\doxysection{mac\+Stats\+Label\+Stack.\+mm}
\hypertarget{macStatsLabelStack_8mm_source}{}\label{macStatsLabelStack_8mm_source}\index{pandatool/src/mac-\/stats/macStatsLabelStack.mm@{pandatool/src/mac-\/stats/macStatsLabelStack.mm}}
\mbox{\hyperlink{macStatsLabelStack_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsLabelStack_8h}{macStatsLabelStack.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsLabel_8h}{macStatsLabel.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsMonitor_8h}{macStatsMonitor.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ NSEdgeInsets\ insets\ =\ \{8,\ 8,\ 8,\ 8\};}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00023\ MacStatsLabelStack::}
\DoxyCodeLine{00024\ MacStatsLabelStack()\ \{}
\DoxyCodeLine{00025\ \ \ \_stack\_view\ =\ [[NSStackView\ alloc]\ init];}
\DoxyCodeLine{00026\ \ \ \_stack\_view.edgeInsets\ =\ insets;}
\DoxyCodeLine{00027\ \ \ \_stack\_view.orientation\ =\ NSUserInterfaceLayoutOrientationVertical;}
\DoxyCodeLine{00028\ \ \ \_stack\_view.alignment\ =\ NSLayoutAttributeRight;\textcolor{comment}{//NSLayoutAttributeCenterX;}}
\DoxyCodeLine{00029\ \ \ \_stack\_view.distribution\ =\ NSStackViewDistributionGravityAreas;}
\DoxyCodeLine{00030\ \ \ \_stack\_view.autoresizingMask\ =\ NSViewWidthSizable\ |\ NSViewHeightSizable;}
\DoxyCodeLine{00031\ \ \ \_stack\_view.translatesAutoresizingMaskIntoConstraints\ =\ NO;}
\DoxyCodeLine{00032\ \ \ \_stack\_view.spacing\ =\ 0;}
\DoxyCodeLine{00033\ \ \ \_highlight\_label\ =\ -\/1;}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ May\ never\ be\ wider\ than\ the\ widest\ label,\ or\ 68,\ whichever\ is\ larger}}
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//FIXME}}
\DoxyCodeLine{00037\ \ \ \_constraint\ =\ [\_stack\_view.widthAnchor\ constraintLessThanOrEqualToConstant:68];}
\DoxyCodeLine{00038\ \ \ \_constraint.active\ =\ NO;}
\DoxyCodeLine{00039\ \ \ [\_constraint\ retain];}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00045\ MacStatsLabelStack::}
\DoxyCodeLine{00046\ \string~MacStatsLabelStack()\ \{}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classMacStatsLabelStack_ae0ff343201fd5f0cad0f405e64ec9984}{clear\_labels}}();}
\DoxyCodeLine{00048\ \ \ [\_constraint\ release];}
\DoxyCodeLine{00049\ \ \ [\_stack\_view\ release];}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00055\ NSView\ *\mbox{\hyperlink{classMacStatsLabelStack_a17d0cbb8cccf844275096662e7141d6f}{MacStatsLabelStack::}}}
\DoxyCodeLine{00056\ \mbox{\hyperlink{classMacStatsLabelStack_a17d0cbb8cccf844275096662e7141d6f}{get\_view}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{return}\ \_stack\_view;}
\DoxyCodeLine{00058\ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00064\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMacStatsLabelStack_afdc015747b71c9c1a895c0ca206df378}{MacStatsLabelStack::}}}
\DoxyCodeLine{00065\ \mbox{\hyperlink{classMacStatsLabelStack_afdc015747b71c9c1a895c0ca206df378}{get\_label\_y}}(\textcolor{keywordtype}{int}\ label\_index,\ NSView\ *target\_view)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00066\ \ \ nassertr(label\_index\ >=\ 0\ \&\&\ label\_index\ <\ (\textcolor{keywordtype}{int})\_labels.size(),\ 0);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ *label\ =\ \_labels[label\_index];}
\DoxyCodeLine{00069\ \ \ NSPoint\ pos\ =\ [target\_view\ convertPoint:NSMakePoint(0,\ label.frame.size.height)\ fromView:label];}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{return}\ pos.y;}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00076\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMacStatsLabelStack_ab8a8ea9471e2255f7911e93dc6bdc13d}{MacStatsLabelStack::}}}
\DoxyCodeLine{00077\ \mbox{\hyperlink{classMacStatsLabelStack_ab8a8ea9471e2255f7911e93dc6bdc13d}{get\_label\_height}}(\textcolor{keywordtype}{int}\ label\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00078\ \ \ nassertr(label\_index\ >=\ 0\ \&\&\ label\_index\ <\ (\textcolor{keywordtype}{int})\_labels.size(),\ 0);}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ \_labels[label\_index].frame.size.height;}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMacStatsLabelStack_ade69e3483730e4a2a3b28cef3c7bde50}{MacStatsLabelStack::}}}
\DoxyCodeLine{00086\ \mbox{\hyperlink{classMacStatsLabelStack_ade69e3483730e4a2a3b28cef3c7bde50}{get\_label\_collector\_index}}(\textcolor{keywordtype}{int}\ label\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00087\ \ \ nassertr(label\_index\ >=\ 0\ \&\&\ label\_index\ <\ (\textcolor{keywordtype}{int})\_labels.size(),\ -\/1);}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{return}\ \_labels[label\_index].collectorIndex;}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00094\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsLabelStack_ae0ff343201fd5f0cad0f405e64ec9984}{MacStatsLabelStack::}}}
\DoxyCodeLine{00095\ \mbox{\hyperlink{classMacStatsLabelStack_ae0ff343201fd5f0cad0f405e64ec9984}{clear\_labels}}()\ \{}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ *label\ :\ \_labels)\ \{}
\DoxyCodeLine{00097\ \ \ \ \ [\_stack\_view\ removeView:label];}
\DoxyCodeLine{00098\ \ \ \ \ [label\ release];}
\DoxyCodeLine{00099\ \ \ \}}
\DoxyCodeLine{00100\ \ \ \_labels.clear();}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \_constraint.constant\ =\ 68;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ NSRect\ frame\ =\ \_stack\_view.frame;}
\DoxyCodeLine{00105\ \ \ frame.size.width\ =\ 0;}
\DoxyCodeLine{00106\ \ \ \_stack\_view.frame\ =\ frame;}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00112\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMacStatsLabelStack_a64f56365d5cf951fb2c81da7bb57c16b}{MacStatsLabelStack::}}}
\DoxyCodeLine{00113\ \mbox{\hyperlink{classMacStatsLabelStack_a64f56365d5cf951fb2c81da7bb57c16b}{add\_label}}(\mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor,\ \mbox{\hyperlink{classMacStatsGraph}{MacStatsGraph}}\ *graph,}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ collector\_index,\ \textcolor{keywordtype}{bool}\ use\_fullname)\ \{}
\DoxyCodeLine{00115\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =\ monitor-\/>get\_client\_data();}
\DoxyCodeLine{00116\ \ \ std::string\ text;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{if}\ (use\_fullname)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ text\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{get\_collector\_fullname}}(collector\_index);}
\DoxyCodeLine{00119\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00120\ \ \ \ \ text\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_ae5c6475096900ee0f29eff74e6919b31}{get\_collector\_name}}(collector\_index);}
\DoxyCodeLine{00121\ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ *label\ =\ [\mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ alloc];}
\DoxyCodeLine{00124\ \ \ [label\ initWithText:[NSString\ stringWithUTF8String:text.c\_str()]}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ graph:graph}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ threadIndex:thread\_index}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ collectorIndex:collector\_index];}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ [\_stack\_view\ insertView:label\ atIndex:0\ inGravity:NSStackViewGravityBottom];}
\DoxyCodeLine{00130\ \ \ [label.leadingAnchor\ constraintEqualToAnchor:\_stack\_view.leadingAnchor\ constant:8].active\ =\ YES;}
\DoxyCodeLine{00131\ \ \ [label.trailingAnchor\ constraintLessThanOrEqualToAnchor:\_stack\_view.trailingAnchor\ constant:-\/8].active\ =\ YES;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \_constraint.constant\ =\ std::max(\_constraint.constant,\ label.intrinsicContentSize.width);}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{int}\ label\_index\ =\ (int)\_labels.size();}
\DoxyCodeLine{00136\ \ \ \_labels.push\_back(label);}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{return}\ label\_index;}
\DoxyCodeLine{00139\ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00144\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classMacStatsLabelStack_a5e65e940be86dd012f99b3cf359eaef6}{MacStatsLabelStack::}}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{classMacStatsLabelStack_a5e65e940be86dd012f99b3cf359eaef6}{get\_num\_labels}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{return}\ \_labels.size();}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00154\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsLabelStack_a8197f33bd443942a356a08ccf6c1cb7e}{MacStatsLabelStack::}}}
\DoxyCodeLine{00155\ \mbox{\hyperlink{classMacStatsLabelStack_a8197f33bd443942a356a08ccf6c1cb7e}{highlight\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{if}\ (\_highlight\_label\ !=\ collector\_index)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \_highlight\_label\ =\ collector\_index;}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ *label\ :\ \_labels)\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ label.highlight\ =\ (label.collectorIndex\ ==\ \_highlight\_label);}
\DoxyCodeLine{00160\ \ \ \ \ \}}
\DoxyCodeLine{00161\ \ \ \}}
\DoxyCodeLine{00162\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00167\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsLabelStack_a766d7e6f5f345d41e58d95931e7e55fd}{MacStatsLabelStack::}}}
\DoxyCodeLine{00168\ \mbox{\hyperlink{classMacStatsLabelStack_a766d7e6f5f345d41e58d95931e7e55fd}{update\_label\_color}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{interfaceMacStatsLabel}{MacStatsLabel}}\ *label\ :\ \_labels)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{if}\ (label.collectorIndex\ ==\ collector\_index)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ [label\ updateColor];}
\DoxyCodeLine{00172\ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ \}}

\end{DoxyCode}
