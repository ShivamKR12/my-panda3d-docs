\doxysection{texture.\+cxx}
\hypertarget{texture_8cxx_source}{}\label{texture_8cxx_source}\index{panda/src/gobj/texture.cxx@{panda/src/gobj/texture.cxx}}
\mbox{\hyperlink{texture_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{texture_8h}{texture.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__gobj_8h}{config\_gobj.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__putil_8h}{config\_putil.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{texturePool_8h}{texturePool.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textureContext_8h}{textureContext.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamCache_8h}{bamCache.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamCacheRecord_8h}{bamCacheRecord.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{preparedGraphicsObjects_8h}{preparedGraphicsObjects.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmImage_8h}{pnmImage.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmReader_8h}{pnmReader.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pfmFile_8h}{pfmFile.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmFileTypeRegistry_8h}{pnmFileTypeRegistry.h}}"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramInputFile_8h}{datagramInputFile.h}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramOutputFile_8h}{datagramOutputFile.h}}"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bam_8h}{bam.h}}"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{zStream_8h}{zStream.h}}"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cmath_8h}{cmath.h}}"{}}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatTimer_8h}{pStatTimer.h}}"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pbitops_8h}{pbitops.h}}"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{streamReader_8h}{streamReader.h}}"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{texturePeeker_8h}{texturePeeker.h}}"{}}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{convert__srgb_8h}{convert\_srgb.h}}"{}}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{asyncTaskManager_8h}{asyncTaskManager.h}}"{}}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#ifdef\ HAVE\_SQUISH}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#include\ <squish.h>}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{stddef_8h}{stddef.h}}>}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{keyword}{using\ }std::endl;}
\DoxyCodeLine{00055\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00056\ \textcolor{keyword}{using\ }std::max;}
\DoxyCodeLine{00057\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00058\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00059\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00060\ \textcolor{keyword}{using\ }std::swap;}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \mbox{\hyperlink{classConfigVariableEnum}{ConfigVariableEnum<Texture::QualityLevel>}}\ texture\_quality\_level}
\DoxyCodeLine{00063\ (\textcolor{stringliteral}{"{}texture-\/quality-\/level"{}},\ Texture::QL\_normal,}
\DoxyCodeLine{00064\ \ PRC\_DESC(\textcolor{stringliteral}{"{}This\ specifies\ a\ global\ quality\ level\ for\ all\ textures.\ \ You\ "{}}}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}may\ specify\ either\ fastest,\ normal,\ or\ best.\ \ This\ actually\ "{}}}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}affects\ the\ meaning\ of\ Texture::set\_quality\_level(QL\_default),\ "{}}}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}so\ it\ may\ be\ overridden\ on\ a\ per-\/texture\ basis.\ \ This\ generally\ "{}}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}only\ has\ an\ effect\ when\ using\ the\ tinydisplay\ software\ renderer;\ "{}}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}it\ has\ little\ or\ no\ effect\ on\ normal,\ hardware-\/accelerated\ "{}}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}renderers.\ \ See\ Texture::set\_quality\_level()."{}}));}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ Texture::\_texture\_read\_pcollector(\textcolor{stringliteral}{"{}*:Texture:Read"{}});}
\DoxyCodeLine{00073\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ Texture::\_texture\_write\_pcollector(\textcolor{stringliteral}{"{}*:Texture:Write"{}});}
\DoxyCodeLine{00074\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ Texture::\_type\_handle;}
\DoxyCodeLine{00075\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ Texture::CData::\_type\_handle;}
\DoxyCodeLine{00076\ AutoTextureScale\ Texture::\_textures\_power\_2\ =\ ATS\_unspecified;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{comment}{//\ Stuff\ to\ read\ and\ write\ DDS\ files.}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{comment}{//\ little-\/endian,\ of\ course}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#define\ DDS\_MAGIC\ 0x20534444}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{comment}{//\ DDS\_header.dwFlags}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#define\ DDSD\_CAPS\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000001}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#define\ DDSD\_HEIGHT\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000002}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\#define\ DDSD\_WIDTH\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#define\ DDSD\_PITCH\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\#define\ DDSD\_PIXELFORMAT\ \ \ \ \ \ \ \ \ \ \ \ 0x00001000}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#define\ DDSD\_MIPMAPCOUNT\ \ \ \ \ \ \ \ \ \ \ \ 0x00020000}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\#define\ DDSD\_LINEARSIZE\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00080000}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#define\ DDSD\_DEPTH\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00800000}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{comment}{//\ DDS\_header.sPixelFormat.dwFlags}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#define\ DDPF\_ALPHAPIXELS\ \ \ \ \ \ \ \ \ \ \ \ 0x00000001}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#define\ DDPF\_FOURCC\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000004}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\#define\ DDPF\_INDEXED\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000020}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#define\ DDPF\_RGB\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000040}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{comment}{//\ DDS\_header.sCaps.dwCaps1}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#define\ DDSCAPS\_COMPLEX\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00000008}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#define\ DDSCAPS\_TEXTURE\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00001000}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\#define\ DDSCAPS\_MIPMAP\ \ \ \ \ \ \ \ \ \ \ \ \ \ 0x00400000}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{comment}{//\ DDS\_header.sCaps.dwCaps2}}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\ \ \ \ \ \ \ \ \ \ \ \ 0x00000200}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_POSITIVEX\ \ 0x00000400}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_NEGATIVEX\ \ 0x00000800}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_POSITIVEY\ \ 0x00001000}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_NEGATIVEY\ \ 0x00002000}}
\DoxyCodeLine{00111\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_POSITIVEZ\ \ 0x00004000}}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_CUBEMAP\_NEGATIVEZ\ \ 0x00008000}}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#define\ DDSCAPS2\_VOLUME\ \ \ \ \ \ \ \ \ \ \ \ \ 0x00200000}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structDDSPixelFormat}{DDSPixelFormat}}\ \{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pf\_size;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pf\_flags;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ four\_cc;}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ rgb\_bitcount;}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\_mask;}
\DoxyCodeLine{00121\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ g\_mask;}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ b\_mask;}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\_mask;}
\DoxyCodeLine{00124\ \};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structDDSCaps2}{DDSCaps2}}\ \{}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ caps1;}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ caps2;}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ddsx;}
\DoxyCodeLine{00130\ \};}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \{}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ dds\_magic;}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ dds\_size;}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ dds\_flags;}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ height;}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ width;}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ pitch;}
\DoxyCodeLine{00139\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ depth;}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ num\_levels;}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{structDDSPixelFormat}{DDSPixelFormat}}\ pf;}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{structDDSCaps2}{DDSCaps2}}\ caps;}
\DoxyCodeLine{00144\ \};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{comment}{//\ Stuff\ to\ read\ KTX\ files.}}
\DoxyCodeLine{00147\ \textcolor{keyword}{enum}\ KTXType\ \{}
\DoxyCodeLine{00148\ \ \ KTX\_BYTE\ =\ 0x1400,}
\DoxyCodeLine{00149\ \ \ KTX\_UNSIGNED\_BYTE\ =\ 0x1401,}
\DoxyCodeLine{00150\ \ \ KTX\_SHORT\ =\ 0x1402,}
\DoxyCodeLine{00151\ \ \ KTX\_UNSIGNED\_SHORT\ =\ 0x1403,}
\DoxyCodeLine{00152\ \ \ KTX\_INT\ =\ 0x1404,}
\DoxyCodeLine{00153\ \ \ KTX\_UNSIGNED\_INT\ =\ 0x1405,}
\DoxyCodeLine{00154\ \ \ KTX\_FLOAT\ =\ 0x1406,}
\DoxyCodeLine{00155\ \ \ KTX\_HALF\_FLOAT\ =\ 0x140B,}
\DoxyCodeLine{00156\ \ \ KTX\_UNSIGNED\_BYTE\_3\_3\_2\ =\ 0x8032,}
\DoxyCodeLine{00157\ \ \ KTX\_UNSIGNED\_SHORT\_4\_4\_4\_4\ =\ 0x8033,}
\DoxyCodeLine{00158\ \ \ KTX\_UNSIGNED\_SHORT\_5\_5\_5\_1\ =\ 0x8034,}
\DoxyCodeLine{00159\ \ \ KTX\_UNSIGNED\_INT\_8\_8\_8\_8\ =\ 0x8035,}
\DoxyCodeLine{00160\ \ \ KTX\_UNSIGNED\_INT\_10\_10\_10\_2\ =\ 0x8036,}
\DoxyCodeLine{00161\ \ \ KTX\_UNSIGNED\_BYTE\_2\_3\_3\_REV\ =\ 0x8362,}
\DoxyCodeLine{00162\ \ \ KTX\_UNSIGNED\_SHORT\_5\_6\_5\ =\ 0x8363,}
\DoxyCodeLine{00163\ \ \ KTX\_UNSIGNED\_SHORT\_5\_6\_5\_REV\ =\ 0x8364,}
\DoxyCodeLine{00164\ \ \ KTX\_UNSIGNED\_SHORT\_4\_4\_4\_4\_REV\ =\ 0x8365,}
\DoxyCodeLine{00165\ \ \ KTX\_UNSIGNED\_SHORT\_1\_5\_5\_5\_REV\ =\ 0x8366,}
\DoxyCodeLine{00166\ \ \ KTX\_UNSIGNED\_INT\_8\_8\_8\_8\_REV\ =\ 0x8367,}
\DoxyCodeLine{00167\ \ \ KTX\_UNSIGNED\_INT\_2\_10\_10\_10\_REV\ =\ 0x8368,}
\DoxyCodeLine{00168\ \ \ KTX\_UNSIGNED\_INT\_24\_8\ =\ 0x84FA,}
\DoxyCodeLine{00169\ \ \ KTX\_UNSIGNED\_INT\_10F\_11F\_11F\_REV\ =\ 0x8C3B,}
\DoxyCodeLine{00170\ \ \ KTX\_UNSIGNED\_INT\_5\_9\_9\_9\_REV\ =\ 0x8C3E,}
\DoxyCodeLine{00171\ \ \ KTX\_FLOAT\_32\_UNSIGNED\_INT\_24\_8\_REV\ =\ 0x8DAD,}
\DoxyCodeLine{00172\ \};}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \textcolor{keyword}{enum}\ KTXFormat\ \{}
\DoxyCodeLine{00175\ \ \ KTX\_ALPHA\ =\ 0x1906,}
\DoxyCodeLine{00176\ \ \ KTX\_ALPHA12\ =\ 0x803D,}
\DoxyCodeLine{00177\ \ \ KTX\_ALPHA16\ =\ 0x803E,}
\DoxyCodeLine{00178\ \ \ KTX\_ALPHA16\_SNORM\ =\ 0x9018,}
\DoxyCodeLine{00179\ \ \ KTX\_ALPHA4\ =\ 0x803B,}
\DoxyCodeLine{00180\ \ \ KTX\_ALPHA8\ =\ 0x803C,}
\DoxyCodeLine{00181\ \ \ KTX\_ALPHA8\_SNORM\ =\ 0x9014,}
\DoxyCodeLine{00182\ \ \ KTX\_ALPHA\_SNORM\ =\ 0x9010,}
\DoxyCodeLine{00183\ \ \ KTX\_BGR\ =\ 0x80E0,}
\DoxyCodeLine{00184\ \ \ KTX\_BGR\_INTEGER\ =\ 0x8D9A,}
\DoxyCodeLine{00185\ \ \ KTX\_BGRA\ =\ 0x80E1,}
\DoxyCodeLine{00186\ \ \ KTX\_BGRA\_INTEGER\ =\ 0x8D9B,}
\DoxyCodeLine{00187\ \ \ KTX\_BLUE\ =\ 0x1905,}
\DoxyCodeLine{00188\ \ \ KTX\_BLUE\_INTEGER\ =\ 0x8D96,}
\DoxyCodeLine{00189\ \ \ KTX\_COLOR\_INDEX\ =\ 0x1900,}
\DoxyCodeLine{00190\ \ \ KTX\_DEPTH24\_STENCIL8\ =\ 0x88F0,}
\DoxyCodeLine{00191\ \ \ KTX\_DEPTH32F\_STENCIL8\ =\ 0x8CAD,}
\DoxyCodeLine{00192\ \ \ KTX\_DEPTH\_COMPONENT\ =\ 0x1902,}
\DoxyCodeLine{00193\ \ \ KTX\_DEPTH\_COMPONENT16\ =\ 0x81A5,}
\DoxyCodeLine{00194\ \ \ KTX\_DEPTH\_COMPONENT24\ =\ 0x81A6,}
\DoxyCodeLine{00195\ \ \ KTX\_DEPTH\_COMPONENT32\ =\ 0x81A7,}
\DoxyCodeLine{00196\ \ \ KTX\_DEPTH\_COMPONENT32F\ =\ 0x8CAC,}
\DoxyCodeLine{00197\ \ \ KTX\_DEPTH\_STENCIL\ =\ 0x84F9,}
\DoxyCodeLine{00198\ \ \ KTX\_GREEN\ =\ 0x1904,}
\DoxyCodeLine{00199\ \ \ KTX\_GREEN\_INTEGER\ =\ 0x8D95,}
\DoxyCodeLine{00200\ \ \ KTX\_INTENSITY\ =\ 0x8049,}
\DoxyCodeLine{00201\ \ \ KTX\_INTENSITY12\ =\ 0x804C,}
\DoxyCodeLine{00202\ \ \ KTX\_INTENSITY16\ =\ 0x804D,}
\DoxyCodeLine{00203\ \ \ KTX\_INTENSITY16\_SNORM\ =\ 0x901B,}
\DoxyCodeLine{00204\ \ \ KTX\_INTENSITY4\ =\ 0x804A,}
\DoxyCodeLine{00205\ \ \ KTX\_INTENSITY8\ =\ 0x804B,}
\DoxyCodeLine{00206\ \ \ KTX\_INTENSITY8\_SNORM\ =\ 0x9017,}
\DoxyCodeLine{00207\ \ \ KTX\_INTENSITY\_SNORM\ =\ 0x9013,}
\DoxyCodeLine{00208\ \ \ KTX\_LUMINANCE\ =\ 0x1909,}
\DoxyCodeLine{00209\ \ \ KTX\_LUMINANCE12\ =\ 0x8041,}
\DoxyCodeLine{00210\ \ \ KTX\_LUMINANCE12\_ALPHA12\ =\ 0x8047,}
\DoxyCodeLine{00211\ \ \ KTX\_LUMINANCE12\_ALPHA4\ =\ 0x8046,}
\DoxyCodeLine{00212\ \ \ KTX\_LUMINANCE16\ =\ 0x8042,}
\DoxyCodeLine{00213\ \ \ KTX\_LUMINANCE16\_ALPHA16\ =\ 0x8048,}
\DoxyCodeLine{00214\ \ \ KTX\_LUMINANCE16\_ALPHA16\_SNORM\ =\ 0x901A,}
\DoxyCodeLine{00215\ \ \ KTX\_LUMINANCE16\_SNORM\ =\ 0x9019,}
\DoxyCodeLine{00216\ \ \ KTX\_LUMINANCE4\ =\ 0x803F,}
\DoxyCodeLine{00217\ \ \ KTX\_LUMINANCE4\_ALPHA4\ =\ 0x8043,}
\DoxyCodeLine{00218\ \ \ KTX\_LUMINANCE6\_ALPHA2\ =\ 0x8044,}
\DoxyCodeLine{00219\ \ \ KTX\_LUMINANCE8\ =\ 0x8040,}
\DoxyCodeLine{00220\ \ \ KTX\_LUMINANCE8\_ALPHA8\ =\ 0x8045,}
\DoxyCodeLine{00221\ \ \ KTX\_LUMINANCE8\_ALPHA8\_SNORM\ =\ 0x9016,}
\DoxyCodeLine{00222\ \ \ KTX\_LUMINANCE8\_SNORM\ =\ 0x9015,}
\DoxyCodeLine{00223\ \ \ KTX\_LUMINANCE\_ALPHA\ =\ 0x190A,}
\DoxyCodeLine{00224\ \ \ KTX\_LUMINANCE\_ALPHA\_SNORM\ =\ 0x9012,}
\DoxyCodeLine{00225\ \ \ KTX\_LUMINANCE\_SNORM\ =\ 0x9011,}
\DoxyCodeLine{00226\ \ \ KTX\_R11F\_G11F\_B10F\ =\ 0x8C3A,}
\DoxyCodeLine{00227\ \ \ KTX\_R16\ =\ 0x822A,}
\DoxyCodeLine{00228\ \ \ KTX\_R16\_SNORM\ =\ 0x8F98,}
\DoxyCodeLine{00229\ \ \ KTX\_R16F\ =\ 0x822D,}
\DoxyCodeLine{00230\ \ \ KTX\_R16I\ =\ 0x8233,}
\DoxyCodeLine{00231\ \ \ KTX\_R16UI\ =\ 0x8234,}
\DoxyCodeLine{00232\ \ \ KTX\_R32F\ =\ 0x822E,}
\DoxyCodeLine{00233\ \ \ KTX\_R32I\ =\ 0x8235,}
\DoxyCodeLine{00234\ \ \ KTX\_R32UI\ =\ 0x8236,}
\DoxyCodeLine{00235\ \ \ KTX\_R3\_G3\_B2\ =\ 0x2A10,}
\DoxyCodeLine{00236\ \ \ KTX\_R8\ =\ 0x8229,}
\DoxyCodeLine{00237\ \ \ KTX\_R8\_SNORM\ =\ 0x8F94,}
\DoxyCodeLine{00238\ \ \ KTX\_R8I\ =\ 0x8231,}
\DoxyCodeLine{00239\ \ \ KTX\_R8UI\ =\ 0x8232,}
\DoxyCodeLine{00240\ \ \ KTX\_RED\ =\ 0x1903,}
\DoxyCodeLine{00241\ \ \ KTX\_RED\_INTEGER\ =\ 0x8D94,}
\DoxyCodeLine{00242\ \ \ KTX\_RED\_SNORM\ =\ 0x8F90,}
\DoxyCodeLine{00243\ \ \ KTX\_RG\ =\ 0x8227,}
\DoxyCodeLine{00244\ \ \ KTX\_RG16\ =\ 0x822C,}
\DoxyCodeLine{00245\ \ \ KTX\_RG16\_SNORM\ =\ 0x8F99,}
\DoxyCodeLine{00246\ \ \ KTX\_RG16F\ =\ 0x822F,}
\DoxyCodeLine{00247\ \ \ KTX\_RG16I\ =\ 0x8239,}
\DoxyCodeLine{00248\ \ \ KTX\_RG16UI\ =\ 0x823A,}
\DoxyCodeLine{00249\ \ \ KTX\_RG32F\ =\ 0x8230,}
\DoxyCodeLine{00250\ \ \ KTX\_RG32I\ =\ 0x823B,}
\DoxyCodeLine{00251\ \ \ KTX\_RG32UI\ =\ 0x823C,}
\DoxyCodeLine{00252\ \ \ KTX\_RG8\ =\ 0x822B,}
\DoxyCodeLine{00253\ \ \ KTX\_RG8\_SNORM\ =\ 0x8F95,}
\DoxyCodeLine{00254\ \ \ KTX\_RG8I\ =\ 0x8237,}
\DoxyCodeLine{00255\ \ \ KTX\_RG8UI\ =\ 0x8238,}
\DoxyCodeLine{00256\ \ \ KTX\_RG\_INTEGER\ =\ 0x8228,}
\DoxyCodeLine{00257\ \ \ KTX\_RG\_SNORM\ =\ 0x8F91,}
\DoxyCodeLine{00258\ \ \ KTX\_RGB\ =\ 0x1907,}
\DoxyCodeLine{00259\ \ \ KTX\_RGB10\ =\ 0x8052,}
\DoxyCodeLine{00260\ \ \ KTX\_RGB10\_A2\ =\ 0x8059,}
\DoxyCodeLine{00261\ \ \ KTX\_RGB12\ =\ 0x8053,}
\DoxyCodeLine{00262\ \ \ KTX\_RGB16\ =\ 0x8054,}
\DoxyCodeLine{00263\ \ \ KTX\_RGB16\_SNORM\ =\ 0x8F9A,}
\DoxyCodeLine{00264\ \ \ KTX\_RGB16F\ =\ 0x881B,}
\DoxyCodeLine{00265\ \ \ KTX\_RGB16I\ =\ 0x8D89,}
\DoxyCodeLine{00266\ \ \ KTX\_RGB16UI\ =\ 0x8D77,}
\DoxyCodeLine{00267\ \ \ KTX\_RGB2\ =\ 0x804E,}
\DoxyCodeLine{00268\ \ \ KTX\_RGB32F\ =\ 0x8815,}
\DoxyCodeLine{00269\ \ \ KTX\_RGB32I\ =\ 0x8D83,}
\DoxyCodeLine{00270\ \ \ KTX\_RGB32UI\ =\ 0x8D71,}
\DoxyCodeLine{00271\ \ \ KTX\_RGB4\ =\ 0x804F,}
\DoxyCodeLine{00272\ \ \ KTX\_RGB5\ =\ 0x8050,}
\DoxyCodeLine{00273\ \ \ KTX\_RGB5\_A1\ =\ 0x8057,}
\DoxyCodeLine{00274\ \ \ KTX\_RGB8\ =\ 0x8051,}
\DoxyCodeLine{00275\ \ \ KTX\_RGB8\_SNORM\ =\ 0x8F96,}
\DoxyCodeLine{00276\ \ \ KTX\_RGB8I\ =\ 0x8D8F,}
\DoxyCodeLine{00277\ \ \ KTX\_RGB8UI\ =\ 0x8D7D,}
\DoxyCodeLine{00278\ \ \ KTX\_RGB9\_E5\ =\ 0x8C3D,}
\DoxyCodeLine{00279\ \ \ KTX\_RGB\_INTEGER\ =\ 0x8D98,}
\DoxyCodeLine{00280\ \ \ KTX\_RGB\_SNORM\ =\ 0x8F92,}
\DoxyCodeLine{00281\ \ \ KTX\_RGBA\ =\ 0x1908,}
\DoxyCodeLine{00282\ \ \ KTX\_RGBA12\ =\ 0x805A,}
\DoxyCodeLine{00283\ \ \ KTX\_RGBA16\ =\ 0x805B,}
\DoxyCodeLine{00284\ \ \ KTX\_RGBA16\_SNORM\ =\ 0x8F9B,}
\DoxyCodeLine{00285\ \ \ KTX\_RGBA16F\ =\ 0x881A,}
\DoxyCodeLine{00286\ \ \ KTX\_RGBA16I\ =\ 0x8D88,}
\DoxyCodeLine{00287\ \ \ KTX\_RGBA16UI\ =\ 0x8D76,}
\DoxyCodeLine{00288\ \ \ KTX\_RGBA2\ =\ 0x8055,}
\DoxyCodeLine{00289\ \ \ KTX\_RGBA32F\ =\ 0x8814,}
\DoxyCodeLine{00290\ \ \ KTX\_RGBA32I\ =\ 0x8D82,}
\DoxyCodeLine{00291\ \ \ KTX\_RGBA32UI\ =\ 0x8D70,}
\DoxyCodeLine{00292\ \ \ KTX\_RGBA4\ =\ 0x8056,}
\DoxyCodeLine{00293\ \ \ KTX\_RGBA8\ =\ 0x8058,}
\DoxyCodeLine{00294\ \ \ KTX\_RGBA8\_SNORM\ =\ 0x8F97,}
\DoxyCodeLine{00295\ \ \ KTX\_RGBA8I\ =\ 0x8D8E,}
\DoxyCodeLine{00296\ \ \ KTX\_RGBA8UI\ =\ 0x8D7C,}
\DoxyCodeLine{00297\ \ \ KTX\_RGBA\_INTEGER\ =\ 0x8D99,}
\DoxyCodeLine{00298\ \ \ KTX\_RGBA\_SNORM\ =\ 0x8F93,}
\DoxyCodeLine{00299\ \ \ KTX\_SLUMINANCE\ =\ 0x8C46,}
\DoxyCodeLine{00300\ \ \ KTX\_SLUMINANCE8\ =\ 0x8C47,}
\DoxyCodeLine{00301\ \ \ KTX\_SLUMINANCE8\_ALPHA8\ =\ 0x8C45,}
\DoxyCodeLine{00302\ \ \ KTX\_SLUMINANCE\_ALPHA\ =\ 0x8C44,}
\DoxyCodeLine{00303\ \ \ KTX\_SRGB\ =\ 0x8C40,}
\DoxyCodeLine{00304\ \ \ KTX\_SRGB8\ =\ 0x8C41,}
\DoxyCodeLine{00305\ \ \ KTX\_SRGB8\_ALPHA8\ =\ 0x8C43,}
\DoxyCodeLine{00306\ \ \ KTX\_SRGB\_ALPHA\ =\ 0x8C42,}
\DoxyCodeLine{00307\ \ \ KTX\_STENCIL\_INDEX\ =\ 0x1901,}
\DoxyCodeLine{00308\ \ \ KTX\_STENCIL\_INDEX1\ =\ 0x8D46,}
\DoxyCodeLine{00309\ \ \ KTX\_STENCIL\_INDEX16\ =\ 0x8D49,}
\DoxyCodeLine{00310\ \ \ KTX\_STENCIL\_INDEX4\ =\ 0x8D47,}
\DoxyCodeLine{00311\ \ \ KTX\_STENCIL\_INDEX8\ =\ 0x8D48,}
\DoxyCodeLine{00312\ \};}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \textcolor{keyword}{enum}\ KTXCompressedFormat\ \{}
\DoxyCodeLine{00315\ \ \ KTX\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\ =\ 0x8C72,}
\DoxyCodeLine{00316\ \ \ KTX\_COMPRESSED\_LUMINANCE\_LATC1\ =\ 0x8C70,}
\DoxyCodeLine{00317\ \ \ KTX\_COMPRESSED\_R11\_EAC\ =\ 0x9270,}
\DoxyCodeLine{00318\ \ \ KTX\_COMPRESSED\_RED\ =\ 0x8225,}
\DoxyCodeLine{00319\ \ \ KTX\_COMPRESSED\_RED\_RGTC1\ =\ 0x8DBB,}
\DoxyCodeLine{00320\ \ \ KTX\_COMPRESSED\_RG\ =\ 0x8226,}
\DoxyCodeLine{00321\ \ \ KTX\_COMPRESSED\_RG11\_EAC\ =\ 0x9272,}
\DoxyCodeLine{00322\ \ \ KTX\_COMPRESSED\_RG\_RGTC2\ =\ 0x8DBD,}
\DoxyCodeLine{00323\ \ \ KTX\_COMPRESSED\_RGB\ =\ 0x84ED,}
\DoxyCodeLine{00324\ \ \ KTX\_COMPRESSED\_RGB8\_ETC2\ =\ 0x9274,}
\DoxyCodeLine{00325\ \ \ KTX\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2\ =\ 0x9276,}
\DoxyCodeLine{00326\ \ \ KTX\_COMPRESSED\_RGB\_BPTC\_SIGNED\_FLOAT\ =\ 0x8E8E,}
\DoxyCodeLine{00327\ \ \ KTX\_COMPRESSED\_RGB\_BPTC\_UNSIGNED\_FLOAT\ =\ 0x8E8F,}
\DoxyCodeLine{00328\ \ \ KTX\_COMPRESSED\_RGB\_FXT1\_3DFX\ =\ 0x86B0,}
\DoxyCodeLine{00329\ \ \ KTX\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG\ =\ 0x8C01,}
\DoxyCodeLine{00330\ \ \ KTX\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG\ =\ 0x8C00,}
\DoxyCodeLine{00331\ \ \ KTX\_COMPRESSED\_RGB\_S3TC\_DXT1\ =\ 0x83F0,}
\DoxyCodeLine{00332\ \ \ KTX\_COMPRESSED\_RGBA\ =\ 0x84EE,}
\DoxyCodeLine{00333\ \ \ KTX\_COMPRESSED\_RGBA8\_ETC2\_EAC\ =\ 0x9278,}
\DoxyCodeLine{00334\ \ \ KTX\_COMPRESSED\_RGBA\_BPTC\_UNORM\ =\ 0x8E8C,}
\DoxyCodeLine{00335\ \ \ KTX\_COMPRESSED\_RGBA\_FXT1\_3DFX\ =\ 0x86B1,}
\DoxyCodeLine{00336\ \ \ KTX\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG\ =\ 0x8C03,}
\DoxyCodeLine{00337\ \ \ KTX\_COMPRESSED\_RGBA\_PVRTC\_2BPPV2\_IMG\ =\ 0x9137,}
\DoxyCodeLine{00338\ \ \ KTX\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG\ =\ 0x8C02,}
\DoxyCodeLine{00339\ \ \ KTX\_COMPRESSED\_RGBA\_PVRTC\_4BPPV2\_IMG\ =\ 0x9138,}
\DoxyCodeLine{00340\ \ \ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT1\ =\ 0x83F1,}
\DoxyCodeLine{00341\ \ \ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT3\ =\ 0x83F2,}
\DoxyCodeLine{00342\ \ \ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT5\ =\ 0x83F3,}
\DoxyCodeLine{00343\ \ \ KTX\_COMPRESSED\_SIGNED\_LUMINANCE\_ALPHA\_LATC2\ =\ 0x8C73,}
\DoxyCodeLine{00344\ \ \ KTX\_COMPRESSED\_SIGNED\_LUMINANCE\_LATC1\ =\ 0x8C71,}
\DoxyCodeLine{00345\ \ \ KTX\_COMPRESSED\_SIGNED\_R11\_EAC\ =\ 0x9271,}
\DoxyCodeLine{00346\ \ \ KTX\_COMPRESSED\_SIGNED\_RED\_RGTC1\ =\ 0x8DBC,}
\DoxyCodeLine{00347\ \ \ KTX\_COMPRESSED\_SIGNED\_RG11\_EAC\ =\ 0x9273,}
\DoxyCodeLine{00348\ \ \ KTX\_COMPRESSED\_SIGNED\_RG\_RGTC2\ =\ 0x8DBE,}
\DoxyCodeLine{00349\ \ \ KTX\_COMPRESSED\_SLUMINANCE\ =\ 0x8C4A,}
\DoxyCodeLine{00350\ \ \ KTX\_COMPRESSED\_SLUMINANCE\_ALPHA\ =\ 0x8C4B,}
\DoxyCodeLine{00351\ \ \ KTX\_COMPRESSED\_SRGB\ =\ 0x8C48,}
\DoxyCodeLine{00352\ \ \ KTX\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC\ =\ 0x9279,}
\DoxyCodeLine{00353\ \ \ KTX\_COMPRESSED\_SRGB8\_ETC2\ =\ 0x9275,}
\DoxyCodeLine{00354\ \ \ KTX\_COMPRESSED\_SRGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2\ =\ 0x9277,}
\DoxyCodeLine{00355\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\ =\ 0x8C49,}
\DoxyCodeLine{00356\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_BPTC\_UNORM\ =\ 0x8E8D,}
\DoxyCodeLine{00357\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_2BPPV1\ =\ 0x8A56,}
\DoxyCodeLine{00358\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_2BPPV2\ =\ 0x93F0,}
\DoxyCodeLine{00359\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_4BPPV1\ =\ 0x8A57,}
\DoxyCodeLine{00360\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_4BPPV2\ =\ 0x93F1,}
\DoxyCodeLine{00361\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1\ =\ 0x8C4D,}
\DoxyCodeLine{00362\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3\ =\ 0x8C4E,}
\DoxyCodeLine{00363\ \ \ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\ =\ 0x8C4F,}
\DoxyCodeLine{00364\ \ \ KTX\_COMPRESSED\_SRGB\_PVRTC\_2BPPV1\ =\ 0x8A54,}
\DoxyCodeLine{00365\ \ \ KTX\_COMPRESSED\_SRGB\_PVRTC\_4BPPV1\ =\ 0x8A55,}
\DoxyCodeLine{00366\ \ \ KTX\_COMPRESSED\_SRGB\_S3TC\_DXT1\ =\ 0x8C4C,}
\DoxyCodeLine{00367\ \ \ KTX\_ETC1\_RGB8\ =\ 0x8D64,}
\DoxyCodeLine{00368\ \ \ KTX\_ETC1\_SRGB8\ =\ 0x88EE,}
\DoxyCodeLine{00369\ \};}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00376\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture::}}}
\DoxyCodeLine{00377\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ :}
\DoxyCodeLine{00378\ \ \ \mbox{\hyperlink{classNamable}{Namable}}(name),}
\DoxyCodeLine{00379\ \ \ \_lock(name),}
\DoxyCodeLine{00380\ \ \ \_cvar(\_lock)}
\DoxyCodeLine{00381\ \{}
\DoxyCodeLine{00382\ \ \ \_reloading\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00385\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00386\ \}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00391\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture::}}}
\DoxyCodeLine{00392\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture}{Texture}}\ \&copy)\ :}
\DoxyCodeLine{00393\ \ \ \mbox{\hyperlink{classNamable}{Namable}}(copy),}
\DoxyCodeLine{00394\ \ \ \_cycler(copy.\_cycler),}
\DoxyCodeLine{00395\ \ \ \_lock(copy.get\_name()),}
\DoxyCodeLine{00396\ \ \ \_cvar(\_lock)}
\DoxyCodeLine{00397\ \{}
\DoxyCodeLine{00398\ \ \ \_reloading\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00399\ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00404\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a916d2a86f0a86e90de48b56c8dbba5ca}{Texture::}}}
\DoxyCodeLine{00405\ \mbox{\hyperlink{classTexture_a916d2a86f0a86e90de48b56c8dbba5ca}{operator\ =\ }}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture}{Texture}}\ \&copy)\ \{}
\DoxyCodeLine{00406\ \ \ Namable::operator\ =\ (copy);}
\DoxyCodeLine{00407\ \ \ \_cycler\ =\ copy.\_cycler;}
\DoxyCodeLine{00408\ \}}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00413\ Texture::}
\DoxyCodeLine{00414\ \string~Texture()\ \{}
\DoxyCodeLine{00415\ \ \ \mbox{\hyperlink{classTexture_ae5ae2a5c3f415ad6e60bd3937d5feca9}{release\_all}}();}
\DoxyCodeLine{00416\ \ \ nassertv(!\_reloading);}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00425\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a64ce9d5703000d5657dd96fa634ef1b1}{Texture::}}}
\DoxyCodeLine{00426\ \mbox{\hyperlink{classTexture_a64ce9d5703000d5657dd96fa634ef1b1}{generate\_normalization\_cube\_map}}(\textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00428\ \ \ do\_setup\_texture(cdata,\ TT\_cube\_map,\ size,\ size,\ 6,\ T\_unsigned\_byte,\ F\_rgb);}
\DoxyCodeLine{00429\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ \mbox{\hyperlink{classTexture_afc2eb673cfd512db47eb76998fac3a7d}{do\_make\_ram\_image}}(cdata);}
\DoxyCodeLine{00430\ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00433\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ PN\_stdfloat\ half\_size\ =\ (PN\_stdfloat)size\ *\ 0.5f;}
\DoxyCodeLine{00436\ \ \ PN\_stdfloat\ center\ =\ half\_size\ -\/\ 0.5f;}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ LMatrix4\ scale}
\DoxyCodeLine{00439\ \ \ \ \ (127.5f,\ 0.0f,\ 0.0f,\ 0.0f,}
\DoxyCodeLine{00440\ \ \ \ \ \ 0.0f,\ 127.5f,\ 0.0f,\ 0.0f,}
\DoxyCodeLine{00441\ \ \ \ \ \ 0.0f,\ 0.0f,\ 127.5f,\ 0.0f,}
\DoxyCodeLine{00442\ \ \ \ \ \ 127.5f,\ 127.5f,\ 127.5f,\ 1.0f);}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image;}
\DoxyCodeLine{00445\ \ \ \textcolor{keywordtype}{int}\ xi,\ yi;}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \textcolor{comment}{//\ Page\ 0:\ positive\ X.}}
\DoxyCodeLine{00448\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00450\ \ \ \ \ \ \ LVector3\ vec(half\_size,\ center\ -\/\ yi,\ center\ -\/\ xi);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00452\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00455\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00456\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00457\ \ \ \ \ \}}
\DoxyCodeLine{00458\ \ \ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \textcolor{comment}{//\ Page\ 1:\ negative\ X.}}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ LVector3\ vec(-\/half\_size,\ center\ -\/\ yi,\ xi\ -\/\ center);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00465\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00466\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00467\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00468\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00469\ \ \ \ \ \}}
\DoxyCodeLine{00470\ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{comment}{//\ Page\ 2:\ positive\ Y.}}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00475\ \ \ \ \ \ \ LVector3\ vec(xi\ -\/\ center,\ half\_size,\ yi\ -\/\ center);}
\DoxyCodeLine{00476\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00477\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00478\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00479\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00480\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00481\ \ \ \ \ \}}
\DoxyCodeLine{00482\ \ \ \}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \textcolor{comment}{//\ Page\ 3:\ negative\ Y.}}
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ LVector3\ vec(xi\ -\/\ center,\ -\/half\_size,\ center\ -\/\ yi);}
\DoxyCodeLine{00488\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00489\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00491\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00492\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00493\ \ \ \ \ \}}
\DoxyCodeLine{00494\ \ \ \}}
\DoxyCodeLine{00495\ }
\DoxyCodeLine{00496\ \ \ \textcolor{comment}{//\ Page\ 4:\ positive\ Z.}}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00499\ \ \ \ \ \ \ LVector3\ vec(xi\ -\/\ center,\ center\ -\/\ yi,\ half\_size);}
\DoxyCodeLine{00500\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00501\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00502\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00503\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00504\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00505\ \ \ \ \ \}}
\DoxyCodeLine{00506\ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \textcolor{comment}{//\ Page\ 5:\ negative\ Z.}}
\DoxyCodeLine{00509\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ size;\ ++yi)\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ size;\ ++xi)\ \{}
\DoxyCodeLine{00511\ \ \ \ \ \ \ LVector3\ vec(center\ -\/\ xi,\ center\ -\/\ yi,\ -\/half\_size);}
\DoxyCodeLine{00512\ \ \ \ \ \ \ vec.normalize();}
\DoxyCodeLine{00513\ \ \ \ \ \ \ vec\ =\ scale.xform\_point(vec);}
\DoxyCodeLine{00514\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[2];}
\DoxyCodeLine{00515\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[1];}
\DoxyCodeLine{00516\ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)vec[0];}
\DoxyCodeLine{00517\ \ \ \ \ \}}
\DoxyCodeLine{00518\ \ \ \}}
\DoxyCodeLine{00519\ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00527\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a75c43b3bb14c65daf61d4f9e52bd8aa3}{Texture::}}}
\DoxyCodeLine{00528\ \mbox{\hyperlink{classTexture_a75c43b3bb14c65daf61d4f9e52bd8aa3}{generate\_alpha\_scale\_map}}()\ \{}
\DoxyCodeLine{00529\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00530\ \ \ do\_setup\_texture(cdata,\ TT\_1d\_texture,\ 256,\ 1,\ 1,\ T\_unsigned\_byte,\ F\_alpha);}
\DoxyCodeLine{00531\ \ \ cdata-\/>\_default\_sampler.set\_wrap\_u(SamplerState::WM\_clamp);}
\DoxyCodeLine{00532\ \ \ cdata-\/>\_default\_sampler.set\_minfilter(SamplerState::FT\_nearest);}
\DoxyCodeLine{00533\ \ \ cdata-\/>\_default\_sampler.set\_magfilter(SamplerState::FT\_nearest);}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ cdata-\/>\_compression\ =\ CM\_off;}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00538\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ \mbox{\hyperlink{classTexture_afc2eb673cfd512db47eb76998fac3a7d}{do\_make\_ram\_image}}(cdata);}
\DoxyCodeLine{00541\ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image;}
\DoxyCodeLine{00544\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ 256;\ ++xi)\ \{}
\DoxyCodeLine{00545\ \ \ \ \ *p++\ =\ xi;}
\DoxyCodeLine{00546\ \ \ \}}
\DoxyCodeLine{00547\ \}}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00552\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{Texture::}}}
\DoxyCodeLine{00553\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{read}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{00554\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00555\ \ \ \mbox{\hyperlink{classTexture_aae02b1ff840292af0cac659d6d75a632}{do\_clear}}(cdata);}
\DoxyCodeLine{00556\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(cdata,\ fullpath,\ \mbox{\hyperlink{classFilename}{Filename}}(),\ 0,\ 0,\ 0,\ 0,\ \textcolor{keyword}{false},\ \textcolor{keyword}{false},}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00558\ \}}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00567\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{Texture::}}}
\DoxyCodeLine{00568\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{read}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&alpha\_fullpath,}
\DoxyCodeLine{00569\ \ \ \ \ \ \textcolor{keywordtype}{int}\ primary\_file\_num\_channels,\ \textcolor{keywordtype}{int}\ alpha\_file\_channel,}
\DoxyCodeLine{00570\ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{00571\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00572\ \ \ \mbox{\hyperlink{classTexture_aae02b1ff840292af0cac659d6d75a632}{do\_clear}}(cdata);}
\DoxyCodeLine{00573\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(cdata,\ fullpath,\ alpha\_fullpath,\ primary\_file\_num\_channels,}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,\ 0,\ 0,\ \textcolor{keyword}{false},\ \textcolor{keyword}{false},}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00576\ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00585\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{Texture::}}}
\DoxyCodeLine{00586\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{read}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{bool}\ read\_pages,\ \textcolor{keywordtype}{bool}\ read\_mipmaps,}
\DoxyCodeLine{00587\ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{00588\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00589\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00590\ \ \ \textcolor{keywordflow}{if}\ (read\_pages)\ \{}
\DoxyCodeLine{00591\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00592\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00593\ \ \ \ \ cdata-\/>inc\_image\_page\_modified(z);}
\DoxyCodeLine{00594\ \ \ \}}
\DoxyCodeLine{00595\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(cdata,\ fullpath,\ \mbox{\hyperlink{classFilename}{Filename}}(),\ 0,\ 0,\ z,\ n,\ read\_pages,\ read\_mipmaps,}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00597\ \}}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00651\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{Texture::}}}
\DoxyCodeLine{00652\ \mbox{\hyperlink{classTexture_a40d216ac2ba40c8869c54a56ce4ad2e8}{read}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&alpha\_fullpath,}
\DoxyCodeLine{00653\ \ \ \ \ \ \textcolor{keywordtype}{int}\ primary\_file\_num\_channels,\ \textcolor{keywordtype}{int}\ alpha\_file\_channel,}
\DoxyCodeLine{00654\ \ \ \ \ \ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{bool}\ read\_pages,\ \textcolor{keywordtype}{bool}\ read\_mipmaps,}
\DoxyCodeLine{00655\ \ \ \ \ \ \mbox{\hyperlink{classBamCacheRecord}{BamCacheRecord}}\ *record,}
\DoxyCodeLine{00656\ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{00657\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00658\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00659\ \ \ \textcolor{keywordflow}{if}\ (read\_pages)\ \{}
\DoxyCodeLine{00660\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00661\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00662\ \ \ \ \ cdata-\/>inc\_image\_page\_modified(z);}
\DoxyCodeLine{00663\ \ \ \}}
\DoxyCodeLine{00664\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(cdata,\ fullpath,\ alpha\_fullpath,\ primary\_file\_num\_channels,}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,\ z,\ n,\ read\_pages,\ read\_mipmaps,}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ record);}
\DoxyCodeLine{00667\ \}}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00679\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classTexture_a3d116aa6663e72e4675ef2cc91e0ade7}{Texture::}}}
\DoxyCodeLine{00680\ \mbox{\hyperlink{classTexture_a3d116aa6663e72e4675ef2cc91e0ade7}{estimate\_texture\_memory}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00681\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00682\ \ \ \textcolor{keywordtype}{size\_t}\ pixels\ =\ cdata-\/>\_x\_size\ *\ cdata-\/>\_y\_size\ *\ cdata-\/>\_z\_size;}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \textcolor{keywordtype}{size\_t}\ bpp\ =\ 0;}
\DoxyCodeLine{00685\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_format)\ \{}
\DoxyCodeLine{00686\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{00687\ \ \ \ \ bpp\ =\ 1;}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00689\ }
\DoxyCodeLine{00690\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{00691\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{00692\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_green:}
\DoxyCodeLine{00693\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_blue:}
\DoxyCodeLine{00694\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{00695\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{00696\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r8i:}
\DoxyCodeLine{00697\ \ \ \ \ bpp\ =\ 1;}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{00701\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alphamask:}
\DoxyCodeLine{00702\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{00703\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{00704\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{00705\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{00706\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{00707\ \ \ \ \ bpp\ =\ 2;}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{00711\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{00712\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{00713\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{comment}{//\ Most\ of\ the\ above\ formats\ have\ only\ 3\ bytes,\ but\ they\ are\ most\ likely}}
\DoxyCodeLine{00715\ \ \ \ \ \textcolor{comment}{//\ to\ get\ padded\ by\ the\ driver}}
\DoxyCodeLine{00716\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00717\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_color\_index:}
\DoxyCodeLine{00720\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{00721\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{00722\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{00723\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8i:}
\DoxyCodeLine{00724\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8i:}
\DoxyCodeLine{00725\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00726\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{00729\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00732\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{00733\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{00734\ \ \ \ \ bpp\ =\ 2;}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:\ \textcolor{comment}{//\ Gets\ padded}}
\DoxyCodeLine{00738\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{00739\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{00743\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{00744\ \ \ \ \ bpp\ =\ 8;}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{00748\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32i:}
\DoxyCodeLine{00749\ \ \ \ \ bpp\ =\ 16;}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{00753\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16i:}
\DoxyCodeLine{00754\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg8i:}
\DoxyCodeLine{00755\ \ \ \ \ bpp\ =\ 2;}
\DoxyCodeLine{00756\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00757\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16i:}
\DoxyCodeLine{00759\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00761\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{00762\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16i:}
\DoxyCodeLine{00763\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{00764\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16i:}
\DoxyCodeLine{00765\ \ \ \ \ bpp\ =\ 8;}
\DoxyCodeLine{00766\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32i:}
\DoxyCodeLine{00769\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32:}
\DoxyCodeLine{00770\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00771\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32:}
\DoxyCodeLine{00774\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32i:}
\DoxyCodeLine{00775\ \ \ \ \ bpp\ =\ 8;}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{00779\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32i:}
\DoxyCodeLine{00780\ \ \ \ \ bpp\ =\ 16;}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r11\_g11\_b10:}
\DoxyCodeLine{00784\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb9\_e5:}
\DoxyCodeLine{00785\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{00786\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00787\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00788\ \ \ \}}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{if}\ (bpp\ ==\ 0)\ \{}
\DoxyCodeLine{00791\ \ \ \ \ bpp\ =\ 4;}
\DoxyCodeLine{00792\ \ \ \ \ gobj\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Unhandled\ format\ in\ estimate\_texture\_memory():\ "{}}}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00794\ \ \ \}}
\DoxyCodeLine{00795\ }
\DoxyCodeLine{00796\ \ \ \textcolor{keywordtype}{size\_t}\ bytes\ =\ pixels\ *\ bpp;}
\DoxyCodeLine{00797\ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps())\ \{}
\DoxyCodeLine{00798\ \ \ \ \ bytes\ =\ (bytes\ *\ 4)\ /\ 3;}
\DoxyCodeLine{00799\ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \textcolor{keywordflow}{return}\ bytes;}
\DoxyCodeLine{00802\ \}}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00811\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_aaf27e418c88abbd320a1347de7b4beba}{Texture::}}}
\DoxyCodeLine{00812\ \mbox{\hyperlink{classTexture_aaf27e418c88abbd320a1347de7b4beba}{set\_aux\_data}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&key,\ \mbox{\hyperlink{classTypedReferenceCount}{TypedReferenceCount}}\ *aux\_data)\ \{}
\DoxyCodeLine{00813\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00814\ \ \ \_aux\_data[key]\ =\ aux\_data;}
\DoxyCodeLine{00815\ \}}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00820\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a10770b297e50009132979900bd7b989b}{Texture::}}}
\DoxyCodeLine{00821\ \mbox{\hyperlink{classTexture_a10770b297e50009132979900bd7b989b}{clear\_aux\_data}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&key)\ \{}
\DoxyCodeLine{00822\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00823\ \ \ \_aux\_data.erase(key);}
\DoxyCodeLine{00824\ \}}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00830\ \mbox{\hyperlink{classTypedReferenceCount}{TypedReferenceCount}}\ *\mbox{\hyperlink{classTexture_a71097ec3cff1ff35365b1b47518eaed0}{Texture::}}}
\DoxyCodeLine{00831\ \mbox{\hyperlink{classTexture_a71097ec3cff1ff35365b1b47518eaed0}{get\_aux\_data}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&key)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00832\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00833\ \ \ AuxData::const\_iterator\ di;}
\DoxyCodeLine{00834\ \ \ di\ =\ \_aux\_data.find(key);}
\DoxyCodeLine{00835\ \ \ \textcolor{keywordflow}{if}\ (di\ !=\ \_aux\_data.end())\ \{}
\DoxyCodeLine{00836\ \ \ \ \ \textcolor{keywordflow}{return}\ (*di).second;}
\DoxyCodeLine{00837\ \ \ \}}
\DoxyCodeLine{00838\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00839\ \}}
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00849\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a82650f34bc6ef039b1f2aedcee33d5a3}{Texture::}}}
\DoxyCodeLine{00850\ \mbox{\hyperlink{classTexture_a82650f34bc6ef039b1f2aedcee33d5a3}{read\_txo}}(istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename)\ \{}
\DoxyCodeLine{00851\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00852\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00853\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordflow}{return}\ do\_read\_txo(cdata,\ in,\ filename);}
\DoxyCodeLine{00855\ \}}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00864\ PT(\mbox{\hyperlink{classTexture}{Texture}})\ Texture::}
\DoxyCodeLine{00865\ make\_from\_txo(istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename)\ \{}
\DoxyCodeLine{00866\ \ \ \mbox{\hyperlink{classDatagramInputFile}{DatagramInputFile}}\ din;}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \textcolor{keywordflow}{if}\ (!din.open(in,\ filename))\ \{}
\DoxyCodeLine{00869\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00870\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ read\ texture\ object:\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00872\ \ \ \}}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \textcolor{keywordtype}{string}\ head;}
\DoxyCodeLine{00875\ \ \ \textcolor{keywordflow}{if}\ (!din.read\_header(head,\ \_bam\_header.size()))\ \{}
\DoxyCodeLine{00876\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00877\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ texture\ object\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00879\ \ \ \}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \textcolor{keywordflow}{if}\ (head\ !=\ \_bam\_header)\ \{}
\DoxyCodeLine{00882\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00883\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ texture\ object\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00884\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00885\ \ \ \}}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ reader(\&din);}
\DoxyCodeLine{00888\ \ \ \textcolor{keywordflow}{if}\ (!reader.\mbox{\hyperlink{classBamReader_a93a91392b652d4096988fd6c093ee128}{init}}())\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00890\ \ \ \}}
\DoxyCodeLine{00891\ }
\DoxyCodeLine{00892\ \ \ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\textcolor{keywordtype}{object}\ =\ reader.\mbox{\hyperlink{classBamReader_aa2745e61d4d3750aae692e72bc02fa3f}{read\_object}}();}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{00895\ \ \ \ \ \ \ object-\/>is\_exact\_type(BamCacheRecord::get\_class\_type()))\ \{}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ special\ case:\ if\ the\ first\ object\ in\ the\ file\ is\ a}}
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{comment}{//\ BamCacheRecord,\ it's\ really\ a\ cache\ data\ file\ and\ not\ a\ true\ txo\ file;}}
\DoxyCodeLine{00898\ \ \ \ \ \textcolor{comment}{//\ but\ skip\ over\ the\ cache\ data\ record\ and\ let\ the\ user\ treat\ it\ like\ an}}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{comment}{//\ ordinary\ txo\ file.}}
\DoxyCodeLine{00900\ \ \ \ \ \textcolor{keywordtype}{object}\ =\ reader.\mbox{\hyperlink{classBamReader_aa2745e61d4d3750aae692e72bc02fa3f}{read\_object}}();}
\DoxyCodeLine{00901\ \ \ \}}
\DoxyCodeLine{00902\ }
\DoxyCodeLine{00903\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00904\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00905\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ object\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ empty.\(\backslash\)n"{}};}
\DoxyCodeLine{00906\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!object-\/>is\_of\_type(Texture::get\_class\_type()))\ \{}
\DoxyCodeLine{00909\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00910\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ object\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ contains\ a\ "{}}}
\DoxyCodeLine{00911\ \ \ \ \ \ \ <<\ \textcolor{keywordtype}{object}-\/>get\_type()\ <<\ \textcolor{stringliteral}{"{},\ not\ a\ Texture.\(\backslash\)n"{}};}
\DoxyCodeLine{00912\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00913\ \ \ \}}
\DoxyCodeLine{00914\ }
\DoxyCodeLine{00915\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ other\ =\ DCAST(\mbox{\hyperlink{classTexture}{Texture}},\ \textcolor{keywordtype}{object});}
\DoxyCodeLine{00916\ \ \ \textcolor{keywordflow}{if}\ (!reader.\mbox{\hyperlink{classBamReader_a79364fc8c51fdf559ea8c8c8aea0fb41}{resolve}}())\ \{}
\DoxyCodeLine{00917\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00918\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ fully\ resolve\ texture\ object\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00919\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00920\ \ \ \}}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \textcolor{keywordflow}{return}\ other;}
\DoxyCodeLine{00923\ \}}
\DoxyCodeLine{00924\ }
\DoxyCodeLine{00932\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a0b08ca84e58ae031d486f49f37abb146}{Texture::}}}
\DoxyCodeLine{00933\ \mbox{\hyperlink{classTexture_a0b08ca84e58ae031d486f49f37abb146}{write\_txo}}(ostream\ \&out,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00934\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00935\ \ \ \textcolor{keywordflow}{return}\ do\_write\_txo(cdata,\ out,\ filename);}
\DoxyCodeLine{00936\ \}}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00947\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a5d9c980d4af2fa7a31cecb185f9e2030}{Texture::}}}
\DoxyCodeLine{00948\ \mbox{\hyperlink{classTexture_a5d9c980d4af2fa7a31cecb185f9e2030}{read\_dds}}(istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{00949\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00950\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00951\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00952\ \ \ \textcolor{keywordflow}{return}\ do\_read\_dds(cdata,\ in,\ filename,\ header\_only);}
\DoxyCodeLine{00953\ \}}
\DoxyCodeLine{00954\ }
\DoxyCodeLine{00964\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_abd148e608a70df2f5b7bd0efcb4a9e9b}{Texture::}}}
\DoxyCodeLine{00965\ \mbox{\hyperlink{classTexture_abd148e608a70df2f5b7bd0efcb4a9e9b}{read\_ktx}}(istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{00966\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00967\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{00968\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{00969\ \ \ \textcolor{keywordflow}{return}\ do\_read\_ktx(cdata,\ in,\ filename,\ header\_only);}
\DoxyCodeLine{00970\ \}}
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00977\ \mbox{\hyperlink{classTexture}{Texture}}\ *\mbox{\hyperlink{classTexture_a29e8f69683c43d12a1c735496d340393}{Texture::}}}
\DoxyCodeLine{00978\ \mbox{\hyperlink{classTexture_a29e8f69683c43d12a1c735496d340393}{load\_related}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classInternalName}{InternalName}}\ *suffix)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00979\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00980\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ \ \ RelatedTextures::const\_iterator\ ti;}
\DoxyCodeLine{00983\ \ \ ti\ =\ \_related\_textures.find(suffix);}
\DoxyCodeLine{00984\ \ \ \textcolor{keywordflow}{if}\ (ti\ !=\ \_related\_textures.end())\ \{}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keywordflow}{return}\ (*ti).second;}
\DoxyCodeLine{00986\ \ \ \}}
\DoxyCodeLine{00987\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_fullpath.empty())\ \{}
\DoxyCodeLine{00988\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00989\ \ \ \}}
\DoxyCodeLine{00990\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ main\ =\ cdata-\/>\_fullpath;}
\DoxyCodeLine{00991\ \ \ main.set\_basename\_wo\_extension(main.get\_basename\_wo\_extension()\ +}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ suffix-\/>\mbox{\hyperlink{classInternalName_a9fd35ab9c168d1b4e3dcb6822086ae61}{get\_name}}());}
\DoxyCodeLine{00993\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ res;}
\DoxyCodeLine{00994\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_alpha\_fullpath.empty())\ \{}
\DoxyCodeLine{00995\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alph\ =\ cdata-\/>\_alpha\_fullpath;}
\DoxyCodeLine{00996\ \ \ \ \ alph.\mbox{\hyperlink{classFilename_a885b73eb309e81a29f2a93540a6f84b7}{set\_basename\_wo\_extension}}(alph.get\_basename\_wo\_extension()\ +}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ suffix-\/>\mbox{\hyperlink{classInternalName_a9fd35ab9c168d1b4e3dcb6822086ae61}{get\_name}}());}
\DoxyCodeLine{00998\ \ \ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00999\ \ \ \ \ \textcolor{keywordflow}{if}\ (vfs-\/>exists(alph))\ \{}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ alpha\ variant\ of\ the\ filename,\ with\ the\ suffix,\ exists.\ \ Use\ it}}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ load\ the\ texture.}}
\DoxyCodeLine{01002\ \ \ \ \ \ \ res\ =\ TexturePool::load\_texture(main,\ alph,}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_primary\_file\_num\_channels,}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_alpha\_file\_channel,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01005\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ alpha\ variant\ of\ the\ filename\ doesn't\ exist,\ just\ go\ ahead\ and}}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \textcolor{comment}{//\ load\ the\ related\ texture\ without\ alpha.}}
\DoxyCodeLine{01008\ \ \ \ \ \ \ res\ =\ TexturePool::load\_texture(main);}
\DoxyCodeLine{01009\ \ \ \ \ \}}
\DoxyCodeLine{01010\ }
\DoxyCodeLine{01011\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01012\ \ \ \ \ \textcolor{comment}{//\ No\ alpha\ filename-\/-\/just\ load\ the\ single\ file.\ \ It\ doesn't\ necessarily}}
\DoxyCodeLine{01013\ \ \ \ \ \textcolor{comment}{//\ have\ the\ same\ number\ of\ channels\ as\ this\ one.}}
\DoxyCodeLine{01014\ \ \ \ \ res\ =\ TexturePool::load\_texture(main);}
\DoxyCodeLine{01015\ \ \ \}}
\DoxyCodeLine{01016\ }
\DoxyCodeLine{01017\ \ \ \textcolor{comment}{//\ I'm\ casting\ away\ the\ const-\/ness\ of\ 'this'\ because\ this\ field\ is\ only\ a}}
\DoxyCodeLine{01018\ \ \ \textcolor{comment}{//\ cache.}}
\DoxyCodeLine{01019\ \ \ ((\mbox{\hyperlink{classTexture}{Texture}}\ *)\textcolor{keyword}{this})-\/>\_related\_textures.insert(RelatedTextures::value\_type(suffix,\ res));}
\DoxyCodeLine{01020\ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{01021\ \}}
\DoxyCodeLine{01022\ }
\DoxyCodeLine{01035\ PT(\mbox{\hyperlink{classAsyncFuture}{AsyncFuture}})\ Texture::}
\DoxyCodeLine{01036\ async\_ensure\_ram\_image(\textcolor{keywordtype}{bool}\ allow\_compression,\ \textcolor{keywordtype}{int}\ priority)\ \{}
\DoxyCodeLine{01037\ \ \ CDLockedReader\ cdata(\_cycler);}
\DoxyCodeLine{01038\ \ \ \textcolor{keywordflow}{if}\ (allow\_compression\ ?\ \mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata)\ :\ \mbox{\hyperlink{classTexture_a7c7c40f83f66e298526a13a4aa6e0e42}{do\_has\_uncompressed\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{01039\ \ \ \ \ \textcolor{comment}{//\ We\ already\ have\ a\ RAM\ image.}}
\DoxyCodeLine{01040\ \ \ \ \ PT(\mbox{\hyperlink{classAsyncFuture}{AsyncFuture}})\ fut\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAsyncFuture}{AsyncFuture}};}
\DoxyCodeLine{01041\ \ \ \ \ fut-\/>set\_result(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01042\ \ \ \ \ \textcolor{keywordflow}{return}\ fut;}
\DoxyCodeLine{01043\ \ \ \}}
\DoxyCodeLine{01044\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(cdata))\ \{}
\DoxyCodeLine{01045\ \ \ \ \ \textcolor{comment}{//\ We\ don't\ have\ a\ filename\ to\ load\ from.\ \ This\ is\ an\ error.}}
\DoxyCodeLine{01046\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01047\ \ \ \}}
\DoxyCodeLine{01048\ }
\DoxyCodeLine{01049\ \ \ \mbox{\hyperlink{classAsyncTask}{AsyncTask}}\ *task\ =\ cdata-\/>\_reload\_task;}
\DoxyCodeLine{01050\ \ \ \textcolor{keywordflow}{if}\ (task\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{comment}{//\ This\ texture\ is\ already\ queued\ to\ be\ reloaded.\ \ Don't\ queue\ it\ again,}}
\DoxyCodeLine{01052\ \ \ \ \ \textcolor{comment}{//\ just\ make\ sure\ the\ priority\ is\ updated,\ and\ return.}}
\DoxyCodeLine{01053\ \ \ \ \ task-\/>\mbox{\hyperlink{classAsyncTask_a3b161094abc9f018507d6c74c555a50f}{set\_priority}}(std::max(task-\/>get\_priority(),\ priority));}
\DoxyCodeLine{01054\ \ \ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classAsyncFuture}{AsyncFuture}}\ *)task;}
\DoxyCodeLine{01055\ \ \ \}}
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \ \ CDWriter\ cdataw(\_cycler,\ cdata,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01058\ }
\DoxyCodeLine{01059\ \ \ \textcolor{keywordtype}{string}\ task\_name\ =\ string(\textcolor{stringliteral}{"{}reload:"{}})\ +\ get\_name();}
\DoxyCodeLine{01060\ \ \ \mbox{\hyperlink{classAsyncTaskManager}{AsyncTaskManager}}\ *task\_mgr\ =\ AsyncTaskManager::get\_global\_ptr();}
\DoxyCodeLine{01061\ \ \ \textcolor{keyword}{static}\ PT(\mbox{\hyperlink{classAsyncTaskChain}{AsyncTaskChain}})\ chain\ =\ task\_mgr-\/>make\_task\_chain(\textcolor{stringliteral}{"{}texture\_reload"{}});}
\DoxyCodeLine{01062\ \ \ chain-\/>\mbox{\hyperlink{classAsyncTaskChain_a87de4062590e510c4bef65f59d00904f}{set\_num\_threads}}(texture\_reload\_num\_threads);}
\DoxyCodeLine{01063\ \ \ chain-\/>set\_thread\_priority(texture\_reload\_thread\_priority);}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \textcolor{keywordtype}{double}\ delay\ =\ async\_load\_delay;}
\DoxyCodeLine{01066\ }
\DoxyCodeLine{01067\ \ \ \textcolor{comment}{//\ This\ texture\ has\ not\ yet\ been\ queued\ to\ be\ reloaded.\ \ Queue\ it\ up\ now.}}
\DoxyCodeLine{01068\ \ \ task\ =\ chain-\/>add([=](\mbox{\hyperlink{classAsyncTask}{AsyncTask}}\ *task)\ \{}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{keywordflow}{if}\ (delay\ !=\ 0.0)\ \{}
\DoxyCodeLine{01070\ \ \ \ \ \ \ Thread::sleep(delay);}
\DoxyCodeLine{01071\ \ \ \ \ \}}
\DoxyCodeLine{01072\ }
\DoxyCodeLine{01073\ \ \ \ \ \textcolor{keywordflow}{if}\ (allow\_compression)\ \{}
\DoxyCodeLine{01074\ \ \ \ \ \ \ CDWriter\ cdata(\_cycler,\ \mbox{\hyperlink{classTexture_acef5e397a933d18a85ee9dba42e1ed97}{unlocked\_ensure\_ram\_image}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{01075\ \ \ \ \ \ \ cdata-\/>\_reload\_task\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01076\ \ \ \ \ \ \ do\_get\_ram\_image(cdata);}
\DoxyCodeLine{01077\ \ \ \ \ \}}
\DoxyCodeLine{01078\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01079\ \ \ \ \ \ \ CDWriter\ cdata(\_cycler,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01080\ \ \ \ \ \ \ cdata-\/>\_reload\_task\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01081\ \ \ \ \ \ \ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{01082\ \ \ \ \ \}}
\DoxyCodeLine{01083\ \ \ \ \ \textcolor{keywordflow}{return}\ AsyncTask::DS\_done;}
\DoxyCodeLine{01084\ \ \ \},\ task\_name,\ 0,\ priority);}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ cdataw-\/>\_reload\_task\ =\ task;}
\DoxyCodeLine{01087\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classAsyncFuture}{AsyncFuture}}\ *)task;}
\DoxyCodeLine{01088\ \}}
\DoxyCodeLine{01089\ }
\DoxyCodeLine{01096\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ad3093c0ae69fcac67e091c01b07234ff}{Texture::}}}
\DoxyCodeLine{01097\ \mbox{\hyperlink{classTexture_ad3093c0ae69fcac67e091c01b07234ff}{set\_ram\_image\_as}}(\mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&supplied\_format)\ \{}
\DoxyCodeLine{01098\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01099\ }
\DoxyCodeLine{01100\ \ \ \textcolor{keywordtype}{string}\ format\ =\ \mbox{\hyperlink{string__utils_8cxx_a19a4ce633f8fa083313af82a9c1d3189}{upcase}}(supplied\_format);}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ can\ grab\ something\ that's\ uncompressed.}}
\DoxyCodeLine{01103\ \ \ \textcolor{keywordtype}{size\_t}\ imgsize\ =\ (size\_t)cdata-\/>\_x\_size\ *\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_y\_size\ *}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (size\_t)cdata-\/>\_z\_size\ *\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_num\_views;}
\DoxyCodeLine{01105\ \ \ nassertv(image.size()\ ==\ (\textcolor{keywordtype}{size\_t})(cdata-\/>\_component\_width\ *\ format.size()\ *\ imgsize));}
\DoxyCodeLine{01106\ }
\DoxyCodeLine{01107\ \ \ \textcolor{comment}{//\ Check\ if\ the\ format\ is\ already\ what\ we\ have\ internally.}}
\DoxyCodeLine{01108\ \ \ \textcolor{keywordflow}{if}\ ((cdata-\/>\_num\_components\ ==\ 1\ \&\&\ format.size()\ ==\ 1)\ ||}
\DoxyCodeLine{01109\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 2\ \&\&\ format.size()\ ==\ 2\ \&\&\ format.at(1)\ ==\ \textcolor{charliteral}{'A'}\ \&\&\ format.at(0)\ !=\ \textcolor{charliteral}{'A'})\ ||}
\DoxyCodeLine{01110\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 3\ \&\&\ format\ ==\ \textcolor{stringliteral}{"{}BGR"{}})\ ||}
\DoxyCodeLine{01111\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 4\ \&\&\ format\ ==\ \textcolor{stringliteral}{"{}BGRA"{}}))\ \{}
\DoxyCodeLine{01112\ \ \ \ \ \textcolor{comment}{//\ The\ format\ string\ is\ already\ our\ format,\ so\ we\ just\ need\ to\ copy\ it.}}
\DoxyCodeLine{01113\ \ \ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ image);}
\DoxyCodeLine{01114\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01115\ \ \ \}}
\DoxyCodeLine{01116\ }
\DoxyCodeLine{01117\ \ \ \textcolor{comment}{//\ Create\ a\ new\ empty\ array\ that\ can\ hold\ our\ image.}}
\DoxyCodeLine{01118\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ newdata\ =\ PTA\_uchar::empty\_array(imgsize\ *\ cdata-\/>\_num\_components\ *\ cdata-\/>\_component\_width,\ get\_class\_type());}
\DoxyCodeLine{01119\ }
\DoxyCodeLine{01120\ \ \ \textcolor{comment}{//\ These\ ifs\ are\ for\ optimization\ of\ commonly\ used\ image\ types.}}
\DoxyCodeLine{01121\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{01122\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}RGBA"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 4)\ \{}
\DoxyCodeLine{01123\ \ \ \ \ \ \ imgsize\ *=\ 4;}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ p\ +=\ 4)\ \{}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ newdata[p\ +\ 2]\ =\ image[p\ \ \ \ ];}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ newdata[p\ +\ 1]\ =\ image[p\ +\ 1];}
\DoxyCodeLine{01127\ \ \ \ \ \ \ \ \ newdata[p\ \ \ \ ]\ =\ image[p\ +\ 2];}
\DoxyCodeLine{01128\ \ \ \ \ \ \ \ \ newdata[p\ +\ 3]\ =\ image[p\ +\ 3];}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ newdata);}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01132\ \ \ \ \ \}}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}RGB"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 3)\ \{}
\DoxyCodeLine{01134\ \ \ \ \ \ \ imgsize\ *=\ 3;}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ p\ +=\ 3)\ \{}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ newdata[p\ +\ 2]\ =\ image[p\ \ \ \ ];}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ newdata[p\ +\ 1]\ =\ image[p\ +\ 1];}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ newdata[p\ \ \ \ ]\ =\ image[p\ +\ 2];}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ newdata);}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01142\ \ \ \ \ \}}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}A"{}}\ \&\&\ cdata-\/>\_num\_components\ !=\ 3)\ \{}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can\ generally\ rely\ on\ alpha\ to\ be\ the\ last\ component.}}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ component\ =\ cdata-\/>\_num\_components\ -\/\ 1;}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ newdata[component]\ =\ image[p];}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ newdata);}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01151\ \ \ \ \ \}}
\DoxyCodeLine{01152\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ s\ =\ 0;\ s\ <\ format.size();\ ++s)\ \{}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{signed}\ \textcolor{keywordtype}{char}\ component\ =\ -\/1;}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'B'}\ ||\ (cdata-\/>\_num\_components\ <=\ 2\ \&\&\ format.at(s)\ !=\ \textcolor{charliteral}{'A'}))\ \{}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ component\ =\ 0;}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'G'})\ \{}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \ \ component\ =\ 1;}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'R'})\ \{}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ component\ =\ 2;}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'A'})\ \{}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ !=\ 3)\ \{}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ \ \ component\ =\ cdata-\/>\_num\_components\ -\/\ 1;}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'0'})\ \{}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'1'})\ \{}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unexpected\ component\ character\ '"{}}}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ format.at(s)\ <<\ \textcolor{stringliteral}{"{}',\ expected\ one\ of\ RGBA!\(\backslash\)n"{}};}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (component\ >=\ 0)\ \{}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ newdata[p\ *\ cdata-\/>\_num\_components\ +\ component]\ =\ image[p\ *\ format.size()\ +\ s];}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01180\ \ \ \ \ \}}
\DoxyCodeLine{01181\ \ \ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ newdata);}
\DoxyCodeLine{01182\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01183\ \ \ \}}
\DoxyCodeLine{01184\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{01185\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ s\ =\ 0;\ s\ <\ format.size();\ ++s)\ \{}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \textcolor{keywordtype}{signed}\ \textcolor{keywordtype}{char}\ component\ =\ -\/1;}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'B'}\ ||\ (cdata-\/>\_num\_components\ <=\ 2\ \&\&\ format.at(s)\ !=\ \textcolor{charliteral}{'A'}))\ \{}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ component\ =\ 0;}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'G'})\ \{}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \ \ component\ =\ 1;}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'R'})\ \{}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ component\ =\ 2;}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'A'})\ \{}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ !=\ 3)\ \{}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ \ \ component\ =\ cdata-\/>\_num\_components\ -\/\ 1;}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'0'})\ \{}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format.at(s)\ ==\ \textcolor{charliteral}{'1'})\ \{}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ignore.}}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ gobj\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unexpected\ component\ character\ '"{}}}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ <<\ format.at(s)\ <<\ \textcolor{stringliteral}{"{}',\ expected\ one\ of\ RGBA!\(\backslash\)n"{}};}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (component\ >=\ 0)\ \{}
\DoxyCodeLine{01209\ \ \ \ \ \ \ \ \ memcpy((\textcolor{keywordtype}{void}*)(newdata\ +\ (p\ *\ cdata-\/>\_num\_components\ +\ component)\ *\ cdata-\/>\_component\_width),}
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}*)(image\ +\ (p\ *\ format.size()\ +\ s)\ *\ cdata-\/>\_component\_width),}
\DoxyCodeLine{01211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_component\_width);}
\DoxyCodeLine{01212\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01213\ \ \ \ \ \}}
\DoxyCodeLine{01214\ \ \ \}}
\DoxyCodeLine{01215\ \ \ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(cdata,\ newdata);}
\DoxyCodeLine{01216\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01217\ \}}
\DoxyCodeLine{01218\ }
\DoxyCodeLine{01224\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a0cb53fb0680f3fb5cd6bface251429f2}{Texture::}}}
\DoxyCodeLine{01225\ \mbox{\hyperlink{classTexture_a0cb53fb0680f3fb5cd6bface251429f2}{get\_keep\_ram\_image}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01226\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01227\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_keep\_ram\_image;}
\DoxyCodeLine{01228\ \}}
\DoxyCodeLine{01229\ }
\DoxyCodeLine{01235\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a1c42f4c1ee8b92b103d1c08a1d87285b}{Texture::}}}
\DoxyCodeLine{01236\ \mbox{\hyperlink{classTexture_a1c42f4c1ee8b92b103d1c08a1d87285b}{is\_cacheable}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01237\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01238\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata);}
\DoxyCodeLine{01239\ \}}
\DoxyCodeLine{01240\ }
\DoxyCodeLine{01253\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexture_aa3d7afbec21f03539d50a7a6aa2ed143}{Texture::}}}
\DoxyCodeLine{01254\ \mbox{\hyperlink{classTexture_aa3d7afbec21f03539d50a7a6aa2ed143}{get\_num\_loadable\_ram\_mipmap\_images}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01255\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01256\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ ||\ cdata-\/>\_ram\_images[0].\_image.empty())\ \{}
\DoxyCodeLine{01257\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ even\ have\ a\ base\ image,\ the\ answer\ is\ none.}}
\DoxyCodeLine{01258\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01259\ \ \ \}}
\DoxyCodeLine{01260\ \ \ \textcolor{keywordflow}{if}\ (!uses\_mipmaps())\ \{}
\DoxyCodeLine{01261\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ base\ image\ and\ don't\ require\ mipmapping,\ the\ answer\ is\ 1.}}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{01263\ \ \ \}}
\DoxyCodeLine{01264\ }
\DoxyCodeLine{01265\ \ \ \textcolor{comment}{//\ Check\ that\ we\ have\ enough\ mipmap\ levels\ to\ meet\ the\ size\ requirements.}}
\DoxyCodeLine{01266\ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_x\_size,\ max(cdata-\/>\_y\_size,\ cdata-\/>\_z\_size));}
\DoxyCodeLine{01267\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{01268\ \ \ \textcolor{keywordtype}{int}\ x\ =\ 1;}
\DoxyCodeLine{01269\ \ \ \textcolor{keywordflow}{while}\ (x\ <\ size)\ \{}
\DoxyCodeLine{01270\ \ \ \ \ x\ =\ (x\ <<\ 1);}
\DoxyCodeLine{01271\ \ \ \ \ ++n;}
\DoxyCodeLine{01272\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size()\ ||\ cdata-\/>\_ram\_images[n].\_image.empty())\ \{}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ n;}
\DoxyCodeLine{01274\ \ \ \ \ \}}
\DoxyCodeLine{01275\ \ \ \}}
\DoxyCodeLine{01276\ }
\DoxyCodeLine{01277\ \ \ ++n;}
\DoxyCodeLine{01278\ \ \ \textcolor{keywordflow}{return}\ n;}
\DoxyCodeLine{01279\ \}}
\DoxyCodeLine{01280\ }
\DoxyCodeLine{01285\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ \mbox{\hyperlink{classTexture_ae7896287821c803caaee9f58d025471c}{Texture::}}}
\DoxyCodeLine{01286\ \mbox{\hyperlink{classTexture_ae7896287821c803caaee9f58d025471c}{get\_ram\_mipmap\_image}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01287\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01288\ \ \ \textcolor{keywordflow}{if}\ (n\ <\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size()\ \&\&\ !cdata-\/>\_ram\_images[n].\_image.empty())\ \{}
\DoxyCodeLine{01289\ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[n].\_image;}
\DoxyCodeLine{01290\ \ \ \}}
\DoxyCodeLine{01291\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type());}
\DoxyCodeLine{01292\ \}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01299\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{classTexture_a45dc53f3f3f36a177321d88b6c006fd2}{Texture::}}}
\DoxyCodeLine{01300\ \mbox{\hyperlink{classTexture_a45dc53f3f3f36a177321d88b6c006fd2}{get\_ram\_mipmap\_pointer}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01301\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01302\ \ \ \textcolor{keywordflow}{if}\ (n\ <\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{01303\ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[n].\_pointer\_image;}
\DoxyCodeLine{01304\ \ \ \}}
\DoxyCodeLine{01305\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01306\ \}}
\DoxyCodeLine{01307\ }
\DoxyCodeLine{01318\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ad49c1fb6700d31fecd210a2f2d3fcea6}{Texture::}}}
\DoxyCodeLine{01319\ \mbox{\hyperlink{classTexture_ad49c1fb6700d31fecd210a2f2d3fcea6}{set\_ram\_mipmap\_pointer}}(\textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{void}\ *image,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{01320\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01321\ \ \ nassertv(cdata-\/>\_ram\_image\_compression\ !=\ CM\_off\ ||\ do\_get\_expected\_ram\_mipmap\_image\_size(cdata,\ n));}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \ \ \textcolor{keywordflow}{while}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{01324\ \ \ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{01325\ \ \ \}}
\DoxyCodeLine{01326\ }
\DoxyCodeLine{01327\ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ page\_size;}
\DoxyCodeLine{01328\ \ \ \textcolor{comment}{//\ \_ram\_images[n].\_image.clear();\ wtf\ is\ going\ on?!}}
\DoxyCodeLine{01329\ \ \ cdata-\/>\_ram\_images[n].\_pointer\_image\ =\ image;}
\DoxyCodeLine{01330\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{01331\ \}}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01340\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a9c80d42ec907f2c486352a33723bb58a}{Texture::}}}
\DoxyCodeLine{01341\ \mbox{\hyperlink{classTexture_a9c80d42ec907f2c486352a33723bb58a}{set\_ram\_mipmap\_pointer\_from\_int}}(\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ pointer,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ page\_size)\ \{}
\DoxyCodeLine{01342\ \ \ \mbox{\hyperlink{classTexture_ad49c1fb6700d31fecd210a2f2d3fcea6}{set\_ram\_mipmap\_pointer}}(n,\ (\textcolor{keywordtype}{void}*)pointer,\ (\textcolor{keywordtype}{size\_t})page\_size);}
\DoxyCodeLine{01343\ \}}
\DoxyCodeLine{01344\ }
\DoxyCodeLine{01348\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_abb204ecd6903427529c40490a21f4c17}{Texture::}}}
\DoxyCodeLine{01349\ \mbox{\hyperlink{classTexture_abb204ecd6903427529c40490a21f4c17}{clear\_ram\_mipmap\_image}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{01350\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01351\ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{01352\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01353\ \ \ \}}
\DoxyCodeLine{01354\ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ 0;}
\DoxyCodeLine{01355\ \ \ cdata-\/>\_ram\_images[n].\_image.clear();}
\DoxyCodeLine{01356\ \ \ cdata-\/>\_ram\_images[n].\_pointer\_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01357\ \}}
\DoxyCodeLine{01358\ }
\DoxyCodeLine{01363\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \mbox{\hyperlink{classTexture_ab7a3af890e257349b964a27e5948eacb}{Texture::}}}
\DoxyCodeLine{01364\ \mbox{\hyperlink{classTexture_ab7a3af890e257349b964a27e5948eacb}{modify\_simple\_ram\_image}}()\ \{}
\DoxyCodeLine{01365\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01366\ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ (int32\_t)time(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01367\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_simple\_ram\_image.\_image;}
\DoxyCodeLine{01368\ \}}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01374\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \mbox{\hyperlink{classTexture_a306a1937155ca514603ddd6647d322b1}{Texture::}}}
\DoxyCodeLine{01375\ \mbox{\hyperlink{classTexture_a306a1937155ca514603ddd6647d322b1}{new\_simple\_ram\_image}}(\textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{01376\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01377\ \ \ nassertr(cdata-\/>\_texture\_type\ ==\ TT\_2d\_texture,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{01378\ \ \ \textcolor{keywordtype}{size\_t}\ expected\_page\_size\ =\ (size\_t)(x\_size\ *\ y\_size\ *\ 4);}
\DoxyCodeLine{01379\ }
\DoxyCodeLine{01380\ \ \ cdata-\/>\_simple\_x\_size\ =\ x\_size;}
\DoxyCodeLine{01381\ \ \ cdata-\/>\_simple\_y\_size\ =\ y\_size;}
\DoxyCodeLine{01382\ \ \ cdata-\/>\_simple\_ram\_image.\_image\ =\ PTA\_uchar::empty\_array(expected\_page\_size);}
\DoxyCodeLine{01383\ \ \ cdata-\/>\_simple\_ram\_image.\_page\_size\ =\ expected\_page\_size;}
\DoxyCodeLine{01384\ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ (int32\_t)time(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ RAM\ image\ currently,\ we\ need\ to\ update\ this,\ to\ let\ the}}
\DoxyCodeLine{01387\ \ \ \textcolor{comment}{//\ GSG\ know\ that\ it\ needs\ to\ update\ the\ simple\ image\ it\ is\ currently\ using.}}
\DoxyCodeLine{01388\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{01389\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{01390\ \ \ \}}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_simple\_ram\_image.\_image;}
\DoxyCodeLine{01393\ \}}
\DoxyCodeLine{01394\ }
\DoxyCodeLine{01400\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ae38bbedf84e17f81d7d8e5bd053dce24}{Texture::}}}
\DoxyCodeLine{01401\ \mbox{\hyperlink{classTexture_ae38bbedf84e17f81d7d8e5bd053dce24}{generate\_simple\_ram\_image}}()\ \{}
\DoxyCodeLine{01402\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01403\ }
\DoxyCodeLine{01404\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ !=\ TT\_2d\_texture\ ||}
\DoxyCodeLine{01405\ \ \ \ \ \ \ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{01406\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01407\ \ \ \}}
\DoxyCodeLine{01408\ }
\DoxyCodeLine{01409\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ pnmimage;}
\DoxyCodeLine{01410\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(cdata,\ pnmimage,\ 0,\ 0))\ \{}
\DoxyCodeLine{01411\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01412\ \ \ \}}
\DoxyCodeLine{01413\ }
\DoxyCodeLine{01414\ \ \ \textcolor{comment}{//\ Start\ at\ the\ suggested\ size\ from\ the\ config\ file.}}
\DoxyCodeLine{01415\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ simple\_image\_size.get\_word(0);}
\DoxyCodeLine{01416\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ simple\_image\_size.get\_word(1);}
\DoxyCodeLine{01417\ }
\DoxyCodeLine{01418\ \ \ \textcolor{comment}{//\ Limit\ it\ to\ no\ larger\ than\ the\ source\ image,\ and\ also\ make\ it\ a\ power\ of}}
\DoxyCodeLine{01419\ \ \ \textcolor{comment}{//\ two.}}
\DoxyCodeLine{01420\ \ \ x\_size\ =\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{down\_to\_power\_2}}(min(x\_size,\ cdata-\/>\_x\_size));}
\DoxyCodeLine{01421\ \ \ y\_size\ =\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{down\_to\_power\_2}}(min(y\_size,\ cdata-\/>\_y\_size));}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01423\ \ \ \textcolor{comment}{//\ Generate\ a\ reduced\ image\ of\ that\ size.}}
\DoxyCodeLine{01424\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ scaled(x\_size,\ y\_size,\ pnmimage.get\_num\_channels());}
\DoxyCodeLine{01425\ \ \ scaled.quick\_filter\_from(pnmimage);}
\DoxyCodeLine{01426\ }
\DoxyCodeLine{01427\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ reduced\ image\ has\ 4\ components,\ by\ convention.}}
\DoxyCodeLine{01428\ \ \ \textcolor{keywordflow}{if}\ (!scaled.has\_alpha())\ \{}
\DoxyCodeLine{01429\ \ \ \ \ scaled.add\_alpha();}
\DoxyCodeLine{01430\ \ \ \ \ scaled.alpha\_fill(1.0);}
\DoxyCodeLine{01431\ \ \ \}}
\DoxyCodeLine{01432\ \ \ scaled.set\_num\_channels(4);}
\DoxyCodeLine{01433\ }
\DoxyCodeLine{01434\ \ \ \textcolor{comment}{//\ Now\ see\ if\ we\ can\ go\ even\ smaller.}}
\DoxyCodeLine{01435\ \ \ \textcolor{keywordtype}{bool}\ did\_anything;}
\DoxyCodeLine{01436\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{01437\ \ \ \ \ did\_anything\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01438\ }
\DoxyCodeLine{01439\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ reduce\ X.}}
\DoxyCodeLine{01440\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ >\ 1)\ \{}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ (x\_size\ >>\ 1);}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ smaller(new\_x\_size,\ y\_size,\ 4);}
\DoxyCodeLine{01443\ \ \ \ \ \ \ smaller.quick\_filter\_from(scaled);}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ bigger(x\_size,\ y\_size,\ 4);}
\DoxyCodeLine{01445\ \ \ \ \ \ \ bigger.quick\_filter\_from(smaller);}
\DoxyCodeLine{01446\ }
\DoxyCodeLine{01447\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compare\_images(scaled,\ bigger))\ \{}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ scaled.take\_from(smaller);}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ x\_size\ =\ new\_x\_size;}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ did\_anything\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01452\ \ \ \ \ \}}
\DoxyCodeLine{01453\ }
\DoxyCodeLine{01454\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ reduce\ Y.}}
\DoxyCodeLine{01455\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >\ 1)\ \{}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ (y\_size\ >>\ 1);}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ smaller(x\_size,\ new\_y\_size,\ 4);}
\DoxyCodeLine{01458\ \ \ \ \ \ \ smaller.quick\_filter\_from(scaled);}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ bigger(x\_size,\ y\_size,\ 4);}
\DoxyCodeLine{01460\ \ \ \ \ \ \ bigger.quick\_filter\_from(smaller);}
\DoxyCodeLine{01461\ }
\DoxyCodeLine{01462\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compare\_images(scaled,\ bigger))\ \{}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ scaled.take\_from(smaller);}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ y\_size\ =\ new\_y\_size;}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ did\_anything\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01467\ \ \ \ \ \}}
\DoxyCodeLine{01468\ \ \ \}\ \textcolor{keywordflow}{while}\ (did\_anything);}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ \textcolor{keywordtype}{size\_t}\ expected\_page\_size\ =\ (size\_t)(x\_size\ *\ y\_size\ *\ 4);}
\DoxyCodeLine{01471\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(expected\_page\_size,\ get\_class\_type());}
\DoxyCodeLine{01472\ \ \ convert\_from\_pnmimage(image,\ expected\_page\_size,\ x\_size,\ 0,\ 0,\ 0,\ scaled,\ 4,\ 1);}
\DoxyCodeLine{01473\ }
\DoxyCodeLine{01474\ \ \ do\_set\_simple\_ram\_image(cdata,\ image,\ x\_size,\ y\_size);}
\DoxyCodeLine{01475\ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ (int32\_t)time(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01476\ \}}
\DoxyCodeLine{01477\ }
\DoxyCodeLine{01490\ PT(\mbox{\hyperlink{classTexturePeeker}{TexturePeeker}})\ Texture::}
\DoxyCodeLine{01491\ peek()\ \{}
\DoxyCodeLine{01492\ \ \ CDWriter\ cdata(\_cycler,\ \mbox{\hyperlink{classTexture_acef5e397a933d18a85ee9dba42e1ed97}{unlocked\_ensure\_ram\_image}}(\textcolor{keyword}{true}));}
\DoxyCodeLine{01493\ }
\DoxyCodeLine{01494\ \ \ PT(\mbox{\hyperlink{classTexturePeeker}{TexturePeeker}})\ peeker\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexturePeeker}{TexturePeeker}}(\textcolor{keyword}{this},\ cdata);}
\DoxyCodeLine{01495\ \ \ \textcolor{keywordflow}{if}\ (peeker-\/>is\_valid())\ \{}
\DoxyCodeLine{01496\ \ \ \ \ \textcolor{keywordflow}{return}\ peeker;}
\DoxyCodeLine{01497\ \ \ \}}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01500\ \}}
\DoxyCodeLine{01501\ }
\DoxyCodeLine{01506\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ \mbox{\hyperlink{classTexture_a181a4aef49c4b9e28cd47d99e66109ac}{Texture::}}}
\DoxyCodeLine{01507\ \mbox{\hyperlink{classTexture_a181a4aef49c4b9e28cd47d99e66109ac}{get\_image\_modified\_pages}}(\mbox{\hyperlink{classUpdateSeq}{UpdateSeq}}\ since,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01508\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01509\ }
\DoxyCodeLine{01510\ \ \ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ result;}
\DoxyCodeLine{01511\ \ \ \textcolor{keywordflow}{if}\ (since\ ==\ cdata-\/>\_image\_modified)\ \{}
\DoxyCodeLine{01512\ \ \ \ \ \textcolor{comment}{//\ Early-\/out\ since\ no\ range\ is\ more\ recent\ than\ \_image\_modified.}}
\DoxyCodeLine{01513\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01514\ \ \ \}}
\DoxyCodeLine{01515\ }
\DoxyCodeLine{01516\ \ \ \textcolor{keywordflow}{if}\ (n\ >\ 0\ \&\&\ cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture)\ \{}
\DoxyCodeLine{01517\ \ \ \ \ \textcolor{comment}{//\ Don't\ bother\ handling\ this\ special\ case,\ just\ consider\ all\ mipmap\ pages}}
\DoxyCodeLine{01518\ \ \ \ \ \textcolor{comment}{//\ modified.}}
\DoxyCodeLine{01519\ \ \ \ \ result.set\_range(0,\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n));}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01521\ \ \ \}}
\DoxyCodeLine{01522\ }
\DoxyCodeLine{01523\ \ \ \textcolor{keywordtype}{size\_t}\ num\_pages\ =\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views;}
\DoxyCodeLine{01524\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structTexture_1_1ModifiedPageRange}{ModifiedPageRange}}\ \&range\ :\ cdata-\/>\_modified\_pages)\ \{}
\DoxyCodeLine{01525\ \ \ \ \ \textcolor{keywordflow}{if}\ (range.\_z\_begin\ >=\ num\_pages)\ \{}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01527\ \ \ \ \ \}}
\DoxyCodeLine{01528\ \ \ \ \ \textcolor{keywordflow}{if}\ (since\ <\ range.\_modified)\ \{}
\DoxyCodeLine{01529\ \ \ \ \ \ \ result.set\_range(range.\_z\_begin,\ std::min(range.\_z\_end,\ num\_pages)\ -\/\ range.\_z\_begin);}
\DoxyCodeLine{01530\ \ \ \ \ \}}
\DoxyCodeLine{01531\ \ \ \}}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01534\ \}}
\DoxyCodeLine{01535\ }
\DoxyCodeLine{01539\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ \mbox{\hyperlink{classTexture_a5ce865719a98c15bf1be32e681859bed}{Texture::}}}
\DoxyCodeLine{01540\ \mbox{\hyperlink{classTexture_a5ce865719a98c15bf1be32e681859bed}{get\_view\_modified\_pages}}(\mbox{\hyperlink{classUpdateSeq}{UpdateSeq}}\ since,\ \textcolor{keywordtype}{int}\ view,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01541\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01542\ }
\DoxyCodeLine{01543\ \ \ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ result;}
\DoxyCodeLine{01544\ \ \ \textcolor{keywordflow}{if}\ (since\ ==\ cdata-\/>\_image\_modified)\ \{}
\DoxyCodeLine{01545\ \ \ \ \ \textcolor{comment}{//\ Early-\/out\ since\ no\ range\ is\ more\ recent\ than\ \_image\_modified.}}
\DoxyCodeLine{01546\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01547\ \ \ \}}
\DoxyCodeLine{01548\ }
\DoxyCodeLine{01549\ \ \ \textcolor{keywordflow}{if}\ (n\ >\ 0\ \&\&\ cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture)\ \{}
\DoxyCodeLine{01550\ \ \ \ \ \textcolor{comment}{//\ Don't\ bother\ handling\ this\ special\ case,\ just\ consider\ all\ mipmap\ pages}}
\DoxyCodeLine{01551\ \ \ \ \ \textcolor{comment}{//\ modified.}}
\DoxyCodeLine{01552\ \ \ \ \ result.set\_range(0,\ do\_get\_expected\_mipmap\_z\_size(cdata,\ n));}
\DoxyCodeLine{01553\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01554\ \ \ \}}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01556\ \ \ \textcolor{keywordtype}{size\_t}\ offset\ =\ cdata-\/>\_z\_size\ *\ view;}
\DoxyCodeLine{01557\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structTexture_1_1ModifiedPageRange}{ModifiedPageRange}}\ \&range\ :\ cdata-\/>\_modified\_pages)\ \{}
\DoxyCodeLine{01558\ \ \ \ \ \textcolor{keywordflow}{if}\ (range.\_z\_end\ <=\ offset)\ \{}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01560\ \ \ \ \ \}}
\DoxyCodeLine{01561\ \ \ \ \ \textcolor{keywordflow}{if}\ (range.\_z\_begin\ >=\ offset\ +\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_z\_size)\ \{}
\DoxyCodeLine{01562\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01563\ \ \ \ \ \}}
\DoxyCodeLine{01564\ \ \ \ \ \textcolor{keywordflow}{if}\ (since\ <\ range.\_modified)\ \{}
\DoxyCodeLine{01565\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ begin\ =\ std::max(range.\_z\_begin,\ offset)\ -\/\ offset;}
\DoxyCodeLine{01566\ \ \ \ \ \ \ result.set\_range(begin,\ std::min(range.\_z\_end\ -\/\ offset,\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_z\_size)\ -\/\ begin);}
\DoxyCodeLine{01567\ \ \ \ \ \}}
\DoxyCodeLine{01568\ \ \ \}}
\DoxyCodeLine{01569\ }
\DoxyCodeLine{01570\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01571\ \}}
\DoxyCodeLine{01572\ }
\DoxyCodeLine{01589\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_acc3871aea35528881e22b3ba37fd1a82}{Texture::}}}
\DoxyCodeLine{01590\ \mbox{\hyperlink{classTexture_acc3871aea35528881e22b3ba37fd1a82}{setup\_async\_transfer}}(\textcolor{keywordtype}{int}\ num\_buffers)\ \{}
\DoxyCodeLine{01591\ \ \ \_num\_async\_transfer\_buffers.store(num\_buffers);}
\DoxyCodeLine{01592\ \}}
\DoxyCodeLine{01593\ }
\DoxyCodeLine{01603\ PT(\mbox{\hyperlink{classAsyncFuture}{AsyncFuture}})\ Texture::}
\DoxyCodeLine{01604\ prepare(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\ \{}
\DoxyCodeLine{01605\ \ \ \textcolor{keywordflow}{return}\ prepared\_objects-\/>enqueue\_texture\_future(\textcolor{keyword}{this});}
\DoxyCodeLine{01606\ \}}
\DoxyCodeLine{01607\ }
\DoxyCodeLine{01612\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_accdde9cef0a1b76525fceebab0a0f389}{Texture::}}}
\DoxyCodeLine{01613\ \mbox{\hyperlink{classTexture_accdde9cef0a1b76525fceebab0a0f389}{is\_prepared}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01614\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01615\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01616\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01617\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01618\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01619\ \ \ \}}
\DoxyCodeLine{01620\ \ \ \textcolor{keywordflow}{return}\ prepared\_objects-\/>\mbox{\hyperlink{classPreparedGraphicsObjects_a1f8d89b003463ec85b48a67832f65246}{is\_texture\_queued}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01621\ \}}
\DoxyCodeLine{01622\ }
\DoxyCodeLine{01628\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_abcf45f507f232d3fa31cec8fe56ef505}{Texture::}}}
\DoxyCodeLine{01629\ \mbox{\hyperlink{classTexture_abcf45f507f232d3fa31cec8fe56ef505}{was\_image\_modified}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01630\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01631\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01632\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01633\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01634\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordflow}{return}\ tc-\/>was\_image\_modified();}
\DoxyCodeLine{01636\ \ \ \}}
\DoxyCodeLine{01637\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01638\ \}}
\DoxyCodeLine{01639\ }
\DoxyCodeLine{01647\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classTexture_ac6916a8d4a0eeba9e9a75aa001e6aa78}{Texture::}}}
\DoxyCodeLine{01648\ \mbox{\hyperlink{classTexture_ac6916a8d4a0eeba9e9a75aa001e6aa78}{get\_data\_size\_bytes}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01649\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01650\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01651\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01652\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01653\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01654\ \ \ \ \ \textcolor{keywordflow}{return}\ tc-\/>get\_data\_size\_bytes();}
\DoxyCodeLine{01655\ \ \ \}}
\DoxyCodeLine{01656\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01657\ \}}
\DoxyCodeLine{01658\ }
\DoxyCodeLine{01663\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a5566a845dabd15e288310fce58215dbf}{Texture::}}}
\DoxyCodeLine{01664\ \mbox{\hyperlink{classTexture_a5566a845dabd15e288310fce58215dbf}{get\_active}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01665\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01666\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01667\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01668\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01669\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01670\ \ \ \ \ \textcolor{keywordflow}{return}\ tc-\/>get\_active();}
\DoxyCodeLine{01671\ \ \ \}}
\DoxyCodeLine{01672\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01673\ \}}
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01679\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a28ee1ebc73b934c183306bc26838566f}{Texture::}}}
\DoxyCodeLine{01680\ \mbox{\hyperlink{classTexture_a28ee1ebc73b934c183306bc26838566f}{get\_resident}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01681\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01682\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01683\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01684\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01685\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01686\ \ \ \ \ \textcolor{keywordflow}{return}\ tc-\/>get\_resident();}
\DoxyCodeLine{01687\ \ \ \}}
\DoxyCodeLine{01688\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{01689\ \}}
\DoxyCodeLine{01690\ }
\DoxyCodeLine{01695\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_aa2b01d0895bb0772c4831f01d2c954ea}{Texture::}}}
\DoxyCodeLine{01696\ \mbox{\hyperlink{classTexture_aa2b01d0895bb0772c4831f01d2c954ea}{release}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\ \{}
\DoxyCodeLine{01697\ \ \ Contexts::iterator\ ci;}
\DoxyCodeLine{01698\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{01699\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{01700\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01701\ \ \ \ \ \textcolor{keywordflow}{if}\ (tc\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01702\ \ \ \ \ \ \ prepared\_objects-\/>\mbox{\hyperlink{classPreparedGraphicsObjects_af34c2d5663ee60380dc3b4d11c65452d}{release\_texture}}(tc);}
\DoxyCodeLine{01703\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \_contexts.erase(ci);}
\DoxyCodeLine{01705\ \ \ \ \ \}}
\DoxyCodeLine{01706\ \ \ \}}
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \ \ \textcolor{comment}{//\ Maybe\ it\ wasn't\ prepared\ yet,\ but\ it's\ about\ to\ be.}}
\DoxyCodeLine{01709\ \ \ \textcolor{keywordflow}{return}\ prepared\_objects-\/>\mbox{\hyperlink{classPreparedGraphicsObjects_aa8955cb8109a28da78f52de756baa1e8}{dequeue\_texture}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01710\ \}}
\DoxyCodeLine{01711\ }
\DoxyCodeLine{01716\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexture_ae5ae2a5c3f415ad6e60bd3937d5feca9}{Texture::}}}
\DoxyCodeLine{01717\ \mbox{\hyperlink{classTexture_ae5ae2a5c3f415ad6e60bd3937d5feca9}{release\_all}}()\ \{}
\DoxyCodeLine{01718\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01719\ }
\DoxyCodeLine{01720\ \ \ \textcolor{comment}{//\ We\ have\ to\ traverse\ a\ copy\ of\ the\ \_contexts\ list,\ because\ the}}
\DoxyCodeLine{01721\ \ \ \textcolor{comment}{//\ PreparedGraphicsObjects\ object\ will\ call\ clear\_prepared()\ in\ response\ to}}
\DoxyCodeLine{01722\ \ \ \textcolor{comment}{//\ each\ release\_texture(),\ and\ we\ don't\ want\ to\ be\ modifying\ the}}
\DoxyCodeLine{01723\ \ \ \textcolor{comment}{//\ \_contexts\ list\ while\ we're\ traversing\ it.}}
\DoxyCodeLine{01724\ \ \ \mbox{\hyperlink{classpmap}{Contexts}}\ temp\ =\ \_contexts;}
\DoxyCodeLine{01725\ \ \ \textcolor{keywordtype}{int}\ num\_freed\ =\ (int)\_contexts.size();}
\DoxyCodeLine{01726\ }
\DoxyCodeLine{01727\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{01728\ \ \ \textcolor{keywordflow}{for}\ (ci\ =\ temp.begin();\ ci\ !=\ temp.end();\ ++ci)\ \{}
\DoxyCodeLine{01729\ \ \ \ \ \mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects\ =\ (*ci).first;}
\DoxyCodeLine{01730\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ (*ci).second;}
\DoxyCodeLine{01731\ \ \ \ \ \textcolor{keywordflow}{if}\ (tc\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01732\ \ \ \ \ \ \ prepared\_objects-\/>\mbox{\hyperlink{classPreparedGraphicsObjects_af34c2d5663ee60380dc3b4d11c65452d}{release\_texture}}(tc);}
\DoxyCodeLine{01733\ \ \ \ \ \}}
\DoxyCodeLine{01734\ \ \ \}}
\DoxyCodeLine{01735\ }
\DoxyCodeLine{01736\ \ \ \textcolor{keywordflow}{return}\ num\_freed;}
\DoxyCodeLine{01737\ \}}
\DoxyCodeLine{01738\ }
\DoxyCodeLine{01743\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{01744\ write(ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01745\ \ \ CDReader\ cdata(\_cycler);}
\DoxyCodeLine{01746\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{01747\ \ \ \ \ <<\ cdata-\/>\_texture\_type\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ get\_name();}
\DoxyCodeLine{01748\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_filename.empty())\ \{}
\DoxyCodeLine{01749\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ (from\ "{}}\ <<\ cdata-\/>\_filename\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{01750\ \ \ \}}
\DoxyCodeLine{01751\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01752\ }
\DoxyCodeLine{01753\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2);}
\DoxyCodeLine{01754\ }
\DoxyCodeLine{01755\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_texture\_type)\ \{}
\DoxyCodeLine{01756\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{01757\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}1-\/d,\ "{}}\ <<\ cdata-\/>\_x\_size;}
\DoxyCodeLine{01758\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01759\ }
\DoxyCodeLine{01760\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture:}
\DoxyCodeLine{01761\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}2-\/d,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size;}
\DoxyCodeLine{01762\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01763\ }
\DoxyCodeLine{01764\ \ \ \textcolor{keywordflow}{case}\ TT\_3d\_texture:}
\DoxyCodeLine{01765\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}3-\/d,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_z\_size;}
\DoxyCodeLine{01766\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture\_array:}
\DoxyCodeLine{01769\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}2-\/d\ array,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_z\_size;}
\DoxyCodeLine{01770\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01771\ }
\DoxyCodeLine{01772\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{01773\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}cube\ map,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size;}
\DoxyCodeLine{01774\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01775\ }
\DoxyCodeLine{01776\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:}
\DoxyCodeLine{01777\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}cube\ map\ array,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_z\_size;}
\DoxyCodeLine{01778\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01780\ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{01781\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}buffer,\ "{}}\ <<\ cdata-\/>\_x\_size;}
\DoxyCodeLine{01782\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01783\ }
\DoxyCodeLine{01784\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture\_array:}
\DoxyCodeLine{01785\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}1-\/d\ array,\ "{}}\ <<\ cdata-\/>\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ cdata-\/>\_y\_size;}
\DoxyCodeLine{01786\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01787\ \ \ \}}
\DoxyCodeLine{01788\ }
\DoxyCodeLine{01789\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_views\ >\ 1)\ \{}
\DoxyCodeLine{01790\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ (x\ "{}}\ <<\ cdata-\/>\_num\_views\ <<\ \textcolor{stringliteral}{"{}\ views)"{}};}
\DoxyCodeLine{01791\ \ \ \}}
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ pixels,\ each\ "{}}\ <<\ cdata-\/>\_num\_components;}
\DoxyCodeLine{01794\ }
\DoxyCodeLine{01795\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_component\_type)\ \{}
\DoxyCodeLine{01796\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{01797\ \ \ \textcolor{keywordflow}{case}\ T\_byte:}
\DoxyCodeLine{01798\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ bytes"{}};}
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01800\ }
\DoxyCodeLine{01801\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{01802\ \ \ \textcolor{keywordflow}{case}\ T\_short:}
\DoxyCodeLine{01803\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ shorts"{}};}
\DoxyCodeLine{01804\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01805\ }
\DoxyCodeLine{01806\ \ \ \textcolor{keywordflow}{case}\ T\_half\_float:}
\DoxyCodeLine{01807\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ half"{}};}
\DoxyCodeLine{01808\ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{01809\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ floats"{}};}
\DoxyCodeLine{01810\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01811\ }
\DoxyCodeLine{01812\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int\_24\_8:}
\DoxyCodeLine{01813\ \ \ \textcolor{keywordflow}{case}\ T\_int:}
\DoxyCodeLine{01814\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int:}
\DoxyCodeLine{01815\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ ints"{}};}
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01817\ }
\DoxyCodeLine{01818\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01819\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01820\ \ \ \}}
\DoxyCodeLine{01821\ }
\DoxyCodeLine{01822\ \ \ out\ <<\ \textcolor{stringliteral}{"{},\ "{}};}
\DoxyCodeLine{01823\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_format)\ \{}
\DoxyCodeLine{01824\ \ \ \textcolor{keywordflow}{case}\ F\_color\_index:}
\DoxyCodeLine{01825\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}color\_index"{}};}
\DoxyCodeLine{01826\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01827\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_stencil:}
\DoxyCodeLine{01828\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}depth\_stencil"{}};}
\DoxyCodeLine{01829\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01830\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component:}
\DoxyCodeLine{01831\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}depth\_component"{}};}
\DoxyCodeLine{01832\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01833\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component16:}
\DoxyCodeLine{01834\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}depth\_component16"{}};}
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01836\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component24:}
\DoxyCodeLine{01837\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}depth\_component24"{}};}
\DoxyCodeLine{01838\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01839\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component32:}
\DoxyCodeLine{01840\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}depth\_component32"{}};}
\DoxyCodeLine{01841\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01842\ }
\DoxyCodeLine{01843\ \ \ \textcolor{keywordflow}{case}\ F\_rgba:}
\DoxyCodeLine{01844\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba"{}};}
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01846\ \ \ \textcolor{keywordflow}{case}\ F\_rgbm:}
\DoxyCodeLine{01847\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgbm"{}};}
\DoxyCodeLine{01848\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01849\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32:}
\DoxyCodeLine{01850\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba32"{}};}
\DoxyCodeLine{01851\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01852\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16:}
\DoxyCodeLine{01853\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba16"{}};}
\DoxyCodeLine{01854\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01855\ \ \ \textcolor{keywordflow}{case}\ F\_rgba12:}
\DoxyCodeLine{01856\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba12"{}};}
\DoxyCodeLine{01857\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01858\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8:}
\DoxyCodeLine{01859\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba8"{}};}
\DoxyCodeLine{01860\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01861\ \ \ \textcolor{keywordflow}{case}\ F\_rgba4:}
\DoxyCodeLine{01862\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba4"{}};}
\DoxyCodeLine{01863\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01864\ }
\DoxyCodeLine{01865\ \ \ \textcolor{keywordflow}{case}\ F\_rgb:}
\DoxyCodeLine{01866\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb"{}};}
\DoxyCodeLine{01867\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01868\ \ \ \textcolor{keywordflow}{case}\ F\_rgb12:}
\DoxyCodeLine{01869\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb12"{}};}
\DoxyCodeLine{01870\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01871\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8:}
\DoxyCodeLine{01872\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb8"{}};}
\DoxyCodeLine{01873\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01874\ \ \ \textcolor{keywordflow}{case}\ F\_rgb5:}
\DoxyCodeLine{01875\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb5"{}};}
\DoxyCodeLine{01876\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01877\ \ \ \textcolor{keywordflow}{case}\ F\_rgba5:}
\DoxyCodeLine{01878\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba5"{}};}
\DoxyCodeLine{01879\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01880\ \ \ \textcolor{keywordflow}{case}\ F\_rgb332:}
\DoxyCodeLine{01881\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb332"{}};}
\DoxyCodeLine{01882\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01883\ }
\DoxyCodeLine{01884\ \ \ \textcolor{keywordflow}{case}\ F\_red:}
\DoxyCodeLine{01885\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}red"{}};}
\DoxyCodeLine{01886\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01887\ \ \ \textcolor{keywordflow}{case}\ F\_green:}
\DoxyCodeLine{01888\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}green"{}};}
\DoxyCodeLine{01889\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01890\ \ \ \textcolor{keywordflow}{case}\ F\_blue:}
\DoxyCodeLine{01891\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}blue"{}};}
\DoxyCodeLine{01892\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01893\ \ \ \textcolor{keywordflow}{case}\ F\_alpha:}
\DoxyCodeLine{01894\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}alpha"{}};}
\DoxyCodeLine{01895\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01896\ \ \ \textcolor{keywordflow}{case}\ F\_luminance:}
\DoxyCodeLine{01897\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}luminance"{}};}
\DoxyCodeLine{01898\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01899\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alpha:}
\DoxyCodeLine{01900\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}luminance\_alpha"{}};}
\DoxyCodeLine{01901\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01902\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alphamask:}
\DoxyCodeLine{01903\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}luminance\_alphamask"{}};}
\DoxyCodeLine{01904\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01905\ }
\DoxyCodeLine{01906\ \ \ \textcolor{keywordflow}{case}\ F\_r16:}
\DoxyCodeLine{01907\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r16"{}};}
\DoxyCodeLine{01908\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01909\ \ \ \textcolor{keywordflow}{case}\ F\_rg16:}
\DoxyCodeLine{01910\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg16"{}};}
\DoxyCodeLine{01911\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01912\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16:}
\DoxyCodeLine{01913\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb16"{}};}
\DoxyCodeLine{01914\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01915\ }
\DoxyCodeLine{01916\ \ \ \textcolor{keywordflow}{case}\ F\_srgb:}
\DoxyCodeLine{01917\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}srgb"{}};}
\DoxyCodeLine{01918\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01919\ \ \ \textcolor{keywordflow}{case}\ F\_srgb\_alpha:}
\DoxyCodeLine{01920\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}srgb\_alpha"{}};}
\DoxyCodeLine{01921\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01922\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance:}
\DoxyCodeLine{01923\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}sluminance"{}};}
\DoxyCodeLine{01924\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01925\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance\_alpha:}
\DoxyCodeLine{01926\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}sluminance\_alpha"{}};}
\DoxyCodeLine{01927\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01928\ }
\DoxyCodeLine{01929\ \ \ \textcolor{keywordflow}{case}\ F\_r32i:}
\DoxyCodeLine{01930\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r32i"{}};}
\DoxyCodeLine{01931\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01932\ }
\DoxyCodeLine{01933\ \ \ \textcolor{keywordflow}{case}\ F\_r32:}
\DoxyCodeLine{01934\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r32"{}};}
\DoxyCodeLine{01935\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01936\ \ \ \textcolor{keywordflow}{case}\ F\_rg32:}
\DoxyCodeLine{01937\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg32"{}};}
\DoxyCodeLine{01938\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01939\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32:}
\DoxyCodeLine{01940\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb32"{}};}
\DoxyCodeLine{01941\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01942\ }
\DoxyCodeLine{01943\ \ \ \textcolor{keywordflow}{case}\ F\_r8i:}
\DoxyCodeLine{01944\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r8i"{}};}
\DoxyCodeLine{01945\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01946\ \ \ \textcolor{keywordflow}{case}\ F\_rg8i:}
\DoxyCodeLine{01947\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg8i"{}};}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01949\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8i:}
\DoxyCodeLine{01950\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb8i"{}};}
\DoxyCodeLine{01951\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01952\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8i:}
\DoxyCodeLine{01953\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba8i"{}};}
\DoxyCodeLine{01954\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01955\ \ \ \textcolor{keywordflow}{case}\ F\_r11\_g11\_b10:}
\DoxyCodeLine{01956\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r11\_g11\_b10"{}};}
\DoxyCodeLine{01957\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01958\ \ \ \textcolor{keywordflow}{case}\ F\_rgb9\_e5:}
\DoxyCodeLine{01959\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb9\_e5"{}};}
\DoxyCodeLine{01960\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01961\ \ \ \textcolor{keywordflow}{case}\ F\_rgb10\_a2:}
\DoxyCodeLine{01962\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb10\_a2"{}};}
\DoxyCodeLine{01963\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \ \ \textcolor{keywordflow}{case}\ F\_rg:}
\DoxyCodeLine{01966\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg"{}};}
\DoxyCodeLine{01967\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01968\ }
\DoxyCodeLine{01969\ \ \ \textcolor{keywordflow}{case}\ F\_r16i:}
\DoxyCodeLine{01970\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}r16i"{}};}
\DoxyCodeLine{01971\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01972\ \ \ \textcolor{keywordflow}{case}\ F\_rg16i:}
\DoxyCodeLine{01973\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg16i"{}};}
\DoxyCodeLine{01974\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01975\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16i:}
\DoxyCodeLine{01976\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb16i"{}};}
\DoxyCodeLine{01977\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01978\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16i:}
\DoxyCodeLine{01979\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba16i"{}};}
\DoxyCodeLine{01980\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01981\ }
\DoxyCodeLine{01982\ \ \ \textcolor{keywordflow}{case}\ F\_rg32i:}
\DoxyCodeLine{01983\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rg32i"{}};}
\DoxyCodeLine{01984\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01985\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32i:}
\DoxyCodeLine{01986\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgb32i"{}};}
\DoxyCodeLine{01987\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01988\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32i:}
\DoxyCodeLine{01989\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}rgba32i"{}};}
\DoxyCodeLine{01990\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01991\ \ \ \}}
\DoxyCodeLine{01992\ }
\DoxyCodeLine{01993\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_compression\ !=\ CM\_default)\ \{}
\DoxyCodeLine{01994\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{},\ compression\ "{}}\ <<\ cdata-\/>\_compression;}
\DoxyCodeLine{01995\ \ \ \}}
\DoxyCodeLine{01996\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2);}
\DoxyCodeLine{01999\ }
\DoxyCodeLine{02000\ \ \ cdata-\/>\_default\_sampler.output(out);}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{02003\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{02004\ \ \ \ \ \ \ <<\ do\_get\_ram\_image\_size(cdata)\ <<\ \textcolor{stringliteral}{"{}\ bytes\ in\ ram,\ compression\ "{}}}
\DoxyCodeLine{02005\ \ \ \ \ \ \ <<\ cdata-\/>\_ram\_image\_compression\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02006\ }
\DoxyCodeLine{02007\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.size()\ >\ 1)\ \{}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ total\_size\ =\ 0;}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 1;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_ram\_images[n].\_image.empty())\ \{}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \ \ total\_size\ +=\ cdata-\/>\_ram\_images[n].\_image.size();}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Stop\ at\ the\ first\ gap.}}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02019\ \ \ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ <<\ count}
\DoxyCodeLine{02021\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ mipmap\ levels\ also\ present\ in\ ram\ ("{}}\ <<\ total\_size}
\DoxyCodeLine{02022\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ bytes).\(\backslash\)n"{}};}
\DoxyCodeLine{02023\ \ \ \ \ \}}
\DoxyCodeLine{02024\ }
\DoxyCodeLine{02025\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02026\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{02027\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}no\ ram\ image\(\backslash\)n"{}};}
\DoxyCodeLine{02028\ \ \ \}}
\DoxyCodeLine{02029\ }
\DoxyCodeLine{02030\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_simple\_ram\_image.\_image.empty())\ \{}
\DoxyCodeLine{02031\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{02032\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}simple\ image:\ "{}}\ <<\ cdata-\/>\_simple\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}}
\DoxyCodeLine{02033\ \ \ \ \ \ \ <<\ cdata-\/>\_simple\_y\_size\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{02034\ \ \ \ \ \ \ <<\ cdata-\/>\_simple\_ram\_image.\_image.size()\ <<\ \textcolor{stringliteral}{"{}\ bytes\(\backslash\)n"{}};}
\DoxyCodeLine{02035\ \ \ \}}
\DoxyCodeLine{02036\ \}}
\DoxyCodeLine{02037\ }
\DoxyCodeLine{02038\ }
\DoxyCodeLine{02043\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ada1263a8e1050b11ea5bfe007cb34a83}{Texture::}}}
\DoxyCodeLine{02044\ \mbox{\hyperlink{classTexture_ada1263a8e1050b11ea5bfe007cb34a83}{set\_size\_padded}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{02045\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02046\ \ \ \textcolor{keywordflow}{if}\ (do\_get\_auto\_texture\_scale(cdata)\ !=\ ATS\_none)\ \{}
\DoxyCodeLine{02047\ \ \ \ \ do\_set\_x\_size(cdata,\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(x));}
\DoxyCodeLine{02048\ \ \ \ \ do\_set\_y\_size(cdata,\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(y));}
\DoxyCodeLine{02049\ }
\DoxyCodeLine{02050\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ TT\_3d\_texture)\ \{}
\DoxyCodeLine{02051\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ pad\ 3D\ textures.\ \ It\ does\ not\ make\ sense\ to\ do\ so\ for\ cube\ maps}}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \textcolor{comment}{//\ or\ 2D\ texture\ arrays.}}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(cdata,\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(z));}
\DoxyCodeLine{02054\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(cdata,\ z);}
\DoxyCodeLine{02056\ \ \ \ \ \}}
\DoxyCodeLine{02057\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02058\ \ \ \ \ do\_set\_x\_size(cdata,\ x);}
\DoxyCodeLine{02059\ \ \ \ \ do\_set\_y\_size(cdata,\ y);}
\DoxyCodeLine{02060\ \ \ \ \ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(cdata,\ z);}
\DoxyCodeLine{02061\ \ \ \}}
\DoxyCodeLine{02062\ \ \ do\_set\_pad\_size(cdata,}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_x\_size\ -\/\ x,}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_y\_size\ -\/\ y,}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_z\_size\ -\/\ z);}
\DoxyCodeLine{02066\ \}}
\DoxyCodeLine{02067\ }
\DoxyCodeLine{02072\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a525b10c35e496d80a058e2a8b9589cc7}{Texture::}}}
\DoxyCodeLine{02073\ \mbox{\hyperlink{classTexture_a525b10c35e496d80a058e2a8b9589cc7}{set\_orig\_file\_size}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{02074\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02075\ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ x;}
\DoxyCodeLine{02076\ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ y;}
\DoxyCodeLine{02077\ }
\DoxyCodeLine{02078\ \ \ nassertv(z\ ==\ cdata-\/>\_z\_size);}
\DoxyCodeLine{02079\ \}}
\DoxyCodeLine{02080\ }
\DoxyCodeLine{02092\ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *\mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{Texture::}}}
\DoxyCodeLine{02093\ \mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{prepare\_now}}(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects,}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg)\ \{}
\DoxyCodeLine{02095\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{02096\ }
\DoxyCodeLine{02097\ \ \ Contexts::const\_iterator\ ci;}
\DoxyCodeLine{02098\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{02099\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{02100\ \ \ \ \ \textcolor{keywordflow}{return}\ (*ci).second;}
\DoxyCodeLine{02101\ \ \ \}}
\DoxyCodeLine{02102\ }
\DoxyCodeLine{02103\ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ prepared\_objects-\/>\mbox{\hyperlink{classPreparedGraphicsObjects_ae704ff16e42ab4959e725c1af7478658}{prepare\_texture\_now}}(\textcolor{keyword}{this},\ gsg);}
\DoxyCodeLine{02104\ \ \ \_contexts[prepared\_objects]\ =\ tc;}
\DoxyCodeLine{02105\ }
\DoxyCodeLine{02106\ \ \ \textcolor{keywordflow}{return}\ tc;}
\DoxyCodeLine{02107\ \}}
\DoxyCodeLine{02108\ }
\DoxyCodeLine{02112\ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *\mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{Texture::}}}
\DoxyCodeLine{02113\ \mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{prepare\_now}}(\textcolor{keywordtype}{int}\ view,\ \mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects,}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg)\ \{}
\DoxyCodeLine{02115\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{prepare\_now}}(prepared\_objects,\ gsg);}
\DoxyCodeLine{02116\ \}}
\DoxyCodeLine{02117\ }
\DoxyCodeLine{02121\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{Texture::}}}
\DoxyCodeLine{02122\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(\textcolor{keywordtype}{int}\ value)\ \{}
\DoxyCodeLine{02123\ \ \ \textcolor{keywordflow}{if}\ (value\ <=\ 1)\ \{}
\DoxyCodeLine{02124\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{02125\ \ \ \}}
\DoxyCodeLine{02126\ \ \ \textcolor{keywordtype}{int}\ bit\ =\ get\_next\_higher\_bit(((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})value)\ -\/\ 1);}
\DoxyCodeLine{02127\ \ \ \textcolor{keywordflow}{return}\ (1\ <<\ bit);}
\DoxyCodeLine{02128\ \}}
\DoxyCodeLine{02129\ }
\DoxyCodeLine{02133\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{Texture::}}}
\DoxyCodeLine{02134\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{down\_to\_power\_2}}(\textcolor{keywordtype}{int}\ value)\ \{}
\DoxyCodeLine{02135\ \ \ \textcolor{keywordflow}{if}\ (value\ <=\ 1)\ \{}
\DoxyCodeLine{02136\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{02137\ \ \ \}}
\DoxyCodeLine{02138\ \ \ \textcolor{keywordtype}{int}\ bit\ =\ get\_next\_higher\_bit(((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})value)\ >>\ 1);}
\DoxyCodeLine{02139\ \ \ \textcolor{keywordflow}{return}\ (1\ <<\ bit);}
\DoxyCodeLine{02140\ \}}
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02152\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a41530f64117ebd6cc3ec7c1969f7f080}{Texture::}}}
\DoxyCodeLine{02153\ \mbox{\hyperlink{classTexture_a41530f64117ebd6cc3ec7c1969f7f080}{consider\_rescale}}(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage)\ \{}
\DoxyCodeLine{02154\ \ \ \mbox{\hyperlink{classTexture_a41530f64117ebd6cc3ec7c1969f7f080}{consider\_rescale}}(pnmimage,\ get\_name(),\ get\_auto\_texture\_scale());}
\DoxyCodeLine{02155\ \}}
\DoxyCodeLine{02156\ }
\DoxyCodeLine{02167\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a41530f64117ebd6cc3ec7c1969f7f080}{Texture::}}}
\DoxyCodeLine{02168\ \mbox{\hyperlink{classTexture_a41530f64117ebd6cc3ec7c1969f7f080}{consider\_rescale}}(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ AutoTextureScale\ auto\_texture\_scale)\ \{}
\DoxyCodeLine{02169\ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ pnmimage.get\_x\_size();}
\DoxyCodeLine{02170\ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ pnmimage.get\_y\_size();}
\DoxyCodeLine{02171\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{adjust\_size}}(new\_x\_size,\ new\_y\_size,\ name,\ \textcolor{keyword}{false},\ auto\_texture\_scale))\ \{}
\DoxyCodeLine{02172\ \ \ \ \ \textcolor{keywordflow}{if}\ (pnmimage.is\_valid())\ \{}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ image\ is\ already\ loaded.\ \ Rescale\ on\ the\ spot.}}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ new\_image(new\_x\_size,\ new\_y\_size,\ pnmimage.get\_num\_channels(),}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.get\_maxval(),\ pnmimage.get\_type(),}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.get\_color\_space());}
\DoxyCodeLine{02177\ \ \ \ \ \ \ new\_image.quick\_filter\_from(pnmimage);}
\DoxyCodeLine{02178\ \ \ \ \ \ \ pnmimage.take\_from(new\_image);}
\DoxyCodeLine{02179\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \textcolor{comment}{//\ Rescale\ while\ reading.\ \ Some\ image\ types\ (e.g.\ \ jpeg)\ can\ take}}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \textcolor{comment}{//\ advantage\ of\ this.}}
\DoxyCodeLine{02182\ \ \ \ \ \ \ pnmimage.set\_read\_size(new\_x\_size,\ new\_y\_size);}
\DoxyCodeLine{02183\ \ \ \ \ \}}
\DoxyCodeLine{02184\ \ \ \}}
\DoxyCodeLine{02185\ \}}
\DoxyCodeLine{02186\ }
\DoxyCodeLine{02190\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classTexture_aaefbfea0089fa4a0e156d04cbbfad382}{Texture::}}}
\DoxyCodeLine{02191\ \mbox{\hyperlink{classTexture_aaefbfea0089fa4a0e156d04cbbfad382}{format\_texture\_type}}(TextureType\ tt)\ \{}
\DoxyCodeLine{02192\ \ \ \textcolor{keywordflow}{switch}\ (tt)\ \{}
\DoxyCodeLine{02193\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{02194\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}1d\_texture"{}};}
\DoxyCodeLine{02195\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture:}
\DoxyCodeLine{02196\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}2d\_texture"{}};}
\DoxyCodeLine{02197\ \ \ \textcolor{keywordflow}{case}\ TT\_3d\_texture:}
\DoxyCodeLine{02198\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}3d\_texture"{}};}
\DoxyCodeLine{02199\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture\_array:}
\DoxyCodeLine{02200\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}2d\_texture\_array"{}};}
\DoxyCodeLine{02201\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{02202\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}cube\_map"{}};}
\DoxyCodeLine{02203\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:}
\DoxyCodeLine{02204\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}cube\_map\_array"{}};}
\DoxyCodeLine{02205\ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{02206\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}buffer\_texture"{}};}
\DoxyCodeLine{02207\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture\_array:}
\DoxyCodeLine{02208\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}1d\_texture\_array"{}};}
\DoxyCodeLine{02209\ \ \ \}}
\DoxyCodeLine{02210\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{02211\ \}}
\DoxyCodeLine{02212\ }
\DoxyCodeLine{02216\ Texture::TextureType\ \mbox{\hyperlink{classTexture_a074288beb2b76c0fd1072c36c1218861}{Texture::}}}
\DoxyCodeLine{02217\ \mbox{\hyperlink{classTexture_a074288beb2b76c0fd1072c36c1218861}{string\_texture\_type}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{02218\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}1d\_texture"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02219\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_1d\_texture;}
\DoxyCodeLine{02220\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}2d\_texture"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02221\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_2d\_texture;}
\DoxyCodeLine{02222\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}3d\_texture"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02223\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_3d\_texture;}
\DoxyCodeLine{02224\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}2d\_texture\_array"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02225\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_2d\_texture\_array;}
\DoxyCodeLine{02226\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}cube\_map"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02227\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_cube\_map;}
\DoxyCodeLine{02228\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}cube\_map\_array"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02229\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_cube\_map\_array;}
\DoxyCodeLine{02230\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}buffer\_texture"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02231\ \ \ \ \ \textcolor{keywordflow}{return}\ TT\_buffer\_texture;}
\DoxyCodeLine{02232\ \ \ \}}
\DoxyCodeLine{02233\ }
\DoxyCodeLine{02234\ \ \ gobj\_cat-\/>error()}
\DoxyCodeLine{02235\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::TextureType\ value:\ "{}}\ <<\ str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02236\ \ \ \textcolor{keywordflow}{return}\ TT\_2d\_texture;}
\DoxyCodeLine{02237\ \}}
\DoxyCodeLine{02238\ }
\DoxyCodeLine{02242\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classTexture_a1e2ff1700b53dabad5997fb6a81e11a0}{Texture::}}}
\DoxyCodeLine{02243\ \mbox{\hyperlink{classTexture_a1e2ff1700b53dabad5997fb6a81e11a0}{format\_component\_type}}(ComponentType\ ct)\ \{}
\DoxyCodeLine{02244\ \ \ \textcolor{keywordflow}{switch}\ (ct)\ \{}
\DoxyCodeLine{02245\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{02246\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}unsigned\_byte"{}};}
\DoxyCodeLine{02247\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{02248\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}unsigned\_short"{}};}
\DoxyCodeLine{02249\ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{02250\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}float"{}};}
\DoxyCodeLine{02251\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int\_24\_8:}
\DoxyCodeLine{02252\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}unsigned\_int\_24\_8"{}};}
\DoxyCodeLine{02253\ \ \ \textcolor{keywordflow}{case}\ T\_int:}
\DoxyCodeLine{02254\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}int"{}};}
\DoxyCodeLine{02255\ \ \ \textcolor{keywordflow}{case}\ T\_byte:}
\DoxyCodeLine{02256\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}unsigned\_byte"{}};}
\DoxyCodeLine{02257\ \ \ \textcolor{keywordflow}{case}\ T\_short:}
\DoxyCodeLine{02258\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}short"{}};}
\DoxyCodeLine{02259\ \ \ \textcolor{keywordflow}{case}\ T\_half\_float:}
\DoxyCodeLine{02260\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}half\_float"{}};}
\DoxyCodeLine{02261\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int:}
\DoxyCodeLine{02262\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}unsigned\_int"{}};}
\DoxyCodeLine{02263\ \ \ \}}
\DoxyCodeLine{02264\ }
\DoxyCodeLine{02265\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{02266\ \}}
\DoxyCodeLine{02267\ }
\DoxyCodeLine{02271\ Texture::ComponentType\ \mbox{\hyperlink{classTexture_a8d229c7492d50f0c5156a2616c9ad8f7}{Texture::}}}
\DoxyCodeLine{02272\ \mbox{\hyperlink{classTexture_a8d229c7492d50f0c5156a2616c9ad8f7}{string\_component\_type}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{02273\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}unsigned\_byte"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02274\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_unsigned\_byte;}
\DoxyCodeLine{02275\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}unsigned\_short"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02276\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_unsigned\_short;}
\DoxyCodeLine{02277\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}float"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02278\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_float;}
\DoxyCodeLine{02279\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}unsigned\_int\_24\_8"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02280\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_unsigned\_int\_24\_8;}
\DoxyCodeLine{02281\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}int"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02282\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_int;}
\DoxyCodeLine{02283\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}byte"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02284\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_byte;}
\DoxyCodeLine{02285\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}short"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02286\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_short;}
\DoxyCodeLine{02287\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}half\_float"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02288\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_half\_float;}
\DoxyCodeLine{02289\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}unsigned\_int"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02290\ \ \ \ \ \textcolor{keywordflow}{return}\ T\_unsigned\_int;}
\DoxyCodeLine{02291\ \ \ \}}
\DoxyCodeLine{02292\ }
\DoxyCodeLine{02293\ \ \ gobj\_cat-\/>error()}
\DoxyCodeLine{02294\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::ComponentType\ value:\ "{}}\ <<\ str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02295\ \ \ \textcolor{keywordflow}{return}\ T\_unsigned\_byte;}
\DoxyCodeLine{02296\ \}}
\DoxyCodeLine{02297\ }
\DoxyCodeLine{02301\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classTexture_af08a4893d78637835f8ea166212f9a78}{Texture::}}}
\DoxyCodeLine{02302\ \mbox{\hyperlink{classTexture_af08a4893d78637835f8ea166212f9a78}{format\_format}}(Format\ format)\ \{}
\DoxyCodeLine{02303\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{02304\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_stencil:}
\DoxyCodeLine{02305\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}depth\_stencil"{}};}
\DoxyCodeLine{02306\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component:}
\DoxyCodeLine{02307\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}depth\_component"{}};}
\DoxyCodeLine{02308\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component16:}
\DoxyCodeLine{02309\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}depth\_component16"{}};}
\DoxyCodeLine{02310\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component24:}
\DoxyCodeLine{02311\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}depth\_component24"{}};}
\DoxyCodeLine{02312\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component32:}
\DoxyCodeLine{02313\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}depth\_component32"{}};}
\DoxyCodeLine{02314\ \ \ \textcolor{keywordflow}{case}\ F\_color\_index:}
\DoxyCodeLine{02315\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}color\_index"{}};}
\DoxyCodeLine{02316\ \ \ \textcolor{keywordflow}{case}\ F\_red:}
\DoxyCodeLine{02317\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}red"{}};}
\DoxyCodeLine{02318\ \ \ \textcolor{keywordflow}{case}\ F\_green:}
\DoxyCodeLine{02319\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}green"{}};}
\DoxyCodeLine{02320\ \ \ \textcolor{keywordflow}{case}\ F\_blue:}
\DoxyCodeLine{02321\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}blue"{}};}
\DoxyCodeLine{02322\ \ \ \textcolor{keywordflow}{case}\ F\_alpha:}
\DoxyCodeLine{02323\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}alpha"{}};}
\DoxyCodeLine{02324\ \ \ \textcolor{keywordflow}{case}\ F\_rgb:}
\DoxyCodeLine{02325\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb"{}};}
\DoxyCodeLine{02326\ \ \ \textcolor{keywordflow}{case}\ F\_rgb5:}
\DoxyCodeLine{02327\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb5"{}};}
\DoxyCodeLine{02328\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8:}
\DoxyCodeLine{02329\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb8"{}};}
\DoxyCodeLine{02330\ \ \ \textcolor{keywordflow}{case}\ F\_rgb12:}
\DoxyCodeLine{02331\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb12"{}};}
\DoxyCodeLine{02332\ \ \ \textcolor{keywordflow}{case}\ F\_rgb332:}
\DoxyCodeLine{02333\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb332"{}};}
\DoxyCodeLine{02334\ \ \ \textcolor{keywordflow}{case}\ F\_rgba:}
\DoxyCodeLine{02335\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba"{}};}
\DoxyCodeLine{02336\ \ \ \textcolor{keywordflow}{case}\ F\_rgbm:}
\DoxyCodeLine{02337\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgbm"{}};}
\DoxyCodeLine{02338\ \ \ \textcolor{keywordflow}{case}\ F\_rgba4:}
\DoxyCodeLine{02339\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba4"{}};}
\DoxyCodeLine{02340\ \ \ \textcolor{keywordflow}{case}\ F\_rgba5:}
\DoxyCodeLine{02341\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba5"{}};}
\DoxyCodeLine{02342\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8:}
\DoxyCodeLine{02343\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba8"{}};}
\DoxyCodeLine{02344\ \ \ \textcolor{keywordflow}{case}\ F\_rgba12:}
\DoxyCodeLine{02345\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba12"{}};}
\DoxyCodeLine{02346\ \ \ \textcolor{keywordflow}{case}\ F\_luminance:}
\DoxyCodeLine{02347\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}luminance"{}};}
\DoxyCodeLine{02348\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alpha:}
\DoxyCodeLine{02349\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}luminance\_alpha"{}};}
\DoxyCodeLine{02350\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alphamask:}
\DoxyCodeLine{02351\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}luminance\_alphamask"{}};}
\DoxyCodeLine{02352\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16:}
\DoxyCodeLine{02353\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba16"{}};}
\DoxyCodeLine{02354\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32:}
\DoxyCodeLine{02355\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba32"{}};}
\DoxyCodeLine{02356\ \ \ \textcolor{keywordflow}{case}\ F\_r16:}
\DoxyCodeLine{02357\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r16"{}};}
\DoxyCodeLine{02358\ \ \ \textcolor{keywordflow}{case}\ F\_rg16:}
\DoxyCodeLine{02359\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg16"{}};}
\DoxyCodeLine{02360\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16:}
\DoxyCodeLine{02361\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb16"{}};}
\DoxyCodeLine{02362\ \ \ \textcolor{keywordflow}{case}\ F\_srgb:}
\DoxyCodeLine{02363\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}srgb"{}};}
\DoxyCodeLine{02364\ \ \ \textcolor{keywordflow}{case}\ F\_srgb\_alpha:}
\DoxyCodeLine{02365\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}srgb\_alpha"{}};}
\DoxyCodeLine{02366\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance:}
\DoxyCodeLine{02367\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}sluminance"{}};}
\DoxyCodeLine{02368\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance\_alpha:}
\DoxyCodeLine{02369\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}sluminance\_alpha"{}};}
\DoxyCodeLine{02370\ \ \ \textcolor{keywordflow}{case}\ F\_r32i:}
\DoxyCodeLine{02371\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r32i"{}};}
\DoxyCodeLine{02372\ \ \ \textcolor{keywordflow}{case}\ F\_r32:}
\DoxyCodeLine{02373\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r32"{}};}
\DoxyCodeLine{02374\ \ \ \textcolor{keywordflow}{case}\ F\_rg32:}
\DoxyCodeLine{02375\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg32"{}};}
\DoxyCodeLine{02376\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32:}
\DoxyCodeLine{02377\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb32"{}};}
\DoxyCodeLine{02378\ \ \ \textcolor{keywordflow}{case}\ F\_r8i:}
\DoxyCodeLine{02379\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r8i"{}};}
\DoxyCodeLine{02380\ \ \ \textcolor{keywordflow}{case}\ F\_rg8i:}
\DoxyCodeLine{02381\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg8i"{}};}
\DoxyCodeLine{02382\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8i:}
\DoxyCodeLine{02383\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb8i"{}};}
\DoxyCodeLine{02384\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8i:}
\DoxyCodeLine{02385\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba8i"{}};}
\DoxyCodeLine{02386\ \ \ \textcolor{keywordflow}{case}\ F\_r11\_g11\_b10:}
\DoxyCodeLine{02387\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r11g11b10"{}};}
\DoxyCodeLine{02388\ \ \ \textcolor{keywordflow}{case}\ F\_rgb9\_e5:}
\DoxyCodeLine{02389\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb9\_e5"{}};}
\DoxyCodeLine{02390\ \ \ \textcolor{keywordflow}{case}\ F\_rgb10\_a2:}
\DoxyCodeLine{02391\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb10\_a2"{}};}
\DoxyCodeLine{02392\ \ \ \textcolor{keywordflow}{case}\ F\_rg:}
\DoxyCodeLine{02393\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg"{}};}
\DoxyCodeLine{02394\ \ \ \textcolor{keywordflow}{case}\ F\_r16i:}
\DoxyCodeLine{02395\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}r16i"{}};}
\DoxyCodeLine{02396\ \ \ \textcolor{keywordflow}{case}\ F\_rg16i:}
\DoxyCodeLine{02397\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg16i"{}};}
\DoxyCodeLine{02398\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16i:}
\DoxyCodeLine{02399\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb16i"{}};}
\DoxyCodeLine{02400\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16i:}
\DoxyCodeLine{02401\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba16i"{}};}
\DoxyCodeLine{02402\ \ \ \textcolor{keywordflow}{case}\ F\_rg32i:}
\DoxyCodeLine{02403\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rg32i"{}};}
\DoxyCodeLine{02404\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32i:}
\DoxyCodeLine{02405\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgb32i"{}};}
\DoxyCodeLine{02406\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32i:}
\DoxyCodeLine{02407\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgba32i"{}};}
\DoxyCodeLine{02408\ \ \ \}}
\DoxyCodeLine{02409\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{02410\ \}}
\DoxyCodeLine{02411\ }
\DoxyCodeLine{02415\ Texture::Format\ \mbox{\hyperlink{classTexture_ae413e37bc35ffdf9bcaf1058cda5e962}{Texture::}}}
\DoxyCodeLine{02416\ \mbox{\hyperlink{classTexture_ae413e37bc35ffdf9bcaf1058cda5e962}{string\_format}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{02417\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}depth\_stencil"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02418\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_depth\_stencil;}
\DoxyCodeLine{02419\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}depth\_component"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02420\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_depth\_component;}
\DoxyCodeLine{02421\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}depth\_component16"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}d16"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02422\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_depth\_component16;}
\DoxyCodeLine{02423\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}depth\_component24"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}d24"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02424\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_depth\_component24;}
\DoxyCodeLine{02425\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}depth\_component32"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}d32"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02426\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_depth\_component32;}
\DoxyCodeLine{02427\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}color\_index"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02428\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_color\_index;}
\DoxyCodeLine{02429\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}red"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02430\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_red;}
\DoxyCodeLine{02431\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}green"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02432\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_green;}
\DoxyCodeLine{02433\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}blue"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02434\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_blue;}
\DoxyCodeLine{02435\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}alpha"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02436\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_alpha;}
\DoxyCodeLine{02437\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02438\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb;}
\DoxyCodeLine{02439\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb5"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02440\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb5;}
\DoxyCodeLine{02441\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb8"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r8g8b8"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02442\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb8;}
\DoxyCodeLine{02443\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb12"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02444\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb12;}
\DoxyCodeLine{02445\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb332"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r3g3b2"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02446\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb332;}
\DoxyCodeLine{02447\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02448\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba;}
\DoxyCodeLine{02449\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgbm"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02450\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgbm;}
\DoxyCodeLine{02451\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba4"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02452\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba4;}
\DoxyCodeLine{02453\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba5"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02454\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba5;}
\DoxyCodeLine{02455\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba8"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r8g8b8a8"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02456\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba8;}
\DoxyCodeLine{02457\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba12"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02458\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba12;}
\DoxyCodeLine{02459\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}luminance"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02460\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_luminance;}
\DoxyCodeLine{02461\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}luminance\_alpha"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02462\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_luminance\_alpha;}
\DoxyCodeLine{02463\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}luminance\_alphamask"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02464\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_luminance\_alphamask;}
\DoxyCodeLine{02465\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba16"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r16g16b16a16"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02466\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba16;}
\DoxyCodeLine{02467\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgba32"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r32g32b32a32"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02468\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba32;}
\DoxyCodeLine{02469\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r16"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}red16"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02470\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r16;}
\DoxyCodeLine{02471\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r16i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02472\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r16i;}
\DoxyCodeLine{02473\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rg16"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r16g16"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02474\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg16;}
\DoxyCodeLine{02475\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb16"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r16g16b16"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02476\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb16;}
\DoxyCodeLine{02477\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}srgb"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02478\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_srgb;}
\DoxyCodeLine{02479\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}srgb\_alpha"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02480\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_srgb\_alpha;}
\DoxyCodeLine{02481\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}sluminance"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02482\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_sluminance;}
\DoxyCodeLine{02483\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}sluminance\_alpha"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02484\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_sluminance\_alpha;}
\DoxyCodeLine{02485\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r32i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02486\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r32i;}
\DoxyCodeLine{02487\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r32"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}red32"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02488\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r32;}
\DoxyCodeLine{02489\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rg32"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r32g32"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02490\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg32;}
\DoxyCodeLine{02491\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb32"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r32g32b32"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02492\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb32;}
\DoxyCodeLine{02493\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r8i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02494\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r8i;}
\DoxyCodeLine{02495\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rg8i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r8g8i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02496\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg8i;}
\DoxyCodeLine{02497\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgb8i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r8g8b8i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02498\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb8i;}
\DoxyCodeLine{02499\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgba8i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r8g8b8a8i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02500\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba8i;}
\DoxyCodeLine{02501\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r11g11b10"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02502\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r11\_g11\_b10;}
\DoxyCodeLine{02503\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}rgb9\_e5"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02504\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb9\_e5;}
\DoxyCodeLine{02505\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgb10\_a2"{}})\ ==\ 0\ ||\ cmp\_nocase(str,\ \textcolor{stringliteral}{"{}r10g10b10a2"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02506\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb10\_a2;}
\DoxyCodeLine{02507\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rg"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02508\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg;}
\DoxyCodeLine{02509\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r16i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02510\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_r16i;}
\DoxyCodeLine{02511\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rg16i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r16g16i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02512\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg16i;}
\DoxyCodeLine{02513\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgb16i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r16g16b16i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02514\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb16i;}
\DoxyCodeLine{02515\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgba16i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r16g16b16a16i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02516\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba16i;}
\DoxyCodeLine{02517\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rg32i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r32g32i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02518\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rg32i;}
\DoxyCodeLine{02519\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgb32i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r32g32b32i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02520\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgb32i;}
\DoxyCodeLine{02521\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgba32i"{}})\ ==\ 0\ ||\ cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}r32g32b32a32i"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02522\ \ \ \ \ \textcolor{keywordflow}{return}\ F\_rgba32i;}
\DoxyCodeLine{02523\ \ \ \}}
\DoxyCodeLine{02524\ }
\DoxyCodeLine{02525\ \ \ gobj\_cat-\/>error()}
\DoxyCodeLine{02526\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::Format\ value:\ "{}}\ <<\ str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02527\ \ \ \textcolor{keywordflow}{return}\ F\_rgba;}
\DoxyCodeLine{02528\ \}}
\DoxyCodeLine{02529\ }
\DoxyCodeLine{02533\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classTexture_a476671416398601f7f1900687d4fafcf}{Texture::}}}
\DoxyCodeLine{02534\ \mbox{\hyperlink{classTexture_a476671416398601f7f1900687d4fafcf}{format\_compression\_mode}}(CompressionMode\ cm)\ \{}
\DoxyCodeLine{02535\ \ \ \textcolor{keywordflow}{switch}\ (cm)\ \{}
\DoxyCodeLine{02536\ \ \ \textcolor{keywordflow}{case}\ CM\_default:}
\DoxyCodeLine{02537\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}default"{}};}
\DoxyCodeLine{02538\ \ \ \textcolor{keywordflow}{case}\ CM\_off:}
\DoxyCodeLine{02539\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}off"{}};}
\DoxyCodeLine{02540\ \ \ \textcolor{keywordflow}{case}\ CM\_on:}
\DoxyCodeLine{02541\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}on"{}};}
\DoxyCodeLine{02542\ \ \ \textcolor{keywordflow}{case}\ CM\_fxt1:}
\DoxyCodeLine{02543\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}fxt1"{}};}
\DoxyCodeLine{02544\ \ \ \textcolor{keywordflow}{case}\ CM\_dxt1:}
\DoxyCodeLine{02545\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}dxt1"{}};}
\DoxyCodeLine{02546\ \ \ \textcolor{keywordflow}{case}\ CM\_dxt2:}
\DoxyCodeLine{02547\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}dxt2"{}};}
\DoxyCodeLine{02548\ \ \ \textcolor{keywordflow}{case}\ CM\_dxt3:}
\DoxyCodeLine{02549\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}dxt3"{}};}
\DoxyCodeLine{02550\ \ \ \textcolor{keywordflow}{case}\ CM\_dxt4:}
\DoxyCodeLine{02551\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}dxt4"{}};}
\DoxyCodeLine{02552\ \ \ \textcolor{keywordflow}{case}\ CM\_dxt5:}
\DoxyCodeLine{02553\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}dxt5"{}};}
\DoxyCodeLine{02554\ \ \ \textcolor{keywordflow}{case}\ CM\_pvr1\_2bpp:}
\DoxyCodeLine{02555\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}pvr1\_2bpp"{}};}
\DoxyCodeLine{02556\ \ \ \textcolor{keywordflow}{case}\ CM\_pvr1\_4bpp:}
\DoxyCodeLine{02557\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}pvr1\_4bpp"{}};}
\DoxyCodeLine{02558\ \ \ \textcolor{keywordflow}{case}\ CM\_rgtc:}
\DoxyCodeLine{02559\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}rgtc"{}};}
\DoxyCodeLine{02560\ \ \ \textcolor{keywordflow}{case}\ CM\_etc1:}
\DoxyCodeLine{02561\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}etc1"{}};}
\DoxyCodeLine{02562\ \ \ \textcolor{keywordflow}{case}\ CM\_etc2:}
\DoxyCodeLine{02563\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}etc2"{}};}
\DoxyCodeLine{02564\ \ \ \textcolor{keywordflow}{case}\ CM\_eac:}
\DoxyCodeLine{02565\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}eac"{}};}
\DoxyCodeLine{02566\ \ \ \}}
\DoxyCodeLine{02567\ }
\DoxyCodeLine{02568\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{02569\ \}}
\DoxyCodeLine{02570\ }
\DoxyCodeLine{02575\ Texture::CompressionMode\ \mbox{\hyperlink{classTexture_a2a3f367ca58f36efe532ddf1ed6211c7}{Texture::}}}
\DoxyCodeLine{02576\ \mbox{\hyperlink{classTexture_a2a3f367ca58f36efe532ddf1ed6211c7}{string\_compression\_mode}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{02577\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}default"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02578\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_default;}
\DoxyCodeLine{02579\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}off"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02580\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_off;}
\DoxyCodeLine{02581\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}on"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02582\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_on;}
\DoxyCodeLine{02583\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}fxt1"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02584\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_fxt1;}
\DoxyCodeLine{02585\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}dxt1"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02586\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_dxt1;}
\DoxyCodeLine{02587\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}dxt2"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02588\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_dxt2;}
\DoxyCodeLine{02589\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}dxt3"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02590\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_dxt3;}
\DoxyCodeLine{02591\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}dxt4"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02592\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_dxt4;}
\DoxyCodeLine{02593\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}dxt5"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02594\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_dxt5;}
\DoxyCodeLine{02595\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}pvr1\_2bpp"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02596\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_pvr1\_2bpp;}
\DoxyCodeLine{02597\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}pvr1\_4bpp"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02598\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_pvr1\_4bpp;}
\DoxyCodeLine{02599\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}rgtc"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02600\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_rgtc;}
\DoxyCodeLine{02601\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}etc1"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02602\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_etc1;}
\DoxyCodeLine{02603\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}etc2"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02604\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_etc2;}
\DoxyCodeLine{02605\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase\_uh(str,\ \textcolor{stringliteral}{"{}eac"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02606\ \ \ \ \ \textcolor{keywordflow}{return}\ CM\_eac;}
\DoxyCodeLine{02607\ \ \ \}}
\DoxyCodeLine{02608\ }
\DoxyCodeLine{02609\ \ \ gobj\_cat-\/>error()}
\DoxyCodeLine{02610\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::CompressionMode\ value:\ "{}}\ <<\ str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02611\ \ \ \textcolor{keywordflow}{return}\ CM\_default;}
\DoxyCodeLine{02612\ \}}
\DoxyCodeLine{02613\ }
\DoxyCodeLine{02614\ }
\DoxyCodeLine{02618\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classTexture_a3c766453bc4b9039b3db798eecb41a43}{Texture::}}}
\DoxyCodeLine{02619\ \mbox{\hyperlink{classTexture_a3c766453bc4b9039b3db798eecb41a43}{format\_quality\_level}}(QualityLevel\ ql)\ \{}
\DoxyCodeLine{02620\ \ \ \textcolor{keywordflow}{switch}\ (ql)\ \{}
\DoxyCodeLine{02621\ \ \ \textcolor{keywordflow}{case}\ QL\_default:}
\DoxyCodeLine{02622\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}default"{}};}
\DoxyCodeLine{02623\ \ \ \textcolor{keywordflow}{case}\ QL\_fastest:}
\DoxyCodeLine{02624\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}fastest"{}};}
\DoxyCodeLine{02625\ \ \ \textcolor{keywordflow}{case}\ QL\_normal:}
\DoxyCodeLine{02626\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}normal"{}};}
\DoxyCodeLine{02627\ \ \ \textcolor{keywordflow}{case}\ QL\_best:}
\DoxyCodeLine{02628\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}best"{}};}
\DoxyCodeLine{02629\ \ \ \}}
\DoxyCodeLine{02630\ }
\DoxyCodeLine{02631\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{02632\ \}}
\DoxyCodeLine{02633\ }
\DoxyCodeLine{02638\ Texture::QualityLevel\ \mbox{\hyperlink{classTexture_a741de95224905db2590dbcdba235c699}{Texture::}}}
\DoxyCodeLine{02639\ \mbox{\hyperlink{classTexture_a741de95224905db2590dbcdba235c699}{string\_quality\_level}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{02640\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}default"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02641\ \ \ \ \ \textcolor{keywordflow}{return}\ QL\_default;}
\DoxyCodeLine{02642\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}fastest"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02643\ \ \ \ \ \textcolor{keywordflow}{return}\ QL\_fastest;}
\DoxyCodeLine{02644\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}normal"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02645\ \ \ \ \ \textcolor{keywordflow}{return}\ QL\_normal;}
\DoxyCodeLine{02646\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(str,\ \textcolor{stringliteral}{"{}best"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{02647\ \ \ \ \ \textcolor{keywordflow}{return}\ QL\_best;}
\DoxyCodeLine{02648\ \ \ \}}
\DoxyCodeLine{02649\ }
\DoxyCodeLine{02650\ \ \ gobj\_cat-\/>error()}
\DoxyCodeLine{02651\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::QualityLevel\ value:\ "{}}\ <<\ str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02652\ \ \ \textcolor{keywordflow}{return}\ QL\_default;}
\DoxyCodeLine{02653\ \}}
\DoxyCodeLine{02654\ }
\DoxyCodeLine{02664\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ad6ecc4b0a99d621f86cea8a21ef4ea6f}{Texture::}}}
\DoxyCodeLine{02665\ \mbox{\hyperlink{classTexture_ad6ecc4b0a99d621f86cea8a21ef4ea6f}{texture\_uploaded}}()\ \{}
\DoxyCodeLine{02666\ \ \ \mbox{\hyperlink{classCycleDataLockedReader}{CDLockedReader}}\ cdata(\_cycler);}
\DoxyCodeLine{02667\ }
\DoxyCodeLine{02668\ \ \ \textcolor{keywordflow}{if}\ (!keep\_texture\_ram\ \&\&\ !cdata-\/>\_keep\_ram\_image)\ \{}
\DoxyCodeLine{02669\ \ \ \ \ \textcolor{comment}{//\ Once\ we\ have\ prepared\ the\ texture,\ we\ can\ generally\ safely\ remove\ the}}
\DoxyCodeLine{02670\ \ \ \ \ \textcolor{comment}{//\ pixels\ from\ main\ RAM.\ \ The\ GSG\ is\ now\ responsible\ for\ remembering\ what}}
\DoxyCodeLine{02671\ \ \ \ \ \textcolor{comment}{//\ it\ looks\ like.}}
\DoxyCodeLine{02672\ }
\DoxyCodeLine{02673\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdataw(\_cycler,\ cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02674\ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{02675\ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Dumping\ RAM\ for\ texture\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{02677\ \ \ \ \ \}}
\DoxyCodeLine{02678\ \ \ \ \ do\_clear\_ram\_image(cdataw);}
\DoxyCodeLine{02679\ \ \ \}}
\DoxyCodeLine{02680\ \}}
\DoxyCodeLine{02681\ }
\DoxyCodeLine{02687\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_aa529889cdbaf2f49b09a1304c0a463c6}{Texture::}}}
\DoxyCodeLine{02688\ \mbox{\hyperlink{classTexture_aa529889cdbaf2f49b09a1304c0a463c6}{has\_cull\_callback}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02689\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02690\ \}}
\DoxyCodeLine{02691\ }
\DoxyCodeLine{02701\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_ac8661ba5655ccf1a1e34e46c31461ded}{Texture::}}}
\DoxyCodeLine{02702\ \mbox{\hyperlink{classTexture_ac8661ba5655ccf1a1e34e46c31461ded}{cull\_callback}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02703\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02704\ \}}
\DoxyCodeLine{02705\ }
\DoxyCodeLine{02709\ PT(\mbox{\hyperlink{classTexture}{Texture}})\ Texture::}
\DoxyCodeLine{02710\ make\_texture()\ \{}
\DoxyCodeLine{02711\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture}};}
\DoxyCodeLine{02712\ \}}
\DoxyCodeLine{02713\ }
\DoxyCodeLine{02717\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::}}}
\DoxyCodeLine{02718\ \mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{is\_unsigned}}(Texture::ComponentType\ ctype)\ \{}
\DoxyCodeLine{02719\ \ \ \textcolor{keywordflow}{return}\ (ctype\ ==\ T\_unsigned\_byte\ ||}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ ctype\ ==\ T\_unsigned\_short\ ||}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ ctype\ ==\ T\_unsigned\_int\_24\_8\ ||}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \ \ ctype\ ==\ T\_unsigned\_int);}
\DoxyCodeLine{02723\ \}}
\DoxyCodeLine{02724\ }
\DoxyCodeLine{02729\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a31b10b705252bac58ff65e5be9b890bd}{Texture::}}}
\DoxyCodeLine{02730\ \mbox{\hyperlink{classTexture_a31b10b705252bac58ff65e5be9b890bd}{is\_specific}}(Texture::CompressionMode\ compression)\ \{}
\DoxyCodeLine{02731\ \ \ \textcolor{keywordflow}{switch}\ (compression)\ \{}
\DoxyCodeLine{02732\ \ \ \textcolor{keywordflow}{case}\ CM\_default:}
\DoxyCodeLine{02733\ \ \ \textcolor{keywordflow}{case}\ CM\_off:}
\DoxyCodeLine{02734\ \ \ \textcolor{keywordflow}{case}\ CM\_on:}
\DoxyCodeLine{02735\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02738\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02739\ \ \ \}}
\DoxyCodeLine{02740\ \}}
\DoxyCodeLine{02741\ }
\DoxyCodeLine{02745\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::}}}
\DoxyCodeLine{02746\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}(Format\ format)\ \{}
\DoxyCodeLine{02747\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{02748\ \ \ \textcolor{keywordflow}{case}\ F\_alpha:}
\DoxyCodeLine{02749\ \ \ \textcolor{keywordflow}{case}\ F\_rgba:}
\DoxyCodeLine{02750\ \ \ \textcolor{keywordflow}{case}\ F\_rgbm:}
\DoxyCodeLine{02751\ \ \ \textcolor{keywordflow}{case}\ F\_rgba4:}
\DoxyCodeLine{02752\ \ \ \textcolor{keywordflow}{case}\ F\_rgba5:}
\DoxyCodeLine{02753\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8:}
\DoxyCodeLine{02754\ \ \ \textcolor{keywordflow}{case}\ F\_rgba12:}
\DoxyCodeLine{02755\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16:}
\DoxyCodeLine{02756\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32:}
\DoxyCodeLine{02757\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alpha:}
\DoxyCodeLine{02758\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alphamask:}
\DoxyCodeLine{02759\ \ \ \textcolor{keywordflow}{case}\ F\_srgb\_alpha:}
\DoxyCodeLine{02760\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance\_alpha:}
\DoxyCodeLine{02761\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8i:}
\DoxyCodeLine{02762\ \ \ \textcolor{keywordflow}{case}\ F\_rgb10\_a2:}
\DoxyCodeLine{02763\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16i:}
\DoxyCodeLine{02764\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32i:}
\DoxyCodeLine{02765\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02766\ }
\DoxyCodeLine{02767\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02768\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02769\ \ \ \}}
\DoxyCodeLine{02770\ \}}
\DoxyCodeLine{02771\ }
\DoxyCodeLine{02776\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a42f7cafe7c633fa476399c12381e9179}{Texture::}}}
\DoxyCodeLine{02777\ \mbox{\hyperlink{classTexture_a42f7cafe7c633fa476399c12381e9179}{has\_binary\_alpha}}(Format\ format)\ \{}
\DoxyCodeLine{02778\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{02779\ \ \ \textcolor{keywordflow}{case}\ F\_rgbm:}
\DoxyCodeLine{02780\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02781\ }
\DoxyCodeLine{02782\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02783\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02784\ \ \ \}}
\DoxyCodeLine{02785\ \}}
\DoxyCodeLine{02786\ }
\DoxyCodeLine{02791\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{Texture::}}}
\DoxyCodeLine{02792\ \mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(Format\ format)\ \{}
\DoxyCodeLine{02793\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{02794\ \ \ \textcolor{keywordflow}{case}\ F\_srgb:}
\DoxyCodeLine{02795\ \ \ \textcolor{keywordflow}{case}\ F\_srgb\_alpha:}
\DoxyCodeLine{02796\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance:}
\DoxyCodeLine{02797\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance\_alpha:}
\DoxyCodeLine{02798\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02799\ }
\DoxyCodeLine{02800\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02801\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02802\ \ \ \}}
\DoxyCodeLine{02803\ \}}
\DoxyCodeLine{02804\ }
\DoxyCodeLine{02808\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_ab79a121187081015be45d321509da170}{Texture::}}}
\DoxyCodeLine{02809\ \mbox{\hyperlink{classTexture_ab79a121187081015be45d321509da170}{is\_integer}}(Format\ format)\ \{}
\DoxyCodeLine{02810\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{02811\ \ \ \textcolor{keywordflow}{case}\ F\_r32i:}
\DoxyCodeLine{02812\ \ \ \textcolor{keywordflow}{case}\ F\_r8i:}
\DoxyCodeLine{02813\ \ \ \textcolor{keywordflow}{case}\ F\_rg8i:}
\DoxyCodeLine{02814\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8i:}
\DoxyCodeLine{02815\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8i:}
\DoxyCodeLine{02816\ \ \ \textcolor{keywordflow}{case}\ F\_r16i:}
\DoxyCodeLine{02817\ \ \ \textcolor{keywordflow}{case}\ F\_rg16i:}
\DoxyCodeLine{02818\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16i:}
\DoxyCodeLine{02819\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16i:}
\DoxyCodeLine{02820\ \ \ \textcolor{keywordflow}{case}\ F\_rg32i:}
\DoxyCodeLine{02821\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32i:}
\DoxyCodeLine{02822\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32i:}
\DoxyCodeLine{02823\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02824\ }
\DoxyCodeLine{02825\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{02826\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02827\ \ \ \}}
\DoxyCodeLine{02828\ \}}
\DoxyCodeLine{02829\ }
\DoxyCodeLine{02839\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{Texture::}}}
\DoxyCodeLine{02840\ \mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{adjust\_size}}(\textcolor{keywordtype}{int}\ \&x\_size,\ \textcolor{keywordtype}{int}\ \&y\_size,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,}
\DoxyCodeLine{02841\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ for\_padding,\ AutoTextureScale\ auto\_texture\_scale)\ \{}
\DoxyCodeLine{02842\ \ \ \textcolor{keywordtype}{bool}\ exclude\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02843\ \ \ \textcolor{keywordtype}{int}\ num\_excludes\ =\ exclude\_texture\_scale.get\_num\_unique\_values();}
\DoxyCodeLine{02844\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_excludes\ \&\&\ !exclude;\ ++i)\ \{}
\DoxyCodeLine{02845\ \ \ \ \ \mbox{\hyperlink{classGlobPattern}{GlobPattern}}\ pat(exclude\_texture\_scale.get\_unique\_value(i));}
\DoxyCodeLine{02846\ \ \ \ \ \textcolor{keywordflow}{if}\ (pat.matches(name))\ \{}
\DoxyCodeLine{02847\ \ \ \ \ \ \ exclude\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02848\ \ \ \ \ \}}
\DoxyCodeLine{02849\ \ \ \}}
\DoxyCodeLine{02850\ }
\DoxyCodeLine{02851\ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ x\_size;}
\DoxyCodeLine{02852\ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ y\_size;}
\DoxyCodeLine{02853\ }
\DoxyCodeLine{02854\ \ \ \textcolor{keywordflow}{if}\ (!exclude)\ \{}
\DoxyCodeLine{02855\ \ \ \ \ new\_x\_size\ =\ (int)cfloor(new\_x\_size\ *\ texture\_scale\ +\ 0.5);}
\DoxyCodeLine{02856\ \ \ \ \ new\_y\_size\ =\ (int)cfloor(new\_y\_size\ *\ texture\_scale\ +\ 0.5);}
\DoxyCodeLine{02857\ }
\DoxyCodeLine{02858\ \ \ \ \ \textcolor{comment}{//\ Don't\ auto-\/scale\ below\ 4\ in\ either\ dimension.\ \ This\ causes\ problems\ for}}
\DoxyCodeLine{02859\ \ \ \ \ \textcolor{comment}{//\ DirectX\ and\ texture\ compression.}}
\DoxyCodeLine{02860\ \ \ \ \ new\_x\_size\ =\ min(max(new\_x\_size,\ (\textcolor{keywordtype}{int})texture\_scale\_limit),\ x\_size);}
\DoxyCodeLine{02861\ \ \ \ \ new\_y\_size\ =\ min(max(new\_y\_size,\ (\textcolor{keywordtype}{int})texture\_scale\_limit),\ y\_size);}
\DoxyCodeLine{02862\ \ \ \}}
\DoxyCodeLine{02863\ }
\DoxyCodeLine{02864\ \ \ AutoTextureScale\ ats\ =\ auto\_texture\_scale;}
\DoxyCodeLine{02865\ \ \ \textcolor{keywordflow}{if}\ (ats\ ==\ ATS\_unspecified)\ \{}
\DoxyCodeLine{02866\ \ \ \ \ ats\ =\ get\_textures\_power\_2();}
\DoxyCodeLine{02867\ \ \ \}}
\DoxyCodeLine{02868\ \ \ \textcolor{keywordflow}{if}\ (!for\_padding\ \&\&\ ats\ ==\ ATS\_pad)\ \{}
\DoxyCodeLine{02869\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ not\ calculating\ the\ padding\ size-\/-\/that\ is,\ we're\ calculating}}
\DoxyCodeLine{02870\ \ \ \ \ \textcolor{comment}{//\ the\ initial\ scaling\ size\ instead-\/-\/then\ ignore\ ATS\_pad,\ and\ treat\ it\ the}}
\DoxyCodeLine{02871\ \ \ \ \ \textcolor{comment}{//\ same\ as\ ATS\_none.}}
\DoxyCodeLine{02872\ \ \ \ \ ats\ =\ ATS\_none;}
\DoxyCodeLine{02873\ \ \ \}}
\DoxyCodeLine{02874\ }
\DoxyCodeLine{02875\ \ \ \textcolor{keywordflow}{switch}\ (ats)\ \{}
\DoxyCodeLine{02876\ \ \ \textcolor{keywordflow}{case}\ ATS\_down:}
\DoxyCodeLine{02877\ \ \ \ \ new\_x\_size\ =\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{down\_to\_power\_2}}(new\_x\_size);}
\DoxyCodeLine{02878\ \ \ \ \ new\_y\_size\ =\ \mbox{\hyperlink{classTexture_aa21f1ae42b88c63f6a56c5cd169c9604}{down\_to\_power\_2}}(new\_y\_size);}
\DoxyCodeLine{02879\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02880\ }
\DoxyCodeLine{02881\ \ \ \textcolor{keywordflow}{case}\ ATS\_up:}
\DoxyCodeLine{02882\ \ \ \textcolor{keywordflow}{case}\ ATS\_pad:}
\DoxyCodeLine{02883\ \ \ \ \ new\_x\_size\ =\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(new\_x\_size);}
\DoxyCodeLine{02884\ \ \ \ \ new\_y\_size\ =\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{up\_to\_power\_2}}(new\_y\_size);}
\DoxyCodeLine{02885\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02886\ }
\DoxyCodeLine{02887\ \ \ \textcolor{keywordflow}{case}\ ATS\_none:}
\DoxyCodeLine{02888\ \ \ \textcolor{keywordflow}{case}\ ATS\_unspecified:}
\DoxyCodeLine{02889\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02890\ \ \ \}}
\DoxyCodeLine{02891\ }
\DoxyCodeLine{02892\ \ \ ats\ =\ textures\_square.get\_value();}
\DoxyCodeLine{02893\ \ \ \textcolor{keywordflow}{if}\ (!for\_padding\ \&\&\ ats\ ==\ ATS\_pad)\ \{}
\DoxyCodeLine{02894\ \ \ \ \ ats\ =\ ATS\_none;}
\DoxyCodeLine{02895\ \ \ \}}
\DoxyCodeLine{02896\ \ \ \textcolor{keywordflow}{switch}\ (ats)\ \{}
\DoxyCodeLine{02897\ \ \ \textcolor{keywordflow}{case}\ ATS\_down:}
\DoxyCodeLine{02898\ \ \ \ \ new\_x\_size\ =\ new\_y\_size\ =\ min(new\_x\_size,\ new\_y\_size);}
\DoxyCodeLine{02899\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02900\ }
\DoxyCodeLine{02901\ \ \ \textcolor{keywordflow}{case}\ ATS\_up:}
\DoxyCodeLine{02902\ \ \ \textcolor{keywordflow}{case}\ ATS\_pad:}
\DoxyCodeLine{02903\ \ \ \ \ new\_x\_size\ =\ new\_y\_size\ =\ max(new\_x\_size,\ new\_y\_size);}
\DoxyCodeLine{02904\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02905\ }
\DoxyCodeLine{02906\ \ \ \textcolor{keywordflow}{case}\ ATS\_none:}
\DoxyCodeLine{02907\ \ \ \textcolor{keywordflow}{case}\ ATS\_unspecified:}
\DoxyCodeLine{02908\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02909\ \ \ \}}
\DoxyCodeLine{02910\ }
\DoxyCodeLine{02911\ \ \ \textcolor{keywordflow}{if}\ (!exclude)\ \{}
\DoxyCodeLine{02912\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_dimension\ =\ max\_texture\_dimension;}
\DoxyCodeLine{02913\ }
\DoxyCodeLine{02914\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_dimension\ <\ 0)\ \{}
\DoxyCodeLine{02915\ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg\ =\ GraphicsStateGuardianBase::get\_default\_gsg();}
\DoxyCodeLine{02916\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gsg\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02917\ \ \ \ \ \ \ \ \ max\_dimension\ =\ gsg-\/>get\_max\_texture\_dimension();}
\DoxyCodeLine{02918\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02919\ \ \ \ \ \}}
\DoxyCodeLine{02920\ }
\DoxyCodeLine{02921\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_dimension\ >\ 0)\ \{}
\DoxyCodeLine{02922\ \ \ \ \ \ \ new\_x\_size\ =\ min(new\_x\_size,\ (\textcolor{keywordtype}{int})max\_dimension);}
\DoxyCodeLine{02923\ \ \ \ \ \ \ new\_y\_size\ =\ min(new\_y\_size,\ (\textcolor{keywordtype}{int})max\_dimension);}
\DoxyCodeLine{02924\ \ \ \ \ \}}
\DoxyCodeLine{02925\ \ \ \}}
\DoxyCodeLine{02926\ }
\DoxyCodeLine{02927\ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ new\_x\_size\ ||\ y\_size\ !=\ new\_y\_size)\ \{}
\DoxyCodeLine{02928\ \ \ \ \ x\_size\ =\ new\_x\_size;}
\DoxyCodeLine{02929\ \ \ \ \ y\_size\ =\ new\_y\_size;}
\DoxyCodeLine{02930\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02931\ \ \ \}}
\DoxyCodeLine{02932\ }
\DoxyCodeLine{02933\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02934\ \}}
\DoxyCodeLine{02935\ }
\DoxyCodeLine{02949\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a08237442012d6db696a5c98f17307627}{Texture::}}}
\DoxyCodeLine{02950\ \mbox{\hyperlink{classTexture_a08237442012d6db696a5c98f17307627}{ensure\_loader\_type}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename)\ \{}
\DoxyCodeLine{02951\ \ \ \textcolor{comment}{//\ For\ a\ plain\ Texture\ type,\ this\ doesn't\ need\ to\ do\ anything.}}
\DoxyCodeLine{02952\ \}}
\DoxyCodeLine{02953\ }
\DoxyCodeLine{02958\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ada82717e64d95d56e5fb6cd848dd6176}{Texture::}}}
\DoxyCodeLine{02959\ \mbox{\hyperlink{classTexture_ada82717e64d95d56e5fb6cd848dd6176}{reconsider\_dirty}}()\ \{}
\DoxyCodeLine{02960\ \}}
\DoxyCodeLine{02961\ }
\DoxyCodeLine{02967\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{Texture::}}}
\DoxyCodeLine{02968\ \mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{do\_adjust\_this\_size}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{int}\ \&x\_size,\ \textcolor{keywordtype}{int}\ \&y\_size,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,}
\DoxyCodeLine{02969\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ for\_padding)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02970\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{adjust\_size}}(x\_size,\ y\_size,\ name,\ for\_padding,\ cdata-\/>\_auto\_texture\_scale);}
\DoxyCodeLine{02971\ \}}
\DoxyCodeLine{02972\ }
\DoxyCodeLine{02976\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{Texture::}}}
\DoxyCodeLine{02977\ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&alpha\_fullpath,}
\DoxyCodeLine{02978\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ primary\_file\_num\_channels,\ \textcolor{keywordtype}{int}\ alpha\_file\_channel,}
\DoxyCodeLine{02979\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{bool}\ read\_pages,\ \textcolor{keywordtype}{bool}\ read\_mipmaps,}
\DoxyCodeLine{02980\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options,\ \mbox{\hyperlink{classBamCacheRecord}{BamCacheRecord}}\ *record)\ \{}
\DoxyCodeLine{02981\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_texture\_read\_pcollector);}
\DoxyCodeLine{02982\ }
\DoxyCodeLine{02983\ \ \ \textcolor{keywordflow}{if}\ (options.get\_auto\_texture\_scale()\ !=\ ATS\_unspecified)\ \{}
\DoxyCodeLine{02984\ \ \ \ \ cdata-\/>\_auto\_texture\_scale\ =\ options.get\_auto\_texture\_scale();}
\DoxyCodeLine{02985\ \ \ \}}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \ \ \textcolor{keywordtype}{bool}\ header\_only\ =\ ((options.get\_texture\_flags()\ \&\ (LoaderOptions::TF\_preload\ |\ LoaderOptions::TF\_preload\_simple))\ ==\ 0);}
\DoxyCodeLine{02988\ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02989\ \ \ \ \ header\_only\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02990\ \ \ \}}
\DoxyCodeLine{02991\ }
\DoxyCodeLine{02992\ \ \ \textcolor{keywordflow}{if}\ ((z\ ==\ 0\ ||\ read\_pages)\ \&\&\ (n\ ==\ 0\ ||\ read\_mipmaps))\ \{}
\DoxyCodeLine{02993\ \ \ \ \ \textcolor{comment}{//\ When\ we\ re-\/read\ the\ page\ 0\ of\ the\ base\ image,\ we\ clear\ everything\ and}}
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{comment}{//\ start\ over.}}
\DoxyCodeLine{02995\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{02996\ \ \ \}}
\DoxyCodeLine{02997\ }
\DoxyCodeLine{02998\ \ \ \textcolor{keywordflow}{if}\ (is\_txo\_filename(fullpath))\ \{}
\DoxyCodeLine{02999\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03000\ \ \ \ \ \ \ record-\/>add\_dependent\_file(fullpath);}
\DoxyCodeLine{03001\ \ \ \ \ \}}
\DoxyCodeLine{03002\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_ade13ce0f0bc1ad2378b3f437850bb0d0}{do\_read\_txo\_file}}(cdata,\ fullpath);}
\DoxyCodeLine{03003\ \ \ \}}
\DoxyCodeLine{03004\ }
\DoxyCodeLine{03005\ \ \ \textcolor{keywordflow}{if}\ (is\_dds\_filename(fullpath))\ \{}
\DoxyCodeLine{03006\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03007\ \ \ \ \ \ \ record-\/>add\_dependent\_file(fullpath);}
\DoxyCodeLine{03008\ \ \ \ \ \}}
\DoxyCodeLine{03009\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_acb328183683d20f6dfb5a0aecfac3c5c}{do\_read\_dds\_file}}(cdata,\ fullpath,\ header\_only);}
\DoxyCodeLine{03010\ \ \ \}}
\DoxyCodeLine{03011\ }
\DoxyCodeLine{03012\ \ \ \textcolor{keywordflow}{if}\ (is\_ktx\_filename(fullpath))\ \{}
\DoxyCodeLine{03013\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03014\ \ \ \ \ \ \ record-\/>add\_dependent\_file(fullpath);}
\DoxyCodeLine{03015\ \ \ \ \ \}}
\DoxyCodeLine{03016\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a07be74f08244328f8ca9d9404dfa7825}{do\_read\_ktx\_file}}(cdata,\ fullpath,\ header\_only);}
\DoxyCodeLine{03017\ \ \ \}}
\DoxyCodeLine{03018\ }
\DoxyCodeLine{03019\ \ \ \textcolor{comment}{//\ If\ read\_pages\ or\ read\_mipmaps\ is\ specified,\ then\ z\ and\ n\ actually}}
\DoxyCodeLine{03020\ \ \ \textcolor{comment}{//\ indicate\ z\_size\ and\ n\_size,\ respectively-\/-\/the\ numerical\ limits\ on\ which}}
\DoxyCodeLine{03021\ \ \ \textcolor{comment}{//\ to\ search\ for\ filenames.}}
\DoxyCodeLine{03022\ \ \ \textcolor{keywordtype}{int}\ z\_size\ =\ z;}
\DoxyCodeLine{03023\ \ \ \textcolor{keywordtype}{int}\ n\_size\ =\ n;}
\DoxyCodeLine{03024\ }
\DoxyCodeLine{03025\ \ \ \textcolor{comment}{//\ Certain\ texture\ types\ have\ an\ implicit\ z\_size.\ \ If\ z\_size\ is\ omitted,}}
\DoxyCodeLine{03026\ \ \ \textcolor{comment}{//\ choose\ an\ appropriate\ default\ based\ on\ the\ texture\ type.}}
\DoxyCodeLine{03027\ \ \ \textcolor{keywordflow}{if}\ (z\_size\ ==\ 0)\ \{}
\DoxyCodeLine{03028\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_texture\_type)\ \{}
\DoxyCodeLine{03029\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{03030\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture:}
\DoxyCodeLine{03031\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{03032\ \ \ \ \ \ \ z\_size\ =\ 1;}
\DoxyCodeLine{03033\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03034\ }
\DoxyCodeLine{03035\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{03036\ \ \ \ \ \ \ z\_size\ =\ 6;}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03038\ }
\DoxyCodeLine{03039\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03040\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03041\ \ \ \ \ \}}
\DoxyCodeLine{03042\ \ \ \}}
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \ \ \textcolor{keywordtype}{int}\ num\_views\ =\ 0;}
\DoxyCodeLine{03045\ \ \ \textcolor{keywordflow}{if}\ (options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_multiview)\ \{}
\DoxyCodeLine{03046\ \ \ \ \ \textcolor{comment}{//\ We'll\ be\ loading\ a\ multiview\ texture.}}
\DoxyCodeLine{03047\ \ \ \ \ read\_pages\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03048\ \ \ \ \ \textcolor{keywordflow}{if}\ (options.get\_texture\_num\_views()\ !=\ 0)\ \{}
\DoxyCodeLine{03049\ \ \ \ \ \ \ num\_views\ =\ options.get\_texture\_num\_views();}
\DoxyCodeLine{03050\ \ \ \ \ \ \ do\_set\_num\_views(cdata,\ num\_views);}
\DoxyCodeLine{03051\ \ \ \ \ \}}
\DoxyCodeLine{03052\ \ \ \}}
\DoxyCodeLine{03053\ }
\DoxyCodeLine{03054\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \ \ \textcolor{keywordflow}{if}\ (read\_pages\ \&\&\ read\_mipmaps)\ \{}
\DoxyCodeLine{03057\ \ \ \ \ \textcolor{comment}{//\ Read\ a\ sequence\ of\ pages\ *\ mipmap\ levels.}}
\DoxyCodeLine{03058\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{03059\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_fullpath\_pattern\ =\ Filename::pattern\_filename(alpha\_fullpath);}
\DoxyCodeLine{03060\ \ \ \ \ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(cdata,\ z\_size);}
\DoxyCodeLine{03061\ }
\DoxyCodeLine{03062\ \ \ \ \ n\ =\ 0;}
\DoxyCodeLine{03063\ \ \ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ mipmap\ level\ 0,\ the\ total\ number\ of\ pages\ might\ be\ determined\ by}}
\DoxyCodeLine{03065\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ number\ of\ files\ we\ find.\ \ After\ mipmap\ level\ 0,\ though,\ the}}
\DoxyCodeLine{03066\ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ pages\ is\ predetermined.}}
\DoxyCodeLine{03067\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ !=\ 0)\ \{}
\DoxyCodeLine{03068\ \ \ \ \ \ \ \ \ z\_size\ =\ do\_get\_expected\_mipmap\_z\_size(cdata,\ n);}
\DoxyCodeLine{03069\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03070\ }
\DoxyCodeLine{03071\ \ \ \ \ \ \ z\ =\ 0;}
\DoxyCodeLine{03072\ }
\DoxyCodeLine{03073\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ n\_pattern\ =\ Filename::pattern\_filename(fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z));}
\DoxyCodeLine{03074\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_n\_pattern\ =\ Filename::pattern\_filename(alpha\_fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z));}
\DoxyCodeLine{03075\ }
\DoxyCodeLine{03076\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!n\_pattern.has\_hash())\ \{}
\DoxyCodeLine{03077\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03078\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ two\ different\ hash\ sequences:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{03079\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03080\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03081\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03082\ }
\DoxyCodeLine{03083\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ file\ =\ n\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03084\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_file\ =\ alpha\_n\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03085\ }
\DoxyCodeLine{03086\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((n\_size\ ==\ 0\ \&\&\ (vfs-\/>exists(file)\ ||\ n\ ==\ 0))\ ||}
\DoxyCodeLine{03087\ \ \ \ \ \ \ \ \ \ \ (n\_size\ !=\ 0\ \&\&\ n\ <\ n\_size))\ \{}
\DoxyCodeLine{03088\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Continue\ through\ the\ loop.}}
\DoxyCodeLine{03089\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03090\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We've\ reached\ the\ end\ of\ the\ mipmap\ sequence.}}
\DoxyCodeLine{03091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03092\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03093\ }
\DoxyCodeLine{03094\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ z\_size\ *\ num\_views;}
\DoxyCodeLine{03095\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ ((num\_pages\ ==\ 0\ \&\&\ (vfs-\/>exists(file)\ ||\ z\ ==\ 0))\ ||}
\DoxyCodeLine{03096\ \ \ \ \ \ \ \ \ \ \ \ \ \ (num\_pages\ !=\ 0\ \&\&\ z\ <\ num\_pages))\ \{}
\DoxyCodeLine{03097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{do\_read\_one}}(cdata,\ file,\ alpha\_file,\ z,\ n,\ primary\_file\_num\_channels,}
\DoxyCodeLine{03098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,\ options,\ header\_only,\ record))\ \{}
\DoxyCodeLine{03099\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03101\ \ \ \ \ \ \ \ \ ++z;}
\DoxyCodeLine{03102\ }
\DoxyCodeLine{03103\ \ \ \ \ \ \ \ \ n\_pattern\ =\ Filename::pattern\_filename(fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z));}
\DoxyCodeLine{03104\ \ \ \ \ \ \ \ \ file\ =\ n\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03105\ \ \ \ \ \ \ \ \ alpha\_file\ =\ alpha\_n\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03106\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03107\ }
\DoxyCodeLine{03108\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0\ \&\&\ n\_size\ ==\ 0)\ \{}
\DoxyCodeLine{03109\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ n\_size\ is\ not\ specified,\ it\ gets\ implicitly\ set\ after\ we\ read}}
\DoxyCodeLine{03110\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ base\ texture\ image\ (which\ determines\ the\ size\ of\ the\ texture).}}
\DoxyCodeLine{03111\ \ \ \ \ \ \ \ \ n\_size\ =\ do\_get\_expected\_num\_mipmap\_levels(cdata);}
\DoxyCodeLine{03112\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03113\ \ \ \ \ \ \ ++n;}
\DoxyCodeLine{03114\ \ \ \ \ \}}
\DoxyCodeLine{03115\ \ \ \ \ cdata-\/>\_fullpath\ =\ fullpath\_pattern;}
\DoxyCodeLine{03116\ \ \ \ \ cdata-\/>\_alpha\_fullpath\ =\ alpha\_fullpath\_pattern;}
\DoxyCodeLine{03117\ }
\DoxyCodeLine{03118\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (read\_pages)\ \{}
\DoxyCodeLine{03119\ \ \ \ \ \textcolor{comment}{//\ Read\ a\ sequence\ of\ cube\ map\ or\ 3-\/D\ texture\ pages.}}
\DoxyCodeLine{03120\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{03121\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_fullpath\_pattern\ =\ Filename::pattern\_filename(alpha\_fullpath);}
\DoxyCodeLine{03122\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fullpath\_pattern.has\_hash())\ \{}
\DoxyCodeLine{03123\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03124\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ a\ hash\ mark:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{03125\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03126\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03127\ \ \ \ \ \}}
\DoxyCodeLine{03128\ }
\DoxyCodeLine{03129\ \ \ \ \ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(cdata,\ z\_size);}
\DoxyCodeLine{03130\ \ \ \ \ z\ =\ 0;}
\DoxyCodeLine{03131\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ file\ =\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z);}
\DoxyCodeLine{03132\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_file\ =\ alpha\_fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z);}
\DoxyCodeLine{03133\ }
\DoxyCodeLine{03134\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ z\_size\ *\ num\_views;}
\DoxyCodeLine{03135\ \ \ \ \ \textcolor{keywordflow}{while}\ ((num\_pages\ ==\ 0\ \&\&\ (vfs-\/>exists(file)\ ||\ z\ ==\ 0))\ ||}
\DoxyCodeLine{03136\ \ \ \ \ \ \ \ \ \ \ \ (num\_pages\ !=\ 0\ \&\&\ z\ <\ num\_pages))\ \{}
\DoxyCodeLine{03137\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{do\_read\_one}}(cdata,\ file,\ alpha\_file,\ z,\ 0,\ primary\_file\_num\_channels,}
\DoxyCodeLine{03138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,\ options,\ header\_only,\ record))\ \{}
\DoxyCodeLine{03139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03140\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03141\ \ \ \ \ \ \ ++z;}
\DoxyCodeLine{03142\ }
\DoxyCodeLine{03143\ \ \ \ \ \ \ file\ =\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z);}
\DoxyCodeLine{03144\ \ \ \ \ \ \ alpha\_file\ =\ alpha\_fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z);}
\DoxyCodeLine{03145\ \ \ \ \ \}}
\DoxyCodeLine{03146\ \ \ \ \ cdata-\/>\_fullpath\ =\ fullpath\_pattern;}
\DoxyCodeLine{03147\ \ \ \ \ cdata-\/>\_alpha\_fullpath\ =\ alpha\_fullpath\_pattern;}
\DoxyCodeLine{03148\ }
\DoxyCodeLine{03149\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (read\_mipmaps)\ \{}
\DoxyCodeLine{03150\ \ \ \ \ \textcolor{comment}{//\ Read\ a\ sequence\ of\ mipmap\ levels.}}
\DoxyCodeLine{03151\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{03152\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_fullpath\_pattern\ =\ Filename::pattern\_filename(alpha\_fullpath);}
\DoxyCodeLine{03153\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fullpath\_pattern.has\_hash())\ \{}
\DoxyCodeLine{03154\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03155\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ a\ hash\ mark:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{03156\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03157\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03158\ \ \ \ \ \}}
\DoxyCodeLine{03159\ }
\DoxyCodeLine{03160\ \ \ \ \ n\ =\ 0;}
\DoxyCodeLine{03161\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ file\ =\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03162\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_file\ =\ alpha\_fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03163\ }
\DoxyCodeLine{03164\ \ \ \ \ \textcolor{keywordflow}{while}\ ((n\_size\ ==\ 0\ \&\&\ (vfs-\/>exists(file)\ ||\ n\ ==\ 0))\ ||}
\DoxyCodeLine{03165\ \ \ \ \ \ \ \ \ \ \ \ (n\_size\ !=\ 0\ \&\&\ n\ <\ n\_size))\ \{}
\DoxyCodeLine{03166\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{do\_read\_one}}(cdata,\ file,\ alpha\_file,\ z,\ n,}
\DoxyCodeLine{03167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ primary\_file\_num\_channels,\ alpha\_file\_channel,}
\DoxyCodeLine{03168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ header\_only,\ record))\ \{}
\DoxyCodeLine{03169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03170\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03171\ \ \ \ \ \ \ ++n;}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (n\_size\ ==\ 0\ \&\&\ n\ >=\ do\_get\_expected\_num\_mipmap\_levels(cdata))\ \{}
\DoxyCodeLine{03174\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Don't\ try\ to\ read\ more\ than\ the\ requisite\ number\ of\ mipmap\ levels}}
\DoxyCodeLine{03175\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ (unless\ the\ user\ insisted\ on\ it\ for\ some\ reason).}}
\DoxyCodeLine{03176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03177\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03178\ }
\DoxyCodeLine{03179\ \ \ \ \ \ \ file\ =\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03180\ \ \ \ \ \ \ alpha\_file\ =\ alpha\_fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n);}
\DoxyCodeLine{03181\ \ \ \ \ \}}
\DoxyCodeLine{03182\ \ \ \ \ cdata-\/>\_fullpath\ =\ fullpath\_pattern;}
\DoxyCodeLine{03183\ \ \ \ \ cdata-\/>\_alpha\_fullpath\ =\ alpha\_fullpath\_pattern;}
\DoxyCodeLine{03184\ }
\DoxyCodeLine{03185\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03186\ \ \ \ \ \textcolor{comment}{//\ Just\ an\ ordinary\ read\ of\ one\ file.}}
\DoxyCodeLine{03187\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{do\_read\_one}}(cdata,\ fullpath,\ alpha\_fullpath,\ z,\ n,}
\DoxyCodeLine{03188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ primary\_file\_num\_channels,\ alpha\_file\_channel,}
\DoxyCodeLine{03189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ options,\ header\_only,\ record))\ \{}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03191\ \ \ \ \ \}}
\DoxyCodeLine{03192\ \ \ \}}
\DoxyCodeLine{03193\ }
\DoxyCodeLine{03194\ \ \ cdata-\/>\_has\_read\_pages\ =\ read\_pages;}
\DoxyCodeLine{03195\ \ \ cdata-\/>\_has\_read\_mipmaps\ =\ read\_mipmaps;}
\DoxyCodeLine{03196\ \ \ cdata-\/>\_num\_mipmap\_levels\_read\ =\ cdata-\/>\_ram\_images.size();}
\DoxyCodeLine{03197\ }
\DoxyCodeLine{03198\ \ \ \textcolor{keywordflow}{if}\ (header\_only)\ \{}
\DoxyCodeLine{03199\ \ \ \ \ \textcolor{comment}{//\ If\ we\ were\ only\ supposed\ to\ be\ checking\ the\ image\ header\ information,}}
\DoxyCodeLine{03200\ \ \ \ \ \textcolor{comment}{//\ don't\ let\ the\ Texture\ think\ that\ it's\ got\ the\ image\ now.}}
\DoxyCodeLine{03201\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{03202\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03203\ \ \ \ \ \textcolor{keywordflow}{if}\ ((options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_preload)\ !=\ 0)\ \{}
\DoxyCodeLine{03204\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ intend\ to\ keep\ the\ ram\ image\ around,\ consider\ compressing\ it}}
\DoxyCodeLine{03205\ \ \ \ \ \ \ \textcolor{comment}{//\ etc.}}
\DoxyCodeLine{03206\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ generate\_mipmaps\ =\ ((options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_generate\_mipmaps)\ !=\ 0);}
\DoxyCodeLine{03207\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ allow\_compression\ =\ ((options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_allow\_compression)\ !=\ 0);}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a02144ecaee7fca731249f1513b632eff}{do\_consider\_auto\_process\_ram\_image}}(cdata,\ generate\_mipmaps\ ||\ uses\_mipmaps(),\ allow\_compression);}
\DoxyCodeLine{03209\ \ \ \ \ \}}
\DoxyCodeLine{03210\ \ \ \}}
\DoxyCodeLine{03211\ }
\DoxyCodeLine{03212\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03213\ \}}
\DoxyCodeLine{03214\ }
\DoxyCodeLine{03219\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{Texture::}}}
\DoxyCodeLine{03220\ \mbox{\hyperlink{classTexture_abb01742fd9ff699048c81aa81e686f71}{do\_read\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&alpha\_fullpath,}
\DoxyCodeLine{03221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{int}\ primary\_file\_num\_channels,\ \textcolor{keywordtype}{int}\ alpha\_file\_channel,}
\DoxyCodeLine{03222\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options,\ \textcolor{keywordtype}{bool}\ header\_only,\ \mbox{\hyperlink{classBamCacheRecord}{BamCacheRecord}}\ *record)\ \{}
\DoxyCodeLine{03223\ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03224\ \ \ \ \ nassertr(!header\_only,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03225\ \ \ \ \ record-\/>add\_dependent\_file(fullpath);}
\DoxyCodeLine{03226\ \ \ \}}
\DoxyCodeLine{03227\ }
\DoxyCodeLine{03228\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ image;}
\DoxyCodeLine{03229\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ pfm;}
\DoxyCodeLine{03230\ \ \ \mbox{\hyperlink{classPNMReader}{PNMReader}}\ *image\_reader\ =\ image.make\_reader(fullpath,\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{03231\ \ \ \textcolor{keywordflow}{if}\ (image\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03232\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03233\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::read()\ -\/\ couldn't\ read:\ "{}}\ <<\ fullpath\ <<\ endl;}
\DoxyCodeLine{03234\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03235\ \ \ \}}
\DoxyCodeLine{03236\ \ \ image.copy\_header\_from(*image\_reader);}
\DoxyCodeLine{03237\ }
\DoxyCodeLine{03238\ \ \ AutoTextureScale\ auto\_texture\_scale\ =\ do\_get\_auto\_texture\_scale(cdata);}
\DoxyCodeLine{03239\ }
\DoxyCodeLine{03240\ \ \ \textcolor{comment}{//\ If\ it's\ a\ floating-\/point\ image\ file,\ read\ it\ by\ default\ into\ a\ floating-\/}}
\DoxyCodeLine{03241\ \ \ \textcolor{comment}{//\ point\ texture.}}
\DoxyCodeLine{03242\ \ \ \textcolor{keywordtype}{bool}\ read\_floating\_point;}
\DoxyCodeLine{03243\ \ \ \textcolor{keywordtype}{int}\ texture\_load\_type\ =\ (options.get\_texture\_flags()\ \&\ (LoaderOptions::TF\_integer\ |\ LoaderOptions::TF\_float));}
\DoxyCodeLine{03244\ \ \ \textcolor{keywordflow}{switch}\ (texture\_load\_type)\ \{}
\DoxyCodeLine{03245\ \ \ \textcolor{keywordflow}{case}\ LoaderOptions::TF\_integer:}
\DoxyCodeLine{03246\ \ \ \ \ read\_floating\_point\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03247\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03248\ }
\DoxyCodeLine{03249\ \ \ \textcolor{keywordflow}{case}\ LoaderOptions::TF\_float:}
\DoxyCodeLine{03250\ \ \ \ \ read\_floating\_point\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03251\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03252\ }
\DoxyCodeLine{03253\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{03254\ \ \ \ \ \textcolor{comment}{//\ Neither\ TF\_integer\ nor\ TF\_float\ was\ specified;\ determine\ which\ way\ the}}
\DoxyCodeLine{03255\ \ \ \ \ \textcolor{comment}{//\ texture\ wants\ to\ be\ loaded.}}
\DoxyCodeLine{03256\ \ \ \ \ read\_floating\_point\ =\ (image\_reader-\/>\mbox{\hyperlink{classPNMReader_a34acf9a526d3ffe9f6be1fc4617757ae}{is\_floating\_point}}());}
\DoxyCodeLine{03257\ \ \ \ \ \textcolor{keywordflow}{if}\ (!alpha\_fullpath.empty())\ \{}
\DoxyCodeLine{03258\ \ \ \ \ \ \ read\_floating\_point\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03259\ \ \ \ \ \}}
\DoxyCodeLine{03260\ \ \ \}}
\DoxyCodeLine{03261\ }
\DoxyCodeLine{03262\ \ \ \textcolor{keywordflow}{if}\ (header\_only\ ||\ textures\_header\_only)\ \{}
\DoxyCodeLine{03263\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ image.get\_x\_size();}
\DoxyCodeLine{03264\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ image.get\_y\_size();}
\DoxyCodeLine{03265\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0\ \&\&\ n\ ==\ 0)\ \{}
\DoxyCodeLine{03266\ \ \ \ \ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ x\_size;}
\DoxyCodeLine{03267\ \ \ \ \ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ y\_size;}
\DoxyCodeLine{03268\ \ \ \ \ \}}
\DoxyCodeLine{03269\ }
\DoxyCodeLine{03270\ \ \ \ \ \textcolor{keywordflow}{if}\ (textures\_header\_only)\ \{}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ this\ mode,\ we\ never\ intend\ to\ load\ the\ actual\ texture\ image}}
\DoxyCodeLine{03272\ \ \ \ \ \ \ \textcolor{comment}{//\ anyway,\ so\ we\ don't\ even\ need\ to\ make\ the\ size\ right.}}
\DoxyCodeLine{03273\ \ \ \ \ \ \ x\_size\ =\ 1;}
\DoxyCodeLine{03274\ \ \ \ \ \ \ y\_size\ =\ 1;}
\DoxyCodeLine{03275\ }
\DoxyCodeLine{03276\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03277\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{adjust\_size}}(x\_size,\ y\_size,\ fullpath.get\_basename(),\ \textcolor{keyword}{false},\ auto\_texture\_scale);}
\DoxyCodeLine{03278\ \ \ \ \ \}}
\DoxyCodeLine{03279\ }
\DoxyCodeLine{03280\ \ \ \ \ \textcolor{keywordflow}{if}\ (read\_floating\_point)\ \{}
\DoxyCodeLine{03281\ \ \ \ \ \ \ pfm.clear(x\_size,\ y\_size,\ image.get\_num\_channels());}
\DoxyCodeLine{03282\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03283\ \ \ \ \ \ \ image\ =\ \mbox{\hyperlink{classPNMImage}{PNMImage}}(x\_size,\ y\_size,\ image.get\_num\_channels(),}
\DoxyCodeLine{03284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image.get\_maxval(),\ image.get\_type(),}
\DoxyCodeLine{03285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image.get\_color\_space());}
\DoxyCodeLine{03286\ \ \ \ \ \ \ image.fill(0.2,\ 0.3,\ 1.0);}
\DoxyCodeLine{03287\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image.has\_alpha())\ \{}
\DoxyCodeLine{03288\ \ \ \ \ \ \ \ \ image.alpha\_fill(1.0);}
\DoxyCodeLine{03289\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03290\ \ \ \ \ \}}
\DoxyCodeLine{03291\ \ \ \ \ \textcolor{keyword}{delete}\ image\_reader;}
\DoxyCodeLine{03292\ }
\DoxyCodeLine{03293\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03294\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0\ \&\&\ n\ ==\ 0)\ \{}
\DoxyCodeLine{03295\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ image.get\_x\_size();}
\DoxyCodeLine{03296\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ image.get\_y\_size();}
\DoxyCodeLine{03297\ }
\DoxyCodeLine{03298\ \ \ \ \ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ x\_size;}
\DoxyCodeLine{03299\ \ \ \ \ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ y\_size;}
\DoxyCodeLine{03300\ }
\DoxyCodeLine{03301\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a91a15ce76e989a9591342aca28070b24}{adjust\_size}}(x\_size,\ y\_size,\ fullpath.get\_basename(),\ \textcolor{keyword}{false},\ auto\_texture\_scale))\ \{}
\DoxyCodeLine{03302\ \ \ \ \ \ \ \ \ image.set\_read\_size(x\_size,\ y\_size);}
\DoxyCodeLine{03303\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03304\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03305\ \ \ \ \ \ \ image.set\_read\_size(do\_get\_expected\_mipmap\_x\_size(cdata,\ n),}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_y\_size(cdata,\ n));}
\DoxyCodeLine{03307\ \ \ \ \ \}}
\DoxyCodeLine{03308\ }
\DoxyCodeLine{03309\ \ \ \ \ \textcolor{keywordflow}{if}\ (image.get\_x\_size()\ !=\ image.get\_read\_x\_size()\ ||}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \ \ image.get\_y\_size()\ !=\ image.get\_read\_y\_size())\ \{}
\DoxyCodeLine{03311\ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{03312\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Implicitly\ rescaling\ "{}}\ <<\ fullpath.get\_basename()\ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}}
\DoxyCodeLine{03313\ \ \ \ \ \ \ \ \ <<\ image.get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}\ <<\ image.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{03314\ \ \ \ \ \ \ \ \ <<\ image.get\_read\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}\ <<\ image.get\_read\_y\_size()}
\DoxyCodeLine{03315\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03316\ \ \ \ \ \}}
\DoxyCodeLine{03317\ }
\DoxyCodeLine{03318\ \ \ \ \ \textcolor{keywordtype}{bool}\ success;}
\DoxyCodeLine{03319\ \ \ \ \ \textcolor{keywordflow}{if}\ (read\_floating\_point)\ \{}
\DoxyCodeLine{03320\ \ \ \ \ \ \ success\ =\ pfm.read(image\_reader);}
\DoxyCodeLine{03321\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03322\ \ \ \ \ \ \ success\ =\ image.read(image\_reader);}
\DoxyCodeLine{03323\ \ \ \ \ \}}
\DoxyCodeLine{03324\ }
\DoxyCodeLine{03325\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{03326\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03327\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::read()\ -\/\ couldn't\ read:\ "{}}\ <<\ fullpath\ <<\ endl;}
\DoxyCodeLine{03328\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03329\ \ \ \ \ \}}
\DoxyCodeLine{03330\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03331\ \ \ \}}
\DoxyCodeLine{03332\ }
\DoxyCodeLine{03333\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ alpha\_image;}
\DoxyCodeLine{03334\ \ \ \textcolor{keywordflow}{if}\ (!alpha\_fullpath.empty())\ \{}
\DoxyCodeLine{03335\ \ \ \ \ \mbox{\hyperlink{classPNMReader}{PNMReader}}\ *alpha\_image\_reader\ =\ alpha\_image.make\_reader(alpha\_fullpath,\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{03336\ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\_image\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03337\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03338\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::read()\ -\/\ couldn't\ read:\ "{}}\ <<\ alpha\_fullpath\ <<\ endl;}
\DoxyCodeLine{03339\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03340\ \ \ \ \ \}}
\DoxyCodeLine{03341\ \ \ \ \ alpha\_image.copy\_header\_from(*alpha\_image\_reader);}
\DoxyCodeLine{03342\ }
\DoxyCodeLine{03343\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03344\ \ \ \ \ \ \ record-\/>add\_dependent\_file(alpha\_fullpath);}
\DoxyCodeLine{03345\ \ \ \ \ \}}
\DoxyCodeLine{03346\ }
\DoxyCodeLine{03347\ \ \ \ \ \textcolor{keywordflow}{if}\ (header\_only\ ||\ textures\_header\_only)\ \{}
\DoxyCodeLine{03348\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ image.get\_x\_size();}
\DoxyCodeLine{03349\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ image.get\_y\_size();}
\DoxyCodeLine{03350\ \ \ \ \ \ \ alpha\_image\ =\ \mbox{\hyperlink{classPNMImage}{PNMImage}}(x\_size,\ y\_size,\ alpha\_image.get\_num\_channels(),}
\DoxyCodeLine{03351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_maxval(),\ alpha\_image.get\_type(),}
\DoxyCodeLine{03352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_color\_space());}
\DoxyCodeLine{03353\ \ \ \ \ \ \ alpha\_image.fill(1.0);}
\DoxyCodeLine{03354\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\_image.has\_alpha())\ \{}
\DoxyCodeLine{03355\ \ \ \ \ \ \ \ \ alpha\_image.alpha\_fill(1.0);}
\DoxyCodeLine{03356\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03357\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ alpha\_image\_reader;}
\DoxyCodeLine{03358\ }
\DoxyCodeLine{03359\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image.get\_x\_size()\ !=\ alpha\_image.get\_x\_size()\ ||}
\DoxyCodeLine{03361\ \ \ \ \ \ \ \ \ \ \ image.get\_y\_size()\ !=\ alpha\_image.get\_y\_size())\ \{}
\DoxyCodeLine{03362\ \ \ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{03363\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Implicitly\ rescaling\ "{}}\ <<\ alpha\_fullpath.get\_basename()}
\DoxyCodeLine{03364\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ alpha\_image.get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03365\ \ \ \ \ \ \ \ \ \ \ <<\ alpha\_image.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ image.get\_x\_size()}
\DoxyCodeLine{03366\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}\ <<\ image.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03367\ \ \ \ \ \ \ \ \ alpha\_image.set\_read\_size(image.get\_x\_size(),\ image.get\_y\_size());}
\DoxyCodeLine{03368\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03369\ }
\DoxyCodeLine{03370\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!alpha\_image.read(alpha\_image\_reader))\ \{}
\DoxyCodeLine{03371\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03372\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::read()\ -\/\ couldn't\ read\ (alpha):\ "{}}\ <<\ alpha\_fullpath\ <<\ endl;}
\DoxyCodeLine{03373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03374\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03375\ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03376\ \ \ \ \ \}}
\DoxyCodeLine{03377\ \ \ \}}
\DoxyCodeLine{03378\ }
\DoxyCodeLine{03379\ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0\ \&\&\ n\ ==\ 0)\ \{}
\DoxyCodeLine{03380\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_name())\ \{}
\DoxyCodeLine{03381\ \ \ \ \ \ \ set\_name(fullpath.get\_basename\_wo\_extension());}
\DoxyCodeLine{03382\ \ \ \ \ \}}
\DoxyCodeLine{03383\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_filename.empty())\ \{}
\DoxyCodeLine{03384\ \ \ \ \ \ \ cdata-\/>\_filename\ =\ fullpath;}
\DoxyCodeLine{03385\ \ \ \ \ \ \ cdata-\/>\_alpha\_filename\ =\ alpha\_fullpath;}
\DoxyCodeLine{03386\ }
\DoxyCodeLine{03387\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ first\ time\ we\ set\ the\ filename\ via\ a\ read()\ operation,\ we\ clear}}
\DoxyCodeLine{03388\ \ \ \ \ \ \ \textcolor{comment}{//\ keep\_ram\_image.\ \ The\ user\ can\ always\ set\ it\ again\ later\ if\ he\ needs}}
\DoxyCodeLine{03389\ \ \ \ \ \ \ \textcolor{comment}{//\ to.}}
\DoxyCodeLine{03390\ \ \ \ \ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03391\ \ \ \ \ \}}
\DoxyCodeLine{03392\ }
\DoxyCodeLine{03393\ \ \ \ \ cdata-\/>\_fullpath\ =\ fullpath;}
\DoxyCodeLine{03394\ \ \ \ \ cdata-\/>\_alpha\_fullpath\ =\ alpha\_fullpath;}
\DoxyCodeLine{03395\ \ \ \}}
\DoxyCodeLine{03396\ }
\DoxyCodeLine{03397\ \ \ \textcolor{keywordflow}{if}\ (!alpha\_fullpath.empty())\ \{}
\DoxyCodeLine{03398\ \ \ \ \ \textcolor{comment}{//\ The\ grayscale\ (alpha\ channel)\ image\ must\ be\ the\ same\ size\ as\ the\ main}}
\DoxyCodeLine{03399\ \ \ \ \ \textcolor{comment}{//\ image.\ \ This\ should\ really\ have\ been\ already\ guaranteed\ by\ the\ above.}}
\DoxyCodeLine{03400\ \ \ \ \ \textcolor{keywordflow}{if}\ (image.get\_x\_size()\ !=\ alpha\_image.get\_x\_size()\ ||}
\DoxyCodeLine{03401\ \ \ \ \ \ \ \ \ image.get\_y\_size()\ !=\ alpha\_image.get\_y\_size())\ \{}
\DoxyCodeLine{03402\ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{03403\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Automatically\ rescaling\ "{}}\ <<\ alpha\_fullpath.get\_basename()}
\DoxyCodeLine{03404\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ alpha\_image.get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03405\ \ \ \ \ \ \ \ \ <<\ alpha\_image.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ image.get\_x\_size()}
\DoxyCodeLine{03406\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}\ <<\ image.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03407\ }
\DoxyCodeLine{03408\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ scaled(image.get\_x\_size(),\ image.get\_y\_size(),}
\DoxyCodeLine{03409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_num\_channels(),}
\DoxyCodeLine{03410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_maxval(),\ alpha\_image.get\_type(),}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_color\_space());}
\DoxyCodeLine{03412\ \ \ \ \ \ \ scaled.quick\_filter\_from(alpha\_image);}
\DoxyCodeLine{03413\ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03414\ \ \ \ \ \ \ alpha\_image\ =\ scaled;}
\DoxyCodeLine{03415\ \ \ \ \ \}}
\DoxyCodeLine{03416\ \ \ \}}
\DoxyCodeLine{03417\ }
\DoxyCodeLine{03418\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{03419\ \ \ \ \ consider\_downgrade(image,\ primary\_file\_num\_channels,\ get\_name());}
\DoxyCodeLine{03420\ \ \ \ \ cdata-\/>\_primary\_file\_num\_channels\ =\ image.get\_num\_channels();}
\DoxyCodeLine{03421\ \ \ \ \ cdata-\/>\_alpha\_file\_channel\ =\ 0;}
\DoxyCodeLine{03422\ \ \ \}}
\DoxyCodeLine{03423\ }
\DoxyCodeLine{03424\ \ \ \textcolor{keywordflow}{if}\ (!alpha\_fullpath.empty())\ \{}
\DoxyCodeLine{03425\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ original\ image\ a\ 4-\/component\ image\ by\ taking\ the\ grayscale}}
\DoxyCodeLine{03426\ \ \ \ \ \textcolor{comment}{//\ value\ from\ the\ second\ image.}}
\DoxyCodeLine{03427\ \ \ \ \ image.add\_alpha();}
\DoxyCodeLine{03428\ }
\DoxyCodeLine{03429\ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\_file\_channel\ ==\ 4\ ||}
\DoxyCodeLine{03430\ \ \ \ \ \ \ \ \ (alpha\_file\_channel\ ==\ 2\ \&\&\ alpha\_image.get\_num\_channels()\ ==\ 2))\ \{}
\DoxyCodeLine{03431\ }
\DoxyCodeLine{03432\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!alpha\_image.has\_alpha())\ \{}
\DoxyCodeLine{03433\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03434\ \ \ \ \ \ \ \ \ \ \ <<\ alpha\_fullpath.get\_basename()\ <<\ \textcolor{stringliteral}{"{}\ has\ no\ channel\ "{}}\ <<\ alpha\_file\_channel\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{03435\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03436\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ alpha\ channel.}}
\DoxyCodeLine{03437\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ image.get\_x\_size();\ x++)\ \{}
\DoxyCodeLine{03438\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ image.get\_y\_size();\ y++)\ \{}
\DoxyCodeLine{03439\ \ \ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ alpha\_image.get\_alpha(x,\ y));}
\DoxyCodeLine{03440\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03441\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03442\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03443\ \ \ \ \ \ \ cdata-\/>\_alpha\_file\_channel\ =\ alpha\_image.get\_num\_channels();}
\DoxyCodeLine{03444\ }
\DoxyCodeLine{03445\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (alpha\_file\_channel\ >=\ 1\ \&\&\ alpha\_file\_channel\ <=\ 3\ \&\&}
\DoxyCodeLine{03446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_image.get\_num\_channels()\ >=\ 3)\ \{}
\DoxyCodeLine{03447\ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ appropriate\ red,\ green,\ or\ blue\ channel.}}
\DoxyCodeLine{03448\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ image.get\_x\_size();\ x++)\ \{}
\DoxyCodeLine{03449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ image.get\_y\_size();\ y++)\ \{}
\DoxyCodeLine{03450\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ alpha\_image.get\_channel\_val(x,\ y,\ alpha\_file\_channel\ -\/\ 1));}
\DoxyCodeLine{03451\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03452\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03453\ \ \ \ \ \ \ cdata-\/>\_alpha\_file\_channel\ =\ alpha\_file\_channel;}
\DoxyCodeLine{03454\ }
\DoxyCodeLine{03455\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03456\ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ grayscale\ channel.}}
\DoxyCodeLine{03457\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ image.get\_x\_size();\ x++)\ \{}
\DoxyCodeLine{03458\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ image.get\_y\_size();\ y++)\ \{}
\DoxyCodeLine{03459\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ alpha\_image.get\_gray(x,\ y));}
\DoxyCodeLine{03460\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03461\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03462\ \ \ \ \ \ \ cdata-\/>\_alpha\_file\_channel\ =\ 0;}
\DoxyCodeLine{03463\ \ \ \ \ \}}
\DoxyCodeLine{03464\ \ \ \}}
\DoxyCodeLine{03465\ }
\DoxyCodeLine{03466\ \ \ \textcolor{keywordflow}{if}\ (read\_floating\_point)\ \{}
\DoxyCodeLine{03467\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(cdata,\ pfm,\ fullpath.get\_basename(),\ z,\ n,\ options))\ \{}
\DoxyCodeLine{03468\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03469\ \ \ \ \ \}}
\DoxyCodeLine{03470\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03471\ \ \ \ \ \textcolor{comment}{//\ Now\ see\ if\ we\ want\ to\ pad\ the\ image\ within\ a\ larger\ power-\/of-\/2\ image.}}
\DoxyCodeLine{03472\ \ \ \ \ \textcolor{keywordtype}{int}\ pad\_x\_size\ =\ 0;}
\DoxyCodeLine{03473\ \ \ \ \ \textcolor{keywordtype}{int}\ pad\_y\_size\ =\ 0;}
\DoxyCodeLine{03474\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_get\_auto\_texture\_scale(cdata)\ ==\ ATS\_pad)\ \{}
\DoxyCodeLine{03475\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ image.get\_x\_size();}
\DoxyCodeLine{03476\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ image.get\_y\_size();}
\DoxyCodeLine{03477\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{do\_adjust\_this\_size}}(cdata,\ new\_x\_size,\ new\_y\_size,\ fullpath.get\_basename(),\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{03478\ \ \ \ \ \ \ \ \ pad\_x\_size\ =\ new\_x\_size\ -\/\ image.get\_x\_size();}
\DoxyCodeLine{03479\ \ \ \ \ \ \ \ \ pad\_y\_size\ =\ new\_y\_size\ -\/\ image.get\_y\_size();}
\DoxyCodeLine{03480\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ new\_image(new\_x\_size,\ new\_y\_size,\ image.get\_num\_channels(),}
\DoxyCodeLine{03481\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image.get\_maxval(),\ image.get\_type(),}
\DoxyCodeLine{03482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image.get\_color\_space());}
\DoxyCodeLine{03483\ \ \ \ \ \ \ \ \ new\_image.copy\_sub\_image(image,\ 0,\ new\_y\_size\ -\/\ image.get\_y\_size());}
\DoxyCodeLine{03484\ \ \ \ \ \ \ \ \ image.take\_from(new\_image);}
\DoxyCodeLine{03485\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03486\ \ \ \ \ \}}
\DoxyCodeLine{03487\ }
\DoxyCodeLine{03488\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(cdata,\ image,\ fullpath.get\_basename(),\ z,\ n,\ options))\ \{}
\DoxyCodeLine{03489\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03490\ \ \ \ \ \}}
\DoxyCodeLine{03491\ }
\DoxyCodeLine{03492\ \ \ \ \ do\_set\_pad\_size(cdata,\ pad\_x\_size,\ pad\_y\_size,\ 0);}
\DoxyCodeLine{03493\ \ \ \}}
\DoxyCodeLine{03494\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03495\ \}}
\DoxyCodeLine{03496\ }
\DoxyCodeLine{03500\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{Texture::}}}
\DoxyCodeLine{03501\ \mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,}
\DoxyCodeLine{03502\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{03503\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.size()\ <=\ 1\ \&\&\ n\ ==\ 0)\ \{}
\DoxyCodeLine{03504\ \ \ \ \ \textcolor{comment}{//\ A\ special\ case\ for\ mipmap\ level\ 0.\ \ When\ we\ load\ mipmap\ level\ 0,\ unless}}
\DoxyCodeLine{03505\ \ \ \ \ \textcolor{comment}{//\ we\ already\ have\ mipmap\ levels,\ it\ determines\ the\ image\ properties\ like}}
\DoxyCodeLine{03506\ \ \ \ \ \textcolor{comment}{//\ size\ and\ number\ of\ components.}}
\DoxyCodeLine{03507\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a3adf380f82bd7de62b8a780d4d4c83d5}{do\_reconsider\_z\_size}}(cdata,\ z,\ options))\ \{}
\DoxyCodeLine{03508\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03509\ \ \ \ \ \}}
\DoxyCodeLine{03510\ \ \ \ \ nassertr(z\ >=\ 0\ \&\&\ z\ <\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03511\ }
\DoxyCodeLine{03512\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0)\ \{}
\DoxyCodeLine{03513\ \ \ \ \ \ \ ComponentType\ component\_type\ =\ T\_unsigned\_byte;}
\DoxyCodeLine{03514\ \ \ \ \ \ \ xelval\ maxval\ =\ pnmimage.get\_maxval();}
\DoxyCodeLine{03515\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (maxval\ >\ 255)\ \{}
\DoxyCodeLine{03516\ \ \ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{03517\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03518\ }
\DoxyCodeLine{03519\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_af9e91896eac6f7215f59e3a78c100bfc}{do\_reconsider\_image\_properties}}(cdata,\ pnmimage.get\_x\_size(),\ pnmimage.get\_y\_size(),}
\DoxyCodeLine{03520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.get\_num\_channels(),\ component\_type,}
\DoxyCodeLine{03521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z,\ options))\ \{}
\DoxyCodeLine{03522\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03523\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03524\ \ \ \ \ \}}
\DoxyCodeLine{03525\ }
\DoxyCodeLine{03526\ \ \ \ \ \mbox{\hyperlink{classTexture_a1273d4e83f00e6ec1e1d777836fcc935}{do\_modify\_ram\_image}}(cdata);}
\DoxyCodeLine{03527\ \ \ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03528\ \ \ \}}
\DoxyCodeLine{03529\ }
\DoxyCodeLine{03530\ \ \ \mbox{\hyperlink{classTexture_a22ff7474ef423e26313d550f44837ea7}{do\_modify\_ram\_mipmap\_image}}(cdata,\ n);}
\DoxyCodeLine{03531\ }
\DoxyCodeLine{03532\ \ \ \textcolor{comment}{//\ Ensure\ the\ PNMImage\ is\ an\ appropriate\ size.}}
\DoxyCodeLine{03533\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{03534\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{03535\ \ \ \textcolor{keywordflow}{if}\ (pnmimage.get\_x\_size()\ !=\ x\_size\ ||}
\DoxyCodeLine{03536\ \ \ \ \ \ \ pnmimage.get\_y\_size()\ !=\ y\_size)\ \{}
\DoxyCodeLine{03537\ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{03538\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Automatically\ rescaling\ "{}}\ <<\ name;}
\DoxyCodeLine{03539\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ !=\ 0)\ \{}
\DoxyCodeLine{03540\ \ \ \ \ \ \ gobj\_cat.info(\textcolor{keyword}{false})}
\DoxyCodeLine{03541\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ mipmap\ level\ "{}}\ <<\ n;}
\DoxyCodeLine{03542\ \ \ \ \ \}}
\DoxyCodeLine{03543\ \ \ \ \ gobj\_cat.info(\textcolor{keyword}{false})}
\DoxyCodeLine{03544\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ pnmimage.get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03545\ \ \ \ \ \ \ <<\ pnmimage.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ x\_size\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03546\ \ \ \ \ \ \ <<\ y\_size\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03547\ }
\DoxyCodeLine{03548\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ scaled(x\_size,\ y\_size,\ pnmimage.get\_num\_channels(),}
\DoxyCodeLine{03549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.get\_maxval(),\ pnmimage.get\_type(),}
\DoxyCodeLine{03550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.get\_color\_space());}
\DoxyCodeLine{03551\ \ \ \ \ scaled.quick\_filter\_from(pnmimage);}
\DoxyCodeLine{03552\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03553\ }
\DoxyCodeLine{03554\ \ \ \ \ convert\_from\_pnmimage(cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{03555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n),}
\DoxyCodeLine{03556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ 0,\ 0,\ z,\ scaled,}
\DoxyCodeLine{03557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{03558\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03559\ \ \ \ \ \textcolor{comment}{//\ Now\ copy\ the\ pixel\ data\ from\ the\ PNMImage\ into\ our\ internal}}
\DoxyCodeLine{03560\ \ \ \ \ \textcolor{comment}{//\ cdata-\/>\_image\ component.}}
\DoxyCodeLine{03561\ \ \ \ \ convert\_from\_pnmimage(cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{03562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n),}
\DoxyCodeLine{03563\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ 0,\ 0,\ z,\ pnmimage,}
\DoxyCodeLine{03564\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{03565\ \ \ \}}
\DoxyCodeLine{03566\ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03567\ }
\DoxyCodeLine{03568\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03569\ \}}
\DoxyCodeLine{03570\ }
\DoxyCodeLine{03574\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{Texture::}}}
\DoxyCodeLine{03575\ \mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pfm,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,}
\DoxyCodeLine{03576\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{03577\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.size()\ <=\ 1\ \&\&\ n\ ==\ 0)\ \{}
\DoxyCodeLine{03578\ \ \ \ \ \textcolor{comment}{//\ A\ special\ case\ for\ mipmap\ level\ 0.\ \ When\ we\ load\ mipmap\ level\ 0,\ unless}}
\DoxyCodeLine{03579\ \ \ \ \ \textcolor{comment}{//\ we\ already\ have\ mipmap\ levels,\ it\ determines\ the\ image\ properties\ like}}
\DoxyCodeLine{03580\ \ \ \ \ \textcolor{comment}{//\ size\ and\ number\ of\ components.}}
\DoxyCodeLine{03581\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a3adf380f82bd7de62b8a780d4d4c83d5}{do\_reconsider\_z\_size}}(cdata,\ z,\ options))\ \{}
\DoxyCodeLine{03582\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03583\ \ \ \ \ \}}
\DoxyCodeLine{03584\ \ \ \ \ nassertr(z\ >=\ 0\ \&\&\ z\ <\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03585\ }
\DoxyCodeLine{03586\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ ==\ 0)\ \{}
\DoxyCodeLine{03587\ \ \ \ \ \ \ ComponentType\ component\_type\ =\ T\_float;}
\DoxyCodeLine{03588\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_af9e91896eac6f7215f59e3a78c100bfc}{do\_reconsider\_image\_properties}}(cdata,\ pfm.get\_x\_size(),\ pfm.get\_y\_size(),}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pfm.get\_num\_channels(),\ component\_type,}
\DoxyCodeLine{03590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z,\ options))\ \{}
\DoxyCodeLine{03591\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03592\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03593\ \ \ \ \ \}}
\DoxyCodeLine{03594\ }
\DoxyCodeLine{03595\ \ \ \ \ \mbox{\hyperlink{classTexture_a1273d4e83f00e6ec1e1d777836fcc935}{do\_modify\_ram\_image}}(cdata);}
\DoxyCodeLine{03596\ \ \ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03597\ \ \ \}}
\DoxyCodeLine{03598\ }
\DoxyCodeLine{03599\ \ \ \mbox{\hyperlink{classTexture_a22ff7474ef423e26313d550f44837ea7}{do\_modify\_ram\_mipmap\_image}}(cdata,\ n);}
\DoxyCodeLine{03600\ }
\DoxyCodeLine{03601\ \ \ \textcolor{comment}{//\ Ensure\ the\ PfmFile\ is\ an\ appropriate\ size.}}
\DoxyCodeLine{03602\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{03603\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{03604\ \ \ \textcolor{keywordflow}{if}\ (pfm.get\_x\_size()\ !=\ x\_size\ ||}
\DoxyCodeLine{03605\ \ \ \ \ \ \ pfm.get\_y\_size()\ !=\ y\_size)\ \{}
\DoxyCodeLine{03606\ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{03607\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Automatically\ rescaling\ "{}}\ <<\ name;}
\DoxyCodeLine{03608\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ !=\ 0)\ \{}
\DoxyCodeLine{03609\ \ \ \ \ \ \ gobj\_cat.info(\textcolor{keyword}{false})}
\DoxyCodeLine{03610\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ mipmap\ level\ "{}}\ <<\ n;}
\DoxyCodeLine{03611\ \ \ \ \ \}}
\DoxyCodeLine{03612\ \ \ \ \ gobj\_cat.info(\textcolor{keyword}{false})}
\DoxyCodeLine{03613\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ pfm.get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03614\ \ \ \ \ \ \ <<\ pfm.get\_y\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ x\_size\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}}
\DoxyCodeLine{03615\ \ \ \ \ \ \ <<\ y\_size\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03616\ }
\DoxyCodeLine{03617\ \ \ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ scaled(pfm);}
\DoxyCodeLine{03618\ \ \ \ \ scaled.resize(x\_size,\ y\_size);}
\DoxyCodeLine{03619\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03620\ }
\DoxyCodeLine{03621\ \ \ \ \ convert\_from\_pfm(cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{03622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n),\ z,}
\DoxyCodeLine{03623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ scaled,\ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{03624\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03625\ \ \ \ \ \textcolor{comment}{//\ Now\ copy\ the\ pixel\ data\ from\ the\ PfmFile\ into\ our\ internal}}
\DoxyCodeLine{03626\ \ \ \ \ \textcolor{comment}{//\ cdata-\/>\_image\ component.}}
\DoxyCodeLine{03627\ \ \ \ \ convert\_from\_pfm(cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{03628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n),\ z,}
\DoxyCodeLine{03629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pfm,\ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{03630\ \ \ \}}
\DoxyCodeLine{03631\ \ \ Thread::consider\_yield();}
\DoxyCodeLine{03632\ }
\DoxyCodeLine{03633\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03634\ \}}
\DoxyCodeLine{03635\ }
\DoxyCodeLine{03640\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_acba3d5bf8db4c9215c0eb3dc80089544}{Texture::}}}
\DoxyCodeLine{03641\ \mbox{\hyperlink{classTexture_acba3d5bf8db4c9215c0eb3dc80089544}{do\_load\_sub\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&image,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{03642\ \ \ nassertr(n\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})n\ <\ cdata-\/>\_ram\_images.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{03643\ }
\DoxyCodeLine{03644\ \ \ \textcolor{keywordtype}{int}\ tex\_x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{03645\ \ \ \textcolor{keywordtype}{int}\ tex\_y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{03646\ \ \ \textcolor{keywordtype}{int}\ tex\_z\_size\ =\ do\_get\_expected\_mipmap\_z\_size(cdata,\ n);}
\DoxyCodeLine{03647\ }
\DoxyCodeLine{03648\ \ \ nassertr(x\ >=\ 0\ \&\&\ x\ <\ tex\_x\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03649\ \ \ nassertr(y\ >=\ 0\ \&\&\ y\ <\ tex\_y\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03650\ \ \ nassertr(z\ >=\ 0\ \&\&\ z\ <\ tex\_z\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03651\ }
\DoxyCodeLine{03652\ \ \ nassertr(image.get\_x\_size()\ +\ x\ <=\ tex\_x\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03653\ \ \ nassertr(image.get\_y\_size()\ +\ y\ <=\ tex\_y\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03654\ }
\DoxyCodeLine{03655\ \ \ \textcolor{comment}{//\ Flip\ y}}
\DoxyCodeLine{03656\ \ \ y\ =\ cdata-\/>\_y\_size\ -\/\ (image.get\_y\_size()\ +\ y);}
\DoxyCodeLine{03657\ }
\DoxyCodeLine{03658\ \ \ cdata-\/>\mbox{\hyperlink{classTexture_1_1CData_a3850cb4b6f8ba6917ad480617aab4649}{inc\_image\_page\_modified}}(z);}
\DoxyCodeLine{03659\ \ \ \mbox{\hyperlink{classTexture_a22ff7474ef423e26313d550f44837ea7}{do\_modify\_ram\_mipmap\_image}}(cdata,\ n);}
\DoxyCodeLine{03660\ \ \ convert\_from\_pnmimage(cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{03661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n),}
\DoxyCodeLine{03662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tex\_x\_size,\ x,\ y,\ z,\ image,}
\DoxyCodeLine{03663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{03664\ }
\DoxyCodeLine{03665\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03666\ \}}
\DoxyCodeLine{03667\ }
\DoxyCodeLine{03672\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_ade13ce0f0bc1ad2378b3f437850bb0d0}{Texture::}}}
\DoxyCodeLine{03673\ \mbox{\hyperlink{classTexture_ade13ce0f0bc1ad2378b3f437850bb0d0}{do\_read\_txo\_file}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\ \{}
\DoxyCodeLine{03674\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{03675\ }
\DoxyCodeLine{03676\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{03677\ \ \ PT(\mbox{\hyperlink{classVirtualFile}{VirtualFile}})\ file\ =\ vfs-\/>get\_file(filename);}
\DoxyCodeLine{03678\ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03679\ \ \ \ \ \textcolor{comment}{//\ No\ such\ file.}}
\DoxyCodeLine{03680\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03681\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ find\ "{}}\ <<\ fullpath\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03682\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03683\ \ \ \}}
\DoxyCodeLine{03684\ }
\DoxyCodeLine{03685\ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{03686\ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{03687\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ texture\ object\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03688\ \ \ \}}
\DoxyCodeLine{03689\ }
\DoxyCodeLine{03690\ \ \ istream\ *in\ =\ file-\/>open\_read\_file(\textcolor{keyword}{true});}
\DoxyCodeLine{03691\ \ \ \textcolor{keywordflow}{if}\ (in\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03692\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03693\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ for\ reading.\(\backslash\)n"{}};}
\DoxyCodeLine{03694\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03695\ \ \ \}}
\DoxyCodeLine{03696\ }
\DoxyCodeLine{03697\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ do\_read\_txo(cdata,\ *in,\ fullpath);}
\DoxyCodeLine{03698\ \ \ vfs-\/>close\_read\_file(in);}
\DoxyCodeLine{03699\ }
\DoxyCodeLine{03700\ \ \ cdata-\/>\_fullpath\ =\ fullpath;}
\DoxyCodeLine{03701\ \ \ cdata-\/>\_alpha\_fullpath\ =\ \mbox{\hyperlink{classFilename}{Filename}}();}
\DoxyCodeLine{03702\ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03703\ }
\DoxyCodeLine{03704\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{03705\ \}}
\DoxyCodeLine{03706\ }
\DoxyCodeLine{03710\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{03711\ do\_read\_txo(CData\ *cdata,\ istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename)\ \{}
\DoxyCodeLine{03712\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ other\ =\ make\_from\_txo(in,\ filename);}
\DoxyCodeLine{03713\ \ \ \textcolor{keywordflow}{if}\ (other\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03714\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03715\ \ \ \}}
\DoxyCodeLine{03716\ }
\DoxyCodeLine{03717\ \ \ CDReader\ cdata\_other(other-\/>\_cycler);}
\DoxyCodeLine{03718\ \ \ Namable::operator\ =\ (*other);}
\DoxyCodeLine{03719\ \ \ do\_assign(cdata,\ other,\ cdata\_other);}
\DoxyCodeLine{03720\ }
\DoxyCodeLine{03721\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03722\ \ \ cdata-\/>\_loaded\_from\_txo\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03723\ \ \ cdata-\/>\_has\_read\_pages\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03724\ \ \ cdata-\/>\_has\_read\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03725\ \ \ cdata-\/>\_num\_mipmap\_levels\_read\ =\ 0;}
\DoxyCodeLine{03726\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{03727\ \}}
\DoxyCodeLine{03728\ }
\DoxyCodeLine{03733\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_acb328183683d20f6dfb5a0aecfac3c5c}{Texture::}}}
\DoxyCodeLine{03734\ \mbox{\hyperlink{classTexture_acb328183683d20f6dfb5a0aecfac3c5c}{do\_read\_dds\_file}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{03735\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{03736\ }
\DoxyCodeLine{03737\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{03738\ \ \ PT(\mbox{\hyperlink{classVirtualFile}{VirtualFile}})\ file\ =\ vfs-\/>get\_file(filename);}
\DoxyCodeLine{03739\ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03740\ \ \ \ \ \textcolor{comment}{//\ No\ such\ file.}}
\DoxyCodeLine{03741\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03742\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ find\ "{}}\ <<\ fullpath\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03743\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03744\ \ \ \}}
\DoxyCodeLine{03745\ }
\DoxyCodeLine{03746\ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{03747\ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{03748\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ DDS\ file\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03749\ \ \ \}}
\DoxyCodeLine{03750\ }
\DoxyCodeLine{03751\ \ \ istream\ *in\ =\ file-\/>open\_read\_file(\textcolor{keyword}{true});}
\DoxyCodeLine{03752\ \ \ \textcolor{keywordflow}{if}\ (in\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03753\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03754\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ for\ reading.\(\backslash\)n"{}};}
\DoxyCodeLine{03755\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03756\ \ \ \}}
\DoxyCodeLine{03757\ }
\DoxyCodeLine{03758\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ do\_read\_dds(cdata,\ *in,\ fullpath,\ header\_only);}
\DoxyCodeLine{03759\ \ \ vfs-\/>close\_read\_file(in);}
\DoxyCodeLine{03760\ }
\DoxyCodeLine{03761\ \ \ \textcolor{keywordflow}{if}\ (!has\_name())\ \{}
\DoxyCodeLine{03762\ \ \ \ \ set\_name(fullpath.get\_basename\_wo\_extension());}
\DoxyCodeLine{03763\ \ \ \}}
\DoxyCodeLine{03764\ }
\DoxyCodeLine{03765\ \ \ cdata-\/>\_fullpath\ =\ fullpath;}
\DoxyCodeLine{03766\ \ \ cdata-\/>\_alpha\_fullpath\ =\ \mbox{\hyperlink{classFilename}{Filename}}();}
\DoxyCodeLine{03767\ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03768\ }
\DoxyCodeLine{03769\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{03770\ \}}
\DoxyCodeLine{03771\ }
\DoxyCodeLine{03775\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{03776\ do\_read\_dds(CData\ *cdata,\ istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{03777\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ dds(in);}
\DoxyCodeLine{03778\ }
\DoxyCodeLine{03779\ \ \ \textcolor{comment}{//\ DDS\ header\ (19\ words)}}
\DoxyCodeLine{03780\ \ \ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ header;}
\DoxyCodeLine{03781\ \ \ header.dds\_magic\ =\ dds.get\_uint32();}
\DoxyCodeLine{03782\ \ \ header.dds\_size\ =\ dds.get\_uint32();}
\DoxyCodeLine{03783\ \ \ header.dds\_flags\ =\ dds.get\_uint32();}
\DoxyCodeLine{03784\ \ \ header.height\ =\ dds.get\_uint32();}
\DoxyCodeLine{03785\ \ \ header.width\ =\ dds.get\_uint32();}
\DoxyCodeLine{03786\ \ \ header.pitch\ =\ dds.get\_uint32();}
\DoxyCodeLine{03787\ \ \ header.depth\ =\ dds.get\_uint32();}
\DoxyCodeLine{03788\ \ \ header.num\_levels\ =\ dds.get\_uint32();}
\DoxyCodeLine{03789\ \ \ dds.skip\_bytes(44);}
\DoxyCodeLine{03790\ }
\DoxyCodeLine{03791\ \ \ \textcolor{comment}{//\ Pixelformat\ (8\ words)}}
\DoxyCodeLine{03792\ \ \ header.pf.pf\_size\ =\ dds.get\_uint32();}
\DoxyCodeLine{03793\ \ \ header.pf.pf\_flags\ =\ dds.get\_uint32();}
\DoxyCodeLine{03794\ \ \ header.pf.four\_cc\ =\ dds.get\_uint32();}
\DoxyCodeLine{03795\ \ \ header.pf.rgb\_bitcount\ =\ dds.get\_uint32();}
\DoxyCodeLine{03796\ \ \ header.pf.r\_mask\ =\ dds.get\_uint32();}
\DoxyCodeLine{03797\ \ \ header.pf.g\_mask\ =\ dds.get\_uint32();}
\DoxyCodeLine{03798\ \ \ header.pf.b\_mask\ =\ dds.get\_uint32();}
\DoxyCodeLine{03799\ \ \ header.pf.a\_mask\ =\ dds.get\_uint32();}
\DoxyCodeLine{03800\ }
\DoxyCodeLine{03801\ \ \ \textcolor{comment}{//\ Caps\ (4\ words)}}
\DoxyCodeLine{03802\ \ \ header.caps.caps1\ =\ dds.get\_uint32();}
\DoxyCodeLine{03803\ \ \ header.caps.caps2\ =\ dds.get\_uint32();}
\DoxyCodeLine{03804\ \ \ header.caps.ddsx\ =\ dds.get\_uint32();}
\DoxyCodeLine{03805\ \ \ dds.skip\_bytes(4);}
\DoxyCodeLine{03806\ }
\DoxyCodeLine{03807\ \ \ \textcolor{comment}{//\ Pad\ out\ to\ 32\ words}}
\DoxyCodeLine{03808\ \ \ dds.skip\_bytes(4);}
\DoxyCodeLine{03809\ }
\DoxyCodeLine{03810\ \ \ \textcolor{keywordflow}{if}\ (header.dds\_magic\ !=\ DDS\_MAGIC\ ||\ (in.fail()\ ||\ in.eof()))\ \{}
\DoxyCodeLine{03811\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03812\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ DDS\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{03813\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03814\ \ \ \}}
\DoxyCodeLine{03815\ }
\DoxyCodeLine{03816\ \ \ \textcolor{keywordflow}{if}\ ((header.dds\_flags\ \&\ DDSD\_MIPMAPCOUNT)\ ==\ 0)\ \{}
\DoxyCodeLine{03817\ \ \ \ \ \textcolor{comment}{//\ No\ bit\ set\ means\ only\ the\ base\ mipmap\ level.}}
\DoxyCodeLine{03818\ \ \ \ \ header.num\_levels\ =\ 1;}
\DoxyCodeLine{03819\ }
\DoxyCodeLine{03820\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.num\_levels\ ==\ 0)\ \{}
\DoxyCodeLine{03821\ \ \ \ \ \textcolor{comment}{//\ Some\ files\ seem\ to\ have\ this\ set\ to\ 0\ for\ some\ reason-\/-\/existing\ readers}}
\DoxyCodeLine{03822\ \ \ \ \ \textcolor{comment}{//\ assume\ 0\ means\ 1.}}
\DoxyCodeLine{03823\ \ \ \ \ header.num\_levels\ =\ 1;}
\DoxyCodeLine{03824\ \ \ \}}
\DoxyCodeLine{03825\ }
\DoxyCodeLine{03826\ \ \ TextureType\ texture\_type;}
\DoxyCodeLine{03827\ \ \ \textcolor{keywordflow}{if}\ (header.caps.caps2\ \&\ DDSCAPS2\_CUBEMAP)\ \{}
\DoxyCodeLine{03828\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ all\_faces\ =}
\DoxyCodeLine{03829\ \ \ \ \ \ \ (DDSCAPS2\_CUBEMAP\_POSITIVEX\ |}
\DoxyCodeLine{03830\ \ \ \ \ \ \ \ DDSCAPS2\_CUBEMAP\_POSITIVEY\ |}
\DoxyCodeLine{03831\ \ \ \ \ \ \ \ DDSCAPS2\_CUBEMAP\_POSITIVEZ\ |}
\DoxyCodeLine{03832\ \ \ \ \ \ \ \ DDSCAPS2\_CUBEMAP\_NEGATIVEX\ |}
\DoxyCodeLine{03833\ \ \ \ \ \ \ \ DDSCAPS2\_CUBEMAP\_NEGATIVEY\ |}
\DoxyCodeLine{03834\ \ \ \ \ \ \ \ DDSCAPS2\_CUBEMAP\_NEGATIVEZ);}
\DoxyCodeLine{03835\ \ \ \ \ \textcolor{keywordflow}{if}\ ((header.caps.caps2\ \&\ all\_faces)\ !=\ all\_faces)\ \{}
\DoxyCodeLine{03836\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{03837\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ missing\ some\ cube\ map\ faces;\ cannot\ load.\(\backslash\)n"{}};}
\DoxyCodeLine{03838\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{03839\ \ \ \ \ \}}
\DoxyCodeLine{03840\ \ \ \ \ header.depth\ =\ 6;}
\DoxyCodeLine{03841\ \ \ \ \ texture\_type\ =\ TT\_cube\_map;}
\DoxyCodeLine{03842\ }
\DoxyCodeLine{03843\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.caps.caps2\ \&\ DDSCAPS2\_VOLUME)\ \{}
\DoxyCodeLine{03844\ \ \ \ \ texture\_type\ =\ TT\_3d\_texture;}
\DoxyCodeLine{03845\ }
\DoxyCodeLine{03846\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03847\ \ \ \ \ texture\_type\ =\ TT\_2d\_texture;}
\DoxyCodeLine{03848\ \ \ \ \ header.depth\ =\ 1;}
\DoxyCodeLine{03849\ \ \ \}}
\DoxyCodeLine{03850\ }
\DoxyCodeLine{03851\ \ \ \textcolor{comment}{//\ Determine\ the\ function\ to\ use\ to\ read\ the\ DDS\ image.}}
\DoxyCodeLine{03852\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{pta__uchar_8h_a41b9710d305d1a1af615ccb3d2fd3cb5}{PTA\_uchar}}\ (*ReadDDSLevelFunc)(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ \mbox{\hyperlink{classTexture_1_1CData}{Texture::CData}}\ *cdata,}
\DoxyCodeLine{03853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in);}
\DoxyCodeLine{03854\ \ \ ReadDDSLevelFunc\ func\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03855\ }
\DoxyCodeLine{03856\ \ \ Format\ format\ =\ F\_rgb;}
\DoxyCodeLine{03857\ \ \ ComponentType\ component\_type\ =\ T\_unsigned\_byte;}
\DoxyCodeLine{03858\ }
\DoxyCodeLine{03859\ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{03860\ \ \ CompressionMode\ compression\ =\ CM\_off;}
\DoxyCodeLine{03861\ }
\DoxyCodeLine{03862\ \ \ \textcolor{keywordflow}{if}\ ((header.pf.pf\_flags\ \&\ DDPF\_FOURCC)\ !=\ 0\ \&\&}
\DoxyCodeLine{03863\ \ \ \ \ \ \ header.pf.four\_cc\ ==\ 0x30315844)\ \{\ \ \ \textcolor{comment}{//\ 'DX10'}}
\DoxyCodeLine{03864\ \ \ \ \ \textcolor{comment}{//\ A\ DirectX\ 10\ style\ texture,\ which\ has\ an\ additional\ header.}}
\DoxyCodeLine{03865\ \ \ \ \ func\ =\ read\_dds\_level\_generic\_uncompressed;}
\DoxyCodeLine{03866\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ dxgi\_format\ =\ dds.get\_uint32();}
\DoxyCodeLine{03867\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ dimension\ =\ dds.get\_uint32();}
\DoxyCodeLine{03868\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ misc\_flag\ =\ dds.get\_uint32();}
\DoxyCodeLine{03869\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ array\_size\ =\ dds.get\_uint32();}
\DoxyCodeLine{03870\ \ \ \ \ \textcolor{comment}{/*unsigned\ int\ alpha\_mode\ =\ */}dds.get\_uint32();}
\DoxyCodeLine{03871\ }
\DoxyCodeLine{03872\ \ \ \ \ \textcolor{keywordflow}{switch}\ (dxgi\_format)\ \{}
\DoxyCodeLine{03873\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32G32B32A32\_FLOAT}}
\DoxyCodeLine{03874\ \ \ \ \ \ \ format\ =\ F\_rgba32;}
\DoxyCodeLine{03875\ \ \ \ \ \ \ component\_type\ =\ T\_float;}
\DoxyCodeLine{03876\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr32;}
\DoxyCodeLine{03877\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03878\ \ \ \ \ \textcolor{keywordflow}{case}\ 10:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16B16A16\_FLOAT}}
\DoxyCodeLine{03879\ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{03880\ \ \ \ \ \ \ component\_type\ =\ T\_half\_float;}
\DoxyCodeLine{03881\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{03882\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03883\ \ \ \ \ \textcolor{keywordflow}{case}\ 11:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16B16A16\_UNORM}}
\DoxyCodeLine{03884\ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{03885\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{03886\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{03887\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03888\ \ \ \ \ \textcolor{keywordflow}{case}\ 12:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16B16A16\_UINT}}
\DoxyCodeLine{03889\ \ \ \ \ \ \ format\ =\ F\_rgba16i;}
\DoxyCodeLine{03890\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{03891\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{03892\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03893\ \ \ \ \ \textcolor{keywordflow}{case}\ 14:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16B16A16\_SINT}}
\DoxyCodeLine{03894\ \ \ \ \ \ \ format\ =\ F\_rgba16i;}
\DoxyCodeLine{03895\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{03896\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{03897\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03898\ \ \ \ \ \textcolor{keywordflow}{case}\ 16:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32G32\_FLOAT}}
\DoxyCodeLine{03899\ \ \ \ \ \ \ format\ =\ F\_rg32;}
\DoxyCodeLine{03900\ \ \ \ \ \ \ component\_type\ =\ T\_float;}
\DoxyCodeLine{03901\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03902\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03903\ \ \ \ \ \textcolor{keywordflow}{case}\ 17:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32G32\_UINT}}
\DoxyCodeLine{03904\ \ \ \ \ \ \ format\ =\ F\_rg32i;}
\DoxyCodeLine{03905\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_int;}
\DoxyCodeLine{03906\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03907\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03908\ \ \ \ \ \textcolor{keywordflow}{case}\ 18:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32G32\_SINT}}
\DoxyCodeLine{03909\ \ \ \ \ \ \ format\ =\ F\_rg32i;}
\DoxyCodeLine{03910\ \ \ \ \ \ \ component\_type\ =\ T\_int;}
\DoxyCodeLine{03911\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03912\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03913\ \ \ \ \ \textcolor{keywordflow}{case}\ 27:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_TYPELESS}}
\DoxyCodeLine{03914\ \ \ \ \ \textcolor{keywordflow}{case}\ 28:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_UNORM}}
\DoxyCodeLine{03915\ \ \ \ \ \ \ format\ =\ F\_rgba8;}
\DoxyCodeLine{03916\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{03917\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03918\ \ \ \ \ \textcolor{keywordflow}{case}\ 29:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_UNORM\_SRGB}}
\DoxyCodeLine{03919\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{03920\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{03921\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03922\ \ \ \ \ \textcolor{keywordflow}{case}\ 30:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_UINT}}
\DoxyCodeLine{03923\ \ \ \ \ \ \ format\ =\ F\_rgba8i;}
\DoxyCodeLine{03924\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{03925\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03926\ \ \ \ \ \textcolor{keywordflow}{case}\ 31:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_SNORM}}
\DoxyCodeLine{03927\ \ \ \ \ \ \ format\ =\ F\_rgba8;}
\DoxyCodeLine{03928\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{03929\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{03930\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03931\ \ \ \ \ \textcolor{keywordflow}{case}\ 32:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8B8A8\_SINT}}
\DoxyCodeLine{03932\ \ \ \ \ \ \ format\ =\ F\_rgba8i;}
\DoxyCodeLine{03933\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{03934\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{03935\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03936\ \ \ \ \ \textcolor{keywordflow}{case}\ 34:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16\_FLOAT:}}
\DoxyCodeLine{03937\ \ \ \ \ \ \ format\ =\ F\_rg16;}
\DoxyCodeLine{03938\ \ \ \ \ \ \ component\_type\ =\ T\_half\_float;}
\DoxyCodeLine{03939\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03940\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03941\ \ \ \ \ \textcolor{keywordflow}{case}\ 35:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16\_UNORM:}}
\DoxyCodeLine{03942\ \ \ \ \ \ \ format\ =\ F\_rg16;}
\DoxyCodeLine{03943\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{03944\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03945\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03946\ \ \ \ \ \textcolor{keywordflow}{case}\ 36:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16\_UINT:}}
\DoxyCodeLine{03947\ \ \ \ \ \ \ format\ =\ F\_rg16i;}
\DoxyCodeLine{03948\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{03949\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03950\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03951\ \ \ \ \ \textcolor{keywordflow}{case}\ 37:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16\_SNORM:}}
\DoxyCodeLine{03952\ \ \ \ \ \ \ format\ =\ F\_rg16;}
\DoxyCodeLine{03953\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{03954\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03955\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03956\ \ \ \ \ \textcolor{keywordflow}{case}\ 38:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16G16\_SINT:}}
\DoxyCodeLine{03957\ \ \ \ \ \ \ format\ =\ F\_rg16i;}
\DoxyCodeLine{03958\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{03959\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03960\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03961\ \ \ \ \ \textcolor{keywordflow}{case}\ 40:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_D32\_FLOAT}}
\DoxyCodeLine{03962\ \ \ \ \ \ \ format\ =\ F\_depth\_component32;}
\DoxyCodeLine{03963\ \ \ \ \ \ \ component\_type\ =\ T\_float;}
\DoxyCodeLine{03964\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03965\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03966\ \ \ \ \ \textcolor{keywordflow}{case}\ 41:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32\_FLOAT}}
\DoxyCodeLine{03967\ \ \ \ \ \ \ format\ =\ F\_r32;}
\DoxyCodeLine{03968\ \ \ \ \ \ \ component\_type\ =\ T\_float;}
\DoxyCodeLine{03969\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03970\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03971\ \ \ \ \ \textcolor{keywordflow}{case}\ 42:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32\_UINT}}
\DoxyCodeLine{03972\ \ \ \ \ \ \ format\ =\ F\_r32i;}
\DoxyCodeLine{03973\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_int;}
\DoxyCodeLine{03974\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03975\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03976\ \ \ \ \ \textcolor{keywordflow}{case}\ 43:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R32\_SINT}}
\DoxyCodeLine{03977\ \ \ \ \ \ \ format\ =\ F\_r32i;}
\DoxyCodeLine{03978\ \ \ \ \ \ \ component\_type\ =\ T\_int;}
\DoxyCodeLine{03979\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{03980\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03981\ \ \ \ \ \textcolor{keywordflow}{case}\ 48:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8\_TYPELESS}}
\DoxyCodeLine{03982\ \ \ \ \ \textcolor{keywordflow}{case}\ 49:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8\_UNORM}}
\DoxyCodeLine{03983\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{03984\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03985\ \ \ \ \ \textcolor{keywordflow}{case}\ 50:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8\_UINT}}
\DoxyCodeLine{03986\ \ \ \ \ \ \ format\ =\ F\_rg8i;}
\DoxyCodeLine{03987\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03988\ \ \ \ \ \textcolor{keywordflow}{case}\ 51:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8\_SNORM}}
\DoxyCodeLine{03989\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{03990\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{03991\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03992\ \ \ \ \ \textcolor{keywordflow}{case}\ 52:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8G8\_SINT}}
\DoxyCodeLine{03993\ \ \ \ \ \ \ format\ =\ F\_rg8i;}
\DoxyCodeLine{03994\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{03995\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03996\ \ \ \ \ \textcolor{keywordflow}{case}\ 54:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16\_FLOAT:}}
\DoxyCodeLine{03997\ \ \ \ \ \ \ format\ =\ F\_r16;}
\DoxyCodeLine{03998\ \ \ \ \ \ \ component\_type\ =\ T\_half\_float;}
\DoxyCodeLine{03999\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04000\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04001\ \ \ \ \ \textcolor{keywordflow}{case}\ 55:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_D16\_UNORM:}}
\DoxyCodeLine{04002\ \ \ \ \ \ \ format\ =\ F\_depth\_component16;}
\DoxyCodeLine{04003\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{04004\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04005\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04006\ \ \ \ \ \textcolor{keywordflow}{case}\ 56:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16\_UNORM:}}
\DoxyCodeLine{04007\ \ \ \ \ \ \ format\ =\ F\_r16;}
\DoxyCodeLine{04008\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{04009\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04010\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04011\ \ \ \ \ \textcolor{keywordflow}{case}\ 57:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16\_UINT:}}
\DoxyCodeLine{04012\ \ \ \ \ \ \ format\ =\ F\_r16i;}
\DoxyCodeLine{04013\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{04014\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04015\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04016\ \ \ \ \ \textcolor{keywordflow}{case}\ 58:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16\_SNORM:}}
\DoxyCodeLine{04017\ \ \ \ \ \ \ format\ =\ F\_r16;}
\DoxyCodeLine{04018\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{04019\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04020\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04021\ \ \ \ \ \textcolor{keywordflow}{case}\ 59:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R16\_SINT:}}
\DoxyCodeLine{04022\ \ \ \ \ \ \ format\ =\ F\_r16i;}
\DoxyCodeLine{04023\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{04024\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_raw;}
\DoxyCodeLine{04025\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04026\ \ \ \ \ \textcolor{keywordflow}{case}\ 60:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8\_TYPELESS}}
\DoxyCodeLine{04027\ \ \ \ \ \textcolor{keywordflow}{case}\ 61:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8\_UNORM}}
\DoxyCodeLine{04028\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04029\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04030\ \ \ \ \ \textcolor{keywordflow}{case}\ 62:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8\_UINT}}
\DoxyCodeLine{04031\ \ \ \ \ \ \ format\ =\ F\_r8i;}
\DoxyCodeLine{04032\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04033\ \ \ \ \ \textcolor{keywordflow}{case}\ 63:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8\_SNORM}}
\DoxyCodeLine{04034\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04035\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{04036\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04037\ \ \ \ \ \textcolor{keywordflow}{case}\ 64:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_R8\_SINT}}
\DoxyCodeLine{04038\ \ \ \ \ \ \ format\ =\ F\_r8i;}
\DoxyCodeLine{04039\ \ \ \ \ \ \ component\_type\ =\ T\_byte;}
\DoxyCodeLine{04040\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04041\ \ \ \ \ \textcolor{keywordflow}{case}\ 65:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_A8\_UNORM}}
\DoxyCodeLine{04042\ \ \ \ \ \ \ format\ =\ F\_alpha;}
\DoxyCodeLine{04043\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04044\ \ \ \ \ \textcolor{keywordflow}{case}\ 70:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC1\_TYPELESS}}
\DoxyCodeLine{04045\ \ \ \ \ \textcolor{keywordflow}{case}\ 71:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC1\_UNORM}}
\DoxyCodeLine{04046\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04047\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04048\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc1;}
\DoxyCodeLine{04049\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04050\ \ \ \ \ \textcolor{keywordflow}{case}\ 72:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC1\_UNORM\_SRGB}}
\DoxyCodeLine{04051\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04052\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04053\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc1;}
\DoxyCodeLine{04054\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04055\ \ \ \ \ \textcolor{keywordflow}{case}\ 73:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC2\_TYPELESS}}
\DoxyCodeLine{04056\ \ \ \ \ \textcolor{keywordflow}{case}\ 74:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC2\_UNORM}}
\DoxyCodeLine{04057\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04058\ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{04059\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc2;}
\DoxyCodeLine{04060\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04061\ \ \ \ \ \textcolor{keywordflow}{case}\ 75:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC2\_UNORM\_SRGB}}
\DoxyCodeLine{04062\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04063\ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{04064\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc2;}
\DoxyCodeLine{04065\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04066\ \ \ \ \ \textcolor{keywordflow}{case}\ 76:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC3\_TYPELESS}}
\DoxyCodeLine{04067\ \ \ \ \ \textcolor{keywordflow}{case}\ 77:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC3\_UNORM}}
\DoxyCodeLine{04068\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04069\ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{04070\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc3;}
\DoxyCodeLine{04071\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04072\ \ \ \ \ \textcolor{keywordflow}{case}\ 78:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC3\_UNORM\_SRGB}}
\DoxyCodeLine{04073\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04074\ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{04075\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc3;}
\DoxyCodeLine{04076\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04077\ \ \ \ \ \textcolor{keywordflow}{case}\ 79:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC4\_TYPELESS}}
\DoxyCodeLine{04078\ \ \ \ \ \textcolor{keywordflow}{case}\ 80:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC4\_UNORM}}
\DoxyCodeLine{04079\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04080\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04081\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc4;}
\DoxyCodeLine{04082\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04083\ \ \ \ \ \textcolor{keywordflow}{case}\ 82:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC5\_TYPELESS}}
\DoxyCodeLine{04084\ \ \ \ \ \textcolor{keywordflow}{case}\ 83:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_BC5\_UNORM}}
\DoxyCodeLine{04085\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04086\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04087\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc5;}
\DoxyCodeLine{04088\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04089\ \ \ \ \ \textcolor{keywordflow}{case}\ 87:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8A8\_UNORM}}
\DoxyCodeLine{04090\ \ \ \ \ \textcolor{keywordflow}{case}\ 90:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8A8\_TYPELESS}}
\DoxyCodeLine{04091\ \ \ \ \ \ \ format\ =\ F\_rgba8;}
\DoxyCodeLine{04092\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04093\ \ \ \ \ \textcolor{keywordflow}{case}\ 88:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8X8\_UNORM}}
\DoxyCodeLine{04094\ \ \ \ \ \textcolor{keywordflow}{case}\ 92:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8X8\_TYPELESS}}
\DoxyCodeLine{04095\ \ \ \ \ \ \ format\ =\ F\_rgb8;}
\DoxyCodeLine{04096\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04097\ \ \ \ \ \textcolor{keywordflow}{case}\ 91:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8A8\_UNORM\_SRGB}}
\DoxyCodeLine{04098\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04099\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04100\ \ \ \ \ \textcolor{keywordflow}{case}\ 93:\ \ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B8G8R8X8\_UNORM\_SRGB}}
\DoxyCodeLine{04101\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04102\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04103\ \ \ \ \ \textcolor{keywordflow}{case}\ 115:\ \ \textcolor{comment}{//\ DXGI\_FORMAT\_B4G4R4A4\_UNORM}}
\DoxyCodeLine{04104\ \ \ \ \ \ \ format\ =\ F\_rgba4;}
\DoxyCodeLine{04105\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04106\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04107\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04108\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ unsupported\ DXGI\ format\ "{}}\ <<\ dxgi\_format\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{04109\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04110\ \ \ \ \ \}}
\DoxyCodeLine{04111\ }
\DoxyCodeLine{04112\ \ \ \ \ \textcolor{keywordflow}{switch}\ (dimension)\ \{}
\DoxyCodeLine{04113\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ \ \textcolor{comment}{//\ DDS\_DIMENSION\_TEXTURE1D}}
\DoxyCodeLine{04114\ \ \ \ \ \ \ texture\_type\ =\ TT\_1d\_texture;}
\DoxyCodeLine{04115\ \ \ \ \ \ \ header.depth\ =\ 1;}
\DoxyCodeLine{04116\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04117\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ \ \textcolor{comment}{//\ DDS\_DIMENSION\_TEXTURE2D}}
\DoxyCodeLine{04118\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (misc\_flag\ \&\ 0x4)\ \{\ \ \textcolor{comment}{//\ DDS\_RESOURCE\_MISC\_TEXTURECUBE}}
\DoxyCodeLine{04119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (array\_size\ >\ 1)\ \{}
\DoxyCodeLine{04120\ \ \ \ \ \ \ \ \ \ \ texture\_type\ =\ TT\_cube\_map\_array;}
\DoxyCodeLine{04121\ \ \ \ \ \ \ \ \ \ \ header.depth\ =\ array\_size\ *\ 6;}
\DoxyCodeLine{04122\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04123\ \ \ \ \ \ \ \ \ \ \ texture\_type\ =\ TT\_cube\_map;}
\DoxyCodeLine{04124\ \ \ \ \ \ \ \ \ \ \ header.depth\ =\ 6;}
\DoxyCodeLine{04125\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04126\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (array\_size\ >\ 1)\ \{}
\DoxyCodeLine{04128\ \ \ \ \ \ \ \ \ \ \ texture\_type\ =\ TT\_2d\_texture\_array;}
\DoxyCodeLine{04129\ \ \ \ \ \ \ \ \ \ \ header.depth\ =\ array\_size;}
\DoxyCodeLine{04130\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04131\ \ \ \ \ \ \ \ \ \ \ texture\_type\ =\ TT\_2d\_texture;}
\DoxyCodeLine{04132\ \ \ \ \ \ \ \ \ \ \ header.depth\ =\ 1;}
\DoxyCodeLine{04133\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04134\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04135\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04136\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:\ \ \textcolor{comment}{//\ DDS\_DIMENSION\_TEXTURE3D}}
\DoxyCodeLine{04137\ \ \ \ \ \ \ texture\_type\ =\ TT\_3d\_texture;}
\DoxyCodeLine{04138\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04139\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04140\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04141\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ unsupported\ dimension.\(\backslash\)n"{}};}
\DoxyCodeLine{04142\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04143\ \ \ \ \ \}}
\DoxyCodeLine{04144\ }
\DoxyCodeLine{04145\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.pf.pf\_flags\ \&\ DDPF\_FOURCC)\ \{}
\DoxyCodeLine{04146\ \ \ \ \ \textcolor{comment}{//\ Some\ compressed\ texture\ format.}}
\DoxyCodeLine{04147\ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ ==\ TT\_3d\_texture)\ \{}
\DoxyCodeLine{04148\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04149\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ unsupported\ compression\ on\ 3-\/d\ texture.\(\backslash\)n"{}};}
\DoxyCodeLine{04150\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04151\ \ \ \ \ \}}
\DoxyCodeLine{04152\ }
\DoxyCodeLine{04153\ \ \ \ \ \textcolor{comment}{//\ Most\ of\ the\ compressed\ formats\ support\ alpha.}}
\DoxyCodeLine{04154\ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04155\ \ \ \ \ \textcolor{keywordflow}{switch}\ (header.pf.four\_cc)\ \{}
\DoxyCodeLine{04156\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x31545844:\ \ \ \textcolor{comment}{//\ 'DXT1',\ little-\/endian.}}
\DoxyCodeLine{04157\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04158\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc1;}
\DoxyCodeLine{04159\ \ \ \ \ \ \ format\ =\ F\_rgbm;}
\DoxyCodeLine{04160\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04161\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x32545844:\ \ \ \textcolor{comment}{//\ 'DXT2'}}
\DoxyCodeLine{04162\ \ \ \ \ \ \ compression\ =\ CM\_dxt2;}
\DoxyCodeLine{04163\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc2;}
\DoxyCodeLine{04164\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04165\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x33545844:\ \ \ \textcolor{comment}{//\ 'DXT3'}}
\DoxyCodeLine{04166\ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{04167\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc2;}
\DoxyCodeLine{04168\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04169\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x34545844:\ \ \ \textcolor{comment}{//\ 'DXT4'}}
\DoxyCodeLine{04170\ \ \ \ \ \ \ compression\ =\ CM\_dxt4;}
\DoxyCodeLine{04171\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc3;}
\DoxyCodeLine{04172\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04173\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x35545844:\ \ \ \textcolor{comment}{//\ 'DXT5'}}
\DoxyCodeLine{04174\ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{04175\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc3;}
\DoxyCodeLine{04176\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04177\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x31495441:\ \ \ \textcolor{comment}{//\ 'ATI1'}}
\DoxyCodeLine{04178\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x55344342:\ \ \ \textcolor{comment}{//\ 'BC4U'}}
\DoxyCodeLine{04179\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04180\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc4;}
\DoxyCodeLine{04181\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04182\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04183\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x32495441:\ \ \ \textcolor{comment}{//\ 'ATI2'}}
\DoxyCodeLine{04184\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x55354342:\ \ \ \textcolor{comment}{//\ 'BC5U'}}
\DoxyCodeLine{04185\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04186\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bc5;}
\DoxyCodeLine{04187\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04188\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04189\ \ \ \ \ \textcolor{keywordflow}{case}\ 36:\ \ \ \textcolor{comment}{//\ D3DFMT\_A16B16G16R16}}
\DoxyCodeLine{04190\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{04191\ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{04192\ \ \ \ \ \ \ component\_type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{04193\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04194\ \ \ \ \ \textcolor{keywordflow}{case}\ 110:\ \ \textcolor{comment}{//\ D3DFMT\_Q16W16V16U16}}
\DoxyCodeLine{04195\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{04196\ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{04197\ \ \ \ \ \ \ component\_type\ =\ T\_short;}
\DoxyCodeLine{04198\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04199\ \ \ \ \ \textcolor{keywordflow}{case}\ 113:\ \ \textcolor{comment}{//\ D3DFMT\_A16B16G16R16F}}
\DoxyCodeLine{04200\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr16;}
\DoxyCodeLine{04201\ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{04202\ \ \ \ \ \ \ component\_type\ =\ T\_half\_float;}
\DoxyCodeLine{04203\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04204\ \ \ \ \ \textcolor{keywordflow}{case}\ 116:\ \ \textcolor{comment}{//\ D3DFMT\_A32B32G32R32F}}
\DoxyCodeLine{04205\ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr32;}
\DoxyCodeLine{04206\ \ \ \ \ \ \ format\ =\ F\_rgba32;}
\DoxyCodeLine{04207\ \ \ \ \ \ \ component\_type\ =\ T\_float;}
\DoxyCodeLine{04208\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04209\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04210\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04211\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ unsupported\ texture\ compression\ (FourCC:\ 0x"{}}}
\DoxyCodeLine{04212\ \ \ \ \ \ \ \ \ <<\ std::hex\ <<\ header.pf.four\_cc\ <<\ std::dec\ <<\ \textcolor{stringliteral}{"{}).\(\backslash\)n"{}};}
\DoxyCodeLine{04213\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04214\ \ \ \ \ \}}
\DoxyCodeLine{04215\ }
\DoxyCodeLine{04216\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04217\ \ \ \ \ \textcolor{comment}{//\ An\ uncompressed\ texture\ format.}}
\DoxyCodeLine{04218\ \ \ \ \ func\ =\ read\_dds\_level\_generic\_uncompressed;}
\DoxyCodeLine{04219\ }
\DoxyCodeLine{04220\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.pf.pf\_flags\ \&\ DDPF\_ALPHAPIXELS)\ \{}
\DoxyCodeLine{04221\ \ \ \ \ \ \ \textcolor{comment}{//\ An\ uncompressed\ format\ that\ involves\ alpha.}}
\DoxyCodeLine{04222\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04223\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (header.pf.rgb\_bitcount\ ==\ 32\ \&\&}
\DoxyCodeLine{04224\ \ \ \ \ \ \ \ \ \ \ header.pf.r\_mask\ ==\ 0x000000ff\ \&\&}
\DoxyCodeLine{04225\ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0x0000ff00\ \&\&}
\DoxyCodeLine{04226\ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0x00ff0000\ \&\&}
\DoxyCodeLine{04227\ \ \ \ \ \ \ \ \ \ \ header.pf.a\_mask\ ==\ 0xff000000U)\ \{}
\DoxyCodeLine{04228\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_abgr8;}
\DoxyCodeLine{04229\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.pf.rgb\_bitcount\ ==\ 32\ \&\&}
\DoxyCodeLine{04230\ \ \ \ \ \ \ \ \ \ \ header.pf.r\_mask\ ==\ 0x00ff0000\ \&\&}
\DoxyCodeLine{04231\ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0x0000ff00\ \&\&}
\DoxyCodeLine{04232\ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0x000000ff\ \&\&}
\DoxyCodeLine{04233\ \ \ \ \ \ \ \ \ \ \ header.pf.a\_mask\ ==\ 0xff000000U)\ \{}
\DoxyCodeLine{04234\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_rgba8;}
\DoxyCodeLine{04235\ }
\DoxyCodeLine{04236\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.pf.r\_mask\ !=\ 0\ \&\&}
\DoxyCodeLine{04237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0\ \&\&}
\DoxyCodeLine{04238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0)\ \{}
\DoxyCodeLine{04239\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_luminance\_uncompressed;}
\DoxyCodeLine{04240\ \ \ \ \ \ \ \ \ format\ =\ F\_luminance\_alpha;}
\DoxyCodeLine{04241\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04242\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04243\ \ \ \ \ \ \ \textcolor{comment}{//\ An\ uncompressed\ format\ that\ doesn't\ involve\ alpha.}}
\DoxyCodeLine{04244\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (header.pf.rgb\_bitcount\ ==\ 24\ \&\&}
\DoxyCodeLine{04245\ \ \ \ \ \ \ \ \ \ \ header.pf.r\_mask\ ==\ 0x00ff0000\ \&\&}
\DoxyCodeLine{04246\ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0x0000ff00\ \&\&}
\DoxyCodeLine{04247\ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0x000000ff)\ \{}
\DoxyCodeLine{04248\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_bgr8;}
\DoxyCodeLine{04249\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.pf.rgb\_bitcount\ ==\ 24\ \&\&}
\DoxyCodeLine{04250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.r\_mask\ ==\ 0x000000ff\ \&\&}
\DoxyCodeLine{04251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0x0000ff00\ \&\&}
\DoxyCodeLine{04252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0x00ff0000)\ \{}
\DoxyCodeLine{04253\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_rgb8;}
\DoxyCodeLine{04254\ }
\DoxyCodeLine{04255\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (header.pf.r\_mask\ !=\ 0\ \&\&}
\DoxyCodeLine{04256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.g\_mask\ ==\ 0\ \&\&}
\DoxyCodeLine{04257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ header.pf.b\_mask\ ==\ 0)\ \{}
\DoxyCodeLine{04258\ \ \ \ \ \ \ \ \ func\ =\ read\_dds\_level\_luminance\_uncompressed;}
\DoxyCodeLine{04259\ \ \ \ \ \ \ \ \ format\ =\ F\_luminance;}
\DoxyCodeLine{04260\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04261\ \ \ \ \ \}}
\DoxyCodeLine{04262\ \ \ \}}
\DoxyCodeLine{04263\ }
\DoxyCodeLine{04264\ \ \ do\_setup\_texture(cdata,\ texture\_type,\ header.width,\ header.height,\ header.depth,}
\DoxyCodeLine{04265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ format);}
\DoxyCodeLine{04266\ }
\DoxyCodeLine{04267\ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{04268\ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{04269\ \ \ cdata-\/>\_compression\ =\ compression;}
\DoxyCodeLine{04270\ \ \ cdata-\/>\_ram\_image\_compression\ =\ compression;}
\DoxyCodeLine{04271\ }
\DoxyCodeLine{04272\ \ \ \textcolor{keywordflow}{if}\ (!header\_only)\ \{}
\DoxyCodeLine{04273\ \ \ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{04274\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_3d\_texture:}
\DoxyCodeLine{04275\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04276\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 3-\/d\ textures\ store\ all\ the\ depth\ slices\ for\ mipmap\ level\ 0,\ then}}
\DoxyCodeLine{04277\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ the\ depth\ slices\ for\ mipmap\ level\ 1,\ and\ so\ on.}}
\DoxyCodeLine{04278\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04279\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z\_size\ =\ do\_get\_expected\_mipmap\_z\_size(cdata,\ n);}
\DoxyCodeLine{04280\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<PTA\_uchar>}}\ pages;}
\DoxyCodeLine{04281\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ 0;}
\DoxyCodeLine{04282\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z;}
\DoxyCodeLine{04283\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ z\_size;\ ++z)\ \{}
\DoxyCodeLine{04284\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ page\ =\ func(\textcolor{keyword}{this},\ cdata,\ header,\ n,\ in);}
\DoxyCodeLine{04285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (page.is\_null())\ \{}
\DoxyCodeLine{04286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04287\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04288\ \ \ \ \ \ \ \ \ \ \ \ \ nassertr(page\_size\ ==\ 0\ ||\ page\_size\ ==\ page.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{04289\ \ \ \ \ \ \ \ \ \ \ \ \ page\_size\ =\ page.size();}
\DoxyCodeLine{04290\ \ \ \ \ \ \ \ \ \ \ \ \ pages.push\_back(page);}
\DoxyCodeLine{04291\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04292\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ reassemble\ the\ pages\ into\ one\ big\ image.\ \ Because\ this\ is\ a}}
\DoxyCodeLine{04293\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Microsoft\ format,\ the\ images\ are\ stacked\ in\ reverse\ order;\ re-\/}}
\DoxyCodeLine{04294\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ reverse\ them.}}
\DoxyCodeLine{04295\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ z\_size);}
\DoxyCodeLine{04296\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *imagep\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)image.p();}
\DoxyCodeLine{04297\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ z\_size;\ ++z)\ \{}
\DoxyCodeLine{04298\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fz\ =\ z\_size\ -\/\ 1\ -\/\ z;}
\DoxyCodeLine{04299\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(imagep\ +\ z\ *\ page\_size,\ pages[fz].p(),\ page\_size);}
\DoxyCodeLine{04300\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04301\ }
\DoxyCodeLine{04302\ \ \ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ n,\ image,\ page\_size);}
\DoxyCodeLine{04303\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04304\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04305\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04306\ }
\DoxyCodeLine{04307\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{04308\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04309\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Cube\ maps\ store\ all\ the\ mipmap\ levels\ for\ face\ 0,\ then\ all\ the}}
\DoxyCodeLine{04310\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ mipmap\ levels\ for\ face\ 1,\ and\ so\ on.}}
\DoxyCodeLine{04311\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<pvector<PTA\_uchar>}}\ >\ pages;}
\DoxyCodeLine{04312\ \ \ \ \ \ \ \ \ pages.reserve(6);}
\DoxyCodeLine{04313\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z,\ n;}
\DoxyCodeLine{04314\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ 6;\ ++z)\ \{}
\DoxyCodeLine{04315\ \ \ \ \ \ \ \ \ \ \ pages.push\_back(\mbox{\hyperlink{classpvector}{pvector<PTA\_uchar>}}());}
\DoxyCodeLine{04316\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<PTA\_uchar>}}\ \&levels\ =\ pages.back();}
\DoxyCodeLine{04317\ \ \ \ \ \ \ \ \ \ \ levels.reserve(header.num\_levels);}
\DoxyCodeLine{04318\ }
\DoxyCodeLine{04319\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04320\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ func(\textcolor{keyword}{this},\ cdata,\ header,\ n,\ in);}
\DoxyCodeLine{04321\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{04322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04323\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04324\ \ \ \ \ \ \ \ \ \ \ \ \ levels.push\_back(image);}
\DoxyCodeLine{04325\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04326\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04327\ }
\DoxyCodeLine{04328\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now,\ for\ each\ level,\ reassemble\ the\ pages\ into\ one\ big\ image.}}
\DoxyCodeLine{04329\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Because\ this\ is\ a\ Microsoft\ format,\ the\ levels\ are\ arranged\ in\ a}}
\DoxyCodeLine{04330\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ rotated\ order.}}
\DoxyCodeLine{04331\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ level\_remap[6]\ =\ \{}
\DoxyCodeLine{04332\ \ \ \ \ \ \ \ \ \ \ 0,\ 1,\ 5,\ 4,\ 2,\ 3}
\DoxyCodeLine{04333\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{04334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04335\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ pages[0][n].size();}
\DoxyCodeLine{04336\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ 6);}
\DoxyCodeLine{04337\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *imagep\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)image.p();}
\DoxyCodeLine{04338\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ 6;\ ++z)\ \{}
\DoxyCodeLine{04339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ fz\ =\ level\_remap[z];}
\DoxyCodeLine{04340\ \ \ \ \ \ \ \ \ \ \ \ \ nassertr(pages[fz][n].size()\ ==\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{04341\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(imagep\ +\ z\ *\ page\_size,\ pages[fz][n].p(),\ page\_size);}
\DoxyCodeLine{04342\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04343\ }
\DoxyCodeLine{04344\ \ \ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ n,\ image,\ page\_size);}
\DoxyCodeLine{04345\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04346\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04347\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04348\ }
\DoxyCodeLine{04349\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture\_array:}
\DoxyCodeLine{04350\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:\ \textcolor{comment}{//TODO:\ rearrange\ cube\ map\ array\ faces?}}
\DoxyCodeLine{04351\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04352\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Texture\ arrays\ store\ all\ the\ mipmap\ levels\ for\ layer\ 0,\ then\ all}}
\DoxyCodeLine{04353\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ mipmap\ levels\ for\ layer\ 1,\ and\ so\ on.}}
\DoxyCodeLine{04354\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<pvector<PTA\_uchar>}}\ >\ pages;}
\DoxyCodeLine{04355\ \ \ \ \ \ \ \ \ pages.reserve(header.depth);}
\DoxyCodeLine{04356\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z,\ n;}
\DoxyCodeLine{04357\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ (int)header.depth;\ ++z)\ \{}
\DoxyCodeLine{04358\ \ \ \ \ \ \ \ \ \ \ pages.push\_back(\mbox{\hyperlink{classpvector}{pvector<PTA\_uchar>}}());}
\DoxyCodeLine{04359\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<PTA\_uchar>}}\ \&levels\ =\ pages.back();}
\DoxyCodeLine{04360\ \ \ \ \ \ \ \ \ \ \ levels.reserve(header.num\_levels);}
\DoxyCodeLine{04361\ }
\DoxyCodeLine{04362\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04363\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ func(\textcolor{keyword}{this},\ cdata,\ header,\ n,\ in);}
\DoxyCodeLine{04364\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{04365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04366\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04367\ \ \ \ \ \ \ \ \ \ \ \ \ levels.push\_back(image);}
\DoxyCodeLine{04368\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04369\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04370\ }
\DoxyCodeLine{04371\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now,\ for\ each\ level,\ reassemble\ the\ pages\ into\ one\ big\ image.}}
\DoxyCodeLine{04372\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04373\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ pages[0][n].size();}
\DoxyCodeLine{04374\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ header.depth);}
\DoxyCodeLine{04375\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *imagep\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)image.p();}
\DoxyCodeLine{04376\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ (int)header.depth;\ ++z)\ \{}
\DoxyCodeLine{04377\ \ \ \ \ \ \ \ \ \ \ \ \ nassertr(pages[z][n].size()\ ==\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{04378\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(imagep\ +\ z\ *\ page\_size,\ pages[z][n].p(),\ page\_size);}
\DoxyCodeLine{04379\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04380\ }
\DoxyCodeLine{04381\ \ \ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ n,\ image,\ page\_size);}
\DoxyCodeLine{04382\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04383\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04384\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04385\ }
\DoxyCodeLine{04386\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04387\ \ \ \ \ \ \ \textcolor{comment}{//\ Normal\ 2-\/d\ textures\ simply\ store\ the\ mipmap\ levels.}}
\DoxyCodeLine{04388\ \ \ \ \ \ \ \{}
\DoxyCodeLine{04389\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ (int)header.num\_levels;\ ++n)\ \{}
\DoxyCodeLine{04390\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ func(\textcolor{keyword}{this},\ cdata,\ header,\ n,\ in);}
\DoxyCodeLine{04391\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{04392\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04393\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04394\ \ \ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ n,\ image,\ 0);}
\DoxyCodeLine{04395\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04396\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04397\ \ \ \ \ \}}
\DoxyCodeLine{04398\ \ \ \ \ cdata-\/>\_has\_read\_pages\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04399\ \ \ \ \ cdata-\/>\_has\_read\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04400\ \ \ \ \ cdata-\/>\_num\_mipmap\_levels\_read\ =\ cdata-\/>\_ram\_images.size();}
\DoxyCodeLine{04401\ \ \ \}}
\DoxyCodeLine{04402\ }
\DoxyCodeLine{04403\ \ \ \textcolor{keywordflow}{if}\ (in.fail())\ \{}
\DoxyCodeLine{04404\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04405\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ truncated\ DDS\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{04406\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04407\ \ \ \}}
\DoxyCodeLine{04408\ }
\DoxyCodeLine{04409\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04410\ \ \ cdata-\/>\_loaded\_from\_txo\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04411\ }
\DoxyCodeLine{04412\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{04413\ \}}
\DoxyCodeLine{04414\ }
\DoxyCodeLine{04419\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a07be74f08244328f8ca9d9404dfa7825}{Texture::}}}
\DoxyCodeLine{04420\ \mbox{\hyperlink{classTexture_a07be74f08244328f8ca9d9404dfa7825}{do\_read\_ktx\_file}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{04421\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{04422\ }
\DoxyCodeLine{04423\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{04424\ \ \ PT(\mbox{\hyperlink{classVirtualFile}{VirtualFile}})\ file\ =\ vfs-\/>get\_file(filename);}
\DoxyCodeLine{04425\ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04426\ \ \ \ \ \textcolor{comment}{//\ No\ such\ file.}}
\DoxyCodeLine{04427\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04428\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ find\ "{}}\ <<\ fullpath\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04429\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04430\ \ \ \}}
\DoxyCodeLine{04431\ }
\DoxyCodeLine{04432\ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{04433\ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{04434\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ KTX\ file\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04435\ \ \ \}}
\DoxyCodeLine{04436\ }
\DoxyCodeLine{04437\ \ \ istream\ *in\ =\ file-\/>open\_read\_file(\textcolor{keyword}{true});}
\DoxyCodeLine{04438\ \ \ \textcolor{keywordflow}{if}\ (in\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04439\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04440\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ for\ reading.\(\backslash\)n"{}};}
\DoxyCodeLine{04441\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04442\ \ \ \}}
\DoxyCodeLine{04443\ }
\DoxyCodeLine{04444\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ do\_read\_ktx(cdata,\ *in,\ fullpath,\ header\_only);}
\DoxyCodeLine{04445\ \ \ vfs-\/>close\_read\_file(in);}
\DoxyCodeLine{04446\ }
\DoxyCodeLine{04447\ \ \ \textcolor{keywordflow}{if}\ (!has\_name())\ \{}
\DoxyCodeLine{04448\ \ \ \ \ set\_name(fullpath.get\_basename\_wo\_extension());}
\DoxyCodeLine{04449\ \ \ \}}
\DoxyCodeLine{04450\ }
\DoxyCodeLine{04451\ \ \ cdata-\/>\_fullpath\ =\ fullpath;}
\DoxyCodeLine{04452\ \ \ cdata-\/>\_alpha\_fullpath\ =\ \mbox{\hyperlink{classFilename}{Filename}}();}
\DoxyCodeLine{04453\ \ \ cdata-\/>\_keep\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04454\ }
\DoxyCodeLine{04455\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{04456\ \}}
\DoxyCodeLine{04457\ }
\DoxyCodeLine{04461\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{04462\ do\_read\_ktx(CData\ *cdata,\ istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename,\ \textcolor{keywordtype}{bool}\ header\_only)\ \{}
\DoxyCodeLine{04463\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ ktx(in);}
\DoxyCodeLine{04464\ }
\DoxyCodeLine{04465\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ magic[12];}
\DoxyCodeLine{04466\ \ \ \textcolor{keywordflow}{if}\ (ktx.extract\_bytes(magic,\ 12)\ !=\ 12\ ||}
\DoxyCodeLine{04467\ \ \ \ \ \ \ memcmp(magic,\ \textcolor{stringliteral}{"{}\(\backslash\)xABKTX\ 11\(\backslash\)xBB\(\backslash\)r\(\backslash\)n\(\backslash\)x1A\(\backslash\)n"{}},\ 12)\ !=\ 0)\ \{}
\DoxyCodeLine{04468\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04469\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ KTX\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{04470\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04471\ \ \ \}}
\DoxyCodeLine{04472\ }
\DoxyCodeLine{04473\ \ \ \textcolor{comment}{//\ See:\ https://www.khronos.org/opengles/sdk/tools/KTX/file\_format\_spec/}}
\DoxyCodeLine{04474\ \ \ uint32\_t\ gl\_type,\ \textcolor{comment}{/*type\_size,*/}\ gl\_format,\ internal\_format,\ gl\_base\_format,}
\DoxyCodeLine{04475\ \ \ \ \ width,\ height,\ depth,\ num\_array\_elements,\ num\_faces,\ num\_mipmap\_levels,}
\DoxyCodeLine{04476\ \ \ \ \ kvdata\_size;}
\DoxyCodeLine{04477\ }
\DoxyCodeLine{04478\ \ \ \textcolor{keywordtype}{bool}\ big\_endian;}
\DoxyCodeLine{04479\ \ \ \textcolor{keywordflow}{if}\ (ktx.get\_uint32()\ ==\ 0x04030201)\ \{}
\DoxyCodeLine{04480\ \ \ \ \ big\_endian\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04481\ \ \ \ \ gl\_type\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04482\ \ \ \ \ \textcolor{comment}{/*type\_size\ =\ */}ktx.get\_uint32();}
\DoxyCodeLine{04483\ \ \ \ \ gl\_format\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04484\ \ \ \ \ internal\_format\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04485\ \ \ \ \ gl\_base\_format\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04486\ \ \ \ \ width\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04487\ \ \ \ \ height\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04488\ \ \ \ \ depth\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04489\ \ \ \ \ num\_array\_elements\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04490\ \ \ \ \ num\_faces\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04491\ \ \ \ \ num\_mipmap\_levels\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04492\ \ \ \ \ kvdata\_size\ =\ ktx.get\_uint32();}
\DoxyCodeLine{04493\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04494\ \ \ \ \ big\_endian\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04495\ \ \ \ \ gl\_type\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04496\ \ \ \ \ \textcolor{comment}{/*type\_size\ =\ */}ktx.get\_be\_uint32();}
\DoxyCodeLine{04497\ \ \ \ \ gl\_format\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04498\ \ \ \ \ internal\_format\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04499\ \ \ \ \ gl\_base\_format\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04500\ \ \ \ \ width\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04501\ \ \ \ \ height\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04502\ \ \ \ \ depth\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04503\ \ \ \ \ num\_array\_elements\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04504\ \ \ \ \ num\_faces\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04505\ \ \ \ \ num\_mipmap\_levels\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04506\ \ \ \ \ kvdata\_size\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{04507\ \ \ \}}
\DoxyCodeLine{04508\ }
\DoxyCodeLine{04509\ \ \ \textcolor{comment}{//\ Skip\ metadata\ section.}}
\DoxyCodeLine{04510\ \ \ ktx.skip\_bytes(kvdata\_size);}
\DoxyCodeLine{04511\ }
\DoxyCodeLine{04512\ \ \ ComponentType\ type;}
\DoxyCodeLine{04513\ \ \ CompressionMode\ compression;}
\DoxyCodeLine{04514\ \ \ Format\ format;}
\DoxyCodeLine{04515\ \ \ \textcolor{keywordtype}{bool}\ swap\_bgr\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04516\ }
\DoxyCodeLine{04517\ \ \ \textcolor{keywordflow}{if}\ (gl\_type\ ==\ 0\ ||\ gl\_format\ ==\ 0)\ \{}
\DoxyCodeLine{04518\ \ \ \ \ \textcolor{comment}{//\ Compressed\ texture.}}
\DoxyCodeLine{04519\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_type\ >\ 0\ ||\ gl\_format\ >\ 0)\ \{}
\DoxyCodeLine{04520\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04521\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Compressed\ textures\ must\ have\ both\ type\ and\ format\ set\ to\ 0.\(\backslash\)n"{}};}
\DoxyCodeLine{04522\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04523\ \ \ \ \ \}}
\DoxyCodeLine{04524\ \ \ \ \ type\ =\ T\_unsigned\_byte;}
\DoxyCodeLine{04525\ \ \ \ \ compression\ =\ CM\_on;}
\DoxyCodeLine{04526\ }
\DoxyCodeLine{04527\ \ \ \ \ KTXFormat\ base\_format;}
\DoxyCodeLine{04528\ \ \ \ \ \textcolor{keywordflow}{switch}\ ((KTXCompressedFormat)internal\_format)\ \{}
\DoxyCodeLine{04529\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RED:}
\DoxyCodeLine{04530\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04531\ \ \ \ \ \ \ base\_format\ =\ KTX\_RED;}
\DoxyCodeLine{04532\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04533\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RG:}
\DoxyCodeLine{04534\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04535\ \ \ \ \ \ \ base\_format\ =\ KTX\_RG;}
\DoxyCodeLine{04536\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04537\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB:}
\DoxyCodeLine{04538\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04539\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04540\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04541\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA:}
\DoxyCodeLine{04542\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04543\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04544\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04545\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB:}
\DoxyCodeLine{04546\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04547\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB;}
\DoxyCodeLine{04548\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04549\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA:}
\DoxyCodeLine{04550\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04551\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04552\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04553\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB\_FXT1\_3DFX:}
\DoxyCodeLine{04554\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04555\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04556\ \ \ \ \ \ \ compression\ =\ CM\_fxt1;}
\DoxyCodeLine{04557\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04558\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA\_FXT1\_3DFX:}
\DoxyCodeLine{04559\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04560\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04561\ \ \ \ \ \ \ compression\ =\ CM\_fxt1;}
\DoxyCodeLine{04562\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04563\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB\_S3TC\_DXT1:}
\DoxyCodeLine{04564\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04565\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04566\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04567\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04568\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT1:}
\DoxyCodeLine{04569\ \ \ \ \ \ \ format\ =\ F\_rgbm;}
\DoxyCodeLine{04570\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04571\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04572\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04573\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT3:}
\DoxyCodeLine{04574\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04575\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04576\ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{04577\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04578\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA\_S3TC\_DXT5:}
\DoxyCodeLine{04579\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04580\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04581\ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{04582\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04583\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1:}
\DoxyCodeLine{04584\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04585\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04586\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04587\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04588\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3:}
\DoxyCodeLine{04589\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04590\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04591\ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{04592\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04593\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5:}
\DoxyCodeLine{04594\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04595\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04596\ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{04597\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04598\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_S3TC\_DXT1:}
\DoxyCodeLine{04599\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04600\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB;}
\DoxyCodeLine{04601\ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{04602\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04603\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RED\_RGTC1:}
\DoxyCodeLine{04604\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SIGNED\_RED\_RGTC1:}
\DoxyCodeLine{04605\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04606\ \ \ \ \ \ \ base\_format\ =\ KTX\_RED;}
\DoxyCodeLine{04607\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04608\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04609\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RG\_RGTC2:}
\DoxyCodeLine{04610\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SIGNED\_RG\_RGTC2:}
\DoxyCodeLine{04611\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04612\ \ \ \ \ \ \ base\_format\ =\ KTX\_RG;}
\DoxyCodeLine{04613\ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{04614\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04615\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_ETC1\_RGB8:}
\DoxyCodeLine{04616\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04617\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04618\ \ \ \ \ \ \ compression\ =\ CM\_etc1;}
\DoxyCodeLine{04619\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04620\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_ETC1\_SRGB8:}
\DoxyCodeLine{04621\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04622\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB;}
\DoxyCodeLine{04623\ \ \ \ \ \ \ compression\ =\ CM\_etc1;}
\DoxyCodeLine{04624\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04625\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB8\_ETC2:}
\DoxyCodeLine{04626\ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04627\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGB;}
\DoxyCodeLine{04628\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04629\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04630\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB8\_ETC2:}
\DoxyCodeLine{04631\ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04632\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB;}
\DoxyCodeLine{04633\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04634\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04635\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2:}
\DoxyCodeLine{04636\ \ \ \ \ \ \ format\ =\ F\_rgbm;}
\DoxyCodeLine{04637\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04638\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04639\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04640\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2:}
\DoxyCodeLine{04641\ \ \ \ \ \ \ format\ =\ F\_rgbm;}
\DoxyCodeLine{04642\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB8\_ALPHA8;}
\DoxyCodeLine{04643\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04644\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04645\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA8\_ETC2\_EAC:}
\DoxyCodeLine{04646\ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04647\ \ \ \ \ \ \ base\_format\ =\ KTX\_RGBA;}
\DoxyCodeLine{04648\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04649\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04650\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC:}
\DoxyCodeLine{04651\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04652\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB8\_ALPHA8;}
\DoxyCodeLine{04653\ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{04654\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04655\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_R11\_EAC:}
\DoxyCodeLine{04656\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SIGNED\_R11\_EAC:}
\DoxyCodeLine{04657\ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04658\ \ \ \ \ \ \ base\_format\ =\ KTX\_RED;}
\DoxyCodeLine{04659\ \ \ \ \ \ \ compression\ =\ CM\_eac;}
\DoxyCodeLine{04660\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04661\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RG11\_EAC:}
\DoxyCodeLine{04662\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SIGNED\_RG11\_EAC:}
\DoxyCodeLine{04663\ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04664\ \ \ \ \ \ \ base\_format\ =\ KTX\_RG;}
\DoxyCodeLine{04665\ \ \ \ \ \ \ compression\ =\ CM\_eac;}
\DoxyCodeLine{04666\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04667\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_2BPPV1:}
\DoxyCodeLine{04668\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04669\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04670\ \ \ \ \ \ \ compression\ =\ CM\_pvr1\_2bpp;}
\DoxyCodeLine{04671\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04672\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_4BPPV1:}
\DoxyCodeLine{04673\ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04674\ \ \ \ \ \ \ base\_format\ =\ KTX\_SRGB\_ALPHA;}
\DoxyCodeLine{04675\ \ \ \ \ \ \ compression\ =\ CM\_pvr1\_4bpp;}
\DoxyCodeLine{04676\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04677\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGBA\_BPTC\_UNORM:}
\DoxyCodeLine{04678\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_SRGB\_ALPHA\_BPTC\_UNORM:}
\DoxyCodeLine{04679\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB\_BPTC\_SIGNED\_FLOAT:}
\DoxyCodeLine{04680\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_COMPRESSED\_RGB\_BPTC\_UNSIGNED\_FLOAT:}
\DoxyCodeLine{04681\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04682\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04683\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ compressed\ internal\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04684\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04685\ \ \ \ \ \}}
\DoxyCodeLine{04686\ }
\DoxyCodeLine{04687\ \ \ \ \ \textcolor{keywordflow}{if}\ (base\_format\ !=\ gl\_base\_format)\ \{}
\DoxyCodeLine{04688\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04689\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ internal\ format\ that\ is\ incompatible\ with\ base\ "{}}}
\DoxyCodeLine{04690\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}format\ (0x"{}}\ <<\ std::hex\ <<\ gl\_base\_format\ <<\ \textcolor{stringliteral}{"{},\ expected\ 0x"{}}}
\DoxyCodeLine{04691\ \ \ \ \ \ \ \ \ <<\ base\_format\ <<\ std::dec\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04692\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04693\ \ \ \ \ \}}
\DoxyCodeLine{04694\ }
\DoxyCodeLine{04695\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04696\ \ \ \ \ \textcolor{comment}{//\ Uncompressed\ texture.}}
\DoxyCodeLine{04697\ \ \ \ \ compression\ =\ CM\_off;}
\DoxyCodeLine{04698\ \ \ \ \ \textcolor{keywordflow}{switch}\ ((KTXType)gl\_type)\ \{}
\DoxyCodeLine{04699\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BYTE:}
\DoxyCodeLine{04700\ \ \ \ \ \ \ type\ =\ T\_byte;}
\DoxyCodeLine{04701\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04702\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_UNSIGNED\_BYTE:}
\DoxyCodeLine{04703\ \ \ \ \ \ \ type\ =\ T\_unsigned\_byte;}
\DoxyCodeLine{04704\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04705\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_SHORT:}
\DoxyCodeLine{04706\ \ \ \ \ \ \ type\ =\ T\_short;}
\DoxyCodeLine{04707\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04708\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_UNSIGNED\_SHORT:}
\DoxyCodeLine{04709\ \ \ \ \ \ \ type\ =\ T\_unsigned\_short;}
\DoxyCodeLine{04710\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04711\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_INT:}
\DoxyCodeLine{04712\ \ \ \ \ \ \ type\ =\ T\_int;}
\DoxyCodeLine{04713\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04714\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_UNSIGNED\_INT:}
\DoxyCodeLine{04715\ \ \ \ \ \ \ type\ =\ T\_unsigned\_int;}
\DoxyCodeLine{04716\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04717\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_FLOAT:}
\DoxyCodeLine{04718\ \ \ \ \ \ \ type\ =\ T\_float;}
\DoxyCodeLine{04719\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04720\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_HALF\_FLOAT:}
\DoxyCodeLine{04721\ \ \ \ \ \ \ type\ =\ T\_half\_float;}
\DoxyCodeLine{04722\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04723\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_UNSIGNED\_INT\_24\_8:}
\DoxyCodeLine{04724\ \ \ \ \ \ \ type\ =\ T\_unsigned\_int\_24\_8;}
\DoxyCodeLine{04725\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04726\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04727\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04728\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ component\ type\ "{}}\ <<\ gl\_type\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04729\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04730\ \ \ \ \ \}}
\DoxyCodeLine{04731\ }
\DoxyCodeLine{04732\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_format\ !=\ gl\_base\_format)\ \{}
\DoxyCodeLine{04733\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04734\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ mismatched\ formats:\ "{}}\ <<\ gl\_format\ <<\ \textcolor{stringliteral}{"{}\ !=\ "{}}}
\DoxyCodeLine{04735\ \ \ \ \ \ \ \ \ <<\ gl\_base\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04736\ \ \ \ \ \}}
\DoxyCodeLine{04737\ }
\DoxyCodeLine{04738\ \ \ \ \ \textcolor{keywordflow}{switch}\ (gl\_format)\ \{}
\DoxyCodeLine{04739\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT:}
\DoxyCodeLine{04740\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04741\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT:}
\DoxyCodeLine{04742\ \ \ \ \ \ \ \ \ format\ =\ F\_depth\_component;}
\DoxyCodeLine{04743\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04744\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT16:}
\DoxyCodeLine{04745\ \ \ \ \ \ \ \ \ format\ =\ F\_depth\_component16;}
\DoxyCodeLine{04746\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04747\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT24:}
\DoxyCodeLine{04748\ \ \ \ \ \ \ \ \ format\ =\ F\_depth\_component24;}
\DoxyCodeLine{04749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04750\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT32:}
\DoxyCodeLine{04751\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_COMPONENT32F:}
\DoxyCodeLine{04752\ \ \ \ \ \ \ \ \ format\ =\ F\_depth\_component32;}
\DoxyCodeLine{04753\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04754\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04755\ \ \ \ \ \ \ \ \ format\ =\ F\_depth\_component;}
\DoxyCodeLine{04756\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04757\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ depth\ component\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04758\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04759\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04760\ }
\DoxyCodeLine{04761\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_DEPTH\_STENCIL:}
\DoxyCodeLine{04762\ \ \ \ \ \ \ format\ =\ F\_depth\_stencil;}
\DoxyCodeLine{04763\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (internal\_format\ !=\ KTX\_DEPTH\_STENCIL\ \&\&}
\DoxyCodeLine{04764\ \ \ \ \ \ \ \ \ \ \ internal\_format\ !=\ KTX\_DEPTH24\_STENCIL8)\ \{}
\DoxyCodeLine{04765\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04766\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ depth\ stencil\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04767\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04768\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04769\ }
\DoxyCodeLine{04770\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RED:}
\DoxyCodeLine{04771\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04772\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RED:}
\DoxyCodeLine{04773\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RED\_SNORM:}
\DoxyCodeLine{04774\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R8:}
\DoxyCodeLine{04775\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R8\_SNORM:}
\DoxyCodeLine{04776\ \ \ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04777\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04778\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R16:}
\DoxyCodeLine{04779\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R16\_SNORM:}
\DoxyCodeLine{04780\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R16F:}
\DoxyCodeLine{04781\ \ \ \ \ \ \ \ \ format\ =\ F\_r16;}
\DoxyCodeLine{04782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04783\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R32F:}
\DoxyCodeLine{04784\ \ \ \ \ \ \ \ \ format\ =\ F\_r32;}
\DoxyCodeLine{04785\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04786\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04787\ \ \ \ \ \ \ \ \ format\ =\ F\_red;}
\DoxyCodeLine{04788\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04789\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ red\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04790\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04791\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04792\ }
\DoxyCodeLine{04793\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RED\_INTEGER:}
\DoxyCodeLine{04794\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04795\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R8I:}
\DoxyCodeLine{04796\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R8UI:}
\DoxyCodeLine{04797\ \ \ \ \ \ \ \ \ format\ =\ F\_r8i;}
\DoxyCodeLine{04798\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04799\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R16I:}
\DoxyCodeLine{04800\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R16UI:}
\DoxyCodeLine{04801\ \ \ \ \ \ \ \ \ format\ =\ F\_r16i;}
\DoxyCodeLine{04802\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04803\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R32I:}
\DoxyCodeLine{04804\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R32UI:}
\DoxyCodeLine{04805\ \ \ \ \ \ \ \ \ format\ =\ F\_r32i;}
\DoxyCodeLine{04806\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04807\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04808\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04809\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ red\ integer\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04810\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04811\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04812\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04813\ }
\DoxyCodeLine{04814\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_GREEN:}
\DoxyCodeLine{04815\ \ \ \ \ \ \ format\ =\ F\_green;}
\DoxyCodeLine{04816\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (internal\_format\ !=\ KTX\_GREEN)\ \{}
\DoxyCodeLine{04817\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04818\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ green\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04819\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04820\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04821\ }
\DoxyCodeLine{04822\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BLUE:}
\DoxyCodeLine{04823\ \ \ \ \ \ \ format\ =\ F\_blue;}
\DoxyCodeLine{04824\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (internal\_format\ !=\ KTX\_BLUE)\ \{}
\DoxyCodeLine{04825\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04826\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ blue\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04827\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04828\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04829\ }
\DoxyCodeLine{04830\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG:}
\DoxyCodeLine{04831\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04832\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG:}
\DoxyCodeLine{04833\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG\_SNORM:}
\DoxyCodeLine{04834\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG8:}
\DoxyCodeLine{04835\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG8\_SNORM:}
\DoxyCodeLine{04836\ \ \ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04837\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04838\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG16:}
\DoxyCodeLine{04839\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG16\_SNORM:}
\DoxyCodeLine{04840\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG16F:}
\DoxyCodeLine{04841\ \ \ \ \ \ \ \ \ format\ =\ F\_rg16;}
\DoxyCodeLine{04842\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04843\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG32F:}
\DoxyCodeLine{04844\ \ \ \ \ \ \ \ \ format\ =\ F\_rg32;}
\DoxyCodeLine{04845\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04846\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04847\ \ \ \ \ \ \ \ \ format\ =\ F\_rg;}
\DoxyCodeLine{04848\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04849\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RG\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04850\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04851\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04852\ }
\DoxyCodeLine{04853\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG\_INTEGER:}
\DoxyCodeLine{04854\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04855\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG8I:}
\DoxyCodeLine{04856\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG8UI:}
\DoxyCodeLine{04857\ \ \ \ \ \ \ \ \ format\ =\ F\_rg8i;}
\DoxyCodeLine{04858\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04859\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG16I:}
\DoxyCodeLine{04860\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG16UI:}
\DoxyCodeLine{04861\ \ \ \ \ \ \ \ \ format\ =\ F\_rg16i;}
\DoxyCodeLine{04862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04863\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG32I:}
\DoxyCodeLine{04864\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RG32UI:}
\DoxyCodeLine{04865\ \ \ \ \ \ \ \ \ format\ =\ F\_rg32i;}
\DoxyCodeLine{04866\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04867\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04868\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04869\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RG\ integer\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04870\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04871\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04872\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04873\ }
\DoxyCodeLine{04874\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB:}
\DoxyCodeLine{04875\ \ \ \ \ \ \ swap\_bgr\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04876\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BGR:}
\DoxyCodeLine{04877\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04878\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB:}
\DoxyCodeLine{04879\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB\_SNORM:}
\DoxyCodeLine{04880\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04882\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB5:}
\DoxyCodeLine{04883\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb5;}
\DoxyCodeLine{04884\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04885\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB12:}
\DoxyCodeLine{04886\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb12;}
\DoxyCodeLine{04887\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04888\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R3\_G3\_B2:}
\DoxyCodeLine{04889\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb332;}
\DoxyCodeLine{04890\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04891\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB9\_E5:}
\DoxyCodeLine{04892\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb9\_e5;}
\DoxyCodeLine{04893\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04894\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_R11F\_G11F\_B10F:}
\DoxyCodeLine{04895\ \ \ \ \ \ \ \ \ format\ =\ F\_r11\_g11\_b10;}
\DoxyCodeLine{04896\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04897\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB8:}
\DoxyCodeLine{04898\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB8\_SNORM:}
\DoxyCodeLine{04899\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb8;}
\DoxyCodeLine{04900\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04901\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB16:}
\DoxyCodeLine{04902\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB16\_SNORM:}
\DoxyCodeLine{04903\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB16F:}
\DoxyCodeLine{04904\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb16;}
\DoxyCodeLine{04905\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04906\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB32F:}
\DoxyCodeLine{04907\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb32;}
\DoxyCodeLine{04908\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04909\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_SRGB:}
\DoxyCodeLine{04910\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_SRGB8:}
\DoxyCodeLine{04911\ \ \ \ \ \ \ \ \ format\ =\ F\_srgb;}
\DoxyCodeLine{04912\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04913\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04914\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb;}
\DoxyCodeLine{04915\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04916\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RGB\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04917\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04918\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04919\ }
\DoxyCodeLine{04920\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB\_INTEGER:}
\DoxyCodeLine{04921\ \ \ \ \ \ \ swap\_bgr\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04922\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BGR\_INTEGER:}
\DoxyCodeLine{04923\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04924\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB8I:}
\DoxyCodeLine{04925\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB8UI:}
\DoxyCodeLine{04926\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb8i;}
\DoxyCodeLine{04927\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04928\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB16I:}
\DoxyCodeLine{04929\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB16UI:}
\DoxyCodeLine{04930\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb16i;}
\DoxyCodeLine{04931\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04932\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB32I:}
\DoxyCodeLine{04933\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB32UI:}
\DoxyCodeLine{04934\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb32i;}
\DoxyCodeLine{04935\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04936\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04937\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{04938\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RGB\ integer\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04939\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04940\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04941\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04942\ }
\DoxyCodeLine{04943\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA:}
\DoxyCodeLine{04944\ \ \ \ \ \ \ swap\_bgr\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04945\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BGRA:}
\DoxyCodeLine{04946\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04947\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA:}
\DoxyCodeLine{04948\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA\_SNORM:}
\DoxyCodeLine{04949\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04950\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04951\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA4:}
\DoxyCodeLine{04952\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba4;}
\DoxyCodeLine{04953\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04954\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB5\_A1:}
\DoxyCodeLine{04955\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba5;}
\DoxyCodeLine{04956\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04957\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA12:}
\DoxyCodeLine{04958\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba12;}
\DoxyCodeLine{04959\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04960\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGB10\_A2:}
\DoxyCodeLine{04961\ \ \ \ \ \ \ \ \ format\ =\ F\_rgb10\_a2;}
\DoxyCodeLine{04962\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04963\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA8:}
\DoxyCodeLine{04964\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA8\_SNORM:}
\DoxyCodeLine{04965\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba8;}
\DoxyCodeLine{04966\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04967\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA16:}
\DoxyCodeLine{04968\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA16\_SNORM:}
\DoxyCodeLine{04969\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA16F:}
\DoxyCodeLine{04970\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba16;}
\DoxyCodeLine{04971\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04972\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA32F:}
\DoxyCodeLine{04973\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba32;}
\DoxyCodeLine{04974\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04975\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_SRGB\_ALPHA:}
\DoxyCodeLine{04976\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_SRGB8\_ALPHA8:}
\DoxyCodeLine{04977\ \ \ \ \ \ \ \ \ format\ =\ F\_srgb\_alpha;}
\DoxyCodeLine{04978\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04979\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{04980\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba;}
\DoxyCodeLine{04981\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{04982\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RGBA\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04983\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04984\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04985\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04986\ }
\DoxyCodeLine{04987\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA\_INTEGER:}
\DoxyCodeLine{04988\ \ \ \ \ \ \ swap\_bgr\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04989\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_BGRA\_INTEGER:}
\DoxyCodeLine{04990\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{04991\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA8I:}
\DoxyCodeLine{04992\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA8UI:}
\DoxyCodeLine{04993\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba8i;}
\DoxyCodeLine{04994\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04995\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA16I:}
\DoxyCodeLine{04996\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA16UI:}
\DoxyCodeLine{04997\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba16i;}
\DoxyCodeLine{04998\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04999\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA32I:}
\DoxyCodeLine{05000\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_RGBA32UI:}
\DoxyCodeLine{05001\ \ \ \ \ \ \ \ \ format\ =\ F\_rgba32i;}
\DoxyCodeLine{05002\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05003\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{05004\ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05005\ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ RGBA\ integer\ format\ "{}}\ <<\ internal\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05006\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05007\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05008\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05009\ }
\DoxyCodeLine{05010\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_LUMINANCE:}
\DoxyCodeLine{05011\ \ \ \ \ \ \ format\ =\ F\_luminance;}
\DoxyCodeLine{05012\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05013\ }
\DoxyCodeLine{05014\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{05015\ \ \ \ \ \ \ format\ =\ F\_luminance\_alpha;}
\DoxyCodeLine{05016\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05017\ }
\DoxyCodeLine{05018\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_ALPHA:}
\DoxyCodeLine{05019\ \ \ \ \ \ \ format\ =\ F\_alpha;}
\DoxyCodeLine{05020\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05021\ }
\DoxyCodeLine{05022\ \ \ \ \ \textcolor{keywordflow}{case}\ KTX\_STENCIL\_INDEX:}
\DoxyCodeLine{05023\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{05024\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05025\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ unsupported\ format\ "{}}\ <<\ gl\_format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05026\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05027\ \ \ \ \ \}}
\DoxyCodeLine{05028\ \ \ \}}
\DoxyCodeLine{05029\ }
\DoxyCodeLine{05030\ \ \ TextureType\ texture\_type;}
\DoxyCodeLine{05031\ \ \ \textcolor{keywordflow}{if}\ (depth\ >\ 0)\ \{}
\DoxyCodeLine{05032\ \ \ \ \ texture\_type\ =\ TT\_3d\_texture;}
\DoxyCodeLine{05033\ }
\DoxyCodeLine{05034\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (num\_faces\ >\ 1)\ \{}
\DoxyCodeLine{05035\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_faces\ !=\ 6)\ \{}
\DoxyCodeLine{05036\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05037\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ "{}}\ <<\ num\_faces\ <<\ \textcolor{stringliteral}{"{}\ cube\ map\ faces,\ expected\ 6\(\backslash\)n"{}};}
\DoxyCodeLine{05038\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05039\ \ \ \ \ \}}
\DoxyCodeLine{05040\ \ \ \ \ \textcolor{keywordflow}{if}\ (width\ !=\ height)\ \{}
\DoxyCodeLine{05041\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05042\ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ is\ cube\ map,\ but\ does\ not\ have\ square\ dimensions\(\backslash\)n"{}};}
\DoxyCodeLine{05043\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05044\ \ \ \ \ \}}
\DoxyCodeLine{05045\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_array\_elements\ >\ 0)\ \{}
\DoxyCodeLine{05046\ \ \ \ \ \ \ depth\ =\ num\_array\_elements\ *\ 6;}
\DoxyCodeLine{05047\ \ \ \ \ \ \ texture\_type\ =\ TT\_cube\_map\_array;}
\DoxyCodeLine{05048\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05049\ \ \ \ \ \ \ depth\ =\ 6;}
\DoxyCodeLine{05050\ \ \ \ \ \ \ texture\_type\ =\ TT\_cube\_map;}
\DoxyCodeLine{05051\ \ \ \ \ \}}
\DoxyCodeLine{05052\ }
\DoxyCodeLine{05053\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (height\ >\ 0)\ \{}
\DoxyCodeLine{05054\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_array\_elements\ >\ 0)\ \{}
\DoxyCodeLine{05055\ \ \ \ \ \ \ depth\ =\ num\_array\_elements;}
\DoxyCodeLine{05056\ \ \ \ \ \ \ texture\_type\ =\ TT\_2d\_texture\_array;}
\DoxyCodeLine{05057\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05058\ \ \ \ \ \ \ depth\ =\ 1;}
\DoxyCodeLine{05059\ \ \ \ \ \ \ texture\_type\ =\ TT\_2d\_texture;}
\DoxyCodeLine{05060\ \ \ \ \ \}}
\DoxyCodeLine{05061\ }
\DoxyCodeLine{05062\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (width\ >\ 0)\ \{}
\DoxyCodeLine{05063\ \ \ \ \ depth\ =\ 1;}
\DoxyCodeLine{05064\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_array\_elements\ >\ 0)\ \{}
\DoxyCodeLine{05065\ \ \ \ \ \ \ height\ =\ num\_array\_elements;}
\DoxyCodeLine{05066\ \ \ \ \ \ \ texture\_type\ =\ TT\_1d\_texture\_array;}
\DoxyCodeLine{05067\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05068\ \ \ \ \ \ \ height\ =\ 1;}
\DoxyCodeLine{05069\ \ \ \ \ \ \ texture\_type\ =\ TT\_1d\_texture;}
\DoxyCodeLine{05070\ \ \ \ \ \}}
\DoxyCodeLine{05071\ }
\DoxyCodeLine{05072\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05073\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05074\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ zero\ size\(\backslash\)n"{}};}
\DoxyCodeLine{05075\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05076\ \ \ \}}
\DoxyCodeLine{05077\ }
\DoxyCodeLine{05078\ \ \ do\_setup\_texture(cdata,\ texture\_type,\ width,\ height,\ depth,\ type,\ format);}
\DoxyCodeLine{05079\ }
\DoxyCodeLine{05080\ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{05081\ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{05082\ \ \ cdata-\/>\_compression\ =\ compression;}
\DoxyCodeLine{05083\ \ \ cdata-\/>\_ram\_image\_compression\ =\ compression;}
\DoxyCodeLine{05084\ }
\DoxyCodeLine{05085\ \ \ \textcolor{keywordflow}{if}\ (!header\_only)\ \{}
\DoxyCodeLine{05086\ \ \ \ \ \textcolor{keywordtype}{bool}\ generate\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05087\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_mipmap\_levels\ ==\ 0)\ \{}
\DoxyCodeLine{05088\ \ \ \ \ \ \ generate\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05089\ \ \ \ \ \ \ num\_mipmap\_levels\ =\ 1;}
\DoxyCodeLine{05090\ \ \ \ \ \}}
\DoxyCodeLine{05091\ }
\DoxyCodeLine{05092\ \ \ \ \ \textcolor{keywordflow}{for}\ (uint32\_t\ n\ =\ 0;\ n\ <\ num\_mipmap\_levels;\ ++n)\ \{}
\DoxyCodeLine{05093\ \ \ \ \ \ \ uint32\_t\ image\_size;}
\DoxyCodeLine{05094\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (big\_endian)\ \{}
\DoxyCodeLine{05095\ \ \ \ \ \ \ \ \ image\_size\ =\ ktx.get\_be\_uint32();}
\DoxyCodeLine{05096\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05097\ \ \ \ \ \ \ \ \ image\_size\ =\ ktx.get\_uint32();}
\DoxyCodeLine{05098\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05099\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image;}
\DoxyCodeLine{05100\ }
\DoxyCodeLine{05101\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ CM\_off)\ \{}
\DoxyCodeLine{05102\ \ \ \ \ \ \ \ \ uint32\_t\ row\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ (\textcolor{keywordtype}{int})n)\ *\ cdata-\/>\_num\_components\ *\ cdata-\/>\_component\_width;}
\DoxyCodeLine{05103\ \ \ \ \ \ \ \ \ uint32\_t\ num\_rows\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ (\textcolor{keywordtype}{int})n)\ *\ do\_get\_expected\_mipmap\_z\_size(cdata,\ (\textcolor{keywordtype}{int})n);}
\DoxyCodeLine{05104\ \ \ \ \ \ \ \ \ uint32\_t\ row\_padded\ =\ (row\_size\ +\ 3)\ \&\ \string~3;}
\DoxyCodeLine{05105\ }
\DoxyCodeLine{05106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_size\ ==\ row\_size\ *\ num\_rows)\ \{}
\DoxyCodeLine{05107\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (row\_padded\ !=\ row\_size)\ \{}
\DoxyCodeLine{05108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Someone\ tightly\ packed\ the\ image.\ \ This\ is\ invalid,\ but\ because}}
\DoxyCodeLine{05109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ like\ it\ tightly\ packed\ too,\ we'll\ read\ it\ anyway.}}
\DoxyCodeLine{05110\ \ \ \ \ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{05111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ does\ not\ have\ proper\ row\ padding\ for\ mipmap\ "{}}}
\DoxyCodeLine{05112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}level\ "{}}\ <<\ n\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05113\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05114\ \ \ \ \ \ \ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(image\_size);}
\DoxyCodeLine{05115\ \ \ \ \ \ \ \ \ \ \ ktx.extract\_bytes(image.p(),\ image\_size);}
\DoxyCodeLine{05116\ }
\DoxyCodeLine{05117\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (image\_size\ !=\ row\_padded\ *\ num\_rows)\ \{}
\DoxyCodeLine{05118\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05119\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\ has\ invalid\ image\ size\ "{}}\ <<\ image\_size}
\DoxyCodeLine{05120\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ for\ mipmap\ level\ "{}}\ <<\ n\ <<\ \textcolor{stringliteral}{"{}\ (expected\ "{}}}
\DoxyCodeLine{05121\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ row\_padded\ *\ num\_rows\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{05122\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05123\ }
\DoxyCodeLine{05124\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05125\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ it\ row\ by\ row.}}
\DoxyCodeLine{05126\ \ \ \ \ \ \ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(row\_size\ *\ num\_rows);}
\DoxyCodeLine{05127\ \ \ \ \ \ \ \ \ \ \ uint32\_t\ skip\ =\ row\_padded\ -\/\ row\_size;}
\DoxyCodeLine{05128\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{05129\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (uint32\_t\ row\ =\ 0;\ row\ <\ num\_rows;\ ++row)\ \{}
\DoxyCodeLine{05130\ \ \ \ \ \ \ \ \ \ \ \ \ ktx.extract\_bytes(p,\ row\_size);}
\DoxyCodeLine{05131\ \ \ \ \ \ \ \ \ \ \ \ \ ktx.skip\_bytes(skip);}
\DoxyCodeLine{05132\ \ \ \ \ \ \ \ \ \ \ \ \ p\ +=\ row\_size;}
\DoxyCodeLine{05133\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05135\ }
\DoxyCodeLine{05136\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Swap\ red\ and\ blue\ channels\ if\ necessary\ to\ match\ Panda\ conventions.}}
\DoxyCodeLine{05137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (swap\_bgr)\ \{}
\DoxyCodeLine{05138\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *begin\ =\ image.p();}
\DoxyCodeLine{05139\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *end\ =\ image.p()\ +\ image.size();}
\DoxyCodeLine{05140\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ skip\ =\ cdata-\/>\_num\_components;}
\DoxyCodeLine{05141\ \ \ \ \ \ \ \ \ \ \ nassertr(skip\ ==\ 3\ ||\ skip\ ==\ 4,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05142\ }
\DoxyCodeLine{05143\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_component\_width)\ \{}
\DoxyCodeLine{05144\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{05145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ begin;\ p\ <\ end;\ p\ +=\ skip)\ \{}
\DoxyCodeLine{05146\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ swap(p[0],\ p[2]);}
\DoxyCodeLine{05147\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05148\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05149\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{05150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{short}\ *p\ =\ (\textcolor{keywordtype}{short}\ *)begin;\ p\ <\ (\textcolor{keywordtype}{short}\ *)end;\ p\ +=\ skip)\ \{}
\DoxyCodeLine{05151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ swap(p[0],\ p[2]);}
\DoxyCodeLine{05152\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05154\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{05155\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ *p\ =\ (\textcolor{keywordtype}{int}\ *)begin;\ p\ <\ (\textcolor{keywordtype}{int}\ *)end;\ p\ +=\ skip)\ \{}
\DoxyCodeLine{05156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ swap(p[0],\ p[2]);}
\DoxyCodeLine{05157\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05159\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{05160\ \ \ \ \ \ \ \ \ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{05161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05162\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05164\ }
\DoxyCodeLine{05165\ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ (\textcolor{keywordtype}{int})n,\ std::move(image),}
\DoxyCodeLine{05166\ \ \ \ \ \ \ \ \ \ \ row\_size\ *\ do\_get\_expected\_mipmap\_y\_size(cdata,\ (\textcolor{keywordtype}{int})n));}
\DoxyCodeLine{05167\ }
\DoxyCodeLine{05168\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05169\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compressed\ image.\ \ We'll\ trust\ that\ the\ file\ has\ the\ right\ size.}}
\DoxyCodeLine{05170\ \ \ \ \ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(image\_size);}
\DoxyCodeLine{05171\ \ \ \ \ \ \ \ \ ktx.extract\_bytes(image.p(),\ image\_size);}
\DoxyCodeLine{05172\ \ \ \ \ \ \ \ \ do\_set\_ram\_mipmap\_image(cdata,\ (\textcolor{keywordtype}{int})n,\ std::move(image),\ image\_size\ /\ depth);}
\DoxyCodeLine{05173\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05174\ }
\DoxyCodeLine{05175\ \ \ \ \ \ \ ktx.skip\_bytes(3\ -\/\ ((image\_size\ +\ 3)\ \&\ 3));}
\DoxyCodeLine{05176\ \ \ \ \ \}}
\DoxyCodeLine{05177\ }
\DoxyCodeLine{05178\ \ \ \ \ cdata-\/>\_has\_read\_pages\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05179\ \ \ \ \ cdata-\/>\_has\_read\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05180\ \ \ \ \ cdata-\/>\_num\_mipmap\_levels\_read\ =\ cdata-\/>\_ram\_images.size();}
\DoxyCodeLine{05181\ }
\DoxyCodeLine{05182\ \ \ \ \ \textcolor{keywordflow}{if}\ (generate\_mipmaps)\ \{}
\DoxyCodeLine{05183\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{do\_generate\_ram\_mipmap\_images}}(cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05184\ \ \ \ \ \}}
\DoxyCodeLine{05185\ \ \ \}}
\DoxyCodeLine{05186\ }
\DoxyCodeLine{05187\ \ \ \textcolor{keywordflow}{if}\ (in.fail())\ \{}
\DoxyCodeLine{05188\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05189\ \ \ \ \ \ \ <<\ filename\ <<\ \textcolor{stringliteral}{"{}:\ truncated\ KTX\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{05190\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05191\ \ \ \}}
\DoxyCodeLine{05192\ }
\DoxyCodeLine{05193\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05194\ \ \ cdata-\/>\_loaded\_from\_txo\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05195\ }
\DoxyCodeLine{05196\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05197\ \}}
\DoxyCodeLine{05198\ }
\DoxyCodeLine{05203\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a36c5e92b9322b773128cc5ab06b600af}{Texture::}}}
\DoxyCodeLine{05204\ \mbox{\hyperlink{classTexture_a36c5e92b9322b773128cc5ab06b600af}{do\_write}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,}
\DoxyCodeLine{05205\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n,\ \textcolor{keywordtype}{bool}\ write\_pages,\ \textcolor{keywordtype}{bool}\ write\_mipmaps)\ \{}
\DoxyCodeLine{05206\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_texture\_write\_pcollector);}
\DoxyCodeLine{05207\ }
\DoxyCodeLine{05208\ \ \ \textcolor{keywordflow}{if}\ (is\_txo\_filename(fullpath))\ \{}
\DoxyCodeLine{05209\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata))\ \{}
\DoxyCodeLine{05210\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a1f90b25b87791aab8a9abb80d35691d7}{do\_get\_bam\_rawdata}}(cdata);}
\DoxyCodeLine{05211\ \ \ \ \ \}}
\DoxyCodeLine{05212\ \ \ \ \ nassertr(\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05213\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a6c1fb4dd301cc1e9a14b6af6b5d97c1e}{do\_write\_txo\_file}}(cdata,\ fullpath);}
\DoxyCodeLine{05214\ \ \ \}}
\DoxyCodeLine{05215\ }
\DoxyCodeLine{05216\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a7c7c40f83f66e298526a13a4aa6e0e42}{do\_has\_uncompressed\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{05217\ \ \ \ \ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{05218\ \ \ \}}
\DoxyCodeLine{05219\ }
\DoxyCodeLine{05220\ \ \ nassertr(do\_has\_ram\_mipmap\_image(cdata,\ n),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05221\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05222\ }
\DoxyCodeLine{05223\ \ \ \textcolor{keywordflow}{if}\ (write\_pages\ \&\&\ write\_mipmaps)\ \{}
\DoxyCodeLine{05224\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ sequence\ of\ pages\ *\ mipmap\ levels.}}
\DoxyCodeLine{05225\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{05226\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_levels\ =\ cdata-\/>\_ram\_images.size();}
\DoxyCodeLine{05227\ }
\DoxyCodeLine{05228\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ num\_levels;\ ++n)\ \{}
\DoxyCodeLine{05229\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n);}
\DoxyCodeLine{05230\ }
\DoxyCodeLine{05231\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{05232\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ n\_pattern\ =\ Filename::pattern\_filename(fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z));}
\DoxyCodeLine{05233\ }
\DoxyCodeLine{05234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!n\_pattern.has\_hash())\ \{}
\DoxyCodeLine{05235\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05236\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ two\ different\ hash\ sequences:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{05237\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05238\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05239\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05240\ }
\DoxyCodeLine{05241\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{do\_write\_one}}(cdata,\ n\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n),\ z,\ n))\ \{}
\DoxyCodeLine{05242\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05244\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05245\ \ \ \ \ \}}
\DoxyCodeLine{05246\ }
\DoxyCodeLine{05247\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (write\_pages)\ \{}
\DoxyCodeLine{05248\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ sequence\ of\ pages.}}
\DoxyCodeLine{05249\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{05250\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fullpath\_pattern.has\_hash())\ \{}
\DoxyCodeLine{05251\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05252\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ a\ hash\ mark:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{05253\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05254\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05255\ \ \ \ \ \}}
\DoxyCodeLine{05256\ }
\DoxyCodeLine{05257\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views;}
\DoxyCodeLine{05258\ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{05259\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{do\_write\_one}}(cdata,\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(z),\ z,\ n))\ \{}
\DoxyCodeLine{05260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05261\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05262\ \ \ \ \ \}}
\DoxyCodeLine{05263\ }
\DoxyCodeLine{05264\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (write\_mipmaps)\ \{}
\DoxyCodeLine{05265\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ sequence\ of\ mipmap\ images.}}
\DoxyCodeLine{05266\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\_pattern\ =\ Filename::pattern\_filename(fullpath);}
\DoxyCodeLine{05267\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fullpath\_pattern.has\_hash())\ \{}
\DoxyCodeLine{05268\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05269\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Filename\ requires\ a\ hash\ mark:\ "{}}\ <<\ fullpath}
\DoxyCodeLine{05270\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05271\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05272\ \ \ \ \ \}}
\DoxyCodeLine{05273\ }
\DoxyCodeLine{05274\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_levels\ =\ cdata-\/>\_ram\_images.size();}
\DoxyCodeLine{05275\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ num\_levels;\ ++n)\ \{}
\DoxyCodeLine{05276\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{do\_write\_one}}(cdata,\ fullpath\_pattern.\mbox{\hyperlink{classFilename_a3900c44b7bef44eba442c171daf0b70c}{get\_filename\_index}}(n),\ z,\ n))\ \{}
\DoxyCodeLine{05277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05278\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05279\ \ \ \ \ \}}
\DoxyCodeLine{05280\ }
\DoxyCodeLine{05281\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05282\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ single\ file.}}
\DoxyCodeLine{05283\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{do\_write\_one}}(cdata,\ fullpath,\ z,\ n))\ \{}
\DoxyCodeLine{05284\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05285\ \ \ \ \ \}}
\DoxyCodeLine{05286\ \ \ \}}
\DoxyCodeLine{05287\ }
\DoxyCodeLine{05288\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05289\ \}}
\DoxyCodeLine{05290\ }
\DoxyCodeLine{05295\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{Texture::}}}
\DoxyCodeLine{05296\ \mbox{\hyperlink{classTexture_a0c6984033996039ba000390334672eea}{do\_write\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{05297\ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_ram\_mipmap\_image(cdata,\ n))\ \{}
\DoxyCodeLine{05298\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05299\ \ \ \}}
\DoxyCodeLine{05300\ }
\DoxyCodeLine{05301\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05302\ }
\DoxyCodeLine{05303\ \ \ \textcolor{keywordtype}{bool}\ success;}
\DoxyCodeLine{05304\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_type\ ==\ T\_float)\ \{}
\DoxyCodeLine{05305\ \ \ \ \ \textcolor{comment}{//\ Writing\ a\ floating-\/point\ texture.}}
\DoxyCodeLine{05306\ \ \ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ pfm;}
\DoxyCodeLine{05307\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(cdata,\ pfm,\ z,\ n))\ \{}
\DoxyCodeLine{05308\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05309\ \ \ \ \ \}}
\DoxyCodeLine{05310\ \ \ \ \ success\ =\ pfm.write(fullpath);}
\DoxyCodeLine{05311\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05312\ \ \ \ \ \textcolor{comment}{//\ Writing\ a\ normal,\ integer\ texture.}}
\DoxyCodeLine{05313\ \ \ \ \ \mbox{\hyperlink{classPNMFileType}{PNMFileType}}\ *type\ =}
\DoxyCodeLine{05314\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMFileTypeRegistry_a83617b215ff0b0482e86e463b43f22cf}{PNMFileTypeRegistry::get\_global\_ptr}}()-\/>\mbox{\hyperlink{classPNMFileTypeRegistry_af6acaa26376aeef1a4da1e874ab3a104}{get\_type\_from\_extension}}(fullpath);}
\DoxyCodeLine{05315\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05316\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05317\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::write()\ -\/\ couldn't\ determine\ type\ from\ extension:\ "{}}\ <<\ fullpath\ <<\ endl;}
\DoxyCodeLine{05318\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05319\ \ \ \ \ \}}
\DoxyCodeLine{05320\ }
\DoxyCodeLine{05321\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ pnmimage;}
\DoxyCodeLine{05322\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(cdata,\ pnmimage,\ z,\ n))\ \{}
\DoxyCodeLine{05323\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05324\ \ \ \ \ \}}
\DoxyCodeLine{05325\ \ \ \ \ success\ =\ pnmimage.write(fullpath,\ type);}
\DoxyCodeLine{05326\ \ \ \}}
\DoxyCodeLine{05327\ }
\DoxyCodeLine{05328\ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{05329\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05330\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture::write()\ -\/\ couldn't\ write:\ "{}}\ <<\ fullpath\ <<\ endl;}
\DoxyCodeLine{05331\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05332\ \ \ \}}
\DoxyCodeLine{05333\ }
\DoxyCodeLine{05334\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05335\ \}}
\DoxyCodeLine{05336\ }
\DoxyCodeLine{05340\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{Texture::}}}
\DoxyCodeLine{05341\ \mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{05342\ \ \ \textcolor{comment}{//\ First,\ reload\ the\ ram\ image\ if\ necessary.}}
\DoxyCodeLine{05343\ \ \ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{05344\ }
\DoxyCodeLine{05345\ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_ram\_mipmap\_image(cdata,\ n))\ \{}
\DoxyCodeLine{05346\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05347\ \ \ \}}
\DoxyCodeLine{05348\ }
\DoxyCodeLine{05349\ \ \ nassertr(z\ >=\ 0\ \&\&\ z\ <\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05350\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05351\ }
\DoxyCodeLine{05352\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_type\ ==\ T\_float)\ \{}
\DoxyCodeLine{05353\ \ \ \ \ \textcolor{comment}{//\ PNMImage\ by\ way\ of\ PfmFile.}}
\DoxyCodeLine{05354\ \ \ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ pfm;}
\DoxyCodeLine{05355\ \ \ \ \ \textcolor{keywordtype}{bool}\ success\ =\ convert\_to\_pfm(pfm,}
\DoxyCodeLine{05356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_x\_size(cdata,\ n),}
\DoxyCodeLine{05357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_y\_size(cdata,\ n),}
\DoxyCodeLine{05358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width,}
\DoxyCodeLine{05359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{05360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_ram\_mipmap\_page\_size(cdata,\ n),\ z);}
\DoxyCodeLine{05361\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{05362\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05363\ \ \ \ \ \}}
\DoxyCodeLine{05364\ \ \ \ \ \textcolor{keywordflow}{return}\ pfm.store(pnmimage);}
\DoxyCodeLine{05365\ \ \ \}}
\DoxyCodeLine{05366\ }
\DoxyCodeLine{05367\ \ \ \textcolor{keywordflow}{return}\ convert\_to\_pnmimage(pnmimage,}
\DoxyCodeLine{05368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_x\_size(cdata,\ n),}
\DoxyCodeLine{05369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_y\_size(cdata,\ n),}
\DoxyCodeLine{05370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_type,}
\DoxyCodeLine{05371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(cdata-\/>\_format),}
\DoxyCodeLine{05372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{05373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_ram\_mipmap\_page\_size(cdata,\ n),\ z);}
\DoxyCodeLine{05374\ \}}
\DoxyCodeLine{05375\ }
\DoxyCodeLine{05379\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{Texture::}}}
\DoxyCodeLine{05380\ \mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pfm,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{05381\ \ \ \textcolor{comment}{//\ First,\ reload\ the\ ram\ image\ if\ necessary.}}
\DoxyCodeLine{05382\ \ \ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{05383\ }
\DoxyCodeLine{05384\ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_ram\_mipmap\_image(cdata,\ n))\ \{}
\DoxyCodeLine{05385\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05386\ \ \ \}}
\DoxyCodeLine{05387\ }
\DoxyCodeLine{05388\ \ \ nassertr(z\ >=\ 0\ \&\&\ z\ <\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05389\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \textcolor{keyword}{false});}
\DoxyCodeLine{05390\ }
\DoxyCodeLine{05391\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_type\ !=\ T\_float)\ \{}
\DoxyCodeLine{05392\ \ \ \ \ \textcolor{comment}{//\ PfmFile\ by\ way\ of\ PNMImage.}}
\DoxyCodeLine{05393\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ pnmimage;}
\DoxyCodeLine{05394\ \ \ \ \ \textcolor{keywordtype}{bool}\ success\ =}
\DoxyCodeLine{05395\ \ \ \ \ \ \ convert\_to\_pnmimage(pnmimage,}
\DoxyCodeLine{05396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_x\_size(cdata,\ n),}
\DoxyCodeLine{05397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_y\_size(cdata,\ n),}
\DoxyCodeLine{05398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_type,}
\DoxyCodeLine{05399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(cdata-\/>\_format),}
\DoxyCodeLine{05400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{05401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_ram\_mipmap\_page\_size(cdata,\ n),\ z);}
\DoxyCodeLine{05402\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{05403\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05404\ \ \ \ \ \}}
\DoxyCodeLine{05405\ \ \ \ \ \textcolor{keywordflow}{return}\ pfm.load(pnmimage);}
\DoxyCodeLine{05406\ \ \ \}}
\DoxyCodeLine{05407\ }
\DoxyCodeLine{05408\ \ \ \textcolor{keywordflow}{return}\ convert\_to\_pfm(pfm,}
\DoxyCodeLine{05409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_x\_size(cdata,\ n),}
\DoxyCodeLine{05410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_expected\_mipmap\_y\_size(cdata,\ n),}
\DoxyCodeLine{05411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components,\ cdata-\/>\_component\_width,}
\DoxyCodeLine{05412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_image,}
\DoxyCodeLine{05413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ do\_get\_ram\_mipmap\_page\_size(cdata,\ n),\ z);}
\DoxyCodeLine{05414\ \}}
\DoxyCodeLine{05415\ }
\DoxyCodeLine{05419\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a6c1fb4dd301cc1e9a14b6af6b5d97c1e}{Texture::}}}
\DoxyCodeLine{05420\ \mbox{\hyperlink{classTexture_a6c1fb4dd301cc1e9a14b6af6b5d97c1e}{do\_write\_txo\_file}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05421\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{05422\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{05423\ \ \ ostream\ *out\ =\ vfs-\/>open\_write\_file(filename,\ \textcolor{keyword}{true},\ \textcolor{keyword}{true});}
\DoxyCodeLine{05424\ \ \ \textcolor{keywordflow}{if}\ (out\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05425\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05426\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05427\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05428\ \ \ \}}
\DoxyCodeLine{05429\ }
\DoxyCodeLine{05430\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ do\_write\_txo(cdata,\ *out,\ fullpath);}
\DoxyCodeLine{05431\ \ \ vfs-\/>close\_write\_file(out);}
\DoxyCodeLine{05432\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{05433\ \}}
\DoxyCodeLine{05434\ }
\DoxyCodeLine{05438\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{05439\ do\_write\_txo(\textcolor{keyword}{const}\ CData\ *cdata,\ ostream\ \&out,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&filename)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05440\ \ \ \mbox{\hyperlink{classDatagramOutputFile}{DatagramOutputFile}}\ dout;}
\DoxyCodeLine{05441\ }
\DoxyCodeLine{05442\ \ \ \textcolor{keywordflow}{if}\ (!dout.open(out,\ filename))\ \{}
\DoxyCodeLine{05443\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05444\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ write\ texture\ object:\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05445\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05446\ \ \ \}}
\DoxyCodeLine{05447\ }
\DoxyCodeLine{05448\ \ \ \textcolor{keywordflow}{if}\ (!dout.write\_header(\_bam\_header))\ \{}
\DoxyCodeLine{05449\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05450\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ write\ to\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05451\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05452\ \ \ \}}
\DoxyCodeLine{05453\ }
\DoxyCodeLine{05454\ \ \ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ writer(\&dout);}
\DoxyCodeLine{05455\ \ \ \textcolor{keywordflow}{if}\ (!writer.init())\ \{}
\DoxyCodeLine{05456\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05457\ \ \ \}}
\DoxyCodeLine{05458\ }
\DoxyCodeLine{05459\ \ \ writer.set\_file\_texture\_mode(BamWriter::BTM\_rawdata);}
\DoxyCodeLine{05460\ }
\DoxyCodeLine{05461\ \ \ \textcolor{keywordflow}{if}\ (!writer.write\_object(\textcolor{keyword}{this}))\ \{}
\DoxyCodeLine{05462\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05463\ \ \ \}}
\DoxyCodeLine{05464\ }
\DoxyCodeLine{05465\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata))\ \{}
\DoxyCodeLine{05466\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{05467\ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ does\ not\ have\ ram\ image\(\backslash\)n"{}};}
\DoxyCodeLine{05468\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05469\ \ \ \}}
\DoxyCodeLine{05470\ }
\DoxyCodeLine{05471\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05472\ \}}
\DoxyCodeLine{05473\ }
\DoxyCodeLine{05488\ \mbox{\hyperlink{classTexture_1_1CData}{Texture::CData}}\ *\mbox{\hyperlink{classTexture_acef5e397a933d18a85ee9dba42e1ed97}{Texture::}}}
\DoxyCodeLine{05489\ \mbox{\hyperlink{classTexture_acef5e397a933d18a85ee9dba42e1ed97}{unlocked\_ensure\_ram\_image}}(\textcolor{keywordtype}{bool}\ allow\_compression)\ \{}
\DoxyCodeLine{05490\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{05491\ }
\DoxyCodeLine{05492\ \ \ \textcolor{comment}{//\ First,\ wait\ for\ any\ other\ threads\ that\ might\ be\ simultaneously\ performing}}
\DoxyCodeLine{05493\ \ \ \textcolor{comment}{//\ the\ same\ operation.}}
\DoxyCodeLine{05494\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{05495\ \ \ \textcolor{keywordflow}{while}\ (\_reloading)\ \{}
\DoxyCodeLine{05496\ \ \ \ \ \_cvar.wait();}
\DoxyCodeLine{05497\ \ \ \}}
\DoxyCodeLine{05498\ }
\DoxyCodeLine{05499\ \ \ \textcolor{comment}{//\ Then\ make\ sure\ we\ still\ need\ to\ reload\ before\ continuing.}}
\DoxyCodeLine{05500\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata\ =\ \_cycler.read(current\_thread);}
\DoxyCodeLine{05501\ \ \ \textcolor{keywordtype}{bool}\ has\_ram\_image\ =\ \mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata);}
\DoxyCodeLine{05502\ \ \ \textcolor{keywordflow}{if}\ (has\_ram\_image\ \&\&\ !allow\_compression\ \&\&\ cdata-\/>\_ram\_image\_compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{05503\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ want\ compression,\ but\ the\ ram\ image\ we\ have\ is\ pre-\/}}
\DoxyCodeLine{05504\ \ \ \ \ \textcolor{comment}{//\ compressed,\ we\ don't\ consider\ it.}}
\DoxyCodeLine{05505\ \ \ \ \ has\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05506\ \ \ \}}
\DoxyCodeLine{05507\ \ \ \textcolor{keywordflow}{if}\ (has\_ram\_image\ ||\ !\mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(cdata))\ \{}
\DoxyCodeLine{05508\ \ \ \ \ \textcolor{comment}{//\ We\ don't\ need\ to\ reload\ after\ all,\ or\ maybe\ we\ can't\ reload\ anyway.}}
\DoxyCodeLine{05509\ \ \ \ \ \textcolor{comment}{//\ Return,\ but\ elevate\ the\ lock\ first,\ as\ we\ promised.}}
\DoxyCodeLine{05510\ \ \ \ \ \textcolor{keywordflow}{return}\ \_cycler.elevate\_read\_upstream(cdata,\ \textcolor{keyword}{false},\ current\_thread);}
\DoxyCodeLine{05511\ \ \ \}}
\DoxyCodeLine{05512\ }
\DoxyCodeLine{05513\ \ \ \textcolor{comment}{//\ We\ need\ to\ reload.}}
\DoxyCodeLine{05514\ \ \ nassertr(!\_reloading,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05515\ \ \ \_reloading\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05516\ }
\DoxyCodeLine{05517\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ tex\ =\ do\_make\_copy(cdata);}
\DoxyCodeLine{05518\ \ \ \_cycler.release\_read(cdata);}
\DoxyCodeLine{05519\ \ \ \_lock.unlock();}
\DoxyCodeLine{05520\ }
\DoxyCodeLine{05521\ \ \ \textcolor{comment}{//\ Perform\ the\ actual\ reload\ in\ a\ copy\ of\ the\ texture,\ while\ our\ own\ mutex}}
\DoxyCodeLine{05522\ \ \ \textcolor{comment}{//\ is\ left\ unlocked.}}
\DoxyCodeLine{05523\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata\_tex(tex-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{05524\ \ \ tex-\/>do\_reload\_ram\_image(cdata\_tex,\ allow\_compression);}
\DoxyCodeLine{05525\ }
\DoxyCodeLine{05526\ \ \ \_lock.lock();}
\DoxyCodeLine{05527\ }
\DoxyCodeLine{05528\ \ \ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdataw\ =\ \_cycler.write\_upstream(\textcolor{keyword}{false},\ current\_thread);}
\DoxyCodeLine{05529\ }
\DoxyCodeLine{05530\ \ \ \textcolor{comment}{//\ Rather\ than\ calling\ do\_assign(),\ which\ would\ copy\ *all*\ of\ the\ reloaded}}
\DoxyCodeLine{05531\ \ \ \textcolor{comment}{//\ texture's\ properties\ over,\ we\ only\ copy\ in\ the\ ones\ which\ are\ relevant\ to}}
\DoxyCodeLine{05532\ \ \ \textcolor{comment}{//\ the\ ram\ image.\ \ This\ way,\ if\ the\ properties\ have\ changed\ during\ the}}
\DoxyCodeLine{05533\ \ \ \textcolor{comment}{//\ reload\ (for\ instance,\ because\ we\ reloaded\ a\ txo),\ it\ won't\ contaminate}}
\DoxyCodeLine{05534\ \ \ \textcolor{comment}{//\ the\ original\ texture.}}
\DoxyCodeLine{05535\ \ \ cdataw-\/>\_orig\_file\_x\_size\ =\ cdata\_tex-\/>\_orig\_file\_x\_size;}
\DoxyCodeLine{05536\ \ \ cdataw-\/>\_orig\_file\_y\_size\ =\ cdata\_tex-\/>\_orig\_file\_y\_size;}
\DoxyCodeLine{05537\ }
\DoxyCodeLine{05538\ \ \ \textcolor{comment}{//\ If\ any\ of\ *these*\ properties\ have\ changed,\ the\ texture\ has\ changed\ in}}
\DoxyCodeLine{05539\ \ \ \textcolor{comment}{//\ some\ fundamental\ way.\ \ Update\ it\ appropriately.}}
\DoxyCodeLine{05540\ \ \ \textcolor{keywordflow}{if}\ (cdata\_tex-\/>\_x\_size\ !=\ cdataw-\/>\_x\_size\ ||}
\DoxyCodeLine{05541\ \ \ \ \ \ \ cdata\_tex-\/>\_y\_size\ !=\ cdataw-\/>\_y\_size\ ||}
\DoxyCodeLine{05542\ \ \ \ \ \ \ cdata\_tex-\/>\_z\_size\ !=\ cdataw-\/>\_z\_size\ ||}
\DoxyCodeLine{05543\ \ \ \ \ \ \ cdata\_tex-\/>\_num\_views\ !=\ cdataw-\/>\_num\_views\ ||}
\DoxyCodeLine{05544\ \ \ \ \ \ \ cdata\_tex-\/>\_num\_components\ !=\ cdataw-\/>\_num\_components\ ||}
\DoxyCodeLine{05545\ \ \ \ \ \ \ cdata\_tex-\/>\_component\_width\ !=\ cdataw-\/>\_component\_width\ ||}
\DoxyCodeLine{05546\ \ \ \ \ \ \ cdata\_tex-\/>\_texture\_type\ !=\ cdataw-\/>\_texture\_type\ ||}
\DoxyCodeLine{05547\ \ \ \ \ \ \ cdata\_tex-\/>\_component\_type\ !=\ cdataw-\/>\_component\_type)\ \{}
\DoxyCodeLine{05548\ }
\DoxyCodeLine{05549\ \ \ \ \ cdataw-\/>\_x\_size\ =\ cdata\_tex-\/>\_x\_size;}
\DoxyCodeLine{05550\ \ \ \ \ cdataw-\/>\_y\_size\ =\ cdata\_tex-\/>\_y\_size;}
\DoxyCodeLine{05551\ \ \ \ \ cdataw-\/>\_z\_size\ =\ cdata\_tex-\/>\_z\_size;}
\DoxyCodeLine{05552\ \ \ \ \ cdataw-\/>\_num\_views\ =\ cdata\_tex-\/>\_num\_views;}
\DoxyCodeLine{05553\ }
\DoxyCodeLine{05554\ \ \ \ \ cdataw-\/>\_num\_components\ =\ cdata\_tex-\/>\_num\_components;}
\DoxyCodeLine{05555\ \ \ \ \ cdataw-\/>\_component\_width\ =\ cdata\_tex-\/>\_component\_width;}
\DoxyCodeLine{05556\ \ \ \ \ cdataw-\/>\_texture\_type\ =\ cdata\_tex-\/>\_texture\_type;}
\DoxyCodeLine{05557\ \ \ \ \ cdataw-\/>\_format\ =\ cdata\_tex-\/>\_format;}
\DoxyCodeLine{05558\ \ \ \ \ cdataw-\/>\_component\_type\ =\ cdata\_tex-\/>\_component\_type;}
\DoxyCodeLine{05559\ }
\DoxyCodeLine{05560\ \ \ \ \ cdataw-\/>inc\_properties\_modified();}
\DoxyCodeLine{05561\ \ \ \}}
\DoxyCodeLine{05562\ }
\DoxyCodeLine{05563\ \ \ cdataw-\/>\_keep\_ram\_image\ =\ cdata\_tex-\/>\_keep\_ram\_image;}
\DoxyCodeLine{05564\ \ \ cdataw-\/>\_ram\_image\_compression\ =\ cdata\_tex-\/>\_ram\_image\_compression;}
\DoxyCodeLine{05565\ \ \ cdataw-\/>\_ram\_images\ =\ cdata\_tex-\/>\_ram\_images;}
\DoxyCodeLine{05566\ }
\DoxyCodeLine{05567\ \ \ nassertr(\_reloading,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05568\ \ \ \_reloading\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05569\ }
\DoxyCodeLine{05570\ \ \ cdataw-\/>inc\_image\_modified();}
\DoxyCodeLine{05571\ }
\DoxyCodeLine{05572\ \ \ \_cvar.notify\_all();}
\DoxyCodeLine{05573\ }
\DoxyCodeLine{05574\ \ \ \textcolor{comment}{//\ Return\ the\ still-\/locked\ cdata.}}
\DoxyCodeLine{05575\ \ \ \textcolor{keywordflow}{return}\ cdataw;}
\DoxyCodeLine{05576\ \}}
\DoxyCodeLine{05577\ }
\DoxyCodeLine{05586\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ac03cc54614e018515f4ce9f05da89ec1}{Texture::}}}
\DoxyCodeLine{05587\ \mbox{\hyperlink{classTexture_ac03cc54614e018515f4ce9f05da89ec1}{do\_reload\_ram\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{bool}\ allow\_compression)\ \{}
\DoxyCodeLine{05588\ \ \ \mbox{\hyperlink{classBamCache}{BamCache}}\ *cache\ =\ BamCache::get\_global\_ptr();}
\DoxyCodeLine{05589\ \ \ PT(\mbox{\hyperlink{classBamCacheRecord}{BamCacheRecord}})\ record;}
\DoxyCodeLine{05590\ }
\DoxyCodeLine{05591\ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_compression(cdata))\ \{}
\DoxyCodeLine{05592\ \ \ \ \ allow\_compression\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05593\ \ \ \}}
\DoxyCodeLine{05594\ }
\DoxyCodeLine{05595\ \ \ \textcolor{keywordflow}{if}\ ((cache-\/>get\_cache\_textures()\ ||\ (allow\_compression\ \&\&\ cache-\/>get\_cache\_compressed\_textures()))\ \&\&\ !textures\_header\_only)\ \{}
\DoxyCodeLine{05596\ \ \ \ \ \textcolor{comment}{//\ See\ if\ the\ texture\ can\ be\ found\ in\ the\ on-\/disk\ cache,\ if\ it\ is\ active.}}
\DoxyCodeLine{05597\ }
\DoxyCodeLine{05598\ \ \ \ \ record\ =\ cache-\/>lookup(cdata-\/>\_fullpath,\ \textcolor{stringliteral}{"{}txo"{}});}
\DoxyCodeLine{05599\ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{05600\ \ \ \ \ \ \ \ \ record-\/>has\_data())\ \{}
\DoxyCodeLine{05601\ \ \ \ \ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ tex\ =\ DCAST(\mbox{\hyperlink{classTexture}{Texture}},\ record-\/>get\_data());}
\DoxyCodeLine{05602\ }
\DoxyCodeLine{05603\ \ \ \ \ \ \ \textcolor{comment}{//\ But\ don't\ use\ the\ cache\ record\ if\ the\ config\ parameters\ have\ changed,}}
\DoxyCodeLine{05604\ \ \ \ \ \ \ \textcolor{comment}{//\ and\ we\ want\ a\ different-\/sized\ texture\ now.}}
\DoxyCodeLine{05605\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ cdata-\/>\_orig\_file\_x\_size;}
\DoxyCodeLine{05606\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ cdata-\/>\_orig\_file\_y\_size;}
\DoxyCodeLine{05607\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{do\_adjust\_this\_size}}(cdata,\ x\_size,\ y\_size,\ cdata-\/>\_filename.get\_basename(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{05608\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ tex-\/>get\_x\_size()\ ||\ y\_size\ !=\ tex-\/>get\_y\_size())\ \{}
\DoxyCodeLine{05609\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{05610\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{05611\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cached\ texture\ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\ has\ size\ "{}}}
\DoxyCodeLine{05612\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ tex-\/>get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ tex-\/>get\_y\_size()}
\DoxyCodeLine{05613\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ instead\ of\ "{}}\ <<\ x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ y\_size}
\DoxyCodeLine{05614\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{};\ ignoring\ cache.\(\backslash\)n"{}};}
\DoxyCodeLine{05615\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05616\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05617\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Also\ don't\ keep\ the\ cached\ version\ if\ it's\ compressed\ but\ we\ want}}
\DoxyCodeLine{05618\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ uncompressed.}}
\DoxyCodeLine{05619\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!allow\_compression\ \&\&\ tex-\/>get\_ram\_image\_compression()\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{05620\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{05621\ \ \ \ \ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{05622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cached\ texture\ "{}}\ <<\ *\textcolor{keyword}{this}}
\DoxyCodeLine{05623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ is\ compressed\ in\ cache;\ ignoring\ cache.\(\backslash\)n"{}};}
\DoxyCodeLine{05624\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05625\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05626\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{05627\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ reloaded\ from\ disk\ cache\(\backslash\)n"{}};}
\DoxyCodeLine{05628\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ want\ to\ replace\ all\ the\ texture\ parameters-\/-\/for}}
\DoxyCodeLine{05629\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ instance,\ we\ don't\ want\ to\ change\ the\ filter\ type\ or\ the\ border}}
\DoxyCodeLine{05630\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ color\ or\ anything-\/-\/we\ just\ want\ to\ get\ the\ image\ and\ necessary}}
\DoxyCodeLine{05631\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ associated\ parameters.}}
\DoxyCodeLine{05632\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata\_tex(tex-\/>\_cycler);}
\DoxyCodeLine{05633\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_x\_size\ =\ cdata\_tex-\/>\_x\_size;}
\DoxyCodeLine{05634\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_y\_size\ =\ cdata\_tex-\/>\_y\_size;}
\DoxyCodeLine{05635\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ !=\ cdata\_tex-\/>\_num\_components)\ \{}
\DoxyCodeLine{05636\ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components\ =\ cdata\_tex-\/>\_num\_components;}
\DoxyCodeLine{05637\ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_format\ =\ cdata\_tex-\/>\_format;}
\DoxyCodeLine{05638\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05639\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_component\_type\ =\ cdata\_tex-\/>\_component\_type;}
\DoxyCodeLine{05640\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_compression\ =\ cdata\_tex-\/>\_compression;}
\DoxyCodeLine{05641\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_image\_compression\ =\ cdata\_tex-\/>\_ram\_image\_compression;}
\DoxyCodeLine{05642\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_ram\_images\ =\ cdata\_tex-\/>\_ram\_images;}
\DoxyCodeLine{05643\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{05644\ }
\DoxyCodeLine{05645\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ was\_compressed\ =\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off);}
\DoxyCodeLine{05646\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a02144ecaee7fca731249f1513b632eff}{do\_consider\_auto\_process\_ram\_image}}(cdata,\ uses\_mipmaps(),\ allow\_compression))\ \{}
\DoxyCodeLine{05647\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_compressed\ =\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off);}
\DoxyCodeLine{05648\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!was\_compressed\ \&\&\ is\_compressed\ \&\&}
\DoxyCodeLine{05649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache-\/>get\_cache\_compressed\_textures())\ \{}
\DoxyCodeLine{05650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We've\ re-\/compressed\ the\ image\ after\ loading\ it\ from\ the}}
\DoxyCodeLine{05651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ cache.\ \ To\ keep\ the\ cache\ current,\ rewrite\ it\ to\ the\ cache}}
\DoxyCodeLine{05652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ now,\ in\ its\ newly\ compressed\ form.}}
\DoxyCodeLine{05653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ record-\/>set\_data(\textcolor{keyword}{this},\ \textcolor{keyword}{this});}
\DoxyCodeLine{05654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache-\/>store(record);}
\DoxyCodeLine{05655\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05656\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05657\ }
\DoxyCodeLine{05658\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{05659\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05660\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05661\ \ \ \ \ \}}
\DoxyCodeLine{05662\ \ \ \}}
\DoxyCodeLine{05663\ }
\DoxyCodeLine{05664\ \ \ gobj\_cat.info()}
\DoxyCodeLine{05665\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reloading\ texture\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05666\ }
\DoxyCodeLine{05667\ \ \ \textcolor{keywordtype}{int}\ z\ =\ 0;}
\DoxyCodeLine{05668\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{05669\ }
\DoxyCodeLine{05670\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_read\_pages)\ \{}
\DoxyCodeLine{05671\ \ \ \ \ z\ =\ cdata-\/>\_z\_size;}
\DoxyCodeLine{05672\ \ \ \}}
\DoxyCodeLine{05673\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_read\_mipmaps)\ \{}
\DoxyCodeLine{05674\ \ \ \ \ n\ =\ cdata-\/>\_num\_mipmap\_levels\_read;}
\DoxyCodeLine{05675\ \ \ \}}
\DoxyCodeLine{05676\ }
\DoxyCodeLine{05677\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{05678\ \ \ Format\ orig\_format\ =\ cdata-\/>\_format;}
\DoxyCodeLine{05679\ \ \ \textcolor{keywordtype}{int}\ orig\_num\_components\ =\ cdata-\/>\_num\_components;}
\DoxyCodeLine{05680\ }
\DoxyCodeLine{05681\ \ \ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ options;}
\DoxyCodeLine{05682\ \ \ \textcolor{keywordflow}{if}\ (allow\_compression)\ \{}
\DoxyCodeLine{05683\ \ \ \ \ options.set\_texture\_flags(LoaderOptions::TF\_preload\ |}
\DoxyCodeLine{05684\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LoaderOptions::TF\_allow\_compression);}
\DoxyCodeLine{05685\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05686\ \ \ \ \ options.set\_texture\_flags(LoaderOptions::TF\_preload);}
\DoxyCodeLine{05687\ \ \ \}}
\DoxyCodeLine{05688\ \ \ \mbox{\hyperlink{classTexture_a8cd559e4c3a43aeb579d943cf1f1e188}{do\_read}}(cdata,\ cdata-\/>\_fullpath,\ cdata-\/>\_alpha\_fullpath,}
\DoxyCodeLine{05689\ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_primary\_file\_num\_channels,\ cdata-\/>\_alpha\_file\_channel,}
\DoxyCodeLine{05690\ \ \ \ \ \ \ \ \ \ \ z,\ n,\ cdata-\/>\_has\_read\_pages,\ cdata-\/>\_has\_read\_mipmaps,\ options,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05691\ }
\DoxyCodeLine{05692\ \ \ \textcolor{keywordflow}{if}\ (orig\_num\_components\ ==\ cdata-\/>\_num\_components)\ \{}
\DoxyCodeLine{05693\ \ \ \ \ \textcolor{comment}{//\ Restore\ the\ original\ format,\ in\ case\ it\ was\ needlessly\ changed\ during}}
\DoxyCodeLine{05694\ \ \ \ \ \textcolor{comment}{//\ the\ reload\ operation.}}
\DoxyCodeLine{05695\ \ \ \ \ cdata-\/>\_format\ =\ orig\_format;}
\DoxyCodeLine{05696\ \ \ \}}
\DoxyCodeLine{05697\ }
\DoxyCodeLine{05698\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata)\ \&\&\ record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05699\ \ \ \ \ \textcolor{keywordflow}{if}\ (cache-\/>get\_cache\_textures()\ ||\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off\ \&\&\ cache-\/>get\_cache\_compressed\_textures()))\ \{}
\DoxyCodeLine{05700\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ cache.}}
\DoxyCodeLine{05701\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05702\ \ \ \ \ \ \ \ \ record-\/>add\_dependent\_file(cdata-\/>\_fullpath);}
\DoxyCodeLine{05703\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05704\ \ \ \ \ \ \ record-\/>set\_data(\textcolor{keyword}{this},\ \textcolor{keyword}{this});}
\DoxyCodeLine{05705\ \ \ \ \ \ \ cache-\/>store(record);}
\DoxyCodeLine{05706\ \ \ \ \ \}}
\DoxyCodeLine{05707\ \ \ \}}
\DoxyCodeLine{05708\ }
\DoxyCodeLine{05709\ \ \ \textcolor{comment}{//\ Remove\ any\ pending\ asynchronous\ reload\ operation.}}
\DoxyCodeLine{05710\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_reload\_task\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{05711\ \ \ \ \ cdata-\/>\_reload\_task-\/>remove();}
\DoxyCodeLine{05712\ \ \ \ \ cdata-\/>\_reload\_task\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05713\ \ \ \}}
\DoxyCodeLine{05714\ \}}
\DoxyCodeLine{05715\ }
\DoxyCodeLine{05720\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \mbox{\hyperlink{classTexture_a1273d4e83f00e6ec1e1d777836fcc935}{Texture::}}}
\DoxyCodeLine{05721\ \mbox{\hyperlink{classTexture_a1273d4e83f00e6ec1e1d777836fcc935}{do\_modify\_ram\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\ \{}
\DoxyCodeLine{05722\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ ||\ cdata-\/>\_ram\_images[0].\_image.empty()\ ||}
\DoxyCodeLine{05723\ \ \ \ \ \ \ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{05724\ \ \ \ \ \mbox{\hyperlink{classTexture_afc2eb673cfd512db47eb76998fac3a7d}{do\_make\_ram\_image}}(cdata);}
\DoxyCodeLine{05725\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05726\ \ \ \ \ do\_clear\_ram\_mipmap\_images(cdata);}
\DoxyCodeLine{05727\ \ \ \}}
\DoxyCodeLine{05728\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ data\ =\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{05729\ \ \ \textcolor{keywordflow}{if}\ (data.get\_node\_ref\_count()\ >\ 0)\ \{}
\DoxyCodeLine{05730\ \ \ \ \ \textcolor{comment}{//\ Copy\ on\ write,\ if\ an\ upload\ thread\ is\ reading\ this\ now.}}
\DoxyCodeLine{05731\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ new\_data\ =\ PTA\_uchar::empty\_array(0);}
\DoxyCodeLine{05732\ \ \ \ \ new\_data.v()\ =\ data.v();}
\DoxyCodeLine{05733\ \ \ \ \ data.swap(new\_data);}
\DoxyCodeLine{05734\ \ \ \}}
\DoxyCodeLine{05735\ \ \ \textcolor{keywordflow}{return}\ data;}
\DoxyCodeLine{05736\ \}}
\DoxyCodeLine{05737\ }
\DoxyCodeLine{05742\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \mbox{\hyperlink{classTexture_afc2eb673cfd512db47eb76998fac3a7d}{Texture::}}}
\DoxyCodeLine{05743\ \mbox{\hyperlink{classTexture_afc2eb673cfd512db47eb76998fac3a7d}{do\_make\_ram\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\ \{}
\DoxyCodeLine{05744\ \ \ \textcolor{keywordtype}{int}\ image\_size\ =\ do\_get\_expected\_ram\_image\_size(cdata);}
\DoxyCodeLine{05745\ \ \ cdata-\/>\_ram\_images.clear();}
\DoxyCodeLine{05746\ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{05747\ \ \ cdata-\/>\_ram\_images[0].\_page\_size\ =\ do\_get\_expected\_ram\_page\_size(cdata);}
\DoxyCodeLine{05748\ \ \ cdata-\/>\_ram\_images[0].\_image\ =\ PTA\_uchar::empty\_array(image\_size,\ get\_class\_type());}
\DoxyCodeLine{05749\ \ \ cdata-\/>\_ram\_images[0].\_pointer\_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05750\ \ \ cdata-\/>\_ram\_image\_compression\ =\ CM\_off;}
\DoxyCodeLine{05751\ }
\DoxyCodeLine{05752\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_clear\_color)\ \{}
\DoxyCodeLine{05753\ \ \ \ \ \textcolor{comment}{//\ Fill\ the\ image\ with\ the\ clear\ color.}}
\DoxyCodeLine{05754\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structpixel}{pixel}}[16];}
\DoxyCodeLine{05755\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ pixel\_size\ =\ \mbox{\hyperlink{classTexture_a872f62140fa65c333fab00fb1161b26d}{do\_get\_clear\_data}}(cdata,\ \mbox{\hyperlink{structpixel}{pixel}});}
\DoxyCodeLine{05756\ \ \ \ \ nassertr(pixel\_size\ >\ 0,\ cdata-\/>\_ram\_images[0].\_image);}
\DoxyCodeLine{05757\ }
\DoxyCodeLine{05758\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *image\_data\ =\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{05759\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ image\_size;\ i\ +=\ pixel\_size)\ \{}
\DoxyCodeLine{05760\ \ \ \ \ \ \ memcpy(image\_data\ +\ i,\ \mbox{\hyperlink{structpixel}{pixel}},\ pixel\_size);}
\DoxyCodeLine{05761\ \ \ \ \ \}}
\DoxyCodeLine{05762\ \ \ \}}
\DoxyCodeLine{05763\ }
\DoxyCodeLine{05764\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{05765\ \}}
\DoxyCodeLine{05766\ }
\DoxyCodeLine{05774\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{Texture::}}}
\DoxyCodeLine{05775\ \mbox{\hyperlink{classTexture_aa4fb21eb05b9b2a7a0272f9536111516}{do\_set\_ram\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ Texture::CompressionMode\ compression,}
\DoxyCodeLine{05776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{05777\ \ \ nassertv(compression\ !=\ CM\_default);}
\DoxyCodeLine{05778\ \ \ nassertv(compression\ !=\ CM\_off\ ||\ image.size()\ ==\ do\_get\_expected\_ram\_image\_size(cdata));}
\DoxyCodeLine{05779\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty())\ \{}
\DoxyCodeLine{05780\ \ \ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{05781\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05782\ \ \ \ \ do\_clear\_ram\_mipmap\_images(cdata);}
\DoxyCodeLine{05783\ \ \ \}}
\DoxyCodeLine{05784\ \ \ \textcolor{keywordflow}{if}\ (page\_size\ ==\ 0)\ \{}
\DoxyCodeLine{05785\ \ \ \ \ page\_size\ =\ image.size();}
\DoxyCodeLine{05786\ \ \ \}}
\DoxyCodeLine{05787\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images[0].\_image\ !=\ image\ ||}
\DoxyCodeLine{05788\ \ \ \ \ \ \ cdata-\/>\_ram\_images[0].\_page\_size\ !=\ page\_size\ ||}
\DoxyCodeLine{05789\ \ \ \ \ \ \ cdata-\/>\_ram\_image\_compression\ !=\ compression)\ \{}
\DoxyCodeLine{05790\ \ \ \ \ cdata-\/>\_ram\_images[0].\_image\ =\ image.cast\_non\_const();}
\DoxyCodeLine{05791\ \ \ \ \ cdata-\/>\_ram\_images[0].\_page\_size\ =\ page\_size;}
\DoxyCodeLine{05792\ \ \ \ \ cdata-\/>\_ram\_images[0].\_pointer\_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05793\ \ \ \ \ cdata-\/>\_ram\_image\_compression\ =\ compression;}
\DoxyCodeLine{05794\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{05795\ \ \ \}}
\DoxyCodeLine{05796\ \}}
\DoxyCodeLine{05797\ }
\DoxyCodeLine{05802\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \mbox{\hyperlink{classTexture_a22ff7474ef423e26313d550f44837ea7}{Texture::}}}
\DoxyCodeLine{05803\ \mbox{\hyperlink{classTexture_a22ff7474ef423e26313d550f44837ea7}{do\_modify\_ram\_mipmap\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{05804\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{05805\ }
\DoxyCodeLine{05806\ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size()\ ||}
\DoxyCodeLine{05807\ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_image.empty())\ \{}
\DoxyCodeLine{05808\ \ \ \ \ do\_make\_ram\_mipmap\_image(cdata,\ n);}
\DoxyCodeLine{05809\ \ \ \}}
\DoxyCodeLine{05810\ }
\DoxyCodeLine{05811\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ data\ =\ cdata-\/>\_ram\_images[n].\_image;}
\DoxyCodeLine{05812\ \ \ \textcolor{keywordflow}{if}\ (data.get\_node\_ref\_count()\ >\ 0)\ \{}
\DoxyCodeLine{05813\ \ \ \ \ \textcolor{comment}{//\ Copy\ on\ write,\ if\ an\ upload\ thread\ is\ reading\ this\ now.}}
\DoxyCodeLine{05814\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ new\_data\ =\ PTA\_uchar::empty\_array(0);}
\DoxyCodeLine{05815\ \ \ \ \ new\_data.v()\ =\ data.v();}
\DoxyCodeLine{05816\ \ \ \ \ data.swap(new\_data);}
\DoxyCodeLine{05817\ \ \ \}}
\DoxyCodeLine{05818\ \ \ \textcolor{keywordflow}{return}\ data;}
\DoxyCodeLine{05819\ \}}
\DoxyCodeLine{05820\ }
\DoxyCodeLine{05824\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{05825\ do\_make\_ram\_mipmap\_image(CData\ *cdata,\ \textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{05826\ \ \ nassertr(cdata-\/>\_ram\_image\_compression\ ==\ CM\_off,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}(get\_class\_type()));}
\DoxyCodeLine{05827\ }
\DoxyCodeLine{05828\ \ \ \textcolor{keywordflow}{while}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{05829\ \ \ \ \ cdata-\/>\_ram\_images.push\_back(RamImage());}
\DoxyCodeLine{05830\ \ \ \}}
\DoxyCodeLine{05831\ }
\DoxyCodeLine{05832\ \ \ \textcolor{keywordtype}{size\_t}\ image\_size\ =\ do\_get\_expected\_ram\_mipmap\_image\_size(cdata,\ n);}
\DoxyCodeLine{05833\ \ \ cdata-\/>\_ram\_images[n].\_image\ =\ PTA\_uchar::empty\_array(image\_size,\ get\_class\_type());}
\DoxyCodeLine{05834\ \ \ cdata-\/>\_ram\_images[n].\_pointer\_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05835\ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{05836\ }
\DoxyCodeLine{05837\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_clear\_color)\ \{}
\DoxyCodeLine{05838\ \ \ \ \ \textcolor{comment}{//\ Fill\ the\ image\ with\ the\ clear\ color.}}
\DoxyCodeLine{05839\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structpixel}{pixel}}[16];}
\DoxyCodeLine{05840\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ pixel\_size\ =\ (size\_t)\mbox{\hyperlink{classTexture_a872f62140fa65c333fab00fb1161b26d}{do\_get\_clear\_data}}(cdata,\ \mbox{\hyperlink{structpixel}{pixel}});}
\DoxyCodeLine{05841\ \ \ \ \ nassertr(pixel\_size\ >\ 0,\ cdata-\/>\_ram\_images[n].\_image);}
\DoxyCodeLine{05842\ }
\DoxyCodeLine{05843\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *image\_data\ =\ cdata-\/>\_ram\_images[n].\_image;}
\DoxyCodeLine{05844\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ image\_size;\ i\ +=\ pixel\_size)\ \{}
\DoxyCodeLine{05845\ \ \ \ \ \ \ memcpy(image\_data\ +\ i,\ \mbox{\hyperlink{structpixel}{pixel}},\ pixel\_size);}
\DoxyCodeLine{05846\ \ \ \ \ \}}
\DoxyCodeLine{05847\ \ \ \}}
\DoxyCodeLine{05848\ }
\DoxyCodeLine{05849\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[n].\_image;}
\DoxyCodeLine{05850\ \}}
\DoxyCodeLine{05851\ }
\DoxyCodeLine{05855\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{05856\ do\_set\_ram\_mipmap\_image(CData\ *cdata,\ \textcolor{keywordtype}{int}\ n,\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{05857\ \ \ nassertv(cdata-\/>\_ram\_image\_compression\ !=\ CM\_off\ ||\ image.size()\ ==\ do\_get\_expected\_ram\_mipmap\_image\_size(cdata,\ n));}
\DoxyCodeLine{05858\ }
\DoxyCodeLine{05859\ \ \ \textcolor{keywordflow}{while}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{05860\ \ \ \ \ cdata-\/>\_ram\_images.push\_back(RamImage());}
\DoxyCodeLine{05861\ \ \ \}}
\DoxyCodeLine{05862\ \ \ \textcolor{keywordflow}{if}\ (page\_size\ ==\ 0)\ \{}
\DoxyCodeLine{05863\ \ \ \ \ page\_size\ =\ image.size();}
\DoxyCodeLine{05864\ \ \ \}}
\DoxyCodeLine{05865\ }
\DoxyCodeLine{05866\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images[n].\_image\ !=\ image\ ||}
\DoxyCodeLine{05867\ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ !=\ page\_size)\ \{}
\DoxyCodeLine{05868\ \ \ \ \ cdata-\/>\_ram\_images[n].\_image\ =\ image.cast\_non\_const();}
\DoxyCodeLine{05869\ \ \ \ \ cdata-\/>\_ram\_images[n].\_pointer\_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{05870\ \ \ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ page\_size;}
\DoxyCodeLine{05871\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{05872\ \ \ \}}
\DoxyCodeLine{05873\ \}}
\DoxyCodeLine{05874\ }
\DoxyCodeLine{05882\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classTexture_a872f62140fa65c333fab00fb1161b26d}{Texture::}}}
\DoxyCodeLine{05883\ \mbox{\hyperlink{classTexture_a872f62140fa65c333fab00fb1161b26d}{do\_get\_clear\_data}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *into)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{05884\ \ \ nassertr(cdata-\/>\_has\_clear\_color,\ 0);}
\DoxyCodeLine{05885\ }
\DoxyCodeLine{05886\ \ \ \textcolor{keywordtype}{int}\ num\_components\ =\ cdata-\/>\_num\_components;}
\DoxyCodeLine{05887\ \ \ nassertr(num\_components\ >\ 0,\ 0);}
\DoxyCodeLine{05888\ \ \ nassertr(num\_components\ <=\ 4,\ 0);}
\DoxyCodeLine{05889\ }
\DoxyCodeLine{05890\ \ \ LVecBase4\ clear\_value\ =\ cdata-\/>\_clear\_color;}
\DoxyCodeLine{05891\ }
\DoxyCodeLine{05892\ \ \ \textcolor{comment}{//\ Swap\ red\ and\ blue\ components.}}
\DoxyCodeLine{05893\ \ \ \textcolor{keywordflow}{if}\ (num\_components\ >=\ 3)\ \{}
\DoxyCodeLine{05894\ \ \ \ \ std::swap(clear\_value[0],\ clear\_value[2]);}
\DoxyCodeLine{05895\ \ \ \}}
\DoxyCodeLine{05896\ }
\DoxyCodeLine{05897\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_component\_type)\ \{}
\DoxyCodeLine{05898\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{05899\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(cdata-\/>\_format))\ \{}
\DoxyCodeLine{05900\ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{05901\ \ \ \ \ \ \ xelval\ alpha;}
\DoxyCodeLine{05902\ \ \ \ \ \ \ encode\_sRGB\_uchar(clear\_value,\ \mbox{\hyperlink{structcolor}{color}},\ alpha);}
\DoxyCodeLine{05903\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (num\_components)\ \{}
\DoxyCodeLine{05904\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:\ into[3]\ =\ (\textcolor{keywordtype}{unsigned}\ char)alpha;}
\DoxyCodeLine{05905\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:\ into[2]\ =\ (\textcolor{keywordtype}{unsigned}\ char)\mbox{\hyperlink{structcolor}{color}}.b;}
\DoxyCodeLine{05906\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:\ into[1]\ =\ (\textcolor{keywordtype}{unsigned}\ char)\mbox{\hyperlink{structcolor}{color}}.g;}
\DoxyCodeLine{05907\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:\ into[0]\ =\ (\textcolor{keywordtype}{unsigned}\ char)\mbox{\hyperlink{structcolor}{color}}.r;}
\DoxyCodeLine{05908\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05909\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05910\ \ \ \ \ \ \ LColor\ scaled\ =\ clear\_value.fmin(LColor(1)).fmax(LColor::zero());}
\DoxyCodeLine{05911\ \ \ \ \ \ \ scaled\ *=\ 255;}
\DoxyCodeLine{05912\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05913\ \ \ \ \ \ \ \ \ into[i]\ =\ (\textcolor{keywordtype}{unsigned}\ char)scaled[i];}
\DoxyCodeLine{05914\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05915\ \ \ \ \ \}}
\DoxyCodeLine{05916\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05917\ }
\DoxyCodeLine{05918\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{05919\ \ \ \ \ \{}
\DoxyCodeLine{05920\ \ \ \ \ \ \ LColor\ scaled\ =\ clear\_value.fmin(LColor(1)).fmax(LColor::zero());}
\DoxyCodeLine{05921\ \ \ \ \ \ \ scaled\ *=\ 65535;}
\DoxyCodeLine{05922\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05923\ \ \ \ \ \ \ \ \ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)into)[i]\ =\ (\textcolor{keywordtype}{unsigned}\ short)scaled[i];}
\DoxyCodeLine{05924\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05925\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05926\ \ \ \ \ \}}
\DoxyCodeLine{05927\ }
\DoxyCodeLine{05928\ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{05929\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05930\ \ \ \ \ \ \ ((\textcolor{keywordtype}{float}\ *)into)[i]\ =\ clear\_value[i];}
\DoxyCodeLine{05931\ \ \ \ \ \}}
\DoxyCodeLine{05932\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05933\ }
\DoxyCodeLine{05934\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int\_24\_8:}
\DoxyCodeLine{05935\ \ \ \ \ nassertr(num\_components\ ==\ 1,\ 0);}
\DoxyCodeLine{05936\ \ \ \ \ *((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *)into)\ =}
\DoxyCodeLine{05937\ \ \ \ \ \ \ ((\textcolor{keywordtype}{unsigned}\ int)(clear\_value[0]\ *\ 16777215)\ <<\ 8)\ +}
\DoxyCodeLine{05938\ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})max(min(clear\_value[1],\ (PN\_stdfloat)255),\ (PN\_stdfloat)0);}
\DoxyCodeLine{05939\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05940\ }
\DoxyCodeLine{05941\ \ \ \textcolor{keywordflow}{case}\ T\_int:}
\DoxyCodeLine{05942\ \ \ \ \ \textcolor{comment}{//\ Note:\ there\ are\ no\ 32-\/bit\ UNORM\ textures.\ \ Therefore,\ we\ don't\ do\ any}}
\DoxyCodeLine{05943\ \ \ \ \ \textcolor{comment}{//\ normalization\ here,\ either.}}
\DoxyCodeLine{05944\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05945\ \ \ \ \ \ \ ((\textcolor{keywordtype}{int}\ *)into)[i]\ =\ (int)clear\_value[i];}
\DoxyCodeLine{05946\ \ \ \ \ \}}
\DoxyCodeLine{05947\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05948\ }
\DoxyCodeLine{05949\ \ \ \textcolor{keywordflow}{case}\ T\_byte:}
\DoxyCodeLine{05950\ \ \ \ \ \{}
\DoxyCodeLine{05951\ \ \ \ \ \ \ LColor\ scaled\ =\ clear\_value.fmin(LColor(1)).fmax(LColor(-\/1));}
\DoxyCodeLine{05952\ \ \ \ \ \ \ scaled\ *=\ 127;}
\DoxyCodeLine{05953\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05954\ \ \ \ \ \ \ \ \ ((\textcolor{keywordtype}{signed}\ \textcolor{keywordtype}{char}\ *)into)[i]\ =\ (\textcolor{keywordtype}{signed}\ char)scaled[i];}
\DoxyCodeLine{05955\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05956\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05957\ \ \ \ \ \}}
\DoxyCodeLine{05958\ }
\DoxyCodeLine{05959\ \ \ \textcolor{keywordflow}{case}\ T\_short:}
\DoxyCodeLine{05960\ \ \ \ \ \{}
\DoxyCodeLine{05961\ \ \ \ \ \ \ LColor\ scaled\ =\ clear\_value.fmin(LColor(1)).fmax(LColor(-\/1));}
\DoxyCodeLine{05962\ \ \ \ \ \ \ scaled\ *=\ 32767;}
\DoxyCodeLine{05963\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05964\ \ \ \ \ \ \ \ \ ((\textcolor{keywordtype}{short}\ *)into)[i]\ =\ (short)scaled[i];}
\DoxyCodeLine{05965\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05966\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05967\ \ \ \ \ \}}
\DoxyCodeLine{05968\ }
\DoxyCodeLine{05969\ \ \ \textcolor{keywordflow}{case}\ T\_half\_float:}
\DoxyCodeLine{05970\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05971\ \ \ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{05972\ \ \ \ \ \ \ \ \ uint32\_t\ ui;}
\DoxyCodeLine{05973\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ uf;}
\DoxyCodeLine{05974\ \ \ \ \ \ \ \}\ v;}
\DoxyCodeLine{05975\ \ \ \ \ \ \ v.uf\ =\ clear\_value[i];}
\DoxyCodeLine{05976\ \ \ \ \ \ \ uint16\_t\ sign\ =\ ((v.ui\ \&\ 0x80000000u)\ >>\ 16u);}
\DoxyCodeLine{05977\ \ \ \ \ \ \ uint32\_t\ mantissa\ =\ (v.ui\ \&\ 0x007fffffu);}
\DoxyCodeLine{05978\ \ \ \ \ \ \ uint16\_t\ exponent\ =\ (uint16\_t)std::min(std::max((\textcolor{keywordtype}{int})((v.ui\ \&\ 0x7f800000u)\ >>\ 23u)\ -\/\ 112,\ 0),\ 31);}
\DoxyCodeLine{05979\ \ \ \ \ \ \ mantissa\ +=\ (mantissa\ \&\ 0x00001000u)\ <<\ 1u;}
\DoxyCodeLine{05980\ \ \ \ \ \ \ ((uint16\_t\ *)into)[i]\ =\ (uint16\_t)(sign\ |\ ((exponent\ <<\ 10u)\ |\ (mantissa\ >>\ 13u)));}
\DoxyCodeLine{05981\ \ \ \ \ \}}
\DoxyCodeLine{05982\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{05983\ }
\DoxyCodeLine{05984\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int:}
\DoxyCodeLine{05985\ \ \ \ \ \textcolor{comment}{//\ Note:\ there\ are\ no\ 32-\/bit\ UNORM\ textures.\ \ Therefore,\ we\ don't\ do\ any}}
\DoxyCodeLine{05986\ \ \ \ \ \textcolor{comment}{//\ normalization\ here,\ either.}}
\DoxyCodeLine{05987\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_components;\ ++i)\ \{}
\DoxyCodeLine{05988\ \ \ \ \ \ \ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ *)into)[i]\ =\ (\textcolor{keywordtype}{unsigned}\ int)clear\_value[i];}
\DoxyCodeLine{05989\ \ \ \ \ \}}
\DoxyCodeLine{05990\ \ \ \}}
\DoxyCodeLine{05991\ }
\DoxyCodeLine{05992\ \ \ \textcolor{keywordflow}{return}\ num\_components\ *\ cdata-\/>\_component\_width;}
\DoxyCodeLine{05993\ \}}
\DoxyCodeLine{05994\ }
\DoxyCodeLine{06002\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a998478f0a9e72cb493d1d4f83e2f3867}{Texture::}}}
\DoxyCodeLine{06003\ \mbox{\hyperlink{classTexture_a998478f0a9e72cb493d1d4f83e2f3867}{consider\_auto\_process\_ram\_image}}(\textcolor{keywordtype}{bool}\ generate\_mipmaps,\ \textcolor{keywordtype}{bool}\ allow\_compression)\ \{}
\DoxyCodeLine{06004\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06005\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a02144ecaee7fca731249f1513b632eff}{do\_consider\_auto\_process\_ram\_image}}(cdata,\ generate\_mipmaps,\ allow\_compression);}
\DoxyCodeLine{06006\ \}}
\DoxyCodeLine{06007\ }
\DoxyCodeLine{06015\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a02144ecaee7fca731249f1513b632eff}{Texture::}}}
\DoxyCodeLine{06016\ \mbox{\hyperlink{classTexture_a02144ecaee7fca731249f1513b632eff}{do\_consider\_auto\_process\_ram\_image}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{bool}\ generate\_mipmaps,}
\DoxyCodeLine{06017\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ allow\_compression)\ \{}
\DoxyCodeLine{06018\ \ \ \textcolor{keywordtype}{bool}\ modified\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{06019\ }
\DoxyCodeLine{06020\ \ \ \textcolor{keywordflow}{if}\ (generate\_mipmaps\ \&\&\ !driver\_generate\_mipmaps\ \&\&}
\DoxyCodeLine{06021\ \ \ \ \ \ \ cdata-\/>\_ram\_images.size()\ ==\ 1)\ \{}
\DoxyCodeLine{06022\ \ \ \ \ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{do\_generate\_ram\_mipmap\_images}}(cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06023\ \ \ \ \ modified\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06024\ \ \ \}}
\DoxyCodeLine{06025\ }
\DoxyCodeLine{06026\ \ \ \textcolor{keywordflow}{if}\ (allow\_compression\ \&\&\ !driver\_compress\_textures)\ \{}
\DoxyCodeLine{06027\ \ \ \ \ CompressionMode\ compression\ =\ cdata-\/>\_compression;}
\DoxyCodeLine{06028\ \ \ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ CM\_default\ \&\&\ compressed\_textures)\ \{}
\DoxyCodeLine{06029\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{06030\ \ \ \ \ \ \ \ \ compression\ =\ CM\_off;}
\DoxyCodeLine{06031\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06032\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06033\ \ \ \ \ \ \ \ \ compression\ =\ CM\_on;}
\DoxyCodeLine{06034\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06035\ \ \ \ \ \}}
\DoxyCodeLine{06036\ \ \ \ \ \textcolor{keywordflow}{if}\ (compression\ !=\ CM\_off\ \&\&\ cdata-\/>\_ram\_image\_compression\ ==\ CM\_off)\ \{}
\DoxyCodeLine{06037\ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg\ =\ GraphicsStateGuardianBase::get\_default\_gsg();}
\DoxyCodeLine{06038\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_compress\_ram\_image(cdata,\ compression,\ QL\_default,\ gsg))\ \{}
\DoxyCodeLine{06039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{06040\ \ \ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{06041\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Compressed\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ with\ "{}}}
\DoxyCodeLine{06042\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_ram\_image\_compression\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06044\ \ \ \ \ \ \ \ \ modified\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06045\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06046\ \ \ \ \ \}}
\DoxyCodeLine{06047\ \ \ \}}
\DoxyCodeLine{06048\ }
\DoxyCodeLine{06049\ \ \ \textcolor{keywordflow}{return}\ modified;}
\DoxyCodeLine{06050\ \}}
\DoxyCodeLine{06051\ }
\DoxyCodeLine{06055\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{06056\ do\_compress\_ram\_image(CData\ *cdata,\ Texture::CompressionMode\ compression,}
\DoxyCodeLine{06057\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Texture::QualityLevel\ quality\_level,}
\DoxyCodeLine{06058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg)\ \{}
\DoxyCodeLine{06059\ \ \ nassertr(compression\ !=\ CM\_off,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06060\ }
\DoxyCodeLine{06061\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ ||\ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{06062\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06063\ \ \ \}}
\DoxyCodeLine{06064\ }
\DoxyCodeLine{06065\ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ CM\_on)\ \{}
\DoxyCodeLine{06066\ \ \ \ \ \textcolor{comment}{//\ Select\ an\ appropriate\ compression\ mode\ automatically.}}
\DoxyCodeLine{06067\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_format)\ \{}
\DoxyCodeLine{06068\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{06069\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{06070\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{06071\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{06072\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{06073\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{06074\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{06075\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{06076\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{06077\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{06078\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gsg\ ==\ \textcolor{keyword}{nullptr}\ ||\ gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt1))\ \{}
\DoxyCodeLine{06079\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt1;}
\DoxyCodeLine{06080\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt3))\ \{}
\DoxyCodeLine{06081\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{06082\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt5))\ \{}
\DoxyCodeLine{06083\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{06084\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_etc2))\ \{}
\DoxyCodeLine{06085\ \ \ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{06086\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_etc1))\ \{}
\DoxyCodeLine{06087\ \ \ \ \ \ \ \ \ compression\ =\ CM\_etc1;}
\DoxyCodeLine{06088\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06089\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06090\ }
\DoxyCodeLine{06091\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{06092\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gsg\ ==\ \textcolor{keyword}{nullptr}\ ||\ gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt3))\ \{}
\DoxyCodeLine{06093\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt3;}
\DoxyCodeLine{06094\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt5))\ \{}
\DoxyCodeLine{06095\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{06096\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_etc2))\ \{}
\DoxyCodeLine{06097\ \ \ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{06098\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06099\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06100\ }
\DoxyCodeLine{06101\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{06102\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{06103\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{06104\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{06105\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{06106\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gsg\ ==\ \textcolor{keyword}{nullptr}\ ||\ gsg-\/>get\_supports\_compressed\_texture\_format(CM\_dxt5))\ \{}
\DoxyCodeLine{06107\ \ \ \ \ \ \ \ \ compression\ =\ CM\_dxt5;}
\DoxyCodeLine{06108\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_etc2))\ \{}
\DoxyCodeLine{06109\ \ \ \ \ \ \ \ \ compression\ =\ CM\_etc2;}
\DoxyCodeLine{06110\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06111\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06112\ }
\DoxyCodeLine{06113\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{06114\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{06115\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gsg\ ==\ \textcolor{keyword}{nullptr}\ ||\ gsg-\/>get\_supports\_compressed\_texture\_format(CM\_rgtc))\ \{}
\DoxyCodeLine{06116\ \ \ \ \ \ \ \ \ compression\ =\ CM\_rgtc;}
\DoxyCodeLine{06117\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gsg-\/>get\_supports\_compressed\_texture\_format(CM\_eac))\ \{}
\DoxyCodeLine{06118\ \ \ \ \ \ \ \ \ compression\ =\ CM\_eac;}
\DoxyCodeLine{06119\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06120\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06121\ }
\DoxyCodeLine{06122\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06123\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06124\ \ \ \ \ \}}
\DoxyCodeLine{06125\ \ \ \}}
\DoxyCodeLine{06126\ }
\DoxyCodeLine{06127\ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ CM\_rgtc)\ \{}
\DoxyCodeLine{06128\ \ \ \ \ \textcolor{comment}{//\ We\ should\ compress\ RGTC\ ourselves,\ as\ squish\ does\ not\ support\ it.}}
\DoxyCodeLine{06129\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_type\ !=\ T\_unsigned\_byte)\ \{}
\DoxyCodeLine{06130\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06131\ \ \ \ \ \}}
\DoxyCodeLine{06132\ }
\DoxyCodeLine{06133\ \ \ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_all\_ram\_mipmap\_images(cdata))\ \{}
\DoxyCodeLine{06134\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ about\ to\ compress\ the\ RAM\ image,\ we\ should\ ensure\ that\ we}}
\DoxyCodeLine{06135\ \ \ \ \ \ \ \textcolor{comment}{//\ have\ all\ of\ the\ mipmap\ levels\ first.}}
\DoxyCodeLine{06136\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{do\_generate\_ram\_mipmap\_images}}(cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06137\ \ \ \ \ \}}
\DoxyCodeLine{06138\ }
\DoxyCodeLine{06139\ \ \ \ \ RamImages\ compressed\_ram\_images;}
\DoxyCodeLine{06140\ \ \ \ \ compressed\_ram\_images.resize(cdata-\/>\_ram\_images.size());}
\DoxyCodeLine{06141\ }
\DoxyCodeLine{06142\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{06143\ \ \ \ \ \ \ \textcolor{keyword}{const}\ RamImage\ *uncompressed\_image\ =\ \&cdata-\/>\_ram\_images[n];}
\DoxyCodeLine{06144\ }
\DoxyCodeLine{06145\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{06146\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{06147\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n);}
\DoxyCodeLine{06148\ }
\DoxyCodeLine{06149\ \ \ \ \ \ \ \textcolor{comment}{//\ It\ is\ important\ that\ we\ handle\ image\ sizes\ that\ aren't\ a\ multiple\ of}}
\DoxyCodeLine{06150\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ block\ size,\ since\ this\ method\ may\ be\ used\ to\ compress\ mipmaps,}}
\DoxyCodeLine{06151\ \ \ \ \ \ \ \textcolor{comment}{//\ which\ go\ all\ the\ way\ to\ 1x1.\ \ Pad\ the\ image\ if\ necessary.}}
\DoxyCodeLine{06152\ \ \ \ \ \ \ RamImage\ temp\_image;}
\DoxyCodeLine{06153\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((x\_size\ |\ y\_size)\ \&\ 0x3)\ \{}
\DoxyCodeLine{06154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ virtual\_x\_size\ =\ x\_size;}
\DoxyCodeLine{06155\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ virtual\_y\_size\ =\ y\_size;}
\DoxyCodeLine{06156\ \ \ \ \ \ \ \ \ x\_size\ =\ (x\_size\ +\ 3)\ \&\ \string~0x3;}
\DoxyCodeLine{06157\ \ \ \ \ \ \ \ \ y\_size\ =\ (y\_size\ +\ 3)\ \&\ \string~0x3;}
\DoxyCodeLine{06158\ }
\DoxyCodeLine{06159\ \ \ \ \ \ \ \ \ temp\_image.\_page\_size\ =\ x\_size\ *\ y\_size\ *\ cdata-\/>\_num\_components;}
\DoxyCodeLine{06160\ \ \ \ \ \ \ \ \ temp\_image.\_image\ =\ PTA\_uchar::empty\_array(temp\_image.\_page\_size\ *\ num\_pages);}
\DoxyCodeLine{06161\ }
\DoxyCodeLine{06162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{06163\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\ =\ temp\_image.\_image.p()\ +\ z\ *\ temp\_image.\_page\_size;}
\DoxyCodeLine{06164\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src\ =\ uncompressed\_image-\/>\_image.p()\ +\ z\ *\ uncompressed\_image-\/>\_page\_size;}
\DoxyCodeLine{06165\ }
\DoxyCodeLine{06166\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ virtual\_y\_size;\ ++y)\ \{}
\DoxyCodeLine{06167\ \ \ \ \ \ \ \ \ \ \ \ \ memcpy(dest,\ src,\ virtual\_x\_size);}
\DoxyCodeLine{06168\ \ \ \ \ \ \ \ \ \ \ \ \ src\ +=\ virtual\_x\_size;}
\DoxyCodeLine{06169\ \ \ \ \ \ \ \ \ \ \ \ \ dest\ +=\ x\_size;}
\DoxyCodeLine{06170\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06171\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06172\ }
\DoxyCodeLine{06173\ \ \ \ \ \ \ \ \ uncompressed\_image\ =\ \&temp\_image;}
\DoxyCodeLine{06174\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06175\ }
\DoxyCodeLine{06176\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ new\ image\ to\ hold\ the\ compressed\ texture\ pages.}}
\DoxyCodeLine{06177\ \ \ \ \ \ \ RamImage\ \&compressed\_image\ =\ compressed\_ram\_images[n];}
\DoxyCodeLine{06178\ \ \ \ \ \ \ compressed\_image.\_page\_size\ =\ (x\_size\ *\ y\_size\ *\ cdata-\/>\_num\_components)\ >>\ 1;}
\DoxyCodeLine{06179\ \ \ \ \ \ \ compressed\_image.\_image\ =\ PTA\_uchar::empty\_array(compressed\_image.\_page\_size\ *\ num\_pages);}
\DoxyCodeLine{06180\ }
\DoxyCodeLine{06181\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ ==\ 1)\ \{}
\DoxyCodeLine{06182\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a1ad4a6983c8ef2b89be620f5f61d6df1}{do\_compress\_ram\_image\_bc4}}(*uncompressed\_image,\ compressed\_image,}
\DoxyCodeLine{06183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size,\ num\_pages);}
\DoxyCodeLine{06184\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ ==\ 2)\ \{}
\DoxyCodeLine{06185\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a9b03b927ff8006935ee9ce8faf0b89de}{do\_compress\_ram\_image\_bc5}}(*uncompressed\_image,\ compressed\_image,}
\DoxyCodeLine{06186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size,\ num\_pages);}
\DoxyCodeLine{06187\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06188\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invalid.}}
\DoxyCodeLine{06189\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06190\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06191\ \ \ \ \ \}}
\DoxyCodeLine{06192\ }
\DoxyCodeLine{06193\ \ \ \ \ cdata-\/>\_ram\_images.swap(compressed\_ram\_images);}
\DoxyCodeLine{06194\ \ \ \ \ cdata-\/>\_ram\_image\_compression\ =\ CM\_rgtc;}
\DoxyCodeLine{06195\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06196\ \ \ \}}
\DoxyCodeLine{06197\ }
\DoxyCodeLine{06198\ \textcolor{preprocessor}{\#ifdef\ HAVE\_SQUISH}}
\DoxyCodeLine{06199\ \ \ \textcolor{comment}{//\ Choose\ an\ appropriate\ quality\ level.}}
\DoxyCodeLine{06200\ \ \ \textcolor{keywordflow}{if}\ (quality\_level\ ==\ Texture::QL\_default)\ \{}
\DoxyCodeLine{06201\ \ \ \ \ quality\_level\ =\ cdata-\/>\_quality\_level;}
\DoxyCodeLine{06202\ \ \ \}}
\DoxyCodeLine{06203\ \ \ \textcolor{keywordflow}{if}\ (quality\_level\ ==\ Texture::QL\_default)\ \{}
\DoxyCodeLine{06204\ \ \ \ \ quality\_level\ =\ texture\_quality\_level;}
\DoxyCodeLine{06205\ \ \ \}}
\DoxyCodeLine{06206\ }
\DoxyCodeLine{06207\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ !=\ TT\_3d\_texture\ \&\&}
\DoxyCodeLine{06208\ \ \ \ \ \ \ cdata-\/>\_texture\_type\ !=\ TT\_2d\_texture\_array\ \&\&}
\DoxyCodeLine{06209\ \ \ \ \ \ \ cdata-\/>\_component\_type\ ==\ T\_unsigned\_byte)\ \{}
\DoxyCodeLine{06210\ \ \ \ \ \textcolor{keywordtype}{int}\ squish\_flags\ =\ 0;}
\DoxyCodeLine{06211\ \ \ \ \ \textcolor{keywordflow}{switch}\ (compression)\ \{}
\DoxyCodeLine{06212\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt1:}
\DoxyCodeLine{06213\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt1;}
\DoxyCodeLine{06214\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06215\ }
\DoxyCodeLine{06216\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt3:}
\DoxyCodeLine{06217\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt3;}
\DoxyCodeLine{06218\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06219\ }
\DoxyCodeLine{06220\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt5:}
\DoxyCodeLine{06221\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt5;}
\DoxyCodeLine{06222\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06223\ }
\DoxyCodeLine{06224\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06225\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06226\ \ \ \ \ \}}
\DoxyCodeLine{06227\ }
\DoxyCodeLine{06228\ \ \ \ \ \textcolor{keywordflow}{if}\ (squish\_flags\ !=\ 0)\ \{}
\DoxyCodeLine{06229\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ compression\ mode\ is\ supported\ by\ squish;\ use\ it.}}
\DoxyCodeLine{06230\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (quality\_level)\ \{}
\DoxyCodeLine{06231\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ QL\_fastest:}
\DoxyCodeLine{06232\ \ \ \ \ \ \ \ \ squish\_flags\ |=\ squish::kColourRangeFit;}
\DoxyCodeLine{06233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06234\ }
\DoxyCodeLine{06235\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ QL\_normal:}
\DoxyCodeLine{06236\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ ColourClusterFit\ is\ just\ too\ slow\ for\ everyday\ use.}}
\DoxyCodeLine{06237\ \ \ \ \ \ \ \ \ squish\_flags\ |=\ squish::kColourRangeFit;}
\DoxyCodeLine{06238\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ squish\_flags\ |=\ squish::kColourClusterFit;}}
\DoxyCodeLine{06239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06240\ }
\DoxyCodeLine{06241\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ QL\_best:}
\DoxyCodeLine{06242\ \ \ \ \ \ \ \ \ squish\_flags\ |=\ squish::kColourIterativeClusterFit;}
\DoxyCodeLine{06243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06244\ }
\DoxyCodeLine{06245\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06247\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06248\ }
\DoxyCodeLine{06249\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_squish(cdata,\ compression,\ squish\_flags))\ \{}
\DoxyCodeLine{06250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06251\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06252\ \ \ \ \ \}}
\DoxyCodeLine{06253\ \ \ \}}
\DoxyCodeLine{06254\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{06255\ }
\DoxyCodeLine{06256\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06257\ \}}
\DoxyCodeLine{06258\ }
\DoxyCodeLine{06262\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{06263\ do\_uncompress\_ram\_image(CData\ *cdata)\ \{}
\DoxyCodeLine{06264\ \ \ nassertr(!cdata-\/>\_ram\_images.empty(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{06265\ }
\DoxyCodeLine{06266\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_image\_compression\ ==\ CM\_rgtc)\ \{}
\DoxyCodeLine{06267\ \ \ \ \ \textcolor{comment}{//\ We\ should\ decompress\ RGTC\ ourselves,\ as\ squish\ doesn't\ support\ it.}}
\DoxyCodeLine{06268\ \ \ \ \ RamImages\ uncompressed\_ram\_images;}
\DoxyCodeLine{06269\ \ \ \ \ uncompressed\_ram\_images.resize(cdata-\/>\_ram\_images.size());}
\DoxyCodeLine{06270\ }
\DoxyCodeLine{06271\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{06272\ \ \ \ \ \ \ \textcolor{keyword}{const}\ RamImage\ \&compressed\_image\ =\ cdata-\/>\_ram\_images[n];}
\DoxyCodeLine{06273\ }
\DoxyCodeLine{06274\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{06275\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{06276\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n);}
\DoxyCodeLine{06277\ }
\DoxyCodeLine{06278\ \ \ \ \ \ \ RamImage\ \&uncompressed\_image\ =\ uncompressed\_ram\_images[n];}
\DoxyCodeLine{06279\ \ \ \ \ \ \ uncompressed\_image.\_page\_size\ =\ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{06280\ \ \ \ \ \ \ uncompressed\_image.\_image\ =\ PTA\_uchar::empty\_array(uncompressed\_image.\_page\_size\ *\ num\_pages);}
\DoxyCodeLine{06281\ }
\DoxyCodeLine{06282\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ ==\ 1)\ \{}
\DoxyCodeLine{06283\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_ad2e69f0cc78d2077d3f3fc7eaf670be2}{do\_uncompress\_ram\_image\_bc4}}(compressed\_image,\ uncompressed\_image,}
\DoxyCodeLine{06284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size,\ num\_pages);}
\DoxyCodeLine{06285\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_components\ ==\ 2)\ \{}
\DoxyCodeLine{06286\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_a670584408b060f0f22ee4ae4869f8c7b}{do\_uncompress\_ram\_image\_bc5}}(compressed\_image,\ uncompressed\_image,}
\DoxyCodeLine{06287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size,\ num\_pages);}
\DoxyCodeLine{06288\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06289\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Invalid.}}
\DoxyCodeLine{06290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06291\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06292\ \ \ \ \ \}}
\DoxyCodeLine{06293\ \ \ \ \ cdata-\/>\_ram\_images.swap(uncompressed\_ram\_images);}
\DoxyCodeLine{06294\ \ \ \ \ cdata-\/>\_ram\_image\_compression\ =\ CM\_off;}
\DoxyCodeLine{06295\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06296\ \ \ \}}
\DoxyCodeLine{06297\ }
\DoxyCodeLine{06298\ \textcolor{preprocessor}{\#ifdef\ HAVE\_SQUISH}}
\DoxyCodeLine{06299\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ !=\ TT\_3d\_texture\ \&\&}
\DoxyCodeLine{06300\ \ \ \ \ \ \ cdata-\/>\_texture\_type\ !=\ TT\_2d\_texture\_array\ \&\&}
\DoxyCodeLine{06301\ \ \ \ \ \ \ cdata-\/>\_component\_type\ ==\ T\_unsigned\_byte)\ \{}
\DoxyCodeLine{06302\ \ \ \ \ \textcolor{keywordtype}{int}\ squish\_flags\ =\ 0;}
\DoxyCodeLine{06303\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_ram\_image\_compression)\ \{}
\DoxyCodeLine{06304\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt1:}
\DoxyCodeLine{06305\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt1;}
\DoxyCodeLine{06306\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06307\ }
\DoxyCodeLine{06308\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt3:}
\DoxyCodeLine{06309\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt3;}
\DoxyCodeLine{06310\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06311\ }
\DoxyCodeLine{06312\ \ \ \ \ \textcolor{keywordflow}{case}\ CM\_dxt5:}
\DoxyCodeLine{06313\ \ \ \ \ \ \ squish\_flags\ |=\ squish::kDxt5;}
\DoxyCodeLine{06314\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06315\ }
\DoxyCodeLine{06316\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06317\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06318\ \ \ \ \ \}}
\DoxyCodeLine{06319\ }
\DoxyCodeLine{06320\ \ \ \ \ \textcolor{keywordflow}{if}\ (squish\_flags\ !=\ 0)\ \{}
\DoxyCodeLine{06321\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ compression\ mode\ is\ supported\ by\ squish;\ use\ it.}}
\DoxyCodeLine{06322\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_unsquish(cdata,\ squish\_flags))\ \{}
\DoxyCodeLine{06323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06324\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06325\ \ \ \ \ \}}
\DoxyCodeLine{06326\ \ \ \}}
\DoxyCodeLine{06327\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{06328\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06329\ \}}
\DoxyCodeLine{06330\ }
\DoxyCodeLine{06334\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a1ad4a6983c8ef2b89be620f5f61d6df1}{Texture::}}}
\DoxyCodeLine{06335\ \mbox{\hyperlink{classTexture_a1ad4a6983c8ef2b89be620f5f61d6df1}{do\_compress\_ram\_image\_bc4}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&uncompressed\_image,}
\DoxyCodeLine{06336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&compressed\_image,}
\DoxyCodeLine{06337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_pages)\ \{}
\DoxyCodeLine{06338\ \ \ \textcolor{keywordtype}{int}\ x\_blocks\ =\ (x\_size\ >>\ 2);}
\DoxyCodeLine{06339\ \ \ \textcolor{keywordtype}{int}\ y\_blocks\ =\ (y\_size\ >>\ 2);}
\DoxyCodeLine{06340\ }
\DoxyCodeLine{06341\ \ \ \textcolor{comment}{//\ NB.\ This\ algorithm\ isn't\ fully\ optimal,\ since\ it\ doesn't\ try\ to\ make\ use}}
\DoxyCodeLine{06342\ \ \ \textcolor{comment}{//\ of\ the\ secondary\ interpolation\ mode\ supported\ by\ BC4.\ \ This\ is\ not}}
\DoxyCodeLine{06343\ \ \ \textcolor{comment}{//\ important\ for\ most\ textures,\ but\ it\ may\ be\ added\ in\ the\ future.}}
\DoxyCodeLine{06344\ }
\DoxyCodeLine{06345\ \ \ nassertv((\textcolor{keywordtype}{size\_t})x\_blocks\ *\ (\textcolor{keywordtype}{size\_t})y\_blocks\ *\ 4\ *\ 4\ <=\ uncompressed\_image.\_page\_size);}
\DoxyCodeLine{06346\ \ \ nassertv((\textcolor{keywordtype}{size\_t})x\_size\ *\ (\textcolor{keywordtype}{size\_t})y\_size\ ==\ uncompressed\_image.\_page\_size);}
\DoxyCodeLine{06347\ }
\DoxyCodeLine{06348\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ remap[]\ =\ \{1,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 0\};}
\DoxyCodeLine{06349\ }
\DoxyCodeLine{06350\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{06351\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\ =\ compressed\_image.\_image.p()\ +\ z\ *\ compressed\_image.\_page\_size;}
\DoxyCodeLine{06352\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src\ =\ uncompressed\_image.\_image.p()\ +\ z\ *\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{06353\ }
\DoxyCodeLine{06354\ \ \ \ \ \textcolor{comment}{//\ Convert\ one\ 4\ x\ 4\ block\ at\ a\ time.}}
\DoxyCodeLine{06355\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_blocks;\ ++y)\ \{}
\DoxyCodeLine{06356\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_blocks;\ ++x)\ \{}
\DoxyCodeLine{06357\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a,\ b,\ c,\ d;}
\DoxyCodeLine{06358\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ fac,\ add;}
\DoxyCodeLine{06359\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ minv,\ maxv;}
\DoxyCodeLine{06360\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *blk\ =\ src;}
\DoxyCodeLine{06361\ }
\DoxyCodeLine{06362\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ the\ minimum\ and\ maximum\ value\ in\ the\ block.}}
\DoxyCodeLine{06363\ \ \ \ \ \ \ \ \ minv\ =\ blk[0];}
\DoxyCodeLine{06364\ \ \ \ \ \ \ \ \ maxv\ =\ blk[0];}
\DoxyCodeLine{06365\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[1],\ minv);\ maxv\ =\ max(blk[1],\ maxv);}
\DoxyCodeLine{06366\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06367\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[3],\ minv);\ maxv\ =\ max(blk[3],\ maxv);}
\DoxyCodeLine{06368\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06369\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06370\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[1],\ minv);\ maxv\ =\ max(blk[1],\ maxv);}
\DoxyCodeLine{06371\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06372\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[3],\ minv);\ maxv\ =\ max(blk[3],\ maxv);}
\DoxyCodeLine{06373\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06374\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06375\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[1],\ minv);\ maxv\ =\ max(blk[1],\ maxv);}
\DoxyCodeLine{06376\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06377\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[3],\ minv);\ maxv\ =\ max(blk[3],\ maxv);}
\DoxyCodeLine{06378\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06379\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06380\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[1],\ minv);\ maxv\ =\ max(blk[1],\ maxv);}
\DoxyCodeLine{06381\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06382\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[3],\ minv);\ maxv\ =\ max(blk[3],\ maxv);}
\DoxyCodeLine{06383\ }
\DoxyCodeLine{06384\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ calculate\ the\ index\ for\ each\ pixel.}}
\DoxyCodeLine{06385\ \ \ \ \ \ \ \ \ blk\ =\ src;}
\DoxyCodeLine{06386\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (maxv\ >\ minv)\ \{}
\DoxyCodeLine{06387\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 7.5f\ /\ (maxv\ -\/\ minv);}
\DoxyCodeLine{06388\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06389\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 0;}
\DoxyCodeLine{06390\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06391\ \ \ \ \ \ \ \ \ add\ =\ -\/minv\ *\ fac;}
\DoxyCodeLine{06392\ \ \ \ \ \ \ \ \ a\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06393\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[1]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06394\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[2]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06395\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[3]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06396\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06397\ \ \ \ \ \ \ \ \ b\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06398\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[1]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06399\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[2]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06400\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[3]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06401\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06402\ \ \ \ \ \ \ \ \ c\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06403\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[1]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06404\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[2]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06405\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[3]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06406\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06407\ \ \ \ \ \ \ \ \ d\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06408\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[1]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06409\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[2]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06410\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[3]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06411\ }
\DoxyCodeLine{06412\ \ \ \ \ \ \ \ \ *(dest++)\ =\ maxv;}
\DoxyCodeLine{06413\ \ \ \ \ \ \ \ \ *(dest++)\ =\ minv;}
\DoxyCodeLine{06414\ \ \ \ \ \ \ \ \ *(dest++)\ =\ a\ \&\ 0xff;}
\DoxyCodeLine{06415\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (a\ >>\ 8)\ |\ (b\ \&\ 0xf0);}
\DoxyCodeLine{06416\ \ \ \ \ \ \ \ \ *(dest++)\ =\ b\ >>\ 8;}
\DoxyCodeLine{06417\ \ \ \ \ \ \ \ \ *(dest++)\ =\ c\ \&\ 0xff;}
\DoxyCodeLine{06418\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (c\ >>\ 8)\ |\ (d\ \&\ 0xf0);}
\DoxyCodeLine{06419\ \ \ \ \ \ \ \ \ *(dest++)\ =\ d\ >>\ 8;}
\DoxyCodeLine{06420\ }
\DoxyCodeLine{06421\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Advance\ to\ the\ beginning\ of\ the\ next\ 4x4\ block.}}
\DoxyCodeLine{06422\ \ \ \ \ \ \ \ \ src\ +=\ 4;}
\DoxyCodeLine{06423\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06424\ \ \ \ \ \ \ src\ +=\ x\_size\ *\ 3;}
\DoxyCodeLine{06425\ \ \ \ \ \}}
\DoxyCodeLine{06426\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{06427\ \ \ \}}
\DoxyCodeLine{06428\ \}}
\DoxyCodeLine{06429\ }
\DoxyCodeLine{06433\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a9b03b927ff8006935ee9ce8faf0b89de}{Texture::}}}
\DoxyCodeLine{06434\ \mbox{\hyperlink{classTexture_a9b03b927ff8006935ee9ce8faf0b89de}{do\_compress\_ram\_image\_bc5}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&uncompressed\_image,}
\DoxyCodeLine{06435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&compressed\_image,}
\DoxyCodeLine{06436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_pages)\ \{}
\DoxyCodeLine{06437\ \ \ \textcolor{keywordtype}{int}\ x\_blocks\ =\ (x\_size\ >>\ 2);}
\DoxyCodeLine{06438\ \ \ \textcolor{keywordtype}{int}\ y\_blocks\ =\ (y\_size\ >>\ 2);}
\DoxyCodeLine{06439\ \ \ \textcolor{keywordtype}{int}\ stride\ =\ x\_size\ *\ 2;}
\DoxyCodeLine{06440\ }
\DoxyCodeLine{06441\ \ \ \textcolor{comment}{//\ BC5\ uses\ the\ same\ compression\ algorithm\ as\ BC4,\ except\ repeated\ for\ two}}
\DoxyCodeLine{06442\ \ \ \textcolor{comment}{//\ channels.}}
\DoxyCodeLine{06443\ }
\DoxyCodeLine{06444\ \ \ nassertv((\textcolor{keywordtype}{size\_t})x\_blocks\ *\ (\textcolor{keywordtype}{size\_t})y\_blocks\ *\ 4\ *\ 4\ *\ 2\ <=\ uncompressed\_image.\_page\_size);}
\DoxyCodeLine{06445\ \ \ nassertv((\textcolor{keywordtype}{size\_t})stride\ *\ (\textcolor{keywordtype}{size\_t})y\_size\ ==\ uncompressed\_image.\_page\_size);}
\DoxyCodeLine{06446\ }
\DoxyCodeLine{06447\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ remap[]\ =\ \{1,\ 7,\ 6,\ 5,\ 4,\ 3,\ 2,\ 0\};}
\DoxyCodeLine{06448\ }
\DoxyCodeLine{06449\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{06450\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\ =\ compressed\_image.\_image.p()\ +\ z\ *\ compressed\_image.\_page\_size;}
\DoxyCodeLine{06451\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src\ =\ uncompressed\_image.\_image.p()\ +\ z\ *\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{06452\ }
\DoxyCodeLine{06453\ \ \ \ \ \textcolor{comment}{//\ Convert\ one\ 4\ x\ 4\ block\ at\ a\ time.}}
\DoxyCodeLine{06454\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_blocks;\ ++y)\ \{}
\DoxyCodeLine{06455\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_blocks;\ ++x)\ \{}
\DoxyCodeLine{06456\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ a,\ b,\ c,\ d;}
\DoxyCodeLine{06457\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ fac,\ add;}
\DoxyCodeLine{06458\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ minv,\ maxv;}
\DoxyCodeLine{06459\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *blk\ =\ src;}
\DoxyCodeLine{06460\ }
\DoxyCodeLine{06461\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ the\ minimum\ and\ maximum\ red\ value\ in\ the\ block.}}
\DoxyCodeLine{06462\ \ \ \ \ \ \ \ \ minv\ =\ blk[0];}
\DoxyCodeLine{06463\ \ \ \ \ \ \ \ \ maxv\ =\ blk[0];}
\DoxyCodeLine{06464\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06465\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06466\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06467\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06468\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06469\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06470\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06471\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06472\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06473\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06474\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06475\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06476\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06477\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06478\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06479\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06480\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06481\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06482\ }
\DoxyCodeLine{06483\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ calculate\ the\ index\ for\ each\ pixel.}}
\DoxyCodeLine{06484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (maxv\ >\ minv)\ \{}
\DoxyCodeLine{06485\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 7.5f\ /\ (maxv\ -\/\ minv);}
\DoxyCodeLine{06486\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06487\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 0;}
\DoxyCodeLine{06488\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06489\ \ \ \ \ \ \ \ \ add\ =\ -\/minv\ *\ fac;}
\DoxyCodeLine{06490\ \ \ \ \ \ \ \ \ blk\ =\ src;}
\DoxyCodeLine{06491\ \ \ \ \ \ \ \ \ a\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06492\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06493\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06494\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06495\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06496\ \ \ \ \ \ \ \ \ b\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06497\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06498\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06499\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06500\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06501\ \ \ \ \ \ \ \ \ c\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06502\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06503\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06504\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06505\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06506\ \ \ \ \ \ \ \ \ d\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06507\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06508\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06509\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06510\ }
\DoxyCodeLine{06511\ \ \ \ \ \ \ \ \ *(dest++)\ =\ maxv;}
\DoxyCodeLine{06512\ \ \ \ \ \ \ \ \ *(dest++)\ =\ minv;}
\DoxyCodeLine{06513\ \ \ \ \ \ \ \ \ *(dest++)\ =\ a\ \&\ 0xff;}
\DoxyCodeLine{06514\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (a\ >>\ 8)\ |\ (b\ \&\ 0xf0);}
\DoxyCodeLine{06515\ \ \ \ \ \ \ \ \ *(dest++)\ =\ b\ >>\ 8;}
\DoxyCodeLine{06516\ \ \ \ \ \ \ \ \ *(dest++)\ =\ c\ \&\ 0xff;}
\DoxyCodeLine{06517\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (c\ >>\ 8)\ |\ (d\ \&\ 0xf0);}
\DoxyCodeLine{06518\ \ \ \ \ \ \ \ \ *(dest++)\ =\ d\ >>\ 8;}
\DoxyCodeLine{06519\ }
\DoxyCodeLine{06520\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ the\ minimum\ and\ maximum\ green\ value\ in\ the\ block.}}
\DoxyCodeLine{06521\ \ \ \ \ \ \ \ \ blk\ =\ src\ +\ 1;}
\DoxyCodeLine{06522\ \ \ \ \ \ \ \ \ minv\ =\ blk[0];}
\DoxyCodeLine{06523\ \ \ \ \ \ \ \ \ maxv\ =\ blk[0];}
\DoxyCodeLine{06524\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06525\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06526\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06527\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06528\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06529\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06530\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06531\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06532\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06533\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06534\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06535\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06536\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06537\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06538\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[0],\ minv);\ maxv\ =\ max(blk[0],\ maxv);}
\DoxyCodeLine{06539\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[2],\ minv);\ maxv\ =\ max(blk[2],\ maxv);}
\DoxyCodeLine{06540\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[4],\ minv);\ maxv\ =\ max(blk[4],\ maxv);}
\DoxyCodeLine{06541\ \ \ \ \ \ \ \ \ minv\ =\ min(blk[6],\ minv);\ maxv\ =\ max(blk[6],\ maxv);}
\DoxyCodeLine{06542\ }
\DoxyCodeLine{06543\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ calculate\ the\ index\ for\ each\ pixel.}}
\DoxyCodeLine{06544\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (maxv\ >\ minv)\ \{}
\DoxyCodeLine{06545\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 7.5f\ /\ (maxv\ -\/\ minv);}
\DoxyCodeLine{06546\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06547\ \ \ \ \ \ \ \ \ \ \ fac\ =\ 0;}
\DoxyCodeLine{06548\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06549\ \ \ \ \ \ \ \ \ add\ =\ -\/minv\ *\ fac;}
\DoxyCodeLine{06550\ \ \ \ \ \ \ \ \ blk\ =\ src\ +\ 1;}
\DoxyCodeLine{06551\ \ \ \ \ \ \ \ \ a\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06552\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06553\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06554\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06555\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06556\ \ \ \ \ \ \ \ \ b\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06557\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06558\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06559\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06560\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06561\ \ \ \ \ \ \ \ \ c\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)])}
\DoxyCodeLine{06562\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 3)}
\DoxyCodeLine{06563\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 6)}
\DoxyCodeLine{06564\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 9);}
\DoxyCodeLine{06565\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06566\ \ \ \ \ \ \ \ \ d\ =\ (remap[(int)(blk[0]\ *\ fac\ +\ add)]\ <<\ 4)}
\DoxyCodeLine{06567\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[2]\ *\ fac\ +\ add)]\ <<\ 7)}
\DoxyCodeLine{06568\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(int)(blk[4]\ *\ fac\ +\ add)]\ <<\ 10)}
\DoxyCodeLine{06569\ \ \ \ \ \ \ \ \ \ \ |\ (remap[(\textcolor{keywordtype}{int})(blk[6]\ *\ fac\ +\ add)]\ <<\ 13);}
\DoxyCodeLine{06570\ }
\DoxyCodeLine{06571\ \ \ \ \ \ \ \ \ *(dest++)\ =\ maxv;}
\DoxyCodeLine{06572\ \ \ \ \ \ \ \ \ *(dest++)\ =\ minv;}
\DoxyCodeLine{06573\ \ \ \ \ \ \ \ \ *(dest++)\ =\ a\ \&\ 0xff;}
\DoxyCodeLine{06574\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (a\ >>\ 8)\ |\ (b\ \&\ 0xf0);}
\DoxyCodeLine{06575\ \ \ \ \ \ \ \ \ *(dest++)\ =\ b\ >>\ 8;}
\DoxyCodeLine{06576\ \ \ \ \ \ \ \ \ *(dest++)\ =\ c\ \&\ 0xff;}
\DoxyCodeLine{06577\ \ \ \ \ \ \ \ \ *(dest++)\ =\ (c\ >>\ 8)\ |\ (d\ \&\ 0xf0);}
\DoxyCodeLine{06578\ \ \ \ \ \ \ \ \ *(dest++)\ =\ d\ >>\ 8;}
\DoxyCodeLine{06579\ }
\DoxyCodeLine{06580\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Advance\ to\ the\ beginning\ of\ the\ next\ 4x4\ block.}}
\DoxyCodeLine{06581\ \ \ \ \ \ \ \ \ src\ +=\ 8;}
\DoxyCodeLine{06582\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06583\ \ \ \ \ \ \ src\ +=\ stride\ *\ 3;}
\DoxyCodeLine{06584\ \ \ \ \ \}}
\DoxyCodeLine{06585\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{06586\ \ \ \}}
\DoxyCodeLine{06587\ \}}
\DoxyCodeLine{06588\ }
\DoxyCodeLine{06592\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ad2e69f0cc78d2077d3f3fc7eaf670be2}{Texture::}}}
\DoxyCodeLine{06593\ \mbox{\hyperlink{classTexture_ad2e69f0cc78d2077d3f3fc7eaf670be2}{do\_uncompress\_ram\_image\_bc4}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&compressed\_image,}
\DoxyCodeLine{06594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&uncompressed\_image,}
\DoxyCodeLine{06595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_pages)\ \{}
\DoxyCodeLine{06596\ \ \ \textcolor{keywordtype}{int}\ x\_blocks\ =\ (x\_size\ >>\ 2);}
\DoxyCodeLine{06597\ \ \ \textcolor{keywordtype}{int}\ y\_blocks\ =\ (y\_size\ >>\ 2);}
\DoxyCodeLine{06598\ }
\DoxyCodeLine{06599\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{06600\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\ =\ uncompressed\_image.\_image.p()\ +\ z\ *\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{06601\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src\ =\ compressed\_image.\_image.p()\ +\ z\ *\ compressed\_image.\_page\_size;}
\DoxyCodeLine{06602\ }
\DoxyCodeLine{06603\ \ \ \ \ \textcolor{comment}{//\ Unconvert\ one\ 4\ x\ 4\ block\ at\ a\ time.}}
\DoxyCodeLine{06604\ \ \ \ \ uint8\_t\ tbl[8];}
\DoxyCodeLine{06605\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_blocks;\ ++y)\ \{}
\DoxyCodeLine{06606\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_blocks;\ ++x)\ \{}
\DoxyCodeLine{06607\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *blk\ =\ dest;}
\DoxyCodeLine{06608\ \ \ \ \ \ \ \ \ tbl[0]\ =\ src[0];}
\DoxyCodeLine{06609\ \ \ \ \ \ \ \ \ tbl[1]\ =\ src[1];}
\DoxyCodeLine{06610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tbl[0]\ >\ tbl[1])\ \{}
\DoxyCodeLine{06611\ \ \ \ \ \ \ \ \ \ \ tbl[2]\ =\ (tbl[0]\ *\ 6\ +\ tbl[1]\ *\ 1)\ /\ 7.0f;}
\DoxyCodeLine{06612\ \ \ \ \ \ \ \ \ \ \ tbl[3]\ =\ (tbl[0]\ *\ 5\ +\ tbl[1]\ *\ 2)\ /\ 7.0f;}
\DoxyCodeLine{06613\ \ \ \ \ \ \ \ \ \ \ tbl[4]\ =\ (tbl[0]\ *\ 4\ +\ tbl[1]\ *\ 3)\ /\ 7.0f;}
\DoxyCodeLine{06614\ \ \ \ \ \ \ \ \ \ \ tbl[5]\ =\ (tbl[0]\ *\ 3\ +\ tbl[1]\ *\ 4)\ /\ 7.0f;}
\DoxyCodeLine{06615\ \ \ \ \ \ \ \ \ \ \ tbl[6]\ =\ (tbl[0]\ *\ 2\ +\ tbl[1]\ *\ 5)\ /\ 7.0f;}
\DoxyCodeLine{06616\ \ \ \ \ \ \ \ \ \ \ tbl[7]\ =\ (tbl[0]\ *\ 1\ +\ tbl[1]\ *\ 6)\ /\ 7.0f;}
\DoxyCodeLine{06617\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06618\ \ \ \ \ \ \ \ \ \ \ tbl[2]\ =\ (tbl[0]\ *\ 4\ +\ tbl[1]\ *\ 1)\ /\ 5.0f;}
\DoxyCodeLine{06619\ \ \ \ \ \ \ \ \ \ \ tbl[3]\ =\ (tbl[0]\ *\ 3\ +\ tbl[1]\ *\ 2)\ /\ 5.0f;}
\DoxyCodeLine{06620\ \ \ \ \ \ \ \ \ \ \ tbl[4]\ =\ (tbl[0]\ *\ 2\ +\ tbl[1]\ *\ 3)\ /\ 5.0f;}
\DoxyCodeLine{06621\ \ \ \ \ \ \ \ \ \ \ tbl[5]\ =\ (tbl[0]\ *\ 1\ +\ tbl[1]\ *\ 4)\ /\ 5.0f;}
\DoxyCodeLine{06622\ \ \ \ \ \ \ \ \ \ \ tbl[6]\ =\ 0;}
\DoxyCodeLine{06623\ \ \ \ \ \ \ \ \ \ \ tbl[7]\ =\ 255;}
\DoxyCodeLine{06624\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06625\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ src[2]\ +\ (src[3]\ <<\ 8)\ +\ (src[4]\ <<\ 16);}
\DoxyCodeLine{06626\ \ \ \ \ \ \ \ \ blk[0]\ =\ tbl[v\ \&\ 0x7];}
\DoxyCodeLine{06627\ \ \ \ \ \ \ \ \ blk[1]\ =\ tbl[(v\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06628\ \ \ \ \ \ \ \ \ blk[2]\ =\ tbl[(v\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06629\ \ \ \ \ \ \ \ \ blk[3]\ =\ tbl[(v\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06630\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06631\ \ \ \ \ \ \ \ \ blk[0]\ =\ tbl[(v\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06632\ \ \ \ \ \ \ \ \ blk[1]\ =\ tbl[(v\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06633\ \ \ \ \ \ \ \ \ blk[2]\ =\ tbl[(v\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06634\ \ \ \ \ \ \ \ \ blk[3]\ =\ tbl[(v\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06635\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06636\ \ \ \ \ \ \ \ \ v\ =\ src[5]\ +\ (src[6]\ <<\ 8)\ +\ (src[7]\ <<\ 16);}
\DoxyCodeLine{06637\ \ \ \ \ \ \ \ \ blk[0]\ =\ tbl[v\ \&\ 0x7];}
\DoxyCodeLine{06638\ \ \ \ \ \ \ \ \ blk[1]\ =\ tbl[(v\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06639\ \ \ \ \ \ \ \ \ blk[2]\ =\ tbl[(v\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06640\ \ \ \ \ \ \ \ \ blk[3]\ =\ tbl[(v\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06641\ \ \ \ \ \ \ \ \ blk\ +=\ x\_size;}
\DoxyCodeLine{06642\ \ \ \ \ \ \ \ \ blk[0]\ =\ tbl[(v\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06643\ \ \ \ \ \ \ \ \ blk[1]\ =\ tbl[(v\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06644\ \ \ \ \ \ \ \ \ blk[2]\ =\ tbl[(v\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06645\ \ \ \ \ \ \ \ \ blk[3]\ =\ tbl[(v\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06646\ \ \ \ \ \ \ \ \ src\ +=\ 8;}
\DoxyCodeLine{06647\ \ \ \ \ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{06648\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06649\ \ \ \ \ \ \ dest\ +=\ x\_size\ *\ 3;}
\DoxyCodeLine{06650\ \ \ \ \ \}}
\DoxyCodeLine{06651\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{06652\ \ \ \}}
\DoxyCodeLine{06653\ \}}
\DoxyCodeLine{06654\ }
\DoxyCodeLine{06658\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a670584408b060f0f22ee4ae4869f8c7b}{Texture::}}}
\DoxyCodeLine{06659\ \mbox{\hyperlink{classTexture_a670584408b060f0f22ee4ae4869f8c7b}{do\_uncompress\_ram\_image\_bc5}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&compressed\_image,}
\DoxyCodeLine{06660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ \&uncompressed\_image,}
\DoxyCodeLine{06661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_pages)\ \{}
\DoxyCodeLine{06662\ \ \ \textcolor{keywordtype}{int}\ x\_blocks\ =\ (x\_size\ >>\ 2);}
\DoxyCodeLine{06663\ \ \ \textcolor{keywordtype}{int}\ y\_blocks\ =\ (y\_size\ >>\ 2);}
\DoxyCodeLine{06664\ \ \ \textcolor{keywordtype}{int}\ stride\ =\ x\_size\ *\ 2;}
\DoxyCodeLine{06665\ }
\DoxyCodeLine{06666\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{06667\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\ =\ uncompressed\_image.\_image.p()\ +\ z\ *\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{06668\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *src\ =\ compressed\_image.\_image.p()\ +\ z\ *\ compressed\_image.\_page\_size;}
\DoxyCodeLine{06669\ }
\DoxyCodeLine{06670\ \ \ \ \ \textcolor{comment}{//\ Unconvert\ one\ 4\ x\ 4\ block\ at\ a\ time.}}
\DoxyCodeLine{06671\ \ \ \ \ uint8\_t\ red[8];}
\DoxyCodeLine{06672\ \ \ \ \ uint8\_t\ grn[8];}
\DoxyCodeLine{06673\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_blocks;\ ++y)\ \{}
\DoxyCodeLine{06674\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_blocks;\ ++x)\ \{}
\DoxyCodeLine{06675\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *blk\ =\ dest;}
\DoxyCodeLine{06676\ \ \ \ \ \ \ \ \ red[0]\ =\ src[0];}
\DoxyCodeLine{06677\ \ \ \ \ \ \ \ \ red[1]\ =\ src[1];}
\DoxyCodeLine{06678\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (red[0]\ >\ red[1])\ \{}
\DoxyCodeLine{06679\ \ \ \ \ \ \ \ \ \ \ red[2]\ =\ (red[0]\ *\ 6\ +\ red[1]\ *\ 1)\ /\ 7.0f;}
\DoxyCodeLine{06680\ \ \ \ \ \ \ \ \ \ \ red[3]\ =\ (red[0]\ *\ 5\ +\ red[1]\ *\ 2)\ /\ 7.0f;}
\DoxyCodeLine{06681\ \ \ \ \ \ \ \ \ \ \ red[4]\ =\ (red[0]\ *\ 4\ +\ red[1]\ *\ 3)\ /\ 7.0f;}
\DoxyCodeLine{06682\ \ \ \ \ \ \ \ \ \ \ red[5]\ =\ (red[0]\ *\ 3\ +\ red[1]\ *\ 4)\ /\ 7.0f;}
\DoxyCodeLine{06683\ \ \ \ \ \ \ \ \ \ \ red[6]\ =\ (red[0]\ *\ 2\ +\ red[1]\ *\ 5)\ /\ 7.0f;}
\DoxyCodeLine{06684\ \ \ \ \ \ \ \ \ \ \ red[7]\ =\ (red[0]\ *\ 1\ +\ red[1]\ *\ 6)\ /\ 7.0f;}
\DoxyCodeLine{06685\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06686\ \ \ \ \ \ \ \ \ \ \ red[2]\ =\ (red[0]\ *\ 4\ +\ red[1]\ *\ 1)\ /\ 5.0f;}
\DoxyCodeLine{06687\ \ \ \ \ \ \ \ \ \ \ red[3]\ =\ (red[0]\ *\ 3\ +\ red[1]\ *\ 2)\ /\ 5.0f;}
\DoxyCodeLine{06688\ \ \ \ \ \ \ \ \ \ \ red[4]\ =\ (red[0]\ *\ 2\ +\ red[1]\ *\ 3)\ /\ 5.0f;}
\DoxyCodeLine{06689\ \ \ \ \ \ \ \ \ \ \ red[5]\ =\ (red[0]\ *\ 1\ +\ red[1]\ *\ 4)\ /\ 5.0f;}
\DoxyCodeLine{06690\ \ \ \ \ \ \ \ \ \ \ red[6]\ =\ 0;}
\DoxyCodeLine{06691\ \ \ \ \ \ \ \ \ \ \ red[7]\ =\ 255;}
\DoxyCodeLine{06692\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06693\ \ \ \ \ \ \ \ \ grn[0]\ =\ src[8];}
\DoxyCodeLine{06694\ \ \ \ \ \ \ \ \ grn[1]\ =\ src[9];}
\DoxyCodeLine{06695\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grn[0]\ >\ grn[1])\ \{}
\DoxyCodeLine{06696\ \ \ \ \ \ \ \ \ \ \ grn[2]\ =\ (grn[0]\ *\ 6\ +\ grn[1]\ *\ 1)\ /\ 7.0f;}
\DoxyCodeLine{06697\ \ \ \ \ \ \ \ \ \ \ grn[3]\ =\ (grn[0]\ *\ 5\ +\ grn[1]\ *\ 2)\ /\ 7.0f;}
\DoxyCodeLine{06698\ \ \ \ \ \ \ \ \ \ \ grn[4]\ =\ (grn[0]\ *\ 4\ +\ grn[1]\ *\ 3)\ /\ 7.0f;}
\DoxyCodeLine{06699\ \ \ \ \ \ \ \ \ \ \ grn[5]\ =\ (grn[0]\ *\ 3\ +\ grn[1]\ *\ 4)\ /\ 7.0f;}
\DoxyCodeLine{06700\ \ \ \ \ \ \ \ \ \ \ grn[6]\ =\ (grn[0]\ *\ 2\ +\ grn[1]\ *\ 5)\ /\ 7.0f;}
\DoxyCodeLine{06701\ \ \ \ \ \ \ \ \ \ \ grn[7]\ =\ (grn[0]\ *\ 1\ +\ grn[1]\ *\ 6)\ /\ 7.0f;}
\DoxyCodeLine{06702\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06703\ \ \ \ \ \ \ \ \ \ \ grn[2]\ =\ (grn[0]\ *\ 4\ +\ grn[1]\ *\ 1)\ /\ 5.0f;}
\DoxyCodeLine{06704\ \ \ \ \ \ \ \ \ \ \ grn[3]\ =\ (grn[0]\ *\ 3\ +\ grn[1]\ *\ 2)\ /\ 5.0f;}
\DoxyCodeLine{06705\ \ \ \ \ \ \ \ \ \ \ grn[4]\ =\ (grn[0]\ *\ 2\ +\ grn[1]\ *\ 3)\ /\ 5.0f;}
\DoxyCodeLine{06706\ \ \ \ \ \ \ \ \ \ \ grn[5]\ =\ (grn[0]\ *\ 1\ +\ grn[1]\ *\ 4)\ /\ 5.0f;}
\DoxyCodeLine{06707\ \ \ \ \ \ \ \ \ \ \ grn[6]\ =\ 0;}
\DoxyCodeLine{06708\ \ \ \ \ \ \ \ \ \ \ grn[7]\ =\ 255;}
\DoxyCodeLine{06709\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06710\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ r\ =\ src[2]\ +\ (src[3]\ <<\ 8)\ +\ (src[4]\ <<\ 16);}
\DoxyCodeLine{06711\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ g\ =\ src[10]\ +\ (src[11]\ <<\ 8)\ +\ (src[12]\ <<\ 16);}
\DoxyCodeLine{06712\ \ \ \ \ \ \ \ \ blk[0]\ =\ red[r\ \&\ 0x7];}
\DoxyCodeLine{06713\ \ \ \ \ \ \ \ \ blk[1]\ =\ grn[g\ \&\ 0x7];}
\DoxyCodeLine{06714\ \ \ \ \ \ \ \ \ blk[2]\ =\ red[(r\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06715\ \ \ \ \ \ \ \ \ blk[3]\ =\ grn[(g\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06716\ \ \ \ \ \ \ \ \ blk[4]\ =\ red[(r\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06717\ \ \ \ \ \ \ \ \ blk[5]\ =\ grn[(g\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06718\ \ \ \ \ \ \ \ \ blk[6]\ =\ red[(r\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06719\ \ \ \ \ \ \ \ \ blk[7]\ =\ grn[(g\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06720\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06721\ \ \ \ \ \ \ \ \ blk[0]\ =\ red[(r\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06722\ \ \ \ \ \ \ \ \ blk[1]\ =\ grn[(g\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06723\ \ \ \ \ \ \ \ \ blk[2]\ =\ red[(r\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06724\ \ \ \ \ \ \ \ \ blk[3]\ =\ grn[(g\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06725\ \ \ \ \ \ \ \ \ blk[4]\ =\ red[(r\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06726\ \ \ \ \ \ \ \ \ blk[5]\ =\ grn[(g\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06727\ \ \ \ \ \ \ \ \ blk[6]\ =\ red[(r\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06728\ \ \ \ \ \ \ \ \ blk[7]\ =\ grn[(g\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06729\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06730\ \ \ \ \ \ \ \ \ r\ =\ src[5]\ +\ (src[6]\ <<\ 8)\ +\ (src[7]\ <<\ 16);}
\DoxyCodeLine{06731\ \ \ \ \ \ \ \ \ g\ =\ src[13]\ +\ (src[14]\ <<\ 8)\ +\ (src[15]\ <<\ 16);}
\DoxyCodeLine{06732\ \ \ \ \ \ \ \ \ blk[0]\ =\ red[r\ \&\ 0x7];}
\DoxyCodeLine{06733\ \ \ \ \ \ \ \ \ blk[1]\ =\ grn[g\ \&\ 0x7];}
\DoxyCodeLine{06734\ \ \ \ \ \ \ \ \ blk[2]\ =\ red[(r\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06735\ \ \ \ \ \ \ \ \ blk[3]\ =\ grn[(g\ \&\ 0x000038)\ >>\ 3];}
\DoxyCodeLine{06736\ \ \ \ \ \ \ \ \ blk[4]\ =\ red[(r\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06737\ \ \ \ \ \ \ \ \ blk[5]\ =\ grn[(g\ \&\ 0x0001c0)\ >>\ 6];}
\DoxyCodeLine{06738\ \ \ \ \ \ \ \ \ blk[6]\ =\ red[(r\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06739\ \ \ \ \ \ \ \ \ blk[7]\ =\ grn[(g\ \&\ 0x000e00)\ >>\ 9];}
\DoxyCodeLine{06740\ \ \ \ \ \ \ \ \ blk\ +=\ stride;}
\DoxyCodeLine{06741\ \ \ \ \ \ \ \ \ blk[0]\ =\ red[(r\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06742\ \ \ \ \ \ \ \ \ blk[1]\ =\ grn[(g\ \&\ 0x007000)\ >>\ 12];}
\DoxyCodeLine{06743\ \ \ \ \ \ \ \ \ blk[2]\ =\ red[(r\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06744\ \ \ \ \ \ \ \ \ blk[3]\ =\ grn[(g\ \&\ 0x038000)\ >>\ 15];}
\DoxyCodeLine{06745\ \ \ \ \ \ \ \ \ blk[4]\ =\ red[(r\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06746\ \ \ \ \ \ \ \ \ blk[5]\ =\ grn[(g\ \&\ 0x1c0000)\ >>\ 18];}
\DoxyCodeLine{06747\ \ \ \ \ \ \ \ \ blk[6]\ =\ red[(r\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06748\ \ \ \ \ \ \ \ \ blk[7]\ =\ grn[(g\ \&\ 0xe00000)\ >>\ 21];}
\DoxyCodeLine{06749\ \ \ \ \ \ \ \ \ src\ +=\ 16;}
\DoxyCodeLine{06750\ \ \ \ \ \ \ \ \ dest\ +=\ 8;}
\DoxyCodeLine{06751\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06752\ \ \ \ \ \ \ dest\ +=\ stride\ *\ 3;}
\DoxyCodeLine{06753\ \ \ \ \ \}}
\DoxyCodeLine{06754\ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{06755\ \ \ \}}
\DoxyCodeLine{06756\ \}}
\DoxyCodeLine{06757\ }
\DoxyCodeLine{06761\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{06762\ do\_has\_all\_ram\_mipmap\_images(\textcolor{keyword}{const}\ CData\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{06763\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ ||\ cdata-\/>\_ram\_images[0].\_image.empty())\ \{}
\DoxyCodeLine{06764\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ even\ have\ a\ base\ image,\ the\ answer\ is\ no.}}
\DoxyCodeLine{06765\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06766\ \ \ \}}
\DoxyCodeLine{06767\ \ \ \textcolor{keywordflow}{if}\ (!uses\_mipmaps())\ \{}
\DoxyCodeLine{06768\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ base\ image\ and\ don't\ require\ mipmapping,\ the\ answer\ is}}
\DoxyCodeLine{06769\ \ \ \ \ \textcolor{comment}{//\ yes.}}
\DoxyCodeLine{06770\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06771\ \ \ \}}
\DoxyCodeLine{06772\ }
\DoxyCodeLine{06773\ \ \ \textcolor{comment}{//\ Check\ that\ we\ have\ enough\ mipmap\ levels\ to\ meet\ the\ size\ requirements.}}
\DoxyCodeLine{06774\ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_x\_size,\ max(cdata-\/>\_y\_size,\ cdata-\/>\_z\_size));}
\DoxyCodeLine{06775\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{06776\ \ \ \textcolor{keywordtype}{int}\ x\ =\ 1;}
\DoxyCodeLine{06777\ \ \ \textcolor{keywordflow}{while}\ (x\ <\ size)\ \{}
\DoxyCodeLine{06778\ \ \ \ \ x\ =\ (x\ <<\ 1);}
\DoxyCodeLine{06779\ \ \ \ \ ++n;}
\DoxyCodeLine{06780\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size()\ ||\ cdata-\/>\_ram\_images[n].\_image.empty())\ \{}
\DoxyCodeLine{06781\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06782\ \ \ \ \ \}}
\DoxyCodeLine{06783\ \ \ \}}
\DoxyCodeLine{06784\ }
\DoxyCodeLine{06785\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06786\ \}}
\DoxyCodeLine{06787\ }
\DoxyCodeLine{06795\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a3adf380f82bd7de62b8a780d4d4c83d5}{Texture::}}}
\DoxyCodeLine{06796\ \mbox{\hyperlink{classTexture_a3adf380f82bd7de62b8a780d4d4c83d5}{do\_reconsider\_z\_size}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{int}\ z,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{06797\ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views)\ \{}
\DoxyCodeLine{06798\ \ \ \ \ \textcolor{keywordtype}{bool}\ num\_views\_specified\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06799\ \ \ \ \ \textcolor{keywordflow}{if}\ (options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_multiview)\ \{}
\DoxyCodeLine{06800\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ flag\ is\ false\ if\ is\ a\ multiview\ texture\ with\ a\ specified\ number}}
\DoxyCodeLine{06801\ \ \ \ \ \ \ \textcolor{comment}{//\ of\ views.\ \ It\ is\ true\ if\ it\ is\ not\ a\ multiview\ texture,\ or\ if\ it\ is}}
\DoxyCodeLine{06802\ \ \ \ \ \ \ \textcolor{comment}{//\ but\ the\ number\ of\ views\ is\ explicitly\ specified.}}
\DoxyCodeLine{06803\ \ \ \ \ \ \ num\_views\_specified\ =\ (options.get\_texture\_num\_views()\ !=\ 0);}
\DoxyCodeLine{06804\ \ \ \ \ \}}
\DoxyCodeLine{06805\ }
\DoxyCodeLine{06806\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_views\_specified\ \&\&}
\DoxyCodeLine{06807\ \ \ \ \ \ \ \ \ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture\ ||}
\DoxyCodeLine{06808\ \ \ \ \ \ \ \ \ \ cdata-\/>\_texture\_type\ ==\ Texture::TT\_2d\_texture\_array))\ \{}
\DoxyCodeLine{06809\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ loading\ a\ page\ past\ \_z\_size,\ treat\ it\ as\ an\ implicit\ request}}
\DoxyCodeLine{06810\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ enlarge\ \_z\_size.\ \ However,\ this\ is\ only\ legal\ if\ this\ is,\ in\ fact,}}
\DoxyCodeLine{06811\ \ \ \ \ \ \ \textcolor{comment}{//\ a\ 3-\/d\ texture\ or\ a\ 2d\ texture\ array\ (cube\ maps\ always\ have\ z\_size\ 6,}}
\DoxyCodeLine{06812\ \ \ \ \ \ \ \textcolor{comment}{//\ and\ other\ types\ have\ z\_size\ 1).}}
\DoxyCodeLine{06813\ \ \ \ \ \ \ nassertr(cdata-\/>\_num\_views\ !=\ 0,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06814\ \ \ \ \ \ \ cdata-\/>\_z\_size\ =\ (z\ /\ cdata-\/>\_num\_views)\ +\ 1;}
\DoxyCodeLine{06815\ }
\DoxyCodeLine{06816\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cdata-\/>\_z\_size\ !=\ 0)\ \{}
\DoxyCodeLine{06817\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ the\ case\ of\ a\ 2-\/d\ texture\ or\ cube\ map,\ or\ a\ 3-\/d\ texture\ with\ an}}
\DoxyCodeLine{06818\ \ \ \ \ \ \ \textcolor{comment}{//\ unspecified\ \_num\_views,\ assume\ we're\ loading\ views\ of\ a\ multiview}}
\DoxyCodeLine{06819\ \ \ \ \ \ \ \textcolor{comment}{//\ texture.}}
\DoxyCodeLine{06820\ \ \ \ \ \ \ cdata-\/>\_num\_views\ =\ (z\ /\ cdata-\/>\_z\_size)\ +\ 1;}
\DoxyCodeLine{06821\ }
\DoxyCodeLine{06822\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06823\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ first\ image\ loaded\ sets\ an\ implicit\ z-\/size.}}
\DoxyCodeLine{06824\ \ \ \ \ \ \ cdata-\/>\_z\_size\ =\ 1;}
\DoxyCodeLine{06825\ \ \ \ \ \}}
\DoxyCodeLine{06826\ }
\DoxyCodeLine{06827\ \ \ \ \ \textcolor{comment}{//\ Increase\ the\ size\ of\ the\ data\ buffer\ to\ make\ room\ for\ the\ new\ texture}}
\DoxyCodeLine{06828\ \ \ \ \ \textcolor{comment}{//\ level.}}
\DoxyCodeLine{06829\ \ \ \ \ \mbox{\hyperlink{classTexture_ae49705062d3a3c21b23244d049c6e547}{do\_allocate\_pages}}(cdata);}
\DoxyCodeLine{06830\ \ \ \}}
\DoxyCodeLine{06831\ }
\DoxyCodeLine{06832\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06833\ \}}
\DoxyCodeLine{06834\ }
\DoxyCodeLine{06841\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ae49705062d3a3c21b23244d049c6e547}{Texture::}}}
\DoxyCodeLine{06842\ \mbox{\hyperlink{classTexture_ae49705062d3a3c21b23244d049c6e547}{do\_allocate\_pages}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\ \{}
\DoxyCodeLine{06843\ \ \ \textcolor{keywordtype}{size\_t}\ new\_size\ =\ do\_get\_expected\_ram\_image\_size(cdata);}
\DoxyCodeLine{06844\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_ram\_images.empty()\ \&\&}
\DoxyCodeLine{06845\ \ \ \ \ \ \ !cdata-\/>\_ram\_images[0].\_image.empty()\ \&\&}
\DoxyCodeLine{06846\ \ \ \ \ \ \ new\_size\ >\ cdata-\/>\_ram\_images[0].\_image.size())\ \{}
\DoxyCodeLine{06847\ \ \ \ \ cdata-\/>\_ram\_images[0].\_image.insert(cdata-\/>\_ram\_images[0].\_image.end(),\ new\_size\ -\/\ cdata-\/>\_ram\_images[0].\_image.size(),\ 0);}
\DoxyCodeLine{06848\ \ \ \ \ nassertv(cdata-\/>\_ram\_images[0].\_image.size()\ ==\ new\_size);}
\DoxyCodeLine{06849\ \ \ \}}
\DoxyCodeLine{06850\ \}}
\DoxyCodeLine{06851\ }
\DoxyCodeLine{06858\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_af9e91896eac6f7215f59e3a78c100bfc}{Texture::}}}
\DoxyCodeLine{06859\ \mbox{\hyperlink{classTexture_af9e91896eac6f7215f59e3a78c100bfc}{do\_reconsider\_image\_properties}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_components,}
\DoxyCodeLine{06860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Texture::ComponentType\ component\_type,\ \textcolor{keywordtype}{int}\ z,}
\DoxyCodeLine{06861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options)\ \{}
\DoxyCodeLine{06862\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_loaded\_from\_image\ ||\ num\_components\ !=\ cdata-\/>\_num\_components\ ||\ component\_type\ !=\ cdata-\/>\_component\_type)\ \{}
\DoxyCodeLine{06863\ \ \ \ \ \textcolor{comment}{//\ Come\ up\ with\ a\ default\ format\ based\ on\ the\ number\ of\ channels.\ \ But}}
\DoxyCodeLine{06864\ \ \ \ \ \textcolor{comment}{//\ only\ do\ this\ the\ first\ time\ the\ file\ is\ loaded,\ or\ if\ the\ number\ of}}
\DoxyCodeLine{06865\ \ \ \ \ \textcolor{comment}{//\ channels\ in\ the\ image\ changes\ on\ subsequent\ loads.}}
\DoxyCodeLine{06866\ }
\DoxyCodeLine{06867\ \ \ \ \ \textcolor{comment}{//\ TODO:\ handle\ sRGB\ properly}}
\DoxyCodeLine{06868\ \ \ \ \ \textcolor{keywordflow}{switch}\ (num\_components)\ \{}
\DoxyCodeLine{06869\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{06870\ \ \ \ \ \ \ cdata-\/>\_format\ =\ F\_luminance;}
\DoxyCodeLine{06871\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06872\ }
\DoxyCodeLine{06873\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{06874\ \ \ \ \ \ \ cdata-\/>\_format\ =\ F\_luminance\_alpha;}
\DoxyCodeLine{06875\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06876\ }
\DoxyCodeLine{06877\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{06878\ \ \ \ \ \ \ cdata-\/>\_format\ =\ F\_rgb;}
\DoxyCodeLine{06879\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06880\ }
\DoxyCodeLine{06881\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{06882\ \ \ \ \ \ \ cdata-\/>\_format\ =\ F\_rgba;}
\DoxyCodeLine{06883\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06884\ }
\DoxyCodeLine{06885\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06886\ \ \ \ \ \ \ \textcolor{comment}{//\ Eh?}}
\DoxyCodeLine{06887\ \ \ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{06888\ \ \ \ \ \ \ cdata-\/>\_format\ =\ F\_rgb;}
\DoxyCodeLine{06889\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06890\ \ \ \ \ \}}
\DoxyCodeLine{06891\ \ \ \}}
\DoxyCodeLine{06892\ }
\DoxyCodeLine{06893\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_loaded\_from\_image)\ \{}
\DoxyCodeLine{06894\ \ \ \ \ \textcolor{keywordflow}{if}\ ((options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_allow\_1d)\ \&\&}
\DoxyCodeLine{06895\ \ \ \ \ \ \ \ \ cdata-\/>\_texture\_type\ ==\ TT\_2d\_texture\ \&\&\ x\_size\ !=\ 1\ \&\&\ y\_size\ ==\ 1)\ \{}
\DoxyCodeLine{06896\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ loading\ an\ Nx1\ size\ texture,\ infer\ a\ 1-\/d\ texture\ type.}}
\DoxyCodeLine{06897\ \ \ \ \ \ \ cdata-\/>\_texture\_type\ =\ TT\_1d\_texture;}
\DoxyCodeLine{06898\ \ \ \ \ \}}
\DoxyCodeLine{06899\ }
\DoxyCodeLine{06900\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06901\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_texture\_type)\ \{}
\DoxyCodeLine{06902\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{06903\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{06904\ \ \ \ \ \ \ nassertr(y\_size\ ==\ 1,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06905\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06906\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{06907\ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:}
\DoxyCodeLine{06908\ \ \ \ \ \ \ nassertr(x\_size\ ==\ y\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06909\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06910\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06911\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06912\ \ \ \ \ \}}
\DoxyCodeLine{06913\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06914\ \ \ \ \ \textcolor{keywordflow}{if}\ ((cdata-\/>\_x\_size\ !=\ x\_size)||(cdata-\/>\_y\_size\ !=\ y\_size))\ \{}
\DoxyCodeLine{06915\ \ \ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{06916\ \ \ \ \ \}}
\DoxyCodeLine{06917\ \ \ \ \ cdata-\/>\_x\_size\ =\ x\_size;}
\DoxyCodeLine{06918\ \ \ \ \ cdata-\/>\_y\_size\ =\ y\_size;}
\DoxyCodeLine{06919\ \ \ \ \ cdata-\/>\_num\_components\ =\ num\_components;}
\DoxyCodeLine{06920\ \ \ \ \ do\_set\_component\_type(cdata,\ component\_type);}
\DoxyCodeLine{06921\ }
\DoxyCodeLine{06922\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06923\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_x\_size\ !=\ x\_size\ ||}
\DoxyCodeLine{06924\ \ \ \ \ \ \ \ \ cdata-\/>\_y\_size\ !=\ y\_size\ ||}
\DoxyCodeLine{06925\ \ \ \ \ \ \ \ \ cdata-\/>\_num\_components\ !=\ num\_components\ ||}
\DoxyCodeLine{06926\ \ \ \ \ \ \ \ \ cdata-\/>\_component\_type\ !=\ component\_type)\ \{}
\DoxyCodeLine{06927\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{06928\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ properties\ have\ changed\ for\ texture\ "{}}\ <<\ get\_name()}
\DoxyCodeLine{06929\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ page\ "{}}\ <<\ z\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{06930\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06931\ \ \ \ \ \}}
\DoxyCodeLine{06932\ \ \ \}}
\DoxyCodeLine{06933\ }
\DoxyCodeLine{06934\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06935\ \}}
\DoxyCodeLine{06936\ }
\DoxyCodeLine{06940\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{06941\ do\_rescale\_texture(CData\ *cdata)\ \{}
\DoxyCodeLine{06942\ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{06943\ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{06944\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views\ !=\ 1)\ \{}
\DoxyCodeLine{06945\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}rescale\_texture()\ doesn't\ support\ 3-\/d\ or\ multiview\ textures."{}});}
\DoxyCodeLine{06946\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06947\ \ \ \}}
\DoxyCodeLine{06948\ }
\DoxyCodeLine{06949\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{do\_adjust\_this\_size}}(cdata,\ new\_x\_size,\ new\_y\_size,\ get\_name(),\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{06950\ \ \ \ \ \textcolor{comment}{//\ OK,\ we\ have\ to\ scale\ the\ image.}}
\DoxyCodeLine{06951\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ orig\_image;}
\DoxyCodeLine{06952\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(cdata,\ orig\_image,\ 0,\ 0))\ \{}
\DoxyCodeLine{06953\ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{06954\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Couldn't\ get\ image\ in\ rescale\_texture()\(\backslash\)n"{}};}
\DoxyCodeLine{06955\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06956\ \ \ \ \ \}}
\DoxyCodeLine{06957\ }
\DoxyCodeLine{06958\ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{06959\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Resizing\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ new\_x\_size\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}}
\DoxyCodeLine{06960\ \ \ \ \ \ \ <<\ new\_y\_size\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06961\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ new\_image(new\_x\_size,\ new\_y\_size,\ orig\_image.get\_num\_channels(),}
\DoxyCodeLine{06962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image.get\_maxval(),\ orig\_image.get\_type(),}
\DoxyCodeLine{06963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image.get\_color\_space());}
\DoxyCodeLine{06964\ \ \ \ \ new\_image.quick\_filter\_from(orig\_image);}
\DoxyCodeLine{06965\ }
\DoxyCodeLine{06966\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{06967\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{06968\ \ \ \ \ cdata-\/>\_x\_size\ =\ new\_x\_size;}
\DoxyCodeLine{06969\ \ \ \ \ cdata-\/>\_y\_size\ =\ new\_y\_size;}
\DoxyCodeLine{06970\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(cdata,\ new\_image,\ get\_name(),\ 0,\ 0,\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}()))\ \{}
\DoxyCodeLine{06971\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06972\ \ \ \ \ \}}
\DoxyCodeLine{06973\ }
\DoxyCodeLine{06974\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06975\ \ \ \}}
\DoxyCodeLine{06976\ }
\DoxyCodeLine{06977\ \ \ \textcolor{comment}{//\ Maybe\ we\ should\ pad\ the\ image.}}
\DoxyCodeLine{06978\ \ \ \textcolor{keywordtype}{int}\ pad\_x\_size\ =\ 0;}
\DoxyCodeLine{06979\ \ \ \textcolor{keywordtype}{int}\ pad\_y\_size\ =\ 0;}
\DoxyCodeLine{06980\ \ \ \textcolor{keywordflow}{if}\ (do\_get\_auto\_texture\_scale(cdata)\ ==\ ATS\_pad)\ \{}
\DoxyCodeLine{06981\ \ \ \ \ new\_x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{06982\ \ \ \ \ new\_y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{06983\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a2bdc2d5733e9accf9ed5b04c6bd8c1a9}{do\_adjust\_this\_size}}(cdata,\ new\_x\_size,\ new\_y\_size,\ get\_name(),\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{06984\ \ \ \ \ \ \ pad\_x\_size\ =\ new\_x\_size\ -\/\ cdata-\/>\_x\_size;}
\DoxyCodeLine{06985\ \ \ \ \ \ \ pad\_y\_size\ =\ new\_y\_size\ -\/\ cdata-\/>\_y\_size;}
\DoxyCodeLine{06986\ }
\DoxyCodeLine{06987\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ orig\_image;}
\DoxyCodeLine{06988\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a5e21de402c76cfab0a6ae96a97ae8f6b}{do\_store\_one}}(cdata,\ orig\_image,\ 0,\ 0))\ \{}
\DoxyCodeLine{06989\ \ \ \ \ \ \ \ \ gobj\_cat.warning()}
\DoxyCodeLine{06990\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Couldn't\ get\ image\ in\ rescale\_texture()\(\backslash\)n"{}};}
\DoxyCodeLine{06991\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06992\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06993\ \ \ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ new\_image(new\_x\_size,\ new\_y\_size,\ orig\_image.get\_num\_channels(),}
\DoxyCodeLine{06994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image.get\_maxval(),\ orig\_image.get\_type(),}
\DoxyCodeLine{06995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image.get\_color\_space());}
\DoxyCodeLine{06996\ \ \ \ \ \ \ new\_image.copy\_sub\_image(orig\_image,\ 0,\ new\_y\_size\ -\/\ orig\_image.get\_y\_size());}
\DoxyCodeLine{06997\ }
\DoxyCodeLine{06998\ \ \ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{06999\ \ \ \ \ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{07000\ \ \ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07001\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a095a372175469faf3c3cadd96d33a5cf}{do\_load\_one}}(cdata,\ new\_image,\ get\_name(),\ 0,\ 0,\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}()))\ \{}
\DoxyCodeLine{07002\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07003\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07004\ }
\DoxyCodeLine{07005\ \ \ \ \ \ \ do\_set\_pad\_size(cdata,\ pad\_x\_size,\ pad\_y\_size,\ 0);}
\DoxyCodeLine{07006\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07007\ \ \ \ \ \}}
\DoxyCodeLine{07008\ \ \ \}}
\DoxyCodeLine{07009\ }
\DoxyCodeLine{07010\ \ \ \textcolor{comment}{//\ No\ changes\ needed.}}
\DoxyCodeLine{07011\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07012\ \}}
\DoxyCodeLine{07013\ }
\DoxyCodeLine{07017\ PT(\mbox{\hyperlink{classTexture}{Texture}})\ Texture::}
\DoxyCodeLine{07018\ make\_copy\_impl()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07019\ \ \ CDReader\ cdata(\_cycler);}
\DoxyCodeLine{07020\ \ \ \textcolor{keywordflow}{return}\ do\_make\_copy(cdata);}
\DoxyCodeLine{07021\ \}}
\DoxyCodeLine{07022\ }
\DoxyCodeLine{07026\ PT(\mbox{\hyperlink{classTexture}{Texture}})\ Texture::}
\DoxyCodeLine{07027\ do\_make\_copy(\textcolor{keyword}{const}\ CData\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07028\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ tex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture}}(get\_name());}
\DoxyCodeLine{07029\ \ \ CDWriter\ cdata\_tex(tex-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{07030\ \ \ tex-\/>do\_assign(cdata\_tex,\ \textcolor{keyword}{this},\ cdata);}
\DoxyCodeLine{07031\ \ \ \textcolor{keywordflow}{return}\ tex;}
\DoxyCodeLine{07032\ \}}
\DoxyCodeLine{07033\ }
\DoxyCodeLine{07038\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07039\ do\_assign(CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture}{Texture}}\ *copy,\ \textcolor{keyword}{const}\ CData\ *cdata\_copy)\ \{}
\DoxyCodeLine{07040\ \ \ cdata-\/>do\_assign(cdata\_copy);}
\DoxyCodeLine{07041\ \}}
\DoxyCodeLine{07042\ }
\DoxyCodeLine{07046\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_aae02b1ff840292af0cac659d6d75a632}{Texture::}}}
\DoxyCodeLine{07047\ \mbox{\hyperlink{classTexture_aae02b1ff840292af0cac659d6d75a632}{do\_clear}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\ \{}
\DoxyCodeLine{07048\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ tex;}
\DoxyCodeLine{07049\ \ \ tex.local\_object();}
\DoxyCodeLine{07050\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata\_tex(tex.\_cycler);}
\DoxyCodeLine{07051\ \ \ do\_assign(cdata,\ \&tex,\ cdata\_tex);}
\DoxyCodeLine{07052\ }
\DoxyCodeLine{07053\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07054\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07055\ \}}
\DoxyCodeLine{07056\ }
\DoxyCodeLine{07060\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07061\ do\_setup\_texture(CData\ *cdata,\ Texture::TextureType\ texture\_type,}
\DoxyCodeLine{07062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ z\_size,}
\DoxyCodeLine{07063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Texture::ComponentType\ component\_type,}
\DoxyCodeLine{07064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Texture::Format\ format)\ \{}
\DoxyCodeLine{07065\ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{07066\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{07067\ \ \ \ \ nassertv(y\_size\ ==\ 1\ \&\&\ z\_size\ ==\ 1);}
\DoxyCodeLine{07068\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07069\ }
\DoxyCodeLine{07070\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture:}
\DoxyCodeLine{07071\ \ \ \ \ nassertv(z\_size\ ==\ 1);}
\DoxyCodeLine{07072\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07073\ }
\DoxyCodeLine{07074\ \ \ \textcolor{keywordflow}{case}\ TT\_3d\_texture:}
\DoxyCodeLine{07075\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07076\ }
\DoxyCodeLine{07077\ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture\_array:}
\DoxyCodeLine{07078\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07079\ }
\DoxyCodeLine{07080\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{07081\ \ \ \ \ \textcolor{comment}{//\ Cube\ maps\ must\ always\ consist\ of\ six\ square\ images.}}
\DoxyCodeLine{07082\ \ \ \ \ nassertv(x\_size\ ==\ y\_size\ \&\&\ z\_size\ ==\ 6);}
\DoxyCodeLine{07083\ }
\DoxyCodeLine{07084\ \ \ \ \ \textcolor{comment}{//\ In\ principle\ the\ wrap\ mode\ shouldn't\ mean\ anything\ to\ a\ cube\ map,\ but}}
\DoxyCodeLine{07085\ \ \ \ \ \textcolor{comment}{//\ some\ drivers\ seem\ to\ misbehave\ if\ it's\ other\ than}}
\DoxyCodeLine{07086\ \ \ \ \ \textcolor{comment}{//\ SamplerState::WM\_clamp.}}
\DoxyCodeLine{07087\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_u(SamplerState::WM\_clamp);}
\DoxyCodeLine{07088\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_v(SamplerState::WM\_clamp);}
\DoxyCodeLine{07089\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_w(SamplerState::WM\_clamp);}
\DoxyCodeLine{07090\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07091\ }
\DoxyCodeLine{07092\ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:}
\DoxyCodeLine{07093\ \ \ \ \ \textcolor{comment}{//\ Cube\ maps\ array\ z\_size\ needs\ to\ be\ a\ multiple\ of\ 6.}}
\DoxyCodeLine{07094\ \ \ \ \ nassertv(x\_size\ ==\ y\_size\ \&\&\ z\_size\ \%\ 6\ ==\ 0);}
\DoxyCodeLine{07095\ }
\DoxyCodeLine{07096\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_u(SamplerState::WM\_clamp);}
\DoxyCodeLine{07097\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_v(SamplerState::WM\_clamp);}
\DoxyCodeLine{07098\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_w(SamplerState::WM\_clamp);}
\DoxyCodeLine{07099\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07100\ }
\DoxyCodeLine{07101\ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{07102\ \ \ \ \ nassertv(y\_size\ ==\ 1\ \&\&\ z\_size\ ==\ 1);}
\DoxyCodeLine{07103\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07104\ }
\DoxyCodeLine{07105\ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture\_array:}
\DoxyCodeLine{07106\ \ \ \ \ nassertv(z\_size\ ==\ 1);}
\DoxyCodeLine{07107\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07108\ \ \ \}}
\DoxyCodeLine{07109\ }
\DoxyCodeLine{07110\ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ !=\ TT\_2d\_texture)\ \{}
\DoxyCodeLine{07111\ \ \ \ \ do\_clear\_simple\_ram\_image(cdata);}
\DoxyCodeLine{07112\ \ \ \}}
\DoxyCodeLine{07113\ }
\DoxyCodeLine{07114\ \ \ cdata-\/>\_texture\_type\ =\ texture\_type;}
\DoxyCodeLine{07115\ \ \ cdata-\/>\_x\_size\ =\ x\_size;}
\DoxyCodeLine{07116\ \ \ cdata-\/>\_y\_size\ =\ y\_size;}
\DoxyCodeLine{07117\ \ \ cdata-\/>\_z\_size\ =\ z\_size;}
\DoxyCodeLine{07118\ \ \ cdata-\/>\_num\_views\ =\ 1;}
\DoxyCodeLine{07119\ \ \ do\_set\_component\_type(cdata,\ component\_type);}
\DoxyCodeLine{07120\ \ \ do\_set\_format(cdata,\ format);}
\DoxyCodeLine{07121\ }
\DoxyCodeLine{07122\ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07123\ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{07124\ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ 0;}
\DoxyCodeLine{07125\ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ 0;}
\DoxyCodeLine{07126\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{07127\ \ \ cdata-\/>\_loaded\_from\_txo\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{07128\ \ \ cdata-\/>\_has\_read\_pages\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{07129\ \ \ cdata-\/>\_has\_read\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{07130\ \}}
\DoxyCodeLine{07131\ }
\DoxyCodeLine{07135\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07136\ do\_set\_format(CData\ *cdata,\ Texture::Format\ format)\ \{}
\DoxyCodeLine{07137\ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ cdata-\/>\_format)\ \{}
\DoxyCodeLine{07138\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07139\ \ \ \}}
\DoxyCodeLine{07140\ \ \ cdata-\/>\_format\ =\ format;}
\DoxyCodeLine{07141\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07142\ }
\DoxyCodeLine{07143\ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_format)\ \{}
\DoxyCodeLine{07144\ \ \ \textcolor{keywordflow}{case}\ F\_color\_index:}
\DoxyCodeLine{07145\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_stencil:}
\DoxyCodeLine{07146\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component:}
\DoxyCodeLine{07147\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component16:}
\DoxyCodeLine{07148\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component24:}
\DoxyCodeLine{07149\ \ \ \textcolor{keywordflow}{case}\ F\_depth\_component32:}
\DoxyCodeLine{07150\ \ \ \textcolor{keywordflow}{case}\ F\_red:}
\DoxyCodeLine{07151\ \ \ \textcolor{keywordflow}{case}\ F\_green:}
\DoxyCodeLine{07152\ \ \ \textcolor{keywordflow}{case}\ F\_blue:}
\DoxyCodeLine{07153\ \ \ \textcolor{keywordflow}{case}\ F\_alpha:}
\DoxyCodeLine{07154\ \ \ \textcolor{keywordflow}{case}\ F\_luminance:}
\DoxyCodeLine{07155\ \ \ \textcolor{keywordflow}{case}\ F\_r16:}
\DoxyCodeLine{07156\ \ \ \textcolor{keywordflow}{case}\ F\_r16i:}
\DoxyCodeLine{07157\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance:}
\DoxyCodeLine{07158\ \ \ \textcolor{keywordflow}{case}\ F\_r32i:}
\DoxyCodeLine{07159\ \ \ \textcolor{keywordflow}{case}\ F\_r32:}
\DoxyCodeLine{07160\ \ \ \textcolor{keywordflow}{case}\ F\_r8i:}
\DoxyCodeLine{07161\ \ \ \ \ cdata-\/>\_num\_components\ =\ 1;}
\DoxyCodeLine{07162\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07163\ }
\DoxyCodeLine{07164\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alpha:}
\DoxyCodeLine{07165\ \ \ \textcolor{keywordflow}{case}\ F\_luminance\_alphamask:}
\DoxyCodeLine{07166\ \ \ \textcolor{keywordflow}{case}\ F\_rg16:}
\DoxyCodeLine{07167\ \ \ \textcolor{keywordflow}{case}\ F\_sluminance\_alpha:}
\DoxyCodeLine{07168\ \ \ \textcolor{keywordflow}{case}\ F\_rg32:}
\DoxyCodeLine{07169\ \ \ \textcolor{keywordflow}{case}\ F\_rg8i:}
\DoxyCodeLine{07170\ \ \ \textcolor{keywordflow}{case}\ F\_rg:}
\DoxyCodeLine{07171\ \ \ \textcolor{keywordflow}{case}\ F\_rg16i:}
\DoxyCodeLine{07172\ \ \ \textcolor{keywordflow}{case}\ F\_rg32i:}
\DoxyCodeLine{07173\ \ \ \ \ cdata-\/>\_num\_components\ =\ 2;}
\DoxyCodeLine{07174\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07175\ }
\DoxyCodeLine{07176\ \ \ \textcolor{keywordflow}{case}\ F\_rgb:}
\DoxyCodeLine{07177\ \ \ \textcolor{keywordflow}{case}\ F\_rgb5:}
\DoxyCodeLine{07178\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8:}
\DoxyCodeLine{07179\ \ \ \textcolor{keywordflow}{case}\ F\_rgb12:}
\DoxyCodeLine{07180\ \ \ \textcolor{keywordflow}{case}\ F\_rgb332:}
\DoxyCodeLine{07181\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16:}
\DoxyCodeLine{07182\ \ \ \textcolor{keywordflow}{case}\ F\_srgb:}
\DoxyCodeLine{07183\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32:}
\DoxyCodeLine{07184\ \ \ \textcolor{keywordflow}{case}\ F\_rgb8i:}
\DoxyCodeLine{07185\ \ \ \textcolor{keywordflow}{case}\ F\_r11\_g11\_b10:}
\DoxyCodeLine{07186\ \ \ \textcolor{keywordflow}{case}\ F\_rgb9\_e5:}
\DoxyCodeLine{07187\ \ \ \textcolor{keywordflow}{case}\ F\_rgb16i:}
\DoxyCodeLine{07188\ \ \ \textcolor{keywordflow}{case}\ F\_rgb32i:}
\DoxyCodeLine{07189\ \ \ \ \ cdata-\/>\_num\_components\ =\ 3;}
\DoxyCodeLine{07190\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07191\ }
\DoxyCodeLine{07192\ \ \ \textcolor{keywordflow}{case}\ F\_rgba:}
\DoxyCodeLine{07193\ \ \ \textcolor{keywordflow}{case}\ F\_rgbm:}
\DoxyCodeLine{07194\ \ \ \textcolor{keywordflow}{case}\ F\_rgba4:}
\DoxyCodeLine{07195\ \ \ \textcolor{keywordflow}{case}\ F\_rgba5:}
\DoxyCodeLine{07196\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8:}
\DoxyCodeLine{07197\ \ \ \textcolor{keywordflow}{case}\ F\_rgba12:}
\DoxyCodeLine{07198\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16:}
\DoxyCodeLine{07199\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32:}
\DoxyCodeLine{07200\ \ \ \textcolor{keywordflow}{case}\ F\_srgb\_alpha:}
\DoxyCodeLine{07201\ \ \ \textcolor{keywordflow}{case}\ F\_rgba8i:}
\DoxyCodeLine{07202\ \ \ \textcolor{keywordflow}{case}\ F\_rgb10\_a2:}
\DoxyCodeLine{07203\ \ \ \textcolor{keywordflow}{case}\ F\_rgba16i:}
\DoxyCodeLine{07204\ \ \ \textcolor{keywordflow}{case}\ F\_rgba32i:}
\DoxyCodeLine{07205\ \ \ \ \ cdata-\/>\_num\_components\ =\ 4;}
\DoxyCodeLine{07206\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07207\ \ \ \}}
\DoxyCodeLine{07208\ \}}
\DoxyCodeLine{07209\ }
\DoxyCodeLine{07213\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07214\ do\_set\_component\_type(CData\ *cdata,\ Texture::ComponentType\ component\_type)\ \{}
\DoxyCodeLine{07215\ \ \ cdata-\/>\_component\_type\ =\ component\_type;}
\DoxyCodeLine{07216\ }
\DoxyCodeLine{07217\ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{07218\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{07219\ \ \ \textcolor{keywordflow}{case}\ T\_byte:}
\DoxyCodeLine{07220\ \ \ \ \ cdata-\/>\_component\_width\ =\ 1;}
\DoxyCodeLine{07221\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07222\ }
\DoxyCodeLine{07223\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{07224\ \ \ \textcolor{keywordflow}{case}\ T\_short:}
\DoxyCodeLine{07225\ \ \ \textcolor{keywordflow}{case}\ T\_half\_float:}
\DoxyCodeLine{07226\ \ \ \ \ cdata-\/>\_component\_width\ =\ 2;}
\DoxyCodeLine{07227\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07228\ }
\DoxyCodeLine{07229\ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{07230\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int\_24\_8:}
\DoxyCodeLine{07231\ \ \ \textcolor{keywordflow}{case}\ T\_int:}
\DoxyCodeLine{07232\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int:}
\DoxyCodeLine{07233\ \ \ \ \ cdata-\/>\_component\_width\ =\ 4;}
\DoxyCodeLine{07234\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{07235\ \ \ \}}
\DoxyCodeLine{07236\ \}}
\DoxyCodeLine{07237\ }
\DoxyCodeLine{07241\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07242\ do\_set\_x\_size(CData\ *cdata,\ \textcolor{keywordtype}{int}\ x\_size)\ \{}
\DoxyCodeLine{07243\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_x\_size\ !=\ x\_size)\ \{}
\DoxyCodeLine{07244\ \ \ \ \ cdata-\/>\_x\_size\ =\ x\_size;}
\DoxyCodeLine{07245\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07246\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07247\ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{07248\ \ \ \}}
\DoxyCodeLine{07249\ \}}
\DoxyCodeLine{07250\ }
\DoxyCodeLine{07254\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07255\ do\_set\_y\_size(CData\ *cdata,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{07256\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_y\_size\ !=\ y\_size)\ \{}
\DoxyCodeLine{07257\ \ \ \ \ nassertv((cdata-\/>\_texture\_type\ !=\ Texture::TT\_buffer\_texture\ \&\&}
\DoxyCodeLine{07258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_texture\_type\ !=\ Texture::TT\_1d\_texture)\ ||\ y\_size\ ==\ 1);}
\DoxyCodeLine{07259\ \ \ \ \ cdata-\/>\_y\_size\ =\ y\_size;}
\DoxyCodeLine{07260\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07261\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07262\ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{07263\ \ \ \}}
\DoxyCodeLine{07264\ \}}
\DoxyCodeLine{07265\ }
\DoxyCodeLine{07270\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{Texture::}}}
\DoxyCodeLine{07271\ \mbox{\hyperlink{classTexture_ab48d2679fa6248f3ca3030d150331bdb}{do\_set\_z\_size}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{int}\ z\_size)\ \{}
\DoxyCodeLine{07272\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_z\_size\ !=\ z\_size)\ \{}
\DoxyCodeLine{07273\ \ \ \ \ nassertv((cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture)\ ||}
\DoxyCodeLine{07274\ \ \ \ \ \ \ \ \ \ \ \ \ \ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_cube\_map\ \&\&\ z\_size\ ==\ 6)\ ||}
\DoxyCodeLine{07275\ \ \ \ \ \ \ \ \ \ \ \ \ \ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_cube\_map\_array\ \&\&\ z\_size\ \%\ 6\ ==\ 0)\ ||}
\DoxyCodeLine{07276\ \ \ \ \ \ \ \ \ \ \ \ \ \ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_2d\_texture\_array)\ ||\ (z\_size\ ==\ 1));}
\DoxyCodeLine{07277\ \ \ \ \ cdata-\/>\_z\_size\ =\ z\_size;}
\DoxyCodeLine{07278\ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07279\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07280\ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{07281\ \ \ \}}
\DoxyCodeLine{07282\ \}}
\DoxyCodeLine{07283\ }
\DoxyCodeLine{07287\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07288\ do\_set\_num\_views(CData\ *cdata,\ \textcolor{keywordtype}{int}\ num\_views)\ \{}
\DoxyCodeLine{07289\ \ \ nassertv(num\_views\ >=\ 1);}
\DoxyCodeLine{07290\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_num\_views\ !=\ num\_views)\ \{}
\DoxyCodeLine{07291\ \ \ \ \ cdata-\/>\_num\_views\ =\ num\_views;}
\DoxyCodeLine{07292\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{07293\ \ \ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07294\ \ \ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07295\ \ \ \ \ \}}
\DoxyCodeLine{07296\ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{07297\ \ \ \}}
\DoxyCodeLine{07298\ \}}
\DoxyCodeLine{07299\ }
\DoxyCodeLine{07303\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07304\ do\_set\_wrap\_u(CData\ *cdata,\ SamplerState::WrapMode\ wrap)\ \{}
\DoxyCodeLine{07305\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_wrap\_u()\ !=\ wrap)\ \{}
\DoxyCodeLine{07306\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07307\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_u(wrap);}
\DoxyCodeLine{07308\ \ \ \}}
\DoxyCodeLine{07309\ \}}
\DoxyCodeLine{07310\ }
\DoxyCodeLine{07314\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07315\ do\_set\_wrap\_v(CData\ *cdata,\ SamplerState::WrapMode\ wrap)\ \{}
\DoxyCodeLine{07316\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_wrap\_v()\ !=\ wrap)\ \{}
\DoxyCodeLine{07317\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07318\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_v(wrap);}
\DoxyCodeLine{07319\ \ \ \}}
\DoxyCodeLine{07320\ \}}
\DoxyCodeLine{07321\ }
\DoxyCodeLine{07325\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07326\ do\_set\_wrap\_w(CData\ *cdata,\ SamplerState::WrapMode\ wrap)\ \{}
\DoxyCodeLine{07327\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_wrap\_w()\ !=\ wrap)\ \{}
\DoxyCodeLine{07328\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07329\ \ \ \ \ cdata-\/>\_default\_sampler.set\_wrap\_w(wrap);}
\DoxyCodeLine{07330\ \ \ \}}
\DoxyCodeLine{07331\ \}}
\DoxyCodeLine{07332\ }
\DoxyCodeLine{07336\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07337\ do\_set\_minfilter(CData\ *cdata,\ SamplerState::FilterType\ filter)\ \{}
\DoxyCodeLine{07338\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_minfilter()\ !=\ filter)\ \{}
\DoxyCodeLine{07339\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07340\ \ \ \ \ cdata-\/>\_default\_sampler.set\_minfilter(filter);}
\DoxyCodeLine{07341\ \ \ \}}
\DoxyCodeLine{07342\ \}}
\DoxyCodeLine{07343\ }
\DoxyCodeLine{07347\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07348\ do\_set\_magfilter(CData\ *cdata,\ SamplerState::FilterType\ filter)\ \{}
\DoxyCodeLine{07349\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_magfilter()\ !=\ filter)\ \{}
\DoxyCodeLine{07350\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07351\ \ \ \ \ cdata-\/>\_default\_sampler.set\_magfilter(filter);}
\DoxyCodeLine{07352\ \ \ \}}
\DoxyCodeLine{07353\ \}}
\DoxyCodeLine{07354\ }
\DoxyCodeLine{07358\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07359\ do\_set\_anisotropic\_degree(CData\ *cdata,\ \textcolor{keywordtype}{int}\ anisotropic\_degree)\ \{}
\DoxyCodeLine{07360\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_anisotropic\_degree()\ !=\ anisotropic\_degree)\ \{}
\DoxyCodeLine{07361\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07362\ \ \ \ \ cdata-\/>\_default\_sampler.set\_anisotropic\_degree(anisotropic\_degree);}
\DoxyCodeLine{07363\ \ \ \}}
\DoxyCodeLine{07364\ \}}
\DoxyCodeLine{07365\ }
\DoxyCodeLine{07369\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07370\ do\_set\_border\_color(CData\ *cdata,\ \textcolor{keyword}{const}\ LColor\ \&\mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{07371\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_default\_sampler.get\_border\_color()\ !=\ \mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{07372\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07373\ \ \ \ \ cdata-\/>\_default\_sampler.set\_border\_color(\mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{07374\ \ \ \}}
\DoxyCodeLine{07375\ \}}
\DoxyCodeLine{07376\ }
\DoxyCodeLine{07380\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07381\ do\_set\_compression(CData\ *cdata,\ Texture::CompressionMode\ compression)\ \{}
\DoxyCodeLine{07382\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_compression\ !=\ compression)\ \{}
\DoxyCodeLine{07383\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07384\ \ \ \ \ cdata-\/>\_compression\ =\ compression;}
\DoxyCodeLine{07385\ }
\DoxyCodeLine{07386\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{07387\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_compression\ =\ do\_has\_compression(cdata);}
\DoxyCodeLine{07388\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_ram\_image\_compression\ =\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off);}
\DoxyCodeLine{07389\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_compression\ !=\ has\_ram\_image\_compression\ ||}
\DoxyCodeLine{07390\ \ \ \ \ \ \ \ \ \ \ has\_compression)\ \{}
\DoxyCodeLine{07391\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Reload\ if\ we're\ turning\ compression\ on\ or\ off,\ or\ if\ we're\ changing}}
\DoxyCodeLine{07392\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ compression\ mode\ to\ a\ different\ kind\ of\ compression.}}
\DoxyCodeLine{07393\ \ \ \ \ \ \ \ \ do\_reload(cdata);}
\DoxyCodeLine{07394\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07395\ \ \ \ \ \}}
\DoxyCodeLine{07396\ \ \ \}}
\DoxyCodeLine{07397\ \}}
\DoxyCodeLine{07398\ }
\DoxyCodeLine{07402\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07403\ do\_set\_quality\_level(CData\ *cdata,\ Texture::QualityLevel\ quality\_level)\ \{}
\DoxyCodeLine{07404\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_quality\_level\ !=\ quality\_level)\ \{}
\DoxyCodeLine{07405\ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07406\ \ \ \ \ cdata-\/>\_quality\_level\ =\ quality\_level;}
\DoxyCodeLine{07407\ \ \ \}}
\DoxyCodeLine{07408\ \}}
\DoxyCodeLine{07409\ }
\DoxyCodeLine{07413\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{07414\ do\_has\_compression(\textcolor{keyword}{const}\ CData\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07415\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_compression\ ==\ CM\_default)\ \{}
\DoxyCodeLine{07416\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ !=\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{07417\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ compressed\_textures;}
\DoxyCodeLine{07418\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07419\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07420\ \ \ \ \ \}}
\DoxyCodeLine{07421\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07422\ \ \ \ \ \textcolor{keywordflow}{return}\ (cdata-\/>\_compression\ !=\ CM\_off);}
\DoxyCodeLine{07423\ \ \ \}}
\DoxyCodeLine{07424\ \}}
\DoxyCodeLine{07425\ }
\DoxyCodeLine{07430\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{Texture::}}}
\DoxyCodeLine{07431\ \mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07432\ \ \ \textcolor{keywordflow}{return}\ !cdata-\/>\_ram\_images.empty()\ \&\&\ !cdata-\/>\_ram\_images[0].\_image.empty();}
\DoxyCodeLine{07433\ \}}
\DoxyCodeLine{07434\ }
\DoxyCodeLine{07439\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_a7c7c40f83f66e298526a13a4aa6e0e42}{Texture::}}}
\DoxyCodeLine{07440\ \mbox{\hyperlink{classTexture_a7c7c40f83f66e298526a13a4aa6e0e42}{do\_has\_uncompressed\_ram\_image}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07441\ \ \ \textcolor{keywordflow}{return}\ !cdata-\/>\_ram\_images.empty()\ \&\&\ !cdata-\/>\_ram\_images[0].\_image.empty()\ \&\&\ cdata-\/>\_ram\_image\_compression\ ==\ CM\_off;}
\DoxyCodeLine{07442\ \}}
\DoxyCodeLine{07443\ }
\DoxyCodeLine{07447\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ Texture::}
\DoxyCodeLine{07448\ do\_get\_ram\_image(CData\ *cdata)\ \{}
\DoxyCodeLine{07449\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata)\ \&\&\ \mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(cdata))\ \{}
\DoxyCodeLine{07450\ \ \ \ \ \mbox{\hyperlink{classTexture_ac03cc54614e018515f4ce9f05da89ec1}{do\_reload\_ram\_image}}(cdata,\ \textcolor{keyword}{true});}
\DoxyCodeLine{07451\ }
\DoxyCodeLine{07452\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{07453\ \ \ \ \ \ \ \textcolor{comment}{//\ Normally,\ we\ don't\ update\ the\ cdata-\/>\_modified\ semaphores\ in\ a}}
\DoxyCodeLine{07454\ \ \ \ \ \ \ \textcolor{comment}{//\ do\_blah\ method,\ but\ we'll\ make\ an\ exception\ in\ this\ case,\ because}}
\DoxyCodeLine{07455\ \ \ \ \ \ \ \textcolor{comment}{//\ it's\ easiest\ to\ modify\ these\ here,\ and\ only\ when\ we\ know\ it's\ needed.}}
\DoxyCodeLine{07456\ \ \ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07457\ \ \ \ \ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{07458\ \ \ \ \ \}}
\DoxyCodeLine{07459\ \ \ \}}
\DoxyCodeLine{07460\ }
\DoxyCodeLine{07461\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty())\ \{}
\DoxyCodeLine{07462\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type());}
\DoxyCodeLine{07463\ \ \ \}}
\DoxyCodeLine{07464\ }
\DoxyCodeLine{07465\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{07466\ \}}
\DoxyCodeLine{07467\ }
\DoxyCodeLine{07471\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ Texture::}
\DoxyCodeLine{07472\ do\_get\_uncompressed\_ram\_image(CData\ *cdata)\ \{}
\DoxyCodeLine{07473\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_ram\_images.empty()\ \&\&\ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07474\ \ \ \ \ \textcolor{comment}{//\ We\ have\ an\ image\ in-\/ram,\ but\ it's\ compressed.\ \ Try\ to\ uncompress\ it}}
\DoxyCodeLine{07475\ \ \ \ \ \textcolor{comment}{//\ first.}}
\DoxyCodeLine{07476\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_uncompress\_ram\_image(cdata))\ \{}
\DoxyCodeLine{07477\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{07478\ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{07479\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Uncompressed\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07480\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07481\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{07482\ \ \ \ \ \}}
\DoxyCodeLine{07483\ \ \ \}}
\DoxyCodeLine{07484\ }
\DoxyCodeLine{07485\ \ \ \textcolor{comment}{//\ Couldn't\ uncompress\ the\ existing\ image.\ \ Try\ to\ reload\ it.}}
\DoxyCodeLine{07486\ \ \ \textcolor{keywordflow}{if}\ ((!\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata)\ ||\ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \&\&\ \mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(cdata))\ \{}
\DoxyCodeLine{07487\ \ \ \ \ \mbox{\hyperlink{classTexture_ac03cc54614e018515f4ce9f05da89ec1}{do\_reload\_ram\_image}}(cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07488\ \ \ \}}
\DoxyCodeLine{07489\ }
\DoxyCodeLine{07490\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_ram\_images.empty()\ \&\&\ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07491\ \ \ \ \ \textcolor{comment}{//\ Great,\ now\ we\ have\ an\ image.}}
\DoxyCodeLine{07492\ \ \ \ \ \textcolor{keywordflow}{if}\ (do\_uncompress\_ram\_image(cdata))\ \{}
\DoxyCodeLine{07493\ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{07494\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Uncompressed\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07495\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{07496\ \ \ \ \ \}}
\DoxyCodeLine{07497\ \ \ \}}
\DoxyCodeLine{07498\ }
\DoxyCodeLine{07499\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ ||\ cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07500\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type());}
\DoxyCodeLine{07501\ \ \ \}}
\DoxyCodeLine{07502\ }
\DoxyCodeLine{07503\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[0].\_image;}
\DoxyCodeLine{07504\ \}}
\DoxyCodeLine{07505\ }
\DoxyCodeLine{07529\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ \mbox{\hyperlink{classTexture_a071e8fca271b007efa2a2757319ec0c1}{Texture::}}}
\DoxyCodeLine{07530\ \mbox{\hyperlink{classTexture_a071e8fca271b007efa2a2757319ec0c1}{get\_ram\_image\_as}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&requested\_format)\ \{}
\DoxyCodeLine{07531\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07532\ \ \ \textcolor{keywordtype}{string}\ format\ =\ \mbox{\hyperlink{string__utils_8cxx_a19a4ce633f8fa083313af82a9c1d3189}{upcase}}(requested\_format);}
\DoxyCodeLine{07533\ }
\DoxyCodeLine{07534\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ can\ grab\ something\ that's\ uncompressed.}}
\DoxyCodeLine{07535\ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ data\ =\ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{07536\ \ \ \textcolor{keywordflow}{if}\ (data\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07537\ \ \ \ \ gobj\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Couldn't\ find\ an\ uncompressed\ RAM\ image!\(\backslash\)n"{}};}
\DoxyCodeLine{07538\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type());}
\DoxyCodeLine{07539\ \ \ \}}
\DoxyCodeLine{07540\ \ \ \textcolor{keywordtype}{size\_t}\ imgsize\ =\ (size\_t)cdata-\/>\_x\_size\ *\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_y\_size\ *}
\DoxyCodeLine{07541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (size\_t)cdata-\/>\_z\_size\ *\ (\textcolor{keywordtype}{size\_t})cdata-\/>\_num\_views;}
\DoxyCodeLine{07542\ \ \ nassertr(cdata-\/>\_num\_components\ >\ 0\ \&\&\ cdata-\/>\_num\_components\ <=\ 4,\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type()));}
\DoxyCodeLine{07543\ \ \ nassertr(data.size()\ ==\ (\textcolor{keywordtype}{size\_t})(cdata-\/>\_component\_width\ *\ cdata-\/>\_num\_components\ *\ imgsize),\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type()));}
\DoxyCodeLine{07544\ }
\DoxyCodeLine{07545\ \ \ \textcolor{comment}{//\ Check\ if\ the\ format\ is\ already\ what\ we\ have\ internally.}}
\DoxyCodeLine{07546\ \ \ \textcolor{keywordflow}{if}\ ((cdata-\/>\_num\_components\ ==\ 1\ \&\&\ format.size()\ ==\ 1)\ ||}
\DoxyCodeLine{07547\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 2\ \&\&\ format.size()\ ==\ 2\ \&\&\ format.at(1)\ ==\ \textcolor{charliteral}{'A'}\ \&\&\ format.at(0)\ !=\ \textcolor{charliteral}{'A'})\ ||}
\DoxyCodeLine{07548\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 3\ \&\&\ format\ ==\ \textcolor{stringliteral}{"{}BGR"{}})\ ||}
\DoxyCodeLine{07549\ \ \ \ \ \ \ (cdata-\/>\_num\_components\ ==\ 4\ \&\&\ format\ ==\ \textcolor{stringliteral}{"{}BGRA"{}}))\ \{}
\DoxyCodeLine{07550\ \ \ \ \ \textcolor{comment}{//\ The\ format\ string\ is\ already\ our\ format,\ so\ we\ just\ need\ to\ copy\ it.}}
\DoxyCodeLine{07551\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(data);}
\DoxyCodeLine{07552\ \ \ \}}
\DoxyCodeLine{07553\ }
\DoxyCodeLine{07554\ \ \ \textcolor{comment}{//\ Check\ if\ we\ have\ an\ alpha\ channel,\ and\ remember\ which\ channel\ we\ use.}}
\DoxyCodeLine{07555\ \ \ \textcolor{keywordtype}{int}\ alpha\ =\ -\/1;}
\DoxyCodeLine{07556\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(cdata-\/>\_format))\ \{}
\DoxyCodeLine{07557\ \ \ \ \ alpha\ =\ cdata-\/>\_num\_components\ -\/\ 1;}
\DoxyCodeLine{07558\ \ \ \}}
\DoxyCodeLine{07559\ }
\DoxyCodeLine{07560\ \ \ \textcolor{comment}{//\ Validate\ the\ format\ beforehand.}}
\DoxyCodeLine{07561\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ format.size();\ ++i)\ \{}
\DoxyCodeLine{07562\ \ \ \ \ \textcolor{keywordflow}{if}\ (format[i]\ !=\ \textcolor{charliteral}{'B'}\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'G'}\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'R'}\ \&\&}
\DoxyCodeLine{07563\ \ \ \ \ \ \ \ \ format[i]\ !=\ \textcolor{charliteral}{'A'}\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'0'}\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'1'})\ \{}
\DoxyCodeLine{07564\ \ \ \ \ \ \ gobj\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unexpected\ component\ character\ '"{}}}
\DoxyCodeLine{07565\ \ \ \ \ \ \ \ \ <<\ format[i]\ <<\ \textcolor{stringliteral}{"{}',\ expected\ one\ of\ RGBA01!\(\backslash\)n"{}};}
\DoxyCodeLine{07566\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}(get\_class\_type());}
\DoxyCodeLine{07567\ \ \ \ \ \}}
\DoxyCodeLine{07568\ \ \ \}}
\DoxyCodeLine{07569\ }
\DoxyCodeLine{07570\ \ \ \textcolor{comment}{//\ Create\ a\ new\ empty\ array\ that\ can\ hold\ our\ image.}}
\DoxyCodeLine{07571\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ newdata\ =\ PTA\_uchar::empty\_array(imgsize\ *\ format.size()\ *\ cdata-\/>\_component\_width,\ get\_class\_type());}
\DoxyCodeLine{07572\ }
\DoxyCodeLine{07573\ \ \ \textcolor{comment}{//\ These\ ifs\ are\ for\ optimization\ of\ commonly\ used\ image\ types.}}
\DoxyCodeLine{07574\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{07575\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}RGBA"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 4)\ \{}
\DoxyCodeLine{07576\ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ *src\ =\ (\textcolor{keyword}{const}\ uint32\_t\ *)data.p();}
\DoxyCodeLine{07577\ \ \ \ \ \ \ uint32\_t\ *dst\ =\ (uint32\_t\ *)newdata.p();}
\DoxyCodeLine{07578\ }
\DoxyCodeLine{07579\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{07580\ \ \ \ \ \ \ \ \ uint32\_t\ v\ =\ *src++;}
\DoxyCodeLine{07581\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v\ \&\ 0xff00ff00u))\ |}
\DoxyCodeLine{07582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v\ \&\ 0x00ff0000u)\ >>\ 16)\ |}
\DoxyCodeLine{07583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v\ \&\ 0x000000ffu)\ <<\ 16);}
\DoxyCodeLine{07584\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07585\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07586\ \ \ \ \ \}}
\DoxyCodeLine{07587\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}RGB"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 4)\ \{}
\DoxyCodeLine{07588\ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ *src\ =\ (\textcolor{keyword}{const}\ uint32\_t\ *)data.p();}
\DoxyCodeLine{07589\ \ \ \ \ \ \ uint32\_t\ *dst\ =\ (uint32\_t\ *)newdata.p();}
\DoxyCodeLine{07590\ }
\DoxyCodeLine{07591\ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ blocks\ of\ 4\ pixels\ at\ a\ time,\ so\ that\ we\ can\ treat\ both\ the}}
\DoxyCodeLine{07592\ \ \ \ \ \ \ \textcolor{comment}{//\ source\ and\ destination\ as\ 32-\/bit\ integers.}}
\DoxyCodeLine{07593\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ blocks\ =\ imgsize\ >>\ 2;}
\DoxyCodeLine{07594\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ blocks;\ ++i)\ \{}
\DoxyCodeLine{07595\ \ \ \ \ \ \ \ \ uint32\_t\ v0\ =\ *src++;}
\DoxyCodeLine{07596\ \ \ \ \ \ \ \ \ uint32\_t\ v1\ =\ *src++;}
\DoxyCodeLine{07597\ \ \ \ \ \ \ \ \ uint32\_t\ v2\ =\ *src++;}
\DoxyCodeLine{07598\ \ \ \ \ \ \ \ \ uint32\_t\ v3\ =\ *src++;}
\DoxyCodeLine{07599\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v0\ \&\ 0x00ff0000u)\ >>\ 16)\ |}
\DoxyCodeLine{07600\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v0\ \&\ 0x0000ff00u))\ |}
\DoxyCodeLine{07601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v0\ \&\ 0x000000ffu)\ <<\ 16)\ |}
\DoxyCodeLine{07602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v1\ \&\ 0x00ff0000u)\ <<\ 8);}
\DoxyCodeLine{07603\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v1\ \&\ 0x0000ff00u)\ >>\ 8)\ |}
\DoxyCodeLine{07604\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v1\ \&\ 0x000000ffu)\ <<\ 8)\ |}
\DoxyCodeLine{07605\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v2\ \&\ 0x00ff0000u))\ |}
\DoxyCodeLine{07606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v2\ \&\ 0x0000ff00u)\ <<\ 16);}
\DoxyCodeLine{07607\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v2\ \&\ 0x000000ffu))\ |}
\DoxyCodeLine{07608\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v3\ \&\ 0x00ff0000u)\ >>\ 8)\ |}
\DoxyCodeLine{07609\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v3\ \&\ 0x0000ff00u)\ <<\ 8)\ |}
\DoxyCodeLine{07610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ((v3\ \&\ 0x000000ffu)\ <<\ 24);}
\DoxyCodeLine{07611\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07612\ }
\DoxyCodeLine{07613\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ image\ size\ wasn't\ a\ multiple\ of\ 4,\ we\ may\ have\ a\ handful\ of}}
\DoxyCodeLine{07614\ \ \ \ \ \ \ \textcolor{comment}{//\ pixels\ left\ over.\ \ Convert\ those\ the\ slower\ way.}}
\DoxyCodeLine{07615\ \ \ \ \ \ \ uint8\_t\ *tail\ =\ (uint8\_t\ *)dst;}
\DoxyCodeLine{07616\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ (imgsize\ \&\ \string~0x3);\ i\ <\ imgsize;\ ++i)\ \{}
\DoxyCodeLine{07617\ \ \ \ \ \ \ \ \ uint32\_t\ v\ =\ *src++;}
\DoxyCodeLine{07618\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x00ff0000u)\ >>\ 16;}
\DoxyCodeLine{07619\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x0000ff00u)\ >>\ 8;}
\DoxyCodeLine{07620\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x000000ffu);}
\DoxyCodeLine{07621\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07622\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07623\ \ \ \ \ \}}
\DoxyCodeLine{07624\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}BGR"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 4)\ \{}
\DoxyCodeLine{07625\ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ *src\ =\ (\textcolor{keyword}{const}\ uint32\_t\ *)data.p();}
\DoxyCodeLine{07626\ \ \ \ \ \ \ uint32\_t\ *dst\ =\ (uint32\_t\ *)newdata.p();}
\DoxyCodeLine{07627\ }
\DoxyCodeLine{07628\ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ blocks\ of\ 4\ pixels\ at\ a\ time,\ so\ that\ we\ can\ treat\ both\ the}}
\DoxyCodeLine{07629\ \ \ \ \ \ \ \textcolor{comment}{//\ source\ and\ destination\ as\ 32-\/bit\ integers.}}
\DoxyCodeLine{07630\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ blocks\ =\ imgsize\ >>\ 2;}
\DoxyCodeLine{07631\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ blocks;\ ++i)\ \{}
\DoxyCodeLine{07632\ \ \ \ \ \ \ \ \ uint32\_t\ v0\ =\ *src++;}
\DoxyCodeLine{07633\ \ \ \ \ \ \ \ \ uint32\_t\ v1\ =\ *src++;}
\DoxyCodeLine{07634\ \ \ \ \ \ \ \ \ uint32\_t\ v2\ =\ *src++;}
\DoxyCodeLine{07635\ \ \ \ \ \ \ \ \ uint32\_t\ v3\ =\ *src++;}
\DoxyCodeLine{07636\ \ \ \ \ \ \ \ \ *dst++\ =\ (v0\ \&\ 0x00ffffffu)\ |\ ((v1\ \&\ 0x000000ffu)\ <<\ 24);}
\DoxyCodeLine{07637\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v1\ \&\ 0x00ffff00u)\ >>\ 8)\ |\ \ ((v2\ \&\ 0x0000ffffu)\ <<\ 16);}
\DoxyCodeLine{07638\ \ \ \ \ \ \ \ \ *dst++\ =\ ((v2\ \&\ 0x00ff0000u)\ >>\ 16)\ |\ ((v3\ \&\ 0x00ffffffu)\ <<\ 8);}
\DoxyCodeLine{07639\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07640\ }
\DoxyCodeLine{07641\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ image\ size\ wasn't\ a\ multiple\ of\ 4,\ we\ may\ have\ a\ handful\ of}}
\DoxyCodeLine{07642\ \ \ \ \ \ \ \textcolor{comment}{//\ pixels\ left\ over.\ \ Convert\ those\ the\ slower\ way.}}
\DoxyCodeLine{07643\ \ \ \ \ \ \ uint8\_t\ *tail\ =\ (uint8\_t\ *)dst;}
\DoxyCodeLine{07644\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ (imgsize\ \&\ \string~0x3);\ i\ <\ imgsize;\ ++i)\ \{}
\DoxyCodeLine{07645\ \ \ \ \ \ \ \ \ uint32\_t\ v\ =\ *src++;}
\DoxyCodeLine{07646\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x000000ffu);}
\DoxyCodeLine{07647\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x0000ff00u)\ >>\ 8;}
\DoxyCodeLine{07648\ \ \ \ \ \ \ \ \ *tail++\ =\ (v\ \&\ 0x00ff0000u)\ >>\ 16;}
\DoxyCodeLine{07649\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07650\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07651\ \ \ \ \ \}}
\DoxyCodeLine{07652\ \ \ \ \ \textcolor{keyword}{const}\ uint8\_t\ *src\ =\ (\textcolor{keyword}{const}\ uint8\_t\ *)data.p();}
\DoxyCodeLine{07653\ \ \ \ \ uint8\_t\ *dst\ =\ (uint8\_t\ *)newdata.p();}
\DoxyCodeLine{07654\ }
\DoxyCodeLine{07655\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}RGB"{}}\ \&\&\ cdata-\/>\_num\_components\ ==\ 3)\ \{}
\DoxyCodeLine{07656\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ imgsize;\ ++i)\ \{}
\DoxyCodeLine{07657\ \ \ \ \ \ \ \ \ *dst++\ =\ src[2];}
\DoxyCodeLine{07658\ \ \ \ \ \ \ \ \ *dst++\ =\ src[1];}
\DoxyCodeLine{07659\ \ \ \ \ \ \ \ \ *dst++\ =\ src[0];}
\DoxyCodeLine{07660\ \ \ \ \ \ \ \ \ src\ +=\ 3;}
\DoxyCodeLine{07661\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07662\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07663\ \ \ \ \ \}}
\DoxyCodeLine{07664\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ \textcolor{stringliteral}{"{}A"{}}\ \&\&\ cdata-\/>\_num\_components\ !=\ 3)\ \{}
\DoxyCodeLine{07665\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can\ generally\ rely\ on\ alpha\ to\ be\ the\ last\ component.}}
\DoxyCodeLine{07666\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{07667\ \ \ \ \ \ \ \ \ dst[p]\ =\ src[alpha];}
\DoxyCodeLine{07668\ \ \ \ \ \ \ \ \ src\ +=\ cdata-\/>\_num\_components;}
\DoxyCodeLine{07669\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07670\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07671\ \ \ \ \ \}}
\DoxyCodeLine{07672\ \ \ \ \ \textcolor{comment}{//\ Fallback\ case\ for\ other\ 8-\/bit-\/per-\/channel\ formats.}}
\DoxyCodeLine{07673\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{07674\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ format.size();\ ++i)\ \{}
\DoxyCodeLine{07675\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'B'}\ ||\ (cdata-\/>\_num\_components\ <=\ 2\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'A'}))\ \{}
\DoxyCodeLine{07676\ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ src[0];}
\DoxyCodeLine{07677\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'G'})\ \{}
\DoxyCodeLine{07678\ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ src[1];}
\DoxyCodeLine{07679\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'R'})\ \{}
\DoxyCodeLine{07680\ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ src[2];}
\DoxyCodeLine{07681\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'A'})\ \{}
\DoxyCodeLine{07682\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\ >=\ 0)\ \{}
\DoxyCodeLine{07683\ \ \ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ src[alpha];}
\DoxyCodeLine{07684\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07685\ \ \ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ 0xff;}
\DoxyCodeLine{07686\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{07687\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'1'})\ \{}
\DoxyCodeLine{07688\ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ 0xff;}
\DoxyCodeLine{07689\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07690\ \ \ \ \ \ \ \ \ \ \ *dst++\ =\ 0x00;}
\DoxyCodeLine{07691\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{07692\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07693\ \ \ \ \ \ \ src\ +=\ cdata-\/>\_num\_components;}
\DoxyCodeLine{07694\ \ \ \ \ \}}
\DoxyCodeLine{07695\ \ \ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07696\ \ \ \}}
\DoxyCodeLine{07697\ }
\DoxyCodeLine{07698\ \ \ \textcolor{comment}{//\ The\ slow\ and\ general\ case.}}
\DoxyCodeLine{07699\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ p\ =\ 0;\ p\ <\ imgsize;\ ++p)\ \{}
\DoxyCodeLine{07700\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ format.size();\ ++i)\ \{}
\DoxyCodeLine{07701\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ component\ =\ 0;}
\DoxyCodeLine{07702\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'B'}\ ||\ (cdata-\/>\_num\_components\ <=\ 2\ \&\&\ format[i]\ !=\ \textcolor{charliteral}{'A'}))\ \{}
\DoxyCodeLine{07703\ \ \ \ \ \ \ \ \ component\ =\ 0;}
\DoxyCodeLine{07704\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'G'})\ \{}
\DoxyCodeLine{07705\ \ \ \ \ \ \ \ \ component\ =\ 1;}
\DoxyCodeLine{07706\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'R'})\ \{}
\DoxyCodeLine{07707\ \ \ \ \ \ \ \ \ component\ =\ 2;}
\DoxyCodeLine{07708\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'A'})\ \{}
\DoxyCodeLine{07709\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\ >=\ 0)\ \{}
\DoxyCodeLine{07710\ \ \ \ \ \ \ \ \ \ \ component\ =\ alpha;}
\DoxyCodeLine{07711\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07712\ \ \ \ \ \ \ \ \ \ \ memset((\textcolor{keywordtype}{void}*)(newdata\ +\ (p\ *\ format.size()\ +\ i)\ *\ cdata-\/>\_component\_width),\ -\/1,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{07713\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{07714\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{07715\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format[i]\ ==\ \textcolor{charliteral}{'1'})\ \{}
\DoxyCodeLine{07716\ \ \ \ \ \ \ \ \ memset((\textcolor{keywordtype}{void}*)(newdata\ +\ (p\ *\ format.size()\ +\ i)\ *\ cdata-\/>\_component\_width),\ -\/1,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{07717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{07718\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07719\ \ \ \ \ \ \ \ \ memset((\textcolor{keywordtype}{void}*)(newdata\ +\ (p\ *\ format.size()\ +\ i)\ *\ cdata-\/>\_component\_width),\ \ 0,\ cdata-\/>\_component\_width);}
\DoxyCodeLine{07720\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{07721\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07722\ \ \ \ \ \ \ memcpy((\textcolor{keywordtype}{void}*)(newdata\ +\ (p\ *\ format.size()\ +\ i)\ *\ cdata-\/>\_component\_width),}
\DoxyCodeLine{07723\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}*)(data\ +\ (p\ *\ cdata-\/>\_num\_components\ +\ component)\ *\ cdata-\/>\_component\_width),}
\DoxyCodeLine{07724\ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_component\_width);}
\DoxyCodeLine{07725\ \ \ \ \ \}}
\DoxyCodeLine{07726\ \ \ \}}
\DoxyCodeLine{07727\ \ \ \textcolor{keywordflow}{return}\ newdata;}
\DoxyCodeLine{07728\ \}}
\DoxyCodeLine{07729\ }
\DoxyCodeLine{07733\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07734\ do\_set\_simple\_ram\_image(CData\ *cdata,\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{07735\ \ \ nassertv(cdata-\/>\_texture\_type\ ==\ TT\_2d\_texture);}
\DoxyCodeLine{07736\ \ \ \textcolor{keywordtype}{size\_t}\ expected\_page\_size\ =\ (size\_t)(x\_size\ *\ y\_size\ *\ 4);}
\DoxyCodeLine{07737\ \ \ nassertv(image.size()\ ==\ expected\_page\_size);}
\DoxyCodeLine{07738\ }
\DoxyCodeLine{07739\ \ \ cdata-\/>\_simple\_x\_size\ =\ x\_size;}
\DoxyCodeLine{07740\ \ \ cdata-\/>\_simple\_y\_size\ =\ y\_size;}
\DoxyCodeLine{07741\ \ \ cdata-\/>\_simple\_ram\_image.\_image\ =\ image.cast\_non\_const();}
\DoxyCodeLine{07742\ \ \ cdata-\/>\_simple\_ram\_image.\_page\_size\ =\ image.size();}
\DoxyCodeLine{07743\ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ (int32\_t)time(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{07744\ \}}
\DoxyCodeLine{07745\ }
\DoxyCodeLine{07749\ \textcolor{keywordtype}{int}\ Texture::}
\DoxyCodeLine{07750\ do\_get\_expected\_num\_mipmap\_levels(\textcolor{keyword}{const}\ CData\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07751\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{07752\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{07753\ \ \ \}}
\DoxyCodeLine{07754\ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_x\_size,\ cdata-\/>\_y\_size);}
\DoxyCodeLine{07755\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture)\ \{}
\DoxyCodeLine{07756\ \ \ \ \ size\ =\ max(size,\ cdata-\/>\_z\_size);}
\DoxyCodeLine{07757\ \ \ \}}
\DoxyCodeLine{07758\ \ \ \textcolor{keywordtype}{int}\ count\ =\ 1;}
\DoxyCodeLine{07759\ \ \ \textcolor{keywordflow}{while}\ (size\ >\ 1)\ \{}
\DoxyCodeLine{07760\ \ \ \ \ size\ >>=\ 1;}
\DoxyCodeLine{07761\ \ \ \ \ ++count;}
\DoxyCodeLine{07762\ \ \ \}}
\DoxyCodeLine{07763\ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{07764\ \}}
\DoxyCodeLine{07765\ }
\DoxyCodeLine{07769\ \textcolor{keywordtype}{size\_t}\ Texture::}
\DoxyCodeLine{07770\ do\_get\_ram\_mipmap\_page\_size(\textcolor{keyword}{const}\ CData\ *cdata,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07771\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07772\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})cdata-\/>\_ram\_images.size())\ \{}
\DoxyCodeLine{07773\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_ram\_images[n].\_page\_size;}
\DoxyCodeLine{07774\ \ \ \ \ \}}
\DoxyCodeLine{07775\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{07776\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07777\ \ \ \ \ \textcolor{keywordflow}{return}\ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{07778\ \ \ \}}
\DoxyCodeLine{07779\ \}}
\DoxyCodeLine{07780\ }
\DoxyCodeLine{07784\ \textcolor{keywordtype}{int}\ Texture::}
\DoxyCodeLine{07785\ do\_get\_expected\_mipmap\_x\_size(\textcolor{keyword}{const}\ CData\ *cdata,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07786\ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_x\_size,\ 1);}
\DoxyCodeLine{07787\ \ \ \textcolor{keywordflow}{while}\ (n\ >\ 0\ \&\&\ size\ >\ 1)\ \{}
\DoxyCodeLine{07788\ \ \ \ \ size\ >>=\ 1;}
\DoxyCodeLine{07789\ \ \ \ \ -\/-\/n;}
\DoxyCodeLine{07790\ \ \ \}}
\DoxyCodeLine{07791\ \ \ \textcolor{keywordflow}{return}\ size;}
\DoxyCodeLine{07792\ \}}
\DoxyCodeLine{07793\ }
\DoxyCodeLine{07797\ \textcolor{keywordtype}{int}\ Texture::}
\DoxyCodeLine{07798\ do\_get\_expected\_mipmap\_y\_size(\textcolor{keyword}{const}\ CData\ *cdata,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07799\ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_y\_size,\ 1);}
\DoxyCodeLine{07800\ \ \ \textcolor{keywordflow}{while}\ (n\ >\ 0\ \&\&\ size\ >\ 1)\ \{}
\DoxyCodeLine{07801\ \ \ \ \ size\ >>=\ 1;}
\DoxyCodeLine{07802\ \ \ \ \ -\/-\/n;}
\DoxyCodeLine{07803\ \ \ \}}
\DoxyCodeLine{07804\ \ \ \textcolor{keywordflow}{return}\ size;}
\DoxyCodeLine{07805\ \}}
\DoxyCodeLine{07806\ }
\DoxyCodeLine{07810\ \textcolor{keywordtype}{int}\ Texture::}
\DoxyCodeLine{07811\ do\_get\_expected\_mipmap\_z\_size(\textcolor{keyword}{const}\ CData\ *cdata,\ \textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07812\ \ \ \textcolor{comment}{//\ 3-\/D\ textures\ have\ a\ different\ number\ of\ pages\ per\ each\ mipmap\ level.}}
\DoxyCodeLine{07813\ \ \ \textcolor{comment}{//\ Other\ kinds\ of\ textures-\/-\/especially,\ cube\ map\ textures-\/-\/always\ have\ the}}
\DoxyCodeLine{07814\ \ \ \textcolor{comment}{//\ same.}}
\DoxyCodeLine{07815\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture)\ \{}
\DoxyCodeLine{07816\ \ \ \ \ \textcolor{keywordtype}{int}\ size\ =\ max(cdata-\/>\_z\_size,\ 1);}
\DoxyCodeLine{07817\ \ \ \ \ \textcolor{keywordflow}{while}\ (n\ >\ 0\ \&\&\ size\ >\ 1)\ \{}
\DoxyCodeLine{07818\ \ \ \ \ \ \ size\ >>=\ 1;}
\DoxyCodeLine{07819\ \ \ \ \ \ \ -\/-\/n;}
\DoxyCodeLine{07820\ \ \ \ \ \}}
\DoxyCodeLine{07821\ \ \ \ \ \textcolor{keywordflow}{return}\ size;}
\DoxyCodeLine{07822\ }
\DoxyCodeLine{07823\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07824\ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_z\_size;}
\DoxyCodeLine{07825\ \ \ \}}
\DoxyCodeLine{07826\ \}}
\DoxyCodeLine{07827\ }
\DoxyCodeLine{07831\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07832\ do\_clear\_simple\_ram\_image(CData\ *cdata)\ \{}
\DoxyCodeLine{07833\ \ \ cdata-\/>\_simple\_x\_size\ =\ 0;}
\DoxyCodeLine{07834\ \ \ cdata-\/>\_simple\_y\_size\ =\ 0;}
\DoxyCodeLine{07835\ \ \ cdata-\/>\_simple\_ram\_image.\_image.clear();}
\DoxyCodeLine{07836\ \ \ cdata-\/>\_simple\_ram\_image.\_page\_size\ =\ 0;}
\DoxyCodeLine{07837\ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ 0;}
\DoxyCodeLine{07838\ \}}
\DoxyCodeLine{07839\ }
\DoxyCodeLine{07843\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07844\ do\_clear\_ram\_mipmap\_images(CData\ *cdata)\ \{}
\DoxyCodeLine{07845\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_ram\_images.empty())\ \{}
\DoxyCodeLine{07846\ \ \ \ \ cdata-\/>\_ram\_images.erase(cdata-\/>\_ram\_images.begin()\ +\ 1,\ cdata-\/>\_ram\_images.end());}
\DoxyCodeLine{07847\ \ \ \}}
\DoxyCodeLine{07848\ \}}
\DoxyCodeLine{07849\ }
\DoxyCodeLine{07855\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{Texture::}}}
\DoxyCodeLine{07856\ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{do\_generate\_ram\_mipmap\_images}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keywordtype}{bool}\ allow\_recompress)\ \{}
\DoxyCodeLine{07857\ \ \ nassertv(\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata));}
\DoxyCodeLine{07858\ }
\DoxyCodeLine{07859\ \ \ \textcolor{keywordflow}{if}\ (do\_get\_expected\_num\_mipmap\_levels(cdata)\ ==\ 1)\ \{}
\DoxyCodeLine{07860\ \ \ \ \ \textcolor{comment}{//\ Don't\ bother.}}
\DoxyCodeLine{07861\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07862\ \ \ \}}
\DoxyCodeLine{07863\ }
\DoxyCodeLine{07864\ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ orig\_compressed\_image;}
\DoxyCodeLine{07865\ \ \ CompressionMode\ orig\_compression\_mode\ =\ CM\_off;}
\DoxyCodeLine{07866\ }
\DoxyCodeLine{07867\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07868\ \ \ \ \ \textcolor{comment}{//\ The\ RAM\ image\ is\ compressed.\ \ This\ means\ we\ need\ to\ uncompress\ it\ in}}
\DoxyCodeLine{07869\ \ \ \ \ \textcolor{comment}{//\ order\ to\ generate\ mipmap\ images.\ \ Save\ the\ original\ first,\ to\ avoid}}
\DoxyCodeLine{07870\ \ \ \ \ \textcolor{comment}{//\ lossy\ recompression.}}
\DoxyCodeLine{07871\ \ \ \ \ orig\_compressed\_image\ =\ cdata-\/>\_ram\_images[0];}
\DoxyCodeLine{07872\ \ \ \ \ orig\_compression\_mode\ =\ cdata-\/>\_ram\_image\_compression;}
\DoxyCodeLine{07873\ }
\DoxyCodeLine{07874\ \ \ \ \ \textcolor{comment}{//\ Now\ try\ to\ get\ the\ uncompressed\ source\ image.}}
\DoxyCodeLine{07875\ \ \ \ \ do\_get\_uncompressed\_ram\_image(cdata);}
\DoxyCodeLine{07876\ }
\DoxyCodeLine{07877\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_image\_compression\ !=\ CM\_off)\ \{}
\DoxyCodeLine{07878\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{07879\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cannot\ generate\ mipmap\ levels\ for\ image\ with\ compression\ "{}}}
\DoxyCodeLine{07880\ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_ram\_image\_compression\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07881\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07882\ \ \ \ \ \}}
\DoxyCodeLine{07883\ \ \ \}}
\DoxyCodeLine{07884\ }
\DoxyCodeLine{07885\ \ \ do\_clear\_ram\_mipmap\_images(cdata);}
\DoxyCodeLine{07886\ }
\DoxyCodeLine{07887\ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{07888\ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{07889\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Generating\ mipmap\ levels\ for\ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07890\ \ \ \}}
\DoxyCodeLine{07891\ }
\DoxyCodeLine{07892\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ Texture::TT\_3d\_texture\ \&\&\ cdata-\/>\_z\_size\ !=\ 1)\ \{}
\DoxyCodeLine{07893\ \ \ \ \ \textcolor{comment}{//\ Eek,\ a\ 3-\/D\ texture.}}
\DoxyCodeLine{07894\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{07895\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{07896\ \ \ \ \ \textcolor{keywordtype}{int}\ z\_size\ =\ cdata-\/>\_z\_size;}
\DoxyCodeLine{07897\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{07898\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\_size\ >\ 1\ ||\ y\_size\ >\ 1\ ||\ z\_size\ >\ 1)\ \{}
\DoxyCodeLine{07899\ \ \ \ \ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{07900\ \ \ \ \ \ \ do\_filter\_3d\_mipmap\_level(cdata,\ cdata-\/>\_ram\_images[n\ +\ 1],\ cdata-\/>\_ram\_images[n],}
\DoxyCodeLine{07901\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size,\ z\_size);}
\DoxyCodeLine{07902\ \ \ \ \ \ \ x\_size\ =\ max(x\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{07903\ \ \ \ \ \ \ y\_size\ =\ max(y\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{07904\ \ \ \ \ \ \ z\_size\ =\ max(z\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{07905\ \ \ \ \ \ \ ++n;}
\DoxyCodeLine{07906\ \ \ \ \ \}}
\DoxyCodeLine{07907\ }
\DoxyCodeLine{07908\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07909\ \ \ \ \ \textcolor{comment}{//\ A\ 1-\/D,\ 2-\/D,\ or\ cube\ map\ texture.}}
\DoxyCodeLine{07910\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{07911\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{07912\ \ \ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{07913\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\_size\ >\ 1\ ||\ y\_size\ >\ 1)\ \{}
\DoxyCodeLine{07914\ \ \ \ \ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{07915\ \ \ \ \ \ \ do\_filter\_2d\_mipmap\_pages(cdata,\ cdata-\/>\_ram\_images[n\ +\ 1],\ cdata-\/>\_ram\_images[n],}
\DoxyCodeLine{07916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x\_size,\ y\_size);}
\DoxyCodeLine{07917\ \ \ \ \ \ \ x\_size\ =\ max(x\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{07918\ \ \ \ \ \ \ y\_size\ =\ max(y\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{07919\ \ \ \ \ \ \ ++n;}
\DoxyCodeLine{07920\ \ \ \ \ \}}
\DoxyCodeLine{07921\ \ \ \}}
\DoxyCodeLine{07922\ }
\DoxyCodeLine{07923\ \ \ \textcolor{keywordflow}{if}\ (orig\_compression\_mode\ !=\ CM\_off\ \&\&\ allow\_recompress)\ \{}
\DoxyCodeLine{07924\ \ \ \ \ \textcolor{comment}{//\ Now\ attempt\ to\ recompress\ the\ mipmap\ images\ according\ to\ the\ original}}
\DoxyCodeLine{07925\ \ \ \ \ \textcolor{comment}{//\ compression\ mode.\ \ We\ don't\ need\ to\ bother\ compressing\ the\ first\ image}}
\DoxyCodeLine{07926\ \ \ \ \ \textcolor{comment}{//\ (it\ was\ already\ compressed,\ after\ all),\ so\ temporarily\ remove\ it\ from}}
\DoxyCodeLine{07927\ \ \ \ \ \textcolor{comment}{//\ the\ top\ of\ the\ mipmap\ stack,\ and\ compress\ all\ of\ the\ rest\ of\ them}}
\DoxyCodeLine{07928\ \ \ \ \ \textcolor{comment}{//\ instead.}}
\DoxyCodeLine{07929\ \ \ \ \ nassertv(cdata-\/>\_ram\_images.size()\ >\ 1);}
\DoxyCodeLine{07930\ \ \ \ \ \textcolor{keywordtype}{int}\ l0\_x\_size\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{07931\ \ \ \ \ \textcolor{keywordtype}{int}\ l0\_y\_size\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{07932\ \ \ \ \ \textcolor{keywordtype}{int}\ l0\_z\_size\ =\ cdata-\/>\_z\_size;}
\DoxyCodeLine{07933\ \ \ \ \ cdata-\/>\_x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ 1);}
\DoxyCodeLine{07934\ \ \ \ \ cdata-\/>\_y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ 1);}
\DoxyCodeLine{07935\ \ \ \ \ cdata-\/>\_z\_size\ =\ do\_get\_expected\_mipmap\_z\_size(cdata,\ 1);}
\DoxyCodeLine{07936\ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}\ uncompressed\_image\ =\ cdata-\/>\_ram\_images[0];}
\DoxyCodeLine{07937\ \ \ \ \ cdata-\/>\_ram\_images.erase(cdata-\/>\_ram\_images.begin());}
\DoxyCodeLine{07938\ }
\DoxyCodeLine{07939\ \ \ \ \ \textcolor{keywordtype}{bool}\ success\ =\ do\_compress\_ram\_image(cdata,\ orig\_compression\_mode,\ QL\_default,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07940\ \ \ \ \ \textcolor{comment}{//\ Now\ restore\ the\ toplevel\ image.}}
\DoxyCodeLine{07941\ \ \ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{07942\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{07943\ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{07944\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Compressed\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ generated\ mipmaps\ with\ "{}}}
\DoxyCodeLine{07945\ \ \ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_ram\_image\_compression\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07946\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07947\ \ \ \ \ \ \ cdata-\/>\_ram\_images.insert(cdata-\/>\_ram\_images.begin(),\ orig\_compressed\_image);}
\DoxyCodeLine{07948\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07949\ \ \ \ \ \ \ cdata-\/>\_ram\_images.insert(cdata-\/>\_ram\_images.begin(),\ uncompressed\_image);}
\DoxyCodeLine{07950\ \ \ \ \ \}}
\DoxyCodeLine{07951\ \ \ \ \ cdata-\/>\_x\_size\ =\ l0\_x\_size;}
\DoxyCodeLine{07952\ \ \ \ \ cdata-\/>\_y\_size\ =\ l0\_y\_size;}
\DoxyCodeLine{07953\ \ \ \ \ cdata-\/>\_z\_size\ =\ l0\_z\_size;}
\DoxyCodeLine{07954\ \ \ \}}
\DoxyCodeLine{07955\ \}}
\DoxyCodeLine{07956\ }
\DoxyCodeLine{07960\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{07961\ do\_set\_pad\_size(CData\ *cdata,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{07962\ \ \ \textcolor{keywordflow}{if}\ (x\ >\ cdata-\/>\_x\_size)\ \{}
\DoxyCodeLine{07963\ \ \ \ \ x\ =\ cdata-\/>\_x\_size;}
\DoxyCodeLine{07964\ \ \ \}}
\DoxyCodeLine{07965\ \ \ \textcolor{keywordflow}{if}\ (y\ >\ cdata-\/>\_y\_size)\ \{}
\DoxyCodeLine{07966\ \ \ \ \ y\ =\ cdata-\/>\_y\_size;}
\DoxyCodeLine{07967\ \ \ \}}
\DoxyCodeLine{07968\ \ \ \textcolor{keywordflow}{if}\ (z\ >\ cdata-\/>\_z\_size)\ \{}
\DoxyCodeLine{07969\ \ \ \ \ z\ =\ cdata-\/>\_z\_size;}
\DoxyCodeLine{07970\ \ \ \}}
\DoxyCodeLine{07971\ }
\DoxyCodeLine{07972\ \ \ cdata-\/>\_pad\_x\_size\ =\ x;}
\DoxyCodeLine{07973\ \ \ cdata-\/>\_pad\_y\_size\ =\ y;}
\DoxyCodeLine{07974\ \ \ cdata-\/>\_pad\_z\_size\ =\ z;}
\DoxyCodeLine{07975\ \}}
\DoxyCodeLine{07976\ }
\DoxyCodeLine{07982\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{Texture::}}}
\DoxyCodeLine{07983\ \mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{07984\ \ \ \textcolor{keywordflow}{return}\ (cdata-\/>\_loaded\_from\_image\ \&\&\ !cdata-\/>\_fullpath.empty());}
\DoxyCodeLine{07985\ \}}
\DoxyCodeLine{07986\ }
\DoxyCodeLine{07990\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{07991\ do\_reload(CData\ *cdata)\ \{}
\DoxyCodeLine{07992\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aab2febab5ba2d0be466d31d3580ad116}{do\_can\_reload}}(cdata))\ \{}
\DoxyCodeLine{07993\ \ \ \ \ do\_clear\_ram\_image(cdata);}
\DoxyCodeLine{07994\ \ \ \ \ \mbox{\hyperlink{classTexture_ac03cc54614e018515f4ce9f05da89ec1}{do\_reload\_ram\_image}}(cdata,\ \textcolor{keyword}{true});}
\DoxyCodeLine{07995\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata))\ \{}
\DoxyCodeLine{07996\ \ \ \ \ \ \ \textcolor{comment}{//\ An\ explicit\ call\ to\ reload()\ should\ increment\ image\_modified.}}
\DoxyCodeLine{07997\ \ \ \ \ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{07998\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07999\ \ \ \ \ \}}
\DoxyCodeLine{08000\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08001\ \ \ \}}
\DoxyCodeLine{08002\ }
\DoxyCodeLine{08003\ \ \ \textcolor{comment}{//\ We\ don't\ have\ a\ filename\ to\ load\ from.}}
\DoxyCodeLine{08004\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08005\ \}}
\DoxyCodeLine{08006\ }
\DoxyCodeLine{08012\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{Texture::}}}
\DoxyCodeLine{08013\ \mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{08014\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classTexture_a93353bf248b8cf6ddb72909ad514f689}{do\_has\_ram\_image}}(cdata);}
\DoxyCodeLine{08015\ \}}
\DoxyCodeLine{08016\ }
\DoxyCodeLine{08021\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a1f90b25b87791aab8a9abb80d35691d7}{Texture::}}}
\DoxyCodeLine{08022\ \mbox{\hyperlink{classTexture_a1f90b25b87791aab8a9abb80d35691d7}{do\_get\_bam\_rawdata}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata)\ \{}
\DoxyCodeLine{08023\ \ \ do\_get\_ram\_image(cdata);}
\DoxyCodeLine{08024\ \}}
\DoxyCodeLine{08025\ }
\DoxyCodeLine{08030\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{08031\ convert\_from\_pnmimage(\mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \&image,\ \textcolor{keywordtype}{size\_t}\ page\_size,}
\DoxyCodeLine{08032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\_stride,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ z,}
\DoxyCodeLine{08033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keywordtype}{int}\ num\_components,}
\DoxyCodeLine{08034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ component\_width)\ \{}
\DoxyCodeLine{08035\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ pnmimage.get\_x\_size();}
\DoxyCodeLine{08036\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ pnmimage.get\_y\_size();}
\DoxyCodeLine{08037\ \ \ xelval\ maxval\ =\ pnmimage.get\_maxval();}
\DoxyCodeLine{08038\ \ \ \textcolor{keywordtype}{int}\ pixel\_size\ =\ num\_components\ *\ component\_width;}
\DoxyCodeLine{08039\ }
\DoxyCodeLine{08040\ \ \ \textcolor{keywordtype}{int}\ row\_skip\ =\ 0;}
\DoxyCodeLine{08041\ \ \ \textcolor{keywordflow}{if}\ (row\_stride\ ==\ 0)\ \{}
\DoxyCodeLine{08042\ \ \ \ \ row\_stride\ =\ x\_size;}
\DoxyCodeLine{08043\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08044\ \ \ \ \ row\_skip\ =\ (row\_stride\ -\/\ x\_size)\ *\ pixel\_size;}
\DoxyCodeLine{08045\ \ \ \ \ nassertv(row\_skip\ >=\ 0);}
\DoxyCodeLine{08046\ \ \ \}}
\DoxyCodeLine{08047\ }
\DoxyCodeLine{08048\ \ \ \textcolor{keywordtype}{bool}\ is\_grayscale\ =\ (num\_components\ ==\ 1\ ||\ num\_components\ ==\ 2);}
\DoxyCodeLine{08049\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}\ =\ (num\_components\ ==\ 2\ ||\ num\_components\ ==\ 4);}
\DoxyCodeLine{08050\ \ \ \textcolor{keywordtype}{bool}\ img\_has\_alpha\ =\ pnmimage.has\_alpha();}
\DoxyCodeLine{08051\ }
\DoxyCodeLine{08052\ \ \ \textcolor{keywordtype}{int}\ idx\ =\ page\_size\ *\ z;}
\DoxyCodeLine{08053\ \ \ nassertv(idx\ +\ page\_size\ <=\ image.size());}
\DoxyCodeLine{08054\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ \&image[idx];}
\DoxyCodeLine{08055\ }
\DoxyCodeLine{08056\ \ \ \textcolor{keywordflow}{if}\ (x\ !=\ 0\ ||\ y\ !=\ 0)\ \{}
\DoxyCodeLine{08057\ \ \ \ \ p\ +=\ (row\_stride\ *\ y\ +\ x)\ *\ pixel\_size;}
\DoxyCodeLine{08058\ \ \ \}}
\DoxyCodeLine{08059\ }
\DoxyCodeLine{08060\ \ \ \textcolor{keywordflow}{if}\ (maxval\ ==\ 255\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{08061\ \ \ \ \ \textcolor{comment}{//\ Most\ common\ case:\ one\ byte\ per\ pixel,\ and\ the\ source\ image\ shows\ a}}
\DoxyCodeLine{08062\ \ \ \ \ \textcolor{comment}{//\ maxval\ of\ 255.\ \ No\ scaling\ is\ necessary.\ \ Because\ this\ is\ such\ a\ common}}
\DoxyCodeLine{08063\ \ \ \ \ \textcolor{comment}{//\ case,\ we\ break\ it\ out\ per\ component\ for\ best\ performance.}}
\DoxyCodeLine{08064\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *array\ =\ pnmimage.get\_array();}
\DoxyCodeLine{08065\ \ \ \ \ \textcolor{keywordflow}{switch}\ (num\_components)\ \{}
\DoxyCodeLine{08066\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{08067\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08068\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08070\ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08071\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08072\ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08073\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08074\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08075\ }
\DoxyCodeLine{08076\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{08077\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (img\_has\_alpha)\ \{}
\DoxyCodeLine{08078\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *alpha\ =\ pnmimage.get\_alpha\_array();}
\DoxyCodeLine{08079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08080\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08081\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08082\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08083\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08084\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)alpha\_row[i];}
\DoxyCodeLine{08085\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08086\ \ \ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08088\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08089\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08090\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08091\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08092\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08093\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)255;}
\DoxyCodeLine{08094\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08095\ \ \ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08096\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08097\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08098\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08099\ }
\DoxyCodeLine{08100\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{08101\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08102\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08103\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08104\ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08105\ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETG(row[i]);}
\DoxyCodeLine{08106\ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETR(row[i]);}
\DoxyCodeLine{08107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08108\ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08109\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08110\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08111\ }
\DoxyCodeLine{08112\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{08113\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (img\_has\_alpha)\ \{}
\DoxyCodeLine{08114\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *alpha\ =\ pnmimage.get\_alpha\_array();}
\DoxyCodeLine{08115\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08116\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08117\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08118\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08119\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08120\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETG(row[i]);}
\DoxyCodeLine{08121\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETR(row[i]);}
\DoxyCodeLine{08122\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)alpha\_row[i];}
\DoxyCodeLine{08123\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08124\ \ \ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08125\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08126\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08128\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08129\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08130\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETB(row[i]);}
\DoxyCodeLine{08131\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETG(row[i]);}
\DoxyCodeLine{08132\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)PPM\_GETR(row[i]);}
\DoxyCodeLine{08133\ \ \ \ \ \ \ \ \ \ \ \ \ *p++\ =\ (\textcolor{keywordtype}{unsigned}\ char)255;}
\DoxyCodeLine{08134\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08135\ \ \ \ \ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08137\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08138\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08139\ }
\DoxyCodeLine{08140\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08141\ \ \ \ \ \ \ nassertv(num\_components\ >=\ 1\ \&\&\ num\_components\ <=\ 4);}
\DoxyCodeLine{08142\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08143\ \ \ \ \ \}}
\DoxyCodeLine{08144\ }
\DoxyCodeLine{08145\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (maxval\ ==\ 65535\ \&\&\ component\_width\ ==\ 2)\ \{}
\DoxyCodeLine{08146\ \ \ \ \ \textcolor{comment}{//\ Another\ possible\ case:\ two\ bytes\ per\ pixel,\ and\ the\ source\ image\ shows}}
\DoxyCodeLine{08147\ \ \ \ \ \textcolor{comment}{//\ a\ maxval\ of\ 65535.\ \ Again,\ no\ scaling\ is\ necessary.}}
\DoxyCodeLine{08148\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08149\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_grayscale)\ \{}
\DoxyCodeLine{08151\ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ pnmimage.get\_gray\_val(i,\ j));}
\DoxyCodeLine{08152\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08153\ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ pnmimage.get\_blue\_val(i,\ j));}
\DoxyCodeLine{08154\ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ pnmimage.get\_green\_val(i,\ j));}
\DoxyCodeLine{08155\ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ pnmimage.get\_red\_val(i,\ j));}
\DoxyCodeLine{08156\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08158\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (img\_has\_alpha)\ \{}
\DoxyCodeLine{08159\ \ \ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ pnmimage.get\_alpha\_val(i,\ j));}
\DoxyCodeLine{08160\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08161\ \ \ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ 65535);}
\DoxyCodeLine{08162\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08164\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08165\ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08166\ \ \ \ \ \}}
\DoxyCodeLine{08167\ }
\DoxyCodeLine{08168\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{08169\ \ \ \ \ \textcolor{comment}{//\ A\ less\ common\ case:\ one\ byte\ per\ pixel,\ but\ the\ maxval\ is\ something}}
\DoxyCodeLine{08170\ \ \ \ \ \textcolor{comment}{//\ other\ than\ 255.\ \ In\ this\ case,\ we\ should\ scale\ the\ pixel\ values\ up\ to}}
\DoxyCodeLine{08171\ \ \ \ \ \textcolor{comment}{//\ the\ appropriate\ amount.}}
\DoxyCodeLine{08172\ \ \ \ \ \textcolor{keywordtype}{double}\ scale\ =\ 255.0\ /\ (double)maxval;}
\DoxyCodeLine{08173\ }
\DoxyCodeLine{08174\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08175\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_grayscale)\ \{}
\DoxyCodeLine{08177\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_byte(p,\ pnmimage.get\_gray\_val(i,\ j),\ scale);}
\DoxyCodeLine{08178\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08179\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_byte(p,\ pnmimage.get\_blue\_val(i,\ j),\ scale);}
\DoxyCodeLine{08180\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_byte(p,\ pnmimage.get\_green\_val(i,\ j),\ scale);}
\DoxyCodeLine{08181\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_byte(p,\ pnmimage.get\_red\_val(i,\ j),\ scale);}
\DoxyCodeLine{08182\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08184\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (img\_has\_alpha)\ \{}
\DoxyCodeLine{08185\ \ \ \ \ \ \ \ \ \ \ \ \ store\_scaled\_byte(p,\ pnmimage.get\_alpha\_val(i,\ j),\ scale);}
\DoxyCodeLine{08186\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08187\ \ \ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_byte(p,\ 255);}
\DoxyCodeLine{08188\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08190\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08191\ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08192\ \ \ \ \ \}}
\DoxyCodeLine{08193\ }
\DoxyCodeLine{08194\ \ \ \}\ \textcolor{keywordflow}{else}\ \{\ \ \textcolor{comment}{//\ component\_width\ ==\ 2}}
\DoxyCodeLine{08195\ \ \ \ \ \textcolor{comment}{//\ Another\ uncommon\ case:\ two\ bytes\ per\ pixel,\ and\ the\ maxval\ is\ something}}
\DoxyCodeLine{08196\ \ \ \ \ \textcolor{comment}{//\ other\ than\ 65535.\ \ Again,\ we\ must\ scale\ the\ pixel\ values.}}
\DoxyCodeLine{08197\ \ \ \ \ \textcolor{keywordtype}{double}\ scale\ =\ 65535.0\ /\ (double)maxval;}
\DoxyCodeLine{08198\ }
\DoxyCodeLine{08199\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08200\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08201\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_grayscale)\ \{}
\DoxyCodeLine{08202\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_short(p,\ pnmimage.get\_gray\_val(i,\ j),\ scale);}
\DoxyCodeLine{08203\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08204\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_short(p,\ pnmimage.get\_blue\_val(i,\ j),\ scale);}
\DoxyCodeLine{08205\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_short(p,\ pnmimage.get\_green\_val(i,\ j),\ scale);}
\DoxyCodeLine{08206\ \ \ \ \ \ \ \ \ \ \ store\_scaled\_short(p,\ pnmimage.get\_red\_val(i,\ j),\ scale);}
\DoxyCodeLine{08207\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08209\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (img\_has\_alpha)\ \{}
\DoxyCodeLine{08210\ \ \ \ \ \ \ \ \ \ \ \ \ store\_scaled\_short(p,\ pnmimage.get\_alpha\_val(i,\ j),\ 1.0);}
\DoxyCodeLine{08211\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08212\ \ \ \ \ \ \ \ \ \ \ \ \ store\_unscaled\_short(p,\ 65535);}
\DoxyCodeLine{08213\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08215\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08216\ \ \ \ \ \ \ p\ +=\ row\_skip;}
\DoxyCodeLine{08217\ \ \ \ \ \}}
\DoxyCodeLine{08218\ \ \ \}}
\DoxyCodeLine{08219\ \}}
\DoxyCodeLine{08220\ }
\DoxyCodeLine{08225\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{08226\ convert\_from\_pfm(\mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \&image,\ \textcolor{keywordtype}{size\_t}\ page\_size,\ \textcolor{keywordtype}{int}\ z,}
\DoxyCodeLine{08227\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pfm,\ \textcolor{keywordtype}{int}\ num\_components,\ \textcolor{keywordtype}{int}\ component\_width)\ \{}
\DoxyCodeLine{08228\ \ \ nassertv(component\_width\ ==\ 4);\ \ \textcolor{comment}{//\ Currently\ only\ PN\_float32\ is\ expected.}}
\DoxyCodeLine{08229\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ pfm.get\_x\_size();}
\DoxyCodeLine{08230\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ pfm.get\_y\_size();}
\DoxyCodeLine{08231\ }
\DoxyCodeLine{08232\ \ \ \textcolor{keywordtype}{int}\ idx\ =\ page\_size\ *\ z;}
\DoxyCodeLine{08233\ \ \ nassertv(idx\ +\ page\_size\ <=\ image.size());}
\DoxyCodeLine{08234\ \ \ PN\_float32\ *p\ =\ (PN\_float32\ *)\&image[idx];}
\DoxyCodeLine{08235\ }
\DoxyCodeLine{08236\ \ \ \textcolor{keywordflow}{switch}\ (num\_components)\ \{}
\DoxyCodeLine{08237\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{08238\ \ \ \ \ \{}
\DoxyCodeLine{08239\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08241\ \ \ \ \ \ \ \ \ \ \ p[0]\ =\ pfm.get\_channel(i,\ j,\ 0);}
\DoxyCodeLine{08242\ \ \ \ \ \ \ \ \ \ \ ++p;}
\DoxyCodeLine{08243\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08244\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08245\ \ \ \ \ \}}
\DoxyCodeLine{08246\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08247\ }
\DoxyCodeLine{08248\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{08249\ \ \ \ \ \{}
\DoxyCodeLine{08250\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08251\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08252\ \ \ \ \ \ \ \ \ \ \ p[0]\ =\ pfm.get\_channel(i,\ j,\ 0);}
\DoxyCodeLine{08253\ \ \ \ \ \ \ \ \ \ \ p[1]\ =\ pfm.get\_channel(i,\ j,\ 1);}
\DoxyCodeLine{08254\ \ \ \ \ \ \ \ \ \ \ p\ +=\ 2;}
\DoxyCodeLine{08255\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08256\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08257\ \ \ \ \ \}}
\DoxyCodeLine{08258\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08259\ }
\DoxyCodeLine{08260\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{08261\ \ \ \ \ \{}
\DoxyCodeLine{08262\ \ \ \ \ \ \ \textcolor{comment}{//\ RGB\ -\/>\ BGR}}
\DoxyCodeLine{08263\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08265\ \ \ \ \ \ \ \ \ \ \ p[0]\ =\ pfm.get\_channel(i,\ j,\ 2);}
\DoxyCodeLine{08266\ \ \ \ \ \ \ \ \ \ \ p[1]\ =\ pfm.get\_channel(i,\ j,\ 1);}
\DoxyCodeLine{08267\ \ \ \ \ \ \ \ \ \ \ p[2]\ =\ pfm.get\_channel(i,\ j,\ 0);}
\DoxyCodeLine{08268\ \ \ \ \ \ \ \ \ \ \ p\ +=\ 3;}
\DoxyCodeLine{08269\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08270\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08271\ \ \ \ \ \}}
\DoxyCodeLine{08272\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08273\ }
\DoxyCodeLine{08274\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{08275\ \ \ \ \ \{}
\DoxyCodeLine{08276\ \ \ \ \ \ \ \textcolor{comment}{//\ RGBA\ -\/>\ BGRA}}
\DoxyCodeLine{08277\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08278\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08279\ \ \ \ \ \ \ \ \ \ \ p[0]\ =\ pfm.get\_channel(i,\ j,\ 2);}
\DoxyCodeLine{08280\ \ \ \ \ \ \ \ \ \ \ p[1]\ =\ pfm.get\_channel(i,\ j,\ 1);}
\DoxyCodeLine{08281\ \ \ \ \ \ \ \ \ \ \ p[2]\ =\ pfm.get\_channel(i,\ j,\ 0);}
\DoxyCodeLine{08282\ \ \ \ \ \ \ \ \ \ \ p[3]\ =\ pfm.get\_channel(i,\ j,\ 3);}
\DoxyCodeLine{08283\ \ \ \ \ \ \ \ \ \ \ p\ +=\ 4;}
\DoxyCodeLine{08284\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08285\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08286\ \ \ \ \ \}}
\DoxyCodeLine{08287\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08288\ }
\DoxyCodeLine{08289\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08290\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{08291\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{08292\ \ \ \}}
\DoxyCodeLine{08293\ }
\DoxyCodeLine{08294\ \ \ nassertv((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)p\ ==\ \&image[idx]\ +\ page\_size);}
\DoxyCodeLine{08295\ \}}
\DoxyCodeLine{08296\ }
\DoxyCodeLine{08301\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{08302\ convert\_to\_pnmimage(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{08303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_components,\ ComponentType\ component\_type,}
\DoxyCodeLine{08304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_srgb,\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ \textcolor{keywordtype}{size\_t}\ page\_size,\ \textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{08305\ \ \ xelval\ maxval\ =\ 0xff;}
\DoxyCodeLine{08306\ \ \ \textcolor{keywordflow}{if}\ (component\_type\ !=\ T\_unsigned\_byte\ \&\&\ component\_type\ !=\ T\_byte)\ \{}
\DoxyCodeLine{08307\ \ \ \ \ maxval\ =\ 0xffff;}
\DoxyCodeLine{08308\ \ \ \}}
\DoxyCodeLine{08309\ \ \ ColorSpace\ color\_space\ =\ \mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}\ ?\ CS\_sRGB\ :\ CS\_linear;}
\DoxyCodeLine{08310\ \ \ pnmimage.clear(x\_size,\ y\_size,\ num\_components,\ maxval,\ \textcolor{keyword}{nullptr},\ color\_space);}
\DoxyCodeLine{08311\ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}\ =\ pnmimage.has\_alpha();}
\DoxyCodeLine{08312\ \ \ \textcolor{keywordtype}{bool}\ is\_grayscale\ =\ pnmimage.is\_grayscale();}
\DoxyCodeLine{08313\ }
\DoxyCodeLine{08314\ \ \ \textcolor{keywordtype}{int}\ idx\ =\ page\_size\ *\ z;}
\DoxyCodeLine{08315\ \ \ nassertr(idx\ +\ page\_size\ <=\ image.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{08316\ }
\DoxyCodeLine{08317\ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *array\ =\ pnmimage.get\_array();}
\DoxyCodeLine{08318\ \ \ xelval\ *alpha\ =\ pnmimage.get\_alpha\_array();}
\DoxyCodeLine{08319\ }
\DoxyCodeLine{08320\ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{08321\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{08322\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_grayscale)\ \{}
\DoxyCodeLine{08323\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ \&image[idx];}
\DoxyCodeLine{08324\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08326\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08327\ \ \ \ \ \ \ \ \ \ \ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08328\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08329\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ *p++);}
\DoxyCodeLine{08330\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_row[i]\ =\ *p++;}
\DoxyCodeLine{08331\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08332\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08333\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08334\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08335\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08336\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08337\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ *p++);}
\DoxyCodeLine{08338\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08339\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08340\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08341\ \ \ \ \ \ \ nassertr(p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08342\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08343\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ \&image[idx];}
\DoxyCodeLine{08344\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08345\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08346\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08347\ \ \ \ \ \ \ \ \ \ \ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08348\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08349\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ *p++);}
\DoxyCodeLine{08350\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTG(row[i],\ *p++);}
\DoxyCodeLine{08351\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTR(row[i],\ *p++);}
\DoxyCodeLine{08352\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_row[i]\ =\ *p++;}
\DoxyCodeLine{08353\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08354\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08355\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08356\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08357\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08358\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08359\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ *p++);}
\DoxyCodeLine{08360\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTG(row[i],\ *p++);}
\DoxyCodeLine{08361\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTR(row[i],\ *p++);}
\DoxyCodeLine{08362\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08363\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08364\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08365\ \ \ \ \ \ \ nassertr(p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08366\ \ \ \ \ \}}
\DoxyCodeLine{08367\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08368\ }
\DoxyCodeLine{08369\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{08370\ \ \ \ \ \{}
\DoxyCodeLine{08371\ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint16\_t\ *p\ =\ (\textcolor{keyword}{const}\ uint16\_t\ *)\&image[idx];}
\DoxyCodeLine{08372\ }
\DoxyCodeLine{08373\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08374\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08375\ \ \ \ \ \ \ \ \ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08376\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08377\ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ *p++);}
\DoxyCodeLine{08378\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_grayscale)\ \{}
\DoxyCodeLine{08379\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTG(row[i],\ *p++);}
\DoxyCodeLine{08380\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTR(row[i],\ *p++);}
\DoxyCodeLine{08381\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08382\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08383\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_row[i]\ =\ *p++;}
\DoxyCodeLine{08384\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08385\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08386\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08387\ \ \ \ \ \ \ nassertr((\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08388\ \ \ \ \ \}}
\DoxyCodeLine{08389\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08390\ }
\DoxyCodeLine{08391\ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_int:}
\DoxyCodeLine{08392\ \ \ \ \ \{}
\DoxyCodeLine{08393\ \ \ \ \ \ \ \textcolor{keyword}{const}\ uint32\_t\ *p\ =\ (\textcolor{keyword}{const}\ uint32\_t\ *)\&image[idx];}
\DoxyCodeLine{08394\ }
\DoxyCodeLine{08395\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08396\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *row\ =\ array\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08397\ \ \ \ \ \ \ \ \ xelval\ *alpha\_row\ =\ alpha\ +\ j\ *\ x\_size;}
\DoxyCodeLine{08398\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08399\ \ \ \ \ \ \ \ \ \ \ PPM\_PUTB(row[i],\ (*p++)\ >>\ 16u);}
\DoxyCodeLine{08400\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_grayscale)\ \{}
\DoxyCodeLine{08401\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTG(row[i],\ (*p++)\ >>\ 16u);}
\DoxyCodeLine{08402\ \ \ \ \ \ \ \ \ \ \ \ \ PPM\_PUTR(row[i],\ (*p++)\ >>\ 16u);}
\DoxyCodeLine{08403\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08404\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08405\ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_row[i]\ =\ (*p++)\ >>\ 16u;}
\DoxyCodeLine{08406\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08407\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08408\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08409\ \ \ \ \ \ \ nassertr((\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08410\ \ \ \ \ \}}
\DoxyCodeLine{08411\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08412\ }
\DoxyCodeLine{08413\ \ \ \textcolor{keywordflow}{case}\ T\_half\_float:}
\DoxyCodeLine{08414\ \ \ \ \ \{}
\DoxyCodeLine{08415\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ \&image[idx];}
\DoxyCodeLine{08416\ }
\DoxyCodeLine{08417\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08418\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08419\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_blue(i,\ j,\ get\_half\_float(p));}
\DoxyCodeLine{08420\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_grayscale)\ \{}
\DoxyCodeLine{08421\ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_green(i,\ j,\ get\_half\_float(p));}
\DoxyCodeLine{08422\ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_red(i,\ j,\ get\_half\_float(p));}
\DoxyCodeLine{08423\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08424\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}})\ \{}
\DoxyCodeLine{08425\ \ \ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_alpha(i,\ j,\ get\_half\_float(p));}
\DoxyCodeLine{08426\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08427\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08428\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08429\ \ \ \ \ \ \ nassertr(p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08430\ \ \ \ \ \}}
\DoxyCodeLine{08431\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08432\ }
\DoxyCodeLine{08433\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08434\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08435\ \ \ \}}
\DoxyCodeLine{08436\ }
\DoxyCodeLine{08437\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{08438\ \}}
\DoxyCodeLine{08439\ }
\DoxyCodeLine{08444\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{08445\ convert\_to\_pfm(\mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pfm,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{08446\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_components,\ \textcolor{keywordtype}{int}\ component\_width,}
\DoxyCodeLine{08447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image,\ \textcolor{keywordtype}{size\_t}\ page\_size,\ \textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{08448\ \ \ nassertr(component\_width\ ==\ 4,\ \textcolor{keyword}{false});\ \ \textcolor{comment}{//\ Currently\ only\ PN\_float32\ is\ expected.}}
\DoxyCodeLine{08449\ \ \ pfm.clear(x\_size,\ y\_size,\ num\_components);}
\DoxyCodeLine{08450\ }
\DoxyCodeLine{08451\ \ \ \textcolor{keywordtype}{int}\ idx\ =\ page\_size\ *\ z;}
\DoxyCodeLine{08452\ \ \ nassertr(idx\ +\ page\_size\ <=\ image.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{08453\ \ \ \textcolor{keyword}{const}\ PN\_float32\ *p\ =\ (\textcolor{keyword}{const}\ PN\_float32\ *)\&image[idx];}
\DoxyCodeLine{08454\ }
\DoxyCodeLine{08455\ \ \ \textcolor{keywordflow}{switch}\ (num\_components)\ \{}
\DoxyCodeLine{08456\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{08457\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08458\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08459\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 0,\ p[0]);}
\DoxyCodeLine{08460\ \ \ \ \ \ \ \ \ ++p;}
\DoxyCodeLine{08461\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08462\ \ \ \ \ \}}
\DoxyCodeLine{08463\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08464\ }
\DoxyCodeLine{08465\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{08466\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08467\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08468\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 0,\ p[0]);}
\DoxyCodeLine{08469\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 1,\ p[1]);}
\DoxyCodeLine{08470\ \ \ \ \ \ \ \ \ p\ +=\ 2;}
\DoxyCodeLine{08471\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08472\ \ \ \ \ \}}
\DoxyCodeLine{08473\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08474\ }
\DoxyCodeLine{08475\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{08476\ \ \ \ \ \textcolor{comment}{//\ BGR\ -\/>\ RGB}}
\DoxyCodeLine{08477\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08478\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08479\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 2,\ p[0]);}
\DoxyCodeLine{08480\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 1,\ p[1]);}
\DoxyCodeLine{08481\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 0,\ p[2]);}
\DoxyCodeLine{08482\ \ \ \ \ \ \ \ \ p\ +=\ 3;}
\DoxyCodeLine{08483\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08484\ \ \ \ \ \}}
\DoxyCodeLine{08485\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08486\ }
\DoxyCodeLine{08487\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{08488\ \ \ \ \ \textcolor{comment}{//\ BGRA\ -\/>\ RGBA}}
\DoxyCodeLine{08489\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ y\_size-\/1;\ j\ >=\ 0;\ j-\/-\/)\ \{}
\DoxyCodeLine{08490\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ x\_size;\ i++)\ \{}
\DoxyCodeLine{08491\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 2,\ p[0]);}
\DoxyCodeLine{08492\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 1,\ p[1]);}
\DoxyCodeLine{08493\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 0,\ p[2]);}
\DoxyCodeLine{08494\ \ \ \ \ \ \ \ \ pfm.set\_channel(i,\ j,\ 3,\ p[3]);}
\DoxyCodeLine{08495\ \ \ \ \ \ \ \ \ p\ +=\ 4;}
\DoxyCodeLine{08496\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08497\ \ \ \ \ \}}
\DoxyCodeLine{08498\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08499\ }
\DoxyCodeLine{08500\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08501\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{08502\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08503\ \ \ \}}
\DoxyCodeLine{08504\ }
\DoxyCodeLine{08505\ \ \ nassertr((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)p\ ==\ \&image[idx]\ +\ page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08506\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{08507\ \}}
\DoxyCodeLine{08508\ }
\DoxyCodeLine{08512\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08513\ read\_dds\_level\_bgr8(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08514\ \ \ \textcolor{comment}{//\ This\ is\ in\ order\ B,\ G,\ R.}}
\DoxyCodeLine{08515\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08516\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08517\ }
\DoxyCodeLine{08518\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08519\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 3;}
\DoxyCodeLine{08520\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08521\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08522\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08523\ \ \ \ \ nassertr(p\ +\ row\_bytes\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08524\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08525\ \ \ \}}
\DoxyCodeLine{08526\ }
\DoxyCodeLine{08527\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08528\ \}}
\DoxyCodeLine{08529\ }
\DoxyCodeLine{08533\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08534\ read\_dds\_level\_rgb8(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08535\ \ \ \textcolor{comment}{//\ This\ is\ in\ order\ R,\ G,\ B.}}
\DoxyCodeLine{08536\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08537\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08538\ }
\DoxyCodeLine{08539\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08540\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 3;}
\DoxyCodeLine{08541\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08542\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08543\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08544\ \ \ \ \ nassertr(p\ +\ row\_bytes\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08545\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08546\ }
\DoxyCodeLine{08547\ \ \ \ \ \textcolor{comment}{//\ Now\ reverse\ the\ r,\ g,\ b\ triples.}}
\DoxyCodeLine{08548\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08549\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ r\ =\ p[0];}
\DoxyCodeLine{08550\ \ \ \ \ \ \ p[0]\ =\ p[2];}
\DoxyCodeLine{08551\ \ \ \ \ \ \ p[2]\ =\ r;}
\DoxyCodeLine{08552\ \ \ \ \ \ \ p\ +=\ 3;}
\DoxyCodeLine{08553\ \ \ \ \ \}}
\DoxyCodeLine{08554\ \ \ \ \ nassertr(p\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08555\ \ \ \}}
\DoxyCodeLine{08556\ }
\DoxyCodeLine{08557\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08558\ \}}
\DoxyCodeLine{08559\ }
\DoxyCodeLine{08563\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08564\ read\_dds\_level\_abgr8(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08565\ \ \ \textcolor{comment}{//\ This\ is\ laid\ out\ in\ order\ R,\ G,\ B,\ A.}}
\DoxyCodeLine{08566\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08567\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08568\ }
\DoxyCodeLine{08569\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08570\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 4;}
\DoxyCodeLine{08571\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08572\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08573\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08574\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08575\ }
\DoxyCodeLine{08576\ \ \ \ \ uint32\_t\ *pw\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{08577\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08578\ \ \ \ \ \ \ uint32\_t\ w\ =\ *pw;}
\DoxyCodeLine{08579\ \textcolor{preprocessor}{\#ifdef\ WORDS\_BIGENDIAN}}
\DoxyCodeLine{08580\ \ \ \ \ \ \ \textcolor{comment}{//\ bigendian:\ convert\ R,\ G,\ B,\ A\ to\ B,\ G,\ R,\ A.}}
\DoxyCodeLine{08581\ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff00)\ <<\ 16)\ |\ ((w\ \&\ 0xff000000U)\ >>\ 16)\ |\ (w\ \&\ 0xff00ff);}
\DoxyCodeLine{08582\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{08583\ \ \ \ \ \ \ \textcolor{comment}{//\ littendian:\ convert\ A,\ B,\ G,\ R\ to\ to\ A,\ R,\ G,\ B.}}
\DoxyCodeLine{08584\ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 16)\ |\ ((w\ \&\ 0xff0000)\ >>\ 16)\ |\ (w\ \&\ 0xff00ff00U);}
\DoxyCodeLine{08585\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08586\ \ \ \ \ \ \ *pw\ =\ w;}
\DoxyCodeLine{08587\ \ \ \ \ \ \ ++pw;}
\DoxyCodeLine{08588\ \ \ \ \ \}}
\DoxyCodeLine{08589\ \ \ \ \ nassertr((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)pw\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08590\ \ \ \}}
\DoxyCodeLine{08591\ }
\DoxyCodeLine{08592\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08593\ \}}
\DoxyCodeLine{08594\ }
\DoxyCodeLine{08598\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08599\ read\_dds\_level\_rgba8(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08600\ \ \ \textcolor{comment}{//\ This\ is\ actually\ laid\ out\ in\ order\ B,\ G,\ R,\ A.}}
\DoxyCodeLine{08601\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08602\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08603\ }
\DoxyCodeLine{08604\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08605\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 4;}
\DoxyCodeLine{08606\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08607\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08608\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08609\ \ \ \ \ nassertr(p\ +\ row\_bytes\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08610\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08611\ \ \ \}}
\DoxyCodeLine{08612\ }
\DoxyCodeLine{08613\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08614\ \}}
\DoxyCodeLine{08615\ }
\DoxyCodeLine{08619\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08620\ read\_dds\_level\_abgr16(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08621\ \ \ \textcolor{comment}{//\ This\ is\ laid\ out\ in\ order\ R,\ G,\ B,\ A.}}
\DoxyCodeLine{08622\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08623\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08624\ }
\DoxyCodeLine{08625\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08626\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 8;}
\DoxyCodeLine{08627\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08628\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08629\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08630\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08631\ }
\DoxyCodeLine{08632\ \ \ \ \ uint16\_t\ *pw\ =\ (uint16\_t\ *)p;}
\DoxyCodeLine{08633\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08634\ \ \ \ \ \ \ swap(pw[0],\ pw[2]);}
\DoxyCodeLine{08635\ \ \ \ \ \ \ pw\ +=\ 4;}
\DoxyCodeLine{08636\ \ \ \ \ \}}
\DoxyCodeLine{08637\ \ \ \ \ nassertr((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)pw\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08638\ \ \ \}}
\DoxyCodeLine{08639\ }
\DoxyCodeLine{08640\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08641\ \}}
\DoxyCodeLine{08642\ }
\DoxyCodeLine{08646\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08647\ read\_dds\_level\_abgr32(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08648\ \ \ \textcolor{comment}{//\ This\ is\ laid\ out\ in\ order\ R,\ G,\ B,\ A.}}
\DoxyCodeLine{08649\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08650\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08651\ }
\DoxyCodeLine{08652\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08653\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ 16;}
\DoxyCodeLine{08654\ \ \ nassertr(row\_bytes\ *\ y\_size\ ==\ size,\ \mbox{\hyperlink{pta__uchar_8h_a41b9710d305d1a1af615ccb3d2fd3cb5}{PTA\_uchar}}());}
\DoxyCodeLine{08655\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08656\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08657\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08658\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08659\ }
\DoxyCodeLine{08660\ \ \ \ \ uint32\_t\ *pw\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{08661\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08662\ \ \ \ \ \ \ swap(pw[0],\ pw[2]);}
\DoxyCodeLine{08663\ \ \ \ \ \ \ pw\ +=\ 4;}
\DoxyCodeLine{08664\ \ \ \ \ \}}
\DoxyCodeLine{08665\ \ \ \ \ nassertr((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)pw\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08666\ \ \ \}}
\DoxyCodeLine{08667\ }
\DoxyCodeLine{08668\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08669\ \}}
\DoxyCodeLine{08670\ }
\DoxyCodeLine{08674\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08675\ read\_dds\_level\_raw(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08676\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08677\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08678\ }
\DoxyCodeLine{08679\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08680\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ cdata-\/>\_num\_components\ *\ cdata-\/>\_component\_width;}
\DoxyCodeLine{08681\ \ \ nassertr(row\_bytes\ *\ y\_size\ ==\ size,\ \mbox{\hyperlink{pta__uchar_8h_a41b9710d305d1a1af615ccb3d2fd3cb5}{PTA\_uchar}}());}
\DoxyCodeLine{08682\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08683\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08684\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08685\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_bytes);}
\DoxyCodeLine{08686\ \ \ \}}
\DoxyCodeLine{08687\ }
\DoxyCodeLine{08688\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08689\ \}}
\DoxyCodeLine{08690\ }
\DoxyCodeLine{08695\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08696\ read\_dds\_level\_generic\_uncompressed(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,}
\DoxyCodeLine{08697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08698\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08699\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08700\ }
\DoxyCodeLine{08701\ \ \ \textcolor{keywordtype}{int}\ pitch\ =\ (x\_size\ *\ header.pf.rgb\_bitcount)\ /\ 8;}
\DoxyCodeLine{08702\ }
\DoxyCodeLine{08703\ \ \ \textcolor{comment}{//\ MS\ says\ the\ pitch\ can\ be\ supplied\ in\ the\ header\ file\ and\ must\ be\ DWORD}}
\DoxyCodeLine{08704\ \ \ \textcolor{comment}{//\ aligned,\ but\ this\ appears\ to\ apply\ to\ level\ 0\ mipmaps\ only\ (where\ it}}
\DoxyCodeLine{08705\ \ \ \textcolor{comment}{//\ almost\ always\ will\ be\ anyway).\ \ Other\ mipmap\ levels\ seem\ to\ be\ tightly}}
\DoxyCodeLine{08706\ \ \ \textcolor{comment}{//\ packed,\ but\ there\ isn't\ a\ separate\ pitch\ for\ each\ mipmap\ level.\ \ Weird.}}
\DoxyCodeLine{08707\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{08708\ \ \ \ \ pitch\ =\ ((pitch\ +\ 3)\ /\ 4)\ *\ 4;}
\DoxyCodeLine{08709\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_PITCH)\ \{}
\DoxyCodeLine{08710\ \ \ \ \ \ \ pitch\ =\ header.pitch;}
\DoxyCodeLine{08711\ \ \ \ \ \}}
\DoxyCodeLine{08712\ \ \ \}}
\DoxyCodeLine{08713\ }
\DoxyCodeLine{08714\ \ \ \textcolor{keywordtype}{int}\ bpp\ =\ header.pf.rgb\_bitcount\ /\ 8;}
\DoxyCodeLine{08715\ \ \ \textcolor{keywordtype}{int}\ skip\_bytes\ =\ pitch\ -\/\ (bpp\ *\ x\_size);}
\DoxyCodeLine{08716\ \ \ nassertr(skip\_bytes\ >=\ 0,\ \mbox{\hyperlink{pta__uchar_8h_a41b9710d305d1a1af615ccb3d2fd3cb5}{PTA\_uchar}}());}
\DoxyCodeLine{08717\ }
\DoxyCodeLine{08718\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\_mask\ =\ header.pf.r\_mask;}
\DoxyCodeLine{08719\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ g\_mask\ =\ header.pf.g\_mask;}
\DoxyCodeLine{08720\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ b\_mask\ =\ header.pf.b\_mask;}
\DoxyCodeLine{08721\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\_mask\ =\ header.pf.a\_mask;}
\DoxyCodeLine{08722\ }
\DoxyCodeLine{08723\ \ \ \textcolor{comment}{//\ Determine\ the\ number\ of\ bits\ to\ shift\ each\ mask\ to\ the\ right\ so\ that\ the}}
\DoxyCodeLine{08724\ \ \ \textcolor{comment}{//\ lowest\ on\ bit\ is\ at\ bit\ 0.}}
\DoxyCodeLine{08725\ \ \ \textcolor{keywordtype}{int}\ r\_shift\ =\ get\_lowest\_on\_bit(r\_mask);}
\DoxyCodeLine{08726\ \ \ \textcolor{keywordtype}{int}\ g\_shift\ =\ get\_lowest\_on\_bit(g\_mask);}
\DoxyCodeLine{08727\ \ \ \textcolor{keywordtype}{int}\ b\_shift\ =\ get\_lowest\_on\_bit(b\_mask);}
\DoxyCodeLine{08728\ \ \ \textcolor{keywordtype}{int}\ a\_shift\ =\ get\_lowest\_on\_bit(a\_mask);}
\DoxyCodeLine{08729\ }
\DoxyCodeLine{08730\ \ \ \textcolor{comment}{//\ Then\ determine\ the\ scale\ factor\ required\ to\ raise\ the\ highest\ color\ value}}
\DoxyCodeLine{08731\ \ \ \textcolor{comment}{//\ to\ 0xff000000.}}
\DoxyCodeLine{08732\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\_scale\ =\ 0;}
\DoxyCodeLine{08733\ \ \ \textcolor{keywordflow}{if}\ (r\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08734\ \ \ \ \ r\_scale\ =\ 0xff000000\ /\ (r\_mask\ >>\ r\_shift);}
\DoxyCodeLine{08735\ \ \ \}}
\DoxyCodeLine{08736\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ g\_scale\ =\ 0;}
\DoxyCodeLine{08737\ \ \ \textcolor{keywordflow}{if}\ (g\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08738\ \ \ \ \ g\_scale\ =\ 0xff000000\ /\ (g\_mask\ >>\ g\_shift);}
\DoxyCodeLine{08739\ \ \ \}}
\DoxyCodeLine{08740\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ b\_scale\ =\ 0;}
\DoxyCodeLine{08741\ \ \ \textcolor{keywordflow}{if}\ (b\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08742\ \ \ \ \ b\_scale\ =\ 0xff000000\ /\ (b\_mask\ >>\ b\_shift);}
\DoxyCodeLine{08743\ \ \ \}}
\DoxyCodeLine{08744\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\_scale\ =\ 0;}
\DoxyCodeLine{08745\ \ \ \textcolor{keywordflow}{if}\ (a\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08746\ \ \ \ \ a\_scale\ =\ 0xff000000\ /\ (a\_mask\ >>\ a\_shift);}
\DoxyCodeLine{08747\ \ \ \}}
\DoxyCodeLine{08748\ }
\DoxyCodeLine{08749\ \ \ \textcolor{keywordtype}{bool}\ add\_alpha\ =\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}(cdata-\/>\_format);}
\DoxyCodeLine{08750\ }
\DoxyCodeLine{08751\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08752\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ cdata-\/>\_num\_components;}
\DoxyCodeLine{08753\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08754\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08755\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08756\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08757\ }
\DoxyCodeLine{08758\ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ a\ little-\/endian\ numeric\ value\ of\ bpp\ bytes.}}
\DoxyCodeLine{08759\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpixel}{pixel}}\ =\ 0;}
\DoxyCodeLine{08760\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ shift\ =\ 0;}
\DoxyCodeLine{08761\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ bi\ =\ 0;\ bi\ <\ bpp;\ ++bi)\ \{}
\DoxyCodeLine{08762\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ch\ =\ (\textcolor{keywordtype}{unsigned}\ char)in.get();}
\DoxyCodeLine{08763\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ |=\ (ch\ <<\ shift);}
\DoxyCodeLine{08764\ \ \ \ \ \ \ \ \ shift\ +=\ 8;}
\DoxyCodeLine{08765\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08766\ }
\DoxyCodeLine{08767\ \ \ \ \ \ \ \textcolor{comment}{//\ Then\ break\ apart\ that\ value\ into\ its\ R,\ G,\ B,\ and\ maybe\ A\ components.}}
\DoxyCodeLine{08768\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ r\_mask)\ >>\ r\_shift)\ *\ r\_scale)\ >>\ 24;}
\DoxyCodeLine{08769\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ g\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ g\_mask)\ >>\ g\_shift)\ *\ g\_scale)\ >>\ 24;}
\DoxyCodeLine{08770\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ b\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ b\_mask)\ >>\ b\_shift)\ *\ b\_scale)\ >>\ 24;}
\DoxyCodeLine{08771\ }
\DoxyCodeLine{08772\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ components\ in\ the\ Texture's\ image\ data.}}
\DoxyCodeLine{08773\ \ \ \ \ \ \ store\_unscaled\_byte(p,\ b);}
\DoxyCodeLine{08774\ \ \ \ \ \ \ store\_unscaled\_byte(p,\ g);}
\DoxyCodeLine{08775\ \ \ \ \ \ \ store\_unscaled\_byte(p,\ r);}
\DoxyCodeLine{08776\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (add\_alpha)\ \{}
\DoxyCodeLine{08777\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ a\_mask)\ >>\ a\_shift)\ *\ a\_scale)\ >>\ 24;}
\DoxyCodeLine{08778\ \ \ \ \ \ \ \ \ store\_unscaled\_byte(p,\ a);}
\DoxyCodeLine{08779\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08780\ \ \ \ \ \}}
\DoxyCodeLine{08781\ \ \ \ \ nassertr(p\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08782\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ bi\ =\ 0;\ bi\ <\ skip\_bytes;\ ++bi)\ \{}
\DoxyCodeLine{08783\ \ \ \ \ \ \ in.get();}
\DoxyCodeLine{08784\ \ \ \ \ \}}
\DoxyCodeLine{08785\ \ \ \}}
\DoxyCodeLine{08786\ }
\DoxyCodeLine{08787\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08788\ \}}
\DoxyCodeLine{08789\ }
\DoxyCodeLine{08794\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08795\ read\_dds\_level\_luminance\_uncompressed(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,}
\DoxyCodeLine{08796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08797\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08798\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08799\ }
\DoxyCodeLine{08800\ \ \ \textcolor{keywordtype}{int}\ pitch\ =\ (x\_size\ *\ header.pf.rgb\_bitcount)\ /\ 8;}
\DoxyCodeLine{08801\ }
\DoxyCodeLine{08802\ \ \ \textcolor{comment}{//\ MS\ says\ the\ pitch\ can\ be\ supplied\ in\ the\ header\ file\ and\ must\ be\ DWORD}}
\DoxyCodeLine{08803\ \ \ \textcolor{comment}{//\ aligned,\ but\ this\ appears\ to\ apply\ to\ level\ 0\ mipmaps\ only\ (where\ it}}
\DoxyCodeLine{08804\ \ \ \textcolor{comment}{//\ almost\ always\ will\ be\ anyway).\ \ Other\ mipmap\ levels\ seem\ to\ be\ tightly}}
\DoxyCodeLine{08805\ \ \ \textcolor{comment}{//\ packed,\ but\ there\ isn't\ a\ separate\ pitch\ for\ each\ mipmap\ level.\ \ Weird.}}
\DoxyCodeLine{08806\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{08807\ \ \ \ \ pitch\ =\ ((pitch\ +\ 3)\ /\ 4)\ *\ 4;}
\DoxyCodeLine{08808\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_PITCH)\ \{}
\DoxyCodeLine{08809\ \ \ \ \ \ \ pitch\ =\ header.pitch;}
\DoxyCodeLine{08810\ \ \ \ \ \}}
\DoxyCodeLine{08811\ \ \ \}}
\DoxyCodeLine{08812\ }
\DoxyCodeLine{08813\ \ \ \textcolor{keywordtype}{int}\ bpp\ =\ header.pf.rgb\_bitcount\ /\ 8;}
\DoxyCodeLine{08814\ \ \ \textcolor{keywordtype}{int}\ skip\_bytes\ =\ pitch\ -\/\ (bpp\ *\ x\_size);}
\DoxyCodeLine{08815\ \ \ nassertr(skip\_bytes\ >=\ 0,\ \mbox{\hyperlink{pta__uchar_8h_a41b9710d305d1a1af615ccb3d2fd3cb5}{PTA\_uchar}}());}
\DoxyCodeLine{08816\ }
\DoxyCodeLine{08817\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\_mask\ =\ header.pf.r\_mask;}
\DoxyCodeLine{08818\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\_mask\ =\ header.pf.a\_mask;}
\DoxyCodeLine{08819\ }
\DoxyCodeLine{08820\ \ \ \textcolor{comment}{//\ Determine\ the\ number\ of\ bits\ to\ shift\ each\ mask\ to\ the\ right\ so\ that\ the}}
\DoxyCodeLine{08821\ \ \ \textcolor{comment}{//\ lowest\ on\ bit\ is\ at\ bit\ 0.}}
\DoxyCodeLine{08822\ \ \ \textcolor{keywordtype}{int}\ r\_shift\ =\ get\_lowest\_on\_bit(r\_mask);}
\DoxyCodeLine{08823\ \ \ \textcolor{keywordtype}{int}\ a\_shift\ =\ get\_lowest\_on\_bit(a\_mask);}
\DoxyCodeLine{08824\ }
\DoxyCodeLine{08825\ \ \ \textcolor{comment}{//\ Then\ determine\ the\ scale\ factor\ required\ to\ raise\ the\ highest\ color\ value}}
\DoxyCodeLine{08826\ \ \ \textcolor{comment}{//\ to\ 0xff000000.}}
\DoxyCodeLine{08827\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\_scale\ =\ 0;}
\DoxyCodeLine{08828\ \ \ \textcolor{keywordflow}{if}\ (r\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08829\ \ \ \ \ r\_scale\ =\ 0xff000000\ /\ (r\_mask\ >>\ r\_shift);}
\DoxyCodeLine{08830\ \ \ \}}
\DoxyCodeLine{08831\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\_scale\ =\ 0;}
\DoxyCodeLine{08832\ \ \ \textcolor{keywordflow}{if}\ (a\_mask\ !=\ 0)\ \{}
\DoxyCodeLine{08833\ \ \ \ \ a\_scale\ =\ 0xff000000\ /\ (a\_mask\ >>\ a\_shift);}
\DoxyCodeLine{08834\ \ \ \}}
\DoxyCodeLine{08835\ }
\DoxyCodeLine{08836\ \ \ \textcolor{keywordtype}{bool}\ add\_alpha\ =\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}(cdata-\/>\_format);}
\DoxyCodeLine{08837\ }
\DoxyCodeLine{08838\ \ \ \textcolor{keywordtype}{size\_t}\ size\ =\ tex-\/>do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{08839\ \ \ \textcolor{keywordtype}{size\_t}\ row\_bytes\ =\ x\_size\ *\ cdata-\/>\_num\_components;}
\DoxyCodeLine{08840\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(size);}
\DoxyCodeLine{08841\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_size\ -\/\ 1;\ y\ >=\ 0;\ -\/-\/y)\ \{}
\DoxyCodeLine{08842\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ y\ *\ row\_bytes;}
\DoxyCodeLine{08843\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ ++x)\ \{}
\DoxyCodeLine{08844\ }
\DoxyCodeLine{08845\ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ a\ little-\/endian\ numeric\ value\ of\ bpp\ bytes.}}
\DoxyCodeLine{08846\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structpixel}{pixel}}\ =\ 0;}
\DoxyCodeLine{08847\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ shift\ =\ 0;}
\DoxyCodeLine{08848\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ bi\ =\ 0;\ bi\ <\ bpp;\ ++bi)\ \{}
\DoxyCodeLine{08849\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ ch\ =\ (\textcolor{keywordtype}{unsigned}\ char)in.get();}
\DoxyCodeLine{08850\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ |=\ (ch\ <<\ shift);}
\DoxyCodeLine{08851\ \ \ \ \ \ \ \ \ shift\ +=\ 8;}
\DoxyCodeLine{08852\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08853\ }
\DoxyCodeLine{08854\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ r\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ r\_mask)\ >>\ r\_shift)\ *\ r\_scale)\ >>\ 24;}
\DoxyCodeLine{08855\ }
\DoxyCodeLine{08856\ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ components\ in\ the\ Texture's\ image\ data.}}
\DoxyCodeLine{08857\ \ \ \ \ \ \ store\_unscaled\_byte(p,\ r);}
\DoxyCodeLine{08858\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (add\_alpha)\ \{}
\DoxyCodeLine{08859\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ a\ =\ (((\mbox{\hyperlink{structpixel}{pixel}}\ \&\ a\_mask)\ >>\ a\_shift)\ *\ a\_scale)\ >>\ 24;}
\DoxyCodeLine{08860\ \ \ \ \ \ \ \ \ store\_unscaled\_byte(p,\ a);}
\DoxyCodeLine{08861\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08862\ \ \ \ \ \}}
\DoxyCodeLine{08863\ \ \ \ \ nassertr(p\ <=\ image.p()\ +\ size,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08864\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ bi\ =\ 0;\ bi\ <\ skip\_bytes;\ ++bi)\ \{}
\DoxyCodeLine{08865\ \ \ \ \ \ \ in.get();}
\DoxyCodeLine{08866\ \ \ \ \ \}}
\DoxyCodeLine{08867\ \ \ \}}
\DoxyCodeLine{08868\ }
\DoxyCodeLine{08869\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08870\ \}}
\DoxyCodeLine{08871\ }
\DoxyCodeLine{08875\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08876\ read\_dds\_level\_bc1(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08877\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08878\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08879\ }
\DoxyCodeLine{08880\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ div\ =\ 4;}
\DoxyCodeLine{08881\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ block\_bytes\ =\ 8;}
\DoxyCodeLine{08882\ }
\DoxyCodeLine{08883\ \ \ \textcolor{comment}{//\ The\ DXT1\ image\ is\ divided\ into\ num\_rows\ x\ num\_cols\ blocks,\ where\ each}}
\DoxyCodeLine{08884\ \ \ \textcolor{comment}{//\ block\ represents\ 4x4\ pixels.}}
\DoxyCodeLine{08885\ \ \ \textcolor{keywordtype}{int}\ num\_cols\ =\ max(div,\ x\_size)\ /\ div;}
\DoxyCodeLine{08886\ \ \ \textcolor{keywordtype}{int}\ num\_rows\ =\ max(div,\ y\_size)\ /\ div;}
\DoxyCodeLine{08887\ \ \ \textcolor{keywordtype}{int}\ row\_length\ =\ num\_cols\ *\ block\_bytes;}
\DoxyCodeLine{08888\ \ \ \textcolor{keywordtype}{int}\ linear\_size\ =\ row\_length\ *\ num\_rows;}
\DoxyCodeLine{08889\ }
\DoxyCodeLine{08890\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{08891\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_LINEARSIZE)\ \{}
\DoxyCodeLine{08892\ \ \ \ \ \ \ nassertr(linear\_size\ ==\ (\textcolor{keywordtype}{int})header.pitch,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08893\ \ \ \ \ \}}
\DoxyCodeLine{08894\ \ \ \}}
\DoxyCodeLine{08895\ }
\DoxyCodeLine{08896\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(linear\_size);}
\DoxyCodeLine{08897\ }
\DoxyCodeLine{08898\ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 4)\ \{}
\DoxyCodeLine{08899\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ flip\ the\ image\ as\ we\ read\ it,\ because\ of\ DirectX's\ inverted}}
\DoxyCodeLine{08900\ \ \ \ \ \textcolor{comment}{//\ sense\ of\ up.\ \ That\ means\ we\ (a)\ reverse\ the\ order\ of\ the\ rows\ of\ blocks}}
\DoxyCodeLine{08901\ \ \ \ \ \textcolor{comment}{//\ .\ .\ .}}
\DoxyCodeLine{08902\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ri\ =\ num\_rows\ -\/\ 1;\ ri\ >=\ 0;\ -\/-\/ri)\ \{}
\DoxyCodeLine{08903\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ row\_length\ *\ ri;}
\DoxyCodeLine{08904\ \ \ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{08905\ }
\DoxyCodeLine{08906\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{08907\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ .\ .\ .\ and\ (b)\ within\ each\ block,\ we\ reverse\ the\ 4\ individual\ rows}}
\DoxyCodeLine{08908\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ 4\ pixels.}}
\DoxyCodeLine{08909\ \ \ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{08910\ \ \ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[1];}
\DoxyCodeLine{08911\ \ \ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 24)\ |\ ((w\ \&\ 0xff00)\ <<\ 8)\ |\ ((w\ \&\ 0xff0000)\ >>\ 8)\ |\ ((w\ \&\ 0xff000000U)\ >>\ 24);}
\DoxyCodeLine{08912\ \ \ \ \ \ \ \ \ cells[1]\ =\ w;}
\DoxyCodeLine{08913\ }
\DoxyCodeLine{08914\ \ \ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{08915\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08916\ \ \ \ \ \}}
\DoxyCodeLine{08917\ }
\DoxyCodeLine{08918\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 2)\ \{}
\DoxyCodeLine{08919\ \ \ \ \ \textcolor{comment}{//\ To\ invert\ a\ two-\/pixel\ high\ image,\ we\ just\ flip\ two\ rows\ within\ a\ cell.}}
\DoxyCodeLine{08920\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{08921\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{08922\ }
\DoxyCodeLine{08923\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{08924\ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{08925\ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[1];}
\DoxyCodeLine{08926\ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 8)\ |\ ((w\ \&\ 0xff00)\ >>\ 8);}
\DoxyCodeLine{08927\ \ \ \ \ \ \ cells[1]\ =\ w;}
\DoxyCodeLine{08928\ }
\DoxyCodeLine{08929\ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{08930\ \ \ \ \ \}}
\DoxyCodeLine{08931\ }
\DoxyCodeLine{08932\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 1)\ \{}
\DoxyCodeLine{08933\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ invert\ a\ one-\/pixel-\/high\ image.}}
\DoxyCodeLine{08934\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{08935\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{08936\ \ \ \}}
\DoxyCodeLine{08937\ }
\DoxyCodeLine{08938\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{08939\ \}}
\DoxyCodeLine{08940\ }
\DoxyCodeLine{08944\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{08945\ read\_dds\_level\_bc2(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{08946\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{08947\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{08948\ }
\DoxyCodeLine{08949\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ div\ =\ 4;}
\DoxyCodeLine{08950\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ block\_bytes\ =\ 16;}
\DoxyCodeLine{08951\ }
\DoxyCodeLine{08952\ \ \ \textcolor{comment}{//\ The\ DXT3\ image\ is\ divided\ into\ num\_rows\ x\ num\_cols\ blocks,\ where\ each}}
\DoxyCodeLine{08953\ \ \ \textcolor{comment}{//\ block\ represents\ 4x4\ pixels.\ \ Unlike\ DXT1,\ each\ block\ consists\ of\ two}}
\DoxyCodeLine{08954\ \ \ \textcolor{comment}{//\ 8-\/byte\ chunks,\ representing\ the\ alpha\ and\ color\ separately.}}
\DoxyCodeLine{08955\ \ \ \textcolor{keywordtype}{int}\ num\_cols\ =\ max(div,\ x\_size)\ /\ div;}
\DoxyCodeLine{08956\ \ \ \textcolor{keywordtype}{int}\ num\_rows\ =\ max(div,\ y\_size)\ /\ div;}
\DoxyCodeLine{08957\ \ \ \textcolor{keywordtype}{int}\ row\_length\ =\ num\_cols\ *\ block\_bytes;}
\DoxyCodeLine{08958\ \ \ \textcolor{keywordtype}{int}\ linear\_size\ =\ row\_length\ *\ num\_rows;}
\DoxyCodeLine{08959\ }
\DoxyCodeLine{08960\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{08961\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_LINEARSIZE)\ \{}
\DoxyCodeLine{08962\ \ \ \ \ \ \ nassertr(linear\_size\ ==\ (\textcolor{keywordtype}{int})header.pitch,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{08963\ \ \ \ \ \}}
\DoxyCodeLine{08964\ \ \ \}}
\DoxyCodeLine{08965\ }
\DoxyCodeLine{08966\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(linear\_size);}
\DoxyCodeLine{08967\ }
\DoxyCodeLine{08968\ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 4)\ \{}
\DoxyCodeLine{08969\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ flip\ the\ image\ as\ we\ read\ it,\ because\ of\ DirectX's\ inverted}}
\DoxyCodeLine{08970\ \ \ \ \ \textcolor{comment}{//\ sense\ of\ up.\ \ That\ means\ we\ (a)\ reverse\ the\ order\ of\ the\ rows\ of\ blocks}}
\DoxyCodeLine{08971\ \ \ \ \ \textcolor{comment}{//\ .\ .\ .}}
\DoxyCodeLine{08972\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ri\ =\ num\_rows\ -\/\ 1;\ ri\ >=\ 0;\ -\/-\/ri)\ \{}
\DoxyCodeLine{08973\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ row\_length\ *\ ri;}
\DoxyCodeLine{08974\ \ \ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{08975\ }
\DoxyCodeLine{08976\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{08977\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ .\ .\ .\ and\ (b)\ within\ each\ block,\ we\ reverse\ the\ 4\ individual\ rows}}
\DoxyCodeLine{08978\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ 4\ pixels.}}
\DoxyCodeLine{08979\ \ \ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{08980\ }
\DoxyCodeLine{08981\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Alpha.\ \ The\ block\ is\ four\ 16-\/bit\ words\ of\ pixel\ data.}}
\DoxyCodeLine{08982\ \ \ \ \ \ \ \ \ uint32\_t\ w0\ =\ cells[0];}
\DoxyCodeLine{08983\ \ \ \ \ \ \ \ \ uint32\_t\ w1\ =\ cells[1];}
\DoxyCodeLine{08984\ \ \ \ \ \ \ \ \ w0\ =\ ((w0\ \&\ 0xffff)\ <<\ 16)\ |\ ((w0\ \&\ 0xffff0000U)\ >>\ 16);}
\DoxyCodeLine{08985\ \ \ \ \ \ \ \ \ w1\ =\ ((w1\ \&\ 0xffff)\ <<\ 16)\ |\ ((w1\ \&\ 0xffff0000U)\ >>\ 16);}
\DoxyCodeLine{08986\ \ \ \ \ \ \ \ \ cells[0]\ =\ w1;}
\DoxyCodeLine{08987\ \ \ \ \ \ \ \ \ cells[1]\ =\ w0;}
\DoxyCodeLine{08988\ }
\DoxyCodeLine{08989\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Color.\ \ Only\ the\ second\ 32-\/bit\ dword\ of\ the\ color\ block\ represents}}
\DoxyCodeLine{08990\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ pixel\ data.}}
\DoxyCodeLine{08991\ \ \ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[3];}
\DoxyCodeLine{08992\ \ \ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 24)\ |\ ((w\ \&\ 0xff00)\ <<\ 8)\ |\ ((w\ \&\ 0xff0000)\ >>\ 8)\ |\ ((w\ \&\ 0xff000000U)\ >>\ 24);}
\DoxyCodeLine{08993\ \ \ \ \ \ \ \ \ cells[3]\ =\ w;}
\DoxyCodeLine{08994\ }
\DoxyCodeLine{08995\ \ \ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{08996\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08997\ \ \ \ \ \}}
\DoxyCodeLine{08998\ }
\DoxyCodeLine{08999\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 2)\ \{}
\DoxyCodeLine{09000\ \ \ \ \ \textcolor{comment}{//\ To\ invert\ a\ two-\/pixel\ high\ image,\ we\ just\ flip\ two\ rows\ within\ a\ cell.}}
\DoxyCodeLine{09001\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09002\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09003\ }
\DoxyCodeLine{09004\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09005\ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{09006\ }
\DoxyCodeLine{09007\ \ \ \ \ \ \ uint32\_t\ w0\ =\ cells[0];}
\DoxyCodeLine{09008\ \ \ \ \ \ \ w0\ =\ ((w0\ \&\ 0xffff)\ <<\ 16)\ |\ ((w0\ \&\ 0xffff0000U)\ >>\ 16);}
\DoxyCodeLine{09009\ \ \ \ \ \ \ cells[0]\ =\ w0;}
\DoxyCodeLine{09010\ }
\DoxyCodeLine{09011\ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[3];}
\DoxyCodeLine{09012\ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 8)\ |\ ((w\ \&\ 0xff00)\ >>\ 8);}
\DoxyCodeLine{09013\ \ \ \ \ \ \ cells[3]\ =\ w;}
\DoxyCodeLine{09014\ }
\DoxyCodeLine{09015\ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{09016\ \ \ \ \ \}}
\DoxyCodeLine{09017\ }
\DoxyCodeLine{09018\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 1)\ \{}
\DoxyCodeLine{09019\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ invert\ a\ one-\/pixel-\/high\ image.}}
\DoxyCodeLine{09020\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09021\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09022\ \ \ \}}
\DoxyCodeLine{09023\ }
\DoxyCodeLine{09024\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{09025\ \}}
\DoxyCodeLine{09026\ }
\DoxyCodeLine{09030\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{09031\ read\_dds\_level\_bc3(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{09032\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{09033\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{09034\ }
\DoxyCodeLine{09035\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ div\ =\ 4;}
\DoxyCodeLine{09036\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ block\_bytes\ =\ 16;}
\DoxyCodeLine{09037\ }
\DoxyCodeLine{09038\ \ \ \textcolor{comment}{//\ The\ DXT5\ image\ is\ similar\ to\ DXT3,\ in\ that\ there\ each\ 4x4\ block\ of\ pixels}}
\DoxyCodeLine{09039\ \ \ \textcolor{comment}{//\ consists\ of\ an\ alpha\ block\ and\ a\ color\ block,\ but\ the\ layout\ of\ the\ alpha}}
\DoxyCodeLine{09040\ \ \ \textcolor{comment}{//\ block\ is\ different.}}
\DoxyCodeLine{09041\ \ \ \textcolor{keywordtype}{int}\ num\_cols\ =\ max(div,\ x\_size)\ /\ div;}
\DoxyCodeLine{09042\ \ \ \textcolor{keywordtype}{int}\ num\_rows\ =\ max(div,\ y\_size)\ /\ div;}
\DoxyCodeLine{09043\ \ \ \textcolor{keywordtype}{int}\ row\_length\ =\ num\_cols\ *\ block\_bytes;}
\DoxyCodeLine{09044\ \ \ \textcolor{keywordtype}{int}\ linear\_size\ =\ row\_length\ *\ num\_rows;}
\DoxyCodeLine{09045\ }
\DoxyCodeLine{09046\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{09047\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_LINEARSIZE)\ \{}
\DoxyCodeLine{09048\ \ \ \ \ \ \ nassertr(linear\_size\ ==\ (\textcolor{keywordtype}{int})header.pitch,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{09049\ \ \ \ \ \}}
\DoxyCodeLine{09050\ \ \ \}}
\DoxyCodeLine{09051\ }
\DoxyCodeLine{09052\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(linear\_size);}
\DoxyCodeLine{09053\ }
\DoxyCodeLine{09054\ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 4)\ \{}
\DoxyCodeLine{09055\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ flip\ the\ image\ as\ we\ read\ it,\ because\ of\ DirectX's\ inverted}}
\DoxyCodeLine{09056\ \ \ \ \ \textcolor{comment}{//\ sense\ of\ up.\ \ That\ means\ we\ (a)\ reverse\ the\ order\ of\ the\ rows\ of\ blocks}}
\DoxyCodeLine{09057\ \ \ \ \ \textcolor{comment}{//\ .\ .\ .}}
\DoxyCodeLine{09058\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ri\ =\ num\_rows\ -\/\ 1;\ ri\ >=\ 0;\ -\/-\/ri)\ \{}
\DoxyCodeLine{09059\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ row\_length\ *\ ri;}
\DoxyCodeLine{09060\ \ \ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09061\ }
\DoxyCodeLine{09062\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09063\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ .\ .\ .\ and\ (b)\ within\ each\ block,\ we\ reverse\ the\ 4\ individual\ rows}}
\DoxyCodeLine{09064\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ 4\ pixels.}}
\DoxyCodeLine{09065\ \ \ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{09066\ }
\DoxyCodeLine{09067\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Alpha.\ \ The\ block\ is\ one\ 16-\/bit\ word\ of\ reference\ values,\ followed}}
\DoxyCodeLine{09068\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ by\ six\ words\ of\ pixel\ values,\ in\ 12-\/bit\ rows.\ \ Tricky\ to\ invert.}}
\DoxyCodeLine{09069\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09070\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09071\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09072\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p5\ =\ p[5];}
\DoxyCodeLine{09073\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p6\ =\ p[6];}
\DoxyCodeLine{09074\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p7\ =\ p[7];}
\DoxyCodeLine{09075\ }
\DoxyCodeLine{09076\ \ \ \ \ \ \ \ \ p[2]\ =\ ((p7\ \&\ 0xf)\ <<\ 4)\ |\ ((p6\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09077\ \ \ \ \ \ \ \ \ p[3]\ =\ ((p5\ \&\ 0xf)\ <<\ 4)\ |\ ((p7\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09078\ \ \ \ \ \ \ \ \ p[4]\ =\ ((p6\ \&\ 0xf)\ <<\ 4)\ |\ ((p5\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09079\ \ \ \ \ \ \ \ \ p[5]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09080\ \ \ \ \ \ \ \ \ p[6]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09081\ \ \ \ \ \ \ \ \ p[7]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09082\ }
\DoxyCodeLine{09083\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Color.\ \ Only\ the\ second\ 32-\/bit\ dword\ of\ the\ color\ block\ represents}}
\DoxyCodeLine{09084\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ pixel\ data.}}
\DoxyCodeLine{09085\ \ \ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[3];}
\DoxyCodeLine{09086\ \ \ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 24)\ |\ ((w\ \&\ 0xff00)\ <<\ 8)\ |\ ((w\ \&\ 0xff0000)\ >>\ 8)\ |\ ((w\ \&\ 0xff000000U)\ >>\ 24);}
\DoxyCodeLine{09087\ \ \ \ \ \ \ \ \ cells[3]\ =\ w;}
\DoxyCodeLine{09088\ }
\DoxyCodeLine{09089\ \ \ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{09090\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09091\ \ \ \ \ \}}
\DoxyCodeLine{09092\ }
\DoxyCodeLine{09093\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 2)\ \{}
\DoxyCodeLine{09094\ \ \ \ \ \textcolor{comment}{//\ To\ invert\ a\ two-\/pixel\ high\ image,\ we\ just\ flip\ two\ rows\ within\ a\ cell.}}
\DoxyCodeLine{09095\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09096\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09097\ }
\DoxyCodeLine{09098\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09099\ \ \ \ \ \ \ uint32\_t\ *cells\ =\ (uint32\_t\ *)p;}
\DoxyCodeLine{09100\ }
\DoxyCodeLine{09101\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09102\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09103\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09104\ }
\DoxyCodeLine{09105\ \ \ \ \ \ \ p[2]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09106\ \ \ \ \ \ \ p[3]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09107\ \ \ \ \ \ \ p[4]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09108\ }
\DoxyCodeLine{09109\ \ \ \ \ \ \ uint32\_t\ w0\ =\ cells[0];}
\DoxyCodeLine{09110\ \ \ \ \ \ \ w0\ =\ ((w0\ \&\ 0xffff)\ <<\ 16)\ |\ ((w0\ \&\ 0xffff0000U)\ >>\ 16);}
\DoxyCodeLine{09111\ \ \ \ \ \ \ cells[0]\ =\ w0;}
\DoxyCodeLine{09112\ }
\DoxyCodeLine{09113\ \ \ \ \ \ \ uint32\_t\ w\ =\ cells[3];}
\DoxyCodeLine{09114\ \ \ \ \ \ \ w\ =\ ((w\ \&\ 0xff)\ <<\ 8)\ |\ ((w\ \&\ 0xff00)\ >>\ 8);}
\DoxyCodeLine{09115\ \ \ \ \ \ \ cells[3]\ =\ w;}
\DoxyCodeLine{09116\ }
\DoxyCodeLine{09117\ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{09118\ \ \ \ \ \}}
\DoxyCodeLine{09119\ }
\DoxyCodeLine{09120\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 1)\ \{}
\DoxyCodeLine{09121\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ invert\ a\ one-\/pixel-\/high\ image.}}
\DoxyCodeLine{09122\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09123\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09124\ \ \ \}}
\DoxyCodeLine{09125\ }
\DoxyCodeLine{09126\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{09127\ \}}
\DoxyCodeLine{09128\ }
\DoxyCodeLine{09132\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{09133\ read\_dds\_level\_bc4(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{09134\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{09135\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{09136\ }
\DoxyCodeLine{09137\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ div\ =\ 4;}
\DoxyCodeLine{09138\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ block\_bytes\ =\ 8;}
\DoxyCodeLine{09139\ }
\DoxyCodeLine{09140\ \ \ \textcolor{comment}{//\ The\ ATI1\ (BC4)\ format\ uses\ the\ same\ compression\ mechanism\ as\ the\ alpha}}
\DoxyCodeLine{09141\ \ \ \textcolor{comment}{//\ channel\ of\ DXT5.}}
\DoxyCodeLine{09142\ \ \ \textcolor{keywordtype}{int}\ num\_cols\ =\ max(div,\ x\_size)\ /\ div;}
\DoxyCodeLine{09143\ \ \ \textcolor{keywordtype}{int}\ num\_rows\ =\ max(div,\ y\_size)\ /\ div;}
\DoxyCodeLine{09144\ \ \ \textcolor{keywordtype}{int}\ row\_length\ =\ num\_cols\ *\ block\_bytes;}
\DoxyCodeLine{09145\ \ \ \textcolor{keywordtype}{int}\ linear\_size\ =\ row\_length\ *\ num\_rows;}
\DoxyCodeLine{09146\ }
\DoxyCodeLine{09147\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{09148\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_LINEARSIZE)\ \{}
\DoxyCodeLine{09149\ \ \ \ \ \ \ nassertr(linear\_size\ ==\ (\textcolor{keywordtype}{int})header.pitch,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{09150\ \ \ \ \ \}}
\DoxyCodeLine{09151\ \ \ \}}
\DoxyCodeLine{09152\ }
\DoxyCodeLine{09153\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(linear\_size);}
\DoxyCodeLine{09154\ }
\DoxyCodeLine{09155\ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 4)\ \{}
\DoxyCodeLine{09156\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ flip\ the\ image\ as\ we\ read\ it,\ because\ of\ DirectX's\ inverted}}
\DoxyCodeLine{09157\ \ \ \ \ \textcolor{comment}{//\ sense\ of\ up.\ \ That\ means\ we\ (a)\ reverse\ the\ order\ of\ the\ rows\ of\ blocks}}
\DoxyCodeLine{09158\ \ \ \ \ \textcolor{comment}{//\ .\ .\ .}}
\DoxyCodeLine{09159\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ri\ =\ num\_rows\ -\/\ 1;\ ri\ >=\ 0;\ -\/-\/ri)\ \{}
\DoxyCodeLine{09160\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ row\_length\ *\ ri;}
\DoxyCodeLine{09161\ \ \ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09162\ }
\DoxyCodeLine{09163\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09164\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ .\ .\ .\ and\ (b)\ within\ each\ block,\ we\ reverse\ the\ 4\ individual\ rows}}
\DoxyCodeLine{09165\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ 4\ pixels.\ \ The\ block\ is\ one\ 16-\/bit\ word\ of\ reference\ values,}}
\DoxyCodeLine{09166\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ followed\ by\ six\ words\ of\ pixel\ values,\ in\ 12-\/bit\ rows.\ \ Tricky\ to}}
\DoxyCodeLine{09167\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ invert.}}
\DoxyCodeLine{09168\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09169\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09170\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09171\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p5\ =\ p[5];}
\DoxyCodeLine{09172\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p6\ =\ p[6];}
\DoxyCodeLine{09173\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p7\ =\ p[7];}
\DoxyCodeLine{09174\ }
\DoxyCodeLine{09175\ \ \ \ \ \ \ \ \ p[2]\ =\ ((p7\ \&\ 0xf)\ <<\ 4)\ |\ ((p6\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09176\ \ \ \ \ \ \ \ \ p[3]\ =\ ((p5\ \&\ 0xf)\ <<\ 4)\ |\ ((p7\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09177\ \ \ \ \ \ \ \ \ p[4]\ =\ ((p6\ \&\ 0xf)\ <<\ 4)\ |\ ((p5\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09178\ \ \ \ \ \ \ \ \ p[5]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09179\ \ \ \ \ \ \ \ \ p[6]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09180\ \ \ \ \ \ \ \ \ p[7]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09181\ }
\DoxyCodeLine{09182\ \ \ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{09183\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09184\ \ \ \ \ \}}
\DoxyCodeLine{09185\ }
\DoxyCodeLine{09186\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 2)\ \{}
\DoxyCodeLine{09187\ \ \ \ \ \textcolor{comment}{//\ To\ invert\ a\ two-\/pixel\ high\ image,\ we\ just\ flip\ two\ rows\ within\ a\ cell.}}
\DoxyCodeLine{09188\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09189\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09190\ }
\DoxyCodeLine{09191\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09192\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09193\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09194\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09195\ }
\DoxyCodeLine{09196\ \ \ \ \ \ \ p[2]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09197\ \ \ \ \ \ \ p[3]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09198\ \ \ \ \ \ \ p[4]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09199\ }
\DoxyCodeLine{09200\ \ \ \ \ \ \ p\ +=\ block\_bytes;}
\DoxyCodeLine{09201\ \ \ \ \ \}}
\DoxyCodeLine{09202\ }
\DoxyCodeLine{09203\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 1)\ \{}
\DoxyCodeLine{09204\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ invert\ a\ one-\/pixel-\/high\ image.}}
\DoxyCodeLine{09205\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09206\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09207\ \ \ \}}
\DoxyCodeLine{09208\ }
\DoxyCodeLine{09209\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{09210\ \}}
\DoxyCodeLine{09211\ }
\DoxyCodeLine{09215\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ Texture::}
\DoxyCodeLine{09216\ read\_dds\_level\_bc5(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ CData\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structDDSHeader}{DDSHeader}}\ \&header,\ \textcolor{keywordtype}{int}\ n,\ istream\ \&in)\ \{}
\DoxyCodeLine{09217\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{09218\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ tex-\/>do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{09219\ }
\DoxyCodeLine{09220\ \ \ \textcolor{comment}{//\ The\ ATI2\ (BC5)\ format\ uses\ the\ same\ compression\ mechanism\ as\ the\ ATI1}}
\DoxyCodeLine{09221\ \ \ \textcolor{comment}{//\ (BC4)\ format,\ but\ doubles\ the\ channels.}}
\DoxyCodeLine{09222\ \ \ \textcolor{keywordtype}{int}\ num\_cols\ =\ max(4,\ x\_size)\ /\ 2;}
\DoxyCodeLine{09223\ \ \ \textcolor{keywordtype}{int}\ num\_rows\ =\ max(4,\ y\_size)\ /\ 4;}
\DoxyCodeLine{09224\ \ \ \textcolor{keywordtype}{int}\ row\_length\ =\ num\_cols\ *\ 8;}
\DoxyCodeLine{09225\ \ \ \textcolor{keywordtype}{int}\ linear\_size\ =\ row\_length\ *\ num\_rows;}
\DoxyCodeLine{09226\ }
\DoxyCodeLine{09227\ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0)\ \{}
\DoxyCodeLine{09228\ \ \ \ \ \textcolor{keywordflow}{if}\ (header.dds\_flags\ \&\ DDSD\_LINEARSIZE)\ \{}
\DoxyCodeLine{09229\ \ \ \ \ \ \ nassertr(linear\_size\ ==\ (\textcolor{keywordtype}{int})header.pitch,\ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}());}
\DoxyCodeLine{09230\ \ \ \ \ \}}
\DoxyCodeLine{09231\ \ \ \}}
\DoxyCodeLine{09232\ }
\DoxyCodeLine{09233\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(linear\_size);}
\DoxyCodeLine{09234\ }
\DoxyCodeLine{09235\ \ \ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 4)\ \{}
\DoxyCodeLine{09236\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ flip\ the\ image\ as\ we\ read\ it,\ because\ of\ DirectX's\ inverted}}
\DoxyCodeLine{09237\ \ \ \ \ \textcolor{comment}{//\ sense\ of\ up.\ \ That\ means\ we\ (a)\ reverse\ the\ order\ of\ the\ rows\ of\ blocks}}
\DoxyCodeLine{09238\ \ \ \ \ \textcolor{comment}{//\ .\ .\ .}}
\DoxyCodeLine{09239\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ri\ =\ num\_rows\ -\/\ 1;\ ri\ >=\ 0;\ -\/-\/ri)\ \{}
\DoxyCodeLine{09240\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p()\ +\ row\_length\ *\ ri;}
\DoxyCodeLine{09241\ \ \ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09242\ }
\DoxyCodeLine{09243\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09244\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ .\ .\ .\ and\ (b)\ within\ each\ block,\ we\ reverse\ the\ 4\ individual\ rows}}
\DoxyCodeLine{09245\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ 4\ pixels.\ \ The\ block\ is\ one\ 16-\/bit\ word\ of\ reference\ values,}}
\DoxyCodeLine{09246\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ followed\ by\ six\ words\ of\ pixel\ values,\ in\ 12-\/bit\ rows.\ \ Tricky\ to}}
\DoxyCodeLine{09247\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ invert.}}
\DoxyCodeLine{09248\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09249\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09250\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09251\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p5\ =\ p[5];}
\DoxyCodeLine{09252\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p6\ =\ p[6];}
\DoxyCodeLine{09253\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p7\ =\ p[7];}
\DoxyCodeLine{09254\ }
\DoxyCodeLine{09255\ \ \ \ \ \ \ \ \ p[2]\ =\ ((p7\ \&\ 0xf)\ <<\ 4)\ |\ ((p6\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09256\ \ \ \ \ \ \ \ \ p[3]\ =\ ((p5\ \&\ 0xf)\ <<\ 4)\ |\ ((p7\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09257\ \ \ \ \ \ \ \ \ p[4]\ =\ ((p6\ \&\ 0xf)\ <<\ 4)\ |\ ((p5\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09258\ \ \ \ \ \ \ \ \ p[5]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09259\ \ \ \ \ \ \ \ \ p[6]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09260\ \ \ \ \ \ \ \ \ p[7]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09261\ }
\DoxyCodeLine{09262\ \ \ \ \ \ \ \ \ p\ +=\ 8;}
\DoxyCodeLine{09263\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09264\ \ \ \ \ \}}
\DoxyCodeLine{09265\ }
\DoxyCodeLine{09266\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 2)\ \{}
\DoxyCodeLine{09267\ \ \ \ \ \textcolor{comment}{//\ To\ invert\ a\ two-\/pixel\ high\ image,\ we\ just\ flip\ two\ rows\ within\ a\ cell.}}
\DoxyCodeLine{09268\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09269\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09270\ }
\DoxyCodeLine{09271\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ num\_cols;\ ++ci)\ \{}
\DoxyCodeLine{09272\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p2\ =\ p[2];}
\DoxyCodeLine{09273\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p3\ =\ p[3];}
\DoxyCodeLine{09274\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ p4\ =\ p[4];}
\DoxyCodeLine{09275\ }
\DoxyCodeLine{09276\ \ \ \ \ \ \ p[2]\ =\ ((p4\ \&\ 0xf)\ <<\ 4)\ |\ ((p3\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09277\ \ \ \ \ \ \ p[3]\ =\ ((p2\ \&\ 0xf)\ <<\ 4)\ |\ ((p4\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09278\ \ \ \ \ \ \ p[4]\ =\ ((p3\ \&\ 0xf)\ <<\ 4)\ |\ ((p2\ \&\ 0xf0)\ >>\ 4);}
\DoxyCodeLine{09279\ }
\DoxyCodeLine{09280\ \ \ \ \ \ \ p\ +=\ 8;}
\DoxyCodeLine{09281\ \ \ \ \ \}}
\DoxyCodeLine{09282\ }
\DoxyCodeLine{09283\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (y\_size\ >=\ 1)\ \{}
\DoxyCodeLine{09284\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ invert\ a\ one-\/pixel-\/high\ image.}}
\DoxyCodeLine{09285\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ image.p();}
\DoxyCodeLine{09286\ \ \ \ \ in.read((\textcolor{keywordtype}{char}\ *)p,\ row\_length);}
\DoxyCodeLine{09287\ \ \ \}}
\DoxyCodeLine{09288\ }
\DoxyCodeLine{09289\ \ \ \textcolor{keywordflow}{return}\ image;}
\DoxyCodeLine{09290\ \}}
\DoxyCodeLine{09291\ }
\DoxyCodeLine{09298\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09299\ clear\_prepared(\mbox{\hyperlink{classPreparedGraphicsObjects}{PreparedGraphicsObjects}}\ *prepared\_objects)\ \{}
\DoxyCodeLine{09300\ \ \ Contexts::iterator\ ci;}
\DoxyCodeLine{09301\ \ \ ci\ =\ \_contexts.find(prepared\_objects);}
\DoxyCodeLine{09302\ \ \ \textcolor{keywordflow}{if}\ (ci\ !=\ \_contexts.end())\ \{}
\DoxyCodeLine{09303\ \ \ \ \ \_contexts.erase(ci);}
\DoxyCodeLine{09304\ \ \ \}}
\DoxyCodeLine{09305\ \}}
\DoxyCodeLine{09306\ }
\DoxyCodeLine{09311\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09312\ consider\_downgrade(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keywordtype}{int}\ num\_channels,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ \{}
\DoxyCodeLine{09313\ \ \ \textcolor{keywordflow}{if}\ (num\_channels\ !=\ 0\ \&\&\ num\_channels\ <\ pnmimage.get\_num\_channels())\ \{}
\DoxyCodeLine{09314\ \ \ \ \ \textcolor{comment}{//\ One\ special\ case:\ we\ can't\ reduce\ from\ 3\ to\ 2\ components,\ since\ that}}
\DoxyCodeLine{09315\ \ \ \ \ \textcolor{comment}{//\ would\ require\ adding\ an\ alpha\ channel.}}
\DoxyCodeLine{09316\ \ \ \ \ \textcolor{keywordflow}{if}\ (pnmimage.get\_num\_channels()\ ==\ 3\ \&\&\ num\_channels\ ==\ 2)\ \{}
\DoxyCodeLine{09317\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09318\ \ \ \ \ \}}
\DoxyCodeLine{09319\ }
\DoxyCodeLine{09320\ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{09321\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Downgrading\ "{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}}
\DoxyCodeLine{09322\ \ \ \ \ \ \ <<\ pnmimage.get\_num\_channels()\ <<\ \textcolor{stringliteral}{"{}\ components\ to\ "{}}}
\DoxyCodeLine{09323\ \ \ \ \ \ \ <<\ num\_channels\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{09324\ \ \ \ \ pnmimage.set\_num\_channels(num\_channels);}
\DoxyCodeLine{09325\ \ \ \}}
\DoxyCodeLine{09326\ \}}
\DoxyCodeLine{09327\ }
\DoxyCodeLine{09333\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{09334\ compare\_images(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&b)\ \{}
\DoxyCodeLine{09335\ \ \ nassertr(a.get\_maxval()\ ==\ 255\ \&\&\ b.get\_maxval()\ ==\ 255,\ \textcolor{keyword}{false});}
\DoxyCodeLine{09336\ \ \ nassertr(a.get\_num\_channels()\ ==\ 4\ \&\&\ b.get\_num\_channels()\ ==\ 4,\ \textcolor{keyword}{false});}
\DoxyCodeLine{09337\ \ \ nassertr(a.get\_x\_size()\ ==\ b.get\_x\_size()\ \&\&}
\DoxyCodeLine{09338\ \ \ \ \ \ \ \ \ \ \ \ a.get\_y\_size()\ ==\ b.get\_y\_size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{09339\ }
\DoxyCodeLine{09340\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *a\_array\ =\ a.get\_array();}
\DoxyCodeLine{09341\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *b\_array\ =\ b.get\_array();}
\DoxyCodeLine{09342\ \ \ \textcolor{keyword}{const}\ xelval\ *a\_alpha\ =\ a.get\_alpha\_array();}
\DoxyCodeLine{09343\ \ \ \textcolor{keyword}{const}\ xelval\ *b\_alpha\ =\ b.get\_alpha\_array();}
\DoxyCodeLine{09344\ }
\DoxyCodeLine{09345\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ a.get\_x\_size();}
\DoxyCodeLine{09346\ }
\DoxyCodeLine{09347\ \ \ \textcolor{keywordtype}{int}\ delta\ =\ 0;}
\DoxyCodeLine{09348\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ a.get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{09349\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *a\_row\ =\ a\_array\ +\ yi\ *\ x\_size;}
\DoxyCodeLine{09350\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{xel}}\ *b\_row\ =\ b\_array\ +\ yi\ *\ x\_size;}
\DoxyCodeLine{09351\ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *a\_alpha\_row\ =\ a\_alpha\ +\ yi\ *\ x\_size;}
\DoxyCodeLine{09352\ \ \ \ \ \textcolor{keyword}{const}\ xelval\ *b\_alpha\_row\ =\ b\_alpha\ +\ yi\ *\ x\_size;}
\DoxyCodeLine{09353\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ x\_size;\ ++xi)\ \{}
\DoxyCodeLine{09354\ \ \ \ \ \ \ delta\ +=\ abs(PPM\_GETR(a\_row[xi])\ -\/\ PPM\_GETR(b\_row[xi]));}
\DoxyCodeLine{09355\ \ \ \ \ \ \ delta\ +=\ abs(PPM\_GETG(a\_row[xi])\ -\/\ PPM\_GETG(b\_row[xi]));}
\DoxyCodeLine{09356\ \ \ \ \ \ \ delta\ +=\ abs(PPM\_GETB(a\_row[xi])\ -\/\ PPM\_GETB(b\_row[xi]));}
\DoxyCodeLine{09357\ \ \ \ \ \ \ delta\ +=\ abs(a\_alpha\_row[xi]\ -\/\ b\_alpha\_row[xi]);}
\DoxyCodeLine{09358\ \ \ \ \ \}}
\DoxyCodeLine{09359\ \ \ \}}
\DoxyCodeLine{09360\ }
\DoxyCodeLine{09361\ \ \ \textcolor{keywordtype}{double}\ average\_delta\ =\ (double)delta\ /\ ((\textcolor{keywordtype}{double})a.get\_x\_size()\ *\ (double)b.get\_y\_size()\ *\ (double)a.get\_maxval());}
\DoxyCodeLine{09362\ \ \ \textcolor{keywordflow}{return}\ (average\_delta\ <=\ simple\_image\_threshold);}
\DoxyCodeLine{09363\ \}}
\DoxyCodeLine{09364\ }
\DoxyCodeLine{09374\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09375\ do\_filter\_2d\_mipmap\_pages(\textcolor{keyword}{const}\ CData\ *cdata,}
\DoxyCodeLine{09376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{Texture::RamImage}}\ \&to,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{Texture::RamImage}}\ \&from,}
\DoxyCodeLine{09377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{09378\ \ \ Filter2DComponent\ *filter\_component;}
\DoxyCodeLine{09379\ \ \ Filter2DComponent\ *filter\_alpha;}
\DoxyCodeLine{09380\ }
\DoxyCodeLine{09381\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(cdata-\/>\_format))\ \{}
\DoxyCodeLine{09382\ \ \ \ \ \textcolor{comment}{//\ We\ currently\ only\ support\ sRGB\ mipmap\ generation\ for\ unsigned\ byte}}
\DoxyCodeLine{09383\ \ \ \ \ \textcolor{comment}{//\ textures,\ due\ to\ our\ use\ of\ a\ lookup\ table.}}
\DoxyCodeLine{09384\ \ \ \ \ nassertv(cdata-\/>\_component\_type\ ==\ T\_unsigned\_byte);}
\DoxyCodeLine{09385\ }
\DoxyCodeLine{09386\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_sse2\_sRGB\_encode())\ \{}
\DoxyCodeLine{09387\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_2d\_unsigned\_byte\_srgb\_sse2;}
\DoxyCodeLine{09388\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09389\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_2d\_unsigned\_byte\_srgb;}
\DoxyCodeLine{09390\ \ \ \ \ \}}
\DoxyCodeLine{09391\ }
\DoxyCodeLine{09392\ \ \ \ \ \textcolor{comment}{//\ Alpha\ is\ always\ linear.}}
\DoxyCodeLine{09393\ \ \ \ \ filter\_alpha\ =\ \&filter\_2d\_unsigned\_byte;}
\DoxyCodeLine{09394\ }
\DoxyCodeLine{09395\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09396\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_component\_type)\ \{}
\DoxyCodeLine{09397\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{09398\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_2d\_unsigned\_byte;}
\DoxyCodeLine{09399\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09400\ }
\DoxyCodeLine{09401\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{09402\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_2d\_unsigned\_short;}
\DoxyCodeLine{09403\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09404\ }
\DoxyCodeLine{09405\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{09406\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_2d\_float;}
\DoxyCodeLine{09407\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09408\ }
\DoxyCodeLine{09409\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{09410\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{09411\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ mipmaps\ for\ 2D\ texture\ with\ component\ type\ "{}}}
\DoxyCodeLine{09412\ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_component\_type\ <<\ \textcolor{stringliteral}{"{}!"{}};}
\DoxyCodeLine{09413\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09414\ \ \ \ \ \}}
\DoxyCodeLine{09415\ \ \ \ \ filter\_alpha\ =\ filter\_component;}
\DoxyCodeLine{09416\ \ \ \}}
\DoxyCodeLine{09417\ }
\DoxyCodeLine{09418\ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size\ =\ cdata-\/>\_num\_components\ *\ cdata-\/>\_component\_width;}
\DoxyCodeLine{09419\ \ \ \textcolor{keywordtype}{size\_t}\ row\_size\ =\ (size\_t)x\_size\ *\ pixel\_size;}
\DoxyCodeLine{09420\ }
\DoxyCodeLine{09421\ \ \ \textcolor{keywordtype}{int}\ to\_x\_size\ =\ max(x\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{09422\ \ \ \textcolor{keywordtype}{int}\ to\_y\_size\ =\ max(y\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{09423\ }
\DoxyCodeLine{09424\ \ \ \textcolor{keywordtype}{size\_t}\ to\_row\_size\ =\ (size\_t)to\_x\_size\ *\ pixel\_size;}
\DoxyCodeLine{09425\ \ \ to.\_page\_size\ =\ (size\_t)to\_y\_size\ *\ to\_row\_size;}
\DoxyCodeLine{09426\ \ \ to.\_image\ =\ PTA\_uchar::empty\_array(to.\_page\_size\ *\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views,\ get\_class\_type());}
\DoxyCodeLine{09427\ }
\DoxyCodeLine{09428\ \ \ \textcolor{keywordtype}{bool}\ alpha\ =\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}(cdata-\/>\_format);}
\DoxyCodeLine{09429\ \ \ \textcolor{keywordtype}{int}\ num\_color\_components\ =\ cdata-\/>\_num\_components;}
\DoxyCodeLine{09430\ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09431\ \ \ \ \ -\/-\/num\_color\_components;}
\DoxyCodeLine{09432\ \ \ \}}
\DoxyCodeLine{09433\ }
\DoxyCodeLine{09434\ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ cdata-\/>\_z\_size\ *\ cdata-\/>\_num\_views;}
\DoxyCodeLine{09435\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{09436\ \ \ \ \ \textcolor{comment}{//\ For\ each\ level.}}
\DoxyCodeLine{09437\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ to.\_image.p()\ +\ z\ *\ to.\_page\_size;}
\DoxyCodeLine{09438\ \ \ \ \ nassertv(p\ <=\ to.\_image.p()\ +\ to.\_image.size()\ +\ to.\_page\_size);}
\DoxyCodeLine{09439\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *q\ =\ from.\_image.p()\ +\ z\ *\ from.\_page\_size;}
\DoxyCodeLine{09440\ \ \ \ \ nassertv(q\ <=\ from.\_image.p()\ +\ from.\_image.size()\ +\ from.\_page\_size);}
\DoxyCodeLine{09441\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09442\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y;}
\DoxyCodeLine{09443\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ 0;\ y\ <\ y\_size\ -\/\ 1;\ y\ +=\ 2)\ \{}
\DoxyCodeLine{09444\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ row.}}
\DoxyCodeLine{09445\ \ \ \ \ \ \ \ \ nassertv(p\ ==\ to.\_image.p()\ +\ z\ *\ to.\_page\_size\ +\ (y\ /\ 2)\ *\ to\_row\_size);}
\DoxyCodeLine{09446\ \ \ \ \ \ \ \ \ nassertv(q\ ==\ from.\_image.p()\ +\ z\ *\ from.\_page\_size\ +\ y\ *\ row\_size);}
\DoxyCodeLine{09447\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09448\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09449\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09450\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09452\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ row\_size);}
\DoxyCodeLine{09454\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ row\_size);}
\DoxyCodeLine{09457\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09458\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09459\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09460\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09461\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09462\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09463\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09464\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09465\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09466\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09468\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ row\_size);}
\DoxyCodeLine{09469\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09470\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09471\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ 0,\ row\_size);}
\DoxyCodeLine{09472\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09474\ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09475\ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{09476\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09477\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_size)\ \{}
\DoxyCodeLine{09478\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ row.}}
\DoxyCodeLine{09479\ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09480\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09481\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09482\ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ row.}}
\DoxyCodeLine{09483\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09484\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09486\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09487\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09488\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09489\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ 0);}
\DoxyCodeLine{09490\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09491\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09492\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ 0);}
\DoxyCodeLine{09493\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09494\ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09495\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09496\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09497\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09498\ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09499\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09500\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09501\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09502\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09503\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09504\ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ 0);}
\DoxyCodeLine{09505\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09506\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09507\ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ 0);}
\DoxyCodeLine{09508\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09509\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09510\ \ \ \ \ \}}
\DoxyCodeLine{09511\ }
\DoxyCodeLine{09512\ \ \ \ \ nassertv(p\ ==\ to.\_image.p()\ +\ (z\ +\ 1)\ *\ to.\_page\_size);}
\DoxyCodeLine{09513\ \ \ \ \ nassertv(q\ ==\ from.\_image.p()\ +\ (z\ +\ 1)\ *\ from.\_page\_size);}
\DoxyCodeLine{09514\ \ \ \}}
\DoxyCodeLine{09515\ \}}
\DoxyCodeLine{09516\ }
\DoxyCodeLine{09526\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09527\ do\_filter\_3d\_mipmap\_level(\textcolor{keyword}{const}\ CData\ *cdata,}
\DoxyCodeLine{09528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture_1_1RamImage}{Texture::RamImage}}\ \&to,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1RamImage}{Texture::RamImage}}\ \&from,}
\DoxyCodeLine{09529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ z\_size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{09530\ \ \ Filter3DComponent\ *filter\_component;}
\DoxyCodeLine{09531\ \ \ Filter3DComponent\ *filter\_alpha;}
\DoxyCodeLine{09532\ }
\DoxyCodeLine{09533\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_a4a98c3914b9781fb143c6e05128f5738}{is\_srgb}}(cdata-\/>\_format))\ \{}
\DoxyCodeLine{09534\ \ \ \ \ \textcolor{comment}{//\ We\ currently\ only\ support\ sRGB\ mipmap\ generation\ for\ unsigned\ byte}}
\DoxyCodeLine{09535\ \ \ \ \ \textcolor{comment}{//\ textures,\ due\ to\ our\ use\ of\ a\ lookup\ table.}}
\DoxyCodeLine{09536\ \ \ \ \ nassertv(cdata-\/>\_component\_type\ ==\ T\_unsigned\_byte);}
\DoxyCodeLine{09537\ }
\DoxyCodeLine{09538\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_sse2\_sRGB\_encode())\ \{}
\DoxyCodeLine{09539\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_3d\_unsigned\_byte\_srgb\_sse2;}
\DoxyCodeLine{09540\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09541\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_3d\_unsigned\_byte\_srgb;}
\DoxyCodeLine{09542\ \ \ \ \ \}}
\DoxyCodeLine{09543\ }
\DoxyCodeLine{09544\ \ \ \ \ \textcolor{comment}{//\ Alpha\ is\ always\ linear.}}
\DoxyCodeLine{09545\ \ \ \ \ filter\_alpha\ =\ \&filter\_3d\_unsigned\_byte;}
\DoxyCodeLine{09546\ }
\DoxyCodeLine{09547\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09548\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_component\_type)\ \{}
\DoxyCodeLine{09549\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_byte:}
\DoxyCodeLine{09550\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_3d\_unsigned\_byte;}
\DoxyCodeLine{09551\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09552\ }
\DoxyCodeLine{09553\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_unsigned\_short:}
\DoxyCodeLine{09554\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_3d\_unsigned\_short;}
\DoxyCodeLine{09555\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09556\ }
\DoxyCodeLine{09557\ \ \ \ \ \textcolor{keywordflow}{case}\ T\_float:}
\DoxyCodeLine{09558\ \ \ \ \ \ \ filter\_component\ =\ \&filter\_3d\_float;}
\DoxyCodeLine{09559\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09560\ }
\DoxyCodeLine{09561\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{09562\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{09563\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ generate\ mipmaps\ for\ 3D\ texture\ with\ component\ type\ "{}}}
\DoxyCodeLine{09564\ \ \ \ \ \ \ \ \ <<\ cdata-\/>\_component\_type\ <<\ \textcolor{stringliteral}{"{}!"{}};}
\DoxyCodeLine{09565\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09566\ \ \ \ \ \}}
\DoxyCodeLine{09567\ \ \ \ \ filter\_alpha\ =\ filter\_component;}
\DoxyCodeLine{09568\ \ \ \}}
\DoxyCodeLine{09569\ }
\DoxyCodeLine{09570\ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size\ =\ cdata-\/>\_num\_components\ *\ cdata-\/>\_component\_width;}
\DoxyCodeLine{09571\ \ \ \textcolor{keywordtype}{size\_t}\ row\_size\ =\ (size\_t)x\_size\ *\ pixel\_size;}
\DoxyCodeLine{09572\ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ (size\_t)y\_size\ *\ row\_size;}
\DoxyCodeLine{09573\ \ \ \textcolor{keywordtype}{size\_t}\ view\_size\ =\ (size\_t)z\_size\ *\ page\_size;}
\DoxyCodeLine{09574\ }
\DoxyCodeLine{09575\ \ \ \textcolor{keywordtype}{int}\ to\_x\_size\ =\ max(x\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{09576\ \ \ \textcolor{keywordtype}{int}\ to\_y\_size\ =\ max(y\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{09577\ \ \ \textcolor{keywordtype}{int}\ to\_z\_size\ =\ max(z\_size\ >>\ 1,\ 1);}
\DoxyCodeLine{09578\ }
\DoxyCodeLine{09579\ \ \ \textcolor{keywordtype}{size\_t}\ to\_row\_size\ =\ (size\_t)to\_x\_size\ *\ pixel\_size;}
\DoxyCodeLine{09580\ \ \ \textcolor{keywordtype}{size\_t}\ to\_page\_size\ =\ (size\_t)to\_y\_size\ *\ to\_row\_size;}
\DoxyCodeLine{09581\ \ \ \textcolor{keywordtype}{size\_t}\ to\_view\_size\ =\ (size\_t)to\_z\_size\ *\ to\_page\_size;}
\DoxyCodeLine{09582\ \ \ to.\_page\_size\ =\ to\_page\_size;}
\DoxyCodeLine{09583\ \ \ to.\_image\ =\ PTA\_uchar::empty\_array(to\_page\_size\ *\ to\_z\_size\ *\ cdata-\/>\_num\_views,\ get\_class\_type());}
\DoxyCodeLine{09584\ }
\DoxyCodeLine{09585\ \ \ \textcolor{keywordtype}{bool}\ alpha\ =\ \mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{has\_alpha}}(cdata-\/>\_format);}
\DoxyCodeLine{09586\ \ \ \textcolor{keywordtype}{int}\ num\_color\_components\ =\ cdata-\/>\_num\_components;}
\DoxyCodeLine{09587\ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09588\ \ \ \ \ -\/-\/num\_color\_components;}
\DoxyCodeLine{09589\ \ \ \}}
\DoxyCodeLine{09590\ }
\DoxyCodeLine{09591\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ cdata-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{09592\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *start\_to\ =\ to.\_image.p()\ +\ view\ *\ to\_view\_size;}
\DoxyCodeLine{09593\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *start\_from\ =\ from.\_image.p()\ +\ view\ *\ view\_size;}
\DoxyCodeLine{09594\ \ \ \ \ nassertv(start\_to\ +\ to\_view\_size\ <=\ to.\_image.p()\ +\ to.\_image.size());}
\DoxyCodeLine{09595\ \ \ \ \ nassertv(start\_from\ +\ view\_size\ <=\ from.\_image.p()\ +\ from.\_image.size());}
\DoxyCodeLine{09596\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *p\ =\ start\_to;}
\DoxyCodeLine{09597\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *q\ =\ start\_from;}
\DoxyCodeLine{09598\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09599\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ z;}
\DoxyCodeLine{09600\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (z\ =\ 0;\ z\ <\ z\_size\ -\/\ 1;\ z\ +=\ 2)\ \{}
\DoxyCodeLine{09601\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ level.}}
\DoxyCodeLine{09602\ \ \ \ \ \ \ \ \ nassertv(p\ ==\ start\_to\ +\ (z\ /\ 2)\ *\ to\_page\_size);}
\DoxyCodeLine{09603\ \ \ \ \ \ \ \ \ nassertv(q\ ==\ start\_from\ +\ z\ *\ page\_size);}
\DoxyCodeLine{09604\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09605\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y;}
\DoxyCodeLine{09606\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ 0;\ y\ <\ y\_size\ -\/\ 1;\ y\ +=\ 2)\ \{}
\DoxyCodeLine{09607\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ row.}}
\DoxyCodeLine{09608\ \ \ \ \ \ \ \ \ \ \ \ \ nassertv(p\ ==\ start\_to\ +\ (z\ /\ 2)\ *\ to\_page\_size\ +\ (y\ /\ 2)\ *\ to\_row\_size);}
\DoxyCodeLine{09609\ \ \ \ \ \ \ \ \ \ \ \ \ nassertv(q\ ==\ start\_from\ +\ z\ *\ page\_size\ +\ y\ *\ row\_size);}
\DoxyCodeLine{09610\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09611\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09612\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09613\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09616\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ row\_size,\ page\_size);}
\DoxyCodeLine{09617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09619\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ row\_size,\ page\_size);}
\DoxyCodeLine{09620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09627\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ row\_size,\ page\_size);}
\DoxyCodeLine{09632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09633\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ 0,\ row\_size,\ page\_size);}
\DoxyCodeLine{09635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09636\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09637\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09638\ \ \ \ \ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{09639\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09640\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_size)\ \{}
\DoxyCodeLine{09641\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ row.}}
\DoxyCodeLine{09642\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09643\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09644\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09645\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ row.}}
\DoxyCodeLine{09646\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09647\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09648\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ 0,\ page\_size);}
\DoxyCodeLine{09653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ 0,\ page\_size);}
\DoxyCodeLine{09656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09657\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09658\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09659\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09662\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09663\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09664\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09665\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09666\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ 0,\ page\_size);}
\DoxyCodeLine{09668\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09669\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ 0,\ 0,\ page\_size);}
\DoxyCodeLine{09671\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09672\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09673\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09674\ \ \ \ \ \ \ \ \ q\ +=\ page\_size;}
\DoxyCodeLine{09675\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09676\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ <\ z\_size)\ \{}
\DoxyCodeLine{09677\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ page.}}
\DoxyCodeLine{09678\ \ \ \ \ \ \ \ \ q\ +=\ page\_size;}
\DoxyCodeLine{09679\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09680\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09681\ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ page.}}
\DoxyCodeLine{09682\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09683\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y;}
\DoxyCodeLine{09684\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ 0;\ y\ <\ y\_size\ -\/\ 1;\ y\ +=\ 2)\ \{}
\DoxyCodeLine{09685\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ row.}}
\DoxyCodeLine{09686\ \ \ \ \ \ \ \ \ \ \ nassertv(p\ ==\ start\_to\ +\ (y\ /\ 2)\ *\ to\_row\_size);}
\DoxyCodeLine{09687\ \ \ \ \ \ \ \ \ \ \ nassertv(q\ ==\ start\_from\ +\ y\ *\ row\_size);}
\DoxyCodeLine{09688\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09689\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09690\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09691\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09692\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09693\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ row\_size,\ 0);}
\DoxyCodeLine{09695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ row\_size,\ 0);}
\DoxyCodeLine{09698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09700\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09701\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09704\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09705\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09706\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09707\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ row\_size,\ 0);}
\DoxyCodeLine{09710\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09711\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ 0,\ row\_size,\ 0);}
\DoxyCodeLine{09713\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09714\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09715\ \ \ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09716\ \ \ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{09717\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09718\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_size)\ \{}
\DoxyCodeLine{09719\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ row.}}
\DoxyCodeLine{09720\ \ \ \ \ \ \ \ \ \ \ q\ +=\ row\_size;}
\DoxyCodeLine{09721\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09722\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09723\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ row.}}
\DoxyCodeLine{09724\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_size\ !=\ 1)\ \{}
\DoxyCodeLine{09725\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x;}
\DoxyCodeLine{09726\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ 0;\ x\ <\ x\_size\ -\/\ 1;\ x\ +=\ 2)\ \{}
\DoxyCodeLine{09727\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ pixel.}}
\DoxyCodeLine{09728\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ pixel\_size,\ 0,\ 0);}
\DoxyCodeLine{09731\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09732\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ pixel\_size,\ 0,\ 0);}
\DoxyCodeLine{09734\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09735\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09736\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09737\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_size)\ \{}
\DoxyCodeLine{09738\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ the\ last\ odd\ pixel.}}
\DoxyCodeLine{09739\ \ \ \ \ \ \ \ \ \ \ \ \ q\ +=\ pixel\_size;}
\DoxyCodeLine{09740\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09741\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09742\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ one\ pixel.}}
\DoxyCodeLine{09743\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ num\_color\_components;\ ++c)\ \{}
\DoxyCodeLine{09744\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ component.}}
\DoxyCodeLine{09745\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_component(p,\ q,\ 0,\ 0,\ 0);}
\DoxyCodeLine{09746\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09747\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{09748\ \ \ \ \ \ \ \ \ \ \ \ \ filter\_alpha(p,\ q,\ 0,\ 0,\ 0);}
\DoxyCodeLine{09749\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09750\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09751\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09752\ \ \ \ \ \}}
\DoxyCodeLine{09753\ }
\DoxyCodeLine{09754\ \ \ \ \ nassertv(p\ ==\ start\_to\ +\ to\_z\_size\ *\ to\_page\_size);}
\DoxyCodeLine{09755\ \ \ \ \ nassertv(q\ ==\ start\_from\ +\ z\_size\ *\ page\_size);}
\DoxyCodeLine{09756\ \ \ \}}
\DoxyCodeLine{09757\ \}}
\DoxyCodeLine{09758\ }
\DoxyCodeLine{09763\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09764\ filter\_2d\_unsigned\_byte(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size)\ \{}
\DoxyCodeLine{09766\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ result\ =\ ((\textcolor{keywordtype}{unsigned}\ int)q[0]\ +}
\DoxyCodeLine{09767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size]\ +}
\DoxyCodeLine{09768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)q[row\_size]\ +}
\DoxyCodeLine{09769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size\ +\ row\_size])\ >>\ 2;}
\DoxyCodeLine{09770\ \ \ *p\ =\ (\textcolor{keywordtype}{unsigned}\ char)result;}
\DoxyCodeLine{09771\ \ \ ++p;}
\DoxyCodeLine{09772\ \ \ ++q;}
\DoxyCodeLine{09773\ \}}
\DoxyCodeLine{09774\ }
\DoxyCodeLine{09779\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09780\ filter\_2d\_unsigned\_byte\_srgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size)\ \{}
\DoxyCodeLine{09782\ \ \ \textcolor{keywordtype}{float}\ result\ =\ (decode\_sRGB\_float(q[0])\ +}
\DoxyCodeLine{09783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size])\ +}
\DoxyCodeLine{09784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size])\ +}
\DoxyCodeLine{09785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size]));}
\DoxyCodeLine{09786\ }
\DoxyCodeLine{09787\ \ \ *p\ =\ encode\_sRGB\_uchar(result\ *\ 0.25f);}
\DoxyCodeLine{09788\ \ \ ++p;}
\DoxyCodeLine{09789\ \ \ ++q;}
\DoxyCodeLine{09790\ \}}
\DoxyCodeLine{09791\ }
\DoxyCodeLine{09796\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09797\ filter\_2d\_unsigned\_byte\_srgb\_sse2(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size)\ \{}
\DoxyCodeLine{09799\ \ \ \textcolor{keywordtype}{float}\ result\ =\ (decode\_sRGB\_float(q[0])\ +}
\DoxyCodeLine{09800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size])\ +}
\DoxyCodeLine{09801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size])\ +}
\DoxyCodeLine{09802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size]));}
\DoxyCodeLine{09803\ }
\DoxyCodeLine{09804\ \ \ *p\ =\ encode\_sRGB\_uchar\_sse2(result\ *\ 0.25f);}
\DoxyCodeLine{09805\ \ \ ++p;}
\DoxyCodeLine{09806\ \ \ ++q;}
\DoxyCodeLine{09807\ \}}
\DoxyCodeLine{09808\ }
\DoxyCodeLine{09813\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09814\ filter\_2d\_unsigned\_short(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09815\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size)\ \{}
\DoxyCodeLine{09816\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ result\ =\ ((\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[0]\ +}
\DoxyCodeLine{09817\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size]\ +}
\DoxyCodeLine{09818\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[row\_size]\ +}
\DoxyCodeLine{09819\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size\ +\ row\_size])\ >>\ 2;}
\DoxyCodeLine{09820\ \ \ store\_unscaled\_short(p,\ result);}
\DoxyCodeLine{09821\ \ \ q\ +=\ 2;}
\DoxyCodeLine{09822\ \}}
\DoxyCodeLine{09823\ }
\DoxyCodeLine{09828\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09829\ filter\_2d\_float(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size)\ \{}
\DoxyCodeLine{09831\ \ \ *(\textcolor{keywordtype}{float}\ *)p\ =\ (*(\textcolor{keywordtype}{float}\ *)\&q[0]\ +}
\DoxyCodeLine{09832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size]\ +}
\DoxyCodeLine{09833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[row\_size]\ +}
\DoxyCodeLine{09834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size\ +\ row\_size])\ /\ 4.0f;}
\DoxyCodeLine{09835\ \ \ p\ +=\ 4;}
\DoxyCodeLine{09836\ \ \ q\ +=\ 4;}
\DoxyCodeLine{09837\ \}}
\DoxyCodeLine{09838\ }
\DoxyCodeLine{09844\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09845\ filter\_3d\_unsigned\_byte(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{09847\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ result\ =\ ((\textcolor{keywordtype}{unsigned}\ int)q[0]\ +}
\DoxyCodeLine{09848\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size]\ +}
\DoxyCodeLine{09849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)q[row\_size]\ +}
\DoxyCodeLine{09850\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size\ +\ row\_size]\ +}
\DoxyCodeLine{09851\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)q[page\_size]\ +}
\DoxyCodeLine{09852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)q[row\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})q[pixel\_size\ +\ row\_size\ +\ page\_size])\ >>\ 3;}
\DoxyCodeLine{09855\ \ \ *p\ =\ (\textcolor{keywordtype}{unsigned}\ char)result;}
\DoxyCodeLine{09856\ \ \ ++p;}
\DoxyCodeLine{09857\ \ \ ++q;}
\DoxyCodeLine{09858\ \}}
\DoxyCodeLine{09859\ }
\DoxyCodeLine{09865\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09866\ filter\_3d\_unsigned\_byte\_srgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09867\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{09868\ \ \ \textcolor{keywordtype}{float}\ result\ =\ (decode\_sRGB\_float(q[0])\ +}
\DoxyCodeLine{09869\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size])\ +}
\DoxyCodeLine{09870\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size])\ +}
\DoxyCodeLine{09871\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size])\ +}
\DoxyCodeLine{09872\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[page\_size])\ +}
\DoxyCodeLine{09873\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ page\_size])\ +}
\DoxyCodeLine{09874\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size\ +\ page\_size])\ +}
\DoxyCodeLine{09875\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size\ +\ page\_size]));}
\DoxyCodeLine{09876\ }
\DoxyCodeLine{09877\ \ \ *p\ =\ encode\_sRGB\_uchar(result\ *\ 0.125f);}
\DoxyCodeLine{09878\ \ \ ++p;}
\DoxyCodeLine{09879\ \ \ ++q;}
\DoxyCodeLine{09880\ \}}
\DoxyCodeLine{09881\ }
\DoxyCodeLine{09887\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09888\ filter\_3d\_unsigned\_byte\_srgb\_sse2(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{09890\ \ \ \textcolor{keywordtype}{float}\ result\ =\ (decode\_sRGB\_float(q[0])\ +}
\DoxyCodeLine{09891\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size])\ +}
\DoxyCodeLine{09892\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size])\ +}
\DoxyCodeLine{09893\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size])\ +}
\DoxyCodeLine{09894\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[page\_size])\ +}
\DoxyCodeLine{09895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ page\_size])\ +}
\DoxyCodeLine{09896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[row\_size\ +\ page\_size])\ +}
\DoxyCodeLine{09897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ decode\_sRGB\_float(q[pixel\_size\ +\ row\_size\ +\ page\_size]));}
\DoxyCodeLine{09898\ }
\DoxyCodeLine{09899\ \ \ *p\ =\ encode\_sRGB\_uchar\_sse2(result\ *\ 0.125f);}
\DoxyCodeLine{09900\ \ \ ++p;}
\DoxyCodeLine{09901\ \ \ ++q;}
\DoxyCodeLine{09902\ \}}
\DoxyCodeLine{09903\ }
\DoxyCodeLine{09909\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09910\ filter\_3d\_unsigned\_short(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size,}
\DoxyCodeLine{09912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{09913\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ result\ =\ ((\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[0]\ +}
\DoxyCodeLine{09914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size]\ +}
\DoxyCodeLine{09915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[row\_size]\ +}
\DoxyCodeLine{09916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size\ +\ row\_size]\ +}
\DoxyCodeLine{09917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[page\_size]\ +}
\DoxyCodeLine{09918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[row\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ int)*(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)\&q[pixel\_size\ +\ row\_size\ +\ page\_size])\ >>\ 3;}
\DoxyCodeLine{09921\ \ \ store\_unscaled\_short(p,\ result);}
\DoxyCodeLine{09922\ \ \ q\ +=\ 2;}
\DoxyCodeLine{09923\ \}}
\DoxyCodeLine{09924\ }
\DoxyCodeLine{09930\ \textcolor{keywordtype}{void}\ Texture::}
\DoxyCodeLine{09931\ filter\_3d\_float(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&p,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\&q,}
\DoxyCodeLine{09932\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pixel\_size,\ \textcolor{keywordtype}{size\_t}\ row\_size,\ \textcolor{keywordtype}{size\_t}\ page\_size)\ \{}
\DoxyCodeLine{09933\ \ \ *(\textcolor{keywordtype}{float}\ *)p\ =\ (*(\textcolor{keywordtype}{float}\ *)\&q[0]\ +}
\DoxyCodeLine{09934\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size]\ +}
\DoxyCodeLine{09935\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[row\_size]\ +}
\DoxyCodeLine{09936\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size\ +\ row\_size]\ +}
\DoxyCodeLine{09937\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[page\_size]\ +}
\DoxyCodeLine{09938\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09939\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[row\_size\ +\ page\_size]\ +}
\DoxyCodeLine{09940\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{float}\ *)\&q[pixel\_size\ +\ row\_size\ +\ page\_size])\ /\ 8.0f;}
\DoxyCodeLine{09941\ \ \ p\ +=\ 4;}
\DoxyCodeLine{09942\ \ \ q\ +=\ 4;}
\DoxyCodeLine{09943\ \}}
\DoxyCodeLine{09944\ }
\DoxyCodeLine{09948\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{09949\ do\_squish(CData\ *cdata,\ Texture::CompressionMode\ compression,\ \textcolor{keywordtype}{int}\ squish\_flags)\ \{}
\DoxyCodeLine{09950\ \textcolor{preprocessor}{\#ifdef\ HAVE\_SQUISH}}
\DoxyCodeLine{09951\ \ \ \textcolor{keywordflow}{if}\ (!do\_has\_all\_ram\_mipmap\_images(cdata))\ \{}
\DoxyCodeLine{09952\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ about\ to\ compress\ the\ RAM\ image,\ we\ should\ ensure\ that\ we\ have}}
\DoxyCodeLine{09953\ \ \ \ \ \textcolor{comment}{//\ all\ of\ the\ mipmap\ levels\ first.}}
\DoxyCodeLine{09954\ \ \ \ \ \mbox{\hyperlink{classTexture_a5a7f55af421662cf740d37a4e09106c4}{do\_generate\_ram\_mipmap\_images}}(cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{09955\ \ \ \}}
\DoxyCodeLine{09956\ }
\DoxyCodeLine{09957\ \ \ RamImages\ compressed\_ram\_images;}
\DoxyCodeLine{09958\ \ \ compressed\_ram\_images.reserve(cdata-\/>\_ram\_images.size());}
\DoxyCodeLine{09959\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{09960\ \ \ \ \ RamImage\ compressed\_image;}
\DoxyCodeLine{09961\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{09962\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{09963\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n);}
\DoxyCodeLine{09964\ \ \ \ \ \textcolor{keywordtype}{int}\ page\_size\ =\ squish::GetStorageRequirements(x\_size,\ y\_size,\ squish\_flags);}
\DoxyCodeLine{09965\ \ \ \ \ \textcolor{keywordtype}{int}\ cell\_size\ =\ squish::GetStorageRequirements(4,\ 4,\ squish\_flags);}
\DoxyCodeLine{09966\ }
\DoxyCodeLine{09967\ \ \ \ \ compressed\_image.\_page\_size\ =\ page\_size;}
\DoxyCodeLine{09968\ \ \ \ \ compressed\_image.\_image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ num\_pages);}
\DoxyCodeLine{09969\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{09970\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\_page\ =\ compressed\_image.\_image.p()\ +\ z\ *\ page\_size;}
\DoxyCodeLine{09971\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *source\_page\ =\ cdata-\/>\_ram\_images[n].\_image.p()\ +\ z\ *\ cdata-\/>\_ram\_images[n].\_page\_size;}
\DoxyCodeLine{09972\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *source\_page\_end\ =\ source\_page\ +\ cdata-\/>\_ram\_images[n].\_page\_size;}
\DoxyCodeLine{09973\ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ one\ 4\ x\ 4\ cell\ at\ a\ time.}}
\DoxyCodeLine{09974\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *d\ =\ dest\_page;}
\DoxyCodeLine{09975\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_size;\ y\ +=\ 4)\ \{}
\DoxyCodeLine{09976\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ x\ +=\ 4)\ \{}
\DoxyCodeLine{09977\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tb[16\ *\ 4];}
\DoxyCodeLine{09978\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ mask\ =\ 0;}
\DoxyCodeLine{09979\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *t\ =\ tb;}
\DoxyCodeLine{09980\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 16;\ ++i)\ \{}
\DoxyCodeLine{09981\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xi\ =\ x\ +\ i\ \%\ 4;}
\DoxyCodeLine{09982\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ yi\ =\ y\ +\ i\ /\ 4;}
\DoxyCodeLine{09983\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *s\ =\ source\_page\ +\ (yi\ *\ x\_size\ +\ xi)\ *\ cdata-\/>\_num\_components;}
\DoxyCodeLine{09984\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\ <\ source\_page\_end)\ \{}
\DoxyCodeLine{09985\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_num\_components)\ \{}
\DoxyCodeLine{09986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{09987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ =\ s[0];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{09988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ =\ s[0];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{09989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ =\ s[0];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{09990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[3]\ =\ 255;\ \ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{09991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09992\ }
\DoxyCodeLine{09993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{09994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ =\ s[0];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{09995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ =\ s[0];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{09996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ =\ s[0];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{09997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[3]\ =\ s[1];\ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{09998\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09999\ }
\DoxyCodeLine{10000\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{10001\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ =\ s[2];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{10002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ =\ s[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ =\ s[0];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{10004\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[3]\ =\ 255;\ \ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{10005\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10006\ }
\DoxyCodeLine{10007\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{10008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ =\ s[2];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{10009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ =\ s[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ =\ s[0];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{10011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t[3]\ =\ s[3];\ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{10012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10013\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mask\ |=\ (1\ <<\ i);}
\DoxyCodeLine{10015\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10016\ \ \ \ \ \ \ \ \ \ \ \ \ t\ +=\ 4;}
\DoxyCodeLine{10017\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10018\ \ \ \ \ \ \ \ \ \ \ squish::CompressMasked(tb,\ mask,\ d,\ squish\_flags);}
\DoxyCodeLine{10019\ \ \ \ \ \ \ \ \ \ \ d\ +=\ cell\_size;}
\DoxyCodeLine{10020\ \ \ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{10021\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10022\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10023\ \ \ \ \ \}}
\DoxyCodeLine{10024\ \ \ \ \ compressed\_ram\_images.push\_back(compressed\_image);}
\DoxyCodeLine{10025\ \ \ \}}
\DoxyCodeLine{10026\ \ \ cdata-\/>\_ram\_images.swap(compressed\_ram\_images);}
\DoxyCodeLine{10027\ \ \ cdata-\/>\_ram\_image\_compression\ =\ compression;}
\DoxyCodeLine{10028\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{10029\ }
\DoxyCodeLine{10030\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{10031\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{10032\ }
\DoxyCodeLine{10033\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{10034\ \}}
\DoxyCodeLine{10035\ }
\DoxyCodeLine{10039\ \textcolor{keywordtype}{bool}\ Texture::}
\DoxyCodeLine{10040\ do\_unsquish(CData\ *cdata,\ \textcolor{keywordtype}{int}\ squish\_flags)\ \{}
\DoxyCodeLine{10041\ \textcolor{preprocessor}{\#ifdef\ HAVE\_SQUISH}}
\DoxyCodeLine{10042\ \ \ RamImages\ uncompressed\_ram\_images;}
\DoxyCodeLine{10043\ \ \ uncompressed\_ram\_images.reserve(cdata-\/>\_ram\_images.size());}
\DoxyCodeLine{10044\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{10045\ \ \ \ \ RamImage\ uncompressed\_image;}
\DoxyCodeLine{10046\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ do\_get\_expected\_mipmap\_x\_size(cdata,\ n);}
\DoxyCodeLine{10047\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ do\_get\_expected\_mipmap\_y\_size(cdata,\ n);}
\DoxyCodeLine{10048\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ do\_get\_expected\_mipmap\_num\_pages(cdata,\ n);}
\DoxyCodeLine{10049\ \ \ \ \ \textcolor{keywordtype}{int}\ page\_size\ =\ squish::GetStorageRequirements(x\_size,\ y\_size,\ squish\_flags);}
\DoxyCodeLine{10050\ \ \ \ \ \textcolor{keywordtype}{int}\ cell\_size\ =\ squish::GetStorageRequirements(4,\ 4,\ squish\_flags);}
\DoxyCodeLine{10051\ }
\DoxyCodeLine{10052\ \ \ \ \ uncompressed\_image.\_page\_size\ =\ do\_get\_expected\_ram\_mipmap\_page\_size(cdata,\ n);}
\DoxyCodeLine{10053\ \ \ \ \ uncompressed\_image.\_image\ =\ PTA\_uchar::empty\_array(uncompressed\_image.\_page\_size\ *\ num\_pages);}
\DoxyCodeLine{10054\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ num\_pages;\ ++z)\ \{}
\DoxyCodeLine{10055\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\_page\ =\ uncompressed\_image.\_image.p()\ +\ z\ *\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{10056\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest\_page\_end\ =\ dest\_page\ +\ uncompressed\_image.\_page\_size;}
\DoxyCodeLine{10057\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *source\_page\ =\ cdata-\/>\_ram\_images[n].\_image.p()\ +\ z\ *\ page\_size;}
\DoxyCodeLine{10058\ \ \ \ \ \ \ \textcolor{comment}{//\ Unconvert\ one\ 4\ x\ 4\ cell\ at\ a\ time.}}
\DoxyCodeLine{10059\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *s\ =\ source\_page;}
\DoxyCodeLine{10060\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ y\_size;\ y\ +=\ 4)\ \{}
\DoxyCodeLine{10061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ x\_size;\ x\ +=\ 4)\ \{}
\DoxyCodeLine{10062\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tb[16\ *\ 4];}
\DoxyCodeLine{10063\ \ \ \ \ \ \ \ \ \ \ squish::Decompress(tb,\ s,\ squish\_flags);}
\DoxyCodeLine{10064\ \ \ \ \ \ \ \ \ \ \ s\ +=\ cell\_size;}
\DoxyCodeLine{10065\ }
\DoxyCodeLine{10066\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *t\ =\ tb;}
\DoxyCodeLine{10067\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 16;\ ++i)\ \{}
\DoxyCodeLine{10068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xi\ =\ x\ +\ i\ \%\ 4;}
\DoxyCodeLine{10069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ yi\ =\ y\ +\ i\ /\ 4;}
\DoxyCodeLine{10070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *d\ =\ dest\_page\ +\ (yi\ *\ x\_size\ +\ xi)\ *\ cdata-\/>\_num\_components;}
\DoxyCodeLine{10071\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d\ <\ dest\_page\_end)\ \{}
\DoxyCodeLine{10072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (cdata-\/>\_num\_components)\ \{}
\DoxyCodeLine{10073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{10074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[0]\ =\ t[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10076\ }
\DoxyCodeLine{10077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{10078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[0]\ =\ t[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[1]\ =\ t[3];\ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{10080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10081\ }
\DoxyCodeLine{10082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{10083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[2]\ =\ t[0];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{10084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[1]\ =\ t[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[0]\ =\ t[2];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{10086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10087\ }
\DoxyCodeLine{10088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{10089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[2]\ =\ t[0];\ \ \ \textcolor{comment}{//\ r}}
\DoxyCodeLine{10090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[1]\ =\ t[1];\ \ \ \textcolor{comment}{//\ g}}
\DoxyCodeLine{10091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[0]\ =\ t[2];\ \ \ \textcolor{comment}{//\ b}}
\DoxyCodeLine{10092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d[3]\ =\ t[3];\ \ \ \textcolor{comment}{//\ a}}
\DoxyCodeLine{10093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10095\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10096\ \ \ \ \ \ \ \ \ \ \ \ \ t\ +=\ 4;}
\DoxyCodeLine{10097\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10098\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10099\ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{10100\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10101\ \ \ \ \ \}}
\DoxyCodeLine{10102\ \ \ \ \ uncompressed\_ram\_images.push\_back(uncompressed\_image);}
\DoxyCodeLine{10103\ \ \ \}}
\DoxyCodeLine{10104\ \ \ cdata-\/>\_ram\_images.swap(uncompressed\_ram\_images);}
\DoxyCodeLine{10105\ \ \ cdata-\/>\_ram\_image\_compression\ =\ CM\_off;}
\DoxyCodeLine{10106\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{10107\ }
\DoxyCodeLine{10108\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{10109\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{10110\ }
\DoxyCodeLine{10111\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_SQUISH}}
\DoxyCodeLine{10112\ \}}
\DoxyCodeLine{10113\ }
\DoxyCodeLine{10117\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a8df8d2bc979d41a004ac5859c2719063}{Texture::}}}
\DoxyCodeLine{10118\ \mbox{\hyperlink{classTexture_a8df8d2bc979d41a004ac5859c2719063}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{10119\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classTexture_ae8f48031065ef9a9ef264038408071d5}{make\_from\_bam}});}
\DoxyCodeLine{10120\ \}}
\DoxyCodeLine{10121\ }
\DoxyCodeLine{10126\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_aa208571247a9116e3f64c64c3bbe861e}{Texture::}}}
\DoxyCodeLine{10127\ \mbox{\hyperlink{classTexture_aa208571247a9116e3f64c64c3bbe861e}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{10128\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{false});}
\DoxyCodeLine{10129\ }
\DoxyCodeLine{10130\ \ \ \textcolor{keywordtype}{bool}\ has\_rawdata\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10131\ \ \ \mbox{\hyperlink{classTexture_a8c7049f01b5178dcea3e3a93914a5443}{do\_write\_datagram\_header}}(cdata,\ manager,\ me,\ has\_rawdata);}
\DoxyCodeLine{10132\ \ \ \mbox{\hyperlink{classTexture_a3824ed6c0f6e88c7f4983c0bd9de7b93}{do\_write\_datagram\_body}}(cdata,\ manager,\ me);}
\DoxyCodeLine{10133\ }
\DoxyCodeLine{10134\ \ \ \textcolor{comment}{//\ If\ we\ are\ also\ including\ the\ texture's\ image\ data,\ then\ stuff\ it\ in\ here.}}
\DoxyCodeLine{10135\ \ \ \textcolor{keywordflow}{if}\ (has\_rawdata)\ \{}
\DoxyCodeLine{10136\ \ \ \ \ \mbox{\hyperlink{classTexture_a34715c983a4527823125f2cb12f567fb}{do\_write\_datagram\_rawdata}}(cdata,\ manager,\ me);}
\DoxyCodeLine{10137\ \ \ \}}
\DoxyCodeLine{10138\ \}}
\DoxyCodeLine{10139\ }
\DoxyCodeLine{10145\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a9256a6c5c16f7e3c95f7215a6a7ff527}{Texture::}}}
\DoxyCodeLine{10146\ \mbox{\hyperlink{classTexture_a9256a6c5c16f7e3c95f7215a6a7ff527}{finalize}}(\mbox{\hyperlink{classBamReader}{BamReader}}\ *)\ \{}
\DoxyCodeLine{10147\ \ \ \textcolor{comment}{//\ Unref\ the\ pointer\ that\ we\ explicitly\ reffed\ in\ make\_from\_bam().}}
\DoxyCodeLine{10148\ \ \ unref();}
\DoxyCodeLine{10149\ }
\DoxyCodeLine{10150\ \ \ \textcolor{comment}{//\ We\ should\ never\ get\ back\ to\ zero\ after\ unreffing\ our\ own\ count,\ because}}
\DoxyCodeLine{10151\ \ \ \textcolor{comment}{//\ we\ expect\ to\ have\ been\ stored\ in\ a\ pointer\ somewhere.\ \ If\ we\ do\ get\ to}}
\DoxyCodeLine{10152\ \ \ \textcolor{comment}{//\ zero,\ it's\ a\ memory\ leak;\ the\ way\ to\ avoid\ this\ is\ to\ call\ unref\_delete()}}
\DoxyCodeLine{10153\ \ \ \textcolor{comment}{//\ above\ instead\ of\ unref(),\ but\ this\ is\ dangerous\ to\ do\ from\ within\ a}}
\DoxyCodeLine{10154\ \ \ \textcolor{comment}{//\ virtual\ function.}}
\DoxyCodeLine{10155\ \ \ nassertv(get\_ref\_count()\ !=\ 0);}
\DoxyCodeLine{10156\ \}}
\DoxyCodeLine{10157\ }
\DoxyCodeLine{10158\ }
\DoxyCodeLine{10173\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a8c7049f01b5178dcea3e3a93914a5443}{Texture::}}}
\DoxyCodeLine{10174\ \mbox{\hyperlink{classTexture_a8c7049f01b5178dcea3e3a93914a5443}{do\_write\_datagram\_header}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me,\ \textcolor{keywordtype}{bool}\ \&has\_rawdata)\ \{}
\DoxyCodeLine{10175\ \ \ \textcolor{comment}{//\ Write\ out\ the\ texture's\ raw\ pixel\ data\ if\ (a)\ the\ current\ Bam\ Texture}}
\DoxyCodeLine{10176\ \ \ \textcolor{comment}{//\ Mode\ requires\ that,\ or\ (b)\ there's\ no\ filename,\ so\ the\ file\ can't\ be}}
\DoxyCodeLine{10177\ \ \ \textcolor{comment}{//\ loaded\ up\ from\ disk,\ but\ the\ raw\ pixel\ data\ is\ currently\ available\ in}}
\DoxyCodeLine{10178\ \ \ \textcolor{comment}{//\ RAM.}}
\DoxyCodeLine{10179\ }
\DoxyCodeLine{10180\ \ \ \textcolor{comment}{//\ Otherwise,\ we\ just\ write\ out\ the\ filename,\ and\ assume\ whoever\ loads\ the}}
\DoxyCodeLine{10181\ \ \ \textcolor{comment}{//\ bam\ file\ later\ will\ have\ access\ to\ the\ image\ file\ on\ disk.}}
\DoxyCodeLine{10182\ \ \ BamWriter::BamTextureMode\ file\_texture\_mode\ =\ manager-\/>get\_file\_texture\_mode();}
\DoxyCodeLine{10183\ \ \ has\_rawdata\ =\ (file\_texture\_mode\ ==\ BamWriter::BTM\_rawdata\ ||}
\DoxyCodeLine{10184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (cdata-\/>\_filename.empty()\ \&\&\ \mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata)));}
\DoxyCodeLine{10185\ \ \ \textcolor{keywordflow}{if}\ (has\_rawdata\ \&\&\ !\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata))\ \{}
\DoxyCodeLine{10186\ \ \ \ \ \mbox{\hyperlink{classTexture_a1f90b25b87791aab8a9abb80d35691d7}{do\_get\_bam\_rawdata}}(cdata);}
\DoxyCodeLine{10187\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata))\ \{}
\DoxyCodeLine{10188\ \ \ \ \ \ \ \textcolor{comment}{//\ No\ image\ data\ after\ all.}}
\DoxyCodeLine{10189\ \ \ \ \ \ \ has\_rawdata\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10190\ \ \ \ \ \}}
\DoxyCodeLine{10191\ \ \ \}}
\DoxyCodeLine{10192\ }
\DoxyCodeLine{10193\ \ \ \textcolor{keywordtype}{bool}\ has\_bam\_dir\ =\ !manager-\/>get\_filename().empty();}
\DoxyCodeLine{10194\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ bam\_dir\ =\ manager-\/>get\_filename().get\_dirname();}
\DoxyCodeLine{10195\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ cdata-\/>\_filename;}
\DoxyCodeLine{10196\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_filename\ =\ cdata-\/>\_alpha\_filename;}
\DoxyCodeLine{10197\ }
\DoxyCodeLine{10198\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{10199\ }
\DoxyCodeLine{10200\ \ \ \textcolor{keywordflow}{switch}\ (file\_texture\_mode)\ \{}
\DoxyCodeLine{10201\ \ \ \textcolor{keywordflow}{case}\ BamWriter::BTM\_unchanged:}
\DoxyCodeLine{10202\ \ \ \textcolor{keywordflow}{case}\ BamWriter::BTM\_rawdata:}
\DoxyCodeLine{10203\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10204\ }
\DoxyCodeLine{10205\ \ \ \textcolor{keywordflow}{case}\ BamWriter::BTM\_fullpath:}
\DoxyCodeLine{10206\ \ \ \ \ filename\ =\ cdata-\/>\_fullpath;}
\DoxyCodeLine{10207\ \ \ \ \ alpha\_filename\ =\ cdata-\/>\_alpha\_fullpath;}
\DoxyCodeLine{10208\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10209\ }
\DoxyCodeLine{10210\ \ \ \textcolor{keywordflow}{case}\ BamWriter::BTM\_relative:}
\DoxyCodeLine{10211\ \ \ \ \ filename\ =\ cdata-\/>\_fullpath;}
\DoxyCodeLine{10212\ \ \ \ \ alpha\_filename\ =\ cdata-\/>\_alpha\_fullpath;}
\DoxyCodeLine{10213\ \ \ \ \ bam\_dir.\mbox{\hyperlink{classFilename_ae7676d5949ee4b0023c4fa8396480719}{make\_absolute}}(vfs-\/>get\_cwd());}
\DoxyCodeLine{10214\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_bam\_dir\ ||\ !filename.\mbox{\hyperlink{classFilename_ad4b5858950028cbfdba4e703f97e94c7}{make\_relative\_to}}(bam\_dir,\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{10215\ \ \ \ \ \ \ filename.\mbox{\hyperlink{classFilename_ab4a7aacc9accfde1c097b7f1f7cdfe2d}{find\_on\_searchpath}}(get\_model\_path());}
\DoxyCodeLine{10216\ \ \ \ \ \}}
\DoxyCodeLine{10217\ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{10218\ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{10219\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ file\ "{}}\ <<\ cdata-\/>\_fullpath}
\DoxyCodeLine{10220\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ found\ as\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10221\ \ \ \ \ \}}
\DoxyCodeLine{10222\ \ \ \ \ \textcolor{keywordflow}{if}\ (!alpha\_filename.empty())\ \{}
\DoxyCodeLine{10223\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_bam\_dir\ ||\ !alpha\_filename.\mbox{\hyperlink{classFilename_ad4b5858950028cbfdba4e703f97e94c7}{make\_relative\_to}}(bam\_dir,\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{10224\ \ \ \ \ \ \ \ \ alpha\_filename.\mbox{\hyperlink{classFilename_ab4a7aacc9accfde1c097b7f1f7cdfe2d}{find\_on\_searchpath}}(get\_model\_path());}
\DoxyCodeLine{10225\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10226\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gobj\_cat.is\_debug())\ \{}
\DoxyCodeLine{10227\ \ \ \ \ \ \ \ \ gobj\_cat.debug()}
\DoxyCodeLine{10228\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Alpha\ image\ "{}}\ <<\ cdata-\/>\_alpha\_fullpath}
\DoxyCodeLine{10229\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ found\ as\ "{}}\ <<\ alpha\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10230\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10231\ \ \ \ \ \}}
\DoxyCodeLine{10232\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10233\ }
\DoxyCodeLine{10234\ \ \ \textcolor{keywordflow}{case}\ BamWriter::BTM\_basename:}
\DoxyCodeLine{10235\ \ \ \ \ filename\ =\ cdata-\/>\_fullpath.get\_basename();}
\DoxyCodeLine{10236\ \ \ \ \ alpha\_filename\ =\ cdata-\/>\_alpha\_fullpath.get\_basename();}
\DoxyCodeLine{10237\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10238\ }
\DoxyCodeLine{10239\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10240\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{10241\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unsupported\ bam-\/texture-\/mode:\ "{}}\ <<\ (int)file\_texture\_mode\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10242\ \ \ \}}
\DoxyCodeLine{10243\ }
\DoxyCodeLine{10244\ \ \ \textcolor{keywordflow}{if}\ (filename.empty())\ \{}
\DoxyCodeLine{10245\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_ae654aa59b51b5b38e5b1b47873c09205}{do\_has\_bam\_rawdata}}(cdata)\ ||\ cdata-\/>\_has\_clear\_color)\ \{}
\DoxyCodeLine{10246\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ filename,\ we\ have\ to\ store\ rawdata\ anyway.}}
\DoxyCodeLine{10247\ \ \ \ \ \ \ has\_rawdata\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{10248\ \ \ \ \ \}}
\DoxyCodeLine{10249\ \ \ \}}
\DoxyCodeLine{10250\ }
\DoxyCodeLine{10251\ \ \ me.add\_string(get\_name());}
\DoxyCodeLine{10252\ \ \ me.add\_string(filename);}
\DoxyCodeLine{10253\ \ \ me.add\_string(alpha\_filename);}
\DoxyCodeLine{10254\ \ \ me.add\_uint8(cdata-\/>\_primary\_file\_num\_channels);}
\DoxyCodeLine{10255\ \ \ me.add\_uint8(cdata-\/>\_alpha\_file\_channel);}
\DoxyCodeLine{10256\ \ \ me.add\_bool(has\_rawdata);}
\DoxyCodeLine{10257\ }
\DoxyCodeLine{10258\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ <\ 25\ \&\&}
\DoxyCodeLine{10259\ \ \ \ \ \ \ cdata-\/>\_texture\_type\ ==\ TT\_cube\_map)\ \{}
\DoxyCodeLine{10260\ \ \ \ \ \textcolor{comment}{//\ Between\ Panda3D\ releases\ 1.7.2\ and\ 1.8.0\ (bam\ versions\ 6.24\ and\ 6.25),}}
\DoxyCodeLine{10261\ \ \ \ \ \textcolor{comment}{//\ we\ added\ TT\_2d\_texture\_array,\ shifting\ the\ definition\ for\ TT\_cube\_map.}}
\DoxyCodeLine{10262\ \ \ \ \ me.add\_uint8(TT\_2d\_texture\_array);}
\DoxyCodeLine{10263\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10264\ \ \ \ \ me.add\_uint8(cdata-\/>\_texture\_type);}
\DoxyCodeLine{10265\ \ \ \}}
\DoxyCodeLine{10266\ }
\DoxyCodeLine{10267\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 32)\ \{}
\DoxyCodeLine{10268\ \ \ \ \ me.add\_bool(cdata-\/>\_has\_read\_mipmaps);}
\DoxyCodeLine{10269\ \ \ \}}
\DoxyCodeLine{10270\ \}}
\DoxyCodeLine{10271\ }
\DoxyCodeLine{10276\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a3824ed6c0f6e88c7f4983c0bd9de7b93}{Texture::}}}
\DoxyCodeLine{10277\ \mbox{\hyperlink{classTexture_a3824ed6c0f6e88c7f4983c0bd9de7b93}{do\_write\_datagram\_body}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{10278\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 36)\ \{}
\DoxyCodeLine{10279\ \ \ \ \ cdata-\/>\_default\_sampler.\mbox{\hyperlink{classSamplerState_a4fee8794e8abb1d6b57cbaa87470dec1}{write\_datagram}}(me);}
\DoxyCodeLine{10280\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10281\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classSamplerState}{SamplerState}}\ \&s\ =\ cdata-\/>\_default\_sampler;}
\DoxyCodeLine{10282\ \ \ \ \ me.add\_uint8(s.get\_wrap\_u());}
\DoxyCodeLine{10283\ \ \ \ \ me.add\_uint8(s.get\_wrap\_v());}
\DoxyCodeLine{10284\ \ \ \ \ me.add\_uint8(s.get\_wrap\_w());}
\DoxyCodeLine{10285\ \ \ \ \ me.add\_uint8(s.get\_minfilter());}
\DoxyCodeLine{10286\ \ \ \ \ me.add\_uint8(s.get\_magfilter());}
\DoxyCodeLine{10287\ \ \ \ \ me.add\_int16(s.get\_anisotropic\_degree());}
\DoxyCodeLine{10288\ \ \ \ \ s.get\_border\_color().write\_datagram(me);}
\DoxyCodeLine{10289\ \ \ \}}
\DoxyCodeLine{10290\ }
\DoxyCodeLine{10291\ \ \ me.add\_uint8(cdata-\/>\_compression);}
\DoxyCodeLine{10292\ \ \ me.add\_uint8(cdata-\/>\_quality\_level);}
\DoxyCodeLine{10293\ }
\DoxyCodeLine{10294\ \ \ me.add\_uint8(cdata-\/>\_format);}
\DoxyCodeLine{10295\ \ \ me.add\_uint8(cdata-\/>\_num\_components);}
\DoxyCodeLine{10296\ }
\DoxyCodeLine{10297\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ TT\_buffer\_texture)\ \{}
\DoxyCodeLine{10298\ \ \ \ \ me.add\_uint8(cdata-\/>\_usage\_hint);}
\DoxyCodeLine{10299\ \ \ \}}
\DoxyCodeLine{10300\ }
\DoxyCodeLine{10301\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 28)\ \{}
\DoxyCodeLine{10302\ \ \ \ \ me.add\_uint8(cdata-\/>\_auto\_texture\_scale);}
\DoxyCodeLine{10303\ \ \ \}}
\DoxyCodeLine{10304\ \ \ me.add\_uint32(cdata-\/>\_orig\_file\_x\_size);}
\DoxyCodeLine{10305\ \ \ me.add\_uint32(cdata-\/>\_orig\_file\_y\_size);}
\DoxyCodeLine{10306\ }
\DoxyCodeLine{10307\ \ \ \textcolor{keywordtype}{bool}\ has\_simple\_ram\_image\ =\ !cdata-\/>\_simple\_ram\_image.\_image.empty();}
\DoxyCodeLine{10308\ \ \ me.add\_bool(has\_simple\_ram\_image);}
\DoxyCodeLine{10309\ }
\DoxyCodeLine{10310\ \ \ \textcolor{comment}{//\ Write\ out\ the\ simple\ image\ too,\ so\ it\ will\ be\ available\ later.}}
\DoxyCodeLine{10311\ \ \ \textcolor{keywordflow}{if}\ (has\_simple\_ram\_image)\ \{}
\DoxyCodeLine{10312\ \ \ \ \ me.add\_uint32(cdata-\/>\_simple\_x\_size);}
\DoxyCodeLine{10313\ \ \ \ \ me.add\_uint32(cdata-\/>\_simple\_y\_size);}
\DoxyCodeLine{10314\ \ \ \ \ me.add\_int32(cdata-\/>\_simple\_image\_date\_generated);}
\DoxyCodeLine{10315\ \ \ \ \ me.add\_uint32(cdata-\/>\_simple\_ram\_image.\_image.size());}
\DoxyCodeLine{10316\ \ \ \ \ me.append\_data(cdata-\/>\_simple\_ram\_image.\_image,\ cdata-\/>\_simple\_ram\_image.\_image.size());}
\DoxyCodeLine{10317\ \ \ \}}
\DoxyCodeLine{10318\ }
\DoxyCodeLine{10319\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 45)\ \{}
\DoxyCodeLine{10320\ \ \ \ \ me.add\_bool(cdata-\/>\_has\_clear\_color);}
\DoxyCodeLine{10321\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_clear\_color)\ \{}
\DoxyCodeLine{10322\ \ \ \ \ \ \ cdata-\/>\_clear\_color.write\_datagram(me);}
\DoxyCodeLine{10323\ \ \ \ \ \}}
\DoxyCodeLine{10324\ \ \ \}}
\DoxyCodeLine{10325\ \}}
\DoxyCodeLine{10326\ }
\DoxyCodeLine{10330\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a34715c983a4527823125f2cb12f567fb}{Texture::}}}
\DoxyCodeLine{10331\ \mbox{\hyperlink{classTexture_a34715c983a4527823125f2cb12f567fb}{do\_write\_datagram\_rawdata}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{10332\ \ \ me.add\_uint32(cdata-\/>\_x\_size);}
\DoxyCodeLine{10333\ \ \ me.add\_uint32(cdata-\/>\_y\_size);}
\DoxyCodeLine{10334\ \ \ me.add\_uint32(cdata-\/>\_z\_size);}
\DoxyCodeLine{10335\ }
\DoxyCodeLine{10336\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 30)\ \{}
\DoxyCodeLine{10337\ \ \ \ \ me.add\_uint32(cdata-\/>\_pad\_x\_size);}
\DoxyCodeLine{10338\ \ \ \ \ me.add\_uint32(cdata-\/>\_pad\_y\_size);}
\DoxyCodeLine{10339\ \ \ \ \ me.add\_uint32(cdata-\/>\_pad\_z\_size);}
\DoxyCodeLine{10340\ \ \ \}}
\DoxyCodeLine{10341\ }
\DoxyCodeLine{10342\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 26)\ \{}
\DoxyCodeLine{10343\ \ \ \ \ me.add\_uint32(cdata-\/>\_num\_views);}
\DoxyCodeLine{10344\ \ \ \}}
\DoxyCodeLine{10345\ \ \ me.add\_uint8(cdata-\/>\_component\_type);}
\DoxyCodeLine{10346\ \ \ me.add\_uint8(cdata-\/>\_component\_width);}
\DoxyCodeLine{10347\ \ \ me.add\_uint8(cdata-\/>\_ram\_image\_compression);}
\DoxyCodeLine{10348\ }
\DoxyCodeLine{10349\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_ram\_images.empty()\ \&\&\ cdata-\/>\_has\_clear\_color\ \&\&}
\DoxyCodeLine{10350\ \ \ \ \ \ \ manager-\/>get\_file\_minor\_ver()\ <\ 45)\ \{}
\DoxyCodeLine{10351\ \ \ \ \ \textcolor{comment}{//\ For\ older\ .bam\ versions\ that\ don't\ support\ clear\ colors,\ make\ up\ a\ RAM}}
\DoxyCodeLine{10352\ \ \ \ \ \textcolor{comment}{//\ image.}}
\DoxyCodeLine{10353\ \ \ \ \ \textcolor{keywordtype}{int}\ image\_size\ =\ do\_get\_expected\_ram\_image\_size(cdata);}
\DoxyCodeLine{10354\ \ \ \ \ me.add\_uint8(1);}
\DoxyCodeLine{10355\ \ \ \ \ me.add\_uint32(do\_get\_expected\_ram\_page\_size(cdata));}
\DoxyCodeLine{10356\ \ \ \ \ me.add\_uint32(image\_size);}
\DoxyCodeLine{10357\ }
\DoxyCodeLine{10358\ \ \ \ \ \textcolor{comment}{//\ Fill\ the\ image\ with\ the\ clear\ color.}}
\DoxyCodeLine{10359\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structpixel}{pixel}}[16];}
\DoxyCodeLine{10360\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ pixel\_size\ =\ \mbox{\hyperlink{classTexture_a872f62140fa65c333fab00fb1161b26d}{do\_get\_clear\_data}}(cdata,\ \mbox{\hyperlink{structpixel}{pixel}});}
\DoxyCodeLine{10361\ \ \ \ \ nassertv(pixel\_size\ >\ 0);}
\DoxyCodeLine{10362\ }
\DoxyCodeLine{10363\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ image\_size;\ i\ +=\ pixel\_size)\ \{}
\DoxyCodeLine{10364\ \ \ \ \ \ \ me.append\_data(\mbox{\hyperlink{structpixel}{pixel}},\ pixel\_size);}
\DoxyCodeLine{10365\ \ \ \ \ \}}
\DoxyCodeLine{10366\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10367\ \ \ \ \ me.add\_uint8(cdata-\/>\_ram\_images.size());}
\DoxyCodeLine{10368\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ cdata-\/>\_ram\_images.size();\ ++n)\ \{}
\DoxyCodeLine{10369\ \ \ \ \ \ \ me.add\_uint32(cdata-\/>\_ram\_images[n].\_page\_size);}
\DoxyCodeLine{10370\ \ \ \ \ \ \ me.add\_uint32(cdata-\/>\_ram\_images[n].\_image.size());}
\DoxyCodeLine{10371\ \ \ \ \ \ \ me.append\_data(cdata-\/>\_ram\_images[n].\_image,\ cdata-\/>\_ram\_images[n].\_image.size());}
\DoxyCodeLine{10372\ \ \ \ \ \}}
\DoxyCodeLine{10373\ \ \ \}}
\DoxyCodeLine{10374\ \}}
\DoxyCodeLine{10375\ }
\DoxyCodeLine{10379\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classTexture_ae8f48031065ef9a9ef264038408071d5}{Texture::}}}
\DoxyCodeLine{10380\ \mbox{\hyperlink{classTexture_ae8f48031065ef9a9ef264038408071d5}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{10381\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ dummy\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture_abdf82a7e3262db9452fb0fd994d01c69}{Texture}};}
\DoxyCodeLine{10382\ \ \ \textcolor{keywordflow}{return}\ dummy-\/>make\_this\_from\_bam(params);}
\DoxyCodeLine{10383\ \}}
\DoxyCodeLine{10384\ }
\DoxyCodeLine{10391\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classTexture_a05045fa9d972ba9c6231c18fe9116c2f}{Texture::}}}
\DoxyCodeLine{10392\ \mbox{\hyperlink{classTexture_a05045fa9d972ba9c6231c18fe9116c2f}{make\_this\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{10393\ \ \ \textcolor{comment}{//\ The\ process\ of\ making\ a\ texture\ is\ slightly\ different\ than\ making\ other}}
\DoxyCodeLine{10394\ \ \ \textcolor{comment}{//\ TypedWritable\ objects.\ \ That\ is\ because\ all\ creation\ of\ Textures\ should}}
\DoxyCodeLine{10395\ \ \ \textcolor{comment}{//\ be\ done\ through\ calls\ to\ TexturePool,\ which\ ensures\ that\ any\ loads\ of\ the}}
\DoxyCodeLine{10396\ \ \ \textcolor{comment}{//\ same\ filename\ refer\ to\ the\ same\ memory.}}
\DoxyCodeLine{10397\ }
\DoxyCodeLine{10398\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{10399\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{10400\ }
\DoxyCodeLine{10401\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{10402\ }
\DoxyCodeLine{10403\ \ \ \textcolor{comment}{//\ Get\ the\ header\ information-\/-\/the\ filenames\ and\ texture\ type-\/-\/so\ we\ can}}
\DoxyCodeLine{10404\ \ \ \textcolor{comment}{//\ look\ up\ the\ file\ on\ disk\ first.}}
\DoxyCodeLine{10405\ \ \ \textcolor{keywordtype}{string}\ name\ =\ scan.\mbox{\hyperlink{classDatagramIterator_aa5b2810c1b772f83e744fed70bb313ea}{get\_string}}();}
\DoxyCodeLine{10406\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ scan.\mbox{\hyperlink{classDatagramIterator_aa5b2810c1b772f83e744fed70bb313ea}{get\_string}}();}
\DoxyCodeLine{10407\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_filename\ =\ scan.\mbox{\hyperlink{classDatagramIterator_aa5b2810c1b772f83e744fed70bb313ea}{get\_string}}();}
\DoxyCodeLine{10408\ }
\DoxyCodeLine{10409\ \ \ \textcolor{keywordtype}{int}\ primary\_file\_num\_channels\ =\ scan.get\_uint8();}
\DoxyCodeLine{10410\ \ \ \textcolor{keywordtype}{int}\ alpha\_file\_channel\ =\ scan.get\_uint8();}
\DoxyCodeLine{10411\ \ \ \textcolor{keywordtype}{bool}\ has\_rawdata\ =\ scan.get\_bool();}
\DoxyCodeLine{10412\ \ \ TextureType\ texture\_type\ =\ (TextureType)scan.get\_uint8();}
\DoxyCodeLine{10413\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ <\ 25)\ \{}
\DoxyCodeLine{10414\ \ \ \ \ \textcolor{comment}{//\ Between\ Panda3D\ releases\ 1.7.2\ and\ 1.8.0\ (bam\ versions\ 6.24\ and\ 6.25),}}
\DoxyCodeLine{10415\ \ \ \ \ \textcolor{comment}{//\ we\ added\ TT\_2d\_texture\_array,\ shifting\ the\ definition\ for\ TT\_cube\_map.}}
\DoxyCodeLine{10416\ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ ==\ TT\_2d\_texture\_array)\ \{}
\DoxyCodeLine{10417\ \ \ \ \ \ \ texture\_type\ =\ TT\_cube\_map;}
\DoxyCodeLine{10418\ \ \ \ \ \}}
\DoxyCodeLine{10419\ \ \ \}}
\DoxyCodeLine{10420\ \ \ \textcolor{keywordtype}{bool}\ has\_read\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10421\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 32)\ \{}
\DoxyCodeLine{10422\ \ \ \ \ has\_read\_mipmaps\ =\ scan.get\_bool();}
\DoxyCodeLine{10423\ \ \ \}}
\DoxyCodeLine{10424\ }
\DoxyCodeLine{10425\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *me\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{10426\ \ \ \textcolor{keywordflow}{if}\ (has\_rawdata)\ \{}
\DoxyCodeLine{10427\ \ \ \ \ \textcolor{comment}{//\ If\ the\ raw\ image\ data\ is\ included,\ then\ just\ load\ the\ texture\ directly}}
\DoxyCodeLine{10428\ \ \ \ \ \textcolor{comment}{//\ from\ the\ stream,\ and\ return\ it.\ \ In\ this\ case\ we\ return\ the\ "{}this"{}}}
\DoxyCodeLine{10429\ \ \ \ \ \textcolor{comment}{//\ pointer,\ since\ it's\ a\ newly-\/created\ Texture\ object\ of\ the\ appropriate}}
\DoxyCodeLine{10430\ \ \ \ \ \textcolor{comment}{//\ type.}}
\DoxyCodeLine{10431\ \ \ \ \ me\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{10432\ \ \ \ \ me-\/>set\_name(name);}
\DoxyCodeLine{10433\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata\_me(me-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{10434\ \ \ \ \ cdata\_me-\/>\_filename\ =\ filename;}
\DoxyCodeLine{10435\ \ \ \ \ cdata\_me-\/>\_alpha\_filename\ =\ alpha\_filename;}
\DoxyCodeLine{10436\ \ \ \ \ cdata\_me-\/>\_primary\_file\_num\_channels\ =\ primary\_file\_num\_channels;}
\DoxyCodeLine{10437\ \ \ \ \ cdata\_me-\/>\_alpha\_file\_channel\ =\ alpha\_file\_channel;}
\DoxyCodeLine{10438\ \ \ \ \ cdata\_me-\/>\_texture\_type\ =\ texture\_type;}
\DoxyCodeLine{10439\ \ \ \ \ cdata\_me-\/>\_has\_read\_mipmaps\ =\ has\_read\_mipmaps;}
\DoxyCodeLine{10440\ }
\DoxyCodeLine{10441\ \ \ \ \ \textcolor{comment}{//\ Read\ the\ texture\ attributes\ directly\ from\ the\ bam\ stream.}}
\DoxyCodeLine{10442\ \ \ \ \ me-\/>\mbox{\hyperlink{classTexture_acd0d7f5b98a19ad5441fbb475337b762}{do\_fillin\_body}}(cdata\_me,\ scan,\ manager);}
\DoxyCodeLine{10443\ \ \ \ \ me-\/>\mbox{\hyperlink{classTexture_a861d4d3a199ff1a43bdda47143f35c51}{do\_fillin\_rawdata}}(cdata\_me,\ scan,\ manager);}
\DoxyCodeLine{10444\ }
\DoxyCodeLine{10445\ \ \ \ \ \textcolor{comment}{//\ To\ manage\ the\ reference\ count,\ explicitly\ ref\ it\ now,\ then\ unref\ it\ in}}
\DoxyCodeLine{10446\ \ \ \ \ \textcolor{comment}{//\ the\ finalize\ callback.}}
\DoxyCodeLine{10447\ \ \ \ \ me-\/>ref();}
\DoxyCodeLine{10448\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_a0c2e8dc5a794a4263139116b5b8dcb2d}{register\_finalize}}(me);}
\DoxyCodeLine{10449\ }
\DoxyCodeLine{10450\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10451\ \ \ \ \ \textcolor{comment}{//\ The\ raw\ image\ data\ isn't\ included,\ so\ we'll\ be\ loading\ the\ Texture\ via}}
\DoxyCodeLine{10452\ \ \ \ \ \textcolor{comment}{//\ the\ TexturePool.\ \ In\ this\ case\ we\ use\ the\ "{}this"{}\ pointer\ as\ a\ temporary}}
\DoxyCodeLine{10453\ \ \ \ \ \textcolor{comment}{//\ object\ to\ read\ all\ of\ the\ attributes\ from\ the\ bam\ stream.}}
\DoxyCodeLine{10454\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *dummy\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{10455\ \ \ \ \ AutoTextureScale\ auto\_texture\_scale\ =\ ATS\_unspecified;}
\DoxyCodeLine{10456\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_simple\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10457\ \ \ \ \ \{}
\DoxyCodeLine{10458\ \ \ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata\_dummy(dummy-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{10459\ \ \ \ \ \ \ dummy-\/>\mbox{\hyperlink{classTexture_acd0d7f5b98a19ad5441fbb475337b762}{do\_fillin\_body}}(cdata\_dummy,\ scan,\ manager);}
\DoxyCodeLine{10460\ \ \ \ \ \ \ auto\_texture\_scale\ =\ cdata\_dummy-\/>\_auto\_texture\_scale;}
\DoxyCodeLine{10461\ \ \ \ \ \ \ has\_simple\_ram\_image\ =\ !cdata\_dummy-\/>\_simple\_ram\_image.\_image.empty();}
\DoxyCodeLine{10462\ \ \ \ \ \}}
\DoxyCodeLine{10463\ }
\DoxyCodeLine{10464\ \ \ \ \ \textcolor{keywordflow}{if}\ (filename.empty())\ \{}
\DoxyCodeLine{10465\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ texture\ has\ no\ filename;\ since\ we\ don't\ have\ an\ image\ to\ load,}}
\DoxyCodeLine{10466\ \ \ \ \ \ \ \textcolor{comment}{//\ we\ can't\ actually\ create\ the\ texture.}}
\DoxyCodeLine{10467\ \ \ \ \ \ \ gobj\_cat.info()}
\DoxyCodeLine{10468\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cannot\ create\ texture\ '"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}'\ with\ no\ filename.\(\backslash\)n"{}};}
\DoxyCodeLine{10469\ }
\DoxyCodeLine{10470\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10471\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ texture\ does\ have\ a\ filename,\ so\ try\ to\ load\ it\ from\ disk.}}
\DoxyCodeLine{10472\ \ \ \ \ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{10473\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!manager-\/>get\_filename().empty())\ \{}
\DoxyCodeLine{10474\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ texture\ filename\ was\ given\ relative\ to\ the\ bam\ filename,\ expand}}
\DoxyCodeLine{10475\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ it\ now.}}
\DoxyCodeLine{10476\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ bam\_dir\ =\ manager-\/>get\_filename().get\_dirname();}
\DoxyCodeLine{10477\ \ \ \ \ \ \ \ \ vfs-\/>resolve\_filename(filename,\ \mbox{\hyperlink{classDSearchPath}{DSearchPath}}(bam\_dir));}
\DoxyCodeLine{10478\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!alpha\_filename.empty())\ \{}
\DoxyCodeLine{10479\ \ \ \ \ \ \ \ \ \ \ vfs-\/>resolve\_filename(alpha\_filename,\ \mbox{\hyperlink{classDSearchPath}{DSearchPath}}(bam\_dir));}
\DoxyCodeLine{10480\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10481\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10482\ }
\DoxyCodeLine{10483\ \ \ \ \ \ \ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ options\ =\ manager-\/>get\_loader\_options();}
\DoxyCodeLine{10484\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dummy-\/>uses\_mipmaps())\ \{}
\DoxyCodeLine{10485\ \ \ \ \ \ \ \ \ options.set\_texture\_flags(options.get\_texture\_flags()\ |\ LoaderOptions::TF\_generate\_mipmaps);}
\DoxyCodeLine{10486\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10487\ \ \ \ \ \ \ options.set\_auto\_texture\_scale(auto\_texture\_scale);}
\DoxyCodeLine{10488\ }
\DoxyCodeLine{10489\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{10490\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_buffer\_texture:}
\DoxyCodeLine{10491\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture:}
\DoxyCodeLine{10492\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture:}
\DoxyCodeLine{10493\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_1d\_texture\_array:}
\DoxyCodeLine{10494\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ want\ to\ preload\ textures,\ and\ we\ already\ have\ a\ simple}}
\DoxyCodeLine{10495\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ RAM\ image\ (or\ don't\ need\ one),\ we\ don't\ need\ to\ load\ it\ from\ disk.}}
\DoxyCodeLine{10496\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ do\ check\ for\ it\ in\ the\ texture\ pool\ first,\ though,\ in\ case\ it\ has}}
\DoxyCodeLine{10497\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ already\ been\ loaded.}}
\DoxyCodeLine{10498\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_preload)\ ==\ 0\ \&\&}
\DoxyCodeLine{10499\ \ \ \ \ \ \ \ \ \ \ \ \ (has\_simple\_ram\_image\ ||\ (options.get\_texture\_flags()\ \&\ LoaderOptions::TF\_preload\_simple)\ ==\ 0))\ \{}
\DoxyCodeLine{10500\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\_filename.empty())\ \{}
\DoxyCodeLine{10501\ \ \ \ \ \ \ \ \ \ \ \ \ me\ =\ TexturePool::get\_texture(filename,\ primary\_file\_num\_channels,}
\DoxyCodeLine{10502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_read\_mipmaps);}
\DoxyCodeLine{10503\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10504\ \ \ \ \ \ \ \ \ \ \ \ \ me\ =\ TexturePool::get\_texture(filename,\ alpha\_filename,}
\DoxyCodeLine{10505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ primary\_file\_num\_channels,}
\DoxyCodeLine{10506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,}
\DoxyCodeLine{10507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_read\_mipmaps);}
\DoxyCodeLine{10508\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10509\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (me\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ me-\/>get\_texture\_type()\ ==\ texture\_type)\ \{}
\DoxyCodeLine{10510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can\ use\ this.}}
\DoxyCodeLine{10511\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10512\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10513\ }
\DoxyCodeLine{10514\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ have\ a\ texture,\ but\ we\ didn't\ need\ to\ preload\ it,\ so\ we}}
\DoxyCodeLine{10515\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ can\ just\ use\ this\ one.\ \ We\ just\ need\ to\ know\ where\ we\ can\ find\ it}}
\DoxyCodeLine{10516\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ when\ we\ do\ need\ to\ reload\ it.}}
\DoxyCodeLine{10517\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fullpath\ =\ filename;}
\DoxyCodeLine{10518\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ alpha\_fullpath\ =\ alpha\_filename;}
\DoxyCodeLine{10519\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDSearchPath}{DSearchPath}}\ \&model\_path\ =\ get\_model\_path();}
\DoxyCodeLine{10520\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vfs-\/>resolve\_filename(fullpath,\ model\_path)\ \&\&}
\DoxyCodeLine{10521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (alpha\_fullpath.empty()\ ||\ vfs-\/>resolve\_filename(alpha\_fullpath,\ model\_path)))\ \{}
\DoxyCodeLine{10522\ \ \ \ \ \ \ \ \ \ \ \ \ me\ =\ dummy;}
\DoxyCodeLine{10523\ \ \ \ \ \ \ \ \ \ \ \ \ me-\/>set\_name(name);}
\DoxyCodeLine{10524\ }
\DoxyCodeLine{10525\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{10526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata\_me(me-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{10527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_filename\ =\ filename;}
\DoxyCodeLine{10528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_alpha\_filename\ =\ alpha\_filename;}
\DoxyCodeLine{10529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_fullpath\ =\ fullpath;}
\DoxyCodeLine{10530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_alpha\_fullpath\ =\ alpha\_fullpath;}
\DoxyCodeLine{10531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_primary\_file\_num\_channels\ =\ primary\_file\_num\_channels;}
\DoxyCodeLine{10532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_alpha\_file\_channel\ =\ alpha\_file\_channel;}
\DoxyCodeLine{10533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_texture\_type\ =\ texture\_type;}
\DoxyCodeLine{10534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{10535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_me-\/>\_has\_read\_mipmaps\ =\ has\_read\_mipmaps;}
\DoxyCodeLine{10536\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10537\ }
\DoxyCodeLine{10538\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ To\ manage\ the\ reference\ count,\ explicitly\ ref\ it\ now,\ then\ unref}}
\DoxyCodeLine{10539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ it\ in\ the\ finalize\ callback.}}
\DoxyCodeLine{10540\ \ \ \ \ \ \ \ \ \ \ \ \ me-\/>ref();}
\DoxyCodeLine{10541\ \ \ \ \ \ \ \ \ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_a0c2e8dc5a794a4263139116b5b8dcb2d}{register\_finalize}}(me);}
\DoxyCodeLine{10542\ }
\DoxyCodeLine{10543\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ add\ it\ to\ the\ cache\ now,\ so\ that\ future\ uses\ of\ this\ same}}
\DoxyCodeLine{10544\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ texture\ are\ unified.}}
\DoxyCodeLine{10545\ \ \ \ \ \ \ \ \ \ \ \ \ TexturePool::add\_texture(me);}
\DoxyCodeLine{10546\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{10547\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10548\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10549\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha\_filename.empty())\ \{}
\DoxyCodeLine{10550\ \ \ \ \ \ \ \ \ \ \ me\ =\ TexturePool::load\_texture(filename,\ primary\_file\_num\_channels,}
\DoxyCodeLine{10551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_read\_mipmaps,\ options);}
\DoxyCodeLine{10552\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10553\ \ \ \ \ \ \ \ \ \ \ me\ =\ TexturePool::load\_texture(filename,\ alpha\_filename,}
\DoxyCodeLine{10554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ primary\_file\_num\_channels,}
\DoxyCodeLine{10555\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ alpha\_file\_channel,}
\DoxyCodeLine{10556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_read\_mipmaps,\ options);}
\DoxyCodeLine{10557\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10558\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10559\ }
\DoxyCodeLine{10560\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_3d\_texture:}
\DoxyCodeLine{10561\ \ \ \ \ \ \ \ \ me\ =\ TexturePool::load\_3d\_texture(filename,\ has\_read\_mipmaps,\ options);}
\DoxyCodeLine{10562\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10563\ }
\DoxyCodeLine{10564\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_2d\_texture\_array:}
\DoxyCodeLine{10565\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map\_array:}
\DoxyCodeLine{10566\ \ \ \ \ \ \ \ \ me\ =\ TexturePool::load\_2d\_texture\_array(filename,\ has\_read\_mipmaps,\ options);}
\DoxyCodeLine{10567\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10568\ }
\DoxyCodeLine{10569\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ TT\_cube\_map:}
\DoxyCodeLine{10570\ \ \ \ \ \ \ \ \ me\ =\ TexturePool::load\_cube\_map(filename,\ has\_read\_mipmaps,\ options);}
\DoxyCodeLine{10571\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10572\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10573\ \ \ \ \ \}}
\DoxyCodeLine{10574\ }
\DoxyCodeLine{10575\ \ \ \ \ \textcolor{keywordflow}{if}\ (me\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{10576\ \ \ \ \ \ \ me-\/>set\_name(name);}
\DoxyCodeLine{10577\ \ \ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata\_me(me-\/>\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{10578\ \ \ \ \ \ \ me-\/>\mbox{\hyperlink{classTexture_a130c781aa993f35824c2444d82903a07}{do\_fillin\_from}}(cdata\_me,\ dummy);}
\DoxyCodeLine{10579\ }
\DoxyCodeLine{10580\ \ \ \ \ \ \ \textcolor{comment}{//\ Since\ in\ this\ case\ me\ was\ loaded\ from\ the\ TexturePool,\ there's\ no}}
\DoxyCodeLine{10581\ \ \ \ \ \ \ \textcolor{comment}{//\ need\ to\ explicitly\ manage\ the\ reference\ count.\ \ TexturePool\ will\ hold}}
\DoxyCodeLine{10582\ \ \ \ \ \ \ \textcolor{comment}{//\ it\ safely.}}
\DoxyCodeLine{10583\ \ \ \ \ \}}
\DoxyCodeLine{10584\ \ \ \}}
\DoxyCodeLine{10585\ }
\DoxyCodeLine{10586\ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{10587\ \}}
\DoxyCodeLine{10588\ }
\DoxyCodeLine{10593\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_acd0d7f5b98a19ad5441fbb475337b762}{Texture::}}}
\DoxyCodeLine{10594\ \mbox{\hyperlink{classTexture_acd0d7f5b98a19ad5441fbb475337b762}{do\_fillin\_body}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{10595\ \ \ cdata-\/>\_default\_sampler.\mbox{\hyperlink{classSamplerState_a6fca4a111116e38e2f6f3e2653ad7374}{read\_datagram}}(scan,\ manager);}
\DoxyCodeLine{10596\ }
\DoxyCodeLine{10597\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 1)\ \{}
\DoxyCodeLine{10598\ \ \ \ \ cdata-\/>\_compression\ =\ (CompressionMode)scan.get\_uint8();}
\DoxyCodeLine{10599\ \ \ \}}
\DoxyCodeLine{10600\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 16)\ \{}
\DoxyCodeLine{10601\ \ \ \ \ cdata-\/>\_quality\_level\ =\ (QualityLevel)scan.get\_uint8();}
\DoxyCodeLine{10602\ \ \ \}}
\DoxyCodeLine{10603\ }
\DoxyCodeLine{10604\ \ \ cdata-\/>\_format\ =\ (Format)scan.get\_uint8();}
\DoxyCodeLine{10605\ \ \ cdata-\/>\_num\_components\ =\ scan.get\_uint8();}
\DoxyCodeLine{10606\ }
\DoxyCodeLine{10607\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_texture\_type\ ==\ TT\_buffer\_texture)\ \{}
\DoxyCodeLine{10608\ \ \ \ \ cdata-\/>\_usage\_hint\ =\ (GeomEnums::UsageHint)scan.get\_uint8();}
\DoxyCodeLine{10609\ \ \ \}}
\DoxyCodeLine{10610\ }
\DoxyCodeLine{10611\ \ \ cdata-\/>inc\_properties\_modified();}
\DoxyCodeLine{10612\ }
\DoxyCodeLine{10613\ \ \ cdata-\/>\_auto\_texture\_scale\ =\ ATS\_unspecified;}
\DoxyCodeLine{10614\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 28)\ \{}
\DoxyCodeLine{10615\ \ \ \ \ cdata-\/>\_auto\_texture\_scale\ =\ (AutoTextureScale)scan.get\_uint8();}
\DoxyCodeLine{10616\ \ \ \}}
\DoxyCodeLine{10617\ }
\DoxyCodeLine{10618\ \ \ \textcolor{keywordtype}{bool}\ has\_simple\_ram\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10619\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 18)\ \{}
\DoxyCodeLine{10620\ \ \ \ \ cdata-\/>\_orig\_file\_x\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10621\ \ \ \ \ cdata-\/>\_orig\_file\_y\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10622\ }
\DoxyCodeLine{10623\ \ \ \ \ has\_simple\_ram\_image\ =\ scan.get\_bool();}
\DoxyCodeLine{10624\ \ \ \}}
\DoxyCodeLine{10625\ }
\DoxyCodeLine{10626\ \ \ \textcolor{keywordflow}{if}\ (has\_simple\_ram\_image)\ \{}
\DoxyCodeLine{10627\ \ \ \ \ cdata-\/>\_simple\_x\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10628\ \ \ \ \ cdata-\/>\_simple\_y\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10629\ \ \ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ scan.get\_int32();}
\DoxyCodeLine{10630\ }
\DoxyCodeLine{10631\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ u\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10632\ }
\DoxyCodeLine{10633\ \ \ \ \ \textcolor{comment}{//\ Protect\ against\ large\ allocation.}}
\DoxyCodeLine{10634\ \ \ \ \ \textcolor{keywordflow}{if}\ (u\_size\ >\ scan.get\_remaining\_size())\ \{}
\DoxyCodeLine{10635\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{10636\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}simple\ RAM\ image\ extends\ past\ end\ of\ datagram,\ is\ texture\ corrupt?\(\backslash\)n"{}};}
\DoxyCodeLine{10637\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{10638\ \ \ \ \ \}}
\DoxyCodeLine{10639\ }
\DoxyCodeLine{10640\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(u\_size,\ get\_class\_type());}
\DoxyCodeLine{10641\ \ \ \ \ scan.\mbox{\hyperlink{classDatagramIterator_a6422ef5992636dae0cd634b6cf9fec32}{extract\_bytes}}(image.p(),\ u\_size);}
\DoxyCodeLine{10642\ }
\DoxyCodeLine{10643\ \ \ \ \ cdata-\/>\_simple\_ram\_image.\_image\ =\ image;}
\DoxyCodeLine{10644\ \ \ \ \ cdata-\/>\_simple\_ram\_image.\_page\_size\ =\ u\_size;}
\DoxyCodeLine{10645\ \ \ \}}
\DoxyCodeLine{10646\ }
\DoxyCodeLine{10647\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 45)\ \{}
\DoxyCodeLine{10648\ \ \ \ \ cdata-\/>\_has\_clear\_color\ =\ scan.get\_bool();}
\DoxyCodeLine{10649\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_has\_clear\_color)\ \{}
\DoxyCodeLine{10650\ \ \ \ \ \ \ cdata-\/>\_clear\_color.read\_datagram(scan);}
\DoxyCodeLine{10651\ \ \ \ \ \}}
\DoxyCodeLine{10652\ \ \ \}}
\DoxyCodeLine{10653\ \}}
\DoxyCodeLine{10654\ }
\DoxyCodeLine{10659\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a861d4d3a199ff1a43bdda47143f35c51}{Texture::}}}
\DoxyCodeLine{10660\ \mbox{\hyperlink{classTexture_a861d4d3a199ff1a43bdda47143f35c51}{do\_fillin\_rawdata}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{10661\ \ \ cdata-\/>\_x\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10662\ \ \ cdata-\/>\_y\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10663\ \ \ cdata-\/>\_z\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10664\ }
\DoxyCodeLine{10665\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 30)\ \{}
\DoxyCodeLine{10666\ \ \ \ \ cdata-\/>\_pad\_x\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10667\ \ \ \ \ cdata-\/>\_pad\_y\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10668\ \ \ \ \ cdata-\/>\_pad\_z\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10669\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10670\ \ \ \ \ do\_set\_pad\_size(cdata,\ 0,\ 0,\ 0);}
\DoxyCodeLine{10671\ \ \ \}}
\DoxyCodeLine{10672\ }
\DoxyCodeLine{10673\ \ \ cdata-\/>\_num\_views\ =\ 1;}
\DoxyCodeLine{10674\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 26)\ \{}
\DoxyCodeLine{10675\ \ \ \ \ cdata-\/>\_num\_views\ =\ scan.get\_uint32();}
\DoxyCodeLine{10676\ \ \ \}}
\DoxyCodeLine{10677\ \ \ cdata-\/>\_component\_type\ =\ (ComponentType)scan.get\_uint8();}
\DoxyCodeLine{10678\ \ \ cdata-\/>\_component\_width\ =\ scan.get\_uint8();}
\DoxyCodeLine{10679\ \ \ cdata-\/>\_ram\_image\_compression\ =\ CM\_off;}
\DoxyCodeLine{10680\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 1)\ \{}
\DoxyCodeLine{10681\ \ \ \ \ cdata-\/>\_ram\_image\_compression\ =\ (CompressionMode)scan.get\_uint8();}
\DoxyCodeLine{10682\ \ \ \}}
\DoxyCodeLine{10683\ }
\DoxyCodeLine{10684\ \ \ \textcolor{keywordtype}{int}\ num\_ram\_images\ =\ 1;}
\DoxyCodeLine{10685\ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 3)\ \{}
\DoxyCodeLine{10686\ \ \ \ \ num\_ram\_images\ =\ scan.get\_uint8();}
\DoxyCodeLine{10687\ \ \ \}}
\DoxyCodeLine{10688\ }
\DoxyCodeLine{10689\ \ \ cdata-\/>\_ram\_images.clear();}
\DoxyCodeLine{10690\ \ \ cdata-\/>\_ram\_images.reserve(num\_ram\_images);}
\DoxyCodeLine{10691\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 0;\ n\ <\ num\_ram\_images;\ ++n)\ \{}
\DoxyCodeLine{10692\ \ \ \ \ cdata-\/>\_ram\_images.push\_back(\mbox{\hyperlink{classTexture_1_1RamImage}{RamImage}}());}
\DoxyCodeLine{10693\ \ \ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ get\_expected\_ram\_page\_size();}
\DoxyCodeLine{10694\ \ \ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 1)\ \{}
\DoxyCodeLine{10695\ \ \ \ \ \ \ cdata-\/>\_ram\_images[n].\_page\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10696\ \ \ \ \ \}}
\DoxyCodeLine{10697\ }
\DoxyCodeLine{10698\ \ \ \ \ \textcolor{comment}{//\ fill\ the\ cdata-\/>\_image\ buffer\ with\ image\ data}}
\DoxyCodeLine{10699\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ u\_size\ =\ scan.get\_uint32();}
\DoxyCodeLine{10700\ }
\DoxyCodeLine{10701\ \ \ \ \ \textcolor{comment}{//\ Protect\ against\ large\ allocation.}}
\DoxyCodeLine{10702\ \ \ \ \ \textcolor{keywordflow}{if}\ (u\_size\ >\ scan.get\_remaining\_size())\ \{}
\DoxyCodeLine{10703\ \ \ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{10704\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}RAM\ image\ "{}}\ <<\ n\ <<\ \textcolor{stringliteral}{"{}\ extends\ past\ end\ of\ datagram,\ is\ texture\ corrupt?\(\backslash\)n"{}};}
\DoxyCodeLine{10705\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{10706\ \ \ \ \ \}}
\DoxyCodeLine{10707\ }
\DoxyCodeLine{10708\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image\ =\ PTA\_uchar::empty\_array(u\_size,\ get\_class\_type());}
\DoxyCodeLine{10709\ \ \ \ \ scan.\mbox{\hyperlink{classDatagramIterator_a6422ef5992636dae0cd634b6cf9fec32}{extract\_bytes}}(image.p(),\ u\_size);}
\DoxyCodeLine{10710\ }
\DoxyCodeLine{10711\ \ \ \ \ cdata-\/>\_ram\_images[n].\_image\ =\ image;}
\DoxyCodeLine{10712\ \ \ \}}
\DoxyCodeLine{10713\ \ \ cdata-\/>\_loaded\_from\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{10714\ \ \ cdata-\/>inc\_image\_modified();}
\DoxyCodeLine{10715\ \}}
\DoxyCodeLine{10716\ }
\DoxyCodeLine{10722\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_a130c781aa993f35824c2444d82903a07}{Texture::}}}
\DoxyCodeLine{10723\ \mbox{\hyperlink{classTexture_a130c781aa993f35824c2444d82903a07}{do\_fillin\_from}}(\mbox{\hyperlink{classTexture_1_1CData}{CData}}\ *cdata,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture}{Texture}}\ *dummy)\ \{}
\DoxyCodeLine{10724\ \ \ \textcolor{comment}{//\ Use\ the\ setters\ instead\ of\ setting\ these\ directly,\ so\ we\ can\ correctly}}
\DoxyCodeLine{10725\ \ \ \textcolor{comment}{//\ avoid\ incrementing\ cdata-\/>\_properties\_modified\ if\ none\ of\ these\ actually}}
\DoxyCodeLine{10726\ \ \ \textcolor{comment}{//\ change.\ \ (Otherwise,\ we'd\ have\ to\ reload\ the\ texture\ to\ the\ GSG\ every}}
\DoxyCodeLine{10727\ \ \ \textcolor{comment}{//\ time\ we\ loaded\ a\ new\ bam\ file\ that\ reference\ the\ texture,\ since\ each\ bam}}
\DoxyCodeLine{10728\ \ \ \textcolor{comment}{//\ file\ reference\ passes\ through\ this\ function.)}}
\DoxyCodeLine{10729\ }
\DoxyCodeLine{10730\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata\_dummy(dummy-\/>\_cycler);}
\DoxyCodeLine{10731\ }
\DoxyCodeLine{10732\ \ \ do\_set\_wrap\_u(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_wrap\_u());}
\DoxyCodeLine{10733\ \ \ do\_set\_wrap\_v(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_wrap\_v());}
\DoxyCodeLine{10734\ \ \ do\_set\_wrap\_w(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_wrap\_w());}
\DoxyCodeLine{10735\ \ \ do\_set\_border\_color(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_border\_color());}
\DoxyCodeLine{10736\ }
\DoxyCodeLine{10737\ \ \ \textcolor{keywordflow}{if}\ (cdata\_dummy-\/>\_default\_sampler.get\_minfilter()\ !=\ SamplerState::FT\_default)\ \{}
\DoxyCodeLine{10738\ \ \ \ \ do\_set\_minfilter(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_minfilter());}
\DoxyCodeLine{10739\ \ \ \}}
\DoxyCodeLine{10740\ \ \ \textcolor{keywordflow}{if}\ (cdata\_dummy-\/>\_default\_sampler.get\_magfilter()\ !=\ SamplerState::FT\_default)\ \{}
\DoxyCodeLine{10741\ \ \ \ \ do\_set\_magfilter(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_magfilter());}
\DoxyCodeLine{10742\ \ \ \}}
\DoxyCodeLine{10743\ \ \ \textcolor{keywordflow}{if}\ (cdata\_dummy-\/>\_default\_sampler.get\_anisotropic\_degree()\ !=\ 0)\ \{}
\DoxyCodeLine{10744\ \ \ \ \ do\_set\_anisotropic\_degree(cdata,\ cdata\_dummy-\/>\_default\_sampler.get\_anisotropic\_degree());}
\DoxyCodeLine{10745\ \ \ \}}
\DoxyCodeLine{10746\ \ \ \textcolor{keywordflow}{if}\ (cdata\_dummy-\/>\_compression\ !=\ CM\_default)\ \{}
\DoxyCodeLine{10747\ \ \ \ \ do\_set\_compression(cdata,\ cdata\_dummy-\/>\_compression);}
\DoxyCodeLine{10748\ \ \ \}}
\DoxyCodeLine{10749\ \ \ \textcolor{keywordflow}{if}\ (cdata\_dummy-\/>\_quality\_level\ !=\ QL\_default)\ \{}
\DoxyCodeLine{10750\ \ \ \ \ do\_set\_quality\_level(cdata,\ cdata\_dummy-\/>\_quality\_level);}
\DoxyCodeLine{10751\ \ \ \}}
\DoxyCodeLine{10752\ }
\DoxyCodeLine{10753\ \ \ Format\ format\ =\ cdata\_dummy-\/>\_format;}
\DoxyCodeLine{10754\ \ \ \textcolor{keywordtype}{int}\ num\_components\ =\ cdata\_dummy-\/>\_num\_components;}
\DoxyCodeLine{10755\ }
\DoxyCodeLine{10756\ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ cdata-\/>\_num\_components)\ \{}
\DoxyCodeLine{10757\ \ \ \ \ \textcolor{comment}{//\ Only\ reset\ the\ format\ if\ the\ number\ of\ components\ hasn't\ changed,\ since}}
\DoxyCodeLine{10758\ \ \ \ \ \textcolor{comment}{//\ if\ the\ number\ of\ components\ has\ changed\ our\ texture\ no\ longer\ matches}}
\DoxyCodeLine{10759\ \ \ \ \ \textcolor{comment}{//\ what\ it\ was\ when\ the\ bam\ was\ written.}}
\DoxyCodeLine{10760\ \ \ \ \ do\_set\_format(cdata,\ format);}
\DoxyCodeLine{10761\ \ \ \}}
\DoxyCodeLine{10762\ }
\DoxyCodeLine{10763\ \ \ \textcolor{keywordflow}{if}\ (!cdata\_dummy-\/>\_simple\_ram\_image.\_image.empty())\ \{}
\DoxyCodeLine{10764\ \ \ \ \ \textcolor{comment}{//\ Only\ replace\ the\ simple\ ram\ image\ if\ it\ was\ generated\ more\ recently}}
\DoxyCodeLine{10765\ \ \ \ \ \textcolor{comment}{//\ than\ the\ one\ we\ already\ have.}}
\DoxyCodeLine{10766\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_simple\_ram\_image.\_image.empty()\ ||}
\DoxyCodeLine{10767\ \ \ \ \ \ \ \ \ cdata\_dummy-\/>\_simple\_image\_date\_generated\ >\ cdata-\/>\_simple\_image\_date\_generated)\ \{}
\DoxyCodeLine{10768\ \ \ \ \ \ \ do\_set\_simple\_ram\_image(cdata,}
\DoxyCodeLine{10769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_dummy-\/>\_simple\_ram\_image.\_image,}
\DoxyCodeLine{10770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_dummy-\/>\_simple\_x\_size,}
\DoxyCodeLine{10771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata\_dummy-\/>\_simple\_y\_size);}
\DoxyCodeLine{10772\ \ \ \ \ \ \ cdata-\/>\_simple\_image\_date\_generated\ =\ cdata\_dummy-\/>\_simple\_image\_date\_generated;}
\DoxyCodeLine{10773\ \ \ \ \ \}}
\DoxyCodeLine{10774\ \ \ \}}
\DoxyCodeLine{10775\ \}}
\DoxyCodeLine{10776\ }
\DoxyCodeLine{10780\ Texture::CData::}
\DoxyCodeLine{10781\ CData()\ \{}
\DoxyCodeLine{10782\ \ \ \_primary\_file\_num\_channels\ =\ 0;}
\DoxyCodeLine{10783\ \ \ \_alpha\_file\_channel\ =\ 0;}
\DoxyCodeLine{10784\ \ \ \_keep\_ram\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{10785\ \ \ \_compression\ =\ CM\_default;}
\DoxyCodeLine{10786\ \ \ \_auto\_texture\_scale\ =\ ATS\_unspecified;}
\DoxyCodeLine{10787\ \ \ \_ram\_image\_compression\ =\ CM\_off;}
\DoxyCodeLine{10788\ \ \ \_render\_to\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10789\ \ \ \_match\_framebuffer\_format\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10790\ \ \ \_post\_load\_store\_cache\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10791\ \ \ \_quality\_level\ =\ QL\_default;}
\DoxyCodeLine{10792\ }
\DoxyCodeLine{10793\ \ \ \_texture\_type\ =\ TT\_2d\_texture;}
\DoxyCodeLine{10794\ \ \ \_x\_size\ =\ 0;}
\DoxyCodeLine{10795\ \ \ \_y\_size\ =\ 1;}
\DoxyCodeLine{10796\ \ \ \_z\_size\ =\ 1;}
\DoxyCodeLine{10797\ \ \ \_num\_views\ =\ 1;}
\DoxyCodeLine{10798\ \ \ \_num\_components\ =\ 3;}
\DoxyCodeLine{10799\ \ \ \_component\_width\ =\ 1;}
\DoxyCodeLine{10800\ \ \ \_format\ =\ F\_rgb;}
\DoxyCodeLine{10801\ \ \ \_component\_type\ =\ T\_unsigned\_byte;}
\DoxyCodeLine{10802\ }
\DoxyCodeLine{10803\ \ \ \textcolor{comment}{//\ Only\ used\ for\ buffer\ textures.}}
\DoxyCodeLine{10804\ \ \ \_usage\_hint\ =\ GeomEnums::UH\_unspecified;}
\DoxyCodeLine{10805\ }
\DoxyCodeLine{10806\ \ \ \_pad\_x\_size\ =\ 0;}
\DoxyCodeLine{10807\ \ \ \_pad\_y\_size\ =\ 0;}
\DoxyCodeLine{10808\ \ \ \_pad\_z\_size\ =\ 0;}
\DoxyCodeLine{10809\ }
\DoxyCodeLine{10810\ \ \ \_orig\_file\_x\_size\ =\ 0;}
\DoxyCodeLine{10811\ \ \ \_orig\_file\_y\_size\ =\ 0;}
\DoxyCodeLine{10812\ }
\DoxyCodeLine{10813\ \ \ \_loaded\_from\_image\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10814\ \ \ \_loaded\_from\_txo\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10815\ \ \ \_has\_read\_pages\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10816\ \ \ \_has\_read\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10817\ \ \ \_num\_mipmap\_levels\_read\ =\ 0;}
\DoxyCodeLine{10818\ }
\DoxyCodeLine{10819\ \ \ \_simple\_x\_size\ =\ 0;}
\DoxyCodeLine{10820\ \ \ \_simple\_y\_size\ =\ 0;}
\DoxyCodeLine{10821\ \ \ \_simple\_ram\_image.\_page\_size\ =\ 0;}
\DoxyCodeLine{10822\ }
\DoxyCodeLine{10823\ \ \ \_has\_clear\_color\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{10824\ }
\DoxyCodeLine{10825\ \ \ \_modified\_pages.resize(1);}
\DoxyCodeLine{10826\ \ \ \_modified\_pages[0].\_z\_end\ =\ (size\_t)-\/1;}
\DoxyCodeLine{10827\ \ \ \_modified\_pages[0].\_modified\ =\ \_image\_modified;}
\DoxyCodeLine{10828\ \}}
\DoxyCodeLine{10829\ }
\DoxyCodeLine{10833\ Texture::CData::}
\DoxyCodeLine{10834\ CData(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{Texture::CData}}\ \&copy)\ \{}
\DoxyCodeLine{10835\ \ \ \_num\_mipmap\_levels\_read\ =\ 0;}
\DoxyCodeLine{10836\ \ \ \_render\_to\_texture\ =\ copy.\_render\_to\_texture;}
\DoxyCodeLine{10837\ \ \ \_post\_load\_store\_cache\ =\ copy.\_post\_load\_store\_cache;}
\DoxyCodeLine{10838\ }
\DoxyCodeLine{10839\ \ \ do\_assign(\&copy);}
\DoxyCodeLine{10840\ }
\DoxyCodeLine{10841\ \ \ \_properties\_modified\ =\ copy.\_properties\_modified;}
\DoxyCodeLine{10842\ \ \ \_image\_modified\ =\ copy.\_image\_modified;}
\DoxyCodeLine{10843\ \ \ \_modified\_pages\ =\ copy.\_modified\_pages;}
\DoxyCodeLine{10844\ \}}
\DoxyCodeLine{10845\ }
\DoxyCodeLine{10849\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *Texture::CData::}
\DoxyCodeLine{10850\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{10851\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{10852\ \}}
\DoxyCodeLine{10853\ }
\DoxyCodeLine{10857\ \textcolor{keywordtype}{void}\ Texture::CData::}
\DoxyCodeLine{10858\ do\_assign(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexture_1_1CData}{Texture::CData}}\ *copy)\ \{}
\DoxyCodeLine{10859\ \ \ \_filename\ =\ copy-\/>\_filename;}
\DoxyCodeLine{10860\ \ \ \_alpha\_filename\ =\ copy-\/>\_alpha\_filename;}
\DoxyCodeLine{10861\ \ \ \textcolor{keywordflow}{if}\ (!copy-\/>\_fullpath.empty())\ \{}
\DoxyCodeLine{10862\ \ \ \ \ \textcolor{comment}{//\ Since\ the\ fullpath\ is\ often\ empty\ on\ a\ file\ loaded\ directly\ from\ a\ txo,}}
\DoxyCodeLine{10863\ \ \ \ \ \textcolor{comment}{//\ we\ only\ assign\ the\ fullpath\ if\ it\ is\ not\ empty.}}
\DoxyCodeLine{10864\ \ \ \ \ \_fullpath\ =\ copy-\/>\_fullpath;}
\DoxyCodeLine{10865\ \ \ \ \ \_alpha\_fullpath\ =\ copy-\/>\_alpha\_fullpath;}
\DoxyCodeLine{10866\ \ \ \}}
\DoxyCodeLine{10867\ \ \ \_primary\_file\_num\_channels\ =\ copy-\/>\_primary\_file\_num\_channels;}
\DoxyCodeLine{10868\ \ \ \_alpha\_file\_channel\ =\ copy-\/>\_alpha\_file\_channel;}
\DoxyCodeLine{10869\ \ \ \_x\_size\ =\ copy-\/>\_x\_size;}
\DoxyCodeLine{10870\ \ \ \_y\_size\ =\ copy-\/>\_y\_size;}
\DoxyCodeLine{10871\ \ \ \_z\_size\ =\ copy-\/>\_z\_size;}
\DoxyCodeLine{10872\ \ \ \_num\_views\ =\ copy-\/>\_num\_views;}
\DoxyCodeLine{10873\ \ \ \_pad\_x\_size\ =\ copy-\/>\_pad\_x\_size;}
\DoxyCodeLine{10874\ \ \ \_pad\_y\_size\ =\ copy-\/>\_pad\_y\_size;}
\DoxyCodeLine{10875\ \ \ \_pad\_z\_size\ =\ copy-\/>\_pad\_z\_size;}
\DoxyCodeLine{10876\ \ \ \_orig\_file\_x\_size\ =\ copy-\/>\_orig\_file\_x\_size;}
\DoxyCodeLine{10877\ \ \ \_orig\_file\_y\_size\ =\ copy-\/>\_orig\_file\_y\_size;}
\DoxyCodeLine{10878\ \ \ \_num\_components\ =\ copy-\/>\_num\_components;}
\DoxyCodeLine{10879\ \ \ \_component\_width\ =\ copy-\/>\_component\_width;}
\DoxyCodeLine{10880\ \ \ \_texture\_type\ =\ copy-\/>\_texture\_type;}
\DoxyCodeLine{10881\ \ \ \_format\ =\ copy-\/>\_format;}
\DoxyCodeLine{10882\ \ \ \_component\_type\ =\ copy-\/>\_component\_type;}
\DoxyCodeLine{10883\ \ \ \_loaded\_from\_image\ =\ copy-\/>\_loaded\_from\_image;}
\DoxyCodeLine{10884\ \ \ \_loaded\_from\_txo\ =\ copy-\/>\_loaded\_from\_txo;}
\DoxyCodeLine{10885\ \ \ \_has\_read\_pages\ =\ copy-\/>\_has\_read\_pages;}
\DoxyCodeLine{10886\ \ \ \_has\_read\_mipmaps\ =\ copy-\/>\_has\_read\_mipmaps;}
\DoxyCodeLine{10887\ \ \ \_num\_mipmap\_levels\_read\ =\ copy-\/>\_num\_mipmap\_levels\_read;}
\DoxyCodeLine{10888\ \ \ \_default\_sampler\ =\ copy-\/>\_default\_sampler;}
\DoxyCodeLine{10889\ \ \ \_keep\_ram\_image\ =\ copy-\/>\_keep\_ram\_image;}
\DoxyCodeLine{10890\ \ \ \_compression\ =\ copy-\/>\_compression;}
\DoxyCodeLine{10891\ \ \ \_match\_framebuffer\_format\ =\ copy-\/>\_match\_framebuffer\_format;}
\DoxyCodeLine{10892\ \ \ \_quality\_level\ =\ copy-\/>\_quality\_level;}
\DoxyCodeLine{10893\ \ \ \_auto\_texture\_scale\ =\ copy-\/>\_auto\_texture\_scale;}
\DoxyCodeLine{10894\ \ \ \_ram\_image\_compression\ =\ copy-\/>\_ram\_image\_compression;}
\DoxyCodeLine{10895\ \ \ \_ram\_images\ =\ copy-\/>\_ram\_images;}
\DoxyCodeLine{10896\ \ \ \_simple\_x\_size\ =\ copy-\/>\_simple\_x\_size;}
\DoxyCodeLine{10897\ \ \ \_simple\_y\_size\ =\ copy-\/>\_simple\_y\_size;}
\DoxyCodeLine{10898\ \ \ \_simple\_ram\_image\ =\ copy-\/>\_simple\_ram\_image;}
\DoxyCodeLine{10899\ \}}
\DoxyCodeLine{10900\ }
\DoxyCodeLine{10904\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_1_1CData_a3850cb4b6f8ba6917ad480617aab4649}{Texture::CData::}}}
\DoxyCodeLine{10905\ \mbox{\hyperlink{classTexture_1_1CData_a3850cb4b6f8ba6917ad480617aab4649}{inc\_image\_page\_modified}}(\textcolor{keywordtype}{int}\ z)\ \{}
\DoxyCodeLine{10906\ \ \ ++\_image\_modified;}
\DoxyCodeLine{10907\ }
\DoxyCodeLine{10908\ \ \ ModifiedPageRanges::iterator\ it\ =\ \_modified\_pages.begin();}
\DoxyCodeLine{10909\ \ \ \textcolor{keywordflow}{while}\ (it\ !=\ \_modified\_pages.end()\ \&\&\ (*it).\_z\_end\ <=\ z)\ \{}
\DoxyCodeLine{10910\ \ \ \ \ ++it;}
\DoxyCodeLine{10911\ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{10912\ \ \ \}}
\DoxyCodeLine{10913\ \ \ nassertv(it\ !=\ \_modified\_pages.end());}
\DoxyCodeLine{10914\ }
\DoxyCodeLine{10915\ \ \ \textcolor{keywordtype}{size\_t}\ orig\_z\_end\ =\ (*it).\_z\_end;}
\DoxyCodeLine{10916\ \ \ \mbox{\hyperlink{classUpdateSeq}{UpdateSeq}}\ orig\_modified\ =\ (*it).\_modified;}
\DoxyCodeLine{10917\ }
\DoxyCodeLine{10918\ \ \ \textcolor{keywordflow}{if}\ (z\ >\ (*it).\_z\_begin)\ \{}
\DoxyCodeLine{10919\ \ \ \ \ \textcolor{comment}{//\ Split\ prefix.}}
\DoxyCodeLine{10920\ \ \ \ \ \mbox{\hyperlink{structTexture_1_1ModifiedPageRange}{ModifiedPageRange}}\ copy(*it);}
\DoxyCodeLine{10921\ \ \ \ \ copy.\_z\_end\ =\ z;}
\DoxyCodeLine{10922\ \ \ \ \ it\ =\ \_modified\_pages.insert(it,\ copy);}
\DoxyCodeLine{10923\ \ \ \ \ ++it;}
\DoxyCodeLine{10924\ \ \ \}}
\DoxyCodeLine{10925\ }
\DoxyCodeLine{10926\ \ \ (*it).\_z\_begin\ =\ z;}
\DoxyCodeLine{10927\ \ \ (*it).\_z\_end\ =\ z\ +\ 1;}
\DoxyCodeLine{10928\ \ \ (*it).\_modified\ =\ \_image\_modified;}
\DoxyCodeLine{10929\ }
\DoxyCodeLine{10930\ \ \ \textcolor{keywordflow}{if}\ (z\ +\ 1\ <\ orig\_z\_end)\ \{}
\DoxyCodeLine{10931\ \ \ \ \ \textcolor{comment}{//\ Split\ suffix.}}
\DoxyCodeLine{10932\ \ \ \ \ \mbox{\hyperlink{structTexture_1_1ModifiedPageRange}{ModifiedPageRange}}\ copy(*it);}
\DoxyCodeLine{10933\ \ \ \ \ copy.\_z\_begin\ =\ z\ +\ 1;}
\DoxyCodeLine{10934\ \ \ \ \ copy.\_z\_end\ =\ orig\_z\_end;}
\DoxyCodeLine{10935\ \ \ \ \ copy.\_modified\ =\ orig\_modified;}
\DoxyCodeLine{10936\ \ \ \ \ ++it;}
\DoxyCodeLine{10937\ \ \ \ \ \_modified\_pages.insert(it,\ copy);}
\DoxyCodeLine{10938\ \ \ \}}
\DoxyCodeLine{10939\ \}}
\DoxyCodeLine{10940\ }
\DoxyCodeLine{10945\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_1_1CData_a86d09f50cbfbdcef4ef7f9194bb18653}{Texture::CData::}}}
\DoxyCodeLine{10946\ \mbox{\hyperlink{classTexture_1_1CData_a86d09f50cbfbdcef4ef7f9194bb18653}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{10947\ \}}
\DoxyCodeLine{10948\ }
\DoxyCodeLine{10953\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexture_1_1CData_afca547455335098285e2345dd7b86153}{Texture::CData::}}}
\DoxyCodeLine{10954\ \mbox{\hyperlink{classTexture_1_1CData_afca547455335098285e2345dd7b86153}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{10955\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{10956\ \}}
\DoxyCodeLine{10957\ }
\DoxyCodeLine{10962\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexture_1_1CData_a3a15705d93acde8b2a8fd976676462bf}{Texture::CData::}}}
\DoxyCodeLine{10963\ \mbox{\hyperlink{classTexture_1_1CData_a3a15705d93acde8b2a8fd976676462bf}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{10964\ \}}
\DoxyCodeLine{10965\ }
\DoxyCodeLine{10969\ ostream\ \&}
\DoxyCodeLine{10970\ operator\ <<\ (ostream\ \&out,\ Texture::TextureType\ tt)\ \{}
\DoxyCodeLine{10971\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \mbox{\hyperlink{classTexture_aaefbfea0089fa4a0e156d04cbbfad382}{Texture::format\_texture\_type}}(tt);}
\DoxyCodeLine{10972\ \}}
\DoxyCodeLine{10973\ }
\DoxyCodeLine{10977\ ostream\ \&}
\DoxyCodeLine{10978\ operator\ <<\ (ostream\ \&out,\ Texture::ComponentType\ ct)\ \{}
\DoxyCodeLine{10979\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \mbox{\hyperlink{classTexture_a1e2ff1700b53dabad5997fb6a81e11a0}{Texture::format\_component\_type}}(ct);}
\DoxyCodeLine{10980\ \}}
\DoxyCodeLine{10981\ }
\DoxyCodeLine{10985\ ostream\ \&}
\DoxyCodeLine{10986\ operator\ <<\ (ostream\ \&out,\ Texture::Format\ f)\ \{}
\DoxyCodeLine{10987\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \mbox{\hyperlink{classTexture_af08a4893d78637835f8ea166212f9a78}{Texture::format\_format}}(f);}
\DoxyCodeLine{10988\ \}}
\DoxyCodeLine{10989\ }
\DoxyCodeLine{10993\ ostream\ \&}
\DoxyCodeLine{10994\ operator\ <<\ (ostream\ \&out,\ Texture::CompressionMode\ cm)\ \{}
\DoxyCodeLine{10995\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \mbox{\hyperlink{classTexture_a476671416398601f7f1900687d4fafcf}{Texture::format\_compression\_mode}}(cm);}
\DoxyCodeLine{10996\ \}}
\DoxyCodeLine{10997\ }
\DoxyCodeLine{11001\ ostream\ \&}
\DoxyCodeLine{11002\ operator\ <<\ (ostream\ \&out,\ Texture::QualityLevel\ tql)\ \{}
\DoxyCodeLine{11003\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \mbox{\hyperlink{classTexture_a3c766453bc4b9039b3db798eecb41a43}{Texture::format\_quality\_level}}(tql);}
\DoxyCodeLine{11004\ \}}
\DoxyCodeLine{11005\ }
\DoxyCodeLine{11009\ istream\ \&}
\DoxyCodeLine{11010\ operator\ >>\ (istream\ \&in,\ Texture::QualityLevel\ \&tql)\ \{}
\DoxyCodeLine{11011\ \ \ \textcolor{keywordtype}{string}\ word;}
\DoxyCodeLine{11012\ \ \ in\ >>\ word;}
\DoxyCodeLine{11013\ }
\DoxyCodeLine{11014\ \ \ tql\ =\ \mbox{\hyperlink{classTexture_a741de95224905db2590dbcdba235c699}{Texture::string\_quality\_level}}(word);}
\DoxyCodeLine{11015\ \ \ \textcolor{keywordflow}{return}\ in;}
\DoxyCodeLine{11016\ \}}

\end{DoxyCode}
