\doxysection{parametric\+Curve.\+cxx}
\hypertarget{parametricCurve_8cxx_source}{}\label{parametricCurve_8cxx_source}\index{panda/src/parametrics/parametricCurve.cxx@{panda/src/parametrics/parametricCurve.cxx}}
\mbox{\hyperlink{parametricCurve_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{parametricCurve_8h}{parametricCurve.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__parametrics_8h}{config\_parametrics.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hermiteCurve_8h}{hermiteCurve.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nurbsCurve_8h}{nurbsCurve.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{omniBoundingVolume_8h}{omniBoundingVolume.h}}"{}}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ tolerance\_divisor\ =\ 100000.0f;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ ParametricCurve::\_type\_handle;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00033\ ParametricCurve::}
\DoxyCodeLine{00034\ ParametricCurve()\ :\ \mbox{\hyperlink{classPandaNode}{PandaNode}}(\textcolor{stringliteral}{"{}curve"{}})\ \{}
\DoxyCodeLine{00035\ \ \ \_curve\_type\ =\ PCT\_NONE;}
\DoxyCodeLine{00036\ \ \ \_num\_dimensions\ =\ 3;}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00042\ ParametricCurve::}
\DoxyCodeLine{00043\ \string~ParametricCurve()\ \{}
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//\ Our\ drawer\ list\ must\ be\ empty\ by\ the\ time\ we\ destruct,\ since\ our\ drawers}}
\DoxyCodeLine{00045\ \ \ \textcolor{comment}{//\ all\ maintain\ reference-\/counting\ pointers\ to\ us!\ \ If\ this\ is\ not\ so,\ we}}
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ have\ lost\ a\ reference\ count\ somewhere,\ or\ we\ have\ gotten\ confused\ about}}
\DoxyCodeLine{00047\ \ \ \textcolor{comment}{//\ which\ drawers\ we're\ registered\ to.}}
\DoxyCodeLine{00048\ \ \ nassertv(\_drawers.empty());}
\DoxyCodeLine{00049\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00057\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_aa693b63da3870a9e93483b4582212023}{ParametricCurve::}}}
\DoxyCodeLine{00058\ \mbox{\hyperlink{classParametricCurve_aa693b63da3870a9e93483b4582212023}{safe\_to\_flatten}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a5efe82c1d8511b62b590cbbacf1d3010}{ParametricCurve::}}}
\DoxyCodeLine{00068\ \mbox{\hyperlink{classParametricCurve_a5efe82c1d8511b62b590cbbacf1d3010}{safe\_to\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{bool}\ ParametricCurve::}
\DoxyCodeLine{00078\ is\_valid()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00088\ PN\_stdfloat\ \mbox{\hyperlink{classParametricCurve_a588d07cb27814f01364bc5c5a024dfa4}{ParametricCurve::}}}
\DoxyCodeLine{00089\ \mbox{\hyperlink{classParametricCurve_a588d07cb27814f01364bc5c5a024dfa4}{get\_max\_t}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{return}\ 1.0f;}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00104\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_a5ea75c00bef073428840b1518f7ca034}{ParametricCurve::}}}
\DoxyCodeLine{00105\ \mbox{\hyperlink{classParametricCurve_a5ea75c00bef073428840b1518f7ca034}{set\_curve\_type}}(\textcolor{keywordtype}{int}\ type)\ \{}
\DoxyCodeLine{00106\ \ \ \_curve\_type\ =\ type;}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{switch}\ (\_curve\_type)\ \{}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{case}\ PCT\_XYZ:}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{case}\ PCT\_HPR:}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{case}\ PCT\_NONE:}
\DoxyCodeLine{00111\ \ \ \ \ \_num\_dimensions\ =\ 3;}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{case}\ PCT\_T:}
\DoxyCodeLine{00115\ \ \ \ \ \_num\_dimensions\ =\ 1;}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00119\ \ \ \ \ assert(0);}
\DoxyCodeLine{00120\ \ \ \}}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classParametricCurve_a1f3ab1411cc580dd339982d110591b13}{ParametricCurve::}}}
\DoxyCodeLine{00128\ \mbox{\hyperlink{classParametricCurve_a1f3ab1411cc580dd339982d110591b13}{get\_curve\_type}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordflow}{return}\ \_curve\_type;}
\DoxyCodeLine{00130\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00139\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_a9847b078634520b0dbb9c566cc2f5e26}{ParametricCurve::}}}
\DoxyCodeLine{00140\ \mbox{\hyperlink{classParametricCurve_a9847b078634520b0dbb9c566cc2f5e26}{set\_num\_dimensions}}(\textcolor{keywordtype}{int}\ num)\ \{}
\DoxyCodeLine{00141\ \ \ \_num\_dimensions\ =\ num;}
\DoxyCodeLine{00142\ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00150\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classParametricCurve_a300cdbe401df52d87b0e69d001731b2a}{ParametricCurve::}}}
\DoxyCodeLine{00151\ \mbox{\hyperlink{classParametricCurve_a300cdbe401df52d87b0e69d001731b2a}{get\_num\_dimensions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{return}\ \_num\_dimensions;}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00159\ PN\_stdfloat\ \mbox{\hyperlink{classParametricCurve_a15883df123f6387cf8f7622e59dbf0b9}{ParametricCurve::}}}
\DoxyCodeLine{00160\ \mbox{\hyperlink{classParametricCurve_a15883df123f6387cf8f7622e59dbf0b9}{calc\_length}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classParametricCurve_a15883df123f6387cf8f7622e59dbf0b9}{calc\_length}}(0.0f,\ \mbox{\hyperlink{classParametricCurve_a588d07cb27814f01364bc5c5a024dfa4}{get\_max\_t}}());}
\DoxyCodeLine{00162\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00168\ PN\_stdfloat\ \mbox{\hyperlink{classParametricCurve_a15883df123f6387cf8f7622e59dbf0b9}{ParametricCurve::}}}
\DoxyCodeLine{00169\ \mbox{\hyperlink{classParametricCurve_a15883df123f6387cf8f7622e59dbf0b9}{calc\_length}}(PN\_stdfloat\ from,\ PN\_stdfloat\ to)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00170\ \ \ PN\_stdfloat\ t1,\ t2;}
\DoxyCodeLine{00171\ \ \ LPoint3\ p1,\ p2;}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{comment}{//\ Normally\ we\ expect\ from\ <\ to.\ \ If\ they\ came\ in\ backwards,\ reverse\ them.}}
\DoxyCodeLine{00174\ \ \ PN\_stdfloat\ to\_minus\_from\ =\ to\ -\/\ from;}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{if}\ (to\_minus\_from\ <\ 0.0f)\ \{}
\DoxyCodeLine{00177\ \ \ \ \ PN\_stdfloat\ temp\ =\ to;}
\DoxyCodeLine{00178\ \ \ \ \ to\ =\ from;}
\DoxyCodeLine{00179\ \ \ \ \ from\ =\ temp;}
\DoxyCodeLine{00180\ \ \ \ \ to\_minus\_from=-\/to\_minus\_from;}
\DoxyCodeLine{00181\ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ Start\ with\ a\ segment\ for\ each\ unit\ of\ t.}}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{int}\ num\_segs\ =\ (int)(to\_minus\_from)\ +\ 1;}
\DoxyCodeLine{00185\ \ \ t2\ =\ from;}
\DoxyCodeLine{00186\ \ \ get\_point(t2,\ p2);}
\DoxyCodeLine{00187\ \ \ PN\_stdfloat\ net\ =\ 0.0f;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ num\_segs;\ i++)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ t1\ =\ t2;}
\DoxyCodeLine{00191\ \ \ \ \ p1\ =\ p2;}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ t2\ =\ (to\ -\/\ from)\ *\ (PN\_stdfloat)i\ /\ (PN\_stdfloat)num\_segs\ +\ from;}
\DoxyCodeLine{00194\ \ \ \ \ get\_point(t2,\ p2);}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \ \ net\ +=\ r\_calc\_length(t1,\ t2,\ p1,\ p2,\ (p1\ -\/\ p2).length());}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ \ \ \textcolor{keywordflow}{return}\ net;}
\DoxyCodeLine{00199\ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00211\ PN\_stdfloat\ \mbox{\hyperlink{classParametricCurve_aed963692db3b7cc0fc745c811d5ab10d}{ParametricCurve::}}}
\DoxyCodeLine{00212\ \mbox{\hyperlink{classParametricCurve_aed963692db3b7cc0fc745c811d5ab10d}{find\_length}}(PN\_stdfloat\ start\_t,\ PN\_stdfloat\ length\_offset)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00213\ \ \ nassertr(length\_offset\ >=\ 0.0f,\ start\_t);}
\DoxyCodeLine{00214\ \ \ nassertr(start\_t\ >=\ 0.0f\ \&\&\ start\_t\ <=\ \mbox{\hyperlink{classParametricCurve_a588d07cb27814f01364bc5c5a024dfa4}{get\_max\_t}}(),\ start\_t);}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ PN\_stdfloat\ t1,\ t2;}
\DoxyCodeLine{00217\ \ \ LPoint3\ p1,\ p2;}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{comment}{//\ Start\ with\ a\ segment\ for\ each\ unit\ of\ t.}}
\DoxyCodeLine{00220\ \ \ PN\_stdfloat\ max\_t\ =\ \mbox{\hyperlink{classParametricCurve_a588d07cb27814f01364bc5c5a024dfa4}{get\_max\_t}}();}
\DoxyCodeLine{00221\ \ \ \textcolor{keywordtype}{int}\ num\_segs\ =\ (int)cfloor(max\_t\ -\/\ start\_t\ +\ 1);}
\DoxyCodeLine{00222\ \ \ t2\ =\ start\_t;}
\DoxyCodeLine{00223\ \ \ get\_point(t2,\ p2);}
\DoxyCodeLine{00224\ \ \ PN\_stdfloat\ net\ =\ 0.0f;}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <=\ num\_segs;\ i++)\ \{}
\DoxyCodeLine{00227\ \ \ \ \ assert(net\ <=\ length\_offset);}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ t1\ =\ t2;}
\DoxyCodeLine{00230\ \ \ \ \ p1\ =\ p2;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ t2\ =\ start\_t\ +\ (((max\_t\ -\/\ start\_t)\ *\ (PN\_stdfloat)i)\ /\ (PN\_stdfloat)num\_segs);}
\DoxyCodeLine{00233\ \ \ \ \ get\_point(t2,\ p2);}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ PN\_stdfloat\ seglength\ =\ (p1\ -\/\ p2).length();}
\DoxyCodeLine{00236\ \ \ \ \ PN\_stdfloat\ result;}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\_find\_length(length\_offset\ -\/\ net,\ result,}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ t1,\ t2,\ p1,\ p2,\ seglength))\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{comment}{//\ Found\ it!}}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00242\ \ \ \ \ \}}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ net\ +=\ seglength;}
\DoxyCodeLine{00245\ \ \ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \textcolor{comment}{//\ Not\ on\ the\ curve?\ \ Huh.}}
\DoxyCodeLine{00248\ \ \ \textcolor{keywordflow}{return}\ max\_t;}
\DoxyCodeLine{00249\ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00255\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a578d9c663a5f2a594236400664ad447a}{ParametricCurve::}}}
\DoxyCodeLine{00256\ \mbox{\hyperlink{classParametricCurve_a578d9c663a5f2a594236400664ad447a}{adjust\_point}}(PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat)\ \{}
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00258\ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00264\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a1354e5030e704cc47786630ac5d260bc}{ParametricCurve::}}}
\DoxyCodeLine{00265\ \mbox{\hyperlink{classParametricCurve_a1354e5030e704cc47786630ac5d260bc}{adjust\_tangent}}(PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat)\ \{}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00273\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a12b602c840b61eede815d4d06eb08700}{ParametricCurve::}}}
\DoxyCodeLine{00274\ \mbox{\hyperlink{classParametricCurve_a12b602c840b61eede815d4d06eb08700}{adjust\_pt}}(PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat,\ PN\_stdfloat)\ \{}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00276\ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00282\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a21b218995e8127cf2a8f0fb78a6c0af9}{ParametricCurve::}}}
\DoxyCodeLine{00283\ \mbox{\hyperlink{classParametricCurve_a21b218995e8127cf2a8f0fb78a6c0af9}{recompute}}()\ \{}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{return}\ is\_valid();}
\DoxyCodeLine{00285\ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00294\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a993415943ccd5088560ab63c13cfeb95}{ParametricCurve::}}}
\DoxyCodeLine{00295\ \mbox{\hyperlink{classParametricCurve_a993415943ccd5088560ab63c13cfeb95}{stitch}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *)\ \{}
\DoxyCodeLine{00296\ \ \ parametrics\_cat.error()}
\DoxyCodeLine{00297\ \ \ \ \ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}\ does\ not\ support\ stitching.\(\backslash\)n"{}};}
\DoxyCodeLine{00298\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00299\ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00306\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a93649700ff540cd70a406cc3a2bfe060}{ParametricCurve::}}}
\DoxyCodeLine{00307\ \mbox{\hyperlink{classParametricCurve_a93649700ff540cd70a406cc3a2bfe060}{write\_egg}}(\mbox{\hyperlink{classFilename}{Filename}}\ filename,\ CoordinateSystem\ cs)\ \{}
\DoxyCodeLine{00308\ \ \ pofstream\ out;}
\DoxyCodeLine{00309\ \ \ filename.set\_text();}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{keywordflow}{if}\ (!filename.\mbox{\hyperlink{classFilename_ad37a9d52c837218b01076de184dc5f4d}{open\_write}}(out))\ \{}
\DoxyCodeLine{00312\ \ \ \ \ parametrics\_cat.error()}
\DoxyCodeLine{00313\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ write\ to\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00315\ \ \ \}}
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classParametricCurve_a93649700ff540cd70a406cc3a2bfe060}{write\_egg}}(out,\ filename,\ cs);}
\DoxyCodeLine{00317\ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00323\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a93649700ff540cd70a406cc3a2bfe060}{ParametricCurve::}}}
\DoxyCodeLine{00324\ \mbox{\hyperlink{classParametricCurve_a93649700ff540cd70a406cc3a2bfe060}{write\_egg}}(std::ostream\ \&out,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename,\ CoordinateSystem\ cs)\ \{}
\DoxyCodeLine{00325\ \ \ std::string\ curve\_type;}
\DoxyCodeLine{00326\ \ \ \textcolor{keywordflow}{switch}\ (\mbox{\hyperlink{classParametricCurve_a1f3ab1411cc580dd339982d110591b13}{get\_curve\_type}}())\ \{}
\DoxyCodeLine{00327\ \ \ \textcolor{keywordflow}{case}\ PCT\_XYZ:}
\DoxyCodeLine{00328\ \ \ \ \ curve\_type\ =\ \textcolor{stringliteral}{"{}xyz"{}};}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \textcolor{keywordflow}{case}\ PCT\_HPR:}
\DoxyCodeLine{00332\ \ \ \ \ curve\_type\ =\ \textcolor{stringliteral}{"{}hpr"{}};}
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{case}\ PCT\_T:}
\DoxyCodeLine{00336\ \ \ \ \ curve\_type\ =\ \textcolor{stringliteral}{"{}t"{}};}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00338\ \ \ \}}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{if}\ (!has\_name())\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ name,\ come\ up\ with\ one.}}
\DoxyCodeLine{00342\ \ \ \ \ std::string\ name\ =\ filename.get\_basename\_wo\_extension();}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordflow}{if}\ (!curve\_type.empty())\ \{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ name\ +=\ \textcolor{stringliteral}{"{}\_"{}};}
\DoxyCodeLine{00346\ \ \ \ \ \ \ name\ +=\ curve\_type;}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ set\_name(name);}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{keywordflow}{if}\ (cs\ ==\ CS\_default)\ \{}
\DoxyCodeLine{00353\ \ \ \ \ cs\ =\ get\_default\_coordinate\_system();}
\DoxyCodeLine{00354\ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{keywordflow}{if}\ (cs\ !=\ CS\_invalid)\ \{}
\DoxyCodeLine{00357\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}<CoordinateSystem>\ \{\ "{}};}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keywordflow}{switch}\ (cs)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_right:}
\DoxyCodeLine{00360\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Z-\/Up"{}};}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_right:}
\DoxyCodeLine{00364\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Y-\/Up"{}};}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_left:}
\DoxyCodeLine{00368\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Z-\/Up-\/Left"{}};}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_left:}
\DoxyCodeLine{00372\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Y-\/Up-\/Left"{}};}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00377\ \ \ \ \ \}}
\DoxyCodeLine{00378\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \}\(\backslash\)n\(\backslash\)n"{}};}
\DoxyCodeLine{00379\ \ \ \}}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classParametricCurve_aa35175a6bcf8a131de0d5bf852f82e09}{format\_egg}}(out,\ get\_name(),\ curve\_type,\ 0))\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00384\ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{if}\ (out)\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00388\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00390\ \ \ \}}
\DoxyCodeLine{00391\ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00400\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a52da83c318893d4d4763675cae8af7ec}{ParametricCurve::}}}
\DoxyCodeLine{00401\ \mbox{\hyperlink{classParametricCurve_a52da83c318893d4d4763675cae8af7ec}{get\_bezier\_segs}}(\mbox{\hyperlink{classpvector}{ParametricCurve::BezierSegs}}\ \&)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00403\ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00410\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a3c968067a5209e90859363f3ed706eef}{ParametricCurve::}}}
\DoxyCodeLine{00411\ \mbox{\hyperlink{classParametricCurve_a3c968067a5209e90859363f3ed706eef}{get\_bezier\_seg}}(\mbox{\hyperlink{structParametricCurve_1_1BezierSeg}{ParametricCurve::BezierSeg}}\ \&)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00412\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00413\ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00419\ \mbox{\hyperlink{classNurbsCurveInterface}{NurbsCurveInterface}}\ *\mbox{\hyperlink{classParametricCurve_a340c26a3756e55cb0d3347825e7d38f9}{ParametricCurve::}}}
\DoxyCodeLine{00420\ \mbox{\hyperlink{classParametricCurve_a340c26a3756e55cb0d3347825e7d38f9}{get\_nurbs\_interface}}()\ \{}
\DoxyCodeLine{00421\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00422\ \}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00428\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_ad29874c5e7501e1d01cbc0d0ade9e71d}{ParametricCurve::}}}
\DoxyCodeLine{00429\ \mbox{\hyperlink{classParametricCurve_ad29874c5e7501e1d01cbc0d0ade9e71d}{convert\_to\_hermite}}(\mbox{\hyperlink{classHermiteCurve}{HermiteCurve}}\ *hc)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00430\ \ \ \mbox{\hyperlink{classpvector}{BezierSegs}}\ bz\_segs;}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classParametricCurve_a52da83c318893d4d4763675cae8af7ec}{get\_bezier\_segs}}(bz\_segs))\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ hc-\/>\mbox{\hyperlink{classParametricCurve_a5ea75c00bef073428840b1518f7ca034}{set\_curve\_type}}(\_curve\_type);}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \textcolor{comment}{//\ Now\ convert\ the\ Bezier\ segments\ to\ a\ Hermite.\ \ Normally,\ the\ Beziers\ will}}
\DoxyCodeLine{00438\ \ \ \textcolor{comment}{//\ match\ up\ head-\/to-\/tail,\ but\ if\ they\ don't,\ that's\ a\ cut.}}
\DoxyCodeLine{00439\ \ \ hc-\/>remove\_all\_cvs();}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{keywordtype}{int}\ i,\ n;}
\DoxyCodeLine{00442\ \ \ \textcolor{keywordflow}{if}\ (!bz\_segs.empty())\ \{}
\DoxyCodeLine{00443\ \ \ \ \ PN\_stdfloat\ scale\_in\ =\ 0.0f;}
\DoxyCodeLine{00444\ \ \ \ \ PN\_stdfloat\ scale\_out\ =\ bz\_segs[0].\_t;}
\DoxyCodeLine{00445\ \ \ \ \ n\ =\ hc-\/>append\_cv(HC\_SMOOTH,\ bz\_segs[0].\_v[0]);}
\DoxyCodeLine{00446\ \ \ \ \ hc-\/>set\_cv\_out(n,\ 3.0f\ *\ (bz\_segs[0].\_v[1]\ -\/\ bz\_segs[0].\_v[0])\ /\ scale\_out);}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ (int)bz\_segs.size()-\/1;\ i++)\ \{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ scale\_in\ =\ scale\_out;}
\DoxyCodeLine{00450\ \ \ \ \ \ \ scale\_out\ =\ bz\_segs[i+1].\_t\ -\/\ bz\_segs[i].\_t;}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!bz\_segs[i].\_v[3].almost\_equal(bz\_segs[i+1].\_v[0],\ 0.0001f))\ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Oops,\ we\ have\ a\ cut.}}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ hc-\/>set\_cv\_type(n,\ HC\_CUT);}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \ \ n\ =\ hc-\/>append\_cv(HC\_FREE,\ bz\_segs[i+1].\_v[0]);}
\DoxyCodeLine{00458\ \ \ \ \ \ \ hc-\/>set\_cv\_in(n,\ 3.0f\ *\ (bz\_segs[i].\_v[3]\ -\/\ bz\_segs[i].\_v[2])\ /\ scale\_in);}
\DoxyCodeLine{00459\ \ \ \ \ \ \ hc-\/>set\_cv\_tstart(n,\ bz\_segs[i].\_t);}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \ \ hc-\/>set\_cv\_out(n,\ 3.0f\ *\ (bz\_segs[i+1].\_v[1]\ -\/\ bz\_segs[i+1].\_v[0])\ /\ scale\_out);}
\DoxyCodeLine{00462\ \ \ \ \ \}}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{comment}{//\ Now\ the\ last\ CV.}}
\DoxyCodeLine{00465\ \ \ \ \ scale\_in\ =\ scale\_out;}
\DoxyCodeLine{00466\ \ \ \ \ i\ =\ bz\_segs.size()-\/1;}
\DoxyCodeLine{00467\ \ \ \ \ n\ =\ hc-\/>append\_cv(HC\_SMOOTH,\ bz\_segs[i].\_v[3]);}
\DoxyCodeLine{00468\ \ \ \ \ hc-\/>set\_cv\_in(n,\ 3.0f\ *\ (bz\_segs[i].\_v[3]\ -\/\ bz\_segs[i].\_v[2])\ /\ scale\_in);}
\DoxyCodeLine{00469\ \ \ \ \ hc-\/>set\_cv\_tstart(n,\ bz\_segs[i].\_t);}
\DoxyCodeLine{00470\ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{comment}{//\ Finally,\ go\ through\ and\ figure\ out\ which\ CV's\ are\ smooth\ or\ G1.}}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordtype}{int}\ num\_cvs\ =\ hc-\/>get\_num\_cvs();}
\DoxyCodeLine{00474\ \ \ \textcolor{keywordflow}{for}\ (n\ =\ 1;\ n\ <\ num\_cvs-\/1;\ n++)\ \{}
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{keywordflow}{if}\ (hc-\/>get\_cv\_type(n)!=HC\_CUT)\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ LVector3\ in\ =\ hc-\/>get\_cv\_in(n);}
\DoxyCodeLine{00477\ \ \ \ \ \ \ LVector3\ out\ =\ hc-\/>get\_cv\_out(n);}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in.almost\_equal(out,\ 0.0001f))\ \{}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ hc-\/>set\_cv\_type(n,\ HC\_SMOOTH);}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ in.normalize();}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ out.normalize();}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in.almost\_equal(out,\ 0.0001f))\ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ hc-\/>set\_cv\_type(n,\ HC\_G1);}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00488\ \ \ \ \ \}}
\DoxyCodeLine{00489\ \ \ \}}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00491\ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00497\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_a33105b5382bc116772edae8387294648}{ParametricCurve::}}}
\DoxyCodeLine{00498\ \mbox{\hyperlink{classParametricCurve_a33105b5382bc116772edae8387294648}{convert\_to\_nurbs}}(\mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *nc)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00499\ \ \ \mbox{\hyperlink{classNurbsCurveInterface}{NurbsCurveInterface}}\ *nurbs\ =\ nc-\/>\mbox{\hyperlink{classParametricCurve_a340c26a3756e55cb0d3347825e7d38f9}{get\_nurbs\_interface}}();}
\DoxyCodeLine{00500\ \ \ nassertr(nurbs\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \mbox{\hyperlink{classpvector}{BezierSegs}}\ bz\_segs;}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classParametricCurve_a52da83c318893d4d4763675cae8af7ec}{get\_bezier\_segs}}(bz\_segs))\ \{}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00505\ \ \ \}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ nc-\/>\mbox{\hyperlink{classParametricCurve_a5ea75c00bef073428840b1518f7ca034}{set\_curve\_type}}(\_curve\_type);}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ nurbs-\/>remove\_all\_cvs();}
\DoxyCodeLine{00510\ \ \ nurbs-\/>set\_order(4);}
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{if}\ (!bz\_segs.empty())\ \{}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ (int)bz\_segs.size();\ i++)\ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ nurbs-\/>append\_cv(bz\_segs[i].\_v[0]);}
\DoxyCodeLine{00515\ \ \ \ \ \ \ nurbs-\/>append\_cv(bz\_segs[i].\_v[1]);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ nurbs-\/>append\_cv(bz\_segs[i].\_v[2]);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ (\textcolor{keywordtype}{int})bz\_segs.size()-\/1\ ||}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ !bz\_segs[i].\_v[3].almost\_equal(bz\_segs[i+1].\_v[0],\ 0.0001f))\ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ nurbs-\/>append\_cv(bz\_segs[i].\_v[3]);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00521\ \ \ \ \ \}}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \ \ PN\_stdfloat\ t;}
\DoxyCodeLine{00524\ \ \ \ \ \textcolor{keywordtype}{int}\ ki\ =\ 4;}
\DoxyCodeLine{00525\ \ \ \ \ nurbs-\/>set\_knot(0,\ 0.0f);}
\DoxyCodeLine{00526\ \ \ \ \ nurbs-\/>set\_knot(1,\ 0.0f);}
\DoxyCodeLine{00527\ \ \ \ \ nurbs-\/>set\_knot(2,\ 0.0f);}
\DoxyCodeLine{00528\ \ \ \ \ nurbs-\/>set\_knot(3,\ 0.0f);}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ (int)bz\_segs.size();\ i++)\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ t\ =\ bz\_segs[i].\_t;}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ \ \ nurbs-\/>set\_knot(ki,\ t);}
\DoxyCodeLine{00534\ \ \ \ \ \ \ nurbs-\/>set\_knot(ki+1,\ t);}
\DoxyCodeLine{00535\ \ \ \ \ \ \ nurbs-\/>set\_knot(ki+2,\ t);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ ki\ +=\ 3;}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ ((\textcolor{keywordtype}{int})bz\_segs.size())-\/1\ ||}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ !bz\_segs[i].\_v[3].almost\_equal(bz\_segs[i+1].\_v[0],\ 0.0001f))\ \{}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ nurbs-\/>set\_knot(ki,\ t);}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ ki++;}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00542\ \ \ \ \ \}}
\DoxyCodeLine{00543\ \ \ \}}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{return}\ nc-\/>\mbox{\hyperlink{classParametricCurve_a21b218995e8127cf2a8f0fb78a6c0af9}{recompute}}();}
\DoxyCodeLine{00546\ \}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00557\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_a8ef702b1ce1d1b86d1ed9354777ebd0e}{ParametricCurve::}}}
\DoxyCodeLine{00558\ \mbox{\hyperlink{classParametricCurve_a8ef702b1ce1d1b86d1ed9354777ebd0e}{register\_drawer}}(ParametricCurveDrawer\ *drawer)\ \{}
\DoxyCodeLine{00559\ \ \ \_drawers.push\_back(drawer);}
\DoxyCodeLine{00560\ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00567\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_ace67bcf9968b84ee8887b544ad2ce91b}{ParametricCurve::}}}
\DoxyCodeLine{00568\ \mbox{\hyperlink{classParametricCurve_ace67bcf9968b84ee8887b544ad2ce91b}{unregister\_drawer}}(ParametricCurveDrawer\ *drawer)\ \{}
\DoxyCodeLine{00569\ \ \ \_drawers.remove(drawer);}
\DoxyCodeLine{00570\ \}}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00579\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_a8a5a0688cc9a5b24a59c77e18780f079}{ParametricCurve::}}}
\DoxyCodeLine{00580\ \mbox{\hyperlink{classParametricCurve_a8a5a0688cc9a5b24a59c77e18780f079}{invalidate}}(PN\_stdfloat,\ PN\_stdfloat)\ \{}
\DoxyCodeLine{00581\ \ \ \mbox{\hyperlink{classParametricCurve_ab30299891aa1c8856b7dfd1da204fd9b}{invalidate\_all}}();}
\DoxyCodeLine{00582\ \}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00588\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_ab30299891aa1c8856b7dfd1da204fd9b}{ParametricCurve::}}}
\DoxyCodeLine{00589\ \mbox{\hyperlink{classParametricCurve_ab30299891aa1c8856b7dfd1da204fd9b}{invalidate\_all}}()\ \{}
\DoxyCodeLine{00590\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00591\ \textcolor{comment}{\ \ DrawerList::iterator\ n;}}
\DoxyCodeLine{00592\ \textcolor{comment}{\ \ for\ (n\ =\ \_drawers.begin();}}
\DoxyCodeLine{00593\ \textcolor{comment}{\ \ \ \ \ \ \ n\ !=\ \_drawers.end();}}
\DoxyCodeLine{00594\ \textcolor{comment}{\ \ \ \ \ \ \ ++n)\ \{}}
\DoxyCodeLine{00595\ \textcolor{comment}{\ \ \ \ (*n)-\/>redraw();}}
\DoxyCodeLine{00596\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00597\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00604\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classParametricCurve_aa35175a6bcf8a131de0d5bf852f82e09}{ParametricCurve::}}}
\DoxyCodeLine{00605\ \mbox{\hyperlink{classParametricCurve_aa35175a6bcf8a131de0d5bf852f82e09}{format\_egg}}(std::ostream\ \&,\ \textcolor{keyword}{const}\ std::string\ \&,\ \textcolor{keyword}{const}\ std::string\ \&,\ \textcolor{keywordtype}{int})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00606\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00607\ \}}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00616\ PN\_stdfloat\ ParametricCurve::}
\DoxyCodeLine{00617\ r\_calc\_length(PN\_stdfloat\ t1,\ PN\_stdfloat\ t2,\ \textcolor{keyword}{const}\ LPoint3\ \&p1,\ \textcolor{keyword}{const}\ LPoint3\ \&p2,}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ seglength)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00619\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ length\_tolerance\ =\ 0.0000001f;}
\DoxyCodeLine{00620\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ t\_tolerance\ =\ 0.000001f;}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \textcolor{keywordflow}{if}\ (t2\ -\/\ t1\ <\ t\_tolerance)\ \{}
\DoxyCodeLine{00623\ \ \ \ \ \textcolor{comment}{//\ Stop\ recursing-\/-\/we've\ just\ walked\ off\ the\ limit\ for\ representing}}
\DoxyCodeLine{00624\ \ \ \ \ \textcolor{comment}{//\ smaller\ values\ of\ t.}}
\DoxyCodeLine{00625\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0f;}
\DoxyCodeLine{00626\ \ \ \}}
\DoxyCodeLine{00627\ }
\DoxyCodeLine{00628\ \ \ PN\_stdfloat\ tmid;}
\DoxyCodeLine{00629\ \ \ LPoint3\ pmid;}
\DoxyCodeLine{00630\ \ \ PN\_stdfloat\ left,\ right;}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \textcolor{comment}{//\ Calculate\ the\ point\ on\ the\ curve\ midway\ between\ the\ two\ endpoints.}}
\DoxyCodeLine{00633\ \ \ tmid\ =\ (t1+t2)*0.5f;}
\DoxyCodeLine{00634\ \ \ get\_point(tmid,\ pmid);}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ \textcolor{comment}{//\ Did\ we\ increase\ the\ length\ of\ the\ segment\ measurably?}}
\DoxyCodeLine{00637\ \ \ left\ =\ (p1\ -\/\ pmid).length();}
\DoxyCodeLine{00638\ \ \ right\ =\ (pmid\ -\/\ p2).length();}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \textcolor{keywordflow}{if}\ ((left\ +\ right)\ -\/\ seglength\ <\ length\_tolerance)\ \{}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{comment}{//\ No.\ \ We're\ done.}}
\DoxyCodeLine{00642\ \ \ \ \ \textcolor{keywordflow}{return}\ seglength;}
\DoxyCodeLine{00643\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{comment}{//\ Yes.\ \ Keep\ going.}}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keywordflow}{return}\ r\_calc\_length(t1,\ tmid,\ p1,\ pmid,\ left)\ +}
\DoxyCodeLine{00646\ \ \ \ \ \ \ r\_calc\_length(tmid,\ t2,\ pmid,\ p2,\ right);}
\DoxyCodeLine{00647\ \ \ \}}
\DoxyCodeLine{00648\ \}}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00658\ \textcolor{keywordtype}{bool}\ ParametricCurve::}
\DoxyCodeLine{00659\ r\_find\_length(PN\_stdfloat\ target\_length,\ PN\_stdfloat\ \&found\_t,}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ t1,\ PN\_stdfloat\ t2,}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3\ \&p1,\ \textcolor{keyword}{const}\ LPoint3\ \&p2,}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ \&seglength)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00663\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ length\_tolerance\ =\ 0.0000001f;}
\DoxyCodeLine{00664\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ t\_tolerance\ =\ 0.000001f;}
\DoxyCodeLine{00665\ }
\DoxyCodeLine{00666\ \ \ \textcolor{keywordflow}{if}\ (target\_length\ <\ t\_tolerance)\ \{}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{comment}{//\ Stop\ recursing-\/-\/we've\ just\ walked\ off\ the\ limit\ for\ representing}}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{comment}{//\ smaller\ values\ of\ t.}}
\DoxyCodeLine{00669\ \ \ \ \ found\_t\ =\ t1;}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \}}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ \ \ PN\_stdfloat\ tmid;}
\DoxyCodeLine{00675\ \ \ LPoint3\ pmid;}
\DoxyCodeLine{00676\ \ \ PN\_stdfloat\ left,\ right;}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \textcolor{comment}{//\ Calculate\ the\ point\ on\ the\ curve\ midway\ between\ the\ two\ endpoints.}}
\DoxyCodeLine{00679\ \ \ tmid\ =\ (t1+t2)*0.5f;}
\DoxyCodeLine{00680\ \ \ get\_point(tmid,\ pmid);}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00682\ \ \ \textcolor{comment}{//\ Did\ we\ increase\ the\ length\ of\ the\ segment\ measurably?}}
\DoxyCodeLine{00683\ \ \ left\ =\ (p1\ -\/\ pmid).length();}
\DoxyCodeLine{00684\ \ \ right\ =\ (pmid\ -\/\ p2).length();}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ \textcolor{keywordflow}{if}\ ((left\ +\ right)\ -\/\ seglength\ <\ length\_tolerance)\ \{}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{comment}{//\ No.\ \ Curve\ is\ relatively\ straight\ over\ this\ interval.}}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{return}\ find\_t\_linear(target\_length,\ found\_t,\ t1,\ t2,\ p1,\ p2);}
\DoxyCodeLine{00689\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00690\ \textcolor{comment}{\ \ \ \ if\ (target\_length\ <=\ seglength)\ \{}}
\DoxyCodeLine{00691\ \textcolor{comment}{\ \ \ \ \ \ //\ Compute\ t\ value\ that\ corresponds\ to\ target\_length\ Maybe\ the\ point\ is}}
\DoxyCodeLine{00692\ \textcolor{comment}{\ \ \ \ \ \ //\ in\ the\ left\ half\ of\ the\ segment?}}
\DoxyCodeLine{00693\ \textcolor{comment}{\ \ \ \ \ \ if\ (r\_find\_t(target\_length,\ found\_t,\ t1,\ tmid,\ p1,\ pmid))\ \{}}
\DoxyCodeLine{00694\ \textcolor{comment}{\ \ \ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{00695\ \textcolor{comment}{\ \ \ \ \ \ \}}}
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ \ \ \ \ //\ Maybe\ it's\ on\ the\ right\ half?}}
\DoxyCodeLine{00697\ \textcolor{comment}{\ \ \ \ \ \ if\ (r\_find\_t(target\_length\ -\/\ left,\ found\_t,\ tmid,\ t2,\ pmid,\ p2))\ \{}}
\DoxyCodeLine{00698\ \textcolor{comment}{\ \ \ \ \ \ \ \ return\ true;}}
\DoxyCodeLine{00699\ \textcolor{comment}{\ \ \ \ \ \ \}}}
\DoxyCodeLine{00700\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00701\ \textcolor{comment}{\ \ \ \ return\ false;}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00703\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{comment}{//\ Yes.\ \ Keep\ going.}}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \ \ \textcolor{comment}{//\ Maybe\ the\ point\ is\ in\ the\ left\ half\ of\ the\ segment?}}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\_find\_length(target\_length,\ found\_t,\ t1,\ tmid,\ p1,\ pmid,\ left))\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00709\ \ \ \ \ \}}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00711\ \ \ \ \ \textcolor{comment}{//\ Maybe\ it's\ on\ the\ right\ half?}}
\DoxyCodeLine{00712\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\_find\_length(target\_length\ -\/\ left,\ found\_t,\ tmid,\ t2,\ pmid,\ p2,\ right))\ \{}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00714\ \ \ \ \ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \ \ \textcolor{comment}{//\ Neither.\ \ Keep\ going.}}
\DoxyCodeLine{00717\ \ \ \ \ seglength\ =\ left\ +\ right;}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00719\ \ \ \}}
\DoxyCodeLine{00720\ \}}
\DoxyCodeLine{00721\ }
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00731\ \textcolor{keywordtype}{bool}\ ParametricCurve::}
\DoxyCodeLine{00732\ r\_find\_t(PN\_stdfloat\ target\_length,\ PN\_stdfloat\ \&found\_t,}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ t1,\ PN\_stdfloat\ t2,}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3\ \&p1,\ \textcolor{keyword}{const}\ LPoint3\ \&p2)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00735\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ length\_tolerance\ =\ 0.0001f;}
\DoxyCodeLine{00736\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ t\_tolerance\ =\ 0.0001f;}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_spam())\ \{}
\DoxyCodeLine{00739\ \ \ \ \ parametrics\_cat.spam()}
\DoxyCodeLine{00740\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}target\_length\ "{}}\ <<\ target\_length\ <<\ \textcolor{stringliteral}{"{}\ t1\ "{}}\ <<\ t1\ <<\ \textcolor{stringliteral}{"{}\ t2\ "{}}\ <<\ t2\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00741\ \ \ \}}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \textcolor{comment}{//\ Is\ the\ target\ point\ close\ to\ the\ near\ endpoint}}
\DoxyCodeLine{00744\ \ \ \textcolor{keywordflow}{if}\ (target\_length\ <\ length\_tolerance)\ \{}
\DoxyCodeLine{00745\ \ \ \ \ found\_t\ =\ t1;}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00747\ \ \ \}}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00749\ \ \ \textcolor{comment}{//\ No,\ compute\ distance\ between\ two\ endpoints}}
\DoxyCodeLine{00750\ \ \ PN\_stdfloat\ point\_dist;}
\DoxyCodeLine{00751\ \ \ point\_dist\ =\ (p2\ -\/\ p1).length();}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00753\ \ \ \textcolor{comment}{//\ Is\ the\ target\ point\ past\ the\ far\ endpoint?}}
\DoxyCodeLine{00754\ \ \ \textcolor{keywordflow}{if}\ (point\_dist\ <\ target\_length)\ \{}
\DoxyCodeLine{00755\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00756\ \ \ \}}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{comment}{//\ Is\ the\ target\ point\ close\ to\ far\ endpoint?}}
\DoxyCodeLine{00759\ \ \ \textcolor{keywordflow}{if}\ (\ (point\_dist\ -\/\ target\_length\ )\ <\ length\_tolerance\ )\ \{}
\DoxyCodeLine{00760\ \ \ \ \ found\_t\ =\ t2;}
\DoxyCodeLine{00761\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00762\ \ \ \}}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \textcolor{comment}{//\ are\ we\ running\ out\ of\ parametric\ precision?}}
\DoxyCodeLine{00765\ \ \ \textcolor{keywordflow}{if}\ ((t2\ -\/\ t1)\ <\ t\_tolerance)\ \{}
\DoxyCodeLine{00766\ \ \ \ \ found\_t\ =\ t1;}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00768\ \ \ \}}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ \ \ \textcolor{comment}{//\ No,\ subdivide\ and\ continue}}
\DoxyCodeLine{00771\ \ \ PN\_stdfloat\ tmid;}
\DoxyCodeLine{00772\ \ \ LPoint3\ pmid;}
\DoxyCodeLine{00773\ \ \ PN\_stdfloat\ left;}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ \textcolor{comment}{//\ Calculate\ the\ point\ on\ the\ curve\ midway\ between\ the\ two\ endpoints.}}
\DoxyCodeLine{00776\ \ \ tmid\ =\ (t1+t2)*0.5f;}
\DoxyCodeLine{00777\ \ \ get\_point(tmid,\ pmid);}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \textcolor{comment}{//\ Maybe\ the\ point\ is\ in\ the\ left\ half\ of\ the\ segment?}}
\DoxyCodeLine{00780\ \ \ \textcolor{keywordflow}{if}\ (r\_find\_t(target\_length,\ found\_t,\ t1,\ tmid,\ p1,\ pmid))\ \{}
\DoxyCodeLine{00781\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00782\ \ \ \}}
\DoxyCodeLine{00783\ \ \ \textcolor{comment}{//\ Nope,\ must\ be\ in\ the\ right\ half}}
\DoxyCodeLine{00784\ \ \ left\ =\ (p1\ -\/\ pmid).length();}
\DoxyCodeLine{00785\ \ \ \textcolor{keywordflow}{if}\ (r\_find\_t(target\_length\ -\/\ left,\ found\_t,\ tmid,\ t2,\ pmid,\ p2))\ \{}
\DoxyCodeLine{00786\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00787\ \ \ \}}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \textcolor{comment}{//\ not\ found\ in\ either\ half,\ keep\ looking}}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00791\ \}}
\DoxyCodeLine{00792\ }
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00797\ \textcolor{keywordtype}{bool}\ ParametricCurve::}
\DoxyCodeLine{00798\ find\_t\_linear(PN\_stdfloat\ target\_length,\ PN\_stdfloat\ \&found\_t,}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ t1,\ PN\_stdfloat\ t2,}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3\ \&p1,\ \textcolor{keyword}{const}\ LPoint3\ \&p2)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00801\ \ \ \textcolor{keyword}{const}\ PN\_stdfloat\ length\_tolerance\ =\ (p1-\/p2).length()/tolerance\_divisor;}
\DoxyCodeLine{00802\ \ \ \textcolor{keyword}{const}\ PN\_stdfloat\ t\_tolerance\ =\ (t1+t2)/tolerance\_divisor;}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_spam())\ \{}
\DoxyCodeLine{00805\ \ \ \ \ parametrics\_cat.spam()}
\DoxyCodeLine{00806\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}target\_length\ "{}}\ <<\ target\_length\ <<\ \textcolor{stringliteral}{"{}\ t1\ "{}}\ <<\ t1\ <<\ \textcolor{stringliteral}{"{}\ t2\ "{}}\ <<\ t2\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00807\ \ \ \}}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00809\ \ \ \textcolor{comment}{//\ first,\ check\ to\ make\ sure\ this\ segment\ contains\ the\ point\ we're\ looking}}
\DoxyCodeLine{00810\ \ \ \textcolor{comment}{//\ for}}
\DoxyCodeLine{00811\ \ \ \textcolor{keywordflow}{if}\ (target\_length\ >\ (p1\ -\/\ p2).length())\ \{}
\DoxyCodeLine{00812\ \ \ \ \ \textcolor{comment}{//\ segment\ is\ too\ short}}
\DoxyCodeLine{00813\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00814\ \ \ \}}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ PN\_stdfloat\ tleft\ =\ t1;}
\DoxyCodeLine{00817\ \ \ PN\_stdfloat\ tright\ =\ t2;}
\DoxyCodeLine{00818\ \ \ PN\_stdfloat\ tmid;}
\DoxyCodeLine{00819\ \ \ LPoint3\ pmid;}
\DoxyCodeLine{00820\ \ \ PN\_stdfloat\ len;}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ \textcolor{keywordflow}{while}\ (1)\ \{}
\DoxyCodeLine{00823\ \ \ \ \ tmid\ =\ (tleft\ +\ tright)\ *\ 0.5f;}
\DoxyCodeLine{00824\ \ \ \ \ get\_point(tmid,\ pmid);}
\DoxyCodeLine{00825\ \ \ \ \ len\ =\ (pmid\ -\/\ p1).length();}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00827\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00828\ \textcolor{comment}{\ \ \ \ if\ (parametrics\_cat.is\_spam())\ \{}}
\DoxyCodeLine{00829\ \textcolor{comment}{\ \ \ \ \ \ parametrics\_cat.spam()}}
\DoxyCodeLine{00830\ \textcolor{comment}{\ \ \ \ \ \ \ \ <<\ "{}tleft\ "{}\ <<\ tleft\ <<\ "{}\ tright\ "{}\ <<\ tright\ <<}}
\DoxyCodeLine{00831\ \textcolor{comment}{\ \ \ \ \ \ \ \ "{}\ tmid\ "{}\ <<\ tmid\ <<\ "{}\ len\ "{}\ <<\ len\ <<\ endl;}}
\DoxyCodeLine{00832\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00833\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00834\ }
\DoxyCodeLine{00835\ \ \ \ \ \textcolor{comment}{//\ is\ our\ midpoint\ at\ the\ right\ distance?}}
\DoxyCodeLine{00836\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(len\ -\/\ target\_length)\ <\ length\_tolerance)\ \{}
\DoxyCodeLine{00837\ \ \ \ \ \ \ found\_t\ =\ tmid;}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00839\ \ \ \ \ \}}
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00841\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00842\ \textcolor{comment}{\ \ \ \ if\ (parametrics\_cat.is\_spam())\ \{}}
\DoxyCodeLine{00843\ \textcolor{comment}{\ \ \ \ \ \ parametrics\_cat.spam()}}
\DoxyCodeLine{00844\ \textcolor{comment}{\ \ \ \ \ \ \ \ <<\ "{}tright-\/tleft\ "{}\ <<\ tright-\/tleft\ <<\ "{}\ t\_tolerance\ "{}\ <<\ t\_tolerance\ <<\ endl;}}
\DoxyCodeLine{00845\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00846\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \ \ \ \ \textcolor{comment}{//\ are\ we\ out\ of\ parametric\ precision?}}
\DoxyCodeLine{00849\ \ \ \ \ \textcolor{keywordflow}{if}\ ((tright\ -\/\ tleft)\ <\ t\_tolerance)\ \{}
\DoxyCodeLine{00850\ \ \ \ \ \ \ \textcolor{comment}{//\ unfortunately,\ we\ can't\ get\ any\ closer\ in\ parametric\ space}}
\DoxyCodeLine{00851\ \ \ \ \ \ \ found\_t\ =\ tmid;}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00853\ \ \ \ \ \}}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \ \ \textcolor{comment}{//\ should\ we\ look\ closer\ or\ farther?}}
\DoxyCodeLine{00856\ \ \ \ \ \textcolor{keywordflow}{if}\ (len\ >\ target\_length)\ \{}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \textcolor{comment}{//\ look\ closer}}
\DoxyCodeLine{00858\ \ \ \ \ \ \ tright\ =\ tmid;}
\DoxyCodeLine{00859\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \textcolor{comment}{//\ look\ farther}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ tleft\ =\ tmid;}
\DoxyCodeLine{00862\ \ \ \ \ \}}
\DoxyCodeLine{00863\ \ \ \}}
\DoxyCodeLine{00864\ \}}
\DoxyCodeLine{00865\ }
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00871\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_ad9e07d824908e0ed361c8db20fbe54ce}{ParametricCurve::}}}
\DoxyCodeLine{00872\ \mbox{\hyperlink{classParametricCurve_ad9e07d824908e0ed361c8db20fbe54ce}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{00873\ \ \ \mbox{\hyperlink{classPandaNode_ae9b3055297ade9bbf4a3b4dfc77e4506}{PandaNode::write\_datagram}}(manager,\ me);}
\DoxyCodeLine{00874\ }
\DoxyCodeLine{00875\ \ \ me.add\_int8(\_curve\_type);}
\DoxyCodeLine{00876\ \ \ me.add\_int8(\_num\_dimensions);}
\DoxyCodeLine{00877\ \}}
\DoxyCodeLine{00878\ }
\DoxyCodeLine{00884\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classParametricCurve_aa51af67f91e4da4d0a9ba3b4a86eddad}{ParametricCurve::}}}
\DoxyCodeLine{00885\ \mbox{\hyperlink{classParametricCurve_aa51af67f91e4da4d0a9ba3b4a86eddad}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00886\ \ \ \mbox{\hyperlink{classPandaNode_a924d7f721627231f4504db71809ad2c2}{PandaNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \_curve\_type\ =\ scan.get\_int8();}
\DoxyCodeLine{00889\ \ \ \_num\_dimensions\ =\ scan.get\_int8();}
\DoxyCodeLine{00890\ \}}

\end{DoxyCode}
