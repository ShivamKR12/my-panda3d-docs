\doxysection{win\+Stats\+Flame\+Graph.\+cxx}
\hypertarget{winStatsFlameGraph_8cxx_source}{}\label{winStatsFlameGraph_8cxx_source}\index{pandatool/src/win-\/stats/winStatsFlameGraph.cxx@{pandatool/src/win-\/stats/winStatsFlameGraph.cxx}}
\mbox{\hyperlink{winStatsFlameGraph_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsFlameGraph_8h}{winStatsFlameGraph.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsLabel_8h}{winStatsLabel.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsMonitor_8h}{winStatsMonitor.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatCollectorDef_8h}{pStatCollectorDef.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <commctrl.h>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_flame\_graph\_width\ =\ 1085;}
\DoxyCodeLine{00022\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_flame\_graph\_height\ =\ 210;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keywordtype}{bool}\ WinStatsFlameGraph::\_window\_class\_registered\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00025\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ WinStatsFlameGraph::\_window\_class\_name\ =\ \textcolor{stringliteral}{"{}flame"{}};}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ WinStatsFlameGraph::}
\DoxyCodeLine{00031\ WinStatsFlameGraph(\mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}\ *monitor,\ \textcolor{keywordtype}{int}\ thread\_index,}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ :}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classPStatFlameGraph}{PStatFlameGraph}}(monitor,}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ thread\_index,\ collector\_index,\ frame\_number,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ monitor-\/>get\_pixel\_scale()\ *\ default\_flame\_graph\_width\ /\ 4,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ monitor-\/>get\_pixel\_scale()\ *\ default\_flame\_graph\_height\ /\ 4),}
\DoxyCodeLine{00037\ \ \ \mbox{\hyperlink{classWinStatsGraph}{WinStatsGraph}}(monitor)}
\DoxyCodeLine{00038\ \{}
\DoxyCodeLine{00039\ \ \ \_left\_margin\ =\ \_pixel\_scale\ *\ 2;}
\DoxyCodeLine{00040\ \ \ \_right\_margin\ =\ \_pixel\_scale\ *\ 2;}
\DoxyCodeLine{00041\ \ \ \_top\_margin\ =\ \_pixel\_scale\ *\ 6;}
\DoxyCodeLine{00042\ \ \ \_bottom\_margin\ =\ \_pixel\_scale\ *\ 2;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//\ Let's\ show\ the\ units\ on\ the\ guide\ bar\ labels.\ \ There's\ room.}}
\DoxyCodeLine{00045\ \ \ set\_guide\_bar\_units(get\_guide\_bar\_units()\ |\ GBU\_show\_units);}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \_average\_check\_box\ =\ 0;}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ create\_window();}
\DoxyCodeLine{00050\ \ \ force\_redraw();}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00056\ WinStatsFlameGraph::}
\DoxyCodeLine{00057\ \string~WinStatsFlameGraph()\ \{}
\DoxyCodeLine{00058\ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00066\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a87b58ad5eca981b5a018bf0094ac8281}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00067\ \mbox{\hyperlink{classWinStatsFlameGraph_a87b58ad5eca981b5a018bf0094ac8281}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{if}\ (is\_title\_unknown())\ \{}
\DoxyCodeLine{00069\ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{if}\ (!\_pause)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a77f7e839375e14b1c6ecf6106ec16e12}{update}}();}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ std::string\ text\ =\ \mbox{\hyperlink{classPStatGraph_aa9829b73ad4d9ce79092eafcb3202b57}{format\_number}}(get\_horizontal\_scale(),\ get\_guide\_bar\_units(),\ get\_guide\_bar\_unit\_name());}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_net\_value\_text\ !=\ text)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \_net\_value\_text\ =\ text;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ RECT\ rect;}
\DoxyCodeLine{00082\ \ \ \ \ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ rect.bottom\ =\ \_top\_margin;}
\DoxyCodeLine{00084\ \ \ \ \ \ \ InvalidateRect(\_window,\ \&rect,\ TRUE);}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ \ \ \}}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00092\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a7392213c6c2dec18758e2dd067d38313}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00093\ \mbox{\hyperlink{classWinStatsFlameGraph_a7392213c6c2dec18758e2dd067d38313}{force\_redraw}}()\ \{}
\DoxyCodeLine{00094\ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00095\ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00100\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a5e85be43800ccc6b01962daf7ad1e22c}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00101\ \mbox{\hyperlink{classWinStatsFlameGraph_a5e85be43800ccc6b01962daf7ad1e22c}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00102\ \ \ \mbox{\hyperlink{classPStatFlameGraph_a364749482f8eb2540c32ff3ada48bed1}{PStatFlameGraph::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a1fc69432beb927c91e2c420cd1823175}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00111\ \mbox{\hyperlink{classWinStatsFlameGraph_a1fc69432beb927c91e2c420cd1823175}{set\_time\_units}}(\textcolor{keywordtype}{int}\ unit\_mask)\ \{}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{int}\ old\_unit\_mask\ =\ get\_guide\_bar\_units();}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{if}\ ((old\_unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms))\ !=\ 0)\ \{}
\DoxyCodeLine{00114\ \ \ \ \ unit\_mask\ =\ unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms);}
\DoxyCodeLine{00115\ \ \ \ \ unit\_mask\ |=\ (old\_unit\_mask\ \&\ GBU\_show\_units);}
\DoxyCodeLine{00116\ \ \ \ \ set\_guide\_bar\_units(unit\_mask);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ RECT\ rect;}
\DoxyCodeLine{00119\ \ \ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00120\ \ \ \ \ rect.bottom\ =\ \_top\_margin;}
\DoxyCodeLine{00121\ \ \ \ \ InvalidateRect(\_window,\ \&rect,\ TRUE);}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00128\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ada820bab788ad3d5b4efba041c440f1e}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00129\ \mbox{\hyperlink{classWinStatsFlameGraph_ada820bab788ad3d5b4efba041c440f1e}{on\_click\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ !=\ get\_collector\_index())\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ ==\ -\/1)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ clear\_history();}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_ac98aee8b244fde3993a72f9d0413a0b6}{set\_collector\_index}}(-\/1);}
\DoxyCodeLine{00134\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_ace86a909d8d8f4739e677e5f61a035a6}{push\_collector\_index}}(collector\_index);}
\DoxyCodeLine{00136\ \ \ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_title\_unknown())\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ \ \ \}}
\DoxyCodeLine{00145\ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00150\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ac1bf7530c8f9705dbb23617b69a806b7}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00151\ \mbox{\hyperlink{classWinStatsFlameGraph_ac1bf7530c8f9705dbb23617b69a806b7}{on\_enter\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ !=\ \_highlighted\_index)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \_highlighted\_index\ =\ collector\_index;}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordflow}{if}\ (!get\_average\_mode())\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00165\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a44c6ee2fc5901902e3afa9d0467e9c32}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00166\ \mbox{\hyperlink{classWinStatsFlameGraph_a44c6ee2fc5901902e3afa9d0467e9c32}{on\_leave\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ ==\ \_highlighted\_index\ \&\&\ collector\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \_highlighted\_index\ =\ -\/1;}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{if}\ (!get\_average\_mode())\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00172\ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00179\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ae6385c07bd3eedec8b6a0e675549b6fb}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00180\ \mbox{\hyperlink{classWinStatsFlameGraph_ae6385c07bd3eedec8b6a0e675549b6fb}{normal\_guide\_bars}}()\ \{}
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//\ We\ want\ vaguely\ 100\ pixels\ between\ guide\ bars.}}
\DoxyCodeLine{00182\ \ \ \textcolor{keywordtype}{int}\ num\_bars\ =\ get\_xsize()\ /\ (\_pixel\_scale\ *\ 25);}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \_guide\_bars.clear();}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{keywordtype}{double}\ dist\ =\ get\_horizontal\_scale()\ /\ num\_bars;}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ num\_bars;\ ++i)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \_guide\_bars.push\_back(\mbox{\hyperlink{classPStatGraph_a3361dd9894e280326e4831f2d575e19a}{make\_guide\_bar}}(i\ *\ dist));}
\DoxyCodeLine{00190\ \ \ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ RECT\ rect;}
\DoxyCodeLine{00195\ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00196\ \ \ rect.bottom\ =\ \_top\_margin;}
\DoxyCodeLine{00197\ \ \ InvalidateRect(\_window,\ \&rect,\ TRUE);}
\DoxyCodeLine{00198\ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ae8fd5c6a519b9e250f290ed0f5e689ff}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00204\ \mbox{\hyperlink{classWinStatsFlameGraph_ae8fd5c6a519b9e250f290ed0f5e689ff}{clear\_region}}()\ \{}
\DoxyCodeLine{00205\ \ \ RECT\ rect\ =\ \{\ 0,\ 0,\ get\_xsize(),\ get\_ysize()\ \};}
\DoxyCodeLine{00206\ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ (HBRUSH)GetStockObject(WHITE\_BRUSH));}
\DoxyCodeLine{00207\ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00212\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a2ba11e3ec9ce25b1658a48e6f864160c}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00213\ \mbox{\hyperlink{classWinStatsFlameGraph_a2ba11e3ec9ce25b1658a48e6f864160c}{begin\_draw}}()\ \{}
\DoxyCodeLine{00214\ \ \ \mbox{\hyperlink{classWinStatsFlameGraph_ae8fd5c6a519b9e250f290ed0f5e689ff}{clear\_region}}();}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ Draw\ in\ the\ guide\ bars.}}
\DoxyCodeLine{00217\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ draw\_guide\_bar(\_bitmap\_dc,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i));}
\DoxyCodeLine{00220\ \ \ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ SelectObject(\_bitmap\_dc,\ WinStatsGraph::\_monitor-\/>get\_font());}
\DoxyCodeLine{00223\ \ \ SelectObject(\_bitmap\_dc,\ GetStockObject(NULL\_PEN));}
\DoxyCodeLine{00224\ \ \ SetBkMode(\_bitmap\_dc,\ TRANSPARENT);}
\DoxyCodeLine{00225\ \ \ SetTextAlign(\_bitmap\_dc,\ TA\_LEFT\ |\ TA\_TOP\ |\ TA\_NOUPDATECP);}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00232\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a921281c999834fe4fe8f71f2aeb612a8}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00233\ \mbox{\hyperlink{classWinStatsFlameGraph_a921281c999834fe4fe8f71f2aeb612a8}{draw\_bar}}(\textcolor{keywordtype}{int}\ depth,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x,\ \textcolor{keywordtype}{int}\ collector\_index,\ \textcolor{keywordtype}{int}\ parent\_index)\ \{}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ get\_ysize()\ -\/\ 1\ -\/\ depth\ *\ \_pixel\_scale\ *\ 5;}
\DoxyCodeLine{00235\ \ \ \textcolor{keywordtype}{int}\ top\ =\ bottom\ -\/\ \_pixel\_scale\ *\ 5;}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ collector\_index\ ==\ \_highlighted\_index;}
\DoxyCodeLine{00238\ \ \ HBRUSH\ brush\ =\ \mbox{\hyperlink{classWinStatsGraph_a6c23dc88d8af5cc9e790ff31a8f74f09}{get\_collector\_brush}}(collector\_index,\ is\_highlighted);}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ 2)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{comment}{//\ It's\ just\ a\ tiny\ sliver.\ \ This\ is\ a\ more\ reliable\ way\ to\ draw\ it.}}
\DoxyCodeLine{00242\ \ \ \ \ RECT\ rect\ =\ \{from\_x,\ top\ +\ 1,\ from\_x\ +\ 1,\ bottom\ -\/\ 1\};}
\DoxyCodeLine{00243\ \ \ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ brush);}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00246\ \ \ \ \ SelectObject(\_bitmap\_dc,\ brush);}
\DoxyCodeLine{00247\ \ \ \ \ RoundRect(\_bitmap\_dc,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::max(from\_x,\ -\/\_pixel\_scale\ -\/\ 1),}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top,}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::min(std::max(to\_x,\ from\_x\ +\ 1),\ get\_xsize()\ +\ \_pixel\_scale),}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom,}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_pixel\_scale,}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_pixel\_scale);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordtype}{int}\ left\ =\ std::max(from\_x,\ 0)\ +\ \_pixel\_scale\ /\ 2;}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordtype}{int}\ right\ =\ std::min(to\_x,\ get\_xsize())\ -\/\ \_pixel\_scale\ /\ 2;}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{if}\ ((to\_x\ -\/\ from\_x)\ >=\ \_pixel\_scale\ *\ 4)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ bother\ drawing\ the\ text\ if\ we've\ got\ some\ space\ to\ draw\ on.}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \textcolor{comment}{//\ Choose\ a\ suitable\ foreground\ color.}}
\DoxyCodeLine{00261\ \ \ \ \ \ \ SetTextColor(\_bitmap\_dc,\ \mbox{\hyperlink{classWinStatsGraph_a63439518bdc72a5d963e0eb8f7449b5c}{get\_collector\_text\_color}}(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =\ WinStatsGraph::\_monitor-\/>get\_client\_data();}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&def\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(collector\_index);}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ SIZE\ size;}
\DoxyCodeLine{00267\ \ \ \ \ \ \ GetTextExtentPoint32(\_bitmap\_dc,\ def.\_name.data(),\ def.\_name.size(),\ \&size);}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size.cx\ <\ right\ -\/\ left)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ room\ for\ more.\ \ Show\ the\ collector's\ actual\ parent,\ if\ it's}}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ different\ than\ the\ block\ it's\ shown\ above.}}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (def.\_parent\_index\ >\ 0\ \&\&\ def.\_parent\_index\ !=\ parent\_index)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&parent\_def\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(def.\_parent\_index);}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ std::string\ long\_name\ =\ parent\_def.\_name\ +\ \textcolor{stringliteral}{"{}:"{}}\ +\ def.\_name;}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ SIZE\ long\_size;}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ GetTextExtentPoint32(\_bitmap\_dc,\ long\_name.data(),\ long\_name.size(),\ \&long\_size);}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (long\_size.cx\ <\ right\ -\/\ left)\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ TextOut(\_bitmap\_dc,\ left,\ top\ +\ (bottom\ -\/\ top\ -\/\ long\_size.cy)\ /\ 2,}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ long\_name.data(),\ long\_name.length());}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ TextOut(\_bitmap\_dc,\ left,\ top\ +\ (bottom\ -\/\ top\ -\/\ size.cy)\ /\ 2,}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ def.\_name.data(),\ def.\_name.length());}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Let\ Windows\ figure\ out\ how\ to\ fit\ it,\ with\ ellipsis\ if\ necessary.}}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ RECT\ rect\ =\ \{left,\ top,\ right,\ bottom\};}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ DrawText(\_bitmap\_dc,\ def.\_name.data(),\ def.\_name.size(),}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&rect,\ DT\_LEFT\ |\ DT\_END\_ELLIPSIS\ |\ DT\_SINGLELINE\ |\ DT\_VCENTER);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \}}
\DoxyCodeLine{00294\ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00300\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ac8c8f7584fcff269b5cce4eee8c87cc4}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00301\ \mbox{\hyperlink{classWinStatsFlameGraph_ac8c8f7584fcff269b5cce4eee8c87cc4}{end\_draw}}()\ \{}
\DoxyCodeLine{00302\ \ \ InvalidateRect(\_graph\_window,\ \textcolor{keyword}{nullptr},\ FALSE);}
\DoxyCodeLine{00303\ \}}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00308\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a7f70104867c1bf7fbe37b0b989c6964a}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00309\ \mbox{\hyperlink{classWinStatsFlameGraph_a7f70104867c1bf7fbe37b0b989c6964a}{idle}}()\ \{}
\DoxyCodeLine{00310\ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00316\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsFlameGraph_ae36dadcec1a067d94297670340dab055}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00317\ \mbox{\hyperlink{classWinStatsFlameGraph_ae36dadcec1a067d94297670340dab055}{animate}}(\textcolor{keywordtype}{double}\ time,\ \textcolor{keywordtype}{double}\ dt)\ \{}
\DoxyCodeLine{00318\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatFlameGraph_a2ff3545c8f2e4d398898e314b813cfeb}{PStatFlameGraph::animate}}(time,\ dt);}
\DoxyCodeLine{00319\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00324\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsFlameGraph_a7d6cedb8cb216806693f800785a64e93}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00325\ \mbox{\hyperlink{classWinStatsFlameGraph_a7d6cedb8cb216806693f800785a64e93}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00327\ \ \ \mbox{\hyperlink{classWinStatsGraph_a09816c5e652ee201e9e4d82b442fffdf}{WinStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00328\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00329\ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00334\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a7486fea7e4e6f66d9e80ad3d494aa3e7}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00335\ \mbox{\hyperlink{classWinStatsFlameGraph_a7486fea7e4e6f66d9e80ad3d494aa3e7}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00337\ \ \ \mbox{\hyperlink{classWinStatsGraph_ac5e136b133729a00045771eb9a1085fe}{WinStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \textcolor{comment}{//\ Set\ the\ state\ of\ the\ checkbox.}}
\DoxyCodeLine{00340\ \ \ SendMessage(\_average\_check\_box,\ BM\_SETCHECK,\ get\_average\_mode()\ ?\ BST\_CHECKED\ :\ BST\_UNCHECKED,\ 0);}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00346\ LONG\ WinStatsFlameGraph::}
\DoxyCodeLine{00347\ window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{switch}\ (msg)\ \{}
\DoxyCodeLine{00349\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONDOWN:}
\DoxyCodeLine{00350\ \ \ \ \ SetFocus(\_window);}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_new\_guide\_bar)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_new\_guide\_bar);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ SetCapture(\_graph\_window);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00355\ \ \ \ \ \}}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \textcolor{keywordflow}{case}\ WM\_COMMAND:}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{switch}\ (LOWORD(wparam))\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{case}\ BN\_CLICKED:}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((HWND)lparam\ ==\ \_average\_check\_box)\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ result\ =\ SendMessage(\_average\_check\_box,\ BM\_GETCHECK,\ 0,\ 0);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ BST\_CHECKED)\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ set\_average\_mode(\textcolor{keyword}{true});}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ set\_average\_mode(\textcolor{keyword}{false});}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{case}\ 101:}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsFlameGraph_ada820bab788ad3d5b4efba041c440f1e}{on\_click\_label}}(\_popup\_index);}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordflow}{case}\ 102:}
\DoxyCodeLine{00378\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a2310299c3cc181f2d4f75210c6406747}{open\_strip\_chart}}(get\_thread\_index(),\ \_popup\_index,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{case}\ 103:}
\DoxyCodeLine{00382\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a19a5f72039f430ce2b33a559c183f5b0}{open\_flame\_graph}}(get\_thread\_index(),\ \_popup\_index);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{keywordflow}{case}\ 104:}
\DoxyCodeLine{00386\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_aa0bc0a0c7e4117e72da204b54debe60f}{choose\_collector\_color}}(\_popup\_index);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordflow}{case}\ 105:}
\DoxyCodeLine{00390\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a7d1d9acd32503d2aebd77c86c5ad42b5}{reset\_collector\_color}}(\_popup\_index);}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00392\ \ \ \ \ \}}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{case}\ WM\_KEYDOWN:}
\DoxyCodeLine{00396\ \ \ \ \ \{}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (wparam)\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_LEFT:}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ changed\ =\ \mbox{\hyperlink{classPStatFlameGraph_a89a7050be707c11f0fa13a99cde54078}{prev\_frame}}();}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_RIGHT:}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ changed\ =\ \mbox{\hyperlink{classPStatFlameGraph_a703752831f4e2bbbceaa2f8c49914246}{next\_frame}}();}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_HOME:}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ changed\ =\ \mbox{\hyperlink{classPStatFlameGraph_a4e896ba8eb93b8898a817c5d4713ed55}{first\_frame}}();}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_END:}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ changed\ =\ \mbox{\hyperlink{classPStatFlameGraph_a2cf97631a0fd8c7c53784551bbaa5600}{last\_frame}}();}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (changed)\ \{}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \ \ \}}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \textcolor{keywordflow}{case}\ WM\_SYSKEYDOWN:}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{if}\ (((lparam\ >>\ 16)\ \&\ KF\_ALTDOWN)\ !=\ 0\ \&\&\ wparam\ ==\ VK\_LEFT)\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatFlameGraph_a6b1401e2d1fe32841f8ed5fed3a92316}{pop\_collector\_index}}())\ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00427\ \ \ \ \ \}}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{keywordflow}{case}\ WM\_APPCOMMAND:}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordflow}{if}\ (GET\_APPCOMMAND\_LPARAM(lparam)\ ==\ APPCOMMAND\_BROWSER\_BACKWARD)\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatFlameGraph_a6b1401e2d1fe32841f8ed5fed3a92316}{pop\_collector\_index}}())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00437\ \ \ \ \ \}}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00441\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00442\ \ \ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classWinStatsGraph_a9c3aa3051d400418232bea75f31872b5}{WinStatsGraph::window\_proc}}(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00445\ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00450\ LONG\ WinStatsFlameGraph::}
\DoxyCodeLine{00451\ graph\_window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00452\ \ \ \textcolor{keywordflow}{switch}\ (msg)\ \{}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONDOWN:}
\DoxyCodeLine{00454\ \ \ \ \ SetFocus(\_window);}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_guide\_bar\ \&\&\ \_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_guide\_bar);}
\DoxyCodeLine{00457\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \_drag\_start\_x\ =\ x;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ SetCapture(\_graph\_window);}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00461\ \ \ \ \ \}}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSEMOVE:}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\ =\ HIWORD(lparam);}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ \mbox{\hyperlink{classPStatFlameGraph_a903a32048dcb3a084d42e1b583e894df}{get\_bar\_collector}}(pixel\_to\_depth(y),\ x);}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsFlameGraph_ac1bf7530c8f9705dbb23617b69a806b7}{on\_enter\_label}}(collector\_index);}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ want\ to\ get\ a\ WM\_MOUSELEAVE\ when\ the\ mouse\ leaves\ the\ graph}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \textcolor{comment}{//\ window.}}
\DoxyCodeLine{00475\ \ \ \ \ \ \ TRACKMOUSEEVENT\ tme\ =\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(TRACKMOUSEEVENT),}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ TME\_LEAVE,}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \_graph\_window,}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ 0}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00481\ \ \ \ \ \ \ TrackMouseEvent(\&tme);}
\DoxyCodeLine{00482\ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_new\_guide\_bar)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ haven't\ created\ the\ new\ guide\ bar\ yet;\ we\ won't\ until\ the\ mouse}}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \textcolor{comment}{//\ comes\ within\ the\ graph's\ region.}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_guide\_bar);}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ \mbox{\hyperlink{classPStatGraph_a3a7fc8b8eb05e7ff7a6f044ebee7035a}{add\_user\_guide\_bar}}(pixel\_to\_height(x));}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00492\ \ \ \ \ \}}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00494\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a45ecee227793ee5f2059e58f8d844ad8}{move\_user\_guide\_bar}}(\_drag\_guide\_bar,\ pixel\_to\_height(x));}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00497\ \ \ \ \ \}}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSELEAVE:}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ leaves\ the\ graph,\ stop\ highlighting.}}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsFlameGraph_a44c6ee2fc5901902e3afa9d0467e9c32}{on\_leave\_label}}(\_highlighted\_index);}
\DoxyCodeLine{00504\ \ \ \ \ \}}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONUP:}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ <\ 0\ ||\ x\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a7627d5e29b88196713f4ba3cea78ea17}{remove\_user\_guide\_bar}}(\_drag\_guide\_bar);}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a45ecee227793ee5f2059e58f8d844ad8}{move\_user\_guide\_bar}}(\_drag\_guide\_bar,\ pixel\_to\_height(x));}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ ReleaseCapture();}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00518\ \ \ \ \ \}}
\DoxyCodeLine{00519\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONDBLCLK:}
\DoxyCodeLine{00522\ \ \ \ \ \{}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ will\ zoom\ the\ graph\ into}}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ collector.}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00526\ \ \ \ \ \ \ int16\_t\ y\ =\ HIWORD(lparam);}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsFlameGraph_ada820bab788ad3d5b4efba041c440f1e}{on\_click\_label}}(\mbox{\hyperlink{classPStatFlameGraph_a903a32048dcb3a084d42e1b583e894df}{get\_bar\_collector}}(pixel\_to\_depth(y),\ x));}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00529\ \ \ \ \ \}}
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{case}\ WM\_CONTEXTMENU:}
\DoxyCodeLine{00533\ \ \ \ \ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ POINT\ point;}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetCursorPos(\&point))\ \{}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ POINT\ graph\_point\ =\ \ point;}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ScreenToClient(\_graph\_window,\ \&graph\_point))\ \{}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ depth\ =\ pixel\_to\_depth(graph\_point.y);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ \mbox{\hyperlink{classPStatFlameGraph_a903a32048dcb3a084d42e1b583e894df}{get\_bar\_collector}}(depth,\ graph\_point.x);}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \_popup\_index\ =\ collector\_index;}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ HMENU\ popup\ =\ CreatePopupMenu();}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ label\ =\ \mbox{\hyperlink{classPStatFlameGraph_a44bf41cc64eb10cdc5b146fe158fd3d0}{get\_bar\_tooltip}}(depth,\ graph\_point.x);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING\ |\ MF\_DISABLED,\ 0,\ label.c\_str());}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ ==\ get\_collector\_index())\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING\ |\ MF\_DISABLED,\ 101,\ \textcolor{stringliteral}{"{}Set\ as\ Focus"{}});}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 101,\ \textcolor{stringliteral}{"{}Set\ as\ Focus"{}});}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 102,\ \textcolor{stringliteral}{"{}Open\ Strip\ Chart"{}});}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 103,\ \textcolor{stringliteral}{"{}Open\ Flame\ Graph"{}});}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING\ |\ MF\_SEPARATOR,\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 104,\ \textcolor{stringliteral}{"{}Change\ Color..."{}});}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 105,\ \textcolor{stringliteral}{"{}Reset\ Color"{}});}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ TrackPopupMenu(popup,\ TPM\_LEFTBUTTON,\ point.x,\ point.y,\ 0,\ \_window,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00563\ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSEHWHEEL:}
\DoxyCodeLine{00567\ \ \ \ \ \{}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ GET\_WHEEL\_DELTA\_WPARAM(wparam);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ !=\ 0)\ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ >\ 0\ ?\ \mbox{\hyperlink{classPStatFlameGraph_a703752831f4e2bbbceaa2f8c49914246}{next\_frame}}()\ :\ \mbox{\hyperlink{classPStatFlameGraph_a89a7050be707c11f0fa13a99cde54078}{prev\_frame}}())\ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ SetWindowText(\_window,\ window\_title.c\_str());}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00576\ \ \ \ \ \}}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00581\ \ \ \}}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{return}\ WinStatsGraph::graph\_window\_proc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00584\ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00591\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a61989da4f26a35b522d5c93da86cc1e6}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00592\ \mbox{\hyperlink{classWinStatsFlameGraph_a61989da4f26a35b522d5c93da86cc1e6}{additional\_window\_paint}}(HDC\ hdc)\ \{}
\DoxyCodeLine{00593\ \ \ \textcolor{comment}{//\ Draw\ in\ the\ labels\ for\ the\ guide\ bars.}}
\DoxyCodeLine{00594\ \ \ SelectObject(hdc,\ WinStatsGraph::\_monitor-\/>get\_font());}
\DoxyCodeLine{00595\ \ \ SetTextAlign(hdc,\ TA\_LEFT\ |\ TA\_BOTTOM);}
\DoxyCodeLine{00596\ \ \ SetBkMode(hdc,\ TRANSPARENT);}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ \textcolor{keywordtype}{int}\ y\ =\ \_top\_margin\ -\/\ \_pixel\_scale\ /\ 2;}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00601\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00602\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00603\ \ \ \ \ draw\_guide\_label(hdc,\ y,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i));}
\DoxyCodeLine{00604\ \ \ \}}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a2817d0202ae60465812dfff807245561}{get\_num\_user\_guide\_bars}}();}
\DoxyCodeLine{00607\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00608\ \ \ \ \ draw\_guide\_label(hdc,\ y,\ \mbox{\hyperlink{classPStatGraph_a065acd03e0e9d4da1b575fe8feb77909}{get\_user\_guide\_bar}}(i));}
\DoxyCodeLine{00609\ \ \ \}}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ RECT\ rect;}
\DoxyCodeLine{00612\ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \textcolor{comment}{//\ Now\ draw\ the\ "{}net\ value"{}\ label\ at\ the\ top.}}
\DoxyCodeLine{00615\ \ \ SetTextAlign(hdc,\ TA\_RIGHT\ |\ TA\_BOTTOM);}
\DoxyCodeLine{00616\ \ \ SetTextColor(hdc,\ RGB(0,\ 0,\ 0));}
\DoxyCodeLine{00617\ \ \ TextOut(hdc,\ rect.right\ -\/\ \_right\_margin,\ y,}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \ \ \ \ \_net\_value\_text.data(),\ \_net\_value\_text.length());}
\DoxyCodeLine{00619\ \}}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00626\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_ab47309a843541bd82a3d9801efa1f1a4}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00627\ \mbox{\hyperlink{classWinStatsFlameGraph_ab47309a843541bd82a3d9801efa1f1a4}{additional\_graph\_window\_paint}}(HDC\ hdc)\ \{}
\DoxyCodeLine{00628\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a2817d0202ae60465812dfff807245561}{get\_num\_user\_guide\_bars}}();}
\DoxyCodeLine{00629\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00630\ \ \ \ \ draw\_guide\_bar(hdc,\ \mbox{\hyperlink{classPStatGraph_a065acd03e0e9d4da1b575fe8feb77909}{get\_user\_guide\_bar}}(i));}
\DoxyCodeLine{00631\ \ \ \}}
\DoxyCodeLine{00632\ \}}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00638\ std::string\ \mbox{\hyperlink{classWinStatsFlameGraph_ad6ae446419dd7ae152907efc750aefb9}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00639\ \mbox{\hyperlink{classWinStatsFlameGraph_ad6ae446419dd7ae152907efc750aefb9}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00640\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatFlameGraph_a44bf41cc64eb10cdc5b146fe158fd3d0}{get\_bar\_tooltip}}(pixel\_to\_depth(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00641\ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00648\ WinStatsGraph::DragMode\ \mbox{\hyperlink{classWinStatsFlameGraph_a1a7665330d005f6d572e2ea46110d9c5}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00649\ \mbox{\hyperlink{classWinStatsFlameGraph_a1a7665330d005f6d572e2ea46110d9c5}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{if}\ (mouse\_y\ >=\ \_graph\_top\ \&\&\ mouse\_y\ <\ \_graph\_top\ +\ get\_ysize())\ \{}
\DoxyCodeLine{00651\ \ \ \ \ \textcolor{keywordflow}{if}\ (mouse\_x\ >=\ \_graph\_left\ \&\&\ mouse\_x\ <\ \_graph\_left\ +\ get\_xsize())\ \{}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \textcolor{comment}{//\ See\ if\ the\ mouse\ is\ over\ a\ user-\/defined\ guide\ bar.}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ mouse\_x\ -\/\ \_graph\_left;}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ 2);}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ 2);}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ \mbox{\hyperlink{classPStatGraph_a27bac34846a7622cab2d7aa247fc570e}{find\_user\_guide\_bar}}(from\_height,\ to\_height);}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_guide\_bar;}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (mouse\_x\ <\ \_left\_margin\ -\/\ 2\ ||}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mouse\_x\ >\ width\ -\/\ \_right\_margin\ +\ 2)\ \{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ mouse\ is\ left\ or\ right\ of\ the\ graph;\ maybe\ create\ a\ new\ guide}}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \textcolor{comment}{//\ bar.}}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_new\_guide\_bar;}
\DoxyCodeLine{00666\ \ \ \ \ \}}
\DoxyCodeLine{00667\ \ \ \}}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \textcolor{comment}{//\ Don't\ upcall;\ there's\ no\ point\ resizing\ the\ margins.}}
\DoxyCodeLine{00670\ \ \ \textcolor{keywordflow}{return}\ DM\_none;}
\DoxyCodeLine{00671\ \}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00677\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsFlameGraph_a9a31a513b450c09be8be99008f8a743f}{WinStatsFlameGraph::}}}
\DoxyCodeLine{00678\ \mbox{\hyperlink{classWinStatsFlameGraph_a9a31a513b450c09be8be99008f8a743f}{move\_graph\_window}}(\textcolor{keywordtype}{int}\ graph\_left,\ \textcolor{keywordtype}{int}\ graph\_top,\ \textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00679\ \ \ \mbox{\hyperlink{classWinStatsGraph_a4afd9c0b5f7e8e40e754b51db3e9c4d1}{WinStatsGraph::move\_graph\_window}}(graph\_left,\ graph\_top,\ graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00680\ \ \ \textcolor{keywordflow}{if}\ (\_average\_check\_box\ !=\ 0)\ \{}
\DoxyCodeLine{00681\ \ \ \ \ SIZE\ size;}
\DoxyCodeLine{00682\ \ \ \ \ SendMessage(\_average\_check\_box,\ BCM\_GETIDEALSIZE,\ 0,\ (LPARAM)\&size);}
\DoxyCodeLine{00683\ }
\DoxyCodeLine{00684\ \ \ \ \ SetWindowPos(\_average\_check\_box,\ 0,}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_left\_margin,\ \_top\_margin\ -\/\ size.cy\ -\/\ \_pixel\_scale\ /\ 2,}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size.cx,\ size.cy,}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SWP\_NOZORDER\ |\ SWP\_SHOWWINDOW);}
\DoxyCodeLine{00688\ \ \ \ \ InvalidateRect(\_average\_check\_box,\ \textcolor{keyword}{nullptr},\ TRUE);}
\DoxyCodeLine{00689\ \ \ \}}
\DoxyCodeLine{00690\ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00695\ \textcolor{keywordtype}{int}\ WinStatsFlameGraph::}
\DoxyCodeLine{00696\ pixel\_to\_depth(\textcolor{keywordtype}{int}\ y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00697\ \ \ \textcolor{keywordflow}{return}\ (get\_ysize()\ -\/\ 1\ -\/\ y)\ /\ (\_pixel\_scale\ *\ 5);}
\DoxyCodeLine{00698\ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00703\ \textcolor{keywordtype}{void}\ WinStatsFlameGraph::}
\DoxyCodeLine{00704\ draw\_guide\_bar(HDC\ hdc,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00705\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \ \ \textcolor{keywordflow}{if}\ (x\ >\ 0\ \&\&\ x\ <\ get\_xsize()\ -\/\ 1)\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{comment}{//\ Only\ draw\ it\ if\ it's\ not\ too\ close\ to\ either\ edge.}}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keywordflow}{switch}\ (bar.\_style)\ \{}
\DoxyCodeLine{00710\ \ \ \ \ \textcolor{keywordflow}{case}\ GBS\_target:}
\DoxyCodeLine{00711\ \ \ \ \ \ \ SelectObject(hdc,\ \_light\_pen);}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{keywordflow}{case}\ GBS\_user:}
\DoxyCodeLine{00715\ \ \ \ \ \ \ SelectObject(hdc,\ \_user\_guide\_bar\_pen);}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keywordflow}{case}\ GBS\_normal:}
\DoxyCodeLine{00719\ \ \ \ \ \ \ SelectObject(hdc,\ \_dark\_pen);}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00721\ \ \ \ \ \}}
\DoxyCodeLine{00722\ \ \ \ \ MoveToEx(hdc,\ x,\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00723\ \ \ \ \ LineTo(hdc,\ x,\ get\_ysize());}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ \}}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00730\ \textcolor{keywordtype}{void}\ WinStatsFlameGraph::}
\DoxyCodeLine{00731\ draw\_guide\_label(HDC\ hdc,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00732\ \ \ \textcolor{keywordflow}{switch}\ (bar.\_style)\ \{}
\DoxyCodeLine{00733\ \ \ \textcolor{keywordflow}{case}\ GBS\_target:}
\DoxyCodeLine{00734\ \ \ \ \ SetTextColor(hdc,\ \_light\_color);}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \textcolor{keywordflow}{case}\ GBS\_user:}
\DoxyCodeLine{00738\ \ \ \ \ SetTextColor(hdc,\ \_user\_guide\_bar\_color);}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \textcolor{keywordflow}{case}\ GBS\_normal:}
\DoxyCodeLine{00742\ \ \ \ \ SetTextColor(hdc,\ \_dark\_color);}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00744\ \ \ \}}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00747\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00748\ \ \ SIZE\ size;}
\DoxyCodeLine{00749\ \ \ GetTextExtentPoint32(hdc,\ label.data(),\ label.length(),\ \&size);}
\DoxyCodeLine{00750\ }
\DoxyCodeLine{00751\ \ \ \textcolor{keywordflow}{if}\ (bar.\_style\ !=\ GBS\_user)\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ size.cx);}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ size.cx);}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatGraph_a27bac34846a7622cab2d7aa247fc570e}{find\_user\_guide\_bar}}(from\_height,\ to\_height)\ >=\ 0)\ \{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \textcolor{comment}{//\ Omit\ the\ label:\ there's\ a\ user-\/defined\ guide\ bar\ in\ the\ same\ space.}}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00757\ \ \ \ \ \}}
\DoxyCodeLine{00758\ \ \ \}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \textcolor{keywordtype}{int}\ this\_x\ =\ \_graph\_left\ +\ x\ -\/\ size.cx\ /\ 2;}
\DoxyCodeLine{00761\ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00762\ \ \ \ \ TextOut(hdc,\ this\_x,\ y,}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ label.data(),\ label.length());}
\DoxyCodeLine{00764\ \ \ \}}
\DoxyCodeLine{00765\ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00770\ \textcolor{keywordtype}{void}\ WinStatsFlameGraph::}
\DoxyCodeLine{00771\ create\_window()\ \{}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{if}\ (\_window)\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00774\ \ \ \}}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ HINSTANCE\ application\ =\ GetModuleHandle(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00777\ \ \ register\_window\_class(application);}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ std::string\ window\_title\ =\ \mbox{\hyperlink{classPStatFlameGraph_a23b00d3f89d8a69449937c8f2f87a8e6}{get\_title\_text}}();}
\DoxyCodeLine{00780\ \ \ POINT\ window\_pos\ =\ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a2f0a1a79cadac41d2e0d9722c80ca0dd}{get\_new\_window\_pos}}();}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ RECT\ win\_rect\ =\ \{}
\DoxyCodeLine{00783\ \ \ \ \ 0,\ 0,}
\DoxyCodeLine{00784\ \ \ \ \ \_left\_margin\ +\ get\_xsize()\ +\ \_right\_margin,}
\DoxyCodeLine{00785\ \ \ \ \ \_top\_margin\ +\ get\_ysize()\ +\ \_bottom\_margin}
\DoxyCodeLine{00786\ \ \ \};}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \textcolor{comment}{//\ compute\ window\ size\ based\ on\ desired\ client\ area\ size}}
\DoxyCodeLine{00789\ \ \ AdjustWindowRect(\&win\_rect,\ graph\_window\_style,\ FALSE);}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \_window\ =}
\DoxyCodeLine{00792\ \ \ \ \ CreateWindowEx(WS\_EX\_DLGMODALFRAME,\ \_window\_class\_name,}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ window\_title.c\_str(),\ graph\_window\_style,}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ window\_pos.x,\ window\_pos.y,}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ win\_rect.right\ -\/\ win\_rect.left,}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ win\_rect.bottom\ -\/\ win\_rect.top,}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>get\_window(),}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ application,\ 0);}
\DoxyCodeLine{00799\ \ \ \textcolor{keywordflow}{if}\ (!\_window)\ \{}
\DoxyCodeLine{00800\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ create\ FlameGraph\ window!\(\backslash\)n"{}};}
\DoxyCodeLine{00801\ \ \ \ \ exit(1);}
\DoxyCodeLine{00802\ \ \ \}}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ SetWindowLongPtr(\_window,\ 0,\ (LONG\_PTR)\textcolor{keyword}{this});}
\DoxyCodeLine{00805\ }
\DoxyCodeLine{00806\ \ \ \_average\_check\_box\ =}
\DoxyCodeLine{00807\ \ \ \ \ CreateWindow(WC\_BUTTON,\ \textcolor{stringliteral}{"{}Average"{}},\ WS\_CHILD\ |\ BS\_AUTOCHECKBOX,}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_window,\ \textcolor{keyword}{nullptr},\ application,\ 0);}
\DoxyCodeLine{00810\ \ \ SendMessage(\_average\_check\_box,\ WM\_SETFONT,}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (WPARAM)WinStatsGraph::\_monitor-\/>get\_font(),\ TRUE);}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \textcolor{keywordflow}{if}\ (get\_average\_mode())\ \{}
\DoxyCodeLine{00814\ \ \ \ \ SendMessage(\_average\_check\_box,\ BM\_SETCHECK,\ BST\_CHECKED,\ 0);}
\DoxyCodeLine{00815\ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00816\ \ \ \}}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \ \ \textcolor{comment}{//\ Ensure\ that\ the\ window\ is\ on\ top\ of\ the\ stack.}}
\DoxyCodeLine{00819\ \ \ SetWindowPos(\_window,\ HWND\_TOP,\ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SWP\_NOMOVE\ |\ SWP\_NOSIZE\ |\ SWP\_SHOWWINDOW);}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ SetFocus(\_window);}
\DoxyCodeLine{00823\ \}}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00829\ \textcolor{keywordtype}{void}\ WinStatsFlameGraph::}
\DoxyCodeLine{00830\ register\_window\_class(HINSTANCE\ application)\ \{}
\DoxyCodeLine{00831\ \ \ \textcolor{keywordflow}{if}\ (\_window\_class\_registered)\ \{}
\DoxyCodeLine{00832\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00833\ \ \ \}}
\DoxyCodeLine{00834\ }
\DoxyCodeLine{00835\ \ \ WNDCLASS\ wc;}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ ZeroMemory(\&wc,\ \textcolor{keyword}{sizeof}(WNDCLASS));}
\DoxyCodeLine{00838\ \ \ wc.style\ =\ 0;}
\DoxyCodeLine{00839\ \ \ wc.lpfnWndProc\ =\ (WNDPROC)static\_window\_proc;}
\DoxyCodeLine{00840\ \ \ wc.hInstance\ =\ application;}
\DoxyCodeLine{00841\ \ \ wc.hCursor\ =\ LoadCursor(\textcolor{keyword}{nullptr},\ IDC\_ARROW);}
\DoxyCodeLine{00842\ \ \ wc.hbrBackground\ =\ (HBRUSH)COLOR\_WINDOW;}
\DoxyCodeLine{00843\ \ \ wc.lpszMenuName\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00844\ \ \ wc.lpszClassName\ =\ \_window\_class\_name;}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \textcolor{comment}{//\ Reserve\ space\ to\ associate\ the\ this\ pointer\ with\ the\ window.}}
\DoxyCodeLine{00847\ \ \ wc.cbWndExtra\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classWinStatsFlameGraph}{WinStatsFlameGraph}}\ *);}
\DoxyCodeLine{00848\ }
\DoxyCodeLine{00849\ \ \ \textcolor{keywordflow}{if}\ (!RegisterClass(\&wc))\ \{}
\DoxyCodeLine{00850\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ register\ FlameGraph\ window\ class!\(\backslash\)n"{}};}
\DoxyCodeLine{00851\ \ \ \ \ exit(1);}
\DoxyCodeLine{00852\ \ \ \}}
\DoxyCodeLine{00853\ }
\DoxyCodeLine{00854\ \ \ \_window\_class\_registered\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00855\ \}}
\DoxyCodeLine{00856\ }
\DoxyCodeLine{00860\ LONG\ WINAPI\ WinStatsFlameGraph::}
\DoxyCodeLine{00861\ static\_window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00862\ \ \ \mbox{\hyperlink{classWinStatsFlameGraph}{WinStatsFlameGraph}}\ *self\ =\ (\mbox{\hyperlink{classWinStatsFlameGraph}{WinStatsFlameGraph}}\ *)GetWindowLongPtr(hwnd,\ 0);}
\DoxyCodeLine{00863\ \ \ \textcolor{keywordflow}{if}\ (self\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ self-\/>\_window\ ==\ hwnd)\ \{}
\DoxyCodeLine{00864\ \ \ \ \ \textcolor{keywordflow}{return}\ self-\/>window\_proc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00865\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00866\ \ \ \ \ \textcolor{keywordflow}{return}\ DefWindowProc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00867\ \ \ \}}
\DoxyCodeLine{00868\ \}}

\end{DoxyCode}
