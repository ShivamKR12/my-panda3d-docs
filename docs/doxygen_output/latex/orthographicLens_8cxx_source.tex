\doxysection{orthographic\+Lens.\+cxx}
\hypertarget{orthographicLens_8cxx_source}{}\label{orthographicLens_8cxx_source}\index{panda/src/gobj/orthographicLens.cxx@{panda/src/gobj/orthographicLens.cxx}}
\mbox{\hyperlink{orthographicLens_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{orthographicLens_8h}{orthographicLens.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ OrthographicLens::\_type\_handle;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00024\ PT(\mbox{\hyperlink{classLens}{Lens}})\ OrthographicLens::}
\DoxyCodeLine{00025\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00026\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classOrthographicLens}{OrthographicLens}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00027\ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00034\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classOrthographicLens_ac59ba7b9a363debe18562acde7684449}{OrthographicLens::}}}
\DoxyCodeLine{00035\ \mbox{\hyperlink{classOrthographicLens_ac59ba7b9a363debe18562acde7684449}{is\_linear}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00043\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classOrthographicLens_a557f5647a03643fb23473aa4f103fd81}{OrthographicLens::}}}
\DoxyCodeLine{00044\ \mbox{\hyperlink{classOrthographicLens_a557f5647a03643fb23473aa4f103fd81}{is\_orthographic}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ \textcolor{keywordtype}{void}\ OrthographicLens::}
\DoxyCodeLine{00052\ write(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)\ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}\ film\ size\ =\ "{}}\ <<\ get\_film\_size()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00054\ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00061\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classOrthographicLens_a558e67bfcb00279f80201a6d1f9eef5d}{OrthographicLens::}}}
\DoxyCodeLine{00062\ \mbox{\hyperlink{classOrthographicLens_a558e67bfcb00279f80201a6d1f9eef5d}{do\_extrude\_depth}}(\textcolor{keyword}{const}\ CData\ *cdata,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3\ \&point2d,\ LPoint3\ \&point3d)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classLens_a7e9b27f70cc860b3d461a8e4c1889774}{do\_extrude\_depth\_with\_mat}}(cdata,\ point2d,\ point3d);}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00071\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classOrthographicLens_a5261d62b2660283898303b794d9243da}{OrthographicLens::}}}
\DoxyCodeLine{00072\ \mbox{\hyperlink{classOrthographicLens_a5261d62b2660283898303b794d9243da}{do\_compute\_projection\_mat}}(\mbox{\hyperlink{classLens_1_1CData}{Lens::CData}}\ *lens\_cdata)\ \{}
\DoxyCodeLine{00073\ \ \ CoordinateSystem\ cs\ =\ lens\_cdata-\/>\_cs;}
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{if}\ (cs\ ==\ CS\_default)\ \{}
\DoxyCodeLine{00075\ \ \ \ \ cs\ =\ get\_default\_coordinate\_system();}
\DoxyCodeLine{00076\ \ \ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ PN\_stdfloat\ a\ =\ 2.0f\ /\ (lens\_cdata-\/>\_far\_distance\ -\/\ lens\_cdata-\/>\_near\_distance);}
\DoxyCodeLine{00079\ \ \ PN\_stdfloat\ b\ =\ -\/(lens\_cdata-\/>\_far\_distance\ +\ lens\_cdata-\/>\_near\_distance)\ /\ (lens\_cdata-\/>\_far\_distance\ -\/\ lens\_cdata-\/>\_near\_distance);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ LMatrix4\ canonical;}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{switch}\ (cs)\ \{}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_right:}
\DoxyCodeLine{00084\ \ \ \ \ canonical.set(1.0f,\ \ 0.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ a,\ \ 0.0f,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 1.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ b,\ \ 1.0f);}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_right:}
\DoxyCodeLine{00091\ \ \ \ \ canonical.set(1.0f,\ \ 0.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 1.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ -\/a,\ \ 0.0f,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ b,\ \ 1.0f);}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_left:}
\DoxyCodeLine{00098\ \ \ \ \ canonical.set(1.0f,\ \ 0.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ -\/a,\ \ 0.0f,}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 1.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ b,\ \ 1.0f);}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_left:}
\DoxyCodeLine{00105\ \ \ \ \ canonical.set(1.0f,\ \ 0.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 1.0f,\ \ 0.0f,\ \ 0.0f,}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ a,\ \ 0.0f,}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f,\ \ 0.0f,\ \ \ \ \ b,\ \ 1.0f);}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00112\ \ \ \ \ gobj\_cat.error()}
\DoxyCodeLine{00113\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ coordinate\ system\ "{}}\ <<\ (int)cs\ <<\ \textcolor{stringliteral}{"{}\ in\ OrthographicLens!\(\backslash\)n"{}};}
\DoxyCodeLine{00114\ \ \ \ \ canonical\ =\ LMatrix4::ident\_mat();}
\DoxyCodeLine{00115\ \ \ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ lens\_cdata-\/>\_projection\_mat\ =\ do\_get\_lens\_mat\_inv(lens\_cdata)\ *\ canonical\ *\ do\_get\_film\_mat(lens\_cdata);}
\DoxyCodeLine{00118\ \ \ lens\_cdata-\/>\_projection\_mat\_left\ =\ lens\_cdata-\/>\_projection\_mat\_right\ =\ lens\_cdata-\/>\_projection\_mat;}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ do\_adjust\_comp\_flags(lens\_cdata,}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CF\_projection\_mat\_inv\ |\ CF\_projection\_mat\_left\_inv\ |\ CF\_projection\_mat\_right\_inv,}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CF\_projection\_mat);}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00128\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classOrthographicLens_a807bff43a3233324dc82abcc51c702aa}{OrthographicLens::}}}
\DoxyCodeLine{00129\ \mbox{\hyperlink{classOrthographicLens_a807bff43a3233324dc82abcc51c702aa}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00130\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classOrthographicLens_a699fee4cb4e3d4f532fb6e27823b69c7}{make\_from\_bam}});}
\DoxyCodeLine{00131\ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00138\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classOrthographicLens_a699fee4cb4e3d4f532fb6e27823b69c7}{OrthographicLens::}}}
\DoxyCodeLine{00139\ \mbox{\hyperlink{classOrthographicLens_a699fee4cb4e3d4f532fb6e27823b69c7}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classOrthographicLens}{OrthographicLens}}\ *lens\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classOrthographicLens}{OrthographicLens}};}
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00145\ \ \ lens-\/>\mbox{\hyperlink{classLens_ae07466afe50a236e96da1445c515ba95}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{keywordflow}{return}\ lens;}
\DoxyCodeLine{00148\ \}}

\end{DoxyCode}
