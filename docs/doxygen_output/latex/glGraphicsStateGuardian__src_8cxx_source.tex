\doxysection{gl\+Graphics\+State\+Guardian\+\_\+src.\+cxx}
\hypertarget{glGraphicsStateGuardian__src_8cxx_source}{}\label{glGraphicsStateGuardian__src_8cxx_source}\index{panda/src/glstuff/glGraphicsStateGuardian\_src.cxx@{panda/src/glstuff/glGraphicsStateGuardian\_src.cxx}}
\mbox{\hyperlink{glGraphicsStateGuardian__src_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__putil_8h}{config\_putil.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{displayRegion_8h}{displayRegion.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{renderBuffer_8h}{renderBuffer.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geom_8h}{geom.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexData_8h}{geomVertexData.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTriangles_8h}{geomTriangles.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTristrips_8h}{geomTristrips.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTrifans_8h}{geomTrifans.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomLines_8h}{geomLines.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomLinestrips_8h}{geomLinestrips.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomPatches_8h}{geomPatches.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomPoints_8h}{geomPoints.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexReader_8h}{geomVertexReader.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsWindow_8h}{graphicsWindow.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lens_8h}{lens.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{perspectiveLens_8h}{perspectiveLens.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{directionalLight_8h}{directionalLight.h}}"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pointLight_8h}{pointLight.h}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{spotlight_8h}{spotlight.h}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{planeNode_8h}{planeNode.h}}"{}}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fog_8h}{fog.h}}"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{clockObject_8h}{clockObject.h}}"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nodePath_8h}{nodePath.h}}"{}}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pvector_8h}{pvector.h}}"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vector__string_8h}{vector\_string.h}}"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmImage_8h}{pnmImage.h}}"{}}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__gobj_8h}{config\_gobj.h}}"{}}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lightMutexHolder_8h}{lightMutexHolder.h}}"{}}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indirectLess_8h}{indirectLess.h}}"{}}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatTimer_8h}{pStatTimer.h}}"{}}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{load__prc__file_8h}{load\_prc\_file.h}}"{}}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamCache_8h}{bamCache.h}}"{}}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamCacheRecord_8h}{bamCacheRecord.h}}"{}}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{alphaTestAttrib_8h}{alphaTestAttrib.h}}"{}}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{clipPlaneAttrib_8h}{clipPlaneAttrib.h}}"{}}}
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullFaceAttrib_8h}{cullFaceAttrib.h}}"{}}}
\DoxyCodeLine{00056\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{depthBiasAttrib_8h}{depthBiasAttrib.h}}"{}}}
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{depthOffsetAttrib_8h}{depthOffsetAttrib.h}}"{}}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{depthWriteAttrib_8h}{depthWriteAttrib.h}}"{}}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fogAttrib_8h}{fogAttrib.h}}"{}}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lightAttrib_8h}{lightAttrib.h}}"{}}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#include\ "{}logicOpAttrib.h"{}}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{materialAttrib_8h}{materialAttrib.h}}"{}}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{rescaleNormalAttrib_8h}{rescaleNormalAttrib.h}}"{}}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{scissorAttrib_8h}{scissorAttrib.h}}"{}}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shadeModelAttrib_8h}{shadeModelAttrib.h}}"{}}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stencilAttrib_8h}{stencilAttrib.h}}"{}}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsEngine_8h}{graphicsEngine.h}}"{}}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shaderGenerator_8h}{shaderGenerator.h}}"{}}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{samplerState_8h}{samplerState.h}}"{}}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{displayInformation_8h}{displayInformation.h}}"{}}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{completionCounter_8h}{completionCounter.h}}"{}}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{htmlVideoTexture_8h}{htmlVideoTexture.h}}"{}}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{cgGL_8h}{Cg/cgGL.h}}>}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{using\ }std::dec;}
\DoxyCodeLine{00084\ \textcolor{keyword}{using\ }std::endl;}
\DoxyCodeLine{00085\ \textcolor{keyword}{using\ }std::hex;}
\DoxyCodeLine{00086\ \textcolor{keyword}{using\ }std::max;}
\DoxyCodeLine{00087\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00088\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_type\_handle;}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_load\_display\_list\_pcollector(\textcolor{stringliteral}{"{}Draw:Transfer\ data:Display\ lists"{}});}
\DoxyCodeLine{00093\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_primitive\_batches\_display\_list\_pcollector(\textcolor{stringliteral}{"{}Primitive\ batches:Display\ lists"{}});}
\DoxyCodeLine{00094\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_vertices\_display\_list\_pcollector(\textcolor{stringliteral}{"{}Vertices:Display\ lists"{}});}
\DoxyCodeLine{00095\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_vertices\_immediate\_pcollector(\textcolor{stringliteral}{"{}Vertices:Immediate\ mode"{}});}
\DoxyCodeLine{00096\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_memory\_barrier\_pcollector(\textcolor{stringliteral}{"{}Draw:Memory\ barriers"{}});}
\DoxyCodeLine{00097\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_vertex\_array\_update\_pcollector(\textcolor{stringliteral}{"{}Draw:Update\ arrays"{}});}
\DoxyCodeLine{00098\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_texture\_update\_pcollector(\textcolor{stringliteral}{"{}Draw:Update\ texture"{}});}
\DoxyCodeLine{00099\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_fbo\_bind\_pcollector(\textcolor{stringliteral}{"{}Draw:Bind\ FBO"{}});}
\DoxyCodeLine{00100\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_check\_error\_pcollector(\textcolor{stringliteral}{"{}Draw:Check\ errors"{}});}
\DoxyCodeLine{00101\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_check\_residency\_pcollector(\textcolor{stringliteral}{"{}*:PStats:Check\ residency"{}});}
\DoxyCodeLine{00102\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_wait\_fence\_pcollector(\textcolor{stringliteral}{"{}Wait:Fence"{}});}
\DoxyCodeLine{00103\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_copy\_texture\_finish\_pcollector(\textcolor{stringliteral}{"{}Draw:Copy\ texture:Finish"{}});}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ \_create\_texture\_storage\_pcollector(\textcolor{stringliteral}{"{}Draw:Transfer\ data:Texture:Create\ Storage"{}});}
\DoxyCodeLine{00106\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ \_create\_map\_pbo\_pcollector(\textcolor{stringliteral}{"{}Draw:Transfer\ data:Texture:Create/Map\ PBO"{}});}
\DoxyCodeLine{00107\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ \_load\_texture\_copy\_pcollector(\textcolor{stringliteral}{"{}Draw:Transfer\ data:Texture:Copy/Convert"{}});}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{00110\ AtomicAdjust::Integer\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_num\_gsgs\_with\_cg\_contexts\ =\ 0;}
\DoxyCodeLine{00111\ \mbox{\hyperlink{classsmall__vector}{small\_vector<CGcontext>}}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::\_destroyed\_cg\_contexts;}
\DoxyCodeLine{00112\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \textcolor{comment}{//\ The\ following\ noop\ functions\ are\ assigned\ to\ the\ corresponding\ glext}}
\DoxyCodeLine{00115\ \textcolor{comment}{//\ function\ pointers\ in\ the\ class,\ in\ case\ the\ functions\ are\ not\ defined\ by}}
\DoxyCodeLine{00116\ \textcolor{comment}{//\ the\ GL,\ just\ so\ it\ will\ always\ be\ safe\ to\ call\ the\ extension\ functions.}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00119\ null\_glPointParameterfv(GLenum,\ \textcolor{keyword}{const}\ GLfloat\ *)\ \{}
\DoxyCodeLine{00120\ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{00123\ \textcolor{comment}{//\ OpenGL\ ES\ 1\ doesn't\ support\ this,\ period.\ \ Might\ as\ well\ macro\ it.}}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#define\ \_glDrawRangeElements(mode,\ start,\ end,\ count,\ type,\ indices)\ \(\backslash\)}}
\DoxyCodeLine{00125\ \textcolor{preprocessor}{\ \ glDrawElements(mode,\ count,\ type,\ indices)}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00128\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00129\ null\_glDrawRangeElements(GLenum\ mode,\ GLuint\ start,\ GLuint\ end,}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLsizei\ count,\ GLenum\ type,\ \textcolor{keyword}{const}\ GLvoid\ *indices)\ \{}
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ If\ we\ don't\ support\ glDrawRangeElements(),\ just\ use\ the\ original}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ glDrawElements()\ instead.}}
\DoxyCodeLine{00133\ \ \ glDrawElements(mode,\ count,\ type,\ indices);}
\DoxyCodeLine{00134\ \}}
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#if\ defined(OPENGLES)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{00138\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00139\ null\_glVertexAttrib4dv(GLuint\ index,\ \textcolor{keyword}{const}\ GLdouble\ *v)\ \{}
\DoxyCodeLine{00140\ \ \ GLfloat\ vf[4]\ =\ \{(GLfloat)v[0],\ (GLfloat)v[1],\ (GLfloat)v[2],\ (GLfloat)v[3]\};}
\DoxyCodeLine{00141\ \ \ glVertexAttrib4fv(index,\ vf);}
\DoxyCodeLine{00142\ \}}
\DoxyCodeLine{00143\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00146\ null\_glActiveTexture(GLenum\ gl\_texture\_stage)\ \{}
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ If\ we\ don't\ support\ multitexture,\ we'd\ better\ not\ try\ to\ request\ a}}
\DoxyCodeLine{00148\ \ \ \textcolor{comment}{//\ texture\ beyond\ the\ first\ texture\ stage.}}
\DoxyCodeLine{00149\ \ \ nassertv(gl\_texture\_stage\ ==\ GL\_TEXTURE0);}
\DoxyCodeLine{00150\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{00153\ \textcolor{preprocessor}{\#define\ \_glBlendEquation\ glBlendEquation}}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\#define\ \_glBlendEquationSeparate\ glBlendEquationSeparate}}
\DoxyCodeLine{00155\ \textcolor{preprocessor}{\#define\ \_glBlendFuncSeparate\ glBlendFuncSeparate}}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\#define\ \_glBlendColor\ glBlendColor}}
\DoxyCodeLine{00157\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00158\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00159\ null\_glBlendEquation(GLenum)\ \{}
\DoxyCodeLine{00160\ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00163\ null\_glBlendFuncSeparate(GLenum\ src,\ GLenum\ dest,\ GLenum,\ GLenum)\ \{}
\DoxyCodeLine{00164\ \ \ glBlendFunc(src,\ dest);}
\DoxyCodeLine{00165\ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00168\ null\_glBlendColor(GLclampf,\ GLclampf,\ GLclampf,\ GLclampf)\ \{}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00173\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00174\ null\_glPolygonOffsetClamp(GLfloat\ factor,\ GLfloat\ units,\ GLfloat\ clamp)\ \{}
\DoxyCodeLine{00175\ \ \ glPolygonOffset(factor,\ units);}
\DoxyCodeLine{00176\ \}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ APIENTRY}
\DoxyCodeLine{00180\ null\_glMemoryBarrier(GLbitfield\ barriers)\ \{}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00184\ \textcolor{comment}{//\ We\ have\ a\ default\ shader\ that\ will\ be\ applied\ when\ there\ isn't\ any\ shader}}
\DoxyCodeLine{00185\ \textcolor{comment}{//\ applied\ (e.g.\ \ if\ it\ failed\ to\ compile).\ \ We\ need\ this\ because\ OpenGL\ ES}}
\DoxyCodeLine{00186\ \textcolor{comment}{//\ 2.x\ and\ OpenGL\ 3.2+\ core\ don't\ have\ a\ fixed-\/function\ pipeline.\ \ This}}
\DoxyCodeLine{00187\ \textcolor{comment}{//\ default\ shader\ just\ applies\ a\ single\ texture,\ which\ is\ good\ enough\ for}}
\DoxyCodeLine{00188\ \textcolor{comment}{//\ drawing\ GUIs\ and\ such.}}
\DoxyCodeLine{00189\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ default\_vshader\ =}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\#ifdef\ \_\_APPLE\_\_\ }\textcolor{comment}{//\ Apple's\ GL\ 3.2\ contexts\ require\ at\ least\ GLSL\ 1.50.}}
\DoxyCodeLine{00192\ \ \ \textcolor{stringliteral}{"{}\#version\ 150\(\backslash\)n"{}}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00194\ \ \ \textcolor{stringliteral}{"{}\#version\ 130\(\backslash\)n"{}}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00196\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ p3d\_Vertex;\(\backslash\)n"{}}}
\DoxyCodeLine{00197\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ p3d\_Color;\(\backslash\)n"{}}}
\DoxyCodeLine{00198\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ p3d\_MultiTexCoord0;\(\backslash\)n"{}}}
\DoxyCodeLine{00199\ \ \ \textcolor{stringliteral}{"{}out\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00200\ \ \ \textcolor{stringliteral}{"{}out\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00201\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ModelViewProjectionMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00202\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00203\ \ \ \textcolor{stringliteral}{"{}\#version\ 100\(\backslash\)n"{}}}
\DoxyCodeLine{00204\ \ \ \textcolor{stringliteral}{"{}precision\ mediump\ float;\(\backslash\)n"{}}}
\DoxyCodeLine{00205\ \ \ \textcolor{stringliteral}{"{}attribute\ vec4\ p3d\_Vertex;\(\backslash\)n"{}}}
\DoxyCodeLine{00206\ \ \ \textcolor{stringliteral}{"{}attribute\ vec4\ p3d\_Color;\(\backslash\)n"{}}}
\DoxyCodeLine{00207\ \ \ \textcolor{stringliteral}{"{}attribute\ vec4\ p3d\_MultiTexCoord0;\(\backslash\)n"{}}}
\DoxyCodeLine{00208\ \ \ \textcolor{stringliteral}{"{}varying\ lowp\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00209\ \ \ \textcolor{stringliteral}{"{}\#ifdef\ GL\_FRAGMENT\_PRECISION\_HIGH\(\backslash\)n"{}}}
\DoxyCodeLine{00210\ \ \ \textcolor{stringliteral}{"{}varying\ highp\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00211\ \ \ \textcolor{stringliteral}{"{}uniform\ highp\ mat4\ p3d\_ModelViewProjectionMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00212\ \ \ \textcolor{stringliteral}{"{}\#else\(\backslash\)n"{}}}
\DoxyCodeLine{00213\ \ \ \textcolor{stringliteral}{"{}varying\ mediump\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00214\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ModelViewProjectionMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00215\ \ \ \textcolor{stringliteral}{"{}\#endif\(\backslash\)n"{}}}
\DoxyCodeLine{00216\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00217\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_TextureMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00218\ \ \ \textcolor{stringliteral}{"{}uniform\ vec4\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00219\ \ \ \textcolor{stringliteral}{"{}void\ main(void)\ \{\(\backslash\)n"{}}}
\DoxyCodeLine{00220\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_Position\ =\ p3d\_ModelViewProjectionMatrix\ *\ p3d\_Vertex;\(\backslash\)n"{}}}
\DoxyCodeLine{00221\ \ \ \textcolor{stringliteral}{"{}\ \ texcoord\ =\ (p3d\_TextureMatrix\ *\ p3d\_MultiTexCoord0).xyw;\(\backslash\)n"{}}}
\DoxyCodeLine{00222\ \ \ \textcolor{stringliteral}{"{}\ \ color\ =\ p3d\_Color\ *\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00223\ \ \ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00226\ \textcolor{comment}{//\ This\ version\ of\ the\ shader\ is\ used\ if\ vertices-\/float64\ is\ enabled.}}
\DoxyCodeLine{00227\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ default\_vshader\_fp64\ =}
\DoxyCodeLine{00228\ \textcolor{preprocessor}{\#ifdef\ \_\_APPLE\_\_}}
\DoxyCodeLine{00229\ \ \ \textcolor{stringliteral}{"{}\#version\ 150\(\backslash\)n"{}}}
\DoxyCodeLine{00230\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00231\ \ \ \textcolor{stringliteral}{"{}\#version\ 130\(\backslash\)n"{}}}
\DoxyCodeLine{00232\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00233\ \ \ \textcolor{stringliteral}{"{}\#extension\ GL\_ARB\_vertex\_attrib\_64bit\ :\ require\(\backslash\)n"{}}}
\DoxyCodeLine{00234\ \ \ \textcolor{stringliteral}{"{}\#extension\ GL\_ARB\_gpu\_shader\_fp64\ :\ require\(\backslash\)n"{}}}
\DoxyCodeLine{00235\ \ \ \textcolor{stringliteral}{"{}in\ dvec3\ p3d\_Vertex;\(\backslash\)n"{}}}
\DoxyCodeLine{00236\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ p3d\_Color;\(\backslash\)n"{}}}
\DoxyCodeLine{00237\ \ \ \textcolor{stringliteral}{"{}in\ dvec4\ p3d\_MultiTexCoord0;\(\backslash\)n"{}}}
\DoxyCodeLine{00238\ \ \ \textcolor{stringliteral}{"{}out\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00239\ \ \ \textcolor{stringliteral}{"{}out\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00240\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ModelViewMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00241\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ProjectionMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00242\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_TextureMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00243\ \ \ \textcolor{stringliteral}{"{}uniform\ vec4\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00244\ \ \ \textcolor{stringliteral}{"{}void\ main(void)\ \{\(\backslash\)n"{}}\ \textcolor{comment}{//\ Apply\ proj\ \&\ modelview\ in\ two\ steps,\ more\ precise}}
\DoxyCodeLine{00245\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_Position\ =\ vec4(dmat4(p3d\_ProjectionMatrix)\ *\ (dmat4(p3d\_ModelViewMatrix)\ *\ dvec4(p3d\_Vertex,\ 1)));\(\backslash\)n"{}}}
\DoxyCodeLine{00246\ \ \ \textcolor{stringliteral}{"{}\ \ texcoord\ =\ (p3d\_TextureMatrix\ *\ vec4(p3d\_MultiTexCoord0)).xyw;\(\backslash\)n"{}}}
\DoxyCodeLine{00247\ \ \ \textcolor{stringliteral}{"{}\ \ color\ =\ p3d\_Color\ *\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00248\ \ \ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \textcolor{comment}{//\ Same\ as\ above,\ but\ for\ OpenGL\ 4.1.}}
\DoxyCodeLine{00251\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ default\_vshader\_fp64\_gl41\ =}
\DoxyCodeLine{00252\ \ \ \textcolor{stringliteral}{"{}\#version\ 410\(\backslash\)n"{}}}
\DoxyCodeLine{00253\ \ \ \textcolor{stringliteral}{"{}in\ dvec3\ p3d\_Vertex;\(\backslash\)n"{}}}
\DoxyCodeLine{00254\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ p3d\_Color;\(\backslash\)n"{}}}
\DoxyCodeLine{00255\ \ \ \textcolor{stringliteral}{"{}in\ dvec4\ p3d\_MultiTexCoord0;\(\backslash\)n"{}}}
\DoxyCodeLine{00256\ \ \ \textcolor{stringliteral}{"{}out\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00257\ \ \ \textcolor{stringliteral}{"{}out\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00258\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ModelViewMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00259\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_ProjectionMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00260\ \ \ \textcolor{stringliteral}{"{}uniform\ mat4\ p3d\_TextureMatrix;\(\backslash\)n"{}}}
\DoxyCodeLine{00261\ \ \ \textcolor{stringliteral}{"{}uniform\ vec4\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00262\ \ \ \textcolor{stringliteral}{"{}void\ main(void)\ \{\(\backslash\)n"{}}\ \textcolor{comment}{//\ Apply\ proj\ \&\ modelview\ in\ two\ steps,\ more\ precise}}
\DoxyCodeLine{00263\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_Position\ =\ vec4(dmat4(p3d\_ProjectionMatrix)\ *\ (dmat4(p3d\_ModelViewMatrix)\ *\ dvec4(p3d\_Vertex,\ 1)));\(\backslash\)n"{}}}
\DoxyCodeLine{00264\ \ \ \textcolor{stringliteral}{"{}\ \ texcoord\ =\ (p3d\_TextureMatrix\ *\ vec4(p3d\_MultiTexCoord0)).xyw;\(\backslash\)n"{}}}
\DoxyCodeLine{00265\ \ \ \textcolor{stringliteral}{"{}\ \ color\ =\ p3d\_Color\ *\ p3d\_ColorScale;\(\backslash\)n"{}}}
\DoxyCodeLine{00266\ \ \ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00267\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ default\_fshader\ =}
\DoxyCodeLine{00270\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00271\ \textcolor{preprocessor}{\#ifdef\ \_\_APPLE\_\_\ \ }\textcolor{comment}{//\ Apple's\ GL\ 3.2\ contexts\ require\ at\ least\ GLSL\ 1.50.}}
\DoxyCodeLine{00272\ \ \ \textcolor{stringliteral}{"{}\#version\ 150\(\backslash\)n"{}}}
\DoxyCodeLine{00273\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00274\ \ \ \textcolor{stringliteral}{"{}\#version\ 130\(\backslash\)n"{}}}
\DoxyCodeLine{00275\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00276\ \ \ \textcolor{stringliteral}{"{}in\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00277\ \ \ \textcolor{stringliteral}{"{}in\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00278\ \ \ \textcolor{stringliteral}{"{}out\ vec4\ p3d\_FragColor;\(\backslash\)n"{}}}
\DoxyCodeLine{00279\ \ \ \textcolor{stringliteral}{"{}uniform\ sampler2D\ p3d\_Texture0;\(\backslash\)n"{}}}
\DoxyCodeLine{00280\ \ \ \textcolor{stringliteral}{"{}uniform\ vec4\ p3d\_TexAlphaOnly;\(\backslash\)n"{}}}
\DoxyCodeLine{00281\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00282\ \ \ \textcolor{stringliteral}{"{}\#version\ 100\(\backslash\)n"{}}}
\DoxyCodeLine{00283\ \ \ \textcolor{stringliteral}{"{}precision\ mediump\ float;\(\backslash\)n"{}}}
\DoxyCodeLine{00284\ \ \ \textcolor{stringliteral}{"{}\#ifdef\ GL\_FRAGMENT\_PRECISION\_HIGH\(\backslash\)n"{}}}
\DoxyCodeLine{00285\ \ \ \textcolor{stringliteral}{"{}varying\ highp\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00286\ \ \ \textcolor{stringliteral}{"{}\#else\(\backslash\)n"{}}}
\DoxyCodeLine{00287\ \ \ \textcolor{stringliteral}{"{}varying\ mediump\ vec3\ texcoord;\(\backslash\)n"{}}}
\DoxyCodeLine{00288\ \ \ \textcolor{stringliteral}{"{}\#endif\(\backslash\)n"{}}}
\DoxyCodeLine{00289\ \ \ \textcolor{stringliteral}{"{}varying\ lowp\ vec4\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00290\ \ \ \textcolor{stringliteral}{"{}uniform\ lowp\ sampler2D\ p3d\_Texture0;\(\backslash\)n"{}}}
\DoxyCodeLine{00291\ \ \ \textcolor{stringliteral}{"{}uniform\ lowp\ vec4\ p3d\_TexAlphaOnly;\(\backslash\)n"{}}}
\DoxyCodeLine{00292\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00293\ \ \ \textcolor{stringliteral}{"{}void\ main(void)\ \{\(\backslash\)n"{}}}
\DoxyCodeLine{00294\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00295\ \ \ \textcolor{stringliteral}{"{}\ \ p3d\_FragColor\ =\ textureProj(p3d\_Texture0,\ texcoord);\(\backslash\)n"{}}}
\DoxyCodeLine{00296\ \ \ \textcolor{stringliteral}{"{}\ \ p3d\_FragColor\ +=\ p3d\_TexAlphaOnly;\(\backslash\)n"{}}\ \textcolor{comment}{//\ Hack\ for\ text\ rendering}}
\DoxyCodeLine{00297\ \ \ \textcolor{stringliteral}{"{}\ \ p3d\_FragColor\ *=\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00298\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00299\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_FragColor\ =\ texture2DProj(p3d\_Texture0,\ texcoord);\(\backslash\)n"{}}}
\DoxyCodeLine{00300\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_FragColor\ +=\ p3d\_TexAlphaOnly;\(\backslash\)n"{}}\ \textcolor{comment}{//\ Hack\ for\ text\ rendering}}
\DoxyCodeLine{00301\ \ \ \textcolor{stringliteral}{"{}\ \ gl\_FragColor\ *=\ color;\(\backslash\)n"{}}}
\DoxyCodeLine{00302\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00303\ \ \ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00304\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00310\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00311\ uchar\_bgr\_to\_rgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *source,}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00314\ \ \ \ \ dest[0]\ =\ source[2];}
\DoxyCodeLine{00315\ \ \ \ \ dest[1]\ =\ source[1];}
\DoxyCodeLine{00316\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00317\ \ \ \ \ dest\ +=\ 3;}
\DoxyCodeLine{00318\ \ \ \ \ source\ +=\ 3;}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00326\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00327\ uchar\_l\_to\_rgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *source,}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00329\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00330\ \ \ \ \ dest[0]\ =\ source[0];}
\DoxyCodeLine{00331\ \ \ \ \ dest[1]\ =\ source[0];}
\DoxyCodeLine{00332\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00333\ \ \ \ \ dest\ +=\ 3;}
\DoxyCodeLine{00334\ \ \ \ \ source\ +=\ 1;}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00342\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00343\ uchar\_l\_to\_rgba(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *source,}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ dest[0]\ =\ source[0];}
\DoxyCodeLine{00347\ \ \ \ \ dest[1]\ =\ source[0];}
\DoxyCodeLine{00348\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00349\ \ \ \ \ dest[3]\ =\ 1;}
\DoxyCodeLine{00350\ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{00351\ \ \ \ \ source\ +=\ 1;}
\DoxyCodeLine{00352\ \ \ \}}
\DoxyCodeLine{00353\ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00359\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00360\ uchar\_bgra\_to\_rgba(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *source,}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ dest[0]\ =\ source[2];}
\DoxyCodeLine{00364\ \ \ \ \ dest[1]\ =\ source[1];}
\DoxyCodeLine{00365\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00366\ \ \ \ \ dest[3]\ =\ source[3];}
\DoxyCodeLine{00367\ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{00368\ \ \ \ \ source\ +=\ 4;}
\DoxyCodeLine{00369\ \ \ \}}
\DoxyCodeLine{00370\ \}}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00376\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00377\ uchar\_la\_to\_rgba(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *source,}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00379\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ dest[0]\ =\ source[0];}
\DoxyCodeLine{00381\ \ \ \ \ dest[1]\ =\ source[0];}
\DoxyCodeLine{00382\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00383\ \ \ \ \ dest[3]\ =\ source[1];}
\DoxyCodeLine{00384\ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{00385\ \ \ \ \ source\ +=\ 2;}
\DoxyCodeLine{00386\ \ \ \}}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00392\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00393\ ushort\_bgr\_to\_rgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *source,}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00396\ \ \ \ \ dest[0]\ =\ source[2];}
\DoxyCodeLine{00397\ \ \ \ \ dest[1]\ =\ source[1];}
\DoxyCodeLine{00398\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00399\ \ \ \ \ dest\ +=\ 3;}
\DoxyCodeLine{00400\ \ \ \ \ source\ +=\ 3;}
\DoxyCodeLine{00401\ \ \ \}}
\DoxyCodeLine{00402\ \}}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00408\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00409\ ushort\_l\_to\_rgb(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *source,}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ dest[0]\ =\ source[0];}
\DoxyCodeLine{00413\ \ \ \ \ dest[1]\ =\ source[0];}
\DoxyCodeLine{00414\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00415\ \ \ \ \ dest\ +=\ 3;}
\DoxyCodeLine{00416\ \ \ \ \ source\ +=\ 1;}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00424\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00425\ ushort\_bgra\_to\_rgba(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *source,}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00427\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00428\ \ \ \ \ dest[0]\ =\ source[2];}
\DoxyCodeLine{00429\ \ \ \ \ dest[1]\ =\ source[1];}
\DoxyCodeLine{00430\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00431\ \ \ \ \ dest[3]\ =\ source[3];}
\DoxyCodeLine{00432\ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{00433\ \ \ \ \ source\ +=\ 4;}
\DoxyCodeLine{00434\ \ \ \}}
\DoxyCodeLine{00435\ \}}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00441\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00442\ ushort\_la\_to\_rgba(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *dest,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *source,}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels)\ \{}
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_pixels;\ i++)\ \{}
\DoxyCodeLine{00445\ \ \ \ \ dest[0]\ =\ source[0];}
\DoxyCodeLine{00446\ \ \ \ \ dest[1]\ =\ source[0];}
\DoxyCodeLine{00447\ \ \ \ \ dest[2]\ =\ source[0];}
\DoxyCodeLine{00448\ \ \ \ \ dest[3]\ =\ source[1];}
\DoxyCodeLine{00449\ \ \ \ \ dest\ +=\ 4;}
\DoxyCodeLine{00450\ \ \ \ \ source\ +=\ 2;}
\DoxyCodeLine{00451\ \ \ \}}
\DoxyCodeLine{00452\ \}}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00457\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00458\ get\_external\_format\_components(GLint\ external\_format)\ \{}
\DoxyCodeLine{00459\ \ \ \textcolor{keywordflow}{switch}\ (external\_format)\ \{}
\DoxyCodeLine{00460\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{case}\ GL\_RED:}
\DoxyCodeLine{00462\ \ \ \textcolor{keywordflow}{case}\ GL\_RED\_INTEGER:}
\DoxyCodeLine{00463\ \ \ \textcolor{keywordflow}{case}\ GL\_GREEN:}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{case}\ GL\_BLUE:}
\DoxyCodeLine{00465\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00466\ \ \ \textcolor{keywordflow}{case}\ GL\_ALPHA:}
\DoxyCodeLine{00467\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE:}
\DoxyCodeLine{00468\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{case}\ GL\_GREEN\_INTEGER:}
\DoxyCodeLine{00470\ \ \ \textcolor{keywordflow}{case}\ GL\_BLUE\_INTEGER:}
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{case}\ GL\_ALPHA\_INTEGER:}
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{case}\ GL\_STENCIL\_INDEX:}
\DoxyCodeLine{00473\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00474\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT:}
\DoxyCodeLine{00475\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_STENCIL:}
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00479\ \ \ \textcolor{keywordflow}{case}\ GL\_RG:}
\DoxyCodeLine{00480\ \ \ \textcolor{keywordflow}{case}\ GL\_RG\_INTEGER:}
\DoxyCodeLine{00481\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00482\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{return}\ 2;}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB:}
\DoxyCodeLine{00486\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00487\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB\_INTEGER:}
\DoxyCodeLine{00488\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00489\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{case}\ GL\_BGR:}
\DoxyCodeLine{00491\ \ \ \textcolor{keywordflow}{case}\ GL\_BGR\_INTEGER:}
\DoxyCodeLine{00492\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordflow}{return}\ 3;}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA:}
\DoxyCodeLine{00496\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA\_INTEGER:}
\DoxyCodeLine{00498\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00499\ \ \ \textcolor{keywordflow}{case}\ GL\_BGRA:}
\DoxyCodeLine{00500\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00501\ \ \ \textcolor{keywordflow}{case}\ GL\_BGRA\_INTEGER:}
\DoxyCodeLine{00502\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordflow}{return}\ 4;}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00506\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{00507\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unknown\ external\ format\ 0x"{}}\ <<\ std::hex\ <<\ external\_format}
\DoxyCodeLine{00508\ \ \ \ \ \ \ <<\ std::dec\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{return}\ 4;}
\DoxyCodeLine{00510\ \ \ \}}
\DoxyCodeLine{00511\ \}}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00516\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00517\ copy\_image(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *new\_image,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *orig\_image,}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ orig\_image\_size,\ GLint\ external\_format,\ \textcolor{keywordtype}{int}\ num\_components,}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ component\_width)\ \{}
\DoxyCodeLine{00520\ \ \ \textcolor{keywordflow}{switch}\ (external\_format)\ \{}
\DoxyCodeLine{00521\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00522\ \ \ \textcolor{keywordflow}{case}\ GL\_RED:}
\DoxyCodeLine{00523\ \ \ \textcolor{keywordflow}{case}\ GL\_RED\_INTEGER:}
\DoxyCodeLine{00524\ \ \ \textcolor{keywordflow}{case}\ GL\_GREEN:}
\DoxyCodeLine{00525\ \ \ \textcolor{keywordflow}{case}\ GL\_BLUE:}
\DoxyCodeLine{00526\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{case}\ GL\_ALPHA:}
\DoxyCodeLine{00528\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE:}
\DoxyCodeLine{00529\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordflow}{case}\ GL\_GREEN\_INTEGER:}
\DoxyCodeLine{00531\ \ \ \textcolor{keywordflow}{case}\ GL\_BLUE\_INTEGER:}
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{case}\ GL\_ALPHA\_INTEGER:}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{case}\ GL\_STENCIL\_INDEX:}
\DoxyCodeLine{00534\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00535\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT:}
\DoxyCodeLine{00536\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_STENCIL:}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 1)\ \{}
\DoxyCodeLine{00538\ \ \ \ \ \ \ memcpy(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00540\ \ \ \ \ \}}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00544\ \ \ \textcolor{keywordflow}{case}\ GL\_RG:}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{case}\ GL\_RG\_INTEGER:}
\DoxyCodeLine{00546\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00547\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 2)\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \ \ memcpy(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00551\ \ \ \ \ \}}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00555\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00556\ \ \ \textcolor{keywordflow}{case}\ GL\_BGR:}
\DoxyCodeLine{00557\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00558\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB\_INTEGER:}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 3)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ memcpy(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00562\ \ \ \ \ \}}
\DoxyCodeLine{00563\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 1\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00564\ \ \ \ \ \ \ uchar\_l\_to\_rgb(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00566\ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00568\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB:}
\DoxyCodeLine{00571\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00572\ \ \ \textcolor{keywordflow}{case}\ GL\_BGR\_INTEGER:}
\DoxyCodeLine{00573\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{comment}{//\ Need\ to\ swap\ order.}}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 1\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \ \ uchar\_l\_to\_rgb(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00578\ \ \ \ \ \}}
\DoxyCodeLine{00579\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 3\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \ \ uchar\_bgr\_to\_rgb(new\_image,\ orig\_image,\ orig\_image\_size\ /\ 3);}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00582\ \ \ \ \ \}}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 3\ \&\&\ component\_width\ ==\ 2)\ \{}
\DoxyCodeLine{00584\ \ \ \ \ \ \ ushort\_bgr\_to\_rgb((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)new\_image,}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)orig\_image,}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image\_size\ /\ 6);}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00588\ \ \ \ \ \}}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \textcolor{keywordflow}{case}\ GL\_BGRA:}
\DoxyCodeLine{00592\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00593\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA\_INTEGER:}
\DoxyCodeLine{00594\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 4)\ \{}
\DoxyCodeLine{00596\ \ \ \ \ \ \ memcpy(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00598\ \ \ \ \ \}}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 1\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \ \ uchar\_l\_to\_rgba(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00602\ \ \ \ \ \}}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 2\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00604\ \ \ \ \ \ \ uchar\_la\_to\_rgba(new\_image,\ orig\_image,\ orig\_image\_size\ /\ 2);}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00606\ \ \ \ \ \}}
\DoxyCodeLine{00607\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA:}
\DoxyCodeLine{00610\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordflow}{case}\ GL\_BGRA\_INTEGER:}
\DoxyCodeLine{00612\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{comment}{//\ Need\ to\ swap\ order.}}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 1\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \ \ uchar\_l\_to\_rgba(new\_image,\ orig\_image,\ orig\_image\_size);}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00617\ \ \ \ \ \}}
\DoxyCodeLine{00618\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 2\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00619\ \ \ \ \ \ \ uchar\_la\_to\_rgba(new\_image,\ orig\_image,\ orig\_image\_size\ /\ 2);}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00621\ \ \ \ \ \}}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 4\ \&\&\ component\_width\ ==\ 1)\ \{}
\DoxyCodeLine{00623\ \ \ \ \ \ \ uchar\_bgra\_to\_rgba(new\_image,\ orig\_image,\ orig\_image\_size\ /\ 4);}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00625\ \ \ \ \ \}}
\DoxyCodeLine{00626\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_components\ ==\ 4\ \&\&\ component\_width\ ==\ 2)\ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ ushort\_bgra\_to\_rgba((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)new\_image,}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ *)orig\_image,}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ orig\_image\_size\ /\ 8);}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00631\ \ \ \ \ \}}
\DoxyCodeLine{00632\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00636\ \ \ \}}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ nassert\_raise(\textcolor{stringliteral}{"{}Failed\ to\ convert\ image."{}});}
\DoxyCodeLine{00639\ \}}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00652\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *}
\DoxyCodeLine{00653\ fix\_component\_ordering(\mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \&new\_image,}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *orig\_image,\ \textcolor{keywordtype}{size\_t}\ orig\_image\_size,}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLenum\ external\_format,\ \mbox{\hyperlink{classTexture}{Texture}}\ *tex)\ \{}
\DoxyCodeLine{00656\ \ \ \textcolor{keywordflow}{if}\ (external\_format\ ==\ GL\_RGB\ ||\ external\_format\ ==\ GL\_RGBA)\ \{}
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_components\ =\ tex-\/>get\_num\_components();}
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keywordtype}{int}\ component\_width\ =\ tex-\/>get\_component\_width();}
\DoxyCodeLine{00659\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ new\_image\_size\ =\ (orig\_image\_size\ /\ num\_components)\ *\ ((external\_format\ ==\ GL\_RGBA)\ ?\ 4\ :\ 3);}
\DoxyCodeLine{00660\ \ \ \ \ new\_image\ =\ PTA\_uchar::empty\_array(new\_image\_size);}
\DoxyCodeLine{00661\ \ \ \ \ copy\_image(\&new\_image[0],\ orig\_image,\ orig\_image\_size,\ external\_format,\ num\_components,\ component\_width);}
\DoxyCodeLine{00662\ \ \ \ \ \textcolor{keywordflow}{return}\ new\_image;}
\DoxyCodeLine{00663\ \ \ \}}
\DoxyCodeLine{00664\ \ \ \textcolor{keywordflow}{return}\ orig\_image;}
\DoxyCodeLine{00665\ \}}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \textcolor{comment}{//\ \#-\/-\/-\/\ Zhao\ Nov2011}}
\DoxyCodeLine{00668\ \textcolor{keywordtype}{string}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_vendor()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_vendor;\ \}}
\DoxyCodeLine{00669\ \textcolor{keywordtype}{string}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_renderer()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_renderer;\ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \textcolor{keywordtype}{string}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_version()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_version;\ \}}
\DoxyCodeLine{00672\ \textcolor{keywordtype}{int}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_version\_major()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_version\_major;\ \}}
\DoxyCodeLine{00673\ \textcolor{keywordtype}{int}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_version\_minor()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_version\_minor;\ \}}
\DoxyCodeLine{00674\ \textcolor{keywordtype}{int}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_shader\_version\_major()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_shadlang\_ver\_major;\ \}}
\DoxyCodeLine{00675\ \textcolor{keywordtype}{int}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::get\_driver\_shader\_version\_minor()\ \{\ \textcolor{keywordflow}{return}\ \_gl\_shadlang\_ver\_minor;\ \}}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00680\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{00681\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})(\mbox{\hyperlink{classGraphicsEngine}{GraphicsEngine}}\ *engine,\ \mbox{\hyperlink{classGraphicsPipe}{GraphicsPipe}}\ *pipe)\ :}
\DoxyCodeLine{00682\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}}(gl\_coordinate\_system,\ engine,\ pipe),}
\DoxyCodeLine{00683\ \ \ \_job\_queue\_cvar(\_job\_queue\_mutex),}
\DoxyCodeLine{00684\ \ \ \_renderbuffer\_residency(get\_prepared\_objects()-\/>get\_name(),\ \textcolor{stringliteral}{"{}renderbuffer"{}}),}
\DoxyCodeLine{00685\ \ \ \_active\_ppbuffer\_memory\_pcollector(\textcolor{stringliteral}{"{}Graphics\ memory:"{}}\ +\ get\_prepared\_objects()-\/>get\_name()\ +\ \textcolor{stringliteral}{"{}:Active:ppbuffer"{}}),}
\DoxyCodeLine{00686\ \ \ \_inactive\_ppbuffer\_memory\_pcollector(\textcolor{stringliteral}{"{}Graphics\ memory:"{}}\ +\ get\_prepared\_objects()-\/>get\_name()\ +\ \textcolor{stringliteral}{"{}:Inactive:ppbuffer"{}})}
\DoxyCodeLine{00687\ \{}
\DoxyCodeLine{00688\ \ \ \_error\_count\ =\ 0;}
\DoxyCodeLine{00689\ \ \ \_last\_error\_check\ =\ -\/1.0;}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \textcolor{comment}{//\ calling\ glGetError()\ forces\ a\ sync,\ this\ turns\ it\ on\ if\ you\ want\ to.}}
\DoxyCodeLine{00692\ \ \ \_check\_errors\ =\ gl\_check\_errors;}
\DoxyCodeLine{00693\ \ \ \_force\_flush\ =\ gl\_force\_flush;}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \_gl\_shadlang\_ver\_major\ =\ 0;}
\DoxyCodeLine{00696\ \ \ \_gl\_shadlang\_ver\_minor\ =\ 0;}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ \textcolor{comment}{//\ Let's\ say\ we\ have\ a\ core\ profile,\ to\ be\ checked\ later\ (Otherwise,\ if\ we\ are}}
\DoxyCodeLine{00699\ \ \ \textcolor{comment}{//\ wrong\ the\ user\ may\ ask\ for\ some\ non-\/available\ functions)}}
\DoxyCodeLine{00700\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00701\ \ \ \_core\_profile\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00702\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \textcolor{comment}{//\ Hack.\ \ Turn\ on\ the\ flag\ that\ we\ turned\ off\ at\ a\ higher\ level,\ since\ we}}
\DoxyCodeLine{00705\ \ \ \textcolor{comment}{//\ know\ this\ works\ properly\ in\ OpenGL,\ and\ we\ want\ the\ performance\ benefit}}
\DoxyCodeLine{00706\ \ \ \textcolor{comment}{//\ it\ gives\ us.}}
\DoxyCodeLine{00707\ \ \ \_prepared\_objects-\/>\_support\_released\_buffer\_cache\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \textcolor{comment}{//\ Assume\ that\ we\ will\ get\ a\ hardware-\/accelerated\ context,\ unless\ the\ window}}
\DoxyCodeLine{00710\ \ \ \textcolor{comment}{//\ tells\ us\ otherwise.}}
\DoxyCodeLine{00711\ \ \ \_is\_hardware\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \_scissor\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00714\ \ \ \_scissor\_attrib\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00715\ \ \ \_has\_attrib\_depth\_range\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \_white\_texture\ =\ 0;}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00720\ \ \ \_shader\_point\_size\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00721\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{00724\ \ \ \_cg\_context\ =\ 0;}
\DoxyCodeLine{00725\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \textcolor{preprocessor}{\#ifdef\ HAVE\_THREADS}}
\DoxyCodeLine{00728\ \ \ \mbox{\hyperlink{classAsyncTaskManager}{AsyncTaskManager}}\ *task\_mgr\ =\ AsyncTaskManager::get\_global\_ptr();}
\DoxyCodeLine{00729\ \ \ \_async\_chain\ =\ task\_mgr-\/>make\_task\_chain(\textcolor{stringliteral}{"{}gl\_texture\_transfer"{}},}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gl\_texture\_transfer\_num\_threads,}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gl\_texture\_transfer\_thread\_priority);}
\DoxyCodeLine{00732\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{00735\ \ \ \textcolor{keywordflow}{if}\ (gl\_finish)\ \{}
\DoxyCodeLine{00736\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{00737\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}The\ config\ variable\ gl-\/finish\ is\ set\ to\ true.\ \ This\ may\ have\ a\ substantial\ negative\ impact\ on\ your\ render\ performance.\(\backslash\)n"{}};}
\DoxyCodeLine{00738\ \ \ \}}
\DoxyCodeLine{00739\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ DO\_PSTATS}}
\DoxyCodeLine{00740\ \}}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00745\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{00746\ \string~CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})()\ \{}
\DoxyCodeLine{00747\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{00748\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{00749\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GLGraphicsStateGuardian\ "{}}\ <<\ \textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\ destructing\(\backslash\)n"{}};}
\DoxyCodeLine{00750\ \ \ \}}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \textcolor{preprocessor}{\#ifdef\ HAVE\_THREADS}}
\DoxyCodeLine{00753\ \ \ \textcolor{comment}{//\ Make\ sure\ there\ are\ no\ more\ async\ tasks\ that\ could\ reference\ this\ GSG.}}
\DoxyCodeLine{00754\ \ \ \_async\_chain-\/>wait\_for\_tasks();}
\DoxyCodeLine{00755\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00756\ \ \ \{}
\DoxyCodeLine{00757\ \ \ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_job\_queue\_mutex);}
\DoxyCodeLine{00758\ \ \ \ \ \_job\_queue.clear();}
\DoxyCodeLine{00759\ \ \ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ close\_gsg();}
\DoxyCodeLine{00762\ \}}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00768\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{00769\ debug\_callback(GLenum\ source,\ GLenum\ type,\ GLuint\ id,\ GLenum\ severity,\ GLsizei\ length,\ const\ GLchar\ *message,\ GLvoid\ *userParam)\ \{}
\DoxyCodeLine{00770\ \ \ \textcolor{comment}{//\ Determine\ how\ to\ map\ the\ severity\ level.}}
\DoxyCodeLine{00771\ \ \ NotifySeverity\ level;}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{switch}\ (severity)\ \{}
\DoxyCodeLine{00773\ \ \ \textcolor{keywordflow}{case}\ GL\_DEBUG\_SEVERITY\_HIGH:}
\DoxyCodeLine{00774\ \ \ \ \ level\ =\ NS\_error;}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ \ \ \textcolor{keywordflow}{case}\ GL\_DEBUG\_SEVERITY\_MEDIUM:}
\DoxyCodeLine{00778\ \ \ \ \ \textcolor{keywordflow}{if}\ (type\ ==\ GL\_DEBUG\_TYPE\_PERFORMANCE)\ \{}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \textcolor{comment}{//\ Performance\ warnings\ should\ really\ be\ "{}info"{}.}}
\DoxyCodeLine{00780\ \ \ \ \ \ \ level\ =\ NS\_info;}
\DoxyCodeLine{00781\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00782\ \ \ \ \ \ \ level\ =\ NS\_warning;}
\DoxyCodeLine{00783\ \ \ \ \ \}}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \textcolor{keywordflow}{case}\ GL\_DEBUG\_SEVERITY\_LOW:}
\DoxyCodeLine{00787\ \ \ \ \ level\ =\ NS\_info;}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \ \ \textcolor{keywordflow}{case}\ GL\_DEBUG\_SEVERITY\_NOTIFICATION:}
\DoxyCodeLine{00791\ \ \ \ \ level\ =\ NS\_debug;}
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00794\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00795\ \ \ \ \ level\ =\ NS\_fatal;\ \textcolor{comment}{//???}}
\DoxyCodeLine{00796\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00797\ \ \ \}}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ \textcolor{keywordtype}{string}\ msg\_str(message,\ length);}
\DoxyCodeLine{00800\ \ \ GLCAT.out(level)\ <<\ msg\_str\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{00803\ \ \ \textcolor{keywordflow}{if}\ (level\ >=\ gl\_debug\_abort\_level.get\_value())\ \{}
\DoxyCodeLine{00804\ \ \ \ \ abort();}
\DoxyCodeLine{00805\ \ \ \}}
\DoxyCodeLine{00806\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00807\ \}}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00812\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{00813\ reset()\ \{}
\DoxyCodeLine{00814\ \ \ \_last\_error\_check\ =\ -\/1.0;}
\DoxyCodeLine{00815\ \ \ \_white\_texture\ =\ 0;}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \ \ free\_pointers();}
\DoxyCodeLine{00818\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian_ac11c772db1e7f8a61c012d196161ee80}{GraphicsStateGuardian::reset}}();}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \ \ \textcolor{comment}{//\ Build\ \_inv\_state\_mask\ as\ a\ mask\ of\ 1's\ where\ we\ don't\ care,\ and\ 0's\ where}}
\DoxyCodeLine{00821\ \ \ \textcolor{comment}{//\ we\ do\ care,\ about\ the\ state.}}
\DoxyCodeLine{00822\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00823\ \ \ \_inv\_state\_mask.clear\_bit(ShaderAttrib::get\_class\_slot());}
\DoxyCodeLine{00824\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00825\ \ \ \_inv\_state\_mask.clear\_bit(AntialiasAttrib::get\_class\_slot());}
\DoxyCodeLine{00826\ \ \ \_inv\_state\_mask.clear\_bit(ClipPlaneAttrib::get\_class\_slot());}
\DoxyCodeLine{00827\ \ \ \_inv\_state\_mask.clear\_bit(ColorAttrib::get\_class\_slot());}
\DoxyCodeLine{00828\ \ \ \_inv\_state\_mask.clear\_bit(ColorScaleAttrib::get\_class\_slot());}
\DoxyCodeLine{00829\ \ \ \_inv\_state\_mask.clear\_bit(CullFaceAttrib::get\_class\_slot());}
\DoxyCodeLine{00830\ \ \ \_inv\_state\_mask.clear\_bit(DepthBiasAttrib::get\_class\_slot());}
\DoxyCodeLine{00831\ \ \ \_inv\_state\_mask.clear\_bit(DepthOffsetAttrib::get\_class\_slot());}
\DoxyCodeLine{00832\ \ \ \_inv\_state\_mask.clear\_bit(DepthTestAttrib::get\_class\_slot());}
\DoxyCodeLine{00833\ \ \ \_inv\_state\_mask.clear\_bit(DepthWriteAttrib::get\_class\_slot());}
\DoxyCodeLine{00834\ \ \ \_inv\_state\_mask.clear\_bit(RenderModeAttrib::get\_class\_slot());}
\DoxyCodeLine{00835\ \ \ \_inv\_state\_mask.clear\_bit(TransparencyAttrib::get\_class\_slot());}
\DoxyCodeLine{00836\ \ \ \_inv\_state\_mask.clear\_bit(ColorWriteAttrib::get\_class\_slot());}
\DoxyCodeLine{00837\ \ \ \_inv\_state\_mask.clear\_bit(ColorBlendAttrib::get\_class\_slot());}
\DoxyCodeLine{00838\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ ||\ defined(OPENGLES\_1)}}
\DoxyCodeLine{00839\ \ \ \_inv\_state\_mask.clear\_bit(LogicOpAttrib::get\_class\_slot());}
\DoxyCodeLine{00840\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00841\ \ \ \_inv\_state\_mask.clear\_bit(TextureAttrib::get\_class\_slot());}
\DoxyCodeLine{00842\ \ \ \_inv\_state\_mask.clear\_bit(TexMatrixAttrib::get\_class\_slot());}
\DoxyCodeLine{00843\ \ \ \_inv\_state\_mask.clear\_bit(StencilAttrib::get\_class\_slot());}
\DoxyCodeLine{00844\ \ \ \_inv\_state\_mask.clear\_bit(ScissorAttrib::get\_class\_slot());}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ \textcolor{comment}{//\ We\ only\ care\ about\ this\ state\ if\ we\ are\ using\ the\ fixed-\/function\ pipeline.}}
\DoxyCodeLine{00847\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{00848\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{00849\ \ \ \ \ \_inv\_state\_mask.clear\_bit(AlphaTestAttrib::get\_class\_slot());}
\DoxyCodeLine{00850\ \ \ \ \ \_inv\_state\_mask.clear\_bit(RescaleNormalAttrib::get\_class\_slot());}
\DoxyCodeLine{00851\ \ \ \ \ \_inv\_state\_mask.clear\_bit(ShadeModelAttrib::get\_class\_slot());}
\DoxyCodeLine{00852\ \ \ \ \ \_inv\_state\_mask.clear\_bit(TexGenAttrib::get\_class\_slot());}
\DoxyCodeLine{00853\ \ \ \ \ \_inv\_state\_mask.clear\_bit(MaterialAttrib::get\_class\_slot());}
\DoxyCodeLine{00854\ \ \ \ \ \_inv\_state\_mask.clear\_bit(LightAttrib::get\_class\_slot());}
\DoxyCodeLine{00855\ \ \ \ \ \_inv\_state\_mask.clear\_bit(FogAttrib::get\_class\_slot());}
\DoxyCodeLine{00856\ \ \ \}}
\DoxyCodeLine{00857\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00858\ }
\DoxyCodeLine{00859\ \ \ \textcolor{comment}{//\ Output\ the\ vendor\ and\ version\ strings.}}
\DoxyCodeLine{00860\ \ \ query\_gl\_version();}
\DoxyCodeLine{00861\ }
\DoxyCodeLine{00862\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ ==\ 0)\ \{}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{comment}{//\ Couldn't\ get\ GL.\ \ Fail.}}
\DoxyCodeLine{00864\ \ \ \ \ mark\_new();}
\DoxyCodeLine{00865\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00866\ \ \ \}}
\DoxyCodeLine{00867\ }
\DoxyCodeLine{00868\ \ \ \textcolor{comment}{//\ Save\ the\ extensions\ tokens.}}
\DoxyCodeLine{00869\ \ \ \_extensions.clear();}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \ \textcolor{comment}{//\ In\ OpenGL\ (ES)\ 3.0\ and\ later,\ glGetString(GL\_EXTENSIONS)\ is\ deprecated.}}
\DoxyCodeLine{00872\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00873\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 3)\ \{}
\DoxyCodeLine{00874\ \ \ \ \ PFNGLGETSTRINGIPROC\ \_glGetStringi\ =}
\DoxyCodeLine{00875\ \ \ \ \ \ \ (PFNGLGETSTRINGIPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glGetStringi"{}});}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGetStringi\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ GLint\ n\ =\ 0;}
\DoxyCodeLine{00879\ \ \ \ \ \ \ glGetIntegerv(GL\_NUM\_EXTENSIONS,\ \&n);}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (GLint\ i\ =\ 0;\ i\ <\ n;\ ++i)\ \{}
\DoxyCodeLine{00881\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *extension\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)\_glGetStringi(GL\_EXTENSIONS,\ i);}
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ \_extensions.insert(\textcolor{keywordtype}{string}(extension));}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00884\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00885\ \ \ \ \ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}glGetStringi\ is\ not\ available!\(\backslash\)n"{}};}
\DoxyCodeLine{00886\ \ \ \ \ \ \ save\_extensions((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)glGetString(GL\_EXTENSIONS));}
\DoxyCodeLine{00887\ \ \ \ \ \}}
\DoxyCodeLine{00888\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00889\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00890\ \ \ \{}
\DoxyCodeLine{00891\ \ \ \ \ save\_extensions((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)glGetString(GL\_EXTENSIONS));}
\DoxyCodeLine{00892\ \ \ \}}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ get\_extra\_extensions();}
\DoxyCodeLine{00895\ }
\DoxyCodeLine{00896\ \ \ \textcolor{comment}{//\ This\ needs\ access\ to\ the\ extensions,\ so\ put\ this\ after\ save\_extensions.}}
\DoxyCodeLine{00897\ \ \ query\_glsl\_version();}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00900\ \ \ \textcolor{comment}{//\ Determine\ whether\ this\ OpenGL\ context\ has\ compatibility\ features.}}
\DoxyCodeLine{00901\ \ \ \textcolor{keywordtype}{bool}\ core\_profile\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00902\ }
\DoxyCodeLine{00903\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 3)\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >\ 3\ ||\ \_gl\_version\_minor\ >=\ 2)\ \{}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \textcolor{comment}{//\ OpenGL\ 3.2\ has\ a\ built-\/in\ way\ to\ check\ this.}}
\DoxyCodeLine{00906\ \ \ \ \ \ \ GLint\ profile\_mask\ =\ 0;}
\DoxyCodeLine{00907\ \ \ \ \ \ \ glGetIntegerv(GL\_CONTEXT\_PROFILE\_MASK,\ \&profile\_mask);}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (profile\_mask\ \&\ GL\_CONTEXT\_CORE\_PROFILE\_BIT)\ \{}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ core\_profile\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (profile\_mask\ \&\ GL\_CONTEXT\_COMPATIBILITY\_PROFILE\_BIT)\ \{}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ core\_profile\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ core\_profile\ =\ !has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_compatibility"{}});}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00916\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \textcolor{comment}{//\ OpenGL\ 3.0/3.1.}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ GLint\ flags\ =\ 0;}
\DoxyCodeLine{00919\ \ \ \ \ \ \ glGetIntegerv(GL\_CONTEXT\_FLAGS,\ \&flags);}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flags\ \&\ GL\_CONTEXT\_FLAG\_FORWARD\_COMPATIBLE\_BIT)\ \{}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ core\_profile\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00922\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00923\ \ \ \ \ \}}
\DoxyCodeLine{00924\ \ \ \}}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00926\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{00927\ \ \ \ \ \textcolor{keywordflow}{if}\ (core\_profile)\ \{}
\DoxyCodeLine{00928\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}Using\ core\ profile\(\backslash\)n"{}};}
\DoxyCodeLine{00929\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00930\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}Using\ compatibility\ profile\(\backslash\)n"{}};}
\DoxyCodeLine{00931\ \ \ \ \ \}}
\DoxyCodeLine{00932\ \ \ \}}
\DoxyCodeLine{00933\ \ \ \_core\_profile\ =\ core\_profile;}
\DoxyCodeLine{00934\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES\_1)}}
\DoxyCodeLine{00935\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ core\_profile\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00936\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00937\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ core\_profile\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00938\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ \ \ \textcolor{comment}{//\ Print\ out\ a\ list\ of\ all\ extensions.}}
\DoxyCodeLine{00941\ \ \ report\_extensions();}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{00944\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 3)\ \{}
\DoxyCodeLine{00945\ \ \ \ \ \_glGetIntegeri\_v\ =\ (PFNGLGETINTEGERI\_VPROC)}
\DoxyCodeLine{00946\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetIntegeri\_v"{}});}
\DoxyCodeLine{00947\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00948\ \ \ \ \ \_glGetIntegeri\_v\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00949\ \ \ \}}
\DoxyCodeLine{00950\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \ \ \textcolor{comment}{//\ Check\ if\ we\ are\ running\ under\ a\ profiling\ tool\ such\ as\ apitrace.}}
\DoxyCodeLine{00953\ \textcolor{preprocessor}{\#if\ !defined(NDEBUG)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{00954\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_debug\_marker"{}}))\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \_glPushGroupMarker\ =\ (PFNGLPUSHGROUPMARKEREXTPROC)}
\DoxyCodeLine{00956\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPushGroupMarkerEXT"{}});}
\DoxyCodeLine{00957\ \ \ \ \ \_glPopGroupMarker\ =\ (PFNGLPOPGROUPMARKEREXTPROC)}
\DoxyCodeLine{00958\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPopGroupMarkerEXT"{}});}
\DoxyCodeLine{00959\ }
\DoxyCodeLine{00960\ \ \ \ \ \textcolor{comment}{//\ Start\ a\ group\ right\ away.}}
\DoxyCodeLine{00961\ \ \ \ \ push\_group\_marker(\textcolor{stringliteral}{"{}reset"{}});}
\DoxyCodeLine{00962\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00963\ \ \ \ \ \_glPushGroupMarker\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00964\ \ \ \ \ \_glPopGroupMarker\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00965\ \ \ \}}
\DoxyCodeLine{00966\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00967\ }
\DoxyCodeLine{00968\ \ \ \textcolor{comment}{//\ Initialize\ OpenGL\ debugging\ output\ first,\ if\ enabled\ and\ supported.}}
\DoxyCodeLine{00969\ \ \ \_supports\_debug\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00970\ \ \ \_use\_object\_labels\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00971\ \ \ \textcolor{keywordflow}{if}\ (gl\_debug)\ \{}
\DoxyCodeLine{00972\ \ \ \ \ PFNGLDEBUGMESSAGECALLBACKPROC\_P\ \_glDebugMessageCallback;}
\DoxyCodeLine{00973\ \ \ \ \ PFNGLDEBUGMESSAGECONTROLPROC\ \_glDebugMessageControl;}
\DoxyCodeLine{00974\ }
\DoxyCodeLine{00975\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_KHR\_debug"{}}))\ \{}
\DoxyCodeLine{00976\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{00977\ \ \ \ \ \ \ \_glDebugMessageCallback\ =\ (PFNGLDEBUGMESSAGECALLBACKPROC\_P)}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageCallbackKHR"{}});}
\DoxyCodeLine{00979\ \ \ \ \ \ \ \_glDebugMessageControl\ =\ (PFNGLDEBUGMESSAGECONTROLPROC)}
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageControlKHR"{}});}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \_glObjectLabel\ =\ (PFNGLOBJECTLABELPROC)}
\DoxyCodeLine{00982\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glObjectLabelKHR"{}});}
\DoxyCodeLine{00983\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \_glDebugMessageCallback\ =\ (PFNGLDEBUGMESSAGECALLBACKPROC\_P)}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageCallback"{}});}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \_glDebugMessageControl\ =\ (PFNGLDEBUGMESSAGECONTROLPROC)}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageControl"{}});}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \_glObjectLabel\ =\ (PFNGLOBJECTLABELPROC)}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glObjectLabel"{}});}
\DoxyCodeLine{00990\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00991\ \ \ \ \ \ \ glEnable(GL\_DEBUG\_OUTPUT);\ \textcolor{comment}{//\ Not\ supported\ in\ ARB\ version}}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \_supports\_debug\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \_use\_object\_labels\ =\ gl\_debug\_object\_labels;}
\DoxyCodeLine{00994\ }
\DoxyCodeLine{00995\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{00996\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_debug\_output"{}}))\ \{}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \_glDebugMessageCallback\ =\ (PFNGLDEBUGMESSAGECALLBACKPROC\_P)}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageCallbackARB"{}});}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \_glDebugMessageControl\ =\ (PFNGLDEBUGMESSAGECONTROLPROC)}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDebugMessageControlARB"{}});}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \_supports\_debug\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01002\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01003\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \_supports\_debug\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01005\ \ \ \ \ \}}
\DoxyCodeLine{01006\ }
\DoxyCodeLine{01007\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_debug)\ \{}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ categories\ we\ want\ to\ listen\ to.}}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \_glDebugMessageControl(GL\_DONT\_CARE,\ GL\_DONT\_CARE,\ GL\_DEBUG\_SEVERITY\_HIGH,}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr},\ GLCAT.is\_error());}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \_glDebugMessageControl(GL\_DONT\_CARE,\ GL\_DONT\_CARE,\ GL\_DEBUG\_SEVERITY\_MEDIUM,}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr},\ GLCAT.is\_warning());}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \_glDebugMessageControl(GL\_DONT\_CARE,\ GL\_DONT\_CARE,\ GL\_DEBUG\_SEVERITY\_LOW,}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr},\ GLCAT.is\_info());}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \_glDebugMessageControl(GL\_DONT\_CARE,\ GL\_DONT\_CARE,\ GL\_DEBUG\_SEVERITY\_NOTIFICATION,}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr},\ GLCAT.is\_debug());}
\DoxyCodeLine{01017\ }
\DoxyCodeLine{01018\ \ \ \ \ \ \ \textcolor{comment}{//\ Enable\ the\ callback.}}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \_glDebugMessageCallback((GLDEBUGPROC\_P)\ \&debug\_callback,\ (\textcolor{keywordtype}{void}*)\textcolor{keyword}{this});}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_debug\_synchronous)\ \{}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ glEnable(GL\_DEBUG\_OUTPUT\_SYNCHRONOUS);}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ \ \ \ \ \ \ GLCAT.info()\ <<\ \textcolor{stringliteral}{"{}gl-\/debug\ enabled.\(\backslash\)n"{}};}
\DoxyCodeLine{01025\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01026\ \ \ \ \ \ \ GLCAT.warning()\ <<\ \textcolor{stringliteral}{"{}gl-\/debug\ enabled,\ but\ NOT\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{01027\ \ \ \ \ \}}
\DoxyCodeLine{01028\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01029\ \ \ \ \ \textcolor{comment}{//\ However,\ still\ check\ if\ it\ is\ supported.}}
\DoxyCodeLine{01030\ \ \ \ \ \_supports\_debug\ =\ is\_at\_least\_gl\_version(4,\ 3)}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_KHR\_debug"{}})}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_debug\_output"{}});}
\DoxyCodeLine{01033\ }
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_debug)\ \{}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}gl-\/debug\ supported,\ but\ NOT\ enabled.\(\backslash\)n"{}};}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}gl-\/debug\ disabled\ and\ unsupported.\(\backslash\)n"{}};}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01040\ \ \ \ \ \}}
\DoxyCodeLine{01041\ \ \ \}}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ \ \ \_supported\_geom\_rendering\ =}
\DoxyCodeLine{01044\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01045\ \ \ \ \ Geom::GR\_render\_mode\_point\ |}
\DoxyCodeLine{01046\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01047\ \ \ \ \ Geom::GR\_indexed\_point\ |}
\DoxyCodeLine{01048\ \ \ \ \ Geom::GR\_point\ |\ Geom::GR\_point\_uniform\_size\ |}
\DoxyCodeLine{01049\ \ \ \ \ Geom::GR\_indexed\_other\ |}
\DoxyCodeLine{01050\ \ \ \ \ Geom::GR\_triangle\_strip\ |\ Geom::GR\_triangle\_fan\ |}
\DoxyCodeLine{01051\ \ \ \ \ Geom::GR\_line\_strip\ |}
\DoxyCodeLine{01052\ \ \ \ \ Geom::GR\_flat\_last\_vertex;}
\DoxyCodeLine{01053\ }
\DoxyCodeLine{01054\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01055\ \ \ \textcolor{comment}{//\ Observed\ bug\ on\ PINEBOOK\ Pro:\ regular\ OpenGL\ 3.3\ driver\ doesn't\ support}}
\DoxyCodeLine{01056\ \ \ \textcolor{comment}{//\ wireframe\ mode,\ it\ just\ renders\ the\ solid\ mesh}}
\DoxyCodeLine{01057\ \ \ \textcolor{comment}{//\ GL\_RENDERER\ =\ Mali-\/T860\ (Panfrost)}}
\DoxyCodeLine{01058\ \ \ \textcolor{comment}{//\ GL\_VERSION\ =\ 3.3\ (Compatibility\ Profile)\ Mesa\ 22.3.6}}
\DoxyCodeLine{01059\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_vendor\ !=\ \textcolor{stringliteral}{"{}Panfrost"{}})\ \{}
\DoxyCodeLine{01060\ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_render\_mode\_wireframe;}
\DoxyCodeLine{01061\ \ \ \}}
\DoxyCodeLine{01062\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01063\ }
\DoxyCodeLine{01064\ \ \ \_supports\_point\_parameters\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01066\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01067\ \ \ \_glPointParameterfv\ =\ glPointParameterfv;}
\DoxyCodeLine{01068\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{01069\ \ \ \textcolor{comment}{//\ Other\ OpenGL\ ES\ versions\ don't\ support\ point\ parameters.}}
\DoxyCodeLine{01070\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01071\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 4))\ \{}
\DoxyCodeLine{01072\ \ \ \ \ \_supports\_point\_parameters\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01073\ \ \ \ \ \_glPointParameterfv\ =\ (PFNGLPOINTPARAMETERFVPROC)}
\DoxyCodeLine{01074\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPointParameterfv"{}});}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01076\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_point\_parameters"{}}))\ \{}
\DoxyCodeLine{01077\ \ \ \ \ \_supports\_point\_parameters\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01078\ \ \ \ \ \_glPointParameterfv\ =\ (PFNGLPOINTPARAMETERFVPROC)}
\DoxyCodeLine{01079\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPointParameterfvARB"{}});}
\DoxyCodeLine{01080\ \ \ \}}
\DoxyCodeLine{01081\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_point\_parameters)\ \{}
\DoxyCodeLine{01082\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glPointParameterfv\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01083\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glPointParameterfv\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \_supports\_point\_parameters\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01086\ \ \ \ \ \}}
\DoxyCodeLine{01087\ \ \ \}}
\DoxyCodeLine{01088\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_point\_parameters)\ \{}
\DoxyCodeLine{01089\ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_point\_perspective\ |\ Geom::GR\_point\_scale;}
\DoxyCodeLine{01090\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01091\ \ \ \ \ \_glPointParameterfv\ =\ null\_glPointParameterfv;}
\DoxyCodeLine{01092\ \ \ \}}
\DoxyCodeLine{01093\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_2}}
\DoxyCodeLine{01094\ }
\DoxyCodeLine{01095\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_2)}}
\DoxyCodeLine{01096\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 2\ doesn't\ have\ point\ sprites.}}
\DoxyCodeLine{01097\ \ \ \_supports\_point\_sprite\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01098\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES\_1)}}
\DoxyCodeLine{01099\ \ \ \_supports\_point\_sprite\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_point\_sprite"{}});}
\DoxyCodeLine{01100\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01101\ \ \ \_supports\_point\_sprite\ =\ is\_at\_least\_gl\_version(2,\ 0)\ ||}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_point\_sprite"{}});}
\DoxyCodeLine{01103\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01105\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_point\_sprite)\ \{}
\DoxyCodeLine{01106\ \ \ \ \ \textcolor{comment}{//\ It\ appears\ that\ the\ point\_sprite\ extension\ doesn't\ support\ texture}}
\DoxyCodeLine{01107\ \ \ \ \ \textcolor{comment}{//\ transforms\ on\ the\ generated\ texture\ coordinates.\ \ How\ inconsistent.}}
\DoxyCodeLine{01108\ \ \ \ \ \textcolor{comment}{//\ Because\ of\ this,\ we\ don't\ advertise\ GR\_point\_sprite\_tex\_matrix.}}
\DoxyCodeLine{01109\ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_point\_sprite;}
\DoxyCodeLine{01110\ \ \ \}}
\DoxyCodeLine{01111\ }
\DoxyCodeLine{01112\ \ \ \textcolor{comment}{//\ Determine\ whether\ we\ support\ wide\ lines\ (and\ how\ wide\ they\ can\ be).}}
\DoxyCodeLine{01113\ \ \ \{}
\DoxyCodeLine{01114\ \ \ \ \ GLfloat\ aliased\_range[2]\ =\ \{1.0f,\ 1.0f\};}
\DoxyCodeLine{01115\ \ \ \ \ glGetFloatv(GL\_ALIASED\_LINE\_WIDTH\_RANGE,\ aliased\_range);}
\DoxyCodeLine{01116\ }
\DoxyCodeLine{01117\ \ \ \ \ \_max\_line\_width\ =\ aliased\_range[1];}
\DoxyCodeLine{01118\ }
\DoxyCodeLine{01119\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01120\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{01121\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01122\ \ \ \ \ \ \ GLfloat\ range[2]\ =\ \{1.0f,\ 1.0f\};}
\DoxyCodeLine{01123\ \ \ \ \ \ \ glGetFloatv(GL\_LINE\_WIDTH\_RANGE,\ range);}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \_max\_line\_width\ =\ std::max(\_max\_line\_width,\ range[1]);}
\DoxyCodeLine{01125\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \ \ \ \ \ \ GLfloat\ smooth\_range[2]\ =\ \{1.0f,\ 1.0f\};}
\DoxyCodeLine{01128\ \ \ \ \ \ \ glGetFloatv(GL\_SMOOTH\_LINE\_WIDTH\_RANGE,\ smooth\_range);}
\DoxyCodeLine{01129\ \ \ \ \ \ \ \_max\_line\_width\ =\ std::max(\_max\_line\_width,\ smooth\_range[1]);}
\DoxyCodeLine{01130\ \ \ \ \ \}}
\DoxyCodeLine{01131\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01132\ \ \ \}}
\DoxyCodeLine{01133\ }
\DoxyCodeLine{01134\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01135\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 1.0\ does\ not\ support\ primitive\ restart\ indices.}}
\DoxyCodeLine{01136\ }
\DoxyCodeLine{01137\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{01138\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_primitive\_restart\_index\ \&\&\ is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01139\ \ \ \ \ \textcolor{comment}{//\ In\ WebGL\ 2,\ primitive\ restart\ is\ always\ enabled.}}
\DoxyCodeLine{01140\ \textcolor{preprocessor}{\#ifndef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{01141\ \ \ \ \ glEnable(GL\_PRIMITIVE\_RESTART\_FIXED\_INDEX);}
\DoxyCodeLine{01142\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01143\ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_strip\_cut\_index;}
\DoxyCodeLine{01144\ \ \ \}}
\DoxyCodeLine{01145\ }
\DoxyCodeLine{01146\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01147\ \ \ \_explicit\_primitive\_restart\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01148\ \ \ \_glPrimitiveRestartIndex\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01149\ }
\DoxyCodeLine{01150\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_primitive\_restart\_index)\ \{}
\DoxyCodeLine{01151\ \ \ \ \ \textcolor{keywordflow}{if}\ ((is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_ES3\_compatibility"{}}))\ \&\&}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \_gl\_renderer.substr(0,\ 7)\ !=\ \textcolor{stringliteral}{"{}Gallium"{}})\ \{}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \textcolor{comment}{//\ As\ long\ as\ we\ enable\ this,\ OpenGL\ will\ always\ use\ the\ highest}}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \textcolor{comment}{//\ possible\ index\ for\ a\ numeric\ type\ as\ strip\ cut\ index,\ which\ coincides}}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \textcolor{comment}{//\ with\ our\ convention.\ \ This\ saves\ us\ a\ call\ to\ glPrimitiveRestartIndex}}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \textcolor{comment}{//\ ...\ of\ course,\ though,\ the\ Gallium\ driver\ bugs\ out\ here.\ \ See\ also:}}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \textcolor{comment}{//\ https://www.panda3d.org/forums/viewtopic.php?f=5\&t=17512}}
\DoxyCodeLine{01158\ \ \ \ \ \ \ glEnable(GL\_PRIMITIVE\_RESTART\_FIXED\_INDEX);}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_strip\_cut\_index;}
\DoxyCodeLine{01160\ }
\DoxyCodeLine{01161\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 1))\ \{}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ use\ an\ explicit\ primitive\ restart\ enableindex.}}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \_explicit\_primitive\_restart\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_strip\_cut\_index;}
\DoxyCodeLine{01165\ }
\DoxyCodeLine{01166\ \ \ \ \ \ \ \_glPrimitiveRestartIndex\ =\ (PFNGLPRIMITIVERESTARTINDEXPROC)}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPrimitiveRestartIndex"{}});}
\DoxyCodeLine{01168\ }
\DoxyCodeLine{01169\ \ \ \ \ \}}
\DoxyCodeLine{01170\ \ \ \}}
\DoxyCodeLine{01171\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ \&\&\ defined(SUPPORT\_FIXED\_FUNCTION)}}
\DoxyCodeLine{01174\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ is\_at\_least\_gl\_version(1,\ 4))\ \{}
\DoxyCodeLine{01175\ \ \ \ \ \_glSecondaryColorPointer\ =\ (PFNGLSECONDARYCOLORPOINTERPROC)}
\DoxyCodeLine{01176\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glSecondaryColorPointer"{}});}
\DoxyCodeLine{01177\ }
\DoxyCodeLine{01178\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_secondary\_color"{}}))\ \{}
\DoxyCodeLine{01179\ \ \ \ \ \_glSecondaryColorPointer\ =\ (PFNGLSECONDARYCOLORPOINTERPROC)}
\DoxyCodeLine{01180\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glSecondaryColorPointerEXT"{}});}
\DoxyCodeLine{01181\ \ \ \}}
\DoxyCodeLine{01182\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{01185\ \ \ \_glDrawRangeElements\ =\ null\_glDrawRangeElements;}
\DoxyCodeLine{01186\ }
\DoxyCodeLine{01187\ \ \ \textcolor{comment}{//\ Temporarily\ disabled\ in\ WebGL\ due\ to\ Firefox\ bug}}
\DoxyCodeLine{01188\ \textcolor{preprocessor}{\#ifndef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{01189\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01190\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01191\ \ \ \ \ \_glDrawRangeElements\ =\ (PFNGLDRAWRANGEELEMENTSPROC)}
\DoxyCodeLine{01192\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawRangeElements"{}});}
\DoxyCodeLine{01193\ \ \ \}}
\DoxyCodeLine{01194\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01195\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2))\ \{}
\DoxyCodeLine{01196\ \ \ \ \ \_glDrawRangeElements\ =\ (PFNGLDRAWRANGEELEMENTSPROC)}
\DoxyCodeLine{01197\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawRangeElements"{}});}
\DoxyCodeLine{01198\ }
\DoxyCodeLine{01199\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_draw\_range\_elements"{}}))\ \{}
\DoxyCodeLine{01200\ \ \ \ \ \_glDrawRangeElements\ =\ (PFNGLDRAWRANGEELEMENTSPROC)}
\DoxyCodeLine{01201\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawRangeElementsEXT"{}});}
\DoxyCodeLine{01202\ \ \ \}}
\DoxyCodeLine{01203\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01204\ \ \ \textcolor{keywordflow}{if}\ (\_glDrawRangeElements\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01205\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01206\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDrawRangeElements\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01207\ \ \ \ \ \_glDrawRangeElements\ =\ null\_glDrawRangeElements;}
\DoxyCodeLine{01208\ \ \ \}}
\DoxyCodeLine{01209\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !\_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{01210\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{01211\ }
\DoxyCodeLine{01212\ \ \ \_supports\_3d\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01213\ }
\DoxyCodeLine{01214\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{01215\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01216\ \ \ \ \ \_supports\_3d\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \ \ \_glTexImage3D\ =\ (PFNGLTEXIMAGE3DPROC\_P)}
\DoxyCodeLine{01219\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexImage3D"{}});}
\DoxyCodeLine{01220\ \ \ \ \ \_glTexSubImage3D\ =\ (PFNGLTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01221\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexSubImage3D"{}});}
\DoxyCodeLine{01222\ \ \ \ \ \_glCopyTexSubImage3D\ =\ (PFNGLCOPYTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01223\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCopyTexSubImage3D"{}});}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01225\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01226\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture3D"{}}))\ \{}
\DoxyCodeLine{01227\ \ \ \ \ \_supports\_3d\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01228\ }
\DoxyCodeLine{01229\ \ \ \ \ \_glTexImage3D\ =\ (PFNGLTEXIMAGE3DPROC\_P)}
\DoxyCodeLine{01230\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexImage3DEXT"{}});}
\DoxyCodeLine{01231\ \ \ \ \ \_glTexSubImage3D\ =\ (PFNGLTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01232\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexSubImage3DEXT"{}});}
\DoxyCodeLine{01233\ }
\DoxyCodeLine{01234\ \ \ \ \ \_glCopyTexSubImage3D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01235\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_copy\_texture"{}}))\ \{}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \_glCopyTexSubImage3D\ =\ (PFNGLCOPYTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCopyTexSubImage3DEXT"{}});}
\DoxyCodeLine{01238\ \ \ \ \ \}}
\DoxyCodeLine{01239\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01240\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_3D"{}}))\ \{}
\DoxyCodeLine{01241\ \ \ \ \ \_supports\_3d\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01242\ }
\DoxyCodeLine{01243\ \ \ \ \ \_glTexImage3D\ =\ (PFNGLTEXIMAGE3DPROC\_P)}
\DoxyCodeLine{01244\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexImage3DOES"{}});}
\DoxyCodeLine{01245\ \ \ \ \ \_glTexSubImage3D\ =\ (PFNGLTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01246\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexSubImage3DOES"{}});}
\DoxyCodeLine{01247\ \ \ \ \ \_glCopyTexSubImage3D\ =\ (PFNGLCOPYTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01248\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCopyTexSubImage3DOES"{}});}
\DoxyCodeLine{01249\ \ \ \ \ \_glFramebufferTexture3D\ =\ (PFNGLFRAMEBUFFERTEXTURE3DOES)}
\DoxyCodeLine{01250\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture3DOES"{}});}
\DoxyCodeLine{01251\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01252\ \ \ \}}
\DoxyCodeLine{01253\ }
\DoxyCodeLine{01254\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{01255\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glTexImage3D\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glTexSubImage3D\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01256\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}3-\/D\ textures\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \_supports\_3d\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01259\ \ \ \ \ \}}
\DoxyCodeLine{01260\ \ \ \}}
\DoxyCodeLine{01261\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{01262\ }
\DoxyCodeLine{01263\ \ \ \_supports\_tex\_storage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01264\ }
\DoxyCodeLine{01265\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01266\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01267\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01268\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_storage"{}}))\ \{}
\DoxyCodeLine{01269\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01270\ \ \ \ \ \_supports\_tex\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01271\ }
\DoxyCodeLine{01272\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01273\ \ \ \ \ \_glTexStorage1D\ =\ (PFNGLTEXSTORAGE1DPROC)}
\DoxyCodeLine{01274\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexStorage1D"{}});}
\DoxyCodeLine{01275\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01276\ \ \ \ \ \_glTexStorage2D\ =\ (PFNGLTEXSTORAGE2DPROC)}
\DoxyCodeLine{01277\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexStorage2D"{}});}
\DoxyCodeLine{01278\ \ \ \ \ \_glTexStorage3D\ =\ (PFNGLTEXSTORAGE3DPROC)}
\DoxyCodeLine{01279\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexStorage3D"{}});}
\DoxyCodeLine{01280\ \ \ \}}
\DoxyCodeLine{01281\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01282\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_storage"{}}))\ \{}
\DoxyCodeLine{01283\ \ \ \ \ \_supports\_tex\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01284\ }
\DoxyCodeLine{01285\ \ \ \ \ \_glTexStorage2D\ =\ (PFNGLTEXSTORAGE2DPROC)}
\DoxyCodeLine{01286\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexStorage2DEXT"{}});}
\DoxyCodeLine{01287\ \ \ \ \ \_glTexStorage3D\ =\ (PFNGLTEXSTORAGE3DPROC)}
\DoxyCodeLine{01288\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTexStorage3DEXT"{}});}
\DoxyCodeLine{01289\ \ \ \}}
\DoxyCodeLine{01290\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01291\ }
\DoxyCodeLine{01292\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_tex\_storage)\ \{}
\DoxyCodeLine{01293\ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{01294\ \#ifndef\ OPENGLES}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \_glTexStorage1D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01296\ \#endif}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \_glTexStorage2D\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glTexStorage3D\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01298\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Immutable\ texture\ storage\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \_supports\_tex\_storage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01301\ \ \ \ \ \}}
\DoxyCodeLine{01302\ \ \ \}}
\DoxyCodeLine{01303\ }
\DoxyCodeLine{01304\ \ \ \_supports\_clear\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01305\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01306\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 4)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_clear\_texture"{}}))\ \{}
\DoxyCodeLine{01307\ \ \ \ \ \_glClearTexImage\ =\ (PFNGLCLEARTEXIMAGEPROC)}
\DoxyCodeLine{01308\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearTexImage"{}});}
\DoxyCodeLine{01309\ \ \ \ \ \_glClearTexSubImage\ =\ (PFNGLCLEARTEXSUBIMAGEPROC)}
\DoxyCodeLine{01310\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearTexSubImage"{}});}
\DoxyCodeLine{01311\ }
\DoxyCodeLine{01312\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glClearTexImage\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glClearTexSubImage\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01313\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_ARB\_clear\_texture\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01315\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \_supports\_clear\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01317\ \ \ \ \ \}}
\DoxyCodeLine{01318\ \ \ \}}
\DoxyCodeLine{01319\ \textcolor{preprocessor}{\#elif\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{01320\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_clear\_texture"{}}))\ \{}
\DoxyCodeLine{01321\ \ \ \ \ \_glClearTexImage\ =\ (PFNGLCLEARTEXIMAGEEXTPROC)}
\DoxyCodeLine{01322\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearTexImageEXT"{}});}
\DoxyCodeLine{01323\ \ \ \ \ \_glClearTexSubImage\ =\ (PFNGLCLEARTEXSUBIMAGEEXTPROC)}
\DoxyCodeLine{01324\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearTexSubImageEXT"{}});}
\DoxyCodeLine{01325\ }
\DoxyCodeLine{01326\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glClearTexImage\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glClearTexSubImage\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01327\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_EXT\_clear\_texture\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01329\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \_supports\_clear\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01331\ \ \ \ \ \}}
\DoxyCodeLine{01332\ \ \ \}}
\DoxyCodeLine{01333\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01335\ \ \ \_supports\_clear\_buffer\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01336\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01337\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_clear\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{01338\ \ \ \ \ \_glClearBufferData\ =\ (PFNGLCLEARBUFFERDATAPROC)}
\DoxyCodeLine{01339\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearBufferData"{}});}
\DoxyCodeLine{01340\ }
\DoxyCodeLine{01341\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glClearBufferData\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01342\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_ARB\_clear\_buffer\_object\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{01344\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \_supports\_clear\_buffer\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01346\ \ \ \ \ \}}
\DoxyCodeLine{01347\ \ \ \}}
\DoxyCodeLine{01348\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01349\ }
\DoxyCodeLine{01350\ \ \ \_supports\_2d\_texture\_array\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01351\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{01352\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 3)\ \{}
\DoxyCodeLine{01353\ \ \ \ \ \_supports\_2d\_texture\_array\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01354\ }
\DoxyCodeLine{01355\ \ \ \ \ \_glFramebufferTextureLayer\ =\ (PFNGLFRAMEBUFFERTEXTURELAYERPROC)}
\DoxyCodeLine{01356\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTextureLayer"{}});}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01359\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_array"{}}))\ \{}
\DoxyCodeLine{01360\ \ \ \ \ \_supports\_2d\_texture\_array\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01362\ \ \ \ \ \_glFramebufferTextureLayer\ =\ (PFNGLFRAMEBUFFERTEXTURELAYERPROC)}
\DoxyCodeLine{01363\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTextureLayerEXT"{}});}
\DoxyCodeLine{01364\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01365\ \ \ \}}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01367\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_2d\_texture\_array\ \&\&\ \_glFramebufferTextureLayer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01368\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01369\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ arrays\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointer\ to\ glFramebufferTextureLayer\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{01370\ \ \ \}}
\DoxyCodeLine{01371\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{01372\ }
\DoxyCodeLine{01373\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{01374\ \ \ \_supports\_cube\_map\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01375\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01376\ \ \ \_supports\_cube\_map\ =}
\DoxyCodeLine{01377\ \ \ \ \ is\_at\_least\_gl\_version(1,\ 3)\ ||}
\DoxyCodeLine{01378\ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_cube\_map"{}})\ ||}
\DoxyCodeLine{01379\ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_cube\_map"{}});}
\DoxyCodeLine{01380\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01381\ }
\DoxyCodeLine{01382\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01383\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map\ \&\&\ gl\_cube\_map\_seamless)\ \{}
\DoxyCodeLine{01384\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_seamless\_cube\_map"{}}))\ \{}
\DoxyCodeLine{01385\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_CUBE\_MAP\_SEAMLESS);}
\DoxyCodeLine{01386\ \ \ \ \ \}}
\DoxyCodeLine{01387\ \ \ \}}
\DoxyCodeLine{01388\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01389\ }
\DoxyCodeLine{01390\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01391\ \ \ \_supports\_cube\_map\_array\ =\ is\_at\_least\_gl\_version(4,\ 0)\ ||}
\DoxyCodeLine{01392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_cube\_map\_array"{}});}
\DoxyCodeLine{01393\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01394\ }
\DoxyCodeLine{01395\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01396\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 1))\ \{}
\DoxyCodeLine{01397\ \ \ \ \ \_glTexBuffer\ =\ (PFNGLTEXBUFFERPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glTexBuffer"{}});}
\DoxyCodeLine{01398\ \ \ \ \ \_supports\_buffer\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01399\ }
\DoxyCodeLine{01400\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{01401\ \ \ \ \ \_glTexBuffer\ =\ (PFNGLTEXBUFFERPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glTexBufferARB"{}});}
\DoxyCodeLine{01402\ \ \ \ \ \_supports\_buffer\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01403\ \ \ \}}
\DoxyCodeLine{01404\ \textcolor{preprocessor}{\#elif\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{01405\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 2))\ \{}
\DoxyCodeLine{01406\ \ \ \ \ \_glTexBuffer\ =\ (PFNGLTEXBUFFERPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glTexBuffer"{}});}
\DoxyCodeLine{01407\ \ \ \ \ \_supports\_buffer\_texture\ =\ (\_glTexBuffer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01408\ \ \ \}}
\DoxyCodeLine{01409\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_buffer"{}}))\ \{}
\DoxyCodeLine{01410\ \ \ \ \ \_glTexBuffer\ =\ (PFNGLTEXBUFFERPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glTexBufferOES"{}});}
\DoxyCodeLine{01411\ \ \ \ \ \_supports\_buffer\_texture\ =\ (\_glTexBuffer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01412\ \ \ \}}
\DoxyCodeLine{01413\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01414\ }
\DoxyCodeLine{01415\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01416\ \ \ \_supports\_texture\_srgb\ =}
\DoxyCodeLine{01417\ \ \ \ \ is\_at\_least\_gles\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_sRGB"{}});}
\DoxyCodeLine{01418\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01419\ \ \ \_supports\_texture\_srgb\ =}
\DoxyCodeLine{01420\ \ \ \ \ is\_at\_least\_gl\_version(2,\ 1)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_sRGB"{}});}
\DoxyCodeLine{01421\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01423\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01424\ \ \ \_supports\_compressed\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01425\ }
\DoxyCodeLine{01426\ \ \ \textcolor{comment}{//\ Supported\ in\ the\ core.\ \ 1D\ textures\ are\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{01427\ \ \ \_glCompressedTexImage1D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01428\ \ \ \_glCompressedTexImage2D\ =\ glCompressedTexImage2D;}
\DoxyCodeLine{01429\ \ \ \_glCompressedTexSubImage1D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01430\ \ \ \_glCompressedTexSubImage2D\ =\ glCompressedTexSubImage2D;}
\DoxyCodeLine{01431\ \ \ \_glGetCompressedTexImage\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01432\ }
\DoxyCodeLine{01433\ \ \ \_glCompressedTexImage3D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01434\ \ \ \_glCompressedTexSubImage3D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01435\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{01436\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{01437\ \ \ \ \ \_glCompressedTexImage3D\ =\ (PFNGLCOMPRESSEDTEXIMAGE3DPROC)}
\DoxyCodeLine{01438\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage3DOES"{}});}
\DoxyCodeLine{01439\ \ \ \ \ \_glCompressedTexSubImage3D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01440\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImageOES"{}});}
\DoxyCodeLine{01441\ \ \ \}}
\DoxyCodeLine{01442\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01443\ }
\DoxyCodeLine{01444\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01445\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 3))\ \{}
\DoxyCodeLine{01446\ \ \ \ \ \_supports\_compressed\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01447\ }
\DoxyCodeLine{01448\ \ \ \ \ \_glCompressedTexImage1D\ =\ (PFNGLCOMPRESSEDTEXIMAGE1DPROC)}
\DoxyCodeLine{01449\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage1D"{}});}
\DoxyCodeLine{01450\ \ \ \ \ \_glCompressedTexImage2D\ =\ (PFNGLCOMPRESSEDTEXIMAGE2DPROC)}
\DoxyCodeLine{01451\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage2D"{}});}
\DoxyCodeLine{01452\ \ \ \ \ \_glCompressedTexImage3D\ =\ (PFNGLCOMPRESSEDTEXIMAGE3DPROC)}
\DoxyCodeLine{01453\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage3D"{}});}
\DoxyCodeLine{01454\ \ \ \ \ \_glCompressedTexSubImage1D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE1DPROC)}
\DoxyCodeLine{01455\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage1D"{}});}
\DoxyCodeLine{01456\ \ \ \ \ \_glCompressedTexSubImage2D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE2DPROC)}
\DoxyCodeLine{01457\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage2D"{}});}
\DoxyCodeLine{01458\ \ \ \ \ \_glCompressedTexSubImage3D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01459\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage3D"{}});}
\DoxyCodeLine{01460\ \ \ \ \ \_glGetCompressedTexImage\ =\ (PFNGLGETCOMPRESSEDTEXIMAGEPROC)}
\DoxyCodeLine{01461\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetCompressedTexImage"{}});}
\DoxyCodeLine{01462\ }
\DoxyCodeLine{01463\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_compression"{}}))\ \{}
\DoxyCodeLine{01464\ \ \ \ \ \_supports\_compressed\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \ \ \_glCompressedTexImage1D\ =\ (PFNGLCOMPRESSEDTEXIMAGE1DPROC)}
\DoxyCodeLine{01467\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage1DARB"{}});}
\DoxyCodeLine{01468\ \ \ \ \ \_glCompressedTexImage2D\ =\ (PFNGLCOMPRESSEDTEXIMAGE2DPROC)}
\DoxyCodeLine{01469\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage2DARB"{}});}
\DoxyCodeLine{01470\ \ \ \ \ \_glCompressedTexImage3D\ =\ (PFNGLCOMPRESSEDTEXIMAGE3DPROC)}
\DoxyCodeLine{01471\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexImage3DARB"{}});}
\DoxyCodeLine{01472\ \ \ \ \ \_glCompressedTexSubImage1D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE1DPROC)}
\DoxyCodeLine{01473\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage1DARB"{}});}
\DoxyCodeLine{01474\ \ \ \ \ \_glCompressedTexSubImage2D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE2DPROC)}
\DoxyCodeLine{01475\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage2DARB"{}});}
\DoxyCodeLine{01476\ \ \ \ \ \_glCompressedTexSubImage3D\ =\ (PFNGLCOMPRESSEDTEXSUBIMAGE3DPROC)}
\DoxyCodeLine{01477\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompressedTexSubImage3DARB"{}});}
\DoxyCodeLine{01478\ \ \ \ \ \_glGetCompressedTexImage\ =\ (PFNGLGETCOMPRESSEDTEXIMAGEPROC)}
\DoxyCodeLine{01479\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetCompressedTexImageARB"{}});}
\DoxyCodeLine{01480\ }
\DoxyCodeLine{01481\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01482\ \ \ \ \ \_supports\_compressed\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01483\ \ \ \}}
\DoxyCodeLine{01484\ }
\DoxyCodeLine{01485\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_compressed\_texture)\ \{}
\DoxyCodeLine{01486\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glCompressedTexImage1D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \_glCompressedTexImage2D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \_glCompressedTexImage3D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage1D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage2D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage3D\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ \_glGetCompressedTexImage\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01493\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Compressed\ textures\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \_supports\_compressed\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01496\ \ \ \ \ \}}
\DoxyCodeLine{01497\ \ \ \}}
\DoxyCodeLine{01498\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01499\ }
\DoxyCodeLine{01500\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_compressed\_texture)\ \{}
\DoxyCodeLine{01501\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01502\ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_on);}
\DoxyCodeLine{01503\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01504\ }
\DoxyCodeLine{01505\ \ \ \ \ GLint\ num\_compressed\_formats\ =\ 0;}
\DoxyCodeLine{01506\ \ \ \ \ glGetIntegerv(GL\_NUM\_COMPRESSED\_TEXTURE\_FORMATS,\ \&num\_compressed\_formats);}
\DoxyCodeLine{01507\ \ \ \ \ GLint\ *formats\ =\ (GLint\ *)alloca(num\_compressed\_formats\ *\ \textcolor{keyword}{sizeof}(GLint));}
\DoxyCodeLine{01508\ \ \ \ \ glGetIntegerv(GL\_COMPRESSED\_TEXTURE\_FORMATS,\ formats);}
\DoxyCodeLine{01509\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_compressed\_formats;\ ++i)\ \{}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (formats[i])\ \{}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_dxt1);}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01515\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_pvr1\_2bpp);}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_pvr1\_4bpp);}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01524\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01525\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT:}
\DoxyCodeLine{01526\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_dxt3);}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01528\ }
\DoxyCodeLine{01529\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT:}
\DoxyCodeLine{01530\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_dxt5);}
\DoxyCodeLine{01531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX:}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX:}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_fxt1);}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01537\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01538\ }
\DoxyCodeLine{01539\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_R11\_EAC:}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RG11\_EAC:}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_eac);}
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01543\ }
\DoxyCodeLine{01544\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB8\_ETC2:}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2:}
\DoxyCodeLine{01546\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA8\_ETC2\_EAC:}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_etc1);}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_etc2);}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_ETC1\_RGB8\_OES:}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_etc1);}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01555\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01556\ }
\DoxyCodeLine{01557\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01560\ \ \ \ \ \}}
\DoxyCodeLine{01561\ }
\DoxyCodeLine{01562\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01563\ \ \ \ \ \textcolor{comment}{//\ The\ OpenGL\ spec\ states\ that\ these\ are\ not\ reported\ by\ the\ above}}
\DoxyCodeLine{01564\ \ \ \ \ \textcolor{comment}{//\ mechanism,\ so\ we\ have\ to\ check\ for\ the\ extension\ ourselves.}}
\DoxyCodeLine{01565\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0)\ ||}
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_compression\_rgtc"{}})\ ||}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_compression\_rgtc"{}}))\ \{}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \_compressed\_texture\_formats.set\_bit(Texture::CM\_rgtc);}
\DoxyCodeLine{01569\ \ \ \ \ \}}
\DoxyCodeLine{01570\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01571\ \ \ \}}
\DoxyCodeLine{01572\ }
\DoxyCodeLine{01573\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01574\ \ \ \textcolor{comment}{//\ Note\ that\ these\ extensions\ only\ offer\ support\ for\ GL\_BGRA,\ not\ GL\_BGR.}}
\DoxyCodeLine{01575\ \ \ \_supports\_bgr\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_format\_BGRA8888"{}})\ ||}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_APPLE\_texture\_format\_BGRA8888"{}});}
\DoxyCodeLine{01577\ \ \ \_supports\_bgra\_read\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_read\_format\_bgra"{}});}
\DoxyCodeLine{01578\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01579\ \ \ \textcolor{comment}{//\ In\ regular\ OpenGL,\ we\ have\ both\ GL\_BGRA\ and\ GL\_BGR.}}
\DoxyCodeLine{01580\ \ \ \_supports\_bgr\ =}
\DoxyCodeLine{01581\ \ \ \ \ is\_at\_least\_gl\_version(1,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_bgra"{}});}
\DoxyCodeLine{01582\ \ \ \_supports\_bgra\_read\ =\ \_supports\_bgr;}
\DoxyCodeLine{01583\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01586\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01587\ \ \ \_supports\_rescale\_normal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01588\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01589\ \ \ \_supports\_rescale\_normal\ =}
\DoxyCodeLine{01590\ \ \ \ \ has\_fixed\_function\_pipeline()\ \&\&\ gl\_support\_rescale\_normal\ \&\&}
\DoxyCodeLine{01591\ \ \ \ \ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_rescale\_normal"{}}));}
\DoxyCodeLine{01592\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01593\ }
\DoxyCodeLine{01594\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01595\ \ \ \_use\_separate\_specular\_color\ =}
\DoxyCodeLine{01596\ \ \ \ \ has\_fixed\_function\_pipeline()\ \&\&\ gl\_separate\_specular\_color\ \&\&}
\DoxyCodeLine{01597\ \ \ \ \ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_separate\_specular\_color"{}}));}
\DoxyCodeLine{01598\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01599\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01600\ }
\DoxyCodeLine{01601\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01602\ \ \ \_supports\_packed\_dabc\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01603\ \ \ \_supports\_packed\_ufloat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01604\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01605\ \ \ \_supports\_packed\_dabc\ =\ (is\_at\_least\_gl\_version(3,\ 2)\ ||}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_array\_bgra"{}})\ ||}
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_vertex\_array\_bgra"{}}))\ \&\&\ gl\_support\_vertex\_array\_bgra;}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \ \ \_supports\_packed\_ufloat\ =\ is\_at\_least\_gl\_version(4,\ 4)\ ||}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_type\_10f\_11f\_11f\_rev"{}});}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_packed\_dabc)\ \{}
\DoxyCodeLine{01613\ \ \ \ \ \textcolor{keywordtype}{int}\ number\ =\ 0;}
\DoxyCodeLine{01614\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_gl\_renderer.compare(0,\ 14,\ \textcolor{stringliteral}{"{}AMD\ Radeon\ RX\ "{}})\ ==\ 0)\ \{}
\DoxyCodeLine{01615\ \ \ \ \ \ \ number\ =\ atoi(\_gl\_renderer.c\_str()\ +\ 14);}
\DoxyCodeLine{01616\ \ \ \ \ \}}
\DoxyCodeLine{01617\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_gl\_renderer.compare(0,\ 10,\ \textcolor{stringliteral}{"{}Radeon\ RX\ "{}})\ ==\ 0)\ \{}
\DoxyCodeLine{01618\ \ \ \ \ \ \ number\ =\ atoi(\_gl\_renderer.c\_str()\ +\ 10);}
\DoxyCodeLine{01619\ \ \ \ \ \}}
\DoxyCodeLine{01620\ }
\DoxyCodeLine{01621\ \ \ \ \ \textcolor{comment}{//\ This\ is\ buggy\ for\ RDNA\ cards.\ \ Verified\ on\ 5700\ XT,\ reportedly\ also}}
\DoxyCodeLine{01622\ \ \ \ \ \textcolor{comment}{//\ occurs\ on\ the\ entire\ 5*00\ and\ 6*00\ line.}}
\DoxyCodeLine{01623\ \ \ \ \ \textcolor{keywordflow}{if}\ (number\ >=\ 5000\ \&\&\ number\ <\ 8000)\ \{}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \_supports\_packed\_dabc\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01625\ }
\DoxyCodeLine{01626\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{01628\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Detected\ AMD\ Radeon\ RX\ "{}}\ <<\ number}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ disabling\ use\ of\ GL\_BGRA\ vertex\ attributes\(\backslash\)n"{}};}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01631\ \ \ \ \ \}}
\DoxyCodeLine{01632\ \ \ \}}
\DoxyCodeLine{01633\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01634\ }
\DoxyCodeLine{01635\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01636\ \ \ \textcolor{comment}{//TODO}}
\DoxyCodeLine{01637\ \ \ \_supports\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01638\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01639\ \ \ \_supports\_multisample\ =}
\DoxyCodeLine{01640\ \ \ \ \ is\_at\_least\_gl\_version(1,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_multisample"{}});}
\DoxyCodeLine{01641\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01642\ }
\DoxyCodeLine{01643\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01644\ \ \ \_supports\_generate\_mipmap\ =\ is\_at\_least\_gles\_version(1,\ 1);}
\DoxyCodeLine{01645\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{01646\ \ \ \_supports\_generate\_mipmap\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01647\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01648\ \ \ \_supports\_generate\_mipmap\ =\ is\_at\_least\_gl\_version(1,\ 4)\ ||}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_SGIS\_generate\_mipmap"{}});}
\DoxyCodeLine{01650\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01651\ }
\DoxyCodeLine{01652\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01653\ \ \ \_supports\_tex\_non\_pow2\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01654\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{01655\ \ \ \_supports\_tex\_non\_pow2\ =\ is\_at\_least\_gles\_version(3,\ 0)\ ||}
\DoxyCodeLine{01656\ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_npot"{}});}
\DoxyCodeLine{01657\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01658\ \ \ \_supports\_tex\_non\_pow2\ =\ is\_at\_least\_gl\_version(2,\ 0)\ ||}
\DoxyCodeLine{01659\ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_non\_power\_of\_two"{}});}
\DoxyCodeLine{01660\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01661\ }
\DoxyCodeLine{01662\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{01663\ \ \ \textcolor{keywordtype}{bool}\ supports\_multitexture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01664\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 3)\ ||\ is\_at\_least\_gles\_version(1,\ 1))\ \{}
\DoxyCodeLine{01665\ \ \ \ \ supports\_multitexture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01666\ }
\DoxyCodeLine{01667\ \ \ \ \ \_glActiveTexture\ =\ (PFNGLACTIVETEXTUREPROC)}
\DoxyCodeLine{01668\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glActiveTexture"{}});}
\DoxyCodeLine{01669\ }
\DoxyCodeLine{01670\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01671\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \_glClientActiveTexture\ =\ (PFNGLACTIVETEXTUREPROC)}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClientActiveTexture"{}});}
\DoxyCodeLine{01674\ \ \ \ \ \}}
\DoxyCodeLine{01675\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01676\ }
\DoxyCodeLine{01677\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{01678\ \ \ \ \ \_glMultiTexCoord1f\ =\ (PFNGLMULTITEXCOORD1FPROC)}
\DoxyCodeLine{01679\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord1f"{}});}
\DoxyCodeLine{01680\ \ \ \ \ \_glMultiTexCoord2f\ =\ (PFNGLMULTITEXCOORD2FPROC)}
\DoxyCodeLine{01681\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord2f"{}});}
\DoxyCodeLine{01682\ \ \ \ \ \_glMultiTexCoord3f\ =\ (PFNGLMULTITEXCOORD3FPROC)}
\DoxyCodeLine{01683\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord3f"{}});}
\DoxyCodeLine{01684\ \ \ \ \ \_glMultiTexCoord4f\ =\ (PFNGLMULTITEXCOORD4FPROC)}
\DoxyCodeLine{01685\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord4f"{}});}
\DoxyCodeLine{01686\ \ \ \ \ \_glMultiTexCoord1d\ =\ (PFNGLMULTITEXCOORD1DPROC)}
\DoxyCodeLine{01687\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord1d"{}});}
\DoxyCodeLine{01688\ \ \ \ \ \_glMultiTexCoord2d\ =\ (PFNGLMULTITEXCOORD2DPROC)}
\DoxyCodeLine{01689\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord2d"{}});}
\DoxyCodeLine{01690\ \ \ \ \ \_glMultiTexCoord3d\ =\ (PFNGLMULTITEXCOORD3DPROC)}
\DoxyCodeLine{01691\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord3d"{}});}
\DoxyCodeLine{01692\ \ \ \ \ \_glMultiTexCoord4d\ =\ (PFNGLMULTITEXCOORD4DPROC)}
\DoxyCodeLine{01693\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord4d"{}});}
\DoxyCodeLine{01694\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01695\ }
\DoxyCodeLine{01696\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_multitexture"{}}))\ \{}
\DoxyCodeLine{01697\ \ \ \ \ supports\_multitexture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01698\ }
\DoxyCodeLine{01699\ \ \ \ \ \_glActiveTexture\ =\ (PFNGLACTIVETEXTUREPROC)}
\DoxyCodeLine{01700\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glActiveTextureARB"{}});}
\DoxyCodeLine{01701\ }
\DoxyCodeLine{01702\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01703\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{01704\ \ \ \ \ \ \ \_glClientActiveTexture\ =\ (PFNGLACTIVETEXTUREPROC)}
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClientActiveTextureARB"{}});}
\DoxyCodeLine{01706\ \ \ \ \ \}}
\DoxyCodeLine{01707\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01708\ }
\DoxyCodeLine{01709\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{01710\ \ \ \ \ \_glMultiTexCoord1f\ =\ (PFNGLMULTITEXCOORD1FPROC)}
\DoxyCodeLine{01711\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord1fARB"{}});}
\DoxyCodeLine{01712\ \ \ \ \ \_glMultiTexCoord2f\ =\ (PFNGLMULTITEXCOORD2FPROC)}
\DoxyCodeLine{01713\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord2fARB"{}});}
\DoxyCodeLine{01714\ \ \ \ \ \_glMultiTexCoord3f\ =\ (PFNGLMULTITEXCOORD3FPROC)}
\DoxyCodeLine{01715\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord3fARB"{}});}
\DoxyCodeLine{01716\ \ \ \ \ \_glMultiTexCoord4f\ =\ (PFNGLMULTITEXCOORD4FPROC)}
\DoxyCodeLine{01717\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord4fARB"{}});}
\DoxyCodeLine{01718\ \ \ \ \ \_glMultiTexCoord1d\ =\ (PFNGLMULTITEXCOORD1DPROC)}
\DoxyCodeLine{01719\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord1dARB"{}});}
\DoxyCodeLine{01720\ \ \ \ \ \_glMultiTexCoord2d\ =\ (PFNGLMULTITEXCOORD2DPROC)}
\DoxyCodeLine{01721\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord2dARB"{}});}
\DoxyCodeLine{01722\ \ \ \ \ \_glMultiTexCoord3d\ =\ (PFNGLMULTITEXCOORD3DPROC)}
\DoxyCodeLine{01723\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord3dARB"{}});}
\DoxyCodeLine{01724\ \ \ \ \ \_glMultiTexCoord4d\ =\ (PFNGLMULTITEXCOORD4DPROC)}
\DoxyCodeLine{01725\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMultiTexCoord4dARB"{}});}
\DoxyCodeLine{01726\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01727\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01728\ \ \ \ \ supports\_multitexture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01729\ \ \ \}}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01731\ \ \ \textcolor{keywordflow}{if}\ (supports\_multitexture)\ \{}
\DoxyCodeLine{01732\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glActiveTexture\ ==\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01733\ \#ifdef\ SUPPORT\_FIXED\_FUNCTION}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ ||\ (has\_fixed\_function\_pipeline()\ \&\&\ \_glClientActiveTexture\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{01735\ \#endif}
\DoxyCodeLine{01736\ \#ifdef\ SUPPORT\_IMMEDIATE\_MODE}
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ ||\ GLf(\_glMultiTexCoord1)\ ==\ \textcolor{keyword}{nullptr}\ ||\ GLf(\_glMultiTexCoord2)\ ==\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ ||\ GLf(\_glMultiTexCoord3)\ ==\ \textcolor{keyword}{nullptr}\ ||\ GLf(\_glMultiTexCoord4)\ ==\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{01739\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{01741\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Multitexture\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01743\ \ \ \ \ \ \ supports\_multitexture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01744\ \ \ \ \ \}}
\DoxyCodeLine{01745\ \ \ \}}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ \textcolor{keywordflow}{if}\ (!supports\_multitexture)\ \{}
\DoxyCodeLine{01748\ \ \ \ \ \textcolor{comment}{//\ Replace\ with\ dummy\ no-\/op\ functions.}}
\DoxyCodeLine{01749\ \ \ \ \ \_glActiveTexture\ =\ null\_glActiveTexture;}
\DoxyCodeLine{01750\ \ \ \}}
\DoxyCodeLine{01751\ }
\DoxyCodeLine{01752\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01753\ \ \ \textcolor{keywordflow}{if}\ (!supports\_multitexture\ ||\ !has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{01754\ \ \ \ \ \_glClientActiveTexture\ =\ null\_glActiveTexture;}
\DoxyCodeLine{01755\ \ \ \}}
\DoxyCodeLine{01756\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01757\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_2}}
\DoxyCodeLine{01758\ }
\DoxyCodeLine{01759\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01760\ \ \ \_supports\_depth\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01761\ \ \ \_supports\_depth\_stencil\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_packed\_depth\_stencil"{}});}
\DoxyCodeLine{01762\ \ \ \_supports\_depth24\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_depth24"{}});}
\DoxyCodeLine{01763\ \ \ \_supports\_depth32\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_depth32"{}});}
\DoxyCodeLine{01764\ \ \ \_supports\_luminance\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01765\ }
\DoxyCodeLine{01766\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{01767\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01768\ \ \ \ \ \_supports\_depth\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01769\ \ \ \ \ \_supports\_depth\_stencil\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01770\ \ \ \ \ \_supports\_depth24\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01771\ \ \ \ \ \_supports\_depth32\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01772\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01773\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{01774\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}WEBGL\_depth\_texture"{}})\ ||}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ANGLE\_depth\_texture"{}}))\ \{}
\DoxyCodeLine{01776\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01777\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ANGLE\_depth\_texture"{}}))\ \{}
\DoxyCodeLine{01778\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ extension\ provides\ both\ depth\ textures\ and\ depth-\/stencil\ support.}}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \_supports\_depth\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \_supports\_depth\_stencil\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01782\ }
\DoxyCodeLine{01783\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_depth\_texture"{}}))\ \{}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \_supports\_depth\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01785\ \ \ \ \ \ \ \_supports\_depth\_stencil\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_packed\_depth\_stencil"{}});}
\DoxyCodeLine{01786\ \ \ \ \ \}}
\DoxyCodeLine{01787\ \ \ \ \ \_supports\_depth24\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_depth24"{}});}
\DoxyCodeLine{01788\ \ \ \ \ \_supports\_depth32\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_depth32"{}});}
\DoxyCodeLine{01789\ \ \ \}}
\DoxyCodeLine{01790\ \ \ \_supports\_luminance\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01791\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01792\ \ \ \_supports\_depth\_texture\ =\ (is\_at\_least\_gl\_version(1,\ 4)\ ||}
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_depth\_texture"{}}));}
\DoxyCodeLine{01794\ \ \ \_supports\_depth\_stencil\ =\ (is\_at\_least\_gl\_version(3,\ 0)\ ||}
\DoxyCodeLine{01795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_framebuffer\_object"{}})\ ||}
\DoxyCodeLine{01796\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_packed\_depth\_stencil"{}}));}
\DoxyCodeLine{01797\ }
\DoxyCodeLine{01798\ \ \ \textcolor{comment}{//\ OpenGL\ 3\ deprecates\ luminance,\ luminance-\/alpha\ and\ alpha\ textures.}}
\DoxyCodeLine{01799\ \ \ \_supports\_luminance\_texture\ =\ !core\_profile;}
\DoxyCodeLine{01800\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01801\ }
\DoxyCodeLine{01802\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{01803\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_shadow\_filter\ \&\&\ \_supports\_depth\_texture\ \&\&}
\DoxyCodeLine{01804\ \ \ \ \ \ \ (is\_at\_least\_gles\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_shadow\_samplers"{}})))\ \{}
\DoxyCodeLine{01805\ \ \ \ \ \_supports\_shadow\_filter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01806\ \ \ \}}
\DoxyCodeLine{01807\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01808\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_shadow\_filter\ \&\&}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \_supports\_depth\_texture\ \&\&}
\DoxyCodeLine{01810\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(1,\ 4)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_shadow"{}}))\ \&\&}
\DoxyCodeLine{01811\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(2,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_fragment\_program\_shadow"{}})))\ \{}
\DoxyCodeLine{01812\ \ \ \ \ \_supports\_shadow\_filter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01813\ \ \ \}}
\DoxyCodeLine{01814\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01815\ \ \ \textcolor{comment}{//\ Actually,\ we\ can't\ keep\ forever\ disabling\ ARB\_shadow\ on\ ATI\ cards,\ since}}
\DoxyCodeLine{01816\ \ \ \textcolor{comment}{//\ they\ do\ work\ correctly\ now.\ \ Maybe\ there\ is\ some\ feature\ level\ we\ can}}
\DoxyCodeLine{01817\ \ \ \textcolor{comment}{//\ check\ somewhere?}}
\DoxyCodeLine{01818\ \ \ \textcolor{comment}{/*if\ (\_gl\_vendor.substr(0,3)=="{}ATI"{})\ \{}}
\DoxyCodeLine{01819\ \textcolor{comment}{\ \ \ \ //\ ATI\ drivers\ have\ never\ provided\ correct\ shadow\ support.}}
\DoxyCodeLine{01820\ \textcolor{comment}{\ \ \ \ \_supports\_shadow\_filter\ =\ false;}}
\DoxyCodeLine{01821\ \textcolor{comment}{\ \ \}*/}}
\DoxyCodeLine{01822\ }
\DoxyCodeLine{01823\ \ \ \_supports\_texture\_combine\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01824\ \ \ \_supports\_texture\_saved\_result\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01825\ \ \ \_supports\_texture\_dot3\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01826\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01827\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{01828\ \ \ \ \ \_supports\_texture\_combine\ =}
\DoxyCodeLine{01829\ \ \ \ \ \ \ is\_at\_least\_gl\_version(1,\ 3)\ ||}
\DoxyCodeLine{01830\ \ \ \ \ \ \ is\_at\_least\_gles\_version(1,\ 1)\ ||}
\DoxyCodeLine{01831\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_env\_combine"{}});}
\DoxyCodeLine{01832\ }
\DoxyCodeLine{01833\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{01834\ \ \ \ \ \_supports\_texture\_saved\_result\ =}
\DoxyCodeLine{01835\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_env\_crossbar"{}});}
\DoxyCodeLine{01836\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01837\ \ \ \ \ \_supports\_texture\_saved\_result\ =}
\DoxyCodeLine{01838\ \ \ \ \ \ \ is\_at\_least\_gl\_version(1,\ 4)\ ||}
\DoxyCodeLine{01839\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_env\_crossbar"{}});}
\DoxyCodeLine{01840\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01841\ }
\DoxyCodeLine{01842\ \ \ \ \ \_supports\_texture\_dot3\ =}
\DoxyCodeLine{01843\ \ \ \ \ \ \ is\_at\_least\_gl\_version(1,\ 3)\ ||}
\DoxyCodeLine{01844\ \ \ \ \ \ \ is\_at\_least\_gles\_version(1,\ 1)\ ||}
\DoxyCodeLine{01845\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_env\_dot3"{}});}
\DoxyCodeLine{01846\ \ \ \}}
\DoxyCodeLine{01847\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{01848\ }
\DoxyCodeLine{01849\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{01850\ \ \ \_supports\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01851\ \ \ \_glGenBuffers\ =\ glGenBuffers;}
\DoxyCodeLine{01852\ \ \ \_glBindBuffer\ =\ glBindBuffer;}
\DoxyCodeLine{01853\ \ \ \_glBufferData\ =\ glBufferData;}
\DoxyCodeLine{01854\ \ \ \_glBufferSubData\ =\ glBufferSubData;}
\DoxyCodeLine{01855\ \ \ \_glDeleteBuffers\ =\ glDeleteBuffers;}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01858\ \ \ \_supports\_buffers\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01859\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 5)\ ||\ is\_at\_least\_gles\_version(1,\ 1))\ \{}
\DoxyCodeLine{01860\ \ \ \ \ \_supports\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01861\ }
\DoxyCodeLine{01862\ \ \ \ \ \_glGenBuffers\ =\ (PFNGLGENBUFFERSPROC)}
\DoxyCodeLine{01863\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenBuffers"{}});}
\DoxyCodeLine{01864\ \ \ \ \ \_glBindBuffer\ =\ (PFNGLBINDBUFFERPROC)}
\DoxyCodeLine{01865\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindBuffer"{}});}
\DoxyCodeLine{01866\ \ \ \ \ \_glBufferData\ =\ (PFNGLBUFFERDATAPROC)}
\DoxyCodeLine{01867\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBufferData"{}});}
\DoxyCodeLine{01868\ \ \ \ \ \_glBufferSubData\ =\ (PFNGLBUFFERSUBDATAPROC)}
\DoxyCodeLine{01869\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBufferSubData"{}});}
\DoxyCodeLine{01870\ \ \ \ \ \_glDeleteBuffers\ =\ (PFNGLDELETEBUFFERSPROC)}
\DoxyCodeLine{01871\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteBuffers"{}});}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{01874\ \ \ \ \ \_glMapBuffer\ =\ (PFNGLMAPBUFFERPROC)}
\DoxyCodeLine{01875\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapBuffer"{}});}
\DoxyCodeLine{01876\ \ \ \ \ \_glUnmapBuffer\ =\ (PFNGLUNMAPBUFFERPROC)}
\DoxyCodeLine{01877\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUnmapBuffer"{}});}
\DoxyCodeLine{01878\ \ \ \ \ \_glGetBufferSubData\ =\ (PFNGLGETBUFFERSUBDATAPROC)}
\DoxyCodeLine{01879\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetBufferSubData"{}});}
\DoxyCodeLine{01880\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01881\ \ \ \}}
\DoxyCodeLine{01882\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{01883\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{01884\ \ \ \ \ \_supports\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01885\ }
\DoxyCodeLine{01886\ \ \ \ \ \_glGenBuffers\ =\ (PFNGLGENBUFFERSPROC)}
\DoxyCodeLine{01887\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenBuffersARB"{}});}
\DoxyCodeLine{01888\ \ \ \ \ \_glBindBuffer\ =\ (PFNGLBINDBUFFERPROC)}
\DoxyCodeLine{01889\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindBufferARB"{}});}
\DoxyCodeLine{01890\ \ \ \ \ \_glBufferData\ =\ (PFNGLBUFFERDATAPROC)}
\DoxyCodeLine{01891\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBufferDataARB"{}});}
\DoxyCodeLine{01892\ \ \ \ \ \_glBufferSubData\ =\ (PFNGLBUFFERSUBDATAPROC)}
\DoxyCodeLine{01893\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBufferSubDataARB"{}});}
\DoxyCodeLine{01894\ \ \ \ \ \_glDeleteBuffers\ =\ (PFNGLDELETEBUFFERSPROC)}
\DoxyCodeLine{01895\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteBuffersARB"{}});}
\DoxyCodeLine{01896\ \ \ \ \ \_glMapBuffer\ =\ (PFNGLMAPBUFFERPROC)}
\DoxyCodeLine{01897\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapBufferARB"{}});}
\DoxyCodeLine{01898\ \ \ \ \ \_glUnmapBuffer\ =\ (PFNGLUNMAPBUFFERPROC)}
\DoxyCodeLine{01899\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUnmapBufferARB"{}});}
\DoxyCodeLine{01900\ \ \ \ \ \_glGetBufferSubData\ =\ (PFNGLGETBUFFERSUBDATAPROC)}
\DoxyCodeLine{01901\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetBufferSubDataARB"{}});}
\DoxyCodeLine{01902\ \ \ \}}
\DoxyCodeLine{01903\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{01904\ }
\DoxyCodeLine{01905\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{01906\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGenBuffers\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glBindBuffer\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \_glBufferData\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glBufferSubData\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \_glDeleteBuffers\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01909\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Buffers\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \_supports\_buffers\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01912\ \ \ \ \ \}}
\DoxyCodeLine{01913\ \ \ \}}
\DoxyCodeLine{01914\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01915\ }
\DoxyCodeLine{01916\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{01917\ \ \ \_glCopyBufferSubData\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01918\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{01919\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 1)\ ||}
\DoxyCodeLine{01920\ \ \ \ \ \ \ \ \ is\_at\_least\_gles\_version(3,\ 0)\ ||}
\DoxyCodeLine{01921\ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_copy\_buffer"{}}))\ \{}
\DoxyCodeLine{01922\ \ \ \ \ \ \ \_glCopyBufferSubData\ =\ (PFNGLCOPYBUFFERSUBDATAPROC)}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCopyBufferSubData"{}});}
\DoxyCodeLine{01924\ \ \ \ \ \}}
\DoxyCodeLine{01925\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{01926\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_copy\_buffer"{}}))\ \{}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \_glCopyBufferSubData\ =\ (PFNGLCOPYBUFFERSUBDATAPROC)}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCopyBufferSubDataNV"{}});}
\DoxyCodeLine{01929\ \ \ \ \ \}}
\DoxyCodeLine{01930\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01931\ \ \ \}}
\DoxyCodeLine{01932\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01935\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01936\ \ \ \ \ \_glMapBufferRange\ =\ (PFNGLMAPBUFFERRANGEEXTPROC)}
\DoxyCodeLine{01937\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapBufferRange"{}});}
\DoxyCodeLine{01938\ \ \ \ \ \_glUnmapBuffer\ =\ (PFNGLUNMAPBUFFERPROC)}
\DoxyCodeLine{01939\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUnmapBuffer"{}});}
\DoxyCodeLine{01940\ \ \ \}}
\DoxyCodeLine{01941\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_map\_buffer\_range"{}}))\ \{}
\DoxyCodeLine{01942\ \ \ \ \ \_glMapBufferRange\ =\ (PFNGLMAPBUFFERRANGEEXTPROC)}
\DoxyCodeLine{01943\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapBufferRangeEXT"{}});}
\DoxyCodeLine{01944\ \ \ \ \ \_glUnmapBuffer\ =\ (PFNGLUNMAPBUFFERPROC)}
\DoxyCodeLine{01945\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUnmapBufferOES"{}});}
\DoxyCodeLine{01946\ \ \ \}}
\DoxyCodeLine{01947\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01948\ \ \ \ \ \_glMapBufferRange\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01949\ \ \ \ \ \_glUnmapBuffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01950\ \ \ \}}
\DoxyCodeLine{01951\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01952\ \ \ \textcolor{comment}{//\ Check\ for\ various\ advanced\ buffer\ management\ features.}}
\DoxyCodeLine{01953\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_map\_buffer\_range"{}}))\ \{}
\DoxyCodeLine{01954\ \ \ \ \ \_glMapBufferRange\ =\ (PFNGLMAPBUFFERRANGEPROC)}
\DoxyCodeLine{01955\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapBufferRange"{}});}
\DoxyCodeLine{01956\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01957\ \ \ \ \ \_glMapBufferRange\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01958\ \ \ \}}
\DoxyCodeLine{01959\ }
\DoxyCodeLine{01960\ \ \ \textcolor{keywordflow}{if}\ (\_glMapBufferRange\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{01961\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(4,\ 4)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_buffer\_storage"{}})))\ \{}
\DoxyCodeLine{01962\ \ \ \ \ \_glBufferStorage\ =\ (PFNGLBUFFERSTORAGEPROC)}
\DoxyCodeLine{01963\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBufferStorage"{}});}
\DoxyCodeLine{01964\ }
\DoxyCodeLine{01965\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBufferStorage\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \_supports\_buffer\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01967\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01968\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Buffer\ storage\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ "{}}}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{01971\ \ \ \ \ \}}
\DoxyCodeLine{01972\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01973\ \ \ \ \ \_supports\_buffer\_storage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01974\ \ \ \}}
\DoxyCodeLine{01975\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01976\ }
\DoxyCodeLine{01977\ \ \ \_supports\_vao\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01978\ }
\DoxyCodeLine{01979\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01980\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{01981\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01982\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_array\_object"{}}))\ \{}
\DoxyCodeLine{01983\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01984\ \ \ \ \ \_supports\_vao\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01985\ }
\DoxyCodeLine{01986\ \ \ \ \ \_glBindVertexArray\ =\ (PFNGLBINDVERTEXARRAYPROC)}
\DoxyCodeLine{01987\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindVertexArray"{}});}
\DoxyCodeLine{01988\ \ \ \ \ \_glDeleteVertexArrays\ =\ (PFNGLDELETEVERTEXARRAYSPROC)}
\DoxyCodeLine{01989\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteVertexArrays"{}});}
\DoxyCodeLine{01990\ \ \ \ \ \_glGenVertexArrays\ =\ (PFNGLGENVERTEXARRAYSPROC)}
\DoxyCodeLine{01991\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenVertexArrays"{}});}
\DoxyCodeLine{01992\ }
\DoxyCodeLine{01993\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{01994\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_vertex\_array\_object"{}}))\ \{}
\DoxyCodeLine{01995\ \ \ \ \ \_supports\_vao\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01996\ }
\DoxyCodeLine{01997\ \ \ \ \ \_glBindVertexArray\ =\ (PFNGLBINDVERTEXARRAYPROC)}
\DoxyCodeLine{01998\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindVertexArrayOES"{}});}
\DoxyCodeLine{01999\ \ \ \ \ \_glDeleteVertexArrays\ =\ (PFNGLDELETEVERTEXARRAYSPROC)}
\DoxyCodeLine{02000\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteVertexArraysOES"{}});}
\DoxyCodeLine{02001\ \ \ \ \ \_glGenVertexArrays\ =\ (PFNGLGENVERTEXARRAYSPROC)}
\DoxyCodeLine{02002\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenVertexArraysOES"{}});}
\DoxyCodeLine{02003\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02004\ \ \ \}}
\DoxyCodeLine{02005\ }
\DoxyCodeLine{02006\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_vao)\ \{}
\DoxyCodeLine{02007\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBindVertexArray\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDeleteVertexArrays\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ \_glGenVertexArrays\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02009\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Vertex\ array\ objects\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{02011\ \ \ \ \ \ \ \_supports\_vao\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02012\ \ \ \ \ \}}
\DoxyCodeLine{02013\ \ \ \}}
\DoxyCodeLine{02014\ }
\DoxyCodeLine{02015\ \ \ \textcolor{comment}{//\ Check\ for\ GLSL\ support.}}
\DoxyCodeLine{02016\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_1)}}
\DoxyCodeLine{02017\ \ \ \_supports\_glsl\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02018\ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02019\ \ \ \_supports\_tessellation\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02020\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{02021\ \ \ \_supports\_glsl\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02022\ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02023\ \ \ \_supports\_tessellation\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02024\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02025\ \ \ \_supports\_glsl\ =\ (\_gl\_shadlang\_ver\_major\ >=\ 1);}
\DoxyCodeLine{02026\ \ \ \_supports\_tessellation\_shaders\ =\ is\_at\_least\_gl\_version(4,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_tessellation\_shader"{}});}
\DoxyCodeLine{02027\ }
\DoxyCodeLine{02028\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 2))\ \{}
\DoxyCodeLine{02029\ \ \ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02030\ \ \ \ \ \_glFramebufferTexture\ =\ (PFNGLFRAMEBUFFERTEXTUREARBPROC)}
\DoxyCodeLine{02031\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture"{}});}
\DoxyCodeLine{02032\ }
\DoxyCodeLine{02033\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_geometry\_shader4"{}}))\ \{}
\DoxyCodeLine{02034\ \ \ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02035\ \ \ \ \ \_glFramebufferTexture\ =\ (PFNGLFRAMEBUFFERTEXTUREARBPROC)}
\DoxyCodeLine{02036\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTextureARB"{}});}
\DoxyCodeLine{02037\ \ \ \ \ \_glProgramParameteri\ =\ (PFNGLPROGRAMPARAMETERIPROC)}
\DoxyCodeLine{02038\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glProgramParameteriARB"{}});}
\DoxyCodeLine{02039\ }
\DoxyCodeLine{02040\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_geometry\_shader4"{}}))\ \{}
\DoxyCodeLine{02041\ \ \ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02042\ \ \ \ \ \_glFramebufferTexture\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02043\ \ \ \ \ \_glProgramParameteri\ =\ (PFNGLPROGRAMPARAMETERIPROC)}
\DoxyCodeLine{02044\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glProgramParameteriEXT"{}});}
\DoxyCodeLine{02045\ }
\DoxyCodeLine{02046\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02047\ \ \ \ \ \_supports\_geometry\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02048\ \ \ \ \ \_glFramebufferTexture\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02049\ \ \ \}}
\DoxyCodeLine{02050\ }
\DoxyCodeLine{02051\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_geometry\_shaders)\ \{}
\DoxyCodeLine{02052\ \ \ \ \ \_supported\_geom\_rendering\ |=\ Geom::GR\_adjacency;}
\DoxyCodeLine{02053\ \ \ \}}
\DoxyCodeLine{02054\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02055\ \ \ \_shader\_caps.\_supports\_glsl\ =\ \_supports\_glsl;}
\DoxyCodeLine{02056\ }
\DoxyCodeLine{02057\ \ \ \textcolor{comment}{//\ Check\ for\ support\ for\ other\ types\ of\ shaders\ that\ can\ be\ used\ by\ Cg.}}
\DoxyCodeLine{02058\ \ \ \_supports\_basic\_shaders\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02059\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{02060\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_program"{}})\ \&\&}
\DoxyCodeLine{02061\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_fragment\_program"{}}))\ \{}
\DoxyCodeLine{02062\ \ \ \ \ \_supports\_basic\_shaders\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02063\ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_ARBVP1;}
\DoxyCodeLine{02064\ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_ARBFP1;}
\DoxyCodeLine{02065\ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_UNKNOWN;\ \textcolor{comment}{//\ No\ geometry\ shader\ if\ only\ using\ basic}}
\DoxyCodeLine{02066\ }
\DoxyCodeLine{02067\ \ \ \ \ \textcolor{keywordflow}{if}\ (basic\_shaders\_only)\ \{}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \textcolor{comment}{//\ We're\ happy\ with\ ARB\ programs,\ thanks.}}
\DoxyCodeLine{02069\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_gpu\_program5"{}}))\ \{}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_GP5VP;}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_GP5FP;}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_GP5GP;}
\DoxyCodeLine{02073\ }
\DoxyCodeLine{02074\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_gpu\_program4"{}}))\ \{}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_GP4VP;}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_GP4FP;}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_GP4GP;}
\DoxyCodeLine{02078\ }
\DoxyCodeLine{02079\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_vertex\_program3"{}})\ \&\&}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_fragment\_program2"{}}))\ \{}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_VP40;}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_FP40;}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_UNKNOWN;}
\DoxyCodeLine{02084\ }
\DoxyCodeLine{02085\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_vertex\_program2"{}})\ \&\&}
\DoxyCodeLine{02086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_fragment\_program"{}}))\ \{}
\DoxyCodeLine{02087\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_VP30;}
\DoxyCodeLine{02088\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_FP30;}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_UNKNOWN;}
\DoxyCodeLine{02090\ }
\DoxyCodeLine{02091\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_vertex\_program1\_1"{}})\ \&\&}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_texture\_shader2"{}})\ \&\&}
\DoxyCodeLine{02093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_register\_combiners2"{}}))\ \{}
\DoxyCodeLine{02094\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_VP20;}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_FP20;}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_UNKNOWN;}
\DoxyCodeLine{02097\ }
\DoxyCodeLine{02098\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_glsl)\ \{}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ what\ will\ be\ available\ to\ non-\/NVIDIA\ cards.\ \ It\ is\ the\ last}}
\DoxyCodeLine{02100\ \ \ \ \ \ \ \textcolor{comment}{//\ option\ since\ it\ is\ slower\ to\ compile\ GLSL\ than\ the\ other\ options.}}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_GLSLV;}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_GLSLF;}
\DoxyCodeLine{02103\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_geometry\_shaders)\ \{}
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_GLSLG;}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02106\ \ \ \ \ \}}
\DoxyCodeLine{02107\ \ \ \ \ \_shader\_caps.\_ultimate\_vprofile\ =\ (int)CG\_PROFILE\_GP5VP;}
\DoxyCodeLine{02108\ \ \ \ \ \_shader\_caps.\_ultimate\_fprofile\ =\ (int)CG\_PROFILE\_GP5FP;}
\DoxyCodeLine{02109\ \ \ \ \ \_shader\_caps.\_ultimate\_gprofile\ =\ (int)CG\_PROFILE\_GP5GP;}
\DoxyCodeLine{02110\ }
\DoxyCodeLine{02111\ \ \ \ \ \textcolor{comment}{//\ Bug\ workaround\ for\ radeons.}}
\DoxyCodeLine{02112\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_shader\_caps.\_active\_fprofile\ ==\ CG\_PROFILE\_ARBFP1)\ \{}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ATI\_draw\_buffers"{}}))\ \{}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ \_shader\_caps.\_bug\_list.insert(Shader::SBUG\_ati\_draw\_buffers);}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02116\ \ \ \ \ \}}
\DoxyCodeLine{02117\ }
\DoxyCodeLine{02118\ \ \ \ \ \mbox{\hyperlink{classShader_a794464f89804122fb3858d8eb862b403}{Shader::set\_default\_caps}}(\_shader\_caps);}
\DoxyCodeLine{02119\ }
\DoxyCodeLine{02120\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_glsl)\ \{}
\DoxyCodeLine{02121\ \ \ \ \ \textcolor{comment}{//\ No,\ but\ we\ do\ support\ GLSL...}}
\DoxyCodeLine{02122\ \ \ \ \ \_shader\_caps.\_active\_vprofile\ =\ (int)CG\_PROFILE\_GLSLV;}
\DoxyCodeLine{02123\ \ \ \ \ \_shader\_caps.\_active\_fprofile\ =\ (int)CG\_PROFILE\_GLSLF;}
\DoxyCodeLine{02124\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_geometry\_shaders)\ \{}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_GLSLG;}
\DoxyCodeLine{02126\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \_shader\_caps.\_active\_gprofile\ =\ (int)CG\_PROFILE\_UNKNOWN;}
\DoxyCodeLine{02128\ \ \ \ \ \}}
\DoxyCodeLine{02129\ \ \ \}}
\DoxyCodeLine{02130\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_CG}}
\DoxyCodeLine{02131\ }
\DoxyCodeLine{02132\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02133\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02134\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))\ \{}
\DoxyCodeLine{02135\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02136\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_compute\_shader"{}}))\ \{}
\DoxyCodeLine{02137\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02138\ \ \ \ \ \_glDispatchCompute\ =\ (PFNGLDISPATCHCOMPUTEPROC)}
\DoxyCodeLine{02139\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDispatchCompute"{}});}
\DoxyCodeLine{02140\ }
\DoxyCodeLine{02141\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glDispatchCompute\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02142\ \ \ \ \ \ \ glGetIntegerv(GL\_MAX\_COMPUTE\_WORK\_GROUP\_INVOCATIONS,\ \&\_max\_compute\_work\_group\_invocations);}
\DoxyCodeLine{02143\ }
\DoxyCodeLine{02144\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_max\_compute\_work\_group\_invocations\ >\ 0)\ \{}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Initialize\ to\ spec-\/mandated\ minima}}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \_max\_compute\_work\_group\_count.fill(65535);}
\DoxyCodeLine{02147\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ \_max\_compute\_work\_group\_size.set(128,\ 128,\ 64);}
\DoxyCodeLine{02149\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \_max\_compute\_work\_group\_size.set(1024,\ 1024,\ 64);}
\DoxyCodeLine{02151\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02152\ }
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGetIntegeri\_v\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_COUNT,\ 0,\ \&\_max\_compute\_work\_group\_count[0]);}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_COUNT,\ 1,\ \&\_max\_compute\_work\_group\_count[1]);}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_COUNT,\ 2,\ \&\_max\_compute\_work\_group\_count[2]);}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_SIZE,\ 0,\ \&\_max\_compute\_work\_group\_size[0]);}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_SIZE,\ 1,\ \&\_max\_compute\_work\_group\_size[1]);}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \_glGetIntegeri\_v(GL\_MAX\_COMPUTE\_WORK\_GROUP\_SIZE,\ 2,\ \&\_max\_compute\_work\_group\_size[2]);}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02162\ \ \ \ \ \}}
\DoxyCodeLine{02163\ \ \ \}}
\DoxyCodeLine{02164\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{02165\ }
\DoxyCodeLine{02166\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02167\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_glsl)\ \{}
\DoxyCodeLine{02168\ \ \ \ \ \_glAttachShader\ =\ (PFNGLATTACHSHADERPROC)}
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glAttachShader"{}});}
\DoxyCodeLine{02170\ \ \ \ \ \_glBindAttribLocation\ =\ (PFNGLBINDATTRIBLOCATIONPROC)}
\DoxyCodeLine{02171\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindAttribLocation"{}});}
\DoxyCodeLine{02172\ \ \ \ \ \_glCompileShader\ =\ (PFNGLCOMPILESHADERPROC)}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCompileShader"{}});}
\DoxyCodeLine{02174\ \ \ \ \ \_glCreateProgram\ =\ (PFNGLCREATEPROGRAMPROC)}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCreateProgram"{}});}
\DoxyCodeLine{02176\ \ \ \ \ \_glCreateShader\ =\ (PFNGLCREATESHADERPROC)}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCreateShader"{}});}
\DoxyCodeLine{02178\ \ \ \ \ \_glDeleteProgram\ =\ (PFNGLDELETEPROGRAMPROC)}
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteProgram"{}});}
\DoxyCodeLine{02180\ \ \ \ \ \_glDeleteShader\ =\ (PFNGLDELETESHADERPROC)}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteShader"{}});}
\DoxyCodeLine{02182\ \ \ \ \ \_glDetachShader\ =\ (PFNGLDETACHSHADERPROC)}
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDetachShader"{}});}
\DoxyCodeLine{02184\ \ \ \ \ \_glDisableVertexAttribArray\ =\ (PFNGLDISABLEVERTEXATTRIBARRAYPROC)}
\DoxyCodeLine{02185\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDisableVertexAttribArray"{}});}
\DoxyCodeLine{02186\ \ \ \ \ \_glEnableVertexAttribArray\ =\ (PFNGLENABLEVERTEXATTRIBARRAYPROC)}
\DoxyCodeLine{02187\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glEnableVertexAttribArray"{}});}
\DoxyCodeLine{02188\ \ \ \ \ \_glGetActiveAttrib\ =\ (PFNGLGETACTIVEATTRIBPROC)}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetActiveAttrib"{}});}
\DoxyCodeLine{02190\ \ \ \ \ \_glGetActiveUniform\ =\ (PFNGLGETACTIVEUNIFORMPROC)}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetActiveUniform"{}});}
\DoxyCodeLine{02192\ \ \ \ \ \_glGetAttribLocation\ =\ (PFNGLGETATTRIBLOCATIONPROC)}
\DoxyCodeLine{02193\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetAttribLocation"{}});}
\DoxyCodeLine{02194\ \ \ \ \ \_glGetProgramiv\ =\ (PFNGLGETPROGRAMIVPROC)}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramiv"{}});}
\DoxyCodeLine{02196\ \ \ \ \ \_glGetProgramInfoLog\ =\ (PFNGLGETPROGRAMINFOLOGPROC)}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramInfoLog"{}});}
\DoxyCodeLine{02198\ \ \ \ \ \_glGetShaderiv\ =\ (PFNGLGETSHADERIVPROC)}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetShaderiv"{}});}
\DoxyCodeLine{02200\ \ \ \ \ \_glGetShaderInfoLog\ =\ (PFNGLGETSHADERINFOLOGPROC)}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetShaderInfoLog"{}});}
\DoxyCodeLine{02202\ \ \ \ \ \_glGetUniformLocation\ =\ (PFNGLGETUNIFORMLOCATIONPROC)}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetUniformLocation"{}});}
\DoxyCodeLine{02204\ \ \ \ \ \_glLinkProgram\ =\ (PFNGLLINKPROGRAMPROC)}
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glLinkProgram"{}});}
\DoxyCodeLine{02206\ \ \ \ \ \_glShaderSource\ =\ (PFNGLSHADERSOURCEPROC\_P)}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glShaderSource"{}});}
\DoxyCodeLine{02208\ \ \ \ \ \_glUseProgram\ =\ (PFNGLUSEPROGRAMPROC)}
\DoxyCodeLine{02209\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUseProgram"{}});}
\DoxyCodeLine{02210\ \ \ \ \ \_glUniform4f\ =\ (PFNGLUNIFORM4FPROC)}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform4f"{}});}
\DoxyCodeLine{02212\ \ \ \ \ \_glUniform1i\ =\ (PFNGLUNIFORM1IPROC)}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform1i"{}});}
\DoxyCodeLine{02214\ \ \ \ \ \_glUniform1fv\ =\ (PFNGLUNIFORM1FVPROC)}
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform1fv"{}});}
\DoxyCodeLine{02216\ \ \ \ \ \_glUniform2fv\ =\ (PFNGLUNIFORM2FVPROC)}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform2fv"{}});}
\DoxyCodeLine{02218\ \ \ \ \ \_glUniform3fv\ =\ (PFNGLUNIFORM3FVPROC)}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform3fv"{}});}
\DoxyCodeLine{02220\ \ \ \ \ \_glUniform4fv\ =\ (PFNGLUNIFORM4FVPROC)}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform4fv"{}});}
\DoxyCodeLine{02222\ \ \ \ \ \_glUniform1iv\ =\ (PFNGLUNIFORM1IVPROC)}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform1iv"{}});}
\DoxyCodeLine{02224\ \ \ \ \ \_glUniform2iv\ =\ (PFNGLUNIFORM2IVPROC)}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform2iv"{}});}
\DoxyCodeLine{02226\ \ \ \ \ \_glUniform3iv\ =\ (PFNGLUNIFORM3IVPROC)}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform3iv"{}});}
\DoxyCodeLine{02228\ \ \ \ \ \_glUniform4iv\ =\ (PFNGLUNIFORM4IVPROC)}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform4iv"{}});}
\DoxyCodeLine{02230\ \ \ \ \ \_glUniformMatrix3fv\ =\ (PFNGLUNIFORMMATRIX3FVPROC)}
\DoxyCodeLine{02231\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniformMatrix3fv"{}});}
\DoxyCodeLine{02232\ \ \ \ \ \_glUniformMatrix4fv\ =\ (PFNGLUNIFORMMATRIX4FVPROC)}
\DoxyCodeLine{02233\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniformMatrix4fv"{}});}
\DoxyCodeLine{02234\ \ \ \ \ \_glValidateProgram\ =\ (PFNGLVALIDATEPROGRAMPROC)}
\DoxyCodeLine{02235\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glValidateProgram"{}});}
\DoxyCodeLine{02236\ \ \ \ \ \_glVertexAttrib4fv\ =\ (PFNGLVERTEXATTRIB4FVPROC)}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttrib4fv"{}});}
\DoxyCodeLine{02238\ \ \ \ \ \_glVertexAttrib4dv\ =\ (PFNGLVERTEXATTRIB4DVPROC)}
\DoxyCodeLine{02239\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttrib4dv"{}});}
\DoxyCodeLine{02240\ \ \ \ \ \_glVertexAttribPointer\ =\ (PFNGLVERTEXATTRIBPOINTERPROC)}
\DoxyCodeLine{02241\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribPointer"{}});}
\DoxyCodeLine{02242\ }
\DoxyCodeLine{02243\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0))\ \{}
\DoxyCodeLine{02244\ \ \ \ \ \ \ \_glBindFragDataLocation\ =\ (PFNGLBINDFRAGDATALOCATIONPROC)}
\DoxyCodeLine{02245\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFragDataLocation"{}});}
\DoxyCodeLine{02246\ \ \ \ \ \ \ \_glVertexAttribIPointer\ =\ (PFNGLVERTEXATTRIBIPOINTERPROC)}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribIPointer"{}});}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \_glUniform1uiv\ =\ (PFNGLUNIFORM1UIVPROC)}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform1uiv"{}});}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \_glUniform2uiv\ =\ (PFNGLUNIFORM2UIVPROC)}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform2uiv"{}});}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \_glUniform3uiv\ =\ (PFNGLUNIFORM3UIVPROC)}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform3uiv"{}});}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \_glUniform4uiv\ =\ (PFNGLUNIFORM4UIVPROC)}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform4uiv"{}});}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \_glVertexAttribI4ui\ =\ (PFNGLVERTEXATTRIBI4UIPROC)}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribI4ui"{}});}
\DoxyCodeLine{02258\ }
\DoxyCodeLine{02259\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_gpu\_shader4"{}}))\ \{}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \_glBindFragDataLocation\ =\ (PFNGLBINDFRAGDATALOCATIONPROC)}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFragDataLocationEXT"{}});}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \_glVertexAttribIPointer\ =\ (PFNGLVERTEXATTRIBIPOINTERPROC)}
\DoxyCodeLine{02263\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribIPointerEXT"{}});}
\DoxyCodeLine{02264\ \ \ \ \ \ \ \_glUniform1uiv\ =\ (PFNGLUNIFORM1UIVPROC)}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform1uivEXT"{}});}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \_glUniform2uiv\ =\ (PFNGLUNIFORM2UIVPROC)}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform2uivEXT"{}});}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \_glUniform3uiv\ =\ (PFNGLUNIFORM3UIVPROC)}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform3uivEXT"{}});}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \_glUniform4uiv\ =\ (PFNGLUNIFORM4UIVPROC)}
\DoxyCodeLine{02271\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniform4uivEXT"{}});}
\DoxyCodeLine{02272\ \ \ \ \ \ \ \_glVertexAttribI4ui\ =\ (PFNGLVERTEXATTRIBI4UIPROC)}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribI4uiEXT"{}});}
\DoxyCodeLine{02274\ }
\DoxyCodeLine{02275\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \_glBindFragDataLocation\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \_glVertexAttribIPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \_glVertexAttribI4ui\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02279\ \ \ \ \ \}}
\DoxyCodeLine{02280\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 1)\ ||}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_attrib\_64bit"{}}))\ \{}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \_glVertexAttribLPointer\ =\ (PFNGLVERTEXATTRIBLPOINTERPROC)}
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribLPointer"{}});}
\DoxyCodeLine{02284\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \_glVertexAttribLPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02286\ \ \ \ \ \}}
\DoxyCodeLine{02287\ }
\DoxyCodeLine{02288\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_tessellation\_shaders)\ \{}
\DoxyCodeLine{02289\ \ \ \ \ \ \ \_glPatchParameteri\ =\ (PFNGLPATCHPARAMETERIPROC)}
\DoxyCodeLine{02290\ \ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glPatchParameteri"{}});}
\DoxyCodeLine{02291\ \ \ \ \ \}}
\DoxyCodeLine{02292\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_basic\_shaders)\ \{}
\DoxyCodeLine{02293\ \ \ \ \ \textcolor{comment}{//\ We\ don't\ support\ GLSL,\ but\ we\ support\ ARB\ programs.}}
\DoxyCodeLine{02294\ \ \ \ \ \_glDisableVertexAttribArray\ =\ (PFNGLDISABLEVERTEXATTRIBARRAYPROC)}
\DoxyCodeLine{02295\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDisableVertexAttribArrayARB"{}});}
\DoxyCodeLine{02296\ \ \ \ \ \_glEnableVertexAttribArray\ =\ (PFNGLENABLEVERTEXATTRIBARRAYPROC)}
\DoxyCodeLine{02297\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glEnableVertexAttribArrayARB"{}});}
\DoxyCodeLine{02298\ }
\DoxyCodeLine{02299\ \ \ \ \ \_glVertexAttrib4fv\ =\ (PFNGLVERTEXATTRIB4FVPROC)}
\DoxyCodeLine{02300\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttrib4fvARB"{}});}
\DoxyCodeLine{02301\ \ \ \ \ \_glVertexAttrib4dv\ =\ (PFNGLVERTEXATTRIB4DVPROC)}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttrib4dvARB"{}});}
\DoxyCodeLine{02303\ \ \ \ \ \_glVertexAttribPointer\ =\ (PFNGLVERTEXATTRIBPOINTERPROC)}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribPointerARB"{}});}
\DoxyCodeLine{02305\ }
\DoxyCodeLine{02306\ \ \ \ \ \_glBindFragDataLocation\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02307\ \ \ \ \ \_glVertexAttribI4ui\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02308\ \ \ \ \ \_glVertexAttribIPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02309\ \ \ \ \ \_glVertexAttribLPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02310\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02311\ \ \ \ \ \_glVertexAttribI4ui\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02312\ \ \ \}}
\DoxyCodeLine{02313\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02314\ }
\DoxyCodeLine{02315\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{02316\ \ \ \_glAttachShader\ =\ glAttachShader;}
\DoxyCodeLine{02317\ \ \ \_glBindAttribLocation\ =\ glBindAttribLocation;}
\DoxyCodeLine{02318\ \ \ \_glCompileShader\ =\ glCompileShader;}
\DoxyCodeLine{02319\ \ \ \_glCreateProgram\ =\ glCreateProgram;}
\DoxyCodeLine{02320\ \ \ \_glCreateShader\ =\ glCreateShader;}
\DoxyCodeLine{02321\ \ \ \_glDeleteProgram\ =\ glDeleteProgram;}
\DoxyCodeLine{02322\ \ \ \_glDeleteShader\ =\ glDeleteShader;}
\DoxyCodeLine{02323\ \ \ \_glDetachShader\ =\ glDetachShader;}
\DoxyCodeLine{02324\ \ \ \_glDisableVertexAttribArray\ =\ glDisableVertexAttribArray;}
\DoxyCodeLine{02325\ \ \ \_glEnableVertexAttribArray\ =\ glEnableVertexAttribArray;}
\DoxyCodeLine{02326\ \ \ \_glGetActiveAttrib\ =\ glGetActiveAttrib;}
\DoxyCodeLine{02327\ \ \ \_glGetActiveUniform\ =\ glGetActiveUniform;}
\DoxyCodeLine{02328\ \ \ \_glGetAttribLocation\ =\ glGetAttribLocation;}
\DoxyCodeLine{02329\ \ \ \_glGetProgramiv\ =\ glGetProgramiv;}
\DoxyCodeLine{02330\ \ \ \_glGetProgramInfoLog\ =\ glGetProgramInfoLog;}
\DoxyCodeLine{02331\ \ \ \_glGetShaderiv\ =\ glGetShaderiv;}
\DoxyCodeLine{02332\ \ \ \_glGetShaderInfoLog\ =\ glGetShaderInfoLog;}
\DoxyCodeLine{02333\ \ \ \_glGetUniformLocation\ =\ glGetUniformLocation;}
\DoxyCodeLine{02334\ \ \ \_glLinkProgram\ =\ glLinkProgram;}
\DoxyCodeLine{02335\ \ \ \_glShaderSource\ =\ (PFNGLSHADERSOURCEPROC\_P)\ glShaderSource;}
\DoxyCodeLine{02336\ \ \ \_glUseProgram\ =\ glUseProgram;}
\DoxyCodeLine{02337\ \ \ \_glUniform4f\ =\ glUniform4f;}
\DoxyCodeLine{02338\ \ \ \_glUniform1i\ =\ glUniform1i;}
\DoxyCodeLine{02339\ \ \ \_glUniform1fv\ =\ glUniform1fv;}
\DoxyCodeLine{02340\ \ \ \_glUniform2fv\ =\ glUniform2fv;}
\DoxyCodeLine{02341\ \ \ \_glUniform3fv\ =\ glUniform3fv;}
\DoxyCodeLine{02342\ \ \ \_glUniform4fv\ =\ glUniform4fv;}
\DoxyCodeLine{02343\ \ \ \_glUniform1iv\ =\ glUniform1iv;}
\DoxyCodeLine{02344\ \ \ \_glUniform2iv\ =\ glUniform2iv;}
\DoxyCodeLine{02345\ \ \ \_glUniform3iv\ =\ glUniform3iv;}
\DoxyCodeLine{02346\ \ \ \_glUniform4iv\ =\ glUniform4iv;}
\DoxyCodeLine{02347\ \ \ \_glUniformMatrix3fv\ =\ glUniformMatrix3fv;}
\DoxyCodeLine{02348\ \ \ \_glUniformMatrix4fv\ =\ glUniformMatrix4fv;}
\DoxyCodeLine{02349\ \ \ \_glValidateProgram\ =\ glValidateProgram;}
\DoxyCodeLine{02350\ \ \ \_glVertexAttrib4fv\ =\ glVertexAttrib4fv;}
\DoxyCodeLine{02351\ \ \ \_glVertexAttrib4dv\ =\ null\_glVertexAttrib4dv;}
\DoxyCodeLine{02352\ \ \ \_glVertexAttribPointer\ =\ glVertexAttribPointer;}
\DoxyCodeLine{02353\ \ \ \_glVertexAttribLPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02354\ }
\DoxyCodeLine{02355\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02356\ \ \ \ \ \_glVertexAttribIPointer\ =\ (PFNGLVERTEXATTRIBIPOINTERPROC)}
\DoxyCodeLine{02357\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribIPointer"{}});}
\DoxyCodeLine{02358\ \ \ \ \ \_glVertexAttribI4ui\ =\ (PFNGLVERTEXATTRIBI4UIPROC)}
\DoxyCodeLine{02359\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribI4ui"{}});}
\DoxyCodeLine{02360\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02361\ \ \ \ \ \_glVertexAttribIPointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02362\ \ \ \ \ \_glVertexAttribI4ui\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02363\ \ \ \}}
\DoxyCodeLine{02364\ }
\DoxyCodeLine{02365\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_func\_extended"{}}))\ \{}
\DoxyCodeLine{02366\ \ \ \ \ \_glBindFragDataLocation\ =\ (PFNGLBINDFRAGDATALOCATIONPROC)}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFragDataLocationEXT"{}});}
\DoxyCodeLine{02368\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02369\ \ \ \ \ \_glBindFragDataLocation\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02370\ \ \ \}}
\DoxyCodeLine{02371\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02372\ }
\DoxyCodeLine{02373\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02374\ \ \ \_use\_vertex\_attrib\_binding\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02375\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02376\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))\ \{}
\DoxyCodeLine{02377\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02378\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_attrib\_binding"{}}))\ \{}
\DoxyCodeLine{02379\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02380\ \ \ \ \ \_glBindVertexBuffer\ =\ (PFNGLBINDVERTEXBUFFERPROC)}
\DoxyCodeLine{02381\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindVertexBuffer"{}});}
\DoxyCodeLine{02382\ \ \ \ \ \_glVertexAttribFormat\ =\ (PFNGLVERTEXATTRIBFORMATPROC)}
\DoxyCodeLine{02383\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribFormat"{}});}
\DoxyCodeLine{02384\ \ \ \ \ \_glVertexAttribIFormat\ =\ (PFNGLVERTEXATTRIBIFORMATPROC)}
\DoxyCodeLine{02385\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribIFormat"{}});}
\DoxyCodeLine{02386\ \ \ \ \ \_glVertexAttribBinding\ =\ (PFNGLVERTEXATTRIBBINDINGPROC)}
\DoxyCodeLine{02387\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribBinding"{}});}
\DoxyCodeLine{02388\ \ \ \ \ \_glVertexBindingDivisor\ =\ (PFNGLVERTEXBINDINGDIVISORPROC)}
\DoxyCodeLine{02389\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexBindingDivisor"{}});}
\DoxyCodeLine{02390\ }
\DoxyCodeLine{02391\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02392\ \ \ \ \ \_glVertexAttribLFormat\ =\ (PFNGLVERTEXATTRIBLFORMATPROC)}
\DoxyCodeLine{02393\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribLFormat"{}});}
\DoxyCodeLine{02394\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02395\ }
\DoxyCodeLine{02396\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_fixed\_vertex\_attrib\_locations)\ \{}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \_use\_vertex\_attrib\_binding\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02398\ \ \ \ \ \}}
\DoxyCodeLine{02399\ \ \ \}}
\DoxyCodeLine{02400\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02401\ }
\DoxyCodeLine{02402\ \ \ \textcolor{comment}{//\ We\ need\ to\ have\ a\ default\ shader\ to\ apply\ in\ case\ something\ didn't\ happen}}
\DoxyCodeLine{02403\ \ \ \textcolor{comment}{//\ to\ have\ a\ shader\ applied,\ or\ if\ it\ failed\ to\ compile.\ \ This\ default}}
\DoxyCodeLine{02404\ \ \ \textcolor{comment}{//\ shader\ just\ outputs\ a\ red\ color,\ indicating\ that\ something\ went\ wrong.}}
\DoxyCodeLine{02405\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02406\ \ \ \textcolor{keywordflow}{if}\ (\_default\_shader\ ==\ \textcolor{keyword}{nullptr}\ \&\&\ !has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{02407\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02408\ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_float64\ =\ vertices\_float64;}
\DoxyCodeLine{02409\ \ \ \ \ \textcolor{keywordflow}{if}\ (use\_float64\ \&\&\ is\_at\_least\_gl\_version(4,\ 1))\ \{}
\DoxyCodeLine{02410\ \ \ \ \ \ \ \_default\_shader\ =\ Shader::make(Shader::SL\_GLSL,\ default\_vshader\_fp64\_gl41,\ default\_fshader);}
\DoxyCodeLine{02411\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (use\_float64\ \&\&\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_vertex\_attrib\_64bit"{}}))\ \{}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \_default\_shader\ =\ Shader::make(Shader::SL\_GLSL,\ default\_vshader\_fp64,\ default\_fshader);}
\DoxyCodeLine{02413\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02414\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02415\ \ \ \ \ \{}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \_default\_shader\ =\ Shader::make(Shader::SL\_GLSL,\ default\_vshader,\ default\_fshader);}
\DoxyCodeLine{02417\ \ \ \ \ \}}
\DoxyCodeLine{02418\ \ \ \}}
\DoxyCodeLine{02419\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02422\ \ \ \textcolor{comment}{//\ Check\ for\ uniform\ buffers.}}
\DoxyCodeLine{02423\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02424\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 1)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_uniform\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{02425\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02426\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02427\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02428\ \ \ \ \ \_supports\_uniform\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02429\ \ \ \ \ \_glGetActiveUniformsiv\ =\ (PFNGLGETACTIVEUNIFORMSIVPROC)}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetActiveUniformsiv"{}});}
\DoxyCodeLine{02431\ \ \ \ \ \_glGetActiveUniformBlockiv\ =\ (PFNGLGETACTIVEUNIFORMBLOCKIVPROC)}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetActiveUniformBlockiv"{}});}
\DoxyCodeLine{02433\ \ \ \ \ \_glGetActiveUniformBlockName\ =\ (PFNGLGETACTIVEUNIFORMBLOCKNAMEPROC)}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetActiveUniformBlockName"{}});}
\DoxyCodeLine{02435\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02436\ \ \ \ \ \_supports\_uniform\_buffers\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02437\ \ \ \}}
\DoxyCodeLine{02438\ }
\DoxyCodeLine{02439\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02440\ \ \ \textcolor{comment}{//\ Check\ for\ SSBOs.}}
\DoxyCodeLine{02441\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}ARB\_shader\_storage\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{02442\ \ \ \ \ \_supports\_shader\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02443\ \ \ \ \ \_glGetProgramInterfaceiv\ =\ (PFNGLGETPROGRAMINTERFACEIVPROC)}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramInterfaceiv"{}});}
\DoxyCodeLine{02445\ \ \ \ \ \_glGetProgramResourceName\ =\ (PFNGLGETPROGRAMRESOURCENAMEPROC)}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramResourceName"{}});}
\DoxyCodeLine{02447\ \ \ \ \ \_glGetProgramResourceiv\ =\ (PFNGLGETPROGRAMRESOURCEIVPROC)}
\DoxyCodeLine{02448\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramResourceiv"{}});}
\DoxyCodeLine{02449\ \ \ \ \ \_glShaderStorageBlockBinding\ =\ (PFNGLSHADERSTORAGEBLOCKBINDINGPROC)}
\DoxyCodeLine{02450\ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glShaderStorageBlockBinding"{}});}
\DoxyCodeLine{02451\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02452\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02453\ \ \ \{}
\DoxyCodeLine{02454\ \ \ \ \ \_supports\_shader\_buffers\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02455\ \ \ \}}
\DoxyCodeLine{02456\ }
\DoxyCodeLine{02457\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_uniform\_buffers\ ||\ \_supports\_shader\_buffers)\ \{}
\DoxyCodeLine{02458\ \ \ \ \ \_glBindBufferBase\ =\ (PFNGLBINDBUFFERBASEPROC)}
\DoxyCodeLine{02459\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindBufferBase"{}});}
\DoxyCodeLine{02460\ \ \ \}}
\DoxyCodeLine{02461\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02462\ }
\DoxyCodeLine{02463\ \ \ \textcolor{comment}{//\ Check\ whether\ we\ support\ geometry\ instancing\ and\ instanced\ vertex}}
\DoxyCodeLine{02464\ \ \ \textcolor{comment}{//\ attribs.}}
\DoxyCodeLine{02465\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_1)}}
\DoxyCodeLine{02466\ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02467\ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02468\ }
\DoxyCodeLine{02469\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{02470\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02471\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 3\ has\ all\ of\ this\ in\ the\ core.}}
\DoxyCodeLine{02472\ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02473\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisor"{}});}
\DoxyCodeLine{02474\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02475\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstanced"{}});}
\DoxyCodeLine{02476\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02477\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstanced"{}});}
\DoxyCodeLine{02478\ }
\DoxyCodeLine{02479\ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02480\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02481\ }
\DoxyCodeLine{02482\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ANGLE\_instanced\_arrays"{}}))\ \{}
\DoxyCodeLine{02483\ \ \ \ \ \textcolor{comment}{//\ This\ extension\ has\ both\ things\ in\ one.}}
\DoxyCodeLine{02484\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{02485\ \ \ \ \ \textcolor{comment}{//\ Work\ around\ bug\ -\/\ it\ doesn't\ allow\ ANGLE\ suffix\ in\ getProcAddress.}}
\DoxyCodeLine{02486\ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02487\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisor"{}});}
\DoxyCodeLine{02488\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02489\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstanced"{}});}
\DoxyCodeLine{02490\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02491\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstanced"{}});}
\DoxyCodeLine{02492\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02493\ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02494\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisorANGLE"{}});}
\DoxyCodeLine{02495\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02496\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstancedANGLE"{}});}
\DoxyCodeLine{02497\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02498\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstancedANGLE"{}});}
\DoxyCodeLine{02499\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02500\ }
\DoxyCodeLine{02501\ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02502\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02503\ }
\DoxyCodeLine{02504\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02505\ \ \ \ \ \textcolor{comment}{//\ Check\ separately\ for\ geometry\ instancing\ and\ instanced\ attribs.}}
\DoxyCodeLine{02506\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_draw\_instanced"{}}))\ \{}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02508\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstancedEXT"{}});}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02510\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstancedEXT"{}});}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02512\ }
\DoxyCodeLine{02513\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_draw\_instanced"{}}))\ \{}
\DoxyCodeLine{02514\ \ \ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstancedNV"{}});}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstancedNV"{}});}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02519\ }
\DoxyCodeLine{02520\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02522\ \ \ \ \ \}}
\DoxyCodeLine{02523\ }
\DoxyCodeLine{02524\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_instanced\_arrays"{}}))\ \{}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisorEXT"{}});}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02528\ }
\DoxyCodeLine{02529\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_instanced\_arrays"{}}))\ \{}
\DoxyCodeLine{02530\ \ \ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02531\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisorNV"{}});}
\DoxyCodeLine{02532\ \ \ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02533\ }
\DoxyCodeLine{02534\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02536\ \ \ \ \ \}}
\DoxyCodeLine{02537\ \ \ \}}
\DoxyCodeLine{02538\ }
\DoxyCodeLine{02539\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02540\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 3))\ \{}
\DoxyCodeLine{02541\ \ \ \ \ \textcolor{comment}{//\ This\ feature\ is\ in\ OpenGL\ core\ as\ of\ 3.3.}}
\DoxyCodeLine{02542\ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02543\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisor"{}});}
\DoxyCodeLine{02544\ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02545\ }
\DoxyCodeLine{02546\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_instanced\_arrays"{}}))\ \{}
\DoxyCodeLine{02547\ \ \ \ \ \_glVertexAttribDivisor\ =\ (PFNGLVERTEXATTRIBDIVISORPROC)}
\DoxyCodeLine{02548\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glVertexAttribDivisorARB"{}});}
\DoxyCodeLine{02549\ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02550\ }
\DoxyCodeLine{02551\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02552\ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02553\ \ \ \}}
\DoxyCodeLine{02554\ }
\DoxyCodeLine{02555\ \ \ \textcolor{comment}{//\ Some\ drivers\ expose\ one\ extension,\ some\ expose\ the\ other.}}
\DoxyCodeLine{02556\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 1))\ \{}
\DoxyCodeLine{02557\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02558\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstanced"{}});}
\DoxyCodeLine{02559\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02560\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstanced"{}});}
\DoxyCodeLine{02561\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02562\ }
\DoxyCodeLine{02563\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_draw\_instanced"{}}))\ \{}
\DoxyCodeLine{02564\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02565\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstancedARB"{}});}
\DoxyCodeLine{02566\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02567\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstancedARB"{}});}
\DoxyCodeLine{02568\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02569\ }
\DoxyCodeLine{02570\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_draw\_instanced"{}}))\ \{}
\DoxyCodeLine{02571\ \ \ \ \ \_glDrawArraysInstanced\ =\ (PFNGLDRAWARRAYSINSTANCEDPROC)}
\DoxyCodeLine{02572\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysInstancedEXT"{}});}
\DoxyCodeLine{02573\ \ \ \ \ \_glDrawElementsInstanced\ =\ (PFNGLDRAWELEMENTSINSTANCEDPROC)}
\DoxyCodeLine{02574\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsInstancedEXT"{}});}
\DoxyCodeLine{02575\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02576\ }
\DoxyCodeLine{02577\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02578\ \ \ \ \ \_glDrawElementsInstanced\ =\ 0;}
\DoxyCodeLine{02579\ \ \ \ \ \_glDrawArraysInstanced\ =\ 0;}
\DoxyCodeLine{02580\ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02581\ \ \ \}}
\DoxyCodeLine{02582\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02583\ }
\DoxyCodeLine{02584\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02585\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_geometry\_instancing)\ \{}
\DoxyCodeLine{02586\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glDrawArraysInstanced\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDrawElementsInstanced\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02587\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{02588\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Geometry\ instancing\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \_supports\_geometry\_instancing\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02590\ \ \ \ \ \}}
\DoxyCodeLine{02591\ \ \ \}}
\DoxyCodeLine{02592\ }
\DoxyCodeLine{02593\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_vertex\_attrib\_divisor)\ \{}
\DoxyCodeLine{02594\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glVertexAttribDivisor\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02595\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{02596\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Instanced\ vertex\ arrays\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{02597\ \ \ \ \ \ \ \_supports\_vertex\_attrib\_divisor\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02598\ \ \ \ \ \}}
\DoxyCodeLine{02599\ \ \ \}}
\DoxyCodeLine{02600\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02601\ }
\DoxyCodeLine{02602\ \ \ \textcolor{comment}{//\ Check\ if\ we\ support\ indirect\ draw.}}
\DoxyCodeLine{02603\ \ \ \_supports\_indirect\_draw\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02604\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02605\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02606\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))\ \{}
\DoxyCodeLine{02607\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02608\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_draw\_indirect"{}}))\ \{}
\DoxyCodeLine{02609\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02610\ \ \ \ \ \_glDrawArraysIndirect\ =\ (PFNGLDRAWARRAYSINDIRECTPROC)}
\DoxyCodeLine{02611\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawArraysIndirect"{}});}
\DoxyCodeLine{02612\ \ \ \ \ \_glDrawElementsIndirect\ =\ (PFNGLDRAWELEMENTSINDIRECTPROC)}
\DoxyCodeLine{02613\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawElementsIndirect"{}});}
\DoxyCodeLine{02614\ }
\DoxyCodeLine{02615\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glDrawArraysIndirect\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDrawElementsIndirect\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02616\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{02617\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Indirect\ draw\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{02618\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \_supports\_indirect\_draw\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02620\ \ \ \ \ \}}
\DoxyCodeLine{02621\ \ \ \}}
\DoxyCodeLine{02622\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02623\ }
\DoxyCodeLine{02624\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{02625\ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02626\ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02627\ }
\DoxyCodeLine{02628\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_framebuffer\_object"{}}))\ \{}
\DoxyCodeLine{02629\ \ \ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02630\ \ \ \ \ \_glIsRenderbuffer\ =\ (PFNGLISRENDERBUFFEROESPROC)}
\DoxyCodeLine{02631\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsRenderbufferOES"{}});}
\DoxyCodeLine{02632\ \ \ \ \ \_glBindRenderbuffer\ =\ (PFNGLBINDRENDERBUFFEROESPROC)}
\DoxyCodeLine{02633\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindRenderbufferOES"{}});}
\DoxyCodeLine{02634\ \ \ \ \ \_glDeleteRenderbuffers\ =\ (PFNGLDELETERENDERBUFFERSOESPROC)}
\DoxyCodeLine{02635\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteRenderbuffersOES"{}});}
\DoxyCodeLine{02636\ \ \ \ \ \_glGenRenderbuffers\ =\ (PFNGLGENRENDERBUFFERSOESPROC)}
\DoxyCodeLine{02637\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenRenderbuffersOES"{}});}
\DoxyCodeLine{02638\ \ \ \ \ \_glRenderbufferStorage\ =\ (PFNGLRENDERBUFFERSTORAGEOESPROC)}
\DoxyCodeLine{02639\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageOES"{}});}
\DoxyCodeLine{02640\ \ \ \ \ \_glGetRenderbufferParameteriv\ =\ (PFNGLGETRENDERBUFFERPARAMETERIVOESPROC)}
\DoxyCodeLine{02641\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetRenderbufferParameterivOES"{}});}
\DoxyCodeLine{02642\ \ \ \ \ \_glIsFramebuffer\ =\ (PFNGLISFRAMEBUFFEROESPROC)}
\DoxyCodeLine{02643\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsFramebufferOES"{}});}
\DoxyCodeLine{02644\ \ \ \ \ \_glBindFramebuffer\ =\ (PFNGLBINDFRAMEBUFFEROESPROC)}
\DoxyCodeLine{02645\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFramebufferOES"{}});}
\DoxyCodeLine{02646\ \ \ \ \ \_glDeleteFramebuffers\ =\ (PFNGLDELETEFRAMEBUFFERSOESPROC)}
\DoxyCodeLine{02647\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteFramebuffersOES"{}});}
\DoxyCodeLine{02648\ \ \ \ \ \_glGenFramebuffers\ =\ (PFNGLGENFRAMEBUFFERSOESPROC)}
\DoxyCodeLine{02649\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenFramebuffersOES"{}});}
\DoxyCodeLine{02650\ \ \ \ \ \_glCheckFramebufferStatus\ =\ (PFNGLCHECKFRAMEBUFFERSTATUSOESPROC)}
\DoxyCodeLine{02651\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCheckFramebufferStatusOES"{}});}
\DoxyCodeLine{02652\ \ \ \ \ \_glFramebufferTexture1D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02653\ \ \ \ \ \_glFramebufferTexture2D\ =\ (PFNGLFRAMEBUFFERTEXTURE2DOESPROC)}
\DoxyCodeLine{02654\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture2DOES"{}});}
\DoxyCodeLine{02655\ \ \ \ \ \_glFramebufferRenderbuffer\ =\ (PFNGLFRAMEBUFFERRENDERBUFFEROESPROC)}
\DoxyCodeLine{02656\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferRenderbufferOES"{}});}
\DoxyCodeLine{02657\ \ \ \ \ \_glGetFramebufferAttachmentParameteriv\ =\ (PFNGLGETFRAMEBUFFERATTACHMENTPARAMETERIVOESPROC)}
\DoxyCodeLine{02658\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetFramebufferAttachmentParameterivOES"{}});}
\DoxyCodeLine{02659\ \ \ \ \ \_glGenerateMipmap\ =\ (PFNGLGENERATEMIPMAPOESPROC)}
\DoxyCodeLine{02660\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenerateMipmapOES"{}});}
\DoxyCodeLine{02661\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02662\ \ \ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02663\ \ \ \ \ \_glGenerateMipmap\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02664\ \ \ \}}
\DoxyCodeLine{02665\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{02666\ \ \ \textcolor{comment}{//\ In\ OpenGL\ ES\ 2.x,\ FBO's\ are\ supported\ in\ the\ core.}}
\DoxyCodeLine{02667\ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02668\ \ \ \_glIsRenderbuffer\ =\ glIsRenderbuffer;}
\DoxyCodeLine{02669\ \ \ \_glBindRenderbuffer\ =\ glBindRenderbuffer;}
\DoxyCodeLine{02670\ \ \ \_glDeleteRenderbuffers\ =\ glDeleteRenderbuffers;}
\DoxyCodeLine{02671\ \ \ \_glGenRenderbuffers\ =\ glGenRenderbuffers;}
\DoxyCodeLine{02672\ \ \ \_glRenderbufferStorage\ =\ glRenderbufferStorage;}
\DoxyCodeLine{02673\ \ \ \_glGetRenderbufferParameteriv\ =\ glGetRenderbufferParameteriv;}
\DoxyCodeLine{02674\ \ \ \_glIsFramebuffer\ =\ glIsFramebuffer;}
\DoxyCodeLine{02675\ \ \ \_glBindFramebuffer\ =\ glBindFramebuffer;}
\DoxyCodeLine{02676\ \ \ \_glDeleteFramebuffers\ =\ glDeleteFramebuffers;}
\DoxyCodeLine{02677\ \ \ \_glGenFramebuffers\ =\ glGenFramebuffers;}
\DoxyCodeLine{02678\ \ \ \_glCheckFramebufferStatus\ =\ glCheckFramebufferStatus;}
\DoxyCodeLine{02679\ \ \ \_glFramebufferTexture1D\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02680\ \ \ \_glFramebufferTexture2D\ =\ glFramebufferTexture2D;}
\DoxyCodeLine{02681\ \ \ \_glFramebufferRenderbuffer\ =\ glFramebufferRenderbuffer;}
\DoxyCodeLine{02682\ \ \ \_glGetFramebufferAttachmentParameteriv\ =\ glGetFramebufferAttachmentParameteriv;}
\DoxyCodeLine{02683\ \ \ \_glGenerateMipmap\ =\ glGenerateMipmap;}
\DoxyCodeLine{02684\ }
\DoxyCodeLine{02685\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02686\ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02687\ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02688\ }
\DoxyCodeLine{02689\ \ \ \ \ \_glRenderbufferStorageMultisample\ =\ (PFNGLRENDERBUFFERSTORAGEMULTISAMPLEEXTPROC)}
\DoxyCodeLine{02690\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageMultisample"{}});}
\DoxyCodeLine{02691\ \ \ \ \ \_glBlitFramebuffer\ =\ (PFNGLBLITFRAMEBUFFEREXTPROC)}
\DoxyCodeLine{02692\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlitFramebuffer"{}});}
\DoxyCodeLine{02693\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02694\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ANGLE\_framebuffer\_multisample"{}}))\ \{}
\DoxyCodeLine{02695\ \ \ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02696\ \ \ \ \ \ \ \_glRenderbufferStorageMultisample\ =\ (PFNGLRENDERBUFFERSTORAGEMULTISAMPLEANGLEPROC)}
\DoxyCodeLine{02697\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageMultisampleANGLE"{}});}
\DoxyCodeLine{02698\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02699\ \ \ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02700\ \ \ \ \ \}}
\DoxyCodeLine{02701\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ANGLE\_framebuffer\_blit"{}}))\ \{}
\DoxyCodeLine{02702\ \ \ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02703\ \ \ \ \ \ \ \_glBlitFramebuffer\ =\ (PFNGLBLITFRAMEBUFFERANGLEPROC)}
\DoxyCodeLine{02704\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlitFramebufferANGLE"{}});}
\DoxyCodeLine{02705\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02706\ \ \ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02707\ \ \ \ \ \}}
\DoxyCodeLine{02708\ \ \ \}}
\DoxyCodeLine{02709\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ Desktop\ OpenGL\ case.}}
\DoxyCodeLine{02710\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_framebuffer\_object"{}}))\ \{}
\DoxyCodeLine{02711\ \ \ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02712\ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02713\ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02714\ }
\DoxyCodeLine{02715\ \ \ \ \ \_glIsRenderbuffer\ =\ (PFNGLISRENDERBUFFERPROC)}
\DoxyCodeLine{02716\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsRenderbuffer"{}});}
\DoxyCodeLine{02717\ \ \ \ \ \_glBindRenderbuffer\ =\ (PFNGLBINDRENDERBUFFERPROC)}
\DoxyCodeLine{02718\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindRenderbuffer"{}});}
\DoxyCodeLine{02719\ \ \ \ \ \_glDeleteRenderbuffers\ =\ (PFNGLDELETERENDERBUFFERSPROC)}
\DoxyCodeLine{02720\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteRenderbuffers"{}});}
\DoxyCodeLine{02721\ \ \ \ \ \_glGenRenderbuffers\ =\ (PFNGLGENRENDERBUFFERSPROC)}
\DoxyCodeLine{02722\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenRenderbuffers"{}});}
\DoxyCodeLine{02723\ \ \ \ \ \_glRenderbufferStorage\ =\ (PFNGLRENDERBUFFERSTORAGEPROC)}
\DoxyCodeLine{02724\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorage"{}});}
\DoxyCodeLine{02725\ \ \ \ \ \_glGetRenderbufferParameteriv\ =\ (PFNGLGETRENDERBUFFERPARAMETERIVPROC)}
\DoxyCodeLine{02726\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetRenderbufferParameteriv"{}});}
\DoxyCodeLine{02727\ \ \ \ \ \_glIsFramebuffer\ =\ (PFNGLISFRAMEBUFFERPROC)}
\DoxyCodeLine{02728\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsFramebuffer"{}});}
\DoxyCodeLine{02729\ \ \ \ \ \_glBindFramebuffer\ =\ (PFNGLBINDFRAMEBUFFERPROC)}
\DoxyCodeLine{02730\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFramebuffer"{}});}
\DoxyCodeLine{02731\ \ \ \ \ \_glDeleteFramebuffers\ =\ (PFNGLDELETEFRAMEBUFFERSPROC)}
\DoxyCodeLine{02732\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteFramebuffers"{}});}
\DoxyCodeLine{02733\ \ \ \ \ \_glGenFramebuffers\ =\ (PFNGLGENFRAMEBUFFERSPROC)}
\DoxyCodeLine{02734\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenFramebuffers"{}});}
\DoxyCodeLine{02735\ \ \ \ \ \_glCheckFramebufferStatus\ =\ (PFNGLCHECKFRAMEBUFFERSTATUSPROC)}
\DoxyCodeLine{02736\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCheckFramebufferStatus"{}});}
\DoxyCodeLine{02737\ \ \ \ \ \_glFramebufferTexture1D\ =\ (PFNGLFRAMEBUFFERTEXTURE1DPROC)}
\DoxyCodeLine{02738\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture1D"{}});}
\DoxyCodeLine{02739\ \ \ \ \ \_glFramebufferTexture2D\ =\ (PFNGLFRAMEBUFFERTEXTURE2DPROC)}
\DoxyCodeLine{02740\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture2D"{}});}
\DoxyCodeLine{02741\ \ \ \ \ \_glFramebufferTexture3D\ =\ (PFNGLFRAMEBUFFERTEXTURE3DPROC)}
\DoxyCodeLine{02742\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture3D"{}});}
\DoxyCodeLine{02743\ \ \ \ \ \_glFramebufferRenderbuffer\ =\ (PFNGLFRAMEBUFFERRENDERBUFFERPROC)}
\DoxyCodeLine{02744\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferRenderbuffer"{}});}
\DoxyCodeLine{02745\ \ \ \ \ \_glGetFramebufferAttachmentParameteriv\ =\ (PFNGLGETFRAMEBUFFERATTACHMENTPARAMETERIVPROC)}
\DoxyCodeLine{02746\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetFramebufferAttachmentParameteriv"{}});}
\DoxyCodeLine{02747\ \ \ \ \ \_glGenerateMipmap\ =\ (PFNGLGENERATEMIPMAPPROC)}
\DoxyCodeLine{02748\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenerateMipmap"{}});}
\DoxyCodeLine{02749\ \ \ \ \ \_glRenderbufferStorageMultisample\ =\ (PFNGLRENDERBUFFERSTORAGEMULTISAMPLEPROC)}
\DoxyCodeLine{02750\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageMultisample"{}});}
\DoxyCodeLine{02751\ \ \ \ \ \_glBlitFramebuffer\ =\ (PFNGLBLITFRAMEBUFFERPROC)}
\DoxyCodeLine{02752\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlitFramebuffer"{}});}
\DoxyCodeLine{02753\ }
\DoxyCodeLine{02754\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_framebuffer\_object"{}}))\ \{}
\DoxyCodeLine{02755\ \ \ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02756\ \ \ \ \ \_glIsRenderbuffer\ =\ (PFNGLISRENDERBUFFEREXTPROC)}
\DoxyCodeLine{02757\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsRenderbufferEXT"{}});}
\DoxyCodeLine{02758\ \ \ \ \ \_glBindRenderbuffer\ =\ (PFNGLBINDRENDERBUFFEREXTPROC)}
\DoxyCodeLine{02759\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindRenderbufferEXT"{}});}
\DoxyCodeLine{02760\ \ \ \ \ \_glDeleteRenderbuffers\ =\ (PFNGLDELETERENDERBUFFERSEXTPROC)}
\DoxyCodeLine{02761\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteRenderbuffersEXT"{}});}
\DoxyCodeLine{02762\ \ \ \ \ \_glGenRenderbuffers\ =\ (PFNGLGENRENDERBUFFERSEXTPROC)}
\DoxyCodeLine{02763\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenRenderbuffersEXT"{}});}
\DoxyCodeLine{02764\ \ \ \ \ \_glRenderbufferStorage\ =\ (PFNGLRENDERBUFFERSTORAGEEXTPROC)}
\DoxyCodeLine{02765\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageEXT"{}});}
\DoxyCodeLine{02766\ \ \ \ \ \_glGetRenderbufferParameteriv\ =\ (PFNGLGETRENDERBUFFERPARAMETERIVEXTPROC)}
\DoxyCodeLine{02767\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetRenderbufferParameterivEXT"{}});}
\DoxyCodeLine{02768\ \ \ \ \ \_glIsFramebuffer\ =\ (PFNGLISFRAMEBUFFEREXTPROC)}
\DoxyCodeLine{02769\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glIsFramebufferEXT"{}});}
\DoxyCodeLine{02770\ \ \ \ \ \_glBindFramebuffer\ =\ (PFNGLBINDFRAMEBUFFEREXTPROC)}
\DoxyCodeLine{02771\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindFramebufferEXT"{}});}
\DoxyCodeLine{02772\ \ \ \ \ \_glDeleteFramebuffers\ =\ (PFNGLDELETEFRAMEBUFFERSEXTPROC)}
\DoxyCodeLine{02773\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteFramebuffersEXT"{}});}
\DoxyCodeLine{02774\ \ \ \ \ \_glGenFramebuffers\ =\ (PFNGLGENFRAMEBUFFERSEXTPROC)}
\DoxyCodeLine{02775\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenFramebuffersEXT"{}});}
\DoxyCodeLine{02776\ \ \ \ \ \_glCheckFramebufferStatus\ =\ (PFNGLCHECKFRAMEBUFFERSTATUSEXTPROC)}
\DoxyCodeLine{02777\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCheckFramebufferStatusEXT"{}});}
\DoxyCodeLine{02778\ \ \ \ \ \_glFramebufferTexture1D\ =\ (PFNGLFRAMEBUFFERTEXTURE1DEXTPROC)}
\DoxyCodeLine{02779\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture1DEXT"{}});}
\DoxyCodeLine{02780\ \ \ \ \ \_glFramebufferTexture2D\ =\ (PFNGLFRAMEBUFFERTEXTURE2DEXTPROC)}
\DoxyCodeLine{02781\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture2DEXT"{}});}
\DoxyCodeLine{02782\ \ \ \ \ \_glFramebufferTexture3D\ =\ (PFNGLFRAMEBUFFERTEXTURE3DEXTPROC)}
\DoxyCodeLine{02783\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferTexture3DEXT"{}});}
\DoxyCodeLine{02784\ \ \ \ \ \_glFramebufferRenderbuffer\ =\ (PFNGLFRAMEBUFFERRENDERBUFFEREXTPROC)}
\DoxyCodeLine{02785\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferRenderbufferEXT"{}});}
\DoxyCodeLine{02786\ \ \ \ \ \_glGetFramebufferAttachmentParameteriv\ =\ (PFNGLGETFRAMEBUFFERATTACHMENTPARAMETERIVEXTPROC)}
\DoxyCodeLine{02787\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetFramebufferAttachmentParameterivEXT"{}});}
\DoxyCodeLine{02788\ \ \ \ \ \_glGenerateMipmap\ =\ (PFNGLGENERATEMIPMAPEXTPROC)}
\DoxyCodeLine{02789\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenerateMipmapEXT"{}});}
\DoxyCodeLine{02790\ }
\DoxyCodeLine{02791\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_framebuffer\_multisample"{}}))\ \{}
\DoxyCodeLine{02792\ \ \ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02793\ \ \ \ \ \ \ \_glRenderbufferStorageMultisample\ =\ (PFNGLRENDERBUFFERSTORAGEMULTISAMPLEEXTPROC)}
\DoxyCodeLine{02794\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageMultisampleEXT"{}});}
\DoxyCodeLine{02795\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02796\ \ \ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02797\ \ \ \ \ \}}
\DoxyCodeLine{02798\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_framebuffer\_blit"{}}))\ \{}
\DoxyCodeLine{02799\ \ \ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02800\ \ \ \ \ \ \ \_glBlitFramebuffer\ =\ (PFNGLBLITFRAMEBUFFEREXTPROC)}
\DoxyCodeLine{02801\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlitFramebufferEXT"{}});}
\DoxyCodeLine{02802\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02803\ \ \ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02804\ \ \ \ \ \}}
\DoxyCodeLine{02805\ }
\DoxyCodeLine{02806\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02807\ \ \ \ \ \_supports\_framebuffer\_object\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02808\ \ \ \ \ \_supports\_framebuffer\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02809\ \ \ \ \ \_supports\_framebuffer\_blit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02810\ \ \ \ \ \_glGenerateMipmap\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02811\ \ \ \}}
\DoxyCodeLine{02812\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02813\ }
\DoxyCodeLine{02814\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02815\ \ \ \_glMapNamedBufferRange\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02816\ }
\DoxyCodeLine{02817\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_dsa\ \&\&}
\DoxyCodeLine{02818\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(4,\ 5)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_direct\_state\_access"{}})))\ \{}
\DoxyCodeLine{02819\ \ \ \ \ \_glCreateTextures\ =\ (PFNGLCREATETEXTURESPROC)}
\DoxyCodeLine{02820\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glCreateTextures"{}});}
\DoxyCodeLine{02821\ \ \ \ \ \_glTextureStorage2D\ =\ (PFNGLTEXTURESTORAGE2DPROC)}
\DoxyCodeLine{02822\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTextureStorage2D"{}});}
\DoxyCodeLine{02823\ \ \ \ \ \_glTextureSubImage2D\ =\ (PFNGLTEXTURESUBIMAGE2DPROC)}
\DoxyCodeLine{02824\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTextureSubImage2D"{}});}
\DoxyCodeLine{02825\ \ \ \ \ \_glTextureParameteri\ =\ (PFNGLTEXTUREPARAMETERIPROC)}
\DoxyCodeLine{02826\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glTextureParameteri"{}});}
\DoxyCodeLine{02827\ \ \ \ \ \_glGenerateTextureMipmap\ =\ (PFNGLGENERATETEXTUREMIPMAPPROC)}
\DoxyCodeLine{02828\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenerateTextureMipmap"{}});}
\DoxyCodeLine{02829\ \ \ \ \ \_glBindTextureUnit\ =\ (PFNGLBINDTEXTUREUNITPROC)}
\DoxyCodeLine{02830\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindTextureUnit"{}});}
\DoxyCodeLine{02831\ }
\DoxyCodeLine{02832\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glMapBufferRange\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02833\ \ \ \ \ \ \ \_glMapNamedBufferRange\ =\ (PFNGLMAPNAMEDBUFFERRANGEPROC)}
\DoxyCodeLine{02834\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMapNamedBufferRange"{}});}
\DoxyCodeLine{02835\ \ \ \ \ \}}
\DoxyCodeLine{02836\ }
\DoxyCodeLine{02837\ \ \ \ \ \_supports\_dsa\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02838\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02839\ \ \ \ \ \_supports\_dsa\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02840\ \ \ \}}
\DoxyCodeLine{02841\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02842\ }
\DoxyCodeLine{02843\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02844\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02845\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_pixel\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{02846\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02847\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(2,\ 1)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_pixel\_buffer\_object"{}}))\ \{}
\DoxyCodeLine{02848\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02849\ \ \ \ \ \_supports\_pixel\_buffers\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02850\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02851\ \ \ \ \ \_supports\_pixel\_buffers\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02852\ \ \ \}}
\DoxyCodeLine{02853\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02854\ }
\DoxyCodeLine{02855\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02856\ \ \ \textcolor{comment}{//\ Do\ we\ support\ empty\ framebuffer\ objects?}}
\DoxyCodeLine{02857\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{02858\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))\ \{}
\DoxyCodeLine{02859\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02860\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_framebuffer\_no\_attachments"{}}))\ \{}
\DoxyCodeLine{02861\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02862\ \ \ \ \ \_glFramebufferParameteri\ =\ (PFNGLFRAMEBUFFERPARAMETERIPROC)}
\DoxyCodeLine{02863\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glFramebufferParameteri"{}});}
\DoxyCodeLine{02864\ \ \ \ \ \_supports\_empty\_framebuffer\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02865\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02866\ \ \ \ \ \_supports\_empty\_framebuffer\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02867\ \ \ \}}
\DoxyCodeLine{02868\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{02869\ }
\DoxyCodeLine{02870\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02871\ \ \ \_supports\_framebuffer\_multisample\_coverage\_nv\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02872\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_framebuffer\_multisample\ \&\&}
\DoxyCodeLine{02873\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_framebuffer\_multisample\_coverage"{}}))\ \{}
\DoxyCodeLine{02874\ \ \ \ \ \_supports\_framebuffer\_multisample\_coverage\_nv\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02875\ \ \ \ \ \_glRenderbufferStorageMultisampleCoverage\ =\ (PFNGLRENDERBUFFERSTORAGEMULTISAMPLECOVERAGENVPROC)}
\DoxyCodeLine{02876\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glRenderbufferStorageMultisampleCoverageNV"{}});}
\DoxyCodeLine{02877\ \ \ \}}
\DoxyCodeLine{02878\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02879\ }
\DoxyCodeLine{02880\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_1)}}
\DoxyCodeLine{02881\ \ \ \_glDrawBuffers\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02882\ \ \ \_max\_color\_targets\ =\ 1;}
\DoxyCodeLine{02883\ }
\DoxyCodeLine{02884\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES\_2)}}
\DoxyCodeLine{02885\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02886\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02887\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffers"{}});}
\DoxyCodeLine{02888\ }
\DoxyCodeLine{02889\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{02890\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}WEBGL\_draw\_buffers"{}}))\ \{}
\DoxyCodeLine{02891\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02892\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffers"{}});}
\DoxyCodeLine{02893\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ EMSCRIPTEN}}
\DoxyCodeLine{02894\ }
\DoxyCodeLine{02895\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_draw\_buffers"{}}))\ \{}
\DoxyCodeLine{02896\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02897\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffersEXT"{}});}
\DoxyCodeLine{02898\ }
\DoxyCodeLine{02899\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_draw\_buffers"{}}))\ \{}
\DoxyCodeLine{02900\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02901\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffersNV"{}});}
\DoxyCodeLine{02902\ }
\DoxyCodeLine{02903\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02904\ \ \ \ \ \_glDrawBuffers\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02905\ \ \ \}}
\DoxyCodeLine{02906\ }
\DoxyCodeLine{02907\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{02908\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(2,\ 0))\ \{}
\DoxyCodeLine{02909\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02910\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffers"{}});}
\DoxyCodeLine{02911\ }
\DoxyCodeLine{02912\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_draw\_buffers"{}}))\ \{}
\DoxyCodeLine{02913\ \ \ \ \ \_glDrawBuffers\ =\ (PFNGLDRAWBUFFERSPROC)}
\DoxyCodeLine{02914\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDrawBuffersARB"{}});}
\DoxyCodeLine{02915\ }
\DoxyCodeLine{02916\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02917\ \ \ \ \ \_glDrawBuffers\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02918\ \ \ \}}
\DoxyCodeLine{02919\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02920\ }
\DoxyCodeLine{02921\ \textcolor{preprocessor}{\#if\ defined(OPENGLES)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{02922\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{02923\ \ \ \ \ \_glReadBuffer\ =\ (PFNGLREADBUFFERPROC)}
\DoxyCodeLine{02924\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glReadBuffer"{}});}
\DoxyCodeLine{02925\ }
\DoxyCodeLine{02926\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_read\_buffer"{}}))\ \{}
\DoxyCodeLine{02927\ \ \ \ \ \_glReadBuffer\ =\ (PFNGLREADBUFFERPROC)}
\DoxyCodeLine{02928\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glReadBufferNV"{}});}
\DoxyCodeLine{02929\ }
\DoxyCodeLine{02930\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02931\ \ \ \ \ \_glReadBuffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02932\ \ \ \}}
\DoxyCodeLine{02933\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{02934\ }
\DoxyCodeLine{02935\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02936\ \ \ \_max\_color\_targets\ =\ 1;}
\DoxyCodeLine{02937\ \ \ \textcolor{keywordflow}{if}\ (\_glDrawBuffers\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02938\ \ \ \ \ GLint\ max\_draw\_buffers\ =\ 0;}
\DoxyCodeLine{02939\ \ \ \ \ glGetIntegerv(GL\_MAX\_DRAW\_BUFFERS,\ \&max\_draw\_buffers);}
\DoxyCodeLine{02940\ \ \ \ \ \_max\_color\_targets\ =\ max\_draw\_buffers;}
\DoxyCodeLine{02941\ \ \ \}}
\DoxyCodeLine{02942\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{02943\ }
\DoxyCodeLine{02944\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{02945\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 3)\ \{}
\DoxyCodeLine{02946\ \ \ \ \ \_glClearBufferfv\ =\ (PFNGLCLEARBUFFERFVPROC)}
\DoxyCodeLine{02947\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearBufferfv"{}});}
\DoxyCodeLine{02948\ \ \ \ \ \_glClearBufferiv\ =\ (PFNGLCLEARBUFFERIVPROC)}
\DoxyCodeLine{02949\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearBufferiv"{}});}
\DoxyCodeLine{02950\ \ \ \ \ \_glClearBufferfi\ =\ (PFNGLCLEARBUFFERFIPROC)}
\DoxyCodeLine{02951\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glClearBufferfi"{}});}
\DoxyCodeLine{02952\ }
\DoxyCodeLine{02953\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02954\ \ \ \ \ \_glClearBufferfv\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02955\ \ \ \ \ \_glClearBufferiv\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02956\ \ \ \ \ \_glClearBufferfi\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{02957\ \ \ \}}
\DoxyCodeLine{02958\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{02959\ }
\DoxyCodeLine{02960\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02961\ \ \ \_supports\_viewport\_arrays\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02962\ }
\DoxyCodeLine{02963\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 1)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_viewport\_array"{}}))\ \{}
\DoxyCodeLine{02964\ \ \ \ \ \_glViewportArrayv\ =\ (PFNGLVIEWPORTARRAYVPROC)}
\DoxyCodeLine{02965\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glViewportArrayv"{}});}
\DoxyCodeLine{02966\ \ \ \ \ \_glScissorArrayv\ =\ (PFNGLSCISSORARRAYVPROC)}
\DoxyCodeLine{02967\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glScissorArrayv"{}});}
\DoxyCodeLine{02968\ \ \ \ \ \_glDepthRangeArrayv\ =\ (PFNGLDEPTHRANGEARRAYVPROC)}
\DoxyCodeLine{02969\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDepthRangeArrayv"{}});}
\DoxyCodeLine{02970\ }
\DoxyCodeLine{02971\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glViewportArrayv\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glScissorArrayv\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDepthRangeArrayv\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{02972\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{02973\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Viewport\ arrays\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{02974\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{02975\ \ \ \ \ \ \ \_supports\_viewport\_arrays\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02976\ \ \ \ \ \}}
\DoxyCodeLine{02977\ \ \ \}}
\DoxyCodeLine{02978\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{02979\ }
\DoxyCodeLine{02980\ \ \ \_max\_fb\_samples\ =\ 0;}
\DoxyCodeLine{02981\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_framebuffer\_multisample)\ \{}
\DoxyCodeLine{02982\ \ \ \ \ GLint\ max\_samples;}
\DoxyCodeLine{02983\ \ \ \ \ glGetIntegerv(GL\_MAX\_SAMPLES\_EXT,\ \&max\_samples);}
\DoxyCodeLine{02984\ \ \ \ \ \_max\_fb\_samples\ =\ max\_samples;}
\DoxyCodeLine{02985\ \ \ \}}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \ \ \_supports\_occlusion\_query\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02988\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{02989\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_occlusion\_query)\ \{}
\DoxyCodeLine{02990\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 5))\ \{}
\DoxyCodeLine{02991\ \ \ \ \ \ \ \_supports\_occlusion\_query\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02992\ }
\DoxyCodeLine{02993\ \ \ \ \ \ \ \_glGenQueries\ =\ (PFNGLGENQUERIESPROC)}
\DoxyCodeLine{02994\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenQueries"{}});}
\DoxyCodeLine{02995\ \ \ \ \ \ \ \_glBeginQuery\ =\ (PFNGLBEGINQUERYPROC)}
\DoxyCodeLine{02996\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBeginQuery"{}});}
\DoxyCodeLine{02997\ \ \ \ \ \ \ \_glEndQuery\ =\ (PFNGLENDQUERYPROC)}
\DoxyCodeLine{02998\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glEndQuery"{}});}
\DoxyCodeLine{02999\ \ \ \ \ \ \ \_glDeleteQueries\ =\ (PFNGLDELETEQUERIESPROC)}
\DoxyCodeLine{03000\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteQueries"{}});}
\DoxyCodeLine{03001\ \ \ \ \ \ \ \_glGetQueryiv\ =\ (PFNGLGETQUERYIVPROC)}
\DoxyCodeLine{03002\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryiv"{}});}
\DoxyCodeLine{03003\ \ \ \ \ \ \ \_glGetQueryObjectuiv\ =\ (PFNGLGETQUERYOBJECTUIVPROC)}
\DoxyCodeLine{03004\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryObjectuiv"{}});}
\DoxyCodeLine{03005\ }
\DoxyCodeLine{03006\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_occlusion\_query"{}}))\ \{}
\DoxyCodeLine{03007\ \ \ \ \ \ \ \_supports\_occlusion\_query\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \_glGenQueries\ =\ (PFNGLGENQUERIESPROC)}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGenQueriesARB"{}});}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \_glBeginQuery\ =\ (PFNGLBEGINQUERYPROC)}
\DoxyCodeLine{03011\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBeginQueryARB"{}});}
\DoxyCodeLine{03012\ \ \ \ \ \ \ \_glEndQuery\ =\ (PFNGLENDQUERYPROC)}
\DoxyCodeLine{03013\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glEndQueryARB"{}});}
\DoxyCodeLine{03014\ \ \ \ \ \ \ \_glDeleteQueries\ =\ (PFNGLDELETEQUERIESPROC)}
\DoxyCodeLine{03015\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteQueriesARB"{}});}
\DoxyCodeLine{03016\ \ \ \ \ \ \ \_glGetQueryiv\ =\ (PFNGLGETQUERYIVPROC)}
\DoxyCodeLine{03017\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryivARB"{}});}
\DoxyCodeLine{03018\ \ \ \ \ \ \ \_glGetQueryObjectuiv\ =\ (PFNGLGETQUERYOBJECTUIVPROC)}
\DoxyCodeLine{03019\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryObjectuivARB"{}});}
\DoxyCodeLine{03020\ \ \ \ \ \}}
\DoxyCodeLine{03021\ \ \ \}}
\DoxyCodeLine{03022\ }
\DoxyCodeLine{03023\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_occlusion\_query)\ \{}
\DoxyCodeLine{03024\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGenQueries\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glBeginQuery\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ \_glEndQuery\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDeleteQueries\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \_glGetQueryiv\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glGetQueryObjectuiv\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03027\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Occlusion\ queries\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ functions.\(\backslash\)n"{}};}
\DoxyCodeLine{03029\ \ \ \ \ \ \ \_supports\_occlusion\_query\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03030\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03031\ \ \ \ \ \ \ GLint\ num\_bits;}
\DoxyCodeLine{03032\ \ \ \ \ \ \ \_glGetQueryiv(GL\_SAMPLES\_PASSED,\ GL\_QUERY\_COUNTER\_BITS,\ \&num\_bits);}
\DoxyCodeLine{03033\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_bits\ ==\ 0)\ \{}
\DoxyCodeLine{03034\ \ \ \ \ \ \ \ \ \_supports\_occlusion\_query\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03035\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03036\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03038\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Occlusion\ query\ counter\ provides\ "{}}\ <<\ num\_bits\ <<\ \textcolor{stringliteral}{"{}\ bits.\(\backslash\)n"{}};}
\DoxyCodeLine{03039\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03040\ \ \ \ \ \}}
\DoxyCodeLine{03041\ \ \ \}}
\DoxyCodeLine{03042\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{03043\ }
\DoxyCodeLine{03044\ \ \ \_supports\_timer\_query\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03045\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{03046\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_timer\_query"{}}))\ \{}
\DoxyCodeLine{03047\ \ \ \ \ \_supports\_timer\_query\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03048\ }
\DoxyCodeLine{03049\ \ \ \ \ \_glQueryCounter\ =\ (PFNGLQUERYCOUNTERPROC)}
\DoxyCodeLine{03050\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glQueryCounter"{}});}
\DoxyCodeLine{03051\ \ \ \ \ \_glGetQueryObjecti64v\ =\ (PFNGLGETQUERYOBJECTI64VPROC)}
\DoxyCodeLine{03052\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryObjecti64v"{}});}
\DoxyCodeLine{03053\ \ \ \ \ \_glGetQueryObjectui64v\ =\ (PFNGLGETQUERYOBJECTUI64VPROC)}
\DoxyCodeLine{03054\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetQueryObjectui64v"{}});}
\DoxyCodeLine{03055\ }
\DoxyCodeLine{03056\ \ \ \ \ \_glGetInteger64v\ =\ (PFNGLGETINTEGER64VPROC)}
\DoxyCodeLine{03057\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetInteger64v"{}});}
\DoxyCodeLine{03058\ \ \ \}}
\DoxyCodeLine{03059\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03060\ }
\DoxyCodeLine{03061\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{03062\ \ \ \textcolor{comment}{//\ In\ OpenGL\ ES\ 1,\ blending\ is\ supported\ via\ extensions.}}
\DoxyCodeLine{03063\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_blend\_subtract"{}}))\ \{}
\DoxyCodeLine{03064\ \ \ \ \ \_glBlendEquation\ =\ (PFNGLBLENDEQUATIONPROC)}
\DoxyCodeLine{03065\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquationOES"{}});}
\DoxyCodeLine{03066\ }
\DoxyCodeLine{03067\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBlendEquation\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03068\ \ \ \ \ \ \ \_glBlendEquation\ =\ null\_glBlendEquation;}
\DoxyCodeLine{03069\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03070\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendEquationOES\ advertised\ as\ supported\ by\ OpenGL\ ES\ runtime,\ but\ "{}}}
\DoxyCodeLine{03071\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}could\ not\ get\ pointer\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03072\ \ \ \ \ \}}
\DoxyCodeLine{03073\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03074\ \ \ \ \ \_glBlendEquation\ =\ null\_glBlendEquation;}
\DoxyCodeLine{03075\ \ \ \}}
\DoxyCodeLine{03076\ }
\DoxyCodeLine{03077\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_blend\_equation\_separate"{}}))\ \{}
\DoxyCodeLine{03078\ \ \ \ \ \_glBlendEquationSeparate\ =\ (PFNGLBLENDEQUATIONSEPARATEOESPROC)}
\DoxyCodeLine{03079\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquationSeparateOES"{}});}
\DoxyCodeLine{03080\ }
\DoxyCodeLine{03081\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBlendEquation\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03082\ \ \ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03083\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03084\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendEquationSeparateOES\ advertised\ as\ supported\ by\ OpenGL\ ES\ "{}}}
\DoxyCodeLine{03085\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}runtime,\ but\ could\ not\ get\ pointer\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03086\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03087\ \ \ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03088\ \ \ \ \ \}}
\DoxyCodeLine{03089\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03090\ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03091\ \ \ \ \ \_glBlendEquationSeparate\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03092\ \ \ \}}
\DoxyCodeLine{03093\ }
\DoxyCodeLine{03094\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_blend\_func\_separate"{}}))\ \{}
\DoxyCodeLine{03095\ \ \ \ \ \_glBlendFuncSeparate\ =\ (PFNGLBLENDFUNCSEPARATEOESPROC)}
\DoxyCodeLine{03096\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendFuncSeparateOES"{}});}
\DoxyCodeLine{03097\ }
\DoxyCodeLine{03098\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBlendFuncSeparate\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03099\ \ \ \ \ \ \ \_glBlendFuncSeparate\ =\ null\_glBlendFuncSeparate;}
\DoxyCodeLine{03100\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03101\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendFuncSeparateOES\ advertised\ as\ supported\ by\ OpenGL\ ES\ runtime,\ but\ "{}}}
\DoxyCodeLine{03102\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}could\ not\ get\ pointer\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03103\ \ \ \ \ \}}
\DoxyCodeLine{03104\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03105\ \ \ \ \ \_glBlendFuncSeparate\ =\ null\_glBlendFuncSeparate;}
\DoxyCodeLine{03106\ \ \ \}}
\DoxyCodeLine{03107\ }
\DoxyCodeLine{03108\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{03109\ \ \ \textcolor{comment}{//\ In\ OpenGL\ ES\ 2.x\ and\ above,\ this\ is\ supported\ in\ the\ core.}}
\DoxyCodeLine{03110\ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03111\ }
\DoxyCodeLine{03112\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03113\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2))\ \{}
\DoxyCodeLine{03114\ \ \ \ \ \_glBlendEquation\ =\ (PFNGLBLENDEQUATIONPROC)}
\DoxyCodeLine{03115\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquation"{}});}
\DoxyCodeLine{03116\ }
\DoxyCodeLine{03117\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_minmax"{}}))\ \{}
\DoxyCodeLine{03118\ \ \ \ \ \_glBlendEquation\ =\ (PFNGLBLENDEQUATIONPROC)}
\DoxyCodeLine{03119\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquationEXT"{}});}
\DoxyCodeLine{03120\ }
\DoxyCodeLine{03121\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03122\ \ \ \ \ \_glBlendEquation\ =\ null\_glBlendEquation;}
\DoxyCodeLine{03123\ \ \ \}}
\DoxyCodeLine{03124\ }
\DoxyCodeLine{03125\ \ \ \textcolor{keywordflow}{if}\ (\_glBlendEquation\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03126\ \ \ \ \ \_glBlendEquation\ =\ null\_glBlendEquation;}
\DoxyCodeLine{03127\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03128\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendEquation\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ "{}}}
\DoxyCodeLine{03129\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}not\ get\ pointer\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03130\ \ \ \}}
\DoxyCodeLine{03131\ }
\DoxyCodeLine{03132\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(2,\ 0))\ \{}
\DoxyCodeLine{03133\ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03134\ \ \ \ \ \_glBlendEquationSeparate\ =\ (PFNGLBLENDEQUATIONSEPARATEPROC)}
\DoxyCodeLine{03135\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquationSeparate"{}});}
\DoxyCodeLine{03136\ }
\DoxyCodeLine{03137\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_equation\_separate"{}}))\ \{}
\DoxyCodeLine{03138\ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03139\ \ \ \ \ \_glBlendEquationSeparate\ =\ (PFNGLBLENDEQUATIONSEPARATEEXTPROC)}
\DoxyCodeLine{03140\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendEquationSeparateEXT"{}});}
\DoxyCodeLine{03141\ }
\DoxyCodeLine{03142\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03143\ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03144\ \ \ \ \ \_glBlendEquationSeparate\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03145\ \ \ \}}
\DoxyCodeLine{03146\ }
\DoxyCodeLine{03147\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_blend\_equation\_separate\ \&\&\ \_glBlendEquationSeparate\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03148\ \ \ \ \ \_supports\_blend\_equation\_separate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03149\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03150\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendEquationSeparate\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ "{}}}
\DoxyCodeLine{03151\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}but\ could\ not\ get\ pointer\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03152\ \ \ \}}
\DoxyCodeLine{03153\ }
\DoxyCodeLine{03154\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 4))\ \{}
\DoxyCodeLine{03155\ \ \ \ \ \_glBlendFuncSeparate\ =\ (PFNGLBLENDFUNCSEPARATEPROC)}
\DoxyCodeLine{03156\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendFuncSeparate"{}});}
\DoxyCodeLine{03157\ }
\DoxyCodeLine{03158\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_func\_separate"{}}))\ \{}
\DoxyCodeLine{03159\ \ \ \ \ \_glBlendFuncSeparate\ =\ (PFNGLBLENDFUNCSEPARATEEXTPROC)}
\DoxyCodeLine{03160\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendFuncSeparateEXT"{}});}
\DoxyCodeLine{03161\ }
\DoxyCodeLine{03162\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03163\ \ \ \ \ \_glBlendFuncSeparate\ =\ null\_glBlendFuncSeparate;}
\DoxyCodeLine{03164\ \ \ \}}
\DoxyCodeLine{03165\ }
\DoxyCodeLine{03166\ \ \ \textcolor{keywordflow}{if}\ (\_glBlendFuncSeparate\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03167\ \ \ \ \ \_glBlendFuncSeparate\ =\ null\_glBlendFuncSeparate;}
\DoxyCodeLine{03168\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03169\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendFuncSeparate\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03170\ \ \ \}}
\DoxyCodeLine{03171\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03172\ }
\DoxyCodeLine{03173\ \ \ \textcolor{comment}{//\ In\ OpenGL\ ES\ 2.x,\ this\ is\ supported\ in\ the\ core.\ \ In\ 1.x,\ not\ at\ all.}}
\DoxyCodeLine{03174\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03175\ \ \ \_glBlendColor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03176\ \ \ \textcolor{keywordtype}{bool}\ supports\_blend\_color\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03177\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2))\ \{}
\DoxyCodeLine{03178\ \ \ \ \ supports\_blend\_color\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03179\ \ \ \ \ \_glBlendColor\ =\ (PFNGLBLENDCOLORPROC)}
\DoxyCodeLine{03180\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendColor"{}});}
\DoxyCodeLine{03181\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_color"{}}))\ \{}
\DoxyCodeLine{03182\ \ \ \ \ supports\_blend\_color\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03183\ \ \ \ \ \_glBlendColor\ =\ (PFNGLBLENDCOLORPROC)}
\DoxyCodeLine{03184\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBlendColorEXT"{}});}
\DoxyCodeLine{03185\ \ \ \}}
\DoxyCodeLine{03186\ \ \ \textcolor{keywordflow}{if}\ (supports\_blend\_color\ \&\&\ \_glBlendColor\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03187\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03188\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}BlendColor\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03189\ \ \ \}}
\DoxyCodeLine{03190\ \ \ \textcolor{keywordflow}{if}\ (\_glBlendColor\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03191\ \ \ \ \ \_glBlendColor\ =\ null\_glBlendColor;}
\DoxyCodeLine{03192\ \ \ \}}
\DoxyCodeLine{03193\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03194\ }
\DoxyCodeLine{03195\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{03196\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 1\ doesn't\ support\ dual-\/source\ blending.}}
\DoxyCodeLine{03197\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{03198\ \ \ \_supports\_dual\_source\_blending\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_blend\_func\_extended"{}});}
\DoxyCodeLine{03199\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03200\ \ \ \_supports\_dual\_source\_blending\ =}
\DoxyCodeLine{03201\ \ \ \ \ is\_at\_least\_gl\_version(3,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_blend\_func\_extended"{}});}
\DoxyCodeLine{03202\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03203\ }
\DoxyCodeLine{03204\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03205\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_sync"{}}))\ \{}
\DoxyCodeLine{03206\ \ \ \ \ \_glFenceSync\ =\ (PFNGLFENCESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glFenceSync"{}});}
\DoxyCodeLine{03207\ \ \ \ \ \_glDeleteSync\ =\ (PFNGLDELETESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteSync"{}});}
\DoxyCodeLine{03208\ \ \ \ \ \_glClientWaitSync\ =\ (PFNGLCLIENTWAITSYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glClientWaitSync"{}});}
\DoxyCodeLine{03209\ \ \ \ \ \_glGetSynciv\ =\ (PFNGLGETSYNCIVPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glGetSynciv"{}});}
\DoxyCodeLine{03210\ \ \ \}}
\DoxyCodeLine{03211\ \textcolor{preprocessor}{\#elif\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{03212\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{03213\ \ \ \ \ \_glFenceSync\ =\ (PFNGLFENCESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glFenceSync"{}});}
\DoxyCodeLine{03214\ \ \ \ \ \_glDeleteSync\ =\ (PFNGLDELETESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteSync"{}});}
\DoxyCodeLine{03215\ \ \ \ \ \_glClientWaitSync\ =\ (PFNGLCLIENTWAITSYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glClientWaitSync"{}});}
\DoxyCodeLine{03216\ \ \ \ \ \_glGetSynciv\ =\ (PFNGLGETSYNCIVPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glGetSynciv"{}});}
\DoxyCodeLine{03217\ \ \ \}}
\DoxyCodeLine{03218\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_APPLE\_sync"{}}))\ \{}
\DoxyCodeLine{03219\ \ \ \ \ \_glFenceSync\ =\ (PFNGLFENCESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glFenceSyncAPPLE"{}});}
\DoxyCodeLine{03220\ \ \ \ \ \_glDeleteSync\ =\ (PFNGLDELETESYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteSyncAPPLE"{}});}
\DoxyCodeLine{03221\ \ \ \ \ \_glClientWaitSync\ =\ (PFNGLCLIENTWAITSYNCPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glClientWaitSyncAPPLE"{}});}
\DoxyCodeLine{03222\ \ \ \ \ \_glGetSynciv\ =\ (PFNGLGETSYNCIVPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glGetSyncivAPPLE"{}});}
\DoxyCodeLine{03223\ \ \ \}}
\DoxyCodeLine{03224\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03225\ }
\DoxyCodeLine{03226\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03227\ \ \ \_edge\_clamp\ =\ GL\_CLAMP\_TO\_EDGE;}
\DoxyCodeLine{03228\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03229\ \ \ \_edge\_clamp\ =\ GL\_CLAMP;}
\DoxyCodeLine{03230\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ is\_at\_least\_gles\_version(1,\ 1)\ ||}
\DoxyCodeLine{03231\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_SGIS\_texture\_edge\_clamp"{}}))\ \{}
\DoxyCodeLine{03232\ \ \ \ \ \_edge\_clamp\ =\ GL\_CLAMP\_TO\_EDGE;}
\DoxyCodeLine{03233\ \ \ \}}
\DoxyCodeLine{03234\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03235\ }
\DoxyCodeLine{03236\ \ \ \_border\_clamp\ =\ \_edge\_clamp;}
\DoxyCodeLine{03237\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03238\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_clamp\_to\_border\ \&\&}
\DoxyCodeLine{03239\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(1,\ 3)\ ||}
\DoxyCodeLine{03240\ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_border\_clamp"{}})))\ \{}
\DoxyCodeLine{03241\ \ \ \ \ \_border\_clamp\ =\ GL\_CLAMP\_TO\_BORDER;}
\DoxyCodeLine{03242\ \ \ \}}
\DoxyCodeLine{03243\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03244\ }
\DoxyCodeLine{03245\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{03246\ \ \ \_mirror\_repeat\ =\ GL\_REPEAT;}
\DoxyCodeLine{03247\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_texture\_mirrored\_repeat"{}}))\ \{}
\DoxyCodeLine{03248\ \ \ \ \ \_mirror\_repeat\ =\ GL\_MIRRORED\_REPEAT;}
\DoxyCodeLine{03249\ \ \ \}}
\DoxyCodeLine{03250\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{03251\ \ \ \textcolor{comment}{//\ OpenGL\ 2.x\ and\ above\ support\ this\ in\ the\ core.}}
\DoxyCodeLine{03252\ \ \ \_mirror\_repeat\ =\ GL\_MIRRORED\_REPEAT;}
\DoxyCodeLine{03253\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03254\ \ \ \_mirror\_repeat\ =\ GL\_REPEAT;}
\DoxyCodeLine{03255\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 4)\ ||}
\DoxyCodeLine{03256\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_mirrored\_repeat"{}}))\ \{}
\DoxyCodeLine{03257\ \ \ \ \ \_mirror\_repeat\ =\ GL\_MIRRORED\_REPEAT;}
\DoxyCodeLine{03258\ \ \ \}}
\DoxyCodeLine{03259\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03260\ }
\DoxyCodeLine{03261\ \ \ \_mirror\_clamp\ =\ \_edge\_clamp;}
\DoxyCodeLine{03262\ \ \ \_mirror\_edge\_clamp\ =\ \_edge\_clamp;}
\DoxyCodeLine{03263\ \ \ \_mirror\_border\_clamp\ =\ \_border\_clamp;}
\DoxyCodeLine{03264\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03265\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_mirror\_clamp"{}}))\ \{}
\DoxyCodeLine{03266\ \ \ \ \ \_mirror\_clamp\ =\ GL\_MIRROR\_CLAMP\_EXT;}
\DoxyCodeLine{03267\ \ \ \ \ \_mirror\_edge\_clamp\ =\ GL\_MIRROR\_CLAMP\_TO\_EDGE\_EXT;}
\DoxyCodeLine{03268\ \ \ \ \ \_mirror\_border\_clamp\ =\ GL\_MIRROR\_CLAMP\_TO\_BORDER\_EXT;}
\DoxyCodeLine{03269\ }
\DoxyCodeLine{03270\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 4)\ ||}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_mirror\_clamp\_to\_edge"{}}))\ \{}
\DoxyCodeLine{03272\ \ \ \ \ \_mirror\_clamp\ =\ GL\_MIRROR\_CLAMP\_TO\_EDGE;}
\DoxyCodeLine{03273\ \ \ \ \ \_mirror\_edge\_clamp\ =\ GL\_MIRROR\_CLAMP\_TO\_EDGE;}
\DoxyCodeLine{03274\ \ \ \}}
\DoxyCodeLine{03275\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03276\ }
\DoxyCodeLine{03277\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03278\ \ \ \_supports\_texture\_lod\ =\ is\_at\_least\_gles\_version(3,\ 0);}
\DoxyCodeLine{03279\ \ \ \_supports\_texture\_lod\_bias\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03280\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03281\ \ \ \_supports\_texture\_lod\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03282\ \ \ \_supports\_texture\_lod\_bias\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03283\ }
\DoxyCodeLine{03284\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_texture\_lod\ \&\&}
\DoxyCodeLine{03285\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_SGIS\_texture\_lod"{}})))\ \{}
\DoxyCodeLine{03286\ \ \ \ \ \_supports\_texture\_lod\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03287\ }
\DoxyCodeLine{03288\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 4)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_lod\_bias"{}}))\ \{}
\DoxyCodeLine{03289\ \ \ \ \ \ \ \_supports\_texture\_lod\_bias\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03290\ \ \ \ \ \}}
\DoxyCodeLine{03291\ \ \ \}}
\DoxyCodeLine{03292\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03293\ }
\DoxyCodeLine{03294\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03295\ \ \ \_supports\_texture\_max\_level\ =\ is\_at\_least\_gles\_version(3,\ 0)\ ||}
\DoxyCodeLine{03296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_APPLE\_texture\_max\_level"{}});}
\DoxyCodeLine{03297\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03298\ \ \ \_supports\_texture\_max\_level\ =\ is\_at\_least\_gl\_version(1,\ 2);}
\DoxyCodeLine{03299\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03300\ }
\DoxyCodeLine{03301\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_multisample)\ \{}
\DoxyCodeLine{03302\ \ \ \ \ GLint\ sample\_buffers\ =\ 0;}
\DoxyCodeLine{03303\ \ \ \ \ glGetIntegerv(GL\_SAMPLE\_BUFFERS,\ \&sample\_buffers);}
\DoxyCodeLine{03304\ \ \ \ \ \textcolor{keywordflow}{if}\ (sample\_buffers\ !=\ 1)\ \{}
\DoxyCodeLine{03305\ \ \ \ \ \ \ \textcolor{comment}{//\ Even\ if\ the\ API\ supports\ multisample,\ we\ might\ have\ ended\ up\ with\ a}}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \textcolor{comment}{//\ framebuffer\ that\ doesn't\ have\ any\ multisample\ bits.\ \ (It's\ also}}
\DoxyCodeLine{03307\ \ \ \ \ \ \ \textcolor{comment}{//\ possible\ the\ graphics\ card\ doesn't\ provide\ any\ framebuffers\ with}}
\DoxyCodeLine{03308\ \ \ \ \ \ \ \textcolor{comment}{//\ multisample.)\ \ In\ this\ case,\ we\ don't\ really\ support\ the\ multisample}}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \textcolor{comment}{//\ API's,\ since\ they\ won't\ do\ anything.}}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \_supports\_multisample\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03311\ \ \ \ \ \}}
\DoxyCodeLine{03312\ \ \ \}}
\DoxyCodeLine{03313\ }
\DoxyCodeLine{03314\ \ \ GLint\ max\_texture\_size\ =\ 0;}
\DoxyCodeLine{03315\ \ \ GLint\ max\_3d\_texture\_size\ =\ 0;}
\DoxyCodeLine{03316\ \ \ GLint\ max\_2d\_texture\_array\_layers\ =\ 0;}
\DoxyCodeLine{03317\ \ \ GLint\ max\_cube\_map\_size\ =\ 0;}
\DoxyCodeLine{03318\ }
\DoxyCodeLine{03319\ \ \ glGetIntegerv(GL\_MAX\_TEXTURE\_SIZE,\ \&max\_texture\_size);}
\DoxyCodeLine{03320\ \ \ \_max\_texture\_dimension\ =\ max\_texture\_size;}
\DoxyCodeLine{03321\ }
\DoxyCodeLine{03322\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{03323\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03324\ \ \ \ \ glGetIntegerv(GL\_MAX\_3D\_TEXTURE\_SIZE,\ \&max\_3d\_texture\_size);}
\DoxyCodeLine{03325\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03326\ \ \ \ \ \_max\_3d\_texture\_dimension\ =\ max\_3d\_texture\_size;}
\DoxyCodeLine{03327\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03328\ \ \ \ \ \_max\_3d\_texture\_dimension\ =\ 0;}
\DoxyCodeLine{03329\ \ \ \}}
\DoxyCodeLine{03330\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03331\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{03332\ \ \ \ \ glGetIntegerv(GL\_MAX\_ARRAY\_TEXTURE\_LAYERS,\ \&max\_2d\_texture\_array\_layers);}
\DoxyCodeLine{03333\ \ \ \ \ \_max\_2d\_texture\_array\_layers\ =\ max\_2d\_texture\_array\_layers;}
\DoxyCodeLine{03334\ \ \ \}}
\DoxyCodeLine{03335\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03336\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{03337\ \ \ \ \ glGetIntegerv(GL\_MAX\_CUBE\_MAP\_TEXTURE\_SIZE,\ \&max\_cube\_map\_size);}
\DoxyCodeLine{03338\ \ \ \ \ \_max\_cube\_map\_dimension\ =\ max\_cube\_map\_size;}
\DoxyCodeLine{03339\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03340\ \ \ \ \ \_max\_cube\_map\_dimension\ =\ 0;}
\DoxyCodeLine{03341\ \ \ \}}
\DoxyCodeLine{03342\ }
\DoxyCodeLine{03343\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03344\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_texture)\ \{}
\DoxyCodeLine{03345\ \ \ \ \ GLint\ max\_buffer\_texture\_size\ =\ 0;}
\DoxyCodeLine{03346\ \ \ \ \ glGetIntegerv(GL\_MAX\_TEXTURE\_BUFFER\_SIZE,\ \&max\_buffer\_texture\_size);}
\DoxyCodeLine{03347\ \ \ \ \ \_max\_buffer\_texture\_size\ =\ max\_buffer\_texture\_size;}
\DoxyCodeLine{03348\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03349\ \ \ \ \ \_max\_buffer\_texture\_size\ =\ 0;}
\DoxyCodeLine{03350\ \ \ \}}
\DoxyCodeLine{03351\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{03352\ }
\DoxyCodeLine{03353\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03354\ \ \ GLint\ max\_elements\_vertices\ =\ 0,\ max\_elements\_indices\ =\ 0;}
\DoxyCodeLine{03355\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(1,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_draw\_range\_elements"{}}))\ \{}
\DoxyCodeLine{03356\ \ \ \ \ glGetIntegerv(GL\_MAX\_ELEMENTS\_VERTICES,\ \&max\_elements\_vertices);}
\DoxyCodeLine{03357\ \ \ \ \ glGetIntegerv(GL\_MAX\_ELEMENTS\_INDICES,\ \&max\_elements\_indices);}
\DoxyCodeLine{03358\ }
\DoxyCodeLine{03359\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_elements\_vertices\ >\ 0)\ \{}
\DoxyCodeLine{03360\ \ \ \ \ \ \ \_max\_vertices\_per\_array\ =\ max\_elements\_vertices;}
\DoxyCodeLine{03361\ \ \ \ \ \}}
\DoxyCodeLine{03362\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_elements\_indices\ >\ 0)\ \{}
\DoxyCodeLine{03363\ \ \ \ \ \ \ \_max\_vertices\_per\_primitive\ =\ max\_elements\_indices;}
\DoxyCodeLine{03364\ \ \ \ \ \}}
\DoxyCodeLine{03365\ \ \ \}}
\DoxyCodeLine{03366\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{03367\ }
\DoxyCodeLine{03368\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03369\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03370\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ texture\ dimension\ =\ "{}}\ <<\ \_max\_texture\_dimension}
\DoxyCodeLine{03371\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ max\ 3d\ texture\ =\ "{}}\ <<\ \_max\_3d\_texture\_dimension}
\DoxyCodeLine{03372\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ max\ 2d\ texture\ array\ =\ "{}}\ <<\ max\_2d\_texture\_array\_layers}
\DoxyCodeLine{03373\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ max\ cube\ map\ =\ "{}}\ <<\ \_max\_cube\_map\_dimension\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03374\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03375\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03376\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\_elements\_vertices\ =\ "{}}\ <<\ max\_elements\_vertices}
\DoxyCodeLine{03377\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ max\_elements\_indices\ =\ "{}}\ <<\ max\_elements\_indices\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03378\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03379\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{03380\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex\_buffers)\ \{}
\DoxyCodeLine{03381\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03382\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}vertex\ buffer\ objects\ are\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{03383\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03384\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03385\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}vertex\ buffer\ objects\ are\ supported\ (but\ not\ enabled).\(\backslash\)n"{}};}
\DoxyCodeLine{03386\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03387\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03388\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03389\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}vertex\ buffer\ objects\ are\ NOT\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{03390\ \ \ \ \ \}}
\DoxyCodeLine{03391\ }
\DoxyCodeLine{03392\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{03393\ \ \ \ \ \textcolor{keywordflow}{if}\ (!vertex\_arrays)\ \{}
\DoxyCodeLine{03394\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03395\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}immediate\ mode\ commands\ will\ be\ used\ instead\ of\ vertex\ arrays.\(\backslash\)n"{}};}
\DoxyCodeLine{03396\ \ \ \ \ \}}
\DoxyCodeLine{03397\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03398\ }
\DoxyCodeLine{03399\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_compressed\_texture)\ \{}
\DoxyCodeLine{03400\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03401\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Texture\ compression\ is\ not\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{03402\ }
\DoxyCodeLine{03403\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03404\ \ \ \ \ \ \ GLint\ num\_compressed\_formats\ =\ 0;}
\DoxyCodeLine{03405\ \ \ \ \ \ \ glGetIntegerv(GL\_NUM\_COMPRESSED\_TEXTURE\_FORMATS,\ \&num\_compressed\_formats);}
\DoxyCodeLine{03406\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_compressed\_formats\ ==\ 0)\ \{}
\DoxyCodeLine{03407\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03408\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}No\ specific\ compressed\ texture\ formats\ are\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{03409\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03410\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{03411\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03412\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Supported\ compressed\ texture\ formats:\(\backslash\)n"{}};}
\DoxyCodeLine{03413\ \ \ \ \ \ \ \ \ GLint\ *formats\ =\ (GLint\ *)alloca(num\_compressed\_formats\ *\ \textcolor{keyword}{sizeof}(GLint));}
\DoxyCodeLine{03414\ \ \ \ \ \ \ \ \ glGetIntegerv(GL\_COMPRESSED\_TEXTURE\_FORMATS,\ formats);}
\DoxyCodeLine{03415\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_compressed\_formats;\ ++i)\ \{}
\DoxyCodeLine{03416\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *format\_str\ =\ get\_compressed\_format\_string(formats[i]);}
\DoxyCodeLine{03417\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\_str\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03418\ \ \ \ \ \ \ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ format\_str\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{03419\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03420\ \ \ \ \ \ \ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})}
\DoxyCodeLine{03421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ Unknown\ compressed\ format\ 0x"{}}\ <<\ hex\ <<\ formats[i]}
\DoxyCodeLine{03422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ dec\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03423\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03424\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03425\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03426\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03427\ \ \ \ \ \}}
\DoxyCodeLine{03428\ \ \ \}}
\DoxyCodeLine{03429\ }
\DoxyCodeLine{03430\ \ \ \_active\_texture\_stage\ =\ -\/1;}
\DoxyCodeLine{03431\ \ \ \_num\_active\_texture\_stages\ =\ 0;}
\DoxyCodeLine{03432\ }
\DoxyCodeLine{03433\ \ \ \textcolor{comment}{//\ Check\ availability\ of\ anisotropic\ texture\ filtering.}}
\DoxyCodeLine{03434\ \ \ \_supports\_anisotropy\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03435\ \ \ \_max\_anisotropy\ =\ 1.0;}
\DoxyCodeLine{03436\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 6)\ ||}
\DoxyCodeLine{03437\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_texture\_filter\_anisotropic"{}})\ ||}
\DoxyCodeLine{03438\ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_texture\_filter\_anisotropic"{}}))\ \{}
\DoxyCodeLine{03439\ \ \ \ \ GLfloat\ max\_anisotropy;}
\DoxyCodeLine{03440\ \ \ \ \ glGetFloatv(GL\_MAX\_TEXTURE\_MAX\_ANISOTROPY\_EXT,\ \&max\_anisotropy);}
\DoxyCodeLine{03441\ \ \ \ \ \_max\_anisotropy\ =\ (PN\_stdfloat)max\_anisotropy;}
\DoxyCodeLine{03442\ \ \ \ \ \_supports\_anisotropy\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03443\ \ \ \}}
\DoxyCodeLine{03444\ }
\DoxyCodeLine{03445\ \ \ \textcolor{comment}{//\ Check\ availability\ of\ image\ read/write\ functionality\ in\ shaders.}}
\DoxyCodeLine{03446\ \ \ \_max\_image\_units\ =\ 0;}
\DoxyCodeLine{03447\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03448\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03449\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))\ \{}
\DoxyCodeLine{03450\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03451\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 2)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_shader\_image\_load\_store"{}}))\ \{}
\DoxyCodeLine{03452\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03453\ \ \ \ \ \_glBindImageTexture\ =\ (PFNGLBINDIMAGETEXTUREPROC)}
\DoxyCodeLine{03454\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindImageTexture"{}});}
\DoxyCodeLine{03455\ \ \ \ \ \_glMemoryBarrier\ =\ (PFNGLMEMORYBARRIERPROC)}
\DoxyCodeLine{03456\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMemoryBarrier"{}});}
\DoxyCodeLine{03457\ }
\DoxyCodeLine{03458\ \ \ \ \ glGetIntegerv(GL\_MAX\_IMAGE\_UNITS,\ \&\_max\_image\_units);}
\DoxyCodeLine{03459\ }
\DoxyCodeLine{03460\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03461\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_shader\_image\_load\_store"{}}))\ \{}
\DoxyCodeLine{03462\ \ \ \ \ \_glBindImageTexture\ =\ (PFNGLBINDIMAGETEXTUREPROC)}
\DoxyCodeLine{03463\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindImageTextureEXT"{}});}
\DoxyCodeLine{03464\ \ \ \ \ \_glMemoryBarrier\ =\ (PFNGLMEMORYBARRIERPROC)}
\DoxyCodeLine{03465\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMemoryBarrierEXT"{}});}
\DoxyCodeLine{03466\ }
\DoxyCodeLine{03467\ \ \ \ \ glGetIntegerv(GL\_MAX\_IMAGE\_UNITS\_EXT,\ \&\_max\_image\_units);}
\DoxyCodeLine{03468\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03469\ }
\DoxyCodeLine{03470\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03471\ \ \ \ \ \_glBindImageTexture\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03472\ \ \ \ \ \_glMemoryBarrier\ =\ null\_glMemoryBarrier;}
\DoxyCodeLine{03473\ \ \ \}}
\DoxyCodeLine{03474\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{03475\ }
\DoxyCodeLine{03476\ \ \ \_supports\_sampler\_objects\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03477\ }
\DoxyCodeLine{03478\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03479\ \ \ \textcolor{keywordflow}{if}\ (gl\_support\_sampler\_objects\ \&\&}
\DoxyCodeLine{03480\ \#ifdef\ OPENGLES}
\DoxyCodeLine{03481\ \ \ \ \ \ \ is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{03482\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03483\ \ \ \ \ \ \ (is\_at\_least\_gl\_version(3,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_sampler\_objects"{}})))\ \{}
\DoxyCodeLine{03484\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03485\ \ \ \ \ \_glGenSamplers\ =\ (PFNGLGENSAMPLERSPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glGenSamplers"{}});}
\DoxyCodeLine{03486\ \ \ \ \ \_glDeleteSamplers\ =\ (PFNGLDELETESAMPLERSPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glDeleteSamplers"{}});}
\DoxyCodeLine{03487\ \ \ \ \ \_glBindSampler\ =\ (PFNGLBINDSAMPLERPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glBindSampler"{}});}
\DoxyCodeLine{03488\ \ \ \ \ \_glSamplerParameteri\ =\ (PFNGLSAMPLERPARAMETERIPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glSamplerParameteri"{}});}
\DoxyCodeLine{03489\ \ \ \ \ \_glSamplerParameteriv\ =\ (PFNGLSAMPLERPARAMETERIVPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glSamplerParameteriv"{}});}
\DoxyCodeLine{03490\ \ \ \ \ \_glSamplerParameterf\ =\ (PFNGLSAMPLERPARAMETERFPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glSamplerParameterf"{}});}
\DoxyCodeLine{03491\ \ \ \ \ \_glSamplerParameterfv\ =\ (PFNGLSAMPLERPARAMETERFVPROC)\ get\_extension\_func(\textcolor{stringliteral}{"{}glSamplerParameterfv"{}});}
\DoxyCodeLine{03492\ }
\DoxyCodeLine{03493\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGenSamplers\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glDeleteSamplers\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03494\ \ \ \ \ \ \ \ \ \_glBindSampler\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glSamplerParameteri\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03495\ \ \ \ \ \ \ \ \ \_glSamplerParameteriv\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glSamplerParameterf\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03496\ \ \ \ \ \ \ \ \ \_glSamplerParameterfv\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03497\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03498\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_ARB\_sampler\_objects\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03499\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03500\ \ \ \ \ \ \ \_supports\_sampler\_objects\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03501\ \ \ \ \ \}}
\DoxyCodeLine{03502\ \ \ \}}
\DoxyCodeLine{03503\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{03504\ }
\DoxyCodeLine{03505\ \ \ \textcolor{comment}{//\ Check\ availability\ of\ multi-\/bind\ functions.}}
\DoxyCodeLine{03506\ \ \ \_supports\_multi\_bind\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03507\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03508\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 4)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_multi\_bind"{}}))\ \{}
\DoxyCodeLine{03509\ \ \ \ \ \_glBindTextures\ =\ (PFNGLBINDTEXTURESPROC)}
\DoxyCodeLine{03510\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindTextures"{}});}
\DoxyCodeLine{03511\ \ \ \ \ \_glBindImageTextures\ =\ (PFNGLBINDIMAGETEXTURESPROC)}
\DoxyCodeLine{03512\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindImageTextures"{}});}
\DoxyCodeLine{03513\ }
\DoxyCodeLine{03514\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_sampler\_objects)\ \{}
\DoxyCodeLine{03515\ \ \ \ \ \ \ \_glBindSamplers\ =\ (PFNGLBINDSAMPLERSPROC)}
\DoxyCodeLine{03516\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindSamplers"{}});}
\DoxyCodeLine{03517\ \ \ \ \ \}}
\DoxyCodeLine{03518\ }
\DoxyCodeLine{03519\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_use\_vertex\_attrib\_binding)\ \{}
\DoxyCodeLine{03520\ \ \ \ \ \ \ \_glBindVertexBuffers\ =\ (PFNGLBINDVERTEXBUFFERSPROC)}
\DoxyCodeLine{03521\ \ \ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glBindVertexBuffers"{}});}
\DoxyCodeLine{03522\ \ \ \ \ \}}
\DoxyCodeLine{03523\ }
\DoxyCodeLine{03524\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glBindTextures\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ \_glBindImageTextures\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03525\ \ \ \ \ \ \ \_supports\_multi\_bind\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03526\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03527\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03528\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}ARB\_multi\_bind\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03529\ \ \ \ \ \}}
\DoxyCodeLine{03530\ \ \ \}}
\DoxyCodeLine{03531\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{03532\ }
\DoxyCodeLine{03533\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03534\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03535\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(3,\ 0))\ \{}
\DoxyCodeLine{03536\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03537\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 3)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_internalformat\_query2"{}}))\ \{}
\DoxyCodeLine{03538\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03539\ \ \ \ \ \_glGetInternalformativ\ =\ (PFNGLGETINTERNALFORMATIVPROC)}
\DoxyCodeLine{03540\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetInternalformativ"{}});}
\DoxyCodeLine{03541\ }
\DoxyCodeLine{03542\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGetInternalformativ\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03543\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03544\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}ARB\_internalformat\_query2\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03545\ \ \ \ \ \}}
\DoxyCodeLine{03546\ \ \ \}}
\DoxyCodeLine{03547\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{03548\ }
\DoxyCodeLine{03549\ \ \ \_supports\_bindless\_texture\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03550\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03551\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_bindless\_texture"{}}))\ \{}
\DoxyCodeLine{03552\ \ \ \ \ \_glGetTextureHandle\ =\ (PFNGLGETTEXTUREHANDLEPROC)}
\DoxyCodeLine{03553\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetTextureHandleARB"{}});}
\DoxyCodeLine{03554\ \ \ \ \ \_glGetTextureSamplerHandle\ =\ (PFNGLGETTEXTURESAMPLERHANDLEPROC)}
\DoxyCodeLine{03555\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetTextureSamplerHandleARB"{}});}
\DoxyCodeLine{03556\ \ \ \ \ \_glMakeTextureHandleResident\ =\ (PFNGLMAKETEXTUREHANDLERESIDENTPROC)}
\DoxyCodeLine{03557\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glMakeTextureHandleResidentARB"{}});}
\DoxyCodeLine{03558\ \ \ \ \ \_glUniformHandleui64\ =\ (PFNGLUNIFORMHANDLEUI64PROC)}
\DoxyCodeLine{03559\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glUniformHandleui64ARB"{}});}
\DoxyCodeLine{03560\ }
\DoxyCodeLine{03561\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGetTextureHandle\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_glMakeTextureHandleResident\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{03562\ \ \ \ \ \ \ \ \_glUniformHandleui64\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03563\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03564\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_ARB\_bindless\_texture\ advertised\ as\ supported\ by\ OpenGL\ runtime,\ but\ could\ not\ get\ pointers\ to\ extension\ function.\(\backslash\)n"{}};}
\DoxyCodeLine{03565\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03566\ \ \ \ \ \ \ \_supports\_bindless\_texture\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03567\ \ \ \ \ \}}
\DoxyCodeLine{03568\ \ \ \}}
\DoxyCodeLine{03569\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{03570\ }
\DoxyCodeLine{03571\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES\_1)\ \&\&\ !defined(\_\_EMSCRIPTEN\_\_)}}
\DoxyCodeLine{03572\ \ \ \_supports\_get\_program\_binary\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03573\ \ \ \_program\_binary\_formats.clear();}
\DoxyCodeLine{03574\ }
\DoxyCodeLine{03575\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03576\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{03577\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03578\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 1)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_get\_program\_binary"{}}))\ \{}
\DoxyCodeLine{03579\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03580\ \ \ \ \ \_glGetProgramBinary\ =\ (PFNGLGETPROGRAMBINARYPROC)}
\DoxyCodeLine{03581\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glGetProgramBinary"{}});}
\DoxyCodeLine{03582\ \ \ \ \ \_glProgramBinary\ =\ (PFNGLPROGRAMBINARYPROC)}
\DoxyCodeLine{03583\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glProgramBinary"{}});}
\DoxyCodeLine{03584\ \ \ \ \ \_glProgramParameteri\ =\ (PFNGLPROGRAMPARAMETERIPROC)}
\DoxyCodeLine{03585\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glProgramParameteri"{}});}
\DoxyCodeLine{03586\ }
\DoxyCodeLine{03587\ \ \ \ \ GLint\ num\_binary\_formats\ =\ 0;}
\DoxyCodeLine{03588\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGetProgramBinary\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{03589\ \ \ \ \ \ \ \ \ \_glProgramBinary\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{03590\ \ \ \ \ \ \ \ \ \_glProgramParameteri\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03591\ \ \ \ \ \ \ glGetIntegerv(GL\_NUM\_PROGRAM\_BINARY\_FORMATS,\ \&num\_binary\_formats);}
\DoxyCodeLine{03592\ \ \ \ \ \}}
\DoxyCodeLine{03593\ }
\DoxyCodeLine{03594\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_binary\_formats\ >\ 0)\ \{}
\DoxyCodeLine{03595\ \ \ \ \ \ \ \_supports\_get\_program\_binary\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03596\ }
\DoxyCodeLine{03597\ \ \ \ \ \ \ GLenum\ *binary\_formats\ =\ (GLenum\ *)alloca(\textcolor{keyword}{sizeof}(GLenum)\ *\ num\_binary\_formats);}
\DoxyCodeLine{03598\ \ \ \ \ \ \ glGetIntegerv(GL\_PROGRAM\_BINARY\_FORMATS,\ (GLint\ *)binary\_formats);}
\DoxyCodeLine{03599\ }
\DoxyCodeLine{03600\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_binary\_formats;\ ++i)\ \{}
\DoxyCodeLine{03601\ \ \ \ \ \ \ \ \ \_program\_binary\_formats.insert(binary\_formats[i]);}
\DoxyCodeLine{03602\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03603\ \ \ \ \ \}}
\DoxyCodeLine{03604\ \ \ \}}
\DoxyCodeLine{03605\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{03606\ }
\DoxyCodeLine{03607\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{03608\ }
\DoxyCodeLine{03609\ \ \ \textcolor{keywordflow}{if}\ (core\_profile)\ \{}
\DoxyCodeLine{03610\ \ \ \ \ \textcolor{comment}{//\ TODO:\ better\ detection\ mechanism?}}
\DoxyCodeLine{03611\ \ \ \ \ \_supports\_stencil\ =\ support\_stencil;}
\DoxyCodeLine{03612\ \ \ \}}
\DoxyCodeLine{03613\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03614\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (support\_stencil)\ \{}
\DoxyCodeLine{03615\ \ \ \ \ GLint\ num\_stencil\_bits;}
\DoxyCodeLine{03616\ \ \ \ \ glGetIntegerv(GL\_STENCIL\_BITS,\ \&num\_stencil\_bits);}
\DoxyCodeLine{03617\ \ \ \ \ \_supports\_stencil\ =\ (num\_stencil\_bits\ !=\ 0);}
\DoxyCodeLine{03618\ \ \ \}}
\DoxyCodeLine{03619\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03620\ }
\DoxyCodeLine{03621\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{03622\ \ \ \_supports\_stencil\_wrap\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_OES\_stencil\_wrap"{}});}
\DoxyCodeLine{03623\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{03624\ \ \ \_supports\_stencil\_wrap\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03625\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03626\ \ \ \_supports\_stencil\_wrap\ =\ is\_at\_least\_gl\_version(1,\ 4)\ ||}
\DoxyCodeLine{03627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_stencil\_wrap"{}});}
\DoxyCodeLine{03628\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03629\ }
\DoxyCodeLine{03630\ \ \ \_supports\_two\_sided\_stencil\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03631\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03632\ \ \ \textcolor{comment}{//TODO:\ support\ the\ two-\/sided\ stencil\ functions\ that\ ended\ up\ in\ core.}}
\DoxyCodeLine{03633\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_stencil\_two\_side"{}}))\ \{}
\DoxyCodeLine{03634\ \ \ \ \ \_glActiveStencilFaceEXT\ =\ (PFNGLACTIVESTENCILFACEEXTPROC)}
\DoxyCodeLine{03635\ \ \ \ \ \ \ get\_extension\_func(\textcolor{stringliteral}{"{}glActiveStencilFaceEXT"{}});}
\DoxyCodeLine{03636\ \ \ \ \ \_supports\_two\_sided\_stencil\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03637\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03638\ \ \ \ \ \_glActiveStencilFaceEXT\ =\ 0;}
\DoxyCodeLine{03639\ \ \ \}}
\DoxyCodeLine{03640\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03641\ }
\DoxyCodeLine{03642\ \ \ \textcolor{comment}{//\ Ensure\ the\ initial\ state\ is\ what\ we\ say\ it\ should\ be\ (in\ some\ cases,\ we}}
\DoxyCodeLine{03643\ \ \ \textcolor{comment}{//\ don't\ want\ the\ GL\ default\ settings;\ in\ others,\ we\ have\ to\ force\ the\ point}}
\DoxyCodeLine{03644\ \ \ \textcolor{comment}{//\ with\ some\ drivers\ that\ aren't\ strictly\ compliant\ w.r.t.\ \ initial}}
\DoxyCodeLine{03645\ \ \ \textcolor{comment}{//\ settings).}}
\DoxyCodeLine{03646\ \ \ glFrontFace(GL\_CCW);}
\DoxyCodeLine{03647\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{03648\ \ \ glDisable(GL\_LINE\_SMOOTH);}
\DoxyCodeLine{03649\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03650\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03651\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03652\ \ \ \ \ glDisable(GL\_POINT\_SMOOTH);}
\DoxyCodeLine{03653\ \ \ \}}
\DoxyCodeLine{03654\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03655\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03656\ \ \ glDisable(GL\_POLYGON\_SMOOTH);}
\DoxyCodeLine{03657\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{03658\ }
\DoxyCodeLine{03659\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{03660\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_multisample)\ \{}
\DoxyCodeLine{03661\ \ \ \ \ glDisable(GL\_MULTISAMPLE);}
\DoxyCodeLine{03662\ \ \ \}}
\DoxyCodeLine{03663\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03664\ }
\DoxyCodeLine{03665\ \ \ \textcolor{comment}{//\ Set\ depth\ range\ from\ zero\ to\ one\ if\ requested.}}
\DoxyCodeLine{03666\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03667\ \ \ \_use\_depth\_zero\_to\_one\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03668\ \ \ \_use\_remapped\_depth\_range\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03669\ }
\DoxyCodeLine{03670\ \ \ \textcolor{keywordflow}{if}\ (gl\_depth\_zero\_to\_one)\ \{}
\DoxyCodeLine{03671\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03672\ \ \ \ \ PFNGLCLIPCONTROLPROC\ pglClipControl\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03673\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 5)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_clip\_control"{}}))\ \{}
\DoxyCodeLine{03674\ \ \ \ \ \ \ pglClipControl\ =\ (PFNGLCLIPCONTROLPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glClipControl"{}});}
\DoxyCodeLine{03675\ \ \ \ \ \}}
\DoxyCodeLine{03676\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03677\ \ \ \ \ PFNGLCLIPCONTROLEXTPROC\ pglClipControl\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03678\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_clip\_control"{}}))\ \{}
\DoxyCodeLine{03679\ \ \ \ \ \ \ pglClipControl\ =\ (PFNGLCLIPCONTROLEXTPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glClipControlEXT"{}});}
\DoxyCodeLine{03680\ \ \ \ \ \}}
\DoxyCodeLine{03681\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03682\ }
\DoxyCodeLine{03683\ \ \ \ \ \textcolor{keywordflow}{if}\ (pglClipControl\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{03684\ \ \ \ \ \ \ pglClipControl(GL\_LOWER\_LEFT,\ GL\_ZERO\_TO\_ONE);}
\DoxyCodeLine{03685\ \ \ \ \ \ \ \_use\_depth\_zero\_to\_one\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03686\ }
\DoxyCodeLine{03687\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03688\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03689\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Set\ zero-\/to-\/one\ depth\ using\ glClipControl\(\backslash\)n"{}};}
\DoxyCodeLine{03690\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03691\ \ \ \ \ \}\textcolor{comment}{/*\ else\ if\ (has\_extension("{}GL\_NV\_depth\_buffer\_float"{}))\ \{}}
\DoxyCodeLine{03692\ \textcolor{comment}{\ \ \ \ \ \ //\ Alternatively,\ all\ GeForce\ 8+\ and\ even\ some\ AMD\ drivers\ support\ this}}
\DoxyCodeLine{03693\ \textcolor{comment}{\ \ \ \ \ \ //\ extension,\ which\ (unlike\ the\ core\ glDepthRange,\ which\ clamps\ its}}
\DoxyCodeLine{03694\ \textcolor{comment}{\ \ \ \ \ \ //\ input\ parameters)\ can\ compensate\ for\ the\ built-\/in\ depth\ remapping.}}
\DoxyCodeLine{03695\ \textcolor{comment}{\ \ \ \ \ \ \_glDepthRangedNV\ =\ (PFNGLDEPTHRANGEDNVPROC)get\_extension\_func("{}glDepthRangedNV"{});}}
\DoxyCodeLine{03696\ \textcolor{comment}{}}
\DoxyCodeLine{03697\ \textcolor{comment}{\ \ \ \ \ \ if\ (\_glDepthRangedNV\ !=\ nullptr)\ \{}}
\DoxyCodeLine{03698\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_glDepthRangedNV(-\/1.0,\ 1.0);}}
\DoxyCodeLine{03699\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_use\_depth\_zero\_to\_one\ =\ true;}}
\DoxyCodeLine{03700\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_use\_remapped\_depth\_range\ =\ true;}}
\DoxyCodeLine{03701\ \textcolor{comment}{\ \ \ \ \ \ \ \ \_has\_attrib\_depth\_range\ =\ false;}}
\DoxyCodeLine{03702\ \textcolor{comment}{}}
\DoxyCodeLine{03703\ \textcolor{comment}{\ \ \ \ \ \ \ \ if\ (GLCAT.is\_debug())\ \{}}
\DoxyCodeLine{03704\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ GLCAT.debug()}}
\DoxyCodeLine{03705\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ <<\ "{}Set\ zero-\/to-\/one\ depth\ using\ glDepthRangedNV\(\backslash\)n"{};}}
\DoxyCodeLine{03706\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{03707\ \textcolor{comment}{\ \ \ \ \ \ \}}}
\DoxyCodeLine{03708\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{03709\ }
\DoxyCodeLine{03710\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_use\_depth\_zero\_to\_one)\ \{}
\DoxyCodeLine{03711\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03712\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Zero-\/to-\/one\ depth\ was\ requested,\ but\ driver\ does\ not\ support\ it.\(\backslash\)n"{}};}
\DoxyCodeLine{03713\ \ \ \ \ \}}
\DoxyCodeLine{03714\ \ \ \}}
\DoxyCodeLine{03715\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03716\ }
\DoxyCodeLine{03717\ \ \ \textcolor{keywordflow}{if}\ (\_has\_attrib\_depth\_range)\ \{}
\DoxyCodeLine{03718\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03719\ \ \ \ \ glDepthRangef(0.0f,\ 1.0f);}
\DoxyCodeLine{03720\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03721\ \ \ \ \ glDepthRange(0.0,\ 1.0);}
\DoxyCodeLine{03722\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03723\ \ \ \ \ \_depth\_range\_near\ =\ 0;}
\DoxyCodeLine{03724\ \ \ \ \ \_depth\_range\_far\ =\ 1;}
\DoxyCodeLine{03725\ \ \ \ \ \_has\_attrib\_depth\_range\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03726\ \ \ \}}
\DoxyCodeLine{03727\ }
\DoxyCodeLine{03728\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03729\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03730\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 6)\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_polygon\_offset\_clamp"{}}))\ \{}
\DoxyCodeLine{03731\ \ \ \ \ \_glPolygonOffsetClamp\ =\ (PFNGLPOLYGONOFFSETCLAMPEXTPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glPolygonOffsetClamp"{}});}
\DoxyCodeLine{03732\ \ \ \}}
\DoxyCodeLine{03733\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03734\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03735\ \ \ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_EXT\_polygon\_offset\_clamp"{}}))\ \{}
\DoxyCodeLine{03736\ \ \ \ \ \_glPolygonOffsetClamp\ =\ (PFNGLPOLYGONOFFSETCLAMPEXTPROC)get\_extension\_func(\textcolor{stringliteral}{"{}glPolygonOffsetClampEXT"{}});}
\DoxyCodeLine{03737\ \ \ \}}
\DoxyCodeLine{03738\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03739\ \ \ \ \ \_glPolygonOffsetClamp\ =\ null\_glPolygonOffsetClamp;}
\DoxyCodeLine{03740\ \ \ \}}
\DoxyCodeLine{03741\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03742\ }
\DoxyCodeLine{03743\ \ \ \textcolor{comment}{//\ Set\ up\ all\ the\ enableddisabled\ flags\ to\ GL's\ known\ initial\ values:}}
\DoxyCodeLine{03744\ \ \ \textcolor{comment}{//\ everything\ off.}}
\DoxyCodeLine{03745\ \ \ \_multisample\_mode\ =\ 0;}
\DoxyCodeLine{03746\ \ \ \_line\_smooth\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03747\ \ \ \_point\_smooth\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03748\ \ \ \_polygon\_smooth\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03749\ \ \ \_stencil\_test\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03750\ \ \ \_blend\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03751\ \ \ \_depth\_test\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03752\ \ \ \_fog\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03753\ \ \ \_alpha\_test\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03754\ \ \ \_polygon\_offset\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03755\ \ \ \_flat\_shade\_model\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03756\ \ \ \_decal\_level\ =\ 0;}
\DoxyCodeLine{03757\ \ \ \_active\_color\_write\_mask\ =\ ColorWriteAttrib::C\_all;}
\DoxyCodeLine{03758\ \ \ \_tex\_gen\_point\_sprite\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03759\ }
\DoxyCodeLine{03760\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03761\ \ \ \_enabled\_vertex\_attrib\_arrays.clear();}
\DoxyCodeLine{03762\ \ \ memset(\_vertex\_attrib\_divisors,\ 0,\ \textcolor{keyword}{sizeof}(GLuint)\ *\ 32);}
\DoxyCodeLine{03763\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03764\ }
\DoxyCodeLine{03765\ \ \ \textcolor{comment}{//\ Dither\ is\ on\ by\ default\ in\ GL;\ let's\ turn\ it\ off}}
\DoxyCodeLine{03766\ \ \ glDisable(GL\_DITHER);}
\DoxyCodeLine{03767\ \ \ \_dithering\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03768\ }
\DoxyCodeLine{03769\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{03770\ \ \ \_current\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03771\ \ \ \_current\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03772\ \ \ \_vertex\_array\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03773\ \ \ \_vertex\_array\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03774\ \ \ \_texture\_binding\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03775\ \ \ \_texture\_binding\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{03776\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03777\ }
\DoxyCodeLine{03778\ \ \ \textcolor{comment}{//\ Count\ the\ max\ number\ of\ lights}}
\DoxyCodeLine{03779\ \ \ \_max\_lights\ =\ 0;}
\DoxyCodeLine{03780\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03781\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03782\ \ \ \ \ GLint\ max\_lights\ =\ 0;}
\DoxyCodeLine{03783\ \ \ \ \ glGetIntegerv(GL\_MAX\_LIGHTS,\ \&max\_lights);}
\DoxyCodeLine{03784\ \ \ \ \ \_max\_lights\ =\ max\_lights;}
\DoxyCodeLine{03785\ }
\DoxyCodeLine{03786\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03787\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03788\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ lights\ =\ "{}}\ <<\ \_max\_lights\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03789\ \ \ \ \ \}}
\DoxyCodeLine{03790\ \ \ \}}
\DoxyCodeLine{03791\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03792\ }
\DoxyCodeLine{03793\ \ \ \textcolor{comment}{//\ Count\ the\ max\ number\ of\ clipping\ planes}}
\DoxyCodeLine{03794\ \ \ \_max\_clip\_planes\ =\ 0;}
\DoxyCodeLine{03795\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03796\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03797\ \ \ \ \ GLint\ max\_clip\_planes\ =\ 0;}
\DoxyCodeLine{03798\ \ \ \ \ glGetIntegerv(GL\_MAX\_CLIP\_PLANES,\ \&max\_clip\_planes);}
\DoxyCodeLine{03799\ \ \ \ \ \_max\_clip\_planes\ =\ max\_clip\_planes;}
\DoxyCodeLine{03800\ }
\DoxyCodeLine{03801\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03802\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03803\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ clip\ planes\ =\ "{}}\ <<\ \_max\_clip\_planes\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03804\ \ \ \ \ \}}
\DoxyCodeLine{03805\ \ \ \}}
\DoxyCodeLine{03806\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03807\ }
\DoxyCodeLine{03808\ \ \ \_max\_texture\_stages\ =\ 1;}
\DoxyCodeLine{03809\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03810\ \ \ \textcolor{keywordflow}{if}\ (supports\_multitexture\ \&\&\ has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03811\ \ \ \ \ GLint\ max\_texture\_stages\ =\ 0;}
\DoxyCodeLine{03812\ \ \ \ \ glGetIntegerv(GL\_MAX\_TEXTURE\_UNITS,\ \&max\_texture\_stages);}
\DoxyCodeLine{03813\ \ \ \ \ \_max\_texture\_stages\ =\ max\_texture\_stages;}
\DoxyCodeLine{03814\ }
\DoxyCodeLine{03815\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03816\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03817\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ texture\ stages\ =\ "{}}\ <<\ \_max\_texture\_stages\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03818\ \ \ \ \ \}}
\DoxyCodeLine{03819\ \ \ \}}
\DoxyCodeLine{03820\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03821\ }
\DoxyCodeLine{03822\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES\_1)\ \&\&\ !defined(\_\_EMSCRIPTEN\_\_)}}
\DoxyCodeLine{03823\ \ \ \_max\_vertex\_attrib\_stride\ =\ -\/1;}
\DoxyCodeLine{03824\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03825\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gles\_version(3,\ 1))}
\DoxyCodeLine{03826\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03827\ \ \ \textcolor{keywordflow}{if}\ (is\_at\_least\_gl\_version(4,\ 4))}
\DoxyCodeLine{03828\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03829\ \ \ \{}
\DoxyCodeLine{03830\ \ \ \ \ glGetIntegerv(GL\_MAX\_VERTEX\_ATTRIB\_STRIDE,\ \&\_max\_vertex\_attrib\_stride);}
\DoxyCodeLine{03831\ }
\DoxyCodeLine{03832\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_max\_vertex\_attrib\_stride\ <\ 0)\ \{}
\DoxyCodeLine{03833\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{03834\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ query\ GL\_MAX\_VERTEX\_ATTRIB\_STRIDE.\(\backslash\)n"{}};}
\DoxyCodeLine{03835\ \ \ \ \ \}}
\DoxyCodeLine{03836\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03837\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03838\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ vertex\ attrib\ stride\ =\ "{}}\ <<\ \_max\_vertex\_attrib\_stride\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03839\ \ \ \ \ \}}
\DoxyCodeLine{03840\ \ \ \}}
\DoxyCodeLine{03841\ \ \ \textcolor{keywordflow}{if}\ (\_max\_vertex\_attrib\_stride\ <\ 0)\ \{}
\DoxyCodeLine{03842\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ doesn't\ specify\ a\ maximum\ before\ version\ 4.4\ /\ ES\ 3.1,\ but}}
\DoxyCodeLine{03843\ \ \ \ \ \textcolor{comment}{//\ drivers\ really\ do\ have\ one.\ \ Make\ an\ educated\ guess.}}
\DoxyCodeLine{03844\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{03845\ \ \ \ \ \_max\_vertex\_attrib\_stride\ =\ (\_gl\_vendor\ ==\ \textcolor{stringliteral}{"{}Qualcomm"{}})\ ?\ INT\_MAX\ :\ 2048;}
\DoxyCodeLine{03846\ \textcolor{preprocessor}{\#elif\ defined(\_WIN32)}}
\DoxyCodeLine{03847\ \ \ \ \ \_max\_vertex\_attrib\_stride\ =\ (\_gl\_vendor\ ==\ \textcolor{stringliteral}{"{}Intel"{}})\ ?\ 4095\ :\ 2048;}
\DoxyCodeLine{03848\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{03849\ \ \ \ \ \_max\_vertex\_attrib\_stride\ =\ 2048;}
\DoxyCodeLine{03850\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03851\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03852\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03853\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}max\ vertex\ attrib\ stride\ =\ "{}}\ <<\ \_max\_vertex\_attrib\_stride}
\DoxyCodeLine{03854\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ (guessed)\(\backslash\)n"{}};}
\DoxyCodeLine{03855\ \ \ \ \ \}}
\DoxyCodeLine{03856\ \ \ \}}
\DoxyCodeLine{03857\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{03858\ }
\DoxyCodeLine{03859\ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{03860\ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{03861\ \ \ \_current\_vao\_index\ =\ 0;}
\DoxyCodeLine{03862\ \ \ \_current\_fbo\ =\ 0;}
\DoxyCodeLine{03863\ \ \ \_auto\_antialias\_mode\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03864\ \ \ \_render\_mode\ =\ RenderModeAttrib::M\_filled;}
\DoxyCodeLine{03865\ \ \ \_point\_size\ =\ 1.0f;}
\DoxyCodeLine{03866\ \ \ \_point\_perspective\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03867\ }
\DoxyCodeLine{03868\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03869\ \ \ \_current\_vertex\_buffers.clear();}
\DoxyCodeLine{03870\ \ \ \_current\_vertex\_format.clear();}
\DoxyCodeLine{03871\ \ \ memset(\_vertex\_attrib\_columns,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomVertexColumn}{GeomVertexColumn}}\ *)\ *\ 32);}
\DoxyCodeLine{03872\ }
\DoxyCodeLine{03873\ \ \ \_current\_sbuffer\_index\ =\ 0;}
\DoxyCodeLine{03874\ \ \ \_current\_sbuffer\_base.clear();}
\DoxyCodeLine{03875\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03876\ }
\DoxyCodeLine{03877\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{03878\ }
\DoxyCodeLine{03879\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03880\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03881\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_cheap\_textures)\ \{}
\DoxyCodeLine{03882\ \ \ \ \ \ \ GLCAT.info()}
\DoxyCodeLine{03883\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Setting\ glHint()\ for\ fastest\ textures.\(\backslash\)n"{}};}
\DoxyCodeLine{03884\ \ \ \ \ \ \ glHint(GL\_PERSPECTIVE\_CORRECTION\_HINT,\ GL\_FASTEST);}
\DoxyCodeLine{03885\ \ \ \ \ \}}
\DoxyCodeLine{03886\ }
\DoxyCodeLine{03887\ \ \ \ \ \textcolor{comment}{//\ Use\ per-\/vertex\ fog\ if\ per-\/pixel\ fog\ requires\ SW\ renderer}}
\DoxyCodeLine{03888\ \ \ \ \ glHint(GL\_FOG\_HINT,\ GL\_DONT\_CARE);}
\DoxyCodeLine{03889\ \ \ \}}
\DoxyCodeLine{03890\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03891\ }
\DoxyCodeLine{03892\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{03893\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{03894\ \ \ \ \ GLint\ num\_red\_bits\ =\ 0;}
\DoxyCodeLine{03895\ \ \ \ \ glGetIntegerv(GL\_RED\_BITS,\ \&num\_red\_bits);}
\DoxyCodeLine{03896\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_red\_bits\ <\ 8)\ \{}
\DoxyCodeLine{03897\ \ \ \ \ \ \ glEnable(GL\_DITHER);}
\DoxyCodeLine{03898\ \ \ \ \ \ \ \_dithering\_enabled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03899\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03900\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03901\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}frame\ buffer\ depth\ =\ "{}}\ <<\ num\_red\_bits}
\DoxyCodeLine{03902\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ bits/channel,\ enabling\ dithering\(\backslash\)n"{}};}
\DoxyCodeLine{03903\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03904\ \ \ \ \ \}}
\DoxyCodeLine{03905\ \ \ \}}
\DoxyCodeLine{03906\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03907\ }
\DoxyCodeLine{03908\ \ \ \_error\_count\ =\ 0;}
\DoxyCodeLine{03909\ }
\DoxyCodeLine{03910\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{03911\ }
\DoxyCodeLine{03912\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES\_1)\ \&\&\ !defined(\_\_EMSCRIPTEN\_\_)}}
\DoxyCodeLine{03913\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03914\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_get\_program\_binary)\ \{}
\DoxyCodeLine{03915\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{03916\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Supported\ program\ binary\ formats:\(\backslash\)n"{}};}
\DoxyCodeLine{03917\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{03918\ }
\DoxyCodeLine{03919\ \ \ \ \ \ \ \mbox{\hyperlink{classpset}{pset<GLenum>::const\_iterator}}\ it;}
\DoxyCodeLine{03920\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (it\ =\ \_program\_binary\_formats.begin();}
\DoxyCodeLine{03921\ \ \ \ \ \ \ \ \ \ \ \ it\ !=\ \_program\_binary\_formats.end();\ ++it)\ \{}
\DoxyCodeLine{03922\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ number[16];}
\DoxyCodeLine{03923\ \ \ \ \ \ \ \ \ sprintf(number,\ \textcolor{stringliteral}{"{}0x\%04X"{}},\ *it);}
\DoxyCodeLine{03924\ \ \ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ number\ <<\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{03925\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03926\ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03927\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03928\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}No\ program\ binary\ formats\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{03929\ \ \ \ \ \}}
\DoxyCodeLine{03930\ \ \ \}}
\DoxyCodeLine{03931\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{03932\ }
\DoxyCodeLine{03933\ \ \ \textcolor{comment}{//\ Do\ we\ guarantee\ that\ we\ can\ apply\ the\ color\ scale\ via\ a\ shader?\ \ We\ set}}
\DoxyCodeLine{03934\ \ \ \textcolor{comment}{//\ this\ false\ if\ there\ is\ a\ chance\ that\ the\ fixed-\/function\ pipeline\ is\ used.}}
\DoxyCodeLine{03935\ \ \ \_runtime\_color\_scale\ =\ !has\_fixed\_function\_pipeline();}
\DoxyCodeLine{03936\ }
\DoxyCodeLine{03937\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{03938\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_shadlang\_ver\_major\ >=\ 4\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_gpu\_program5"{}}))\ \{}
\DoxyCodeLine{03939\ \ \ \ \ \textcolor{comment}{//\ gp5fp\ -\/\ OpenGL\ fragment\ profile\ for\ GeForce\ 400\ Series\ and\ up}}
\DoxyCodeLine{03940\ \ \ \ \ \_shader\_model\ =\ SM\_50;}
\DoxyCodeLine{03941\ }
\DoxyCodeLine{03942\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_gl\_shadlang\_ver\_major\ >=\ 3\ ||}
\DoxyCodeLine{03943\ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_gpu\_program4"{}}))\ \{}
\DoxyCodeLine{03944\ \ \ \ \ \textcolor{comment}{//\ gp4fp\ -\/\ OpenGL\ fragment\ profile\ for\ G8x\ (GeForce\ 8xxx\ and\ up)}}
\DoxyCodeLine{03945\ \ \ \ \ \_shader\_model\ =\ SM\_40;}
\DoxyCodeLine{03946\ }
\DoxyCodeLine{03947\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_fragment\_program2"{}}))\ \{}
\DoxyCodeLine{03948\ \ \ \ \ \textcolor{comment}{//\ fp40\ -\/\ OpenGL\ fragment\ profile\ for\ NV4x\ (GeForce\ 6xxx\ and\ 7xxx\ Series,}}
\DoxyCodeLine{03949\ \ \ \ \ \textcolor{comment}{//\ NV4x-\/based\ Quadro\ FX,\ etc.)}}
\DoxyCodeLine{03950\ \ \ \ \ \_shader\_model\ =\ SM\_30;}
\DoxyCodeLine{03951\ }
\DoxyCodeLine{03952\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_fragment\_program"{}}))\ \{}
\DoxyCodeLine{03953\ \ \ \ \ \textcolor{comment}{//\ fp30\ -\/\ OpenGL\ fragment\ profile\ for\ NV3x\ (GeForce\ FX,\ Quadro\ FX,\ etc.)}}
\DoxyCodeLine{03954\ \ \ \ \ \_shader\_model\ =\ SM\_2X;}
\DoxyCodeLine{03955\ }
\DoxyCodeLine{03956\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_gl\_shadlang\_ver\_major\ >=\ 1\ ||}
\DoxyCodeLine{03957\ \ \ \ \ \ \ \ \ \ \ \ \ \ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_fragment\_program"{}}))\ \{}
\DoxyCodeLine{03958\ \ \ \ \ \textcolor{comment}{//\ This\ OpenGL\ profile\ corresponds\ to\ the\ per-\/fragment\ functionality}}
\DoxyCodeLine{03959\ \ \ \ \ \textcolor{comment}{//\ introduced\ by\ GeForce\ FX\ and\ other\ DirectX\ 9\ GPUs.}}
\DoxyCodeLine{03960\ \ \ \ \ \_shader\_model\ =\ SM\_20;}
\DoxyCodeLine{03961\ }
\DoxyCodeLine{03962\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_texture\_shader2"{}}))\ \{}
\DoxyCodeLine{03963\ \ \ \ \ \textcolor{comment}{//\ fp20\ -\/\ OpenGL\ fragment\ profile\ for\ NV2x\ (GeForce3,\ GeForce4\ Ti,\ Quadro}}
\DoxyCodeLine{03964\ \ \ \ \ \textcolor{comment}{//\ DCC,\ etc.)}}
\DoxyCodeLine{03965\ \ \ \ \ \_shader\_model\ =\ SM\_11;}
\DoxyCodeLine{03966\ }
\DoxyCodeLine{03967\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{03968\ \ \ \ \ \textcolor{comment}{//\ No\ shader\ support}}
\DoxyCodeLine{03969\ \ \ \ \ \_shader\_model\ =\ SM\_00;}
\DoxyCodeLine{03970\ \ \ \}}
\DoxyCodeLine{03971\ }
\DoxyCodeLine{03972\ \ \ \textcolor{comment}{//\ DisplayInformation\ may\ have\ better\ shader\ model\ detection}}
\DoxyCodeLine{03973\ \ \ \{}
\DoxyCodeLine{03974\ \ \ \ \ \mbox{\hyperlink{classGraphicsPipe}{GraphicsPipe}}\ *pipe;}
\DoxyCodeLine{03975\ \ \ \ \ \mbox{\hyperlink{classDisplayInformation}{DisplayInformation}}\ *display\_information;}
\DoxyCodeLine{03976\ }
\DoxyCodeLine{03977\ \ \ \ \ pipe\ =\ this-\/>get\_pipe();}
\DoxyCodeLine{03978\ \ \ \ \ \textcolor{keywordflow}{if}\ (pipe)\ \{}
\DoxyCodeLine{03979\ \ \ \ \ \ \ display\_information\ =\ pipe-\/>\mbox{\hyperlink{classGraphicsPipe_ad368f79574c37e47175d34b86b43a861}{get\_display\_information}}\ ();}
\DoxyCodeLine{03980\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_information)\ \{}
\DoxyCodeLine{03981\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_information-\/>get\_shader\_model()\ >\ \_shader\_model)\ \{}
\DoxyCodeLine{03982\ \ \ \ \ \ \ \ \ \ \ \_shader\_model\ =\ display\_information-\/>get\_shader\_model();}
\DoxyCodeLine{03983\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03984\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03985\ \ \ \ \ \}}
\DoxyCodeLine{03986\ \ \ \}}
\DoxyCodeLine{03987\ \ \ \_auto\_detect\_shader\_model\ =\ \_shader\_model;}
\DoxyCodeLine{03988\ }
\DoxyCodeLine{03989\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{03990\ \textcolor{preprocessor}{\#ifdef\ HAVE\_CG}}
\DoxyCodeLine{03991\ \textcolor{preprocessor}{\#if\ CG\_VERSION\_NUM\ >=\ 2200}}
\DoxyCodeLine{03992\ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}Supported\ Cg\ profiles:\(\backslash\)n"{}};}
\DoxyCodeLine{03993\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_profiles\ =\ cgGetNumSupportedProfiles();}
\DoxyCodeLine{03994\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_profiles;\ ++i)\ \{}
\DoxyCodeLine{03995\ \ \ \ \ \ \ CGprofile\ profile\ =\ cgGetSupportedProfile(i);}
\DoxyCodeLine{03996\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cgGLIsProfileSupported(profile))\ \{}
\DoxyCodeLine{03997\ \ \ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ cgGetProfileString(profile)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{03998\ \ \ \ \ \ \ \}}
\DoxyCodeLine{03999\ \ \ \ \ \}}
\DoxyCodeLine{04000\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ CG\_VERSION\_NUM\ >=\ 2200}}
\DoxyCodeLine{04001\ }
\DoxyCodeLine{04002\ \textcolor{preprocessor}{\#if\ CG\_VERSION\_NUM\ >=\ 3100}}
\DoxyCodeLine{04003\ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}Cg\ GLSL\ version\ =\ "{}}}
\DoxyCodeLine{04004\ \ \ \ \ \ \ <<\ cgGLGetGLSLVersionString(cgGLDetectGLSLVersion())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04005\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04006\ }
\DoxyCodeLine{04007\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04008\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ latest\ vertex\ profile\ =\ "{}}}
\DoxyCodeLine{04009\ \ \ \ \ \ \ <<\ cgGetProfileString(cgGLGetLatestProfile(CG\_GL\_VERTEX))\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04010\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04011\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ latest\ fragment\ profile\ =\ "{}}}
\DoxyCodeLine{04012\ \ \ \ \ \ \ <<\ cgGetProfileString(cgGLGetLatestProfile(CG\_GL\_FRAGMENT))\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04013\ \textcolor{preprocessor}{\#if\ CG\_VERSION\_NUM\ >=\ 2000}}
\DoxyCodeLine{04014\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04015\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ latest\ geometry\ profile\ =\ "{}}}
\DoxyCodeLine{04016\ \ \ \ \ \ \ <<\ cgGetProfileString(cgGLGetLatestProfile(CG\_GL\_GEOMETRY))\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04017\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04018\ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}basic-\/shaders-\/only\ "{}}\ <<\ basic\_shaders\_only\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04019\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04020\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ active\ vertex\ profile\ =\ "{}}}
\DoxyCodeLine{04021\ \ \ \ \ \ \ <<\ cgGetProfileString((CGprofile)\_shader\_caps.\_active\_vprofile)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04022\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04023\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ active\ fragment\ profile\ =\ "{}}}
\DoxyCodeLine{04024\ \ \ \ \ \ \ <<\ cgGetProfileString((CGprofile)\_shader\_caps.\_active\_fprofile)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04025\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04026\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cg\ active\ geometry\ profile\ =\ "{}}}
\DoxyCodeLine{04027\ \ \ \ \ \ \ <<\ cgGetProfileString((CGprofile)\_shader\_caps.\_active\_gprofile)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04028\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_CG}}
\DoxyCodeLine{04029\ }
\DoxyCodeLine{04030\ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}shader\ model\ =\ "{}}\ <<\ \_shader\_model\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04031\ \ \ \}}
\DoxyCodeLine{04032\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{04033\ }
\DoxyCodeLine{04034\ \ \ \textcolor{comment}{//\ OpenGL\ core\ profile\ requires\ a\ VAO\ to\ be\ bound.\ \ It's\ a\ bit\ silly,}}
\DoxyCodeLine{04035\ \ \ \textcolor{comment}{//\ because\ we\ can\ just\ bind\ a\ VAO\ and\ then\ forget\ about\ it.}}
\DoxyCodeLine{04036\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)}}
\DoxyCodeLine{04037\ \ \ \textcolor{keywordflow}{if}\ (core\_profile)\ \{}
\DoxyCodeLine{04038\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_vao)\ \{}
\DoxyCodeLine{04039\ \ \ \ \ \ \ \_glGenVertexArrays(1,\ \&\_current\_vao\_index);}
\DoxyCodeLine{04040\ \ \ \ \ \ \ \_glBindVertexArray(\_current\_vao\_index);}
\DoxyCodeLine{04041\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04042\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{04043\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Core\ profile\ enabled,\ but\ vertex\ array\ objects\ not\ supported!\(\backslash\)n"{}};}
\DoxyCodeLine{04044\ \ \ \ \ \}}
\DoxyCodeLine{04045\ \ \ \}}
\DoxyCodeLine{04046\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04047\ }
\DoxyCodeLine{04048\ \ \ pop\_group\_marker();}
\DoxyCodeLine{04049\ }
\DoxyCodeLine{04050\ \ \ \textcolor{comment}{//\ Now\ that\ the\ GSG\ has\ been\ initialized,\ make\ it\ available\ for}}
\DoxyCodeLine{04051\ \ \ \textcolor{comment}{//\ optimizations.}}
\DoxyCodeLine{04052\ \ \ add\_gsg(\textcolor{keyword}{this});}
\DoxyCodeLine{04053\ \}}
\DoxyCodeLine{04054\ }
\DoxyCodeLine{04062\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04063\ finish()\ \{}
\DoxyCodeLine{04064\ \ \ \textcolor{comment}{//\ Rather\ than\ call\ glfinish\ which\ returns\ immediately\ if\ draw\ commands\ have}}
\DoxyCodeLine{04065\ \ \ \textcolor{comment}{//\ been\ submitted,\ we\ will\ read\ a\ single\ pixel\ from\ the\ frame.\ \ That\ will}}
\DoxyCodeLine{04066\ \ \ \textcolor{comment}{//\ force\ the\ graphics\ card\ to\ finish\ drawing\ before\ it\ is\ called}}
\DoxyCodeLine{04067\ \ \ \textcolor{keywordtype}{char}\ data[4];}
\DoxyCodeLine{04068\ \ \ glReadPixels(0,0,1,1,GL\_RGBA,GL\_UNSIGNED\_BYTE,\&data);}
\DoxyCodeLine{04069\ \ \ \textcolor{comment}{//\ glFinish();}}
\DoxyCodeLine{04070\ \}}
\DoxyCodeLine{04071\ }
\DoxyCodeLine{04080\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04081\ clear(\mbox{\hyperlink{classDrawableRegion}{DrawableRegion}}\ *clearable)\ \{}
\DoxyCodeLine{04082\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04083\ }
\DoxyCodeLine{04084\ \ \ \textcolor{keywordflow}{if}\ (!clearable-\/>is\_any\_clear\_active())\ \{}
\DoxyCodeLine{04085\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04086\ \ \ \}}
\DoxyCodeLine{04087\ }
\DoxyCodeLine{04088\ \ \ \textcolor{comment}{//\ XXX\ rdb:\ Is\ this\ line\ really\ necessary?\ \ Could\ we\ perhaps\ just\ reset\ the}}
\DoxyCodeLine{04089\ \ \ \textcolor{comment}{//\ color\ write\ mask\ and\ other\ relevant\ attributes?}}
\DoxyCodeLine{04090\ \ \ set\_state\_and\_transform(RenderState::make\_empty(),\ \_internal\_transform);}
\DoxyCodeLine{04091\ }
\DoxyCodeLine{04092\ \ \ \textcolor{keywordtype}{int}\ mask\ =\ 0;}
\DoxyCodeLine{04093\ }
\DoxyCodeLine{04094\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04095\ \ \ \textcolor{keywordflow}{if}\ (\_current\_fbo\ !=\ 0\ \&\&\ \_glClearBufferfv\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04096\ \ \ \ \ \textcolor{comment}{//\ We\ can\ use\ glClearBuffer\ to\ clear\ all\ the\ color\ attachments,\ which}}
\DoxyCodeLine{04097\ \ \ \ \ \textcolor{comment}{//\ protects\ us\ from\ the\ overhead\ of\ having\ to\ call\ set\_draw\_buffer\ for}}
\DoxyCodeLine{04098\ \ \ \ \ \textcolor{comment}{//\ every\ single\ attachment.}}
\DoxyCodeLine{04099\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ 0;}
\DoxyCodeLine{04100\ }
\DoxyCodeLine{04101\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_color\_bits()\ >\ 0)\ \{}
\DoxyCodeLine{04102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>is\_stereo())\ \{}
\DoxyCodeLine{04103\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clear\ both\ left\ and\ right\ attachments.}}
\DoxyCodeLine{04104\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(GraphicsOutput::RTP\_color))\ \{}
\DoxyCodeLine{04105\ \ \ \ \ \ \ \ \ \ \ LColorf\ v\ =\ LCAST(\textcolor{keywordtype}{float},\ clearable-\/>get\_clear\_value(GraphicsOutput::RTP\_color));}
\DoxyCodeLine{04106\ \ \ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index,\ v.get\_data());}
\DoxyCodeLine{04107\ \ \ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index\ +\ 1,\ v.get\_data());}
\DoxyCodeLine{04108\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04109\ \ \ \ \ \ \ \ \ index\ +=\ 2;}
\DoxyCodeLine{04110\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04111\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(GraphicsOutput::RTP\_color))\ \{}
\DoxyCodeLine{04112\ \ \ \ \ \ \ \ \ \ \ LColorf\ v\ =\ LCAST(\textcolor{keywordtype}{float},\ clearable-\/>get\_clear\_value(GraphicsOutput::RTP\_color));}
\DoxyCodeLine{04113\ \ \ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index,\ v.get\_data());}
\DoxyCodeLine{04114\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04115\ \ \ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{04116\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04117\ \ \ \ \ \}}
\DoxyCodeLine{04118\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_rgba();\ ++i)\ \{}
\DoxyCodeLine{04119\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_rgba\_0\ +\ i;}
\DoxyCodeLine{04120\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04121\ \ \ \ \ \ \ \ \ LColorf\ v\ =\ LCAST(\textcolor{keywordtype}{float},\ clearable-\/>get\_clear\_value(layerid));}
\DoxyCodeLine{04122\ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index,\ v.get\_data());}
\DoxyCodeLine{04123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04124\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{04125\ \ \ \ \ \}}
\DoxyCodeLine{04126\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_hrgba();\ ++i)\ \{}
\DoxyCodeLine{04127\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_hrgba\_0\ +\ i;}
\DoxyCodeLine{04128\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04129\ \ \ \ \ \ \ \ \ LColorf\ v\ =\ LCAST(\textcolor{keywordtype}{float},\ clearable-\/>get\_clear\_value(layerid));}
\DoxyCodeLine{04130\ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index,\ v.get\_data());}
\DoxyCodeLine{04131\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04132\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{04133\ \ \ \ \ \}}
\DoxyCodeLine{04134\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_float();\ ++i)\ \{}
\DoxyCodeLine{04135\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_float\_0\ +\ i;}
\DoxyCodeLine{04136\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04137\ \ \ \ \ \ \ \ \ LColorf\ v\ =\ LCAST(\textcolor{keywordtype}{float},\ clearable-\/>get\_clear\_value(layerid));}
\DoxyCodeLine{04138\ \ \ \ \ \ \ \ \ \_glClearBufferfv(GL\_COLOR,\ index,\ v.get\_data());}
\DoxyCodeLine{04139\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04140\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{04141\ \ \ \ \ \}}
\DoxyCodeLine{04142\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04143\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04144\ \ \ \{}
\DoxyCodeLine{04145\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_aux\_mask()\ !=\ 0)\ \{}
\DoxyCodeLine{04146\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_rgba();\ ++i)\ \{}
\DoxyCodeLine{04147\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_rgba\_0\ +\ i;}
\DoxyCodeLine{04148\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerbit\ =\ RenderBuffer::T\_aux\_rgba\_0\ <<\ i;}
\DoxyCodeLine{04149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04150\ \ \ \ \ \ \ \ \ \ \ LColor\ v\ =\ clearable-\/>get\_clear\_value(layerid);}
\DoxyCodeLine{04151\ \ \ \ \ \ \ \ \ \ \ glClearColor(v[0],\ v[1],\ v[2],\ v[3]);}
\DoxyCodeLine{04152\ \ \ \ \ \ \ \ \ \ \ set\_draw\_buffer(layerbit);}
\DoxyCodeLine{04153\ \ \ \ \ \ \ \ \ \ \ glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{04154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04155\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04156\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_hrgba();\ ++i)\ \{}
\DoxyCodeLine{04157\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_hrgba\_0\ +\ i;}
\DoxyCodeLine{04158\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerbit\ =\ RenderBuffer::T\_aux\_hrgba\_0\ <<\ i;}
\DoxyCodeLine{04159\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04160\ \ \ \ \ \ \ \ \ \ \ LColor\ v\ =\ clearable-\/>get\_clear\_value(layerid);}
\DoxyCodeLine{04161\ \ \ \ \ \ \ \ \ \ \ glClearColor(v[0],\ v[1],\ v[2],\ v[3]);}
\DoxyCodeLine{04162\ \ \ \ \ \ \ \ \ \ \ set\_draw\_buffer(layerbit);}
\DoxyCodeLine{04163\ \ \ \ \ \ \ \ \ \ \ glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{04164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04165\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04166\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_float();\ ++i)\ \{}
\DoxyCodeLine{04167\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerid\ =\ GraphicsOutput::RTP\_aux\_float\_0\ +\ i;}
\DoxyCodeLine{04168\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ layerbit\ =\ RenderBuffer::T\_aux\_float\_0\ <<\ i;}
\DoxyCodeLine{04169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_active(layerid))\ \{}
\DoxyCodeLine{04170\ \ \ \ \ \ \ \ \ \ \ LColor\ v\ =\ clearable-\/>get\_clear\_value(layerid);}
\DoxyCodeLine{04171\ \ \ \ \ \ \ \ \ \ \ glClearColor(v[0],\ v[1],\ v[2],\ v[3]);}
\DoxyCodeLine{04172\ \ \ \ \ \ \ \ \ \ \ set\_draw\_buffer(layerbit);}
\DoxyCodeLine{04173\ \ \ \ \ \ \ \ \ \ \ glClear(GL\_COLOR\_BUFFER\_BIT);}
\DoxyCodeLine{04174\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04175\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04176\ }
\DoxyCodeLine{04177\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ the\ past,\ it\ was\ possible\ to\ set\ the\ draw\ buffer\ once\ in}}
\DoxyCodeLine{04178\ \ \ \ \ \ \ \textcolor{comment}{//\ prepare\_display\_region\ and\ then\ forget\ about\ it.\ \ Now,\ with\ aux}}
\DoxyCodeLine{04179\ \ \ \ \ \ \ \textcolor{comment}{//\ layers,\ it\ is\ necessary\ to\ occasionally\ change\ the\ draw\ buffer.\ \ In}}
\DoxyCodeLine{04180\ \ \ \ \ \ \ \textcolor{comment}{//\ time,\ I\ think\ there\ will\ need\ to\ be\ a\ draw\ buffer\ attrib.\ \ Until}}
\DoxyCodeLine{04181\ \ \ \ \ \ \ \textcolor{comment}{//\ then,\ this\ little\ hack\ to\ put\ things\ back\ the\ way\ they\ were\ after}}
\DoxyCodeLine{04182\ \ \ \ \ \ \ \textcolor{comment}{//\ prepare\_display\_region\ will\ do.}}
\DoxyCodeLine{04183\ }
\DoxyCodeLine{04184\ \ \ \ \ \ \ set\_draw\_buffer(\_draw\_buffer\_type);}
\DoxyCodeLine{04185\ \ \ \ \ \}}
\DoxyCodeLine{04186\ }
\DoxyCodeLine{04187\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_color\_bits()\ >\ 0)\ \{}
\DoxyCodeLine{04188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_color\_active())\ \{}
\DoxyCodeLine{04189\ \ \ \ \ \ \ \ \ LColor\ v\ =\ clearable-\/>get\_clear\_color();}
\DoxyCodeLine{04190\ \ \ \ \ \ \ \ \ glClearColor(v[0],\ v[1],\ v[2],\ v[3]);}
\DoxyCodeLine{04191\ \ \ \ \ \ \ \ \ clear\_color\_write\_mask();}
\DoxyCodeLine{04192\ \ \ \ \ \ \ \ \ \_state\_mask.clear\_bit(ColorWriteAttrib::get\_class\_slot());}
\DoxyCodeLine{04193\ \ \ \ \ \ \ \ \ mask\ |=\ GL\_COLOR\_BUFFER\_BIT;}
\DoxyCodeLine{04194\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04195\ \ \ \ \ \}}
\DoxyCodeLine{04196\ \ \ \}}
\DoxyCodeLine{04197\ }
\DoxyCodeLine{04198\ \ \ \textcolor{keywordflow}{if}\ (clearable-\/>get\_clear\_depth\_active())\ \{}
\DoxyCodeLine{04199\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{04200\ \ \ \ \ glClearDepthf(clearable-\/>get\_clear\_depth());}
\DoxyCodeLine{04201\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04202\ \ \ \ \ glClearDepth(clearable-\/>get\_clear\_depth());}
\DoxyCodeLine{04203\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{04204\ \textcolor{preprocessor}{\#ifdef\ GSG\_VERBOSE}}
\DoxyCodeLine{04205\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04206\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDepthMask(GL\_TRUE)"{}}\ <<\ endl;}
\DoxyCodeLine{04207\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04208\ \ \ \ \ glDepthMask(GL\_TRUE);}
\DoxyCodeLine{04209\ \ \ \ \ \_state\_mask.clear\_bit(DepthWriteAttrib::get\_class\_slot());}
\DoxyCodeLine{04210\ \ \ \ \ mask\ |=\ GL\_DEPTH\_BUFFER\_BIT;}
\DoxyCodeLine{04211\ \ \ \}}
\DoxyCodeLine{04212\ }
\DoxyCodeLine{04213\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_stencil\ \&\&\ clearable-\/>get\_clear\_stencil\_active())\ \{}
\DoxyCodeLine{04214\ \ \ \ \ glStencilMask(\string~0);}
\DoxyCodeLine{04215\ \ \ \ \ glClearStencil(clearable-\/>get\_clear\_stencil());}
\DoxyCodeLine{04216\ \ \ \ \ mask\ |=\ GL\_STENCIL\_BUFFER\_BIT;}
\DoxyCodeLine{04217\ \ \ \}}
\DoxyCodeLine{04218\ }
\DoxyCodeLine{04219\ \ \ \textcolor{keywordflow}{if}\ (mask\ !=\ 0)\ \{}
\DoxyCodeLine{04220\ \ \ \ \ glClear(mask);}
\DoxyCodeLine{04221\ }
\DoxyCodeLine{04222\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04223\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ clear\_flags;}
\DoxyCodeLine{04224\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mask\ \&\ GL\_COLOR\_BUFFER\_BIT)\ \{}
\DoxyCodeLine{04225\ \ \ \ \ \ \ \ \ clear\_flags\ +=\ \textcolor{stringliteral}{"{}\ |\ GL\_COLOR\_BUFFER\_BIT"{}};}
\DoxyCodeLine{04226\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04227\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mask\ \&\ GL\_DEPTH\_BUFFER\_BIT)\ \{}
\DoxyCodeLine{04228\ \ \ \ \ \ \ \ \ clear\_flags\ +=\ \textcolor{stringliteral}{"{}\ |\ GL\_DEPTH\_BUFFER\_BIT"{}};}
\DoxyCodeLine{04229\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04230\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mask\ \&\ GL\_STENCIL\_BUFFER\_BIT)\ \{}
\DoxyCodeLine{04231\ \ \ \ \ \ \ \ \ clear\_flags\ +=\ \textcolor{stringliteral}{"{}\ |\ GL\_STENCIL\_BUFFER\_BIT"{}};}
\DoxyCodeLine{04232\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04233\ \textcolor{preprocessor}{\ \ \#ifndef\ OPENGLES}}
\DoxyCodeLine{04234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mask\ \&\ GL\_ACCUM\_BUFFER\_BIT)\ \{}
\DoxyCodeLine{04235\ \ \ \ \ \ \ \ \ clear\_flags\ +=\ \textcolor{stringliteral}{"{}\ |\ GL\_ACCUM\_BUFFER\_BIT"{}};}
\DoxyCodeLine{04236\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04237\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{04238\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glClear("{}}\ <<\ (clear\_flags.c\_str()\ +\ 3)\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04239\ \ \ \ \ \}}
\DoxyCodeLine{04240\ \ \ \}}
\DoxyCodeLine{04241\ }
\DoxyCodeLine{04242\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04243\ \}}
\DoxyCodeLine{04244\ }
\DoxyCodeLine{04248\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04249\ prepare\_display\_region(\mbox{\hyperlink{classDisplayRegionPipelineReader}{DisplayRegionPipelineReader}}\ *dr)\ \{}
\DoxyCodeLine{04250\ \ \ nassertv(dr\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{04251\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian_a60bb06c5987b92bc39591d4a27bea4ab}{GraphicsStateGuardian::prepare\_display\_region}}(dr);}
\DoxyCodeLine{04252\ }
\DoxyCodeLine{04253\ \ \ \textcolor{keywordtype}{int}\ l,\ b,\ w,\ h;}
\DoxyCodeLine{04254\ \ \ dr-\/>get\_region\_pixels(l,\ b,\ w,\ h);}
\DoxyCodeLine{04255\ \ \ \_viewport\_x\ =\ l;}
\DoxyCodeLine{04256\ \ \ \_viewport\_y\ =\ b;}
\DoxyCodeLine{04257\ \ \ \_viewport\_width\ =\ w;}
\DoxyCodeLine{04258\ \ \ \_viewport\_height\ =\ h;}
\DoxyCodeLine{04259\ \ \ GLint\ x\ =\ GLint(l);}
\DoxyCodeLine{04260\ \ \ GLint\ y\ =\ GLint(b);}
\DoxyCodeLine{04261\ \ \ GLsizei\ width\ =\ GLsizei(w);}
\DoxyCodeLine{04262\ \ \ GLsizei\ height\ =\ GLsizei(h);}
\DoxyCodeLine{04263\ }
\DoxyCodeLine{04264\ \ \ \_draw\_buffer\_type\ =\ dr-\/>get\_object()-\/>get\_draw\_buffer\_type()\ \&\ \_current\_properties-\/>get\_buffer\_mask()\ \&\ \_stereo\_buffer\_mask;}
\DoxyCodeLine{04265\ \ \ \_draw\_buffer\_type\ |=\ \_current\_properties-\/>get\_aux\_mask();}
\DoxyCodeLine{04266\ \ \ set\_draw\_buffer(\_draw\_buffer\_type);}
\DoxyCodeLine{04267\ }
\DoxyCodeLine{04268\ \ \ \textcolor{keywordtype}{int}\ count\ =\ dr-\/>get\_num\_regions();}
\DoxyCodeLine{04269\ }
\DoxyCodeLine{04270\ \ \ \textcolor{keywordflow}{if}\ (dr-\/>get\_scissor\_enabled())\ \{}
\DoxyCodeLine{04271\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04272\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04273\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glEnable(GL\_SCISSOR\_TEST)\(\backslash\)n"{}};}
\DoxyCodeLine{04274\ \ \ \ \ \}}
\DoxyCodeLine{04275\ \ \ \ \ glEnable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{04276\ \ \ \ \ \_scissor\_enabled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04277\ \ \ \ \ \_scissor\_array.resize(count);}
\DoxyCodeLine{04278\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04279\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04280\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04281\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDisable(GL\_SCISSOR\_TEST)\(\backslash\)n"{}};}
\DoxyCodeLine{04282\ \ \ \ \ \}}
\DoxyCodeLine{04283\ \ \ \ \ glDisable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{04284\ \ \ \ \ \_scissor\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04285\ \ \ \ \ \_scissor\_array.clear();}
\DoxyCodeLine{04286\ \ \ \}}
\DoxyCodeLine{04287\ }
\DoxyCodeLine{04288\ \ \ \_scissor\_attrib\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04289\ }
\DoxyCodeLine{04290\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{04291\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_viewport\_arrays)\ \{}
\DoxyCodeLine{04292\ }
\DoxyCodeLine{04293\ \ \ \ \ GLfloat\ *viewports\ =\ (GLfloat\ *)alloca(\textcolor{keyword}{sizeof}(GLfloat)\ *\ 4\ *\ count);}
\DoxyCodeLine{04294\ }
\DoxyCodeLine{04295\ \ \ \ \ \textcolor{comment}{//\ We\ store\ the\ scissor\ regions\ in\ a\ vector\ since\ we\ may\ need\ to\ switch}}
\DoxyCodeLine{04296\ \ \ \ \ \textcolor{comment}{//\ back\ to\ it\ in\ do\_issue\_scissor.}}
\DoxyCodeLine{04297\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ ++i)\ \{}
\DoxyCodeLine{04298\ \ \ \ \ \ \ LVecBase4i\ sr;}
\DoxyCodeLine{04299\ \ \ \ \ \ \ dr-\/>get\_region\_pixels(i,\ sr[0],\ sr[1],\ sr[2],\ sr[3]);}
\DoxyCodeLine{04300\ \ \ \ \ \ \ GLfloat\ *vr\ =\ viewports\ +\ i\ *\ 4;}
\DoxyCodeLine{04301\ \ \ \ \ \ \ vr[0]\ =\ (GLfloat)\ sr[0];}
\DoxyCodeLine{04302\ \ \ \ \ \ \ vr[1]\ =\ (GLfloat)\ sr[1];}
\DoxyCodeLine{04303\ \ \ \ \ \ \ vr[2]\ =\ (GLfloat)\ sr[2];}
\DoxyCodeLine{04304\ \ \ \ \ \ \ vr[3]\ =\ (GLfloat)\ sr[3];}
\DoxyCodeLine{04305\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scissor\_enabled)\ \{}
\DoxyCodeLine{04306\ \ \ \ \ \ \ \ \ \_scissor\_array[i]\ =\ sr;}
\DoxyCodeLine{04307\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04308\ \ \ \ \ \}}
\DoxyCodeLine{04309\ \ \ \ \ \_glViewportArrayv(0,\ count,\ viewports);}
\DoxyCodeLine{04310\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scissor\_enabled)\ \{}
\DoxyCodeLine{04311\ \ \ \ \ \ \ \_glScissorArrayv(0,\ count,\ \_scissor\_array[0].get\_data());}
\DoxyCodeLine{04312\ \ \ \ \ \}}
\DoxyCodeLine{04313\ }
\DoxyCodeLine{04314\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04315\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04316\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glViewportArrayv(0,\ "{}}\ <<\ count\ <<\ \textcolor{stringliteral}{"{},"{}};}
\DoxyCodeLine{04317\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ ++i)\ \{}
\DoxyCodeLine{04318\ \ \ \ \ \ \ \ \ GLfloat\ *vr\ =\ viewports\ +\ i\ *\ 4;}
\DoxyCodeLine{04319\ \ \ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ ["{}}\ <<\ vr[0]\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ vr[1]\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ vr[2]\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ vr[3]\ <<\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{04320\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04321\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04322\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scissor\_enabled)\ \{}
\DoxyCodeLine{04323\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04324\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glScissorArrayv(0,\ "{}}\ <<\ count\ <<\ \textcolor{stringliteral}{"{},"{}};}
\DoxyCodeLine{04325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ count;\ ++i)\ \{}
\DoxyCodeLine{04326\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LVecBase4i\ \&sr\ =\ \_scissor\_array[i];}
\DoxyCodeLine{04327\ \ \ \ \ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ ["{}}\ <<\ sr\ <<\ \textcolor{stringliteral}{"{}]"{}};}
\DoxyCodeLine{04328\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04329\ \ \ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04330\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04331\ \ \ \ \ \}}
\DoxyCodeLine{04332\ }
\DoxyCodeLine{04333\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{04334\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{04335\ \ \ \{}
\DoxyCodeLine{04336\ \ \ \ \ glViewport(x,\ y,\ width,\ height);}
\DoxyCodeLine{04337\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scissor\_enabled)\ \{}
\DoxyCodeLine{04338\ \ \ \ \ \ \ glScissor(x,\ y,\ width,\ height);}
\DoxyCodeLine{04339\ }
\DoxyCodeLine{04340\ \ \ \ \ \ \ \_scissor\_array.resize(1);}
\DoxyCodeLine{04341\ \ \ \ \ \ \ \_scissor\_array[0].set(x,\ y,\ width,\ height);}
\DoxyCodeLine{04342\ \ \ \ \ \}}
\DoxyCodeLine{04343\ }
\DoxyCodeLine{04344\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04345\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04346\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glViewport("{}}\ <<\ x\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ y\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04347\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dr-\/>get\_scissor\_enabled())\ \{}
\DoxyCodeLine{04348\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04349\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glScissor("{}}\ <<\ x\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ y\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{04350\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04351\ \ \ \ \ \}}
\DoxyCodeLine{04352\ \ \ \}}
\DoxyCodeLine{04353\ }
\DoxyCodeLine{04354\ \ \ PN\_stdfloat\ nearv;}
\DoxyCodeLine{04355\ \ \ PN\_stdfloat\ farv;}
\DoxyCodeLine{04356\ \ \ dr-\/>get\_depth\_range(nearv,\ farv);}
\DoxyCodeLine{04357\ \textcolor{preprocessor}{\#ifdef\ GSG\_VERBOSE}}
\DoxyCodeLine{04358\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04359\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04360\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDepthRange("{}}\ <<\ nearv\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ farv\ <<\ \textcolor{stringliteral}{"{})"{}}\ <<\ endl;}
\DoxyCodeLine{04361\ \ \ \}}
\DoxyCodeLine{04362\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04363\ }
\DoxyCodeLine{04364\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{04365\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ uses\ a\ single-\/precision\ call.}}
\DoxyCodeLine{04366\ \ \ glDepthRangef((GLclampf)nearv,\ (GLclampf)farv);}
\DoxyCodeLine{04367\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04368\ \ \ \textcolor{comment}{//\ Mainline\ OpenGL\ uses\ a\ double-\/precision\ call.}}
\DoxyCodeLine{04369\ \ \ \textcolor{keywordflow}{if}\ (!\_use\_remapped\_depth\_range)\ \{}
\DoxyCodeLine{04370\ \ \ \ \ glDepthRange((GLclampd)nearv,\ (GLclampd)farv);}
\DoxyCodeLine{04371\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04372\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ remapped\ depth\ range,\ we\ should\ adjust\ the\ values\ to\ range}}
\DoxyCodeLine{04373\ \ \ \ \ \textcolor{comment}{//\ from\ -\/1\ to\ 1.\ \ We\ need\ to\ use\ an\ NV\ extension\ to\ pass\ unclamped\ values.}}
\DoxyCodeLine{04374\ \ \ \ \ \_glDepthRangedNV(nearv\ *\ 2.0\ -\/\ 1.0,\ farv\ *\ 2.0\ -\/\ 1.0);}
\DoxyCodeLine{04375\ \ \ \}}
\DoxyCodeLine{04376\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{04377\ \ \ \_has\_attrib\_depth\_range\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04378\ \ \ \_depth\_range\_near\ =\ nearv;}
\DoxyCodeLine{04379\ \ \ \_depth\_range\_far\ =\ farv;}
\DoxyCodeLine{04380\ }
\DoxyCodeLine{04381\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04382\ \}}
\DoxyCodeLine{04383\ }
\DoxyCodeLine{04390\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04391\ clear\_before\_callback()\ \{}
\DoxyCodeLine{04392\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{04393\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{04394\ \ \ \ \ disable\_standard\_vertex\_arrays();}
\DoxyCodeLine{04395\ \ \ \}}
\DoxyCodeLine{04396\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04397\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04398\ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_array\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{04399\ \ \ \ \ \_vertex\_array\_shader\_context-\/>disable\_shader\_vertex\_arrays();}
\DoxyCodeLine{04400\ \ \ \ \ \_vertex\_array\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04401\ \ \ \ \ \_vertex\_array\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04402\ \ \ \}}
\DoxyCodeLine{04403\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04404\ \ \ unbind\_buffers();}
\DoxyCodeLine{04405\ }
\DoxyCodeLine{04406\ \ \ \textcolor{comment}{//\ Some\ callbacks\ may\ quite\ reasonably\ assume\ that\ the\ active\ texture\ stage}}
\DoxyCodeLine{04407\ \ \ \textcolor{comment}{//\ is\ still\ set\ to\ stage\ 0.\ \ CEGUI,\ in\ particular,\ makes\ this\ assumption.}}
\DoxyCodeLine{04408\ \ \ set\_active\_texture\_stage(0);}
\DoxyCodeLine{04409\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{04410\ \ \ \_glClientActiveTexture(GL\_TEXTURE0);}
\DoxyCodeLine{04411\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04412\ }
\DoxyCodeLine{04413\ \ \ \textcolor{comment}{//\ It's\ also\ quite\ reasonable\ to\ presume\ there\ aren't\ any\ funny\ color\ write}}
\DoxyCodeLine{04414\ \ \ \textcolor{comment}{//\ mask\ settings\ active.}}
\DoxyCodeLine{04415\ \ \ clear\_color\_write\_mask();}
\DoxyCodeLine{04416\ }
\DoxyCodeLine{04417\ \ \ \textcolor{comment}{//\ Clear\ the\ bound\ sampler\ object,\ so\ that\ we\ do\ not\ inadvertently\ override}}
\DoxyCodeLine{04418\ \ \ \textcolor{comment}{//\ the\ callback's\ desired\ sampler\ settings.}}
\DoxyCodeLine{04419\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04420\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_sampler\_objects)\ \{}
\DoxyCodeLine{04421\ \ \ \ \ \_glBindSampler(0,\ 0);}
\DoxyCodeLine{04422\ }
\DoxyCodeLine{04423\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04424\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04425\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindSampler(0,\ 0)\(\backslash\)n"{}};}
\DoxyCodeLine{04426\ \ \ \ \ \}}
\DoxyCodeLine{04427\ \ \ \}}
\DoxyCodeLine{04428\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04429\ \}}
\DoxyCodeLine{04430\ }
\DoxyCodeLine{04439\ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04440\ calc\_projection\_mat(const\ \mbox{\hyperlink{classLens}{Lens}}\ *lens)\ \{}
\DoxyCodeLine{04441\ \ \ \textcolor{keywordflow}{if}\ (lens\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04442\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04443\ \ \ \}}
\DoxyCodeLine{04444\ }
\DoxyCodeLine{04445\ \ \ \textcolor{keywordflow}{if}\ (!lens-\/>is\_linear())\ \{}
\DoxyCodeLine{04446\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04447\ \ \ \}}
\DoxyCodeLine{04448\ }
\DoxyCodeLine{04449\ \ \ \textcolor{comment}{//\ The\ projection\ matrix\ must\ always\ be\ right-\/handed\ Y-\/up,\ even\ if\ our}}
\DoxyCodeLine{04450\ \ \ \textcolor{comment}{//\ coordinate\ system\ of\ choice\ is\ otherwise,\ because\ certain\ GL\ calls}}
\DoxyCodeLine{04451\ \ \ \textcolor{comment}{//\ (specifically\ glTexGen(GL\_SPHERE\_MAP))\ assume\ this\ kind\ of\ a\ coordinate}}
\DoxyCodeLine{04452\ \ \ \textcolor{comment}{//\ system.\ \ Sigh.\ \ In\ order\ to\ implement\ a\ Z-\/up\ (or\ other\ arbitrary)}}
\DoxyCodeLine{04453\ \ \ \textcolor{comment}{//\ coordinate\ system,\ we'll\ use\ a\ Y-\/up\ projection\ matrix,\ and\ store\ the}}
\DoxyCodeLine{04454\ \ \ \textcolor{comment}{//\ conversion\ to\ our\ coordinate\ system\ of\ choice\ in\ the\ modelview\ matrix.}}
\DoxyCodeLine{04455\ }
\DoxyCodeLine{04456\ \ \ LMatrix4\ result\ =}
\DoxyCodeLine{04457\ \ \ \ \ LMatrix4::convert\_mat(\_internal\_coordinate\_system,}
\DoxyCodeLine{04458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lens-\/>get\_coordinate\_system())\ *}
\DoxyCodeLine{04459\ \ \ \ \ lens-\/>get\_projection\_mat(\_current\_stereo\_channel);}
\DoxyCodeLine{04460\ }
\DoxyCodeLine{04461\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{04462\ \ \ \textcolor{keywordflow}{if}\ (\_use\_depth\_zero\_to\_one)\ \{}
\DoxyCodeLine{04463\ \ \ \ \ \textcolor{comment}{//\ If\ we\ requested\ that\ the\ OpenGL\ NDC\ Z\ goes\ from\ zero\ to\ one\ like\ in}}
\DoxyCodeLine{04464\ \ \ \ \ \textcolor{comment}{//\ Direct3D,\ we\ need\ to\ scale\ the\ projection\ matrix,\ which\ assumes\ -\/1..1.}}
\DoxyCodeLine{04465\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ LMatrix4\ rescale\_mat}
\DoxyCodeLine{04466\ \ \ \ \ \ \ (1,\ 0,\ 0,\ 0,}
\DoxyCodeLine{04467\ \ \ \ \ \ \ \ 0,\ 1,\ 0,\ 0,}
\DoxyCodeLine{04468\ \ \ \ \ \ \ \ 0,\ 0,\ 0.5,\ 0,}
\DoxyCodeLine{04469\ \ \ \ \ \ \ \ 0,\ 0,\ 0.5,\ 1);}
\DoxyCodeLine{04470\ \ \ \ \ result\ *=\ rescale\_mat;}
\DoxyCodeLine{04471\ \ \ \}}
\DoxyCodeLine{04472\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04473\ }
\DoxyCodeLine{04474\ \ \ \textcolor{keywordflow}{if}\ (\_scene\_setup-\/>get\_inverted())\ \{}
\DoxyCodeLine{04475\ \ \ \ \ \textcolor{comment}{//\ If\ the\ scene\ is\ supposed\ to\ be\ inverted,\ then\ invert\ the\ projection}}
\DoxyCodeLine{04476\ \ \ \ \ \textcolor{comment}{//\ matrix.}}
\DoxyCodeLine{04477\ \ \ \ \ result\ *=\ LMatrix4::scale\_mat(1.0f,\ -\/1.0f,\ 1.0f);}
\DoxyCodeLine{04478\ \ \ \}}
\DoxyCodeLine{04479\ }
\DoxyCodeLine{04480\ \ \ \textcolor{keywordflow}{return}\ TransformState::make\_mat(result);}
\DoxyCodeLine{04481\ \}}
\DoxyCodeLine{04482\ }
\DoxyCodeLine{04491\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04492\ prepare\_lens()\ \{}
\DoxyCodeLine{04493\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{04494\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{04495\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04496\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04497\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glMatrixMode(GL\_PROJECTION):\ "{}}\ <<\ \_projection\_mat-\/>get\_mat()\ <<\ endl;}
\DoxyCodeLine{04498\ \ \ \ \ \}}
\DoxyCodeLine{04499\ }
\DoxyCodeLine{04500\ \ \ \ \ glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{04501\ \ \ \ \ call\_glLoadMatrix(\_projection\_mat-\/>get\_mat());}
\DoxyCodeLine{04502\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04503\ }
\DoxyCodeLine{04504\ \ \ \ \ do\_point\_size();}
\DoxyCodeLine{04505\ \ \ \}}
\DoxyCodeLine{04506\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04507\ }
\DoxyCodeLine{04508\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{04509\ \}}
\DoxyCodeLine{04510\ }
\DoxyCodeLine{04519\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04520\ begin\_frame(\mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{04521\ \ \ process\_pending\_jobs(\textcolor{keyword}{false});}
\DoxyCodeLine{04522\ }
\DoxyCodeLine{04523\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classGraphicsStateGuardian_ae76699ce050f1a2ffbda6ee0ec2bdcfd}{GraphicsStateGuardian::begin\_frame}}(current\_thread))\ \{}
\DoxyCodeLine{04524\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04525\ \ \ \}}
\DoxyCodeLine{04526\ \ \ \_renderbuffer\_residency.begin\_frame(current\_thread);}
\DoxyCodeLine{04527\ }
\DoxyCodeLine{04528\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04529\ }
\DoxyCodeLine{04530\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{04531\ \ \ \_vertices\_display\_list\_pcollector.clear\_level();}
\DoxyCodeLine{04532\ \ \ \_vertices\_immediate\_pcollector.clear\_level();}
\DoxyCodeLine{04533\ \ \ \_primitive\_batches\_display\_list\_pcollector.clear\_level();}
\DoxyCodeLine{04534\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04535\ }
\DoxyCodeLine{04536\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04537\ \ \ \textcolor{keywordflow}{if}\ (!\_fences.empty())\ \{}
\DoxyCodeLine{04538\ \ \ \ \ process\_fences(\textcolor{keyword}{false});}
\DoxyCodeLine{04539\ \ \ \}}
\DoxyCodeLine{04540\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04541\ }
\DoxyCodeLine{04542\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{04543\ \ \ \textcolor{keywordtype}{int}\ frame\_number\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_count(current\_thread);}
\DoxyCodeLine{04544\ \ \ \textcolor{keywordflow}{if}\ (\_current\_frame\_timing\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{04545\ \ \ \ \ \ \ frame\_number\ !=\ \_current\_frame\_timing-\/>\_frame\_number)\ \{}
\DoxyCodeLine{04546\ }
\DoxyCodeLine{04547\ \ \ \ \ \_current\_frame\_timing\ =\ begin\_frame\_timing(frame\_number);}
\DoxyCodeLine{04548\ \ \ \}}
\DoxyCodeLine{04549\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04550\ }
\DoxyCodeLine{04551\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{04552\ \ \ \_show\_texture\_usage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04553\ \ \ \textcolor{keywordflow}{if}\ (gl\_show\_texture\_usage)\ \{}
\DoxyCodeLine{04554\ \ \ \ \ \textcolor{comment}{//\ When\ this\ is\ true,\ then\ every\ other\ second,\ we\ show\ the\ usage\ textures}}
\DoxyCodeLine{04555\ \ \ \ \ \textcolor{comment}{//\ instead\ of\ the\ real\ textures.}}
\DoxyCodeLine{04556\ \ \ \ \ \textcolor{keywordtype}{double}\ now\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_time(current\_thread);}
\DoxyCodeLine{04557\ \ \ \ \ \textcolor{keywordtype}{int}\ this\_second\ =\ (int)floor(now);}
\DoxyCodeLine{04558\ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_second\ \&\ 1)\ \{}
\DoxyCodeLine{04559\ \ \ \ \ \ \ \_show\_texture\_usage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04560\ \ \ \ \ \ \ \_show\_texture\_usage\_index\ =\ this\_second\ >>\ 1;}
\DoxyCodeLine{04561\ }
\DoxyCodeLine{04562\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ max\_size\ =\ gl\_show\_texture\_usage\_max\_size;}
\DoxyCodeLine{04563\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_size\ !=\ \_show\_texture\_usage\_max\_size)\ \{}
\DoxyCodeLine{04564\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ the\ cache\ of\ usage\ textures;\ we've\ changed\ the\ max\ size.}}
\DoxyCodeLine{04565\ \ \ \ \ \ \ \ \ UsageTextures::iterator\ ui;}
\DoxyCodeLine{04566\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ui\ =\ \_usage\_textures.begin();}
\DoxyCodeLine{04567\ \ \ \ \ \ \ \ \ \ \ \ \ \ ui\ !=\ \_usage\_textures.end();}
\DoxyCodeLine{04568\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++ui)\ \{}
\DoxyCodeLine{04569\ \ \ \ \ \ \ \ \ \ \ GLuint\ index\ =\ (*ui).second;}
\DoxyCodeLine{04570\ \ \ \ \ \ \ \ \ \ \ glDeleteTextures(1,\ \&index);}
\DoxyCodeLine{04571\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04572\ \ \ \ \ \ \ \ \ \_usage\_textures.clear();}
\DoxyCodeLine{04573\ \ \ \ \ \ \ \ \ \_show\_texture\_usage\_max\_size\ =\ max\_size;}
\DoxyCodeLine{04574\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04575\ \ \ \ \ \}}
\DoxyCodeLine{04576\ \ \ \}}
\DoxyCodeLine{04577\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{04578\ }
\DoxyCodeLine{04579\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{04580\ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_srgb\_color())\ \{}
\DoxyCodeLine{04581\ \ \ \ \ glEnable(GL\_FRAMEBUFFER\_SRGB);}
\DoxyCodeLine{04582\ \ \ \}}
\DoxyCodeLine{04583\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04584\ }
\DoxyCodeLine{04585\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04586\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{04587\ \}}
\DoxyCodeLine{04588\ }
\DoxyCodeLine{04599\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04600\ begin\_scene()\ \{}
\DoxyCodeLine{04601\ \ \ \textcolor{keywordflow}{return}\ GraphicsStateGuardian::begin\_scene();}
\DoxyCodeLine{04602\ \}}
\DoxyCodeLine{04603\ }
\DoxyCodeLine{04610\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04611\ end\_scene()\ \{}
\DoxyCodeLine{04612\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian_ab8d7bc997a78e7a442fcdb920cce0af4}{GraphicsStateGuardian::end\_scene}}();}
\DoxyCodeLine{04613\ }
\DoxyCodeLine{04614\ \ \ \_dlights.clear();}
\DoxyCodeLine{04615\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04616\ \}}
\DoxyCodeLine{04617\ }
\DoxyCodeLine{04622\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04623\ end\_frame(\mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{04624\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04625\ }
\DoxyCodeLine{04626\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{04627\ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_srgb\_color())\ \{}
\DoxyCodeLine{04628\ \ \ \ \ glDisable(GL\_FRAMEBUFFER\_SRGB);}
\DoxyCodeLine{04629\ \ \ \}}
\DoxyCodeLine{04630\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04631\ }
\DoxyCodeLine{04632\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{04633\ \ \ \textcolor{comment}{//\ Check\ for\ textures,\ etc.,\ that\ are\ no\ longer\ resident.\ \ These\ calls\ might}}
\DoxyCodeLine{04634\ \ \ \textcolor{comment}{//\ be\ measurably\ expensive,\ and\ they\ don't\ have\ any\ benefit\ unless\ we\ are}}
\DoxyCodeLine{04635\ \ \ \textcolor{comment}{//\ actually\ viewing\ PStats,\ so\ don't\ do\ them\ unless\ we're\ connected.\ \ That}}
\DoxyCodeLine{04636\ \ \ \textcolor{comment}{//\ will\ just\ mean\ that\ we'll\ count\ everything\ as\ resident\ until\ the\ user}}
\DoxyCodeLine{04637\ \ \ \textcolor{comment}{//\ connects\ PStats,\ at\ which\ point\ it\ will\ then\ correct\ the\ assessment.\ \ No}}
\DoxyCodeLine{04638\ \ \ \textcolor{comment}{//\ harm\ done.}}
\DoxyCodeLine{04639\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ PStatClient::is\_connected())\ \{}
\DoxyCodeLine{04640\ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_check\_residency\_pcollector);}
\DoxyCodeLine{04641\ \ \ \ \ check\_nonresident\_texture(\_prepared\_objects-\/>\_texture\_residency.get\_inactive\_resident());}
\DoxyCodeLine{04642\ \ \ \ \ check\_nonresident\_texture(\_prepared\_objects-\/>\_texture\_residency.get\_active\_resident());}
\DoxyCodeLine{04643\ }
\DoxyCodeLine{04644\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ provides\ no\ methods\ for\ querying\ whether\ a\ buffer\ object\ (vertex}}
\DoxyCodeLine{04645\ \ \ \ \ \textcolor{comment}{//\ buffer)\ is\ resident.\ \ In\ fact,\ the\ API\ appears\ geared\ towards\ the}}
\DoxyCodeLine{04646\ \ \ \ \ \textcolor{comment}{//\ assumption\ that\ such\ buffers\ are\ always\ resident.\ \ OK.}}
\DoxyCodeLine{04647\ \ \ \}}
\DoxyCodeLine{04648\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04649\ }
\DoxyCodeLine{04650\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04651\ \ \ \textcolor{comment}{//\ This\ breaks\ shaders\ across\ multiple\ regions.}}
\DoxyCodeLine{04652\ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_array\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{04653\ \ \ \ \ \_vertex\_array\_shader\_context-\/>disable\_shader\_vertex\_arrays();}
\DoxyCodeLine{04654\ \ \ \ \ \_vertex\_array\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04655\ \ \ \ \ \_vertex\_array\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04656\ \ \ \}}
\DoxyCodeLine{04657\ \ \ \textcolor{keywordflow}{if}\ (\_texture\_binding\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{04658\ \ \ \ \ \_texture\_binding\_shader\_context-\/>disable\_shader\_texture\_bindings();}
\DoxyCodeLine{04659\ \ \ \ \ \_texture\_binding\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04660\ \ \ \ \ \_texture\_binding\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04661\ \ \ \}}
\DoxyCodeLine{04662\ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{04663\ \ \ \ \ \_current\_shader\_context-\/>unbind();}
\DoxyCodeLine{04664\ \ \ \ \ \_current\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04665\ \ \ \ \ \_current\_shader\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04666\ \ \ \}}
\DoxyCodeLine{04667\ \ \ \_state\_shader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04668\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04669\ }
\DoxyCodeLine{04670\ \ \ \textcolor{comment}{//\ Respecify\ the\ active\ texture\ next\ frame,\ for\ good\ measure.}}
\DoxyCodeLine{04671\ \ \ \_active\_texture\_stage\ =\ -\/1;}
\DoxyCodeLine{04672\ }
\DoxyCodeLine{04673\ \ \ \textcolor{comment}{//\ Calling\ glFlush()\ at\ the\ end\ of\ the\ frame\ is\ particularly\ necessary\ if}}
\DoxyCodeLine{04674\ \ \ \textcolor{comment}{//\ this\ is\ a\ single-\/buffered\ visual,\ so\ that\ the\ frame\ will\ be\ finished}}
\DoxyCodeLine{04675\ \ \ \textcolor{comment}{//\ drawing\ before\ we\ return\ to\ the\ application.\ \ It's\ not\ clear\ what\ effect}}
\DoxyCodeLine{04676\ \ \ \textcolor{comment}{//\ this\ has\ on\ our\ total\ frame\ time.\ \ if\ (\_force\_flush\ ||}}
\DoxyCodeLine{04677\ \ \ \textcolor{comment}{//\ \_current\_properties-\/>is\_single\_buffered())\ \{\ gl\_flush();\ \}}}
\DoxyCodeLine{04678\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{04679\ }
\DoxyCodeLine{04680\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian_aabb3c4bf7c00f08f1b1a4c1d570c0370}{GraphicsStateGuardian::end\_frame}}(current\_thread);}
\DoxyCodeLine{04681\ }
\DoxyCodeLine{04682\ \ \ \_renderbuffer\_residency.end\_frame(current\_thread);}
\DoxyCodeLine{04683\ }
\DoxyCodeLine{04684\ \ \ \textcolor{comment}{//\ Flush\ any\ PCollectors\ specific\ to\ this\ kind\ of\ GSG.}}
\DoxyCodeLine{04685\ \ \ \_primitive\_batches\_display\_list\_pcollector.flush\_level();}
\DoxyCodeLine{04686\ \ \ \_vertices\_display\_list\_pcollector.flush\_level();}
\DoxyCodeLine{04687\ \ \ \_vertices\_immediate\_pcollector.flush\_level();}
\DoxyCodeLine{04688\ }
\DoxyCodeLine{04689\ \ \ \textcolor{comment}{//\ Now\ is\ a\ good\ time\ to\ delete\ any\ pending\ display\ lists.}}
\DoxyCodeLine{04690\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{04691\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{04692\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ display\_lists)\ \{}
\DoxyCodeLine{04693\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{04694\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_deleted\_display\_lists.empty())\ \{}
\DoxyCodeLine{04695\ \ \ \ \ \ \ DeletedNames::iterator\ ddli;}
\DoxyCodeLine{04696\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ddli\ =\ \_deleted\_display\_lists.begin();}
\DoxyCodeLine{04697\ \ \ \ \ \ \ \ \ \ \ \ ddli\ !=\ \_deleted\_display\_lists.end();}
\DoxyCodeLine{04698\ \ \ \ \ \ \ \ \ \ \ \ ++ddli)\ \{}
\DoxyCodeLine{04699\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{04700\ \ \ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{04701\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}releasing\ display\ list\ index\ "{}}\ <<\ (int)(*ddli)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04702\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04703\ \ \ \ \ \ \ \ \ glDeleteLists((*ddli),\ 1);}
\DoxyCodeLine{04704\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04705\ \ \ \ \ \ \ \_deleted\_display\_lists.clear();}
\DoxyCodeLine{04706\ \ \ \ \ \}}
\DoxyCodeLine{04707\ \ \ \}}
\DoxyCodeLine{04708\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04709\ }
\DoxyCodeLine{04710\ \ \ \textcolor{comment}{//\ And\ deleted\ queries,\ too,\ unless\ we're\ using\ query\ timers\ in\ which\ case}}
\DoxyCodeLine{04711\ \ \ \textcolor{comment}{//\ we'll\ need\ to\ reuse\ lots\ of\ them.}}
\DoxyCodeLine{04712\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_occlusion\_query\ \&\&\ !get\_timer\_queries\_active())\ \{}
\DoxyCodeLine{04713\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{04714\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_deleted\_queries.empty())\ \{}
\DoxyCodeLine{04715\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04716\ \ \ \ \ \ \ \ \ DeletedNames::iterator\ dqi;}
\DoxyCodeLine{04717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (dqi\ =\ \_deleted\_queries.begin();}
\DoxyCodeLine{04718\ \ \ \ \ \ \ \ \ \ \ \ \ \ dqi\ !=\ \_deleted\_queries.end();}
\DoxyCodeLine{04719\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++dqi)\ \{}
\DoxyCodeLine{04720\ \ \ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{04721\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}releasing\ query\ index\ "{}}\ <<\ (int)(*dqi)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04722\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04723\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04724\ \ \ \ \ \ \ \_glDeleteQueries(\_deleted\_queries.size(),\ \&\_deleted\_queries[0]);}
\DoxyCodeLine{04725\ \ \ \ \ \ \ \_deleted\_queries.clear();}
\DoxyCodeLine{04726\ \ \ \ \ \}}
\DoxyCodeLine{04727\ \ \ \}}
\DoxyCodeLine{04728\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{04729\ }
\DoxyCodeLine{04730\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04731\ \ \ \textcolor{keywordflow}{if}\ (!\_deleted\_buffers.empty())\ \{}
\DoxyCodeLine{04732\ \ \ \ \ GLuint\ *indices\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint\ *)\ *\ \_deleted\_buffers.size());}
\DoxyCodeLine{04733\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_indices\ =\ 0;}
\DoxyCodeLine{04734\ \ \ \ \ DeletedBuffers::iterator\ it\ =\ \_deleted\_buffers.begin();}
\DoxyCodeLine{04735\ \ \ \ \ \textcolor{keywordflow}{while}\ (it\ !=\ \_deleted\_buffers.end())\ \{}
\DoxyCodeLine{04736\ \ \ \ \ \ \ DeletedBuffer\ \&buffer\ =\ *it;}
\DoxyCodeLine{04737\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffer\_storage\ \&\&\ buffer.\_mapped\_pointer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04738\ \ \ \ \ \ \ \ \ \_glBindBuffer(GL\_PIXEL\_PACK\_BUFFER,\ buffer.\_index);}
\DoxyCodeLine{04739\ \ \ \ \ \ \ \ \ \_glUnmapBuffer(GL\_PIXEL\_PACK\_BUFFER);}
\DoxyCodeLine{04740\ \ \ \ \ \ \ \ \ buffer.\_mapped\_pointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04741\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04742\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++buffer.\_age\ >\ 2)\ \{}
\DoxyCodeLine{04743\ \ \ \ \ \ \ \ \ indices[num\_indices++]\ =\ buffer.\_index;}
\DoxyCodeLine{04744\ \ \ \ \ \ \ \ \ it\ =\ \_deleted\_buffers.erase(it);}
\DoxyCodeLine{04745\ \ \ \ \ \ \ \ \ \_inactive\_ppbuffer\_memory\_pcollector.sub\_level(buffer.\_size);}
\DoxyCodeLine{04746\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04747\ \ \ \ \ \ \ \ \ ++it;}
\DoxyCodeLine{04748\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04749\ \ \ \ \ \}}
\DoxyCodeLine{04750\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{04751\ \ \ \ \ \ \ \_glBindBuffer(GL\_PIXEL\_PACK\_BUFFER,\ 0);}
\DoxyCodeLine{04752\ \ \ \ \ \}}
\DoxyCodeLine{04753\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_indices\ >\ 0)\ \{}
\DoxyCodeLine{04754\ \ \ \ \ \ \ \_glDeleteBuffers(num\_indices,\ indices);}
\DoxyCodeLine{04755\ \ \ \ \ \}}
\DoxyCodeLine{04756\ \ \ \}}
\DoxyCodeLine{04757\ }
\DoxyCodeLine{04758\ \ \ \_active\_ppbuffer\_memory\_pcollector.flush\_level();}
\DoxyCodeLine{04759\ \ \ \_inactive\_ppbuffer\_memory\_pcollector.flush\_level();}
\DoxyCodeLine{04760\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04761\ }
\DoxyCodeLine{04762\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{04763\ \ \ \textcolor{keywordflow}{if}\ (\_check\_errors\ ||\ (\_supports\_debug\ \&\&\ gl\_debug))\ \{}
\DoxyCodeLine{04764\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{04765\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04766\ \ \ \ \ \textcolor{comment}{//\ If\ \_check\_errors\ is\ false,\ we\ still\ want\ to\ check\ for\ errors\ once\ every}}
\DoxyCodeLine{04767\ \ \ \ \ \textcolor{comment}{//\ second,\ so\ that\ we\ know\ if\ anything\ went\ wrong\ at\ all.}}
\DoxyCodeLine{04768\ \ \ \ \ \textcolor{keywordtype}{double}\ current\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_time();}
\DoxyCodeLine{04769\ }
\DoxyCodeLine{04770\ \ \ \ \ \textcolor{keywordflow}{if}\ (current\ -\/\ \_last\_error\_check\ >=\ 1.0)\ \{}
\DoxyCodeLine{04771\ \ \ \ \ \ \ \_last\_error\_check\ =\ current;}
\DoxyCodeLine{04772\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_check\_error\_pcollector);}
\DoxyCodeLine{04773\ }
\DoxyCodeLine{04774\ \ \ \ \ \ \ GLenum\ error\_code\ =\ glGetError();}
\DoxyCodeLine{04775\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{04776\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ error\_count\ =\ 0;}
\DoxyCodeLine{04777\ }
\DoxyCodeLine{04778\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{04779\ \ \ \ \ \ \ \ \ \ \ ++error\_count;}
\DoxyCodeLine{04780\ \ \ \ \ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{04781\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\ error\ 0x"{}}\ <<\ hex\ <<\ error\_code\ <<\ dec\ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}}
\DoxyCodeLine{04782\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04783\ \ \ \ \ \ \ \ \ \ \ error\_code\ =\ glGetError();}
\DoxyCodeLine{04784\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (error\_code\ !=\ GL\_NO\_ERROR);}
\DoxyCodeLine{04785\ }
\DoxyCodeLine{04786\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_count\ ==\ 1)\ \{}
\DoxyCodeLine{04787\ \ \ \ \ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{04788\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}An\ OpenGL\ error\ has\ occurred."{}};}
\DoxyCodeLine{04789\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04790\ \ \ \ \ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{04791\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ error\_count\ <<\ \textcolor{stringliteral}{"{}\ OpenGL\ errors\ have\ occurred."{}};}
\DoxyCodeLine{04792\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04793\ }
\DoxyCodeLine{04794\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_debug)\ \{}
\DoxyCodeLine{04795\ \ \ \ \ \ \ \ \ \ \ GLCAT.error(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ \ Set\ gl-\/debug\ \#t\ "{}}}
\DoxyCodeLine{04796\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}in\ your\ PRC\ file\ to\ display\ more\ information.\(\backslash\)n"{}};}
\DoxyCodeLine{04797\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04798\ \ \ \ \ \ \ \ \ \ \ GLCAT.error(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ \ Set\ gl-\/check-\/errors\ \#t\ "{}}}
\DoxyCodeLine{04799\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}in\ your\ PRC\ file\ to\ display\ more\ information.\(\backslash\)n"{}};}
\DoxyCodeLine{04800\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04801\ }
\DoxyCodeLine{04802\ \ \ \ \ \ \ \ \ \_error\_count\ +=\ error\_count;}
\DoxyCodeLine{04803\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_error\_count\ >=\ gl\_max\_errors)\ \{}
\DoxyCodeLine{04804\ \ \ \ \ \ \ \ \ \ \ panic\_deactivate();}
\DoxyCodeLine{04805\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{04806\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04807\ \ \ \ \ \}}
\DoxyCodeLine{04808\ \ \ \}}
\DoxyCodeLine{04809\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04810\ }
\DoxyCodeLine{04811\ \ \ \textcolor{comment}{//\ Add\ in\ a\ newline\ to\ the\ spam\ output\ for\ improved\ legibility.}}
\DoxyCodeLine{04812\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04813\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ endl;}
\DoxyCodeLine{04814\ \ \ \}}
\DoxyCodeLine{04815\ \}}
\DoxyCodeLine{04816\ }
\DoxyCodeLine{04820\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::FrameTiming\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04821\ begin\_frame\_timing(int\ frame\_number)\ \{}
\DoxyCodeLine{04822\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{04823\ \ \ \textcolor{keywordflow}{if}\ (!\_timer\_queries\_active)\ \{}
\DoxyCodeLine{04824\ \ \ \ \ \textcolor{keywordflow}{if}\ (pstats\_gpu\_timing\ \&\&\ \_supports\_timer\_query\ \&\&\ PStatClient::is\_connected())\ \{}
\DoxyCodeLine{04825\ \ \ \ \ \ \ \_timer\_queries\_active\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{04826\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04827\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04828\ \ \ \ \ \}}
\DoxyCodeLine{04829\ \ \ \}}
\DoxyCodeLine{04830\ }
\DoxyCodeLine{04831\ \ \ \mbox{\hyperlink{classPStatClient}{PStatClient}}\ *client\ =\ PStatClient::get\_global\_pstats();}
\DoxyCodeLine{04832\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_wait\_timer\_pcollector);}
\DoxyCodeLine{04833\ }
\DoxyCodeLine{04834\ \ \ \_timer\_queries\_pcollector.clear\_level();}
\DoxyCodeLine{04835\ }
\DoxyCodeLine{04836\ \ \ \textcolor{keywordflow}{if}\ (\_deleted\_queries.size()\ <\ 128)\ \{}
\DoxyCodeLine{04837\ \ \ \ \ \textcolor{comment}{//\ We'll\ need\ a\ lot\ of\ timer\ queries,\ so\ allocate\ a\ whole\ bunch\ up\ front.}}
\DoxyCodeLine{04838\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ alloc\_count\ =\ 128\ -\/\ \_deleted\_queries.size();}
\DoxyCodeLine{04839\ \ \ \ \ \_deleted\_queries.resize(\_deleted\_queries.size()\ +\ alloc\_count);}
\DoxyCodeLine{04840\ \ \ \ \ \_glGenQueries(alloc\_count,\ \_deleted\_queries.data()\ +\ \_deleted\_queries.size()\ -\/\ alloc\_count);}
\DoxyCodeLine{04841\ \ \ \}}
\DoxyCodeLine{04842\ }
\DoxyCodeLine{04843\ \ \ \textcolor{comment}{//\ Issue\ a\ start\ query\ for\ collector\ 0,\ marking\ the\ start\ of\ this\ frame.}}
\DoxyCodeLine{04844\ \ \ GLuint\ frame\_query\ =\ \_deleted\_queries.back();}
\DoxyCodeLine{04845\ \ \ \_deleted\_queries.pop\_back();}
\DoxyCodeLine{04846\ \ \ \_glQueryCounter(frame\_query,\ GL\_TIMESTAMP);}
\DoxyCodeLine{04847\ }
\DoxyCodeLine{04848\ \ \ \textcolor{comment}{//\ Synchronize\ the\ GL\ time\ with\ the\ PStats\ clock.\ \ Note\ that\ the\ driver\ may}}
\DoxyCodeLine{04849\ \ \ \textcolor{comment}{//\ arbitrarily\ decide\ to\ wait\ a\ long\ time\ on\ this\ call\ if\ the\ queue\ is}}
\DoxyCodeLine{04850\ \ \ \textcolor{comment}{//\ saturated\ with\ work.\ \ Experimentally,\ it\ seems\ that\ it\ queries\ the\ time}}
\DoxyCodeLine{04851\ \ \ \textcolor{comment}{//\ *after*\ the\ wait,\ so\ we\ take\ the\ CPU\ time\ after\ it\ returns.\ \ If\ we\ find}}
\DoxyCodeLine{04852\ \ \ \textcolor{comment}{//\ that\ some\ drivers\ do\ it\ differently,\ we\ may\ have\ to\ do\ multiple\ calls.}}
\DoxyCodeLine{04853\ \ \ GLint64\ gl\_time;}
\DoxyCodeLine{04854\ \ \ \_glGetInteger64v(GL\_TIMESTAMP,\ \&gl\_time);}
\DoxyCodeLine{04855\ \ \ \textcolor{keywordtype}{double}\ cpu\_time\ =\ client-\/>get\_real\_time();}
\DoxyCodeLine{04856\ }
\DoxyCodeLine{04857\ \ \ \textcolor{comment}{//\ Check\ if\ the\ results\ from\ the\ previous\ frame\ are\ available.\ \ We\ just\ need}}
\DoxyCodeLine{04858\ \ \ \textcolor{comment}{//\ to\ check\ whether\ the\ last\ query\ for\ each\ frame\ is\ available.}}
\DoxyCodeLine{04859\ \ \ \textcolor{keywordflow}{while}\ (!\_frame\_timings.empty())\ \{}
\DoxyCodeLine{04860\ \ \ \ \ \textcolor{keyword}{const}\ FrameTiming\ \&frame\ =\ \_frame\_timings.front();}
\DoxyCodeLine{04861\ \ \ \ \ GLuint\ last\_query\ =\ frame.\_queries.back().first;}
\DoxyCodeLine{04862\ \ \ \ \ GLuint\ result;}
\DoxyCodeLine{04863\ \ \ \ \ \_glGetQueryObjectuiv(last\_query,\ GL\_QUERY\_RESULT\_AVAILABLE,\ \&result);}
\DoxyCodeLine{04864\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ 0)\ \{}
\DoxyCodeLine{04865\ \ \ \ \ \ \ \textcolor{comment}{//\ Not\ ready,\ so\ subsequent\ frames\ won't\ be,\ either.}}
\DoxyCodeLine{04866\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04867\ \ \ \ \ \}}
\DoxyCodeLine{04868\ \ \ \ \ \textcolor{comment}{//\ We've\ got\ a\ frame\ whose\ timer\ queries\ are\ ready.}}
\DoxyCodeLine{04869\ \ \ \ \ end\_frame\_timing(frame);}
\DoxyCodeLine{04870\ \ \ \ \ \_frame\_timings.pop\_front();}
\DoxyCodeLine{04871\ \ \ \}}
\DoxyCodeLine{04872\ }
\DoxyCodeLine{04873\ \ \ FrameTiming\ frame;}
\DoxyCodeLine{04874\ \ \ frame.\_frame\_number\ =\ frame\_number;}
\DoxyCodeLine{04875\ \ \ frame.\_gpu\_sync\_time\ =\ gl\_time;}
\DoxyCodeLine{04876\ \ \ frame.\_cpu\_sync\_time\ =\ cpu\_time;}
\DoxyCodeLine{04877\ \ \ frame.\_queries.push\_back(std::make\_pair(frame\_query,\ 0));}
\DoxyCodeLine{04878\ \ \ \_frame\_timings.push\_back(std::move(frame));}
\DoxyCodeLine{04879\ }
\DoxyCodeLine{04880\ \ \ \textcolor{keywordflow}{return}\ \&\_frame\_timings.back();}
\DoxyCodeLine{04881\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{04882\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{04883\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04884\ \}}
\DoxyCodeLine{04885\ }
\DoxyCodeLine{04890\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04891\ end\_frame\_timing(const\ FrameTiming\ \&frame)\ \{}
\DoxyCodeLine{04892\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{04893\ \ \ \textcolor{comment}{//\ This\ uses\ the\ lower-\/level\ PStats\ interfaces\ for\ now\ because\ of\ all\ the}}
\DoxyCodeLine{04894\ \ \ \textcolor{comment}{//\ unnecessary\ overhead\ that\ would\ otherwise\ be\ incurred\ when\ adding\ such\ a}}
\DoxyCodeLine{04895\ \ \ \textcolor{comment}{//\ large\ amount\ of\ data\ at\ once.}}
\DoxyCodeLine{04896\ \ \ \textcolor{keywordflow}{if}\ (!PStatClient::is\_connected())\ \{}
\DoxyCodeLine{04897\ \ \ \ \ \_timer\_queries\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{04898\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{04899\ \ \ \}}
\DoxyCodeLine{04900\ }
\DoxyCodeLine{04901\ \ \ \textcolor{comment}{//\ We\ represent\ each\ GSG\ as\ one\ thread.\ \ In\ the\ future\ we\ may\ change\ this\ to}}
\DoxyCodeLine{04902\ \ \ \textcolor{comment}{//\ representing\ each\ graphics\ device\ as\ one\ thread,\ but\ OpenGL\ doesn't\ really}}
\DoxyCodeLine{04903\ \ \ \textcolor{comment}{//\ expose\ this\ information\ to\ us.}}
\DoxyCodeLine{04904\ \ \ \mbox{\hyperlink{classPStatThread}{PStatThread}}\ gpu\_thread\ =\ get\_pstats\_thread();}
\DoxyCodeLine{04905\ }
\DoxyCodeLine{04906\ \ \ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ frame\_data;}
\DoxyCodeLine{04907\ \ \ \textcolor{keywordtype}{size\_t}\ latency\_ref\_i\ =\ 0;}
\DoxyCodeLine{04908\ }
\DoxyCodeLine{04909\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&query\ :\ frame.\_queries)\ \{}
\DoxyCodeLine{04910\ \ \ \ \ GLuint64\ time\_ns;}
\DoxyCodeLine{04911\ \ \ \ \ \_glGetQueryObjectui64v(query.first,\ GL\_QUERY\_RESULT,\ \&time\_ns);}
\DoxyCodeLine{04912\ }
\DoxyCodeLine{04913\ \ \ \ \ \textcolor{keywordflow}{if}\ (query.second\ \&\ 0x10000)\ \{}
\DoxyCodeLine{04914\ \ \ \ \ \ \ \textcolor{comment}{//\ Latency\ query.}}
\DoxyCodeLine{04915\ \ \ \ \ \ \ GLint64\ ref\ =\ frame.\_latency\_refs[latency\_ref\_i++];}
\DoxyCodeLine{04916\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ time\ =\ ((GLint64)time\_ns\ -\/\ ref)\ *\ 0.000001;}
\DoxyCodeLine{04917\ \ \ \ \ \ \ frame\_data.add\_level(query.second\ \&\ 0x7fff,\ time);}
\DoxyCodeLine{04918\ \ \ \ \ \}}
\DoxyCodeLine{04919\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04920\ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ GL\ time\ to\ Panda\ time.}}
\DoxyCodeLine{04921\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ time\ =\ ((GLint64)time\_ns\ -\/\ frame.\_gpu\_sync\_time)\ *\ 0.000000001\ +\ frame.\_cpu\_sync\_time;}
\DoxyCodeLine{04922\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (query.second\ \&\ 0x8000)\ \{}
\DoxyCodeLine{04923\ \ \ \ \ \ \ \ \ frame\_data.add\_stop(query.second\ \&\ 0x7fff,\ time);}
\DoxyCodeLine{04924\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04925\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{04926\ \ \ \ \ \ \ \ \ frame\_data.add\_start(query.second\ \&\ 0x7fff,\ time);}
\DoxyCodeLine{04927\ \ \ \ \ \ \ \}}
\DoxyCodeLine{04928\ \ \ \ \ \}}
\DoxyCodeLine{04929\ \ \ \ \ \_deleted\_queries.push\_back(query.first);}
\DoxyCodeLine{04930\ \ \ \}}
\DoxyCodeLine{04931\ }
\DoxyCodeLine{04932\ \ \ \textcolor{comment}{//\ The\ end\ time\ of\ the\ last\ collector\ is\ implicitly\ the\ frame's\ end\ time.}}
\DoxyCodeLine{04933\ \ \ frame\_data.add\_stop(0,\ frame\_data.get\_end());}
\DoxyCodeLine{04934\ \ \ gpu\_thread.\mbox{\hyperlink{classPStatThread_a3890cfb67e06cb3645519b90d9f5afb3}{add\_frame}}(frame.\_frame\_number,\ std::move(frame\_data));}
\DoxyCodeLine{04935\ }
\DoxyCodeLine{04936\ \ \ \_timer\_queries\_pcollector.add\_level\_now(frame.\_queries.size());}
\DoxyCodeLine{04937\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04938\ \}}
\DoxyCodeLine{04939\ }
\DoxyCodeLine{04945\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{04946\ begin\_draw\_primitives(const\ \mbox{\hyperlink{classGeomPipelineReader}{GeomPipelineReader}}\ *geom\_reader,}
\DoxyCodeLine{04947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classGeomVertexDataPipelineReader}{GeomVertexDataPipelineReader}}\ *data\_reader,}
\DoxyCodeLine{04948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\_t\ num\_instances,\ bool\ force)\ \{}
\DoxyCodeLine{04949\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{04950\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{04951\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}begin\_draw\_primitives:\ "{}}\ <<\ *(data\_reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{04952\ \ \ \}}
\DoxyCodeLine{04953\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{04954\ }
\DoxyCodeLine{04955\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04956\ \ \ \textcolor{keywordflow}{if}\ (!has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{04957\ \ \ \ \ \textcolor{comment}{//\ We\ can't\ draw\ without\ a\ shader\ bound\ in\ OpenGL\ ES\ 2.\ \ This\ shouldn't}}
\DoxyCodeLine{04958\ \ \ \ \ \textcolor{comment}{//\ happen\ anyway\ unless\ the\ default\ shader\ failed\ to\ compile\ somehow.}}
\DoxyCodeLine{04959\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{04960\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04961\ \ \ \ \ \}}
\DoxyCodeLine{04962\ \ \ \}}
\DoxyCodeLine{04963\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04964\ }
\DoxyCodeLine{04965\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classGraphicsStateGuardian_ad878adb93c40352f545d8d95dac0095b}{GraphicsStateGuardian::begin\_draw\_primitives}}(geom\_reader,\ data\_reader,\ num\_instances,\ force))\ \{}
\DoxyCodeLine{04966\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{04967\ \ \ \}}
\DoxyCodeLine{04968\ \ \ nassertr(\_data\_reader\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{04969\ }
\DoxyCodeLine{04970\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{04971\ \ \ \_instance\_count\ =\ \_supports\_geometry\_instancing\ ?\ num\_instances\ :\ 1;}
\DoxyCodeLine{04972\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{04973\ }
\DoxyCodeLine{04974\ \ \ \_geom\_display\_list\ =\ 0;}
\DoxyCodeLine{04975\ }
\DoxyCodeLine{04976\ \ \ \textcolor{keywordflow}{if}\ (\_auto\_antialias\_mode)\ \{}
\DoxyCodeLine{04977\ \ \ \ \ \textcolor{keywordflow}{switch}\ (geom\_reader-\/>get\_primitive\_type())\ \{}
\DoxyCodeLine{04978\ \ \ \ \ \textcolor{keywordflow}{case}\ GeomPrimitive::PT\_polygons:}
\DoxyCodeLine{04979\ \ \ \ \ \textcolor{keywordflow}{case}\ GeomPrimitive::PT\_patches:}
\DoxyCodeLine{04980\ \ \ \ \ \ \ setup\_antialias\_polygon();}
\DoxyCodeLine{04981\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04982\ \ \ \ \ \textcolor{keywordflow}{case}\ GeomPrimitive::PT\_points:}
\DoxyCodeLine{04983\ \ \ \ \ \ \ setup\_antialias\_point();}
\DoxyCodeLine{04984\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04985\ \ \ \ \ \textcolor{keywordflow}{case}\ GeomPrimitive::PT\_lines:}
\DoxyCodeLine{04986\ \ \ \ \ \ \ setup\_antialias\_line();}
\DoxyCodeLine{04987\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04988\ \ \ \ \ \textcolor{keywordflow}{case}\ GeomPrimitive::PT\_none:}
\DoxyCodeLine{04989\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{04990\ \ \ \ \ \}}
\DoxyCodeLine{04991\ }
\DoxyCodeLine{04992\ \ \ \ \ \textcolor{keywordtype}{int}\ transparency\_slot\ =\ TransparencyAttrib::get\_class\_slot();}
\DoxyCodeLine{04993\ \ \ \ \ \textcolor{keywordtype}{int}\ color\_write\_slot\ =\ ColorWriteAttrib::get\_class\_slot();}
\DoxyCodeLine{04994\ \ \ \ \ \textcolor{keywordtype}{int}\ color\_blend\_slot\ =\ ColorBlendAttrib::get\_class\_slot();}
\DoxyCodeLine{04995\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_state\_mask.get\_bit(transparency\_slot)\ ||}
\DoxyCodeLine{04996\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_write\_slot)\ ||}
\DoxyCodeLine{04997\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_blend\_slot))\ \{}
\DoxyCodeLine{04998\ \ \ \ \ \ \ do\_issue\_blending();}
\DoxyCodeLine{04999\ \ \ \ \ \ \ \_state\_mask.set\_bit(transparency\_slot);}
\DoxyCodeLine{05000\ \ \ \ \ \ \ \_state\_mask.set\_bit(color\_write\_slot);}
\DoxyCodeLine{05001\ \ \ \ \ \ \ \_state\_mask.set\_bit(color\_blend\_slot);}
\DoxyCodeLine{05002\ \ \ \ \ \}}
\DoxyCodeLine{05003\ \ \ \}}
\DoxyCodeLine{05004\ }
\DoxyCodeLine{05005\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05006\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ \_data\_reader-\/>is\_vertex\_transformed())\ \{}
\DoxyCodeLine{05007\ \ \ \ \ \textcolor{comment}{//\ If\ the\ vertex\ data\ claims\ to\ be\ already\ transformed\ into\ clip}}
\DoxyCodeLine{05008\ \ \ \ \ \textcolor{comment}{//\ coordinates,\ wipe\ out\ the\ current\ projection\ and\ modelview\ matrix\ (so}}
\DoxyCodeLine{05009\ \ \ \ \ \textcolor{comment}{//\ we\ don't\ attempt\ to\ transform\ it\ again).}}
\DoxyCodeLine{05010\ \ \ \ \ glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{05011\ \ \ \ \ glPushMatrix();}
\DoxyCodeLine{05012\ \ \ \ \ glLoadIdentity();}
\DoxyCodeLine{05013\ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{05014\ \ \ \ \ glPushMatrix();}
\DoxyCodeLine{05015\ \ \ \ \ glLoadIdentity();}
\DoxyCodeLine{05016\ \ \ \}}
\DoxyCodeLine{05017\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05018\ }
\DoxyCodeLine{05019\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ \&\&\ defined(SUPPORT\_FIXED\_FUNCTION)\ \ }\textcolor{comment}{//\ Display\ lists\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{05020\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&}
\DoxyCodeLine{05021\ \ \ \ \ \ \ \textcolor{comment}{/*geom\_reader-\/>get\_usage\_hint()\ ==\ Geom::UH\_static\ \&\&*/}}
\DoxyCodeLine{05022\ \ \ \ \ \ \ \_data\_reader-\/>get\_usage\_hint()\ ==\ Geom::UH\_static\ \&\&}
\DoxyCodeLine{05023\ \ \ \ \ \ \ display\_lists)\ \{}
\DoxyCodeLine{05024\ \ \ \ \ \textcolor{comment}{//\ If\ the\ geom\ claims\ to\ be\ totally\ static,\ try\ to\ build\ it\ into\ a\ display}}
\DoxyCodeLine{05025\ \ \ \ \ \textcolor{comment}{//\ list.}}
\DoxyCodeLine{05026\ }
\DoxyCodeLine{05027\ \ \ \ \ \textcolor{comment}{//\ Before\ we\ compile\ or\ call\ a\ display\ list,\ make\ sure\ the\ current\ buffers}}
\DoxyCodeLine{05028\ \ \ \ \ \textcolor{comment}{//\ are\ unbound,\ or\ the\ nVidia\ drivers\ may\ crash.}}
\DoxyCodeLine{05029\ \ \ \ \ unbind\_buffers();}
\DoxyCodeLine{05030\ }
\DoxyCodeLine{05031\ \ \ \ \ \mbox{\hyperlink{classGeomContext}{GeomContext}}\ *gc\ =\ geom\_reader-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{05032\ \ \ \ \ nassertr(gc\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{05033\ \ \ \ \ CLP(\mbox{\hyperlink{classGeomContext}{GeomContext}})\ *ggc\ =\ DCAST(CLP(\mbox{\hyperlink{classGeomContext}{GeomContext}}),\ gc);}
\DoxyCodeLine{05034\ \ \ \ \ \textcolor{comment}{//const\ CLP(GeomMunger)\ *gmunger\ =\ DCAST(CLP(GeomMunger),\ \_munger);}}
\DoxyCodeLine{05035\ }
\DoxyCodeLine{05036\ \ \ \ \ \mbox{\hyperlink{classUpdateSeq}{UpdateSeq}}\ modified\ =\ max(geom\_reader-\/>get\_modified(),\ \_data\_reader-\/>get\_modified());}
\DoxyCodeLine{05037\ \ \ \ \ \textcolor{keywordflow}{if}\ (ggc-\/>get\_display\_list(\_geom\_display\_list,\ \textcolor{keyword}{nullptr},\ modified))\ \{}
\DoxyCodeLine{05038\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it\ hasn't\ been\ modified,\ just\ play\ the\ display\ list\ again.}}
\DoxyCodeLine{05039\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05040\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{05041\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}calling\ display\ list\ "{}}\ <<\ (int)\_geom\_display\_list\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05042\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05043\ }
\DoxyCodeLine{05044\ \ \ \ \ \ \ glCallList(\_geom\_display\_list);}
\DoxyCodeLine{05045\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{05046\ \ \ \ \ \ \ \_vertices\_display\_list\_pcollector.add\_level(ggc-\/>\_num\_verts);}
\DoxyCodeLine{05047\ \ \ \ \ \ \ \_primitive\_batches\_display\_list\_pcollector.add\_level(1);}
\DoxyCodeLine{05048\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05049\ }
\DoxyCodeLine{05050\ \ \ \ \ \ \ \textcolor{comment}{//\ And\ now\ we\ don't\ need\ to\ do\ anything\ else\ for\ this\ geom.}}
\DoxyCodeLine{05051\ \ \ \ \ \ \ \_geom\_display\_list\ =\ 0;}
\DoxyCodeLine{05052\ \ \ \ \ \ \ end\_draw\_primitives();}
\DoxyCodeLine{05053\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05054\ \ \ \ \ \}}
\DoxyCodeLine{05055\ }
\DoxyCodeLine{05056\ \ \ \ \ \textcolor{comment}{//\ Since\ we\ start\ this\ collector\ explicitly,\ we\ have\ to\ be\ sure\ to\ stop\ it}}
\DoxyCodeLine{05057\ \ \ \ \ \textcolor{comment}{//\ again.}}
\DoxyCodeLine{05058\ \ \ \ \ \_load\_display\_list\_pcollector.start();}
\DoxyCodeLine{05059\ }
\DoxyCodeLine{05060\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{05061\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{05062\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}compiling\ display\ list\ "{}}\ <<\ (int)\_geom\_display\_list\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05063\ \ \ \ \ \}}
\DoxyCodeLine{05064\ }
\DoxyCodeLine{05065\ \ \ \ \ \textcolor{comment}{//\ If\ it\ has\ been\ modified,\ or\ this\ is\ the\ first\ time,\ then\ we\ need\ to}}
\DoxyCodeLine{05066\ \ \ \ \ \textcolor{comment}{//\ build\ the\ display\ list\ up.}}
\DoxyCodeLine{05067\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_compile\_and\_execute)\ \{}
\DoxyCodeLine{05068\ \ \ \ \ \ \ glNewList(\_geom\_display\_list,\ GL\_COMPILE\_AND\_EXECUTE);}
\DoxyCodeLine{05069\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05070\ \ \ \ \ \ \ glNewList(\_geom\_display\_list,\ GL\_COMPILE);}
\DoxyCodeLine{05071\ \ \ \ \ \}}
\DoxyCodeLine{05072\ }
\DoxyCodeLine{05073\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{05074\ \ \ \ \ \textcolor{comment}{//\ Count\ up\ the\ number\ of\ vertices\ used\ by\ primitives\ in\ the\ Geom,\ for}}
\DoxyCodeLine{05075\ \ \ \ \ \textcolor{comment}{//\ PStats\ reporting.}}
\DoxyCodeLine{05076\ \ \ \ \ ggc-\/>\_num\_verts\ =\ 0;}
\DoxyCodeLine{05077\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ geom\_reader-\/>get\_num\_primitives();\ i++)\ \{}
\DoxyCodeLine{05078\ \ \ \ \ \ \ ggc-\/>\_num\_verts\ +=\ geom\_reader-\/>get\_primitive(i)-\/>get\_num\_vertices();}
\DoxyCodeLine{05079\ \ \ \ \ \}}
\DoxyCodeLine{05080\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05081\ \ \ \}}
\DoxyCodeLine{05082\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{05083\ }
\DoxyCodeLine{05084\ \ \ \textcolor{comment}{//\ Enable\ the\ appropriate\ vertex\ arrays,\ and\ disable\ any\ extra\ vertex\ arrays}}
\DoxyCodeLine{05085\ \ \ \textcolor{comment}{//\ used\ by\ the\ previous\ rendering\ mode.}}
\DoxyCodeLine{05086\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05087\ \ \ \_use\_sender\ =\ !vertex\_arrays;}
\DoxyCodeLine{05088\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05089\ }
\DoxyCodeLine{05090\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05091\ \ \ \textcolor{keywordflow}{if}\ (\_use\_vertex\_attrib\_binding)\ \{}
\DoxyCodeLine{05092\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomVertexFormat}{GeomVertexFormat}}\ *format\ =\ data\_reader-\/>get\_format();}
\DoxyCodeLine{05093\ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ !=\ \_current\_vertex\_format)\ \{}
\DoxyCodeLine{05094\ \ \ \ \ \ \ update\_shader\_vertex\_format(format);}
\DoxyCodeLine{05095\ \ \ \ \ \}}
\DoxyCodeLine{05096\ \ \ \}}
\DoxyCodeLine{05097\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05098\ }
\DoxyCodeLine{05099\ \ \ \{}
\DoxyCodeLine{05100\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_vertex\_array\_update\_pcollector);}}
\DoxyCodeLine{05101\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{05102\ \ \ \ \ \textcolor{keywordflow}{if}\ (!update\_standard\_vertex\_arrays(force))\ \{}
\DoxyCodeLine{05103\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05104\ \ \ \ \ \}}
\DoxyCodeLine{05105\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{05106\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ ==\ 0)\ \{}
\DoxyCodeLine{05107\ \ \ \ \ \ \ \textcolor{comment}{//\ No\ shader.}}
\DoxyCodeLine{05108\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_array\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{05109\ \ \ \ \ \ \ \ \ \_vertex\_array\_shader\_context-\/>disable\_shader\_vertex\_arrays();}
\DoxyCodeLine{05110\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05111\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ !update\_standard\_vertex\_arrays(force))\ \{}
\DoxyCodeLine{05113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05114\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05115\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05116\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05117\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05118\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{05119\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Shader.}}
\DoxyCodeLine{05120\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_array\_shader\_context\ ==\ 0\ ||}
\DoxyCodeLine{05121\ \ \ \ \ \ \ \ \ \ \ \ \ \_vertex\_array\_shader\_context-\/>uses\_standard\_vertex\_arrays())\ \{}
\DoxyCodeLine{05122\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Previous\ shader\ used\ standard\ arrays.}}
\DoxyCodeLine{05123\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context-\/>uses\_standard\_vertex\_arrays())\ \{}
\DoxyCodeLine{05124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ So\ does\ the\ current,\ so\ update\ them.}}
\DoxyCodeLine{05125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!update\_standard\_vertex\_arrays(force))\ \{}
\DoxyCodeLine{05126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05127\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05128\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05129\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ current\ shader\ does\ not,\ so\ disable\ them\ entirely.}}
\DoxyCodeLine{05130\ \ \ \ \ \ \ \ \ \ \ \ \ disable\_standard\_vertex\_arrays();}
\DoxyCodeLine{05131\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05132\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05133\ \textcolor{preprocessor}{\#ifdef\ HAVE\_CG}}
\DoxyCodeLine{05134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_vertex\_array\_shader\_context-\/>is\_of\_type(CLP(CgShaderContext)::get\_class\_type()))\ \{}
\DoxyCodeLine{05135\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ previous\ shader\ was\ a\ Cg\ shader,\ which\ can\ leave\ a\ messy}}
\DoxyCodeLine{05136\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ situation.}}
\DoxyCodeLine{05137\ \ \ \ \ \ \ \ \ \ \ \_vertex\_array\_shader\_context-\/>disable\_shader\_vertex\_arrays();}
\DoxyCodeLine{05138\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05139\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05140\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05141\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05142\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ update\ the\ vertex\ arrays\ for\ the\ current\ shader.}}
\DoxyCodeLine{05143\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_current\_shader\_context-\/>}
\DoxyCodeLine{05144\ \ \ \ \ \ \ \ \ \ \ update\_shader\_vertex\_arrays(\_vertex\_array\_shader\_context,\ force))\ \{}
\DoxyCodeLine{05145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05146\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05147\ \ \ \ \ \}}
\DoxyCodeLine{05148\ }
\DoxyCodeLine{05149\ \ \ \ \ \_vertex\_array\_shader\ =\ \_current\_shader;}
\DoxyCodeLine{05150\ \ \ \ \ \_vertex\_array\_shader\_context\ =\ \_current\_shader\_context;}
\DoxyCodeLine{05151\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{05152\ \ \ \}}
\DoxyCodeLine{05153\ }
\DoxyCodeLine{05154\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05155\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05156\ \}}
\DoxyCodeLine{05157\ }
\DoxyCodeLine{05158\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05167\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05168\ update\_standard\_vertex\_arrays(bool\ force)\ \{}
\DoxyCodeLine{05169\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05170\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05171\ \ \ \ \ \textcolor{comment}{//\ We\ must\ use\ immediate\ mode\ to\ render\ primitives.}}
\DoxyCodeLine{05172\ \ \ \ \ \_sender.clear();}
\DoxyCodeLine{05173\ }
\DoxyCodeLine{05174\ \ \ \ \ \_sender.add\_column(\_data\_reader,\ InternalName::get\_normal(),}
\DoxyCodeLine{05175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ GLPf(Normal3),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05176\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05177\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_show\_texture\_usage)\ \{}
\DoxyCodeLine{05178\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ show\_texture\_usage\ mode,\ all\ colors\ are\ white,\ so\ as\ not\ to}}
\DoxyCodeLine{05179\ \ \ \ \ \ \ \textcolor{comment}{//\ contaminate\ the\ texture\ color.}}
\DoxyCodeLine{05180\ \ \ \ \ \ \ GLPf(Color4)(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{05181\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05182\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05183\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_sender.add\_column(\_data\_reader,\ InternalName::get\_color(),}
\DoxyCodeLine{05184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ GLPf(Color3),\ GLPf(Color4)))\ \{}
\DoxyCodeLine{05185\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ didn't\ have\ a\ color\ column,\ the\ item\ color\ is\ white.}}
\DoxyCodeLine{05186\ \ \ \ \ \ \ \ \ GLPf(Color4)(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{05187\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05188\ }
\DoxyCodeLine{05189\ \ \ \ \ \textcolor{comment}{//\ Now\ set\ up\ each\ of\ the\ active\ texture\ coordinate\ stages-\/-\/or\ at\ least}}
\DoxyCodeLine{05190\ \ \ \ \ \textcolor{comment}{//\ those\ for\ which\ we're\ not\ generating\ texture\ coordinates\ automatically.}}
\DoxyCodeLine{05191\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_stage\_index\ =\ \_target\_texture-\/>get\_num\_on\_ff\_stages();}
\DoxyCodeLine{05192\ \ \ \ \ \textcolor{keywordtype}{int}\ stage\_index\ =\ 0;}
\DoxyCodeLine{05193\ \ \ \ \ \textcolor{keywordflow}{while}\ (stage\_index\ <\ max\_stage\_index)\ \{}
\DoxyCodeLine{05194\ \ \ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(stage\_index);}
\DoxyCodeLine{05195\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_target\_tex\_gen-\/>has\_gen\_texcoord\_stage(stage))\ \{}
\DoxyCodeLine{05196\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ stage\ is\ not\ one\ of\ the\ stages\ that\ doesn't\ need\ texcoords}}
\DoxyCodeLine{05197\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ issued\ for\ it.}}
\DoxyCodeLine{05198\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classInternalName}{InternalName}}\ *name\ =\ stage-\/>get\_texcoord\_name();}
\DoxyCodeLine{05199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (stage\_index\ ==\ 0)\ \{}
\DoxyCodeLine{05200\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ the\ original\ functions\ for\ stage\ 0,\ in\ case\ we\ don't\ support}}
\DoxyCodeLine{05201\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ multitexture.}}
\DoxyCodeLine{05202\ \ \ \ \ \ \ \ \ \ \ \_sender.add\_column(\_data\_reader,\ name,}
\DoxyCodeLine{05203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLPf(TexCoord1),\ GLPf(TexCoord2),}
\DoxyCodeLine{05204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLPf(TexCoord3),\ GLPf(TexCoord4));}
\DoxyCodeLine{05205\ }
\DoxyCodeLine{05206\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05207\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Other\ stages\ require\ the\ multitexture\ functions.}}
\DoxyCodeLine{05208\ \ \ \ \ \ \ \ \ \ \ \_sender.add\_texcoord\_column(\_data\_reader,\ name,\ stage\_index,}
\DoxyCodeLine{05209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLf(\_glMultiTexCoord1),\ GLf(\_glMultiTexCoord2),}
\DoxyCodeLine{05210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLf(\_glMultiTexCoord3),\ GLf(\_glMultiTexCoord4));}
\DoxyCodeLine{05211\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05212\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05213\ }
\DoxyCodeLine{05214\ \ \ \ \ \ \ ++stage\_index;}
\DoxyCodeLine{05215\ \ \ \ \ \}}
\DoxyCodeLine{05216\ }
\DoxyCodeLine{05217\ \ \ \ \ \textcolor{comment}{//\ Be\ sure\ also\ to\ disable\ any\ texture\ stages\ we\ had\ enabled\ before.}}
\DoxyCodeLine{05218\ \ \ \ \ \textcolor{keywordflow}{while}\ (stage\_index\ <\ \_last\_max\_stage\_index)\ \{}
\DoxyCodeLine{05219\ \ \ \ \ \ \ \_glClientActiveTexture(GL\_TEXTURE0\ +\ stage\_index);}
\DoxyCodeLine{05220\ \ \ \ \ \ \ glDisableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05221\ \ \ \ \ \ \ ++stage\_index;}
\DoxyCodeLine{05222\ \ \ \ \ \}}
\DoxyCodeLine{05223\ \ \ \ \ \_last\_max\_stage\_index\ =\ max\_stage\_index;}
\DoxyCodeLine{05224\ }
\DoxyCodeLine{05225\ \ \ \ \ \textcolor{comment}{//\ We\ must\ add\ vertex\ last,\ because\ glVertex3f()\ is\ the\ key\ function\ call}}
\DoxyCodeLine{05226\ \ \ \ \ \textcolor{comment}{//\ that\ actually\ issues\ the\ vertex.}}
\DoxyCodeLine{05227\ \ \ \ \ \_sender.add\_column(\_data\_reader,\ InternalName::get\_vertex(),}
\DoxyCodeLine{05228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ GLPf(Vertex2),\ GLPf(Vertex3),\ GLPf(Vertex4));}
\DoxyCodeLine{05229\ }
\DoxyCodeLine{05230\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05231\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05232\ \ \ \{}
\DoxyCodeLine{05233\ \ \ \ \ \textcolor{comment}{//\ We\ may\ use\ vertex\ arrays\ or\ buffers\ to\ render\ primitives.}}
\DoxyCodeLine{05234\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomVertexArrayDataHandle}{GeomVertexArrayDataHandle}}\ *array\_reader;}
\DoxyCodeLine{05235\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05236\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_values;}
\DoxyCodeLine{05237\ \ \ \ \ Geom::NumericType\ numeric\_type;}
\DoxyCodeLine{05238\ \ \ \ \ \textcolor{keywordtype}{int}\ start;}
\DoxyCodeLine{05239\ \ \ \ \ \textcolor{keywordtype}{int}\ stride;}
\DoxyCodeLine{05240\ }
\DoxyCodeLine{05241\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_data\_reader-\/>get\_normal\_info(array\_reader,\ numeric\_type,}
\DoxyCodeLine{05242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ start,\ stride))\ \{}
\DoxyCodeLine{05243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_array\_data(client\_pointer,\ array\_reader,\ force))\ \{}
\DoxyCodeLine{05244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05245\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05246\ \ \ \ \ \ \ glNormalPointer(get\_numeric\_type(numeric\_type),\ stride,}
\DoxyCodeLine{05247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start);}
\DoxyCodeLine{05248\ \ \ \ \ \ \ glEnableClientState(GL\_NORMAL\_ARRAY);}
\DoxyCodeLine{05249\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05250\ \ \ \ \ \ \ glDisableClientState(GL\_NORMAL\_ARRAY);}
\DoxyCodeLine{05251\ \ \ \ \ \}}
\DoxyCodeLine{05252\ }
\DoxyCodeLine{05253\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05254\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_show\_texture\_usage)\ \{}
\DoxyCodeLine{05255\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ show\_texture\_usage\ mode,\ all\ colors\ are\ white,\ so\ as\ not\ to}}
\DoxyCodeLine{05256\ \ \ \ \ \ \ \textcolor{comment}{//\ contaminate\ the\ texture\ color.}}
\DoxyCodeLine{05257\ \ \ \ \ \ \ glDisableClientState(GL\_COLOR\_ARRAY);}
\DoxyCodeLine{05258\ \ \ \ \ \ \ GLPf(Color4)(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{05259\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05260\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05261\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_colors\_enabled\ \&\&}
\DoxyCodeLine{05262\ \ \ \ \ \ \ \ \ \ \ \_data\_reader-\/>get\_color\_info(array\_reader,\ num\_values,\ numeric\_type,}
\DoxyCodeLine{05263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ start,\ stride))\ \{}
\DoxyCodeLine{05264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_array\_data(client\_pointer,\ array\_reader,\ force))\ \{}
\DoxyCodeLine{05265\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05266\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05267\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (numeric\_type\ ==\ Geom::NT\_packed\_dabc)\ \{}
\DoxyCodeLine{05268\ \ \ \ \ \ \ \ \ \ \ glColorPointer(GL\_BGRA,\ GL\_UNSIGNED\_BYTE,}
\DoxyCodeLine{05269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stride,\ client\_pointer\ +\ start);}
\DoxyCodeLine{05270\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05271\ \ \ \ \ \ \ \ \ \ \ glColorPointer(num\_values,\ get\_numeric\_type(numeric\_type),}
\DoxyCodeLine{05272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stride,\ client\_pointer\ +\ start);}
\DoxyCodeLine{05273\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05274\ \ \ \ \ \ \ \ \ glEnableClientState(GL\_COLOR\_ARRAY);}
\DoxyCodeLine{05275\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05276\ \ \ \ \ \ \ \ \ glDisableClientState(GL\_COLOR\_ARRAY);}
\DoxyCodeLine{05277\ }
\DoxyCodeLine{05278\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Since\ we\ don't\ have\ per-\/vertex\ color,\ the\ implicit\ color\ is\ white.}}
\DoxyCodeLine{05279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_color\_scale\_via\_lighting)\ \{}
\DoxyCodeLine{05280\ \ \ \ \ \ \ \ \ \ \ GLPf(Color4)(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{05281\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05282\ \ \ \ \ \ \ \ \ \ \ LColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ \_scene\_graph\_color;}
\DoxyCodeLine{05283\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}.componentwise\_mult(\_current\_color\_scale);}
\DoxyCodeLine{05284\ \ \ \ \ \ \ \ \ \ \ GLPf(Color4)(\mbox{\hyperlink{structcolor}{color}}[0],\ \mbox{\hyperlink{structcolor}{color}}[1],\ \mbox{\hyperlink{structcolor}{color}}[2],\ \mbox{\hyperlink{structcolor}{color}}[3]);}
\DoxyCodeLine{05285\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05286\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05287\ }
\DoxyCodeLine{05288\ \ \ \ \ \textcolor{comment}{//\ Now\ set\ up\ each\ of\ the\ active\ texture\ coordinate\ stages-\/-\/or\ at\ least}}
\DoxyCodeLine{05289\ \ \ \ \ \textcolor{comment}{//\ those\ for\ which\ we're\ not\ generating\ texture\ coordinates\ automatically.}}
\DoxyCodeLine{05290\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_stage\_index\ =\ \_target\_texture-\/>get\_num\_on\_ff\_stages();}
\DoxyCodeLine{05291\ \ \ \ \ \textcolor{keywordtype}{int}\ stage\_index\ =\ 0;}
\DoxyCodeLine{05292\ \ \ \ \ \textcolor{keywordflow}{while}\ (stage\_index\ <\ max\_stage\_index)\ \{}
\DoxyCodeLine{05293\ \ \ \ \ \ \ \_glClientActiveTexture(GL\_TEXTURE0\ +\ stage\_index);}
\DoxyCodeLine{05294\ \ \ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(stage\_index);}
\DoxyCodeLine{05295\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_target\_tex\_gen-\/>has\_gen\_texcoord\_stage(stage))\ \{}
\DoxyCodeLine{05296\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ stage\ is\ not\ one\ of\ the\ stages\ that\ doesn't\ need\ texcoords}}
\DoxyCodeLine{05297\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ issued\ for\ it.}}
\DoxyCodeLine{05298\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classInternalName}{InternalName}}\ *name\ =\ stage-\/>get\_texcoord\_name();}
\DoxyCodeLine{05299\ }
\DoxyCodeLine{05300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_data\_reader-\/>get\_array\_info(name,\ array\_reader,\ num\_values,}
\DoxyCodeLine{05301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ numeric\_type,\ start,\ stride))\ \{}
\DoxyCodeLine{05302\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vertex\ data\ does\ have\ texcoords\ for\ this\ stage.}}
\DoxyCodeLine{05303\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_array\_data(client\_pointer,\ array\_reader,\ force))\ \{}
\DoxyCodeLine{05304\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05305\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05306\ \ \ \ \ \ \ \ \ \ \ glTexCoordPointer(num\_values,\ get\_numeric\_type(numeric\_type),}
\DoxyCodeLine{05307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stride,\ client\_pointer\ +\ start);}
\DoxyCodeLine{05308\ \ \ \ \ \ \ \ \ \ \ glEnableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05309\ }
\DoxyCodeLine{05310\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05311\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vertex\ data\ doesn't\ have\ texcoords\ for\ this\ stage\ (even}}
\DoxyCodeLine{05312\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ though\ they're\ needed).}}
\DoxyCodeLine{05313\ \ \ \ \ \ \ \ \ \ \ glDisableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05314\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05315\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05316\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ texcoords\ are\ needed\ for\ this\ stage.}}
\DoxyCodeLine{05317\ \ \ \ \ \ \ \ \ glDisableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05318\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05319\ }
\DoxyCodeLine{05320\ \ \ \ \ \ \ ++stage\_index;}
\DoxyCodeLine{05321\ \ \ \ \ \}}
\DoxyCodeLine{05322\ }
\DoxyCodeLine{05323\ \ \ \ \ \textcolor{comment}{//\ Be\ sure\ also\ to\ disable\ any\ texture\ stages\ we\ had\ enabled\ before.}}
\DoxyCodeLine{05324\ \ \ \ \ \textcolor{keywordflow}{while}\ (stage\_index\ <\ \_last\_max\_stage\_index)\ \{}
\DoxyCodeLine{05325\ \ \ \ \ \ \ \_glClientActiveTexture(GL\_TEXTURE0\ +\ stage\_index);}
\DoxyCodeLine{05326\ \ \ \ \ \ \ glDisableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05327\ \ \ \ \ \ \ ++stage\_index;}
\DoxyCodeLine{05328\ \ \ \ \ \}}
\DoxyCodeLine{05329\ \ \ \ \ \_last\_max\_stage\_index\ =\ max\_stage\_index;}
\DoxyCodeLine{05330\ }
\DoxyCodeLine{05331\ \ \ \ \ \textcolor{comment}{//\ There's\ no\ requirement\ that\ we\ add\ vertices\ last,\ but\ we\ do\ anyway.}}
\DoxyCodeLine{05332\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_data\_reader-\/>get\_vertex\_info(array\_reader,\ num\_values,\ numeric\_type,}
\DoxyCodeLine{05333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ start,\ stride))\ \{}
\DoxyCodeLine{05334\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_array\_data(client\_pointer,\ array\_reader,\ force))\ \{}
\DoxyCodeLine{05335\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05336\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05337\ \ \ \ \ \ \ glVertexPointer(num\_values,\ get\_numeric\_type(numeric\_type),}
\DoxyCodeLine{05338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stride,\ client\_pointer\ +\ start);}
\DoxyCodeLine{05339\ \ \ \ \ \ \ glEnableClientState(GL\_VERTEX\_ARRAY);}
\DoxyCodeLine{05340\ \ \ \ \ \}}
\DoxyCodeLine{05341\ \ \ \}}
\DoxyCodeLine{05342\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05343\ \}}
\DoxyCodeLine{05344\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05345\ }
\DoxyCodeLine{05350\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05351\ unbind\_buffers()\ \{}
\DoxyCodeLine{05352\ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ !=\ 0)\ \{}
\DoxyCodeLine{05353\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{05354\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{05355\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ vertex\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{05356\ \ \ \ \ \}}
\DoxyCodeLine{05357\ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{05358\ \ \ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{05359\ \ \ \}}
\DoxyCodeLine{05360\ \ \ \textcolor{keywordflow}{if}\ (\_current\_ibuffer\_index\ !=\ 0)\ \{}
\DoxyCodeLine{05361\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{05362\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{05363\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ index\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{05364\ \ \ \ \ \}}
\DoxyCodeLine{05365\ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{05366\ \ \ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{05367\ \ \ \}}
\DoxyCodeLine{05368\ }
\DoxyCodeLine{05369\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{05370\ \ \ \textcolor{keywordflow}{if}\ (\_current\_vertex\_buffers.size()\ >\ 1\ \&\&\ \_supports\_multi\_bind)\ \{}
\DoxyCodeLine{05371\ \ \ \ \ \_glBindVertexBuffers(0,\ \_current\_vertex\_buffers.size(),\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{05372\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05373\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_current\_vertex\_buffers.size();\ ++i)\ \{}
\DoxyCodeLine{05374\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_vertex\_buffers[i]\ !=\ 0)\ \{}
\DoxyCodeLine{05375\ \ \ \ \ \ \ \ \ \_glBindVertexBuffer((GLuint)i,\ 0,\ 0,\ 0);}
\DoxyCodeLine{05376\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05377\ \ \ \ \ \}}
\DoxyCodeLine{05378\ \ \ \}}
\DoxyCodeLine{05379\ \ \ \_current\_vertex\_buffers.clear();}
\DoxyCodeLine{05380\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05381\ }
\DoxyCodeLine{05382\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05383\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{05384\ \ \ \ \ disable\_standard\_vertex\_arrays();}
\DoxyCodeLine{05385\ \ \ \}}
\DoxyCodeLine{05386\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05387\ \}}
\DoxyCodeLine{05388\ }
\DoxyCodeLine{05389\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05396\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05397\ disable\_standard\_vertex\_arrays()\ \{}
\DoxyCodeLine{05398\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05399\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{05400\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05401\ }
\DoxyCodeLine{05402\ \ \ glDisableClientState(GL\_NORMAL\_ARRAY);}
\DoxyCodeLine{05403\ \ \ glDisableClientState(GL\_COLOR\_ARRAY);}
\DoxyCodeLine{05404\ \ \ GLPf(Color4)(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{05405\ }
\DoxyCodeLine{05406\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ stage\_index=0;\ stage\_index\ <\ \_last\_max\_stage\_index;\ stage\_index++)\ \{}
\DoxyCodeLine{05407\ \ \ \ \ \_glClientActiveTexture(GL\_TEXTURE0\ +\ stage\_index);}
\DoxyCodeLine{05408\ \ \ \ \ glDisableClientState(GL\_TEXTURE\_COORD\_ARRAY);}
\DoxyCodeLine{05409\ \ \ \}}
\DoxyCodeLine{05410\ \ \ \_last\_max\_stage\_index\ =\ 0;}
\DoxyCodeLine{05411\ }
\DoxyCodeLine{05412\ \ \ glDisableClientState(GL\_VERTEX\_ARRAY);}
\DoxyCodeLine{05413\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05414\ \}}
\DoxyCodeLine{05415\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{05416\ }
\DoxyCodeLine{05417\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05422\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05423\ update\_shader\_vertex\_format(const\ \mbox{\hyperlink{classGeomVertexFormat}{GeomVertexFormat}}\ *format)\ \{}
\DoxyCodeLine{05424\ \ \ \textcolor{keywordtype}{size\_t}\ num\_columns\ =\ format-\/>get\_num\_columns();}
\DoxyCodeLine{05425\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ ci\ =\ 0;\ ci\ <\ num\_columns;\ ++ci)\ \{}
\DoxyCodeLine{05426\ \ \ \ \ GLuint\ binding\ =\ format-\/>get\_array\_with(ci);}
\DoxyCodeLine{05427\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomVertexColumn}{GeomVertexColumn}}\ *column\ =\ format-\/>get\_column(ci);}
\DoxyCodeLine{05428\ }
\DoxyCodeLine{05429\ \ \ \ \ \textcolor{comment}{//\ Needs\ improvement,\ obviously.}}
\DoxyCodeLine{05430\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classInternalName}{InternalName}}\ *name\ =\ column-\/>\mbox{\hyperlink{classInternalName_a9fd35ab9c168d1b4e3dcb6822086ae61}{get\_name}}();}
\DoxyCodeLine{05431\ \ \ \ \ GLuint\ loc;}
\DoxyCodeLine{05432\ \ \ \ \ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_vertex())\ \{}
\DoxyCodeLine{05433\ \ \ \ \ \ \ loc\ =\ 0;}
\DoxyCodeLine{05434\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_transform\_weight())\ \{}
\DoxyCodeLine{05435\ \ \ \ \ \ \ loc\ =\ 1;}
\DoxyCodeLine{05436\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_normal())\ \{}
\DoxyCodeLine{05437\ \ \ \ \ \ \ loc\ =\ 2;}
\DoxyCodeLine{05438\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_color())\ \{}
\DoxyCodeLine{05439\ \ \ \ \ \ \ loc\ =\ 3;}
\DoxyCodeLine{05440\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_transform\_index())\ \{}
\DoxyCodeLine{05441\ \ \ \ \ \ \ loc\ =\ 7;}
\DoxyCodeLine{05442\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ InternalName::get\_texcoord())\ \{}
\DoxyCodeLine{05443\ \ \ \ \ \ \ loc\ =\ 8;}
\DoxyCodeLine{05444\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05445\ \ \ \ \ \ \ \textcolor{comment}{//\ Not\ yet\ supported,\ ignore\ for\ now.\ \ This\ system\ will\ be\ improved.}}
\DoxyCodeLine{05446\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{05447\ \ \ \ \ \}}
\DoxyCodeLine{05448\ }
\DoxyCodeLine{05449\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_attrib\_columns[loc]\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{05450\ \ \ \ \ \ \ \ \ \_vertex\_attrib\_columns[loc]-\/>\mbox{\hyperlink{classcompare__to}{compare\_to}}(*column)\ ==\ 0)\ \{}
\DoxyCodeLine{05451\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{05452\ \ \ \ \ \}}
\DoxyCodeLine{05453\ \ \ \ \ \_vertex\_attrib\_columns[loc]\ =\ column;}
\DoxyCodeLine{05454\ }
\DoxyCodeLine{05455\ \ \ \ \ GLuint\ offset\ =\ column-\/>get\_start();}
\DoxyCodeLine{05456\ \ \ \ \ GLenum\ type\ =\ get\_numeric\_type(column-\/>get\_numeric\_type());}
\DoxyCodeLine{05457\ \ \ \ \ GLboolean\ normalized\ =\ (column-\/>get\_contents()\ ==\ GeomEnums::C\_color);}
\DoxyCodeLine{05458\ \ \ \ \ GLint\ size\ =\ column-\/>get\_num\_values();}
\DoxyCodeLine{05459\ }
\DoxyCodeLine{05460\ \ \ \ \ \textcolor{keywordflow}{if}\ (column-\/>get\_numeric\_type()\ ==\ GeomEnums::NT\_packed\_dabc)\ \{}
\DoxyCodeLine{05461\ \ \ \ \ \ \ \textcolor{comment}{//\ GL\_BGRA\ is\ a\ special\ accepted\ value\ available\ since\ OpenGL\ 3.2.\ It}}
\DoxyCodeLine{05462\ \ \ \ \ \ \ \textcolor{comment}{//\ requires\ us\ to\ pass\ GL\_TRUE\ for\ normalized.}}
\DoxyCodeLine{05463\ \ \ \ \ \ \ size\ =\ GL\_BGRA;}
\DoxyCodeLine{05464\ \ \ \ \ \ \ normalized\ =\ GL\_TRUE;}
\DoxyCodeLine{05465\ \ \ \ \ \}}
\DoxyCodeLine{05466\ }
\DoxyCodeLine{05467\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ column-\/>get\_num\_elements();\ ++i)\ \{}
\DoxyCodeLine{05468\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (loc\ ==\ 7)\ \{\ \textcolor{comment}{//\ Temp\ hack}}
\DoxyCodeLine{05469\ \ \ \ \ \ \ \ \ \_glVertexAttribIFormat(loc,\ size,\ type,\ offset);}
\DoxyCodeLine{05470\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05471\ \ \ \ \ \ \ \ \ \_glVertexAttribFormat(loc,\ size,\ type,\ normalized,\ offset);}
\DoxyCodeLine{05472\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05473\ \ \ \ \ \ \ \_glVertexAttribBinding(loc,\ binding);}
\DoxyCodeLine{05474\ }
\DoxyCodeLine{05475\ \ \ \ \ \ \ offset\ +=\ column-\/>get\_element\_stride();}
\DoxyCodeLine{05476\ \ \ \ \ \ \ ++loc;}
\DoxyCodeLine{05477\ \ \ \ \ \}}
\DoxyCodeLine{05478\ \ \ \}}
\DoxyCodeLine{05479\ }
\DoxyCodeLine{05480\ \ \ \textcolor{keywordtype}{size\_t}\ num\_arrays\ =\ format-\/>get\_num\_arrays();}
\DoxyCodeLine{05481\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ ai\ =\ 0;\ ai\ <\ num\_arrays;\ ++ai)\ \{}
\DoxyCodeLine{05482\ \ \ \ \ \_glVertexBindingDivisor(ai,\ format-\/>get\_array(ai)-\/>get\_divisor());}
\DoxyCodeLine{05483\ \ \ \}}
\DoxyCodeLine{05484\ }
\DoxyCodeLine{05485\ \ \ \_current\_vertex\_format\ =\ format;}
\DoxyCodeLine{05486\ \}}
\DoxyCodeLine{05487\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05488\ }
\DoxyCodeLine{05492\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05493\ draw\_triangles(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05494\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05495\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05496\ }
\DoxyCodeLine{05497\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05498\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05499\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_triangles:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05500\ \ \ \}}
\DoxyCodeLine{05501\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05502\ }
\DoxyCodeLine{05503\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05504\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05505\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_TRIANGLES);}
\DoxyCodeLine{05506\ }
\DoxyCodeLine{05507\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05508\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05509\ \ \ \{}
\DoxyCodeLine{05510\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{05511\ \ \ \ \ \_vertices\_tri\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{05512\ \ \ \ \ \_primitive\_batches\_tri\_pcollector.add\_level(1);}
\DoxyCodeLine{05513\ }
\DoxyCodeLine{05514\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05515\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05516\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05517\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05518\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05519\ }
\DoxyCodeLine{05520\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05521\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05522\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLES,\ num\_vertices,}
\DoxyCodeLine{05523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{05525\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05526\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05527\ \ \ \ \ \ \ \{}
\DoxyCodeLine{05528\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLES,}
\DoxyCodeLine{05529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{05530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{05531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{05532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{05534\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05535\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05536\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05537\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05538\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLES,}
\DoxyCodeLine{05539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{05541\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05542\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05543\ \ \ \ \ \ \ \{}
\DoxyCodeLine{05544\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLES,}
\DoxyCodeLine{05545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{05547\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05548\ \ \ \ \ \}}
\DoxyCodeLine{05549\ \ \ \}}
\DoxyCodeLine{05550\ }
\DoxyCodeLine{05551\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05552\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05553\ \}}
\DoxyCodeLine{05554\ }
\DoxyCodeLine{05558\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{05559\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05560\ draw\_triangles\_adj(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05561\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05562\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05563\ }
\DoxyCodeLine{05564\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05565\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05566\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_triangles\_adj:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05567\ \ \ \}}
\DoxyCodeLine{05568\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05569\ }
\DoxyCodeLine{05570\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05571\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05572\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_TRIANGLES\_ADJACENCY);}
\DoxyCodeLine{05573\ }
\DoxyCodeLine{05574\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05575\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05576\ \ \ \{}
\DoxyCodeLine{05577\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{05578\ \ \ \ \ \_vertices\_tri\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{05579\ \ \ \ \ \_primitive\_batches\_tri\_pcollector.add\_level(1);}
\DoxyCodeLine{05580\ }
\DoxyCodeLine{05581\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05582\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05583\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05585\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05586\ }
\DoxyCodeLine{05587\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05588\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLES\_ADJACENCY,\ num\_vertices,}
\DoxyCodeLine{05589\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{05591\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05592\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLES\_ADJACENCY,}
\DoxyCodeLine{05593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{05594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{05595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{05596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{05598\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05599\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05600\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05601\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLES\_ADJACENCY,}
\DoxyCodeLine{05602\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05603\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{05604\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05605\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLES\_ADJACENCY,}
\DoxyCodeLine{05606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{05608\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05609\ \ \ \ \ \}}
\DoxyCodeLine{05610\ \ \ \}}
\DoxyCodeLine{05611\ }
\DoxyCodeLine{05612\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05613\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05614\ \}}
\DoxyCodeLine{05615\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{05616\ }
\DoxyCodeLine{05620\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05621\ draw\_tristrips(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05622\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05623\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05624\ }
\DoxyCodeLine{05625\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05626\ }
\DoxyCodeLine{05627\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05628\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05629\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_tristrips:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05630\ \ \ \}}
\DoxyCodeLine{05631\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05632\ }
\DoxyCodeLine{05633\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05634\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05635\ \ \ \ \ draw\_immediate\_composite\_primitives(reader,\ GL\_TRIANGLE\_STRIP);}
\DoxyCodeLine{05636\ }
\DoxyCodeLine{05637\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05638\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05639\ \ \ \{}
\DoxyCodeLine{05640\ \ \ \ \ \textcolor{keywordflow}{if}\ (connect\_triangle\_strips\ \&\&\ \_render\_mode\ !=\ RenderModeAttrib::M\_wireframe)\ \{}
\DoxyCodeLine{05641\ \ \ \ \ \ \ \textcolor{comment}{//\ One\ long\ triangle\ strip,\ connected\ by\ the\ degenerate\ vertices\ that}}
\DoxyCodeLine{05642\ \ \ \ \ \ \ \textcolor{comment}{//\ have\ already\ been\ set\ up\ within\ the\ primitive.}}
\DoxyCodeLine{05643\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{05644\ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{05645\ \ \ \ \ \ \ \_primitive\_batches\_tristrip\_pcollector.add\_level(1);}
\DoxyCodeLine{05646\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05647\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05648\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05649\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05650\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05651\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05652\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05653\ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLE\_STRIP,\ num\_vertices,}
\DoxyCodeLine{05654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05655\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{05656\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05657\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05658\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05659\ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLE\_STRIP,}
\DoxyCodeLine{05660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{05661\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{05662\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{05663\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{05665\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05666\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05667\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05668\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05669\ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLE\_STRIP,}
\DoxyCodeLine{05670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05671\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{05672\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05673\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05674\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05675\ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLE\_STRIP,}
\DoxyCodeLine{05676\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05677\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{05678\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05679\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05680\ }
\DoxyCodeLine{05681\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05682\ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ the\ individual\ triangle\ strips,\ stepping\ over\ the\ degenerate}}
\DoxyCodeLine{05683\ \ \ \ \ \ \ \textcolor{comment}{//\ vertices.}}
\DoxyCodeLine{05684\ \ \ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{05685\ }
\DoxyCodeLine{05686\ \ \ \ \ \ \ \_primitive\_batches\_tristrip\_pcollector.add\_level(ends.size());}
\DoxyCodeLine{05687\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05688\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05690\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05691\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05692\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_stride\ =\ reader-\/>get\_index\_stride();}
\DoxyCodeLine{05693\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ mins(reader-\/>get\_mins(),\ 0);}
\DoxyCodeLine{05694\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ maxs(reader-\/>get\_maxs(),\ 0);}
\DoxyCodeLine{05695\ \ \ \ \ \ \ \ \ nassertr(reader-\/>get\_mins()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size()\ \&\&}
\DoxyCodeLine{05696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_maxs()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05697\ }
\DoxyCodeLine{05698\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05699\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05700\ \ \ \ \ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05701\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05702\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05703\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLE\_STRIP,\ ends[i]\ -\/\ start,}
\DoxyCodeLine{05704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride,}
\DoxyCodeLine{05706\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_instance\_count);}
\DoxyCodeLine{05707\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05708\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05709\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05710\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLE\_STRIP,}
\DoxyCodeLine{05711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mins.get\_data1i(),\ maxs.get\_data1i(),}
\DoxyCodeLine{05712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,}
\DoxyCodeLine{05713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride);}
\DoxyCodeLine{05715\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05716\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 2;}
\DoxyCodeLine{05717\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05718\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05719\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05720\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_vertex\ =\ reader-\/>get\_first\_vertex();}
\DoxyCodeLine{05721\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05722\ \ \ \ \ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05723\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05724\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05725\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLE\_STRIP,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,\ \_instance\_count);}
\DoxyCodeLine{05727\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05728\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05729\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05730\ \ \ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLE\_STRIP,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start);}
\DoxyCodeLine{05732\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05733\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 2;}
\DoxyCodeLine{05734\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05735\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05736\ \ \ \ \ \}}
\DoxyCodeLine{05737\ \ \ \}}
\DoxyCodeLine{05738\ }
\DoxyCodeLine{05739\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05740\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05741\ \}}
\DoxyCodeLine{05742\ }
\DoxyCodeLine{05746\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{05747\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05748\ draw\_tristrips\_adj(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05749\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05750\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05751\ }
\DoxyCodeLine{05752\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05753\ }
\DoxyCodeLine{05754\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05755\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05756\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_tristrips\_adj:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05757\ \ \ \}}
\DoxyCodeLine{05758\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05759\ }
\DoxyCodeLine{05760\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05761\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05762\ \ \ \ \ draw\_immediate\_composite\_primitives(reader,\ GL\_TRIANGLE\_STRIP\_ADJACENCY);}
\DoxyCodeLine{05763\ }
\DoxyCodeLine{05764\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05765\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05766\ \ \ \{}
\DoxyCodeLine{05767\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed()\ \&\&}
\DoxyCodeLine{05768\ \ \ \ \ \ \ \ \ (\_supported\_geom\_rendering\ \&\ GeomEnums::GR\_strip\_cut\_index)\ !=\ 0)\ \{}
\DoxyCodeLine{05769\ \ \ \ \ \ \ \textcolor{comment}{//\ One\ long\ line\ strip,\ connected\ by\ strip\ cut\ indices.}}
\DoxyCodeLine{05770\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{05771\ \ \ \ \ \ \ \ \ glEnable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{05772\ \ \ \ \ \ \ \ \ \_glPrimitiveRestartIndex(reader-\/>get\_strip\_cut\_index());}
\DoxyCodeLine{05773\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05774\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{05775\ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{05776\ \ \ \ \ \ \ \_primitive\_batches\_tristrip\_pcollector.add\_level(1);}
\DoxyCodeLine{05777\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05778\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05779\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05780\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05781\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05783\ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLE\_STRIP\_ADJACENCY,\ num\_vertices,}
\DoxyCodeLine{05784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{05786\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05787\ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{05788\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{05789\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{05790\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{05791\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05792\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{05793\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05794\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05795\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05796\ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{05797\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05798\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{05799\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05800\ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{05801\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{05802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{05803\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05805\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{05806\ \ \ \ \ \ \ \ \ glDisable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{05807\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05808\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05809\ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ the\ individual\ triangle\ strips,\ stepping\ over\ the\ degenerate}}
\DoxyCodeLine{05810\ \ \ \ \ \ \ \textcolor{comment}{//\ vertices.}}
\DoxyCodeLine{05811\ \ \ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{05812\ }
\DoxyCodeLine{05813\ \ \ \ \ \ \ \_primitive\_batches\_tristrip\_pcollector.add\_level(ends.size());}
\DoxyCodeLine{05814\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05815\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05816\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05817\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05818\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05819\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_stride\ =\ reader-\/>get\_index\_stride();}
\DoxyCodeLine{05820\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ mins(reader-\/>get\_mins(),\ 0);}
\DoxyCodeLine{05821\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ maxs(reader-\/>get\_maxs(),\ 0);}
\DoxyCodeLine{05822\ \ \ \ \ \ \ \ \ nassertr(reader-\/>get\_mins()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size()\ \&\&}
\DoxyCodeLine{05823\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_maxs()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05824\ }
\DoxyCodeLine{05825\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05827\ \ \ \ \ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05828\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05829\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLE\_STRIP\_ADJACENCY,\ ends[i]\ -\/\ start,}
\DoxyCodeLine{05830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride,}
\DoxyCodeLine{05832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_instance\_count);}
\DoxyCodeLine{05833\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05834\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{05835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mins.get\_data1i(),\ maxs.get\_data1i(),}
\DoxyCodeLine{05836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,}
\DoxyCodeLine{05837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride);}
\DoxyCodeLine{05839\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05840\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{05841\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05842\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05843\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05844\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_vertex\ =\ reader-\/>get\_first\_vertex();}
\DoxyCodeLine{05845\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05846\ \ \ \ \ \ \ \ \ \ \ \_vertices\_tristrip\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05847\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05848\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLE\_STRIP\_ADJACENCY,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,\ \_instance\_count);}
\DoxyCodeLine{05850\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05851\ \ \ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLE\_STRIP\_ADJACENCY,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05852\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start);}
\DoxyCodeLine{05853\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05854\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{05855\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05856\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05857\ \ \ \ \ \}}
\DoxyCodeLine{05858\ \ \ \}}
\DoxyCodeLine{05859\ }
\DoxyCodeLine{05860\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05861\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05862\ \}}
\DoxyCodeLine{05863\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{05864\ }
\DoxyCodeLine{05868\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05869\ draw\_trifans(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05870\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05871\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05872\ }
\DoxyCodeLine{05873\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05874\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05875\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_trifans:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05876\ \ \ \}}
\DoxyCodeLine{05877\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05878\ }
\DoxyCodeLine{05879\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05880\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05881\ \ \ \ \ draw\_immediate\_composite\_primitives(reader,\ GL\_TRIANGLE\_FAN);}
\DoxyCodeLine{05882\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05883\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05884\ \ \ \{}
\DoxyCodeLine{05885\ \ \ \ \ \textcolor{comment}{//\ Send\ the\ individual\ triangle\ fans.\ \ There's\ no\ connecting\ fans\ with}}
\DoxyCodeLine{05886\ \ \ \ \ \textcolor{comment}{//\ degenerate\ vertices,\ so\ no\ worries\ about\ that.}}
\DoxyCodeLine{05887\ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{05888\ }
\DoxyCodeLine{05889\ \ \ \ \ \_primitive\_batches\_trifan\_pcollector.add\_level(ends.size());}
\DoxyCodeLine{05890\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05891\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05892\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05893\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05894\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05895\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_stride\ =\ reader-\/>get\_index\_stride();}
\DoxyCodeLine{05896\ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ mins(reader-\/>get\_mins(),\ 0);}
\DoxyCodeLine{05897\ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ maxs(reader-\/>get\_maxs(),\ 0);}
\DoxyCodeLine{05898\ \ \ \ \ \ \ nassertr(reader-\/>get\_mins()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size()\ \&\&}
\DoxyCodeLine{05899\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_maxs()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{05900\ }
\DoxyCodeLine{05901\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05902\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05903\ \ \ \ \ \ \ \ \ \_vertices\_trifan\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05904\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05905\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05906\ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_TRIANGLE\_FAN,\ ends[i]\ -\/\ start,}
\DoxyCodeLine{05907\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride,}
\DoxyCodeLine{05909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_instance\_count);}
\DoxyCodeLine{05910\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05911\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05912\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05913\ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_TRIANGLE\_FAN,}
\DoxyCodeLine{05914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mins.get\_data1i(),\ maxs.get\_data1i(),\ ends[i]\ -\/\ start,}
\DoxyCodeLine{05915\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05916\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride);}
\DoxyCodeLine{05917\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05918\ \ \ \ \ \ \ \ \ start\ =\ ends[i];}
\DoxyCodeLine{05919\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05920\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05921\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{05922\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_vertex\ =\ reader-\/>get\_first\_vertex();}
\DoxyCodeLine{05923\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{05924\ \ \ \ \ \ \ \ \ \_vertices\_trifan\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{05925\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05926\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05927\ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_TRIANGLE\_FAN,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,\ \_instance\_count);}
\DoxyCodeLine{05929\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05930\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05931\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{05932\ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_TRIANGLE\_FAN,\ first\_vertex\ +\ start,}
\DoxyCodeLine{05933\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start);}
\DoxyCodeLine{05934\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{05935\ \ \ \ \ \ \ \ \ start\ =\ ends[i];}
\DoxyCodeLine{05936\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05937\ \ \ \ \ \}}
\DoxyCodeLine{05938\ \ \ \}}
\DoxyCodeLine{05939\ }
\DoxyCodeLine{05940\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{05941\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{05942\ \}}
\DoxyCodeLine{05943\ }
\DoxyCodeLine{05948\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{05949\ draw\_patches(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{05950\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{05951\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{05952\ }
\DoxyCodeLine{05953\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{05954\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{05955\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_patches:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{05956\ \ \ \}}
\DoxyCodeLine{05957\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{05958\ }
\DoxyCodeLine{05959\ \ \ \textcolor{keywordflow}{if}\ (!get\_supports\_tessellation\_shaders())\ \{}
\DoxyCodeLine{05960\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05961\ \ \ \}}
\DoxyCodeLine{05962\ }
\DoxyCodeLine{05963\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{05964\ \ \ \_glPatchParameteri(GL\_PATCH\_VERTICES,\ ((\textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomPatches}{GeomPatches}}\ *)reader-\/>get\_object())-\/>get\_num\_vertices\_per\_primitive());}
\DoxyCodeLine{05965\ }
\DoxyCodeLine{05966\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05967\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{05968\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_PATCHES);}
\DoxyCodeLine{05969\ }
\DoxyCodeLine{05970\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05971\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{05972\ \ \ \{}
\DoxyCodeLine{05973\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{05974\ \ \ \ \ \_vertices\_patch\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{05975\ \ \ \ \ \_primitive\_batches\_patch\_pcollector.add\_level(1);}
\DoxyCodeLine{05976\ }
\DoxyCodeLine{05977\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{05978\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{05979\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{05980\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{05981\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05982\ }
\DoxyCodeLine{05983\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{05984\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{05985\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_PATCHES,\ num\_vertices,}
\DoxyCodeLine{05986\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05987\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{05988\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{05989\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{05990\ \ \ \ \ \ \ \{}
\DoxyCodeLine{05991\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_PATCHES,}
\DoxyCodeLine{05992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{05993\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{05994\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{05995\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{05996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{05997\ \ \ \ \ \ \ \}}
\DoxyCodeLine{05998\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{05999\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06000\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06001\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_PATCHES,}
\DoxyCodeLine{06002\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06003\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{06004\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06005\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06006\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06007\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_PATCHES,}
\DoxyCodeLine{06008\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{06010\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06011\ \ \ \ \ \}}
\DoxyCodeLine{06012\ \ \ \}}
\DoxyCodeLine{06013\ }
\DoxyCodeLine{06014\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{06015\ }
\DoxyCodeLine{06016\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06017\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06018\ \}}
\DoxyCodeLine{06019\ }
\DoxyCodeLine{06023\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06024\ draw\_lines(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{06025\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{06026\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{06027\ }
\DoxyCodeLine{06028\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06029\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06030\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_lines:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06031\ \ \ \}}
\DoxyCodeLine{06032\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{06033\ }
\DoxyCodeLine{06034\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06035\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{06036\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_LINES);}
\DoxyCodeLine{06037\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06038\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06039\ \ \ \{}
\DoxyCodeLine{06040\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{06041\ \ \ \ \ \_vertices\_other\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{06042\ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(1);}
\DoxyCodeLine{06043\ }
\DoxyCodeLine{06044\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{06045\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06046\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06047\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06048\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06049\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06050\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06051\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINES,\ num\_vertices,}
\DoxyCodeLine{06052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{06054\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06055\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06056\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06057\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINES,}
\DoxyCodeLine{06058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{06059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{06060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{06061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{06063\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06064\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06065\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06066\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06067\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_LINES,}
\DoxyCodeLine{06068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{06070\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06071\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06072\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06073\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_LINES,}
\DoxyCodeLine{06074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{06076\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06077\ \ \ \ \ \}}
\DoxyCodeLine{06078\ \ \ \}}
\DoxyCodeLine{06079\ }
\DoxyCodeLine{06080\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06081\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06082\ \}}
\DoxyCodeLine{06083\ }
\DoxyCodeLine{06087\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06088\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06089\ draw\_lines\_adj(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{06090\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{06091\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{06092\ }
\DoxyCodeLine{06093\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06094\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06095\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_lines\_adj:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06096\ \ \ \}}
\DoxyCodeLine{06097\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{06098\ }
\DoxyCodeLine{06099\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06100\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{06101\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_LINES\_ADJACENCY);}
\DoxyCodeLine{06102\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06103\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06104\ \ \ \{}
\DoxyCodeLine{06105\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{06106\ \ \ \ \ \_vertices\_other\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{06107\ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(1);}
\DoxyCodeLine{06108\ }
\DoxyCodeLine{06109\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{06110\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06111\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06112\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06113\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06114\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06115\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINES\_ADJACENCY,\ num\_vertices,}
\DoxyCodeLine{06116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{06118\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06119\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINES\_ADJACENCY,}
\DoxyCodeLine{06120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{06121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{06122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{06123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{06125\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06126\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06127\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06128\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_LINES\_ADJACENCY,}
\DoxyCodeLine{06129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{06131\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06132\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_LINES\_ADJACENCY,}
\DoxyCodeLine{06133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices);}
\DoxyCodeLine{06135\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06136\ \ \ \ \ \}}
\DoxyCodeLine{06137\ \ \ \}}
\DoxyCodeLine{06138\ }
\DoxyCodeLine{06139\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06140\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06141\ \}}
\DoxyCodeLine{06142\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{06143\ }
\DoxyCodeLine{06147\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06148\ draw\_linestrips(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{06149\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{06150\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{06151\ }
\DoxyCodeLine{06152\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06153\ }
\DoxyCodeLine{06154\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06155\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06156\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_linestrips:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06157\ \ \ \}}
\DoxyCodeLine{06158\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{06159\ }
\DoxyCodeLine{06160\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06161\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{06162\ \ \ \ \ draw\_immediate\_composite\_primitives(reader,\ GL\_LINE\_STRIP);}
\DoxyCodeLine{06163\ }
\DoxyCodeLine{06164\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06165\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06166\ \ \ \{}
\DoxyCodeLine{06167\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed()\ \&\&}
\DoxyCodeLine{06168\ \ \ \ \ \ \ \ \ (\_supported\_geom\_rendering\ \&\ GeomEnums::GR\_strip\_cut\_index)\ !=\ 0)\ \{}
\DoxyCodeLine{06169\ \ \ \ \ \ \ \textcolor{comment}{//\ One\ long\ triangle\ strip,\ connected\ by\ strip\ cut\ indices.}}
\DoxyCodeLine{06170\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06171\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{06172\ \ \ \ \ \ \ \ \ glEnable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{06173\ \ \ \ \ \ \ \ \ \_glPrimitiveRestartIndex(reader-\/>get\_strip\_cut\_index());}
\DoxyCodeLine{06174\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06175\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{06176\ }
\DoxyCodeLine{06177\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{06178\ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{06179\ \ \ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(1);}
\DoxyCodeLine{06180\ }
\DoxyCodeLine{06181\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06182\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06183\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06184\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06185\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06186\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06187\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINE\_STRIP,\ num\_vertices,}
\DoxyCodeLine{06188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{06190\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06191\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{06192\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06193\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINE\_STRIP,}
\DoxyCodeLine{06194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{06195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{06196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{06197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{06199\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06200\ }
\DoxyCodeLine{06201\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06202\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{06203\ \ \ \ \ \ \ \ \ glDisable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{06204\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06205\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{06206\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06207\ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ the\ individual\ line\ strips,\ stepping\ over\ the\ strip-\/cut\ indices.}}
\DoxyCodeLine{06208\ \ \ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{06209\ }
\DoxyCodeLine{06210\ \ \ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(ends.size());}
\DoxyCodeLine{06211\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{06212\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06213\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06214\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06215\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06216\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_stride\ =\ reader-\/>get\_index\_stride();}
\DoxyCodeLine{06217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ mins(reader-\/>get\_mins(),\ 0);}
\DoxyCodeLine{06218\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ maxs(reader-\/>get\_maxs(),\ 0);}
\DoxyCodeLine{06219\ \ \ \ \ \ \ \ \ nassertr(reader-\/>get\_mins()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size()\ \&\&}
\DoxyCodeLine{06220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_maxs()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{06221\ }
\DoxyCodeLine{06222\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{06223\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{06224\ \ \ \ \ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{06225\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06226\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06227\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINE\_STRIP,\ ends[i]\ -\/\ start,}
\DoxyCodeLine{06228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06229\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride,}
\DoxyCodeLine{06230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_instance\_count);}
\DoxyCodeLine{06231\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06232\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06233\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{06234\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINE\_STRIP,}
\DoxyCodeLine{06235\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mins.get\_data1i(),\ maxs.get\_data1i(),}
\DoxyCodeLine{06236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,}
\DoxyCodeLine{06237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride);}
\DoxyCodeLine{06239\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06240\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{06241\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06242\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06243\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{06244\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_vertex\ =\ reader-\/>get\_first\_vertex();}
\DoxyCodeLine{06245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{06246\ \ \ \ \ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{06247\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06248\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06249\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_LINE\_STRIP,\ first\_vertex\ +\ start,}
\DoxyCodeLine{06250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,\ \_instance\_count);}
\DoxyCodeLine{06251\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06252\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06253\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{06254\ \ \ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_LINE\_STRIP,\ first\_vertex\ +\ start,\ ends[i]\ -\/\ start);}
\DoxyCodeLine{06255\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06256\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{06257\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06258\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06259\ \ \ \ \ \}}
\DoxyCodeLine{06260\ \ \ \}}
\DoxyCodeLine{06261\ }
\DoxyCodeLine{06262\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06263\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06264\ \}}
\DoxyCodeLine{06265\ }
\DoxyCodeLine{06269\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06270\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06271\ draw\_linestrips\_adj(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{06272\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{06273\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{06274\ }
\DoxyCodeLine{06275\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06276\ }
\DoxyCodeLine{06277\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06278\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06279\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_linestrips\_adj:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06280\ \ \ \}}
\DoxyCodeLine{06281\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{06282\ }
\DoxyCodeLine{06283\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06284\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{06285\ \ \ \ \ draw\_immediate\_composite\_primitives(reader,\ GL\_LINE\_STRIP\_ADJACENCY);}
\DoxyCodeLine{06286\ }
\DoxyCodeLine{06287\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06288\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06289\ \ \ \{}
\DoxyCodeLine{06290\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed()\ \&\&}
\DoxyCodeLine{06291\ \ \ \ \ \ \ \ \ (\_supported\_geom\_rendering\ \&\ GeomEnums::GR\_strip\_cut\_index)\ !=\ 0)\ \{}
\DoxyCodeLine{06292\ \ \ \ \ \ \ \textcolor{comment}{//\ One\ long\ line\ strip,\ connected\ by\ strip\ cut\ indices.}}
\DoxyCodeLine{06293\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{06294\ \ \ \ \ \ \ \ \ glEnable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{06295\ \ \ \ \ \ \ \ \ \_glPrimitiveRestartIndex(reader-\/>get\_strip\_cut\_index());}
\DoxyCodeLine{06296\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06297\ }
\DoxyCodeLine{06298\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{06299\ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{06300\ \ \ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(1);}
\DoxyCodeLine{06301\ }
\DoxyCodeLine{06302\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06303\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06305\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06306\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06307\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINE\_STRIP\_ADJACENCY,\ num\_vertices,}
\DoxyCodeLine{06308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{06310\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06311\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{06312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{06313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{06314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{06315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{06317\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06318\ }
\DoxyCodeLine{06319\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_explicit\_primitive\_restart)\ \{}
\DoxyCodeLine{06320\ \ \ \ \ \ \ \ \ glDisable(GL\_PRIMITIVE\_RESTART);}
\DoxyCodeLine{06321\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06322\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06323\ \ \ \ \ \ \ \textcolor{comment}{//\ Send\ the\ individual\ line\ strips,\ stepping\ over\ the\ strip-\/cut\ indices.}}
\DoxyCodeLine{06324\ \ \ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{06325\ }
\DoxyCodeLine{06326\ \ \ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(ends.size());}
\DoxyCodeLine{06327\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{06328\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06330\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06331\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06332\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\_stride\ =\ reader-\/>get\_index\_stride();}
\DoxyCodeLine{06333\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ mins(reader-\/>get\_mins(),\ 0);}
\DoxyCodeLine{06334\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ maxs(reader-\/>get\_maxs(),\ 0);}
\DoxyCodeLine{06335\ \ \ \ \ \ \ \ \ nassertr(reader-\/>get\_mins()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size()\ \&\&}
\DoxyCodeLine{06336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_maxs()-\/>get\_num\_rows()\ ==\ (\textcolor{keywordtype}{int})ends.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{06337\ }
\DoxyCodeLine{06338\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{06339\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{06340\ \ \ \ \ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{06341\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06342\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_LINE\_STRIP\_ADJACENCY,\ ends[i]\ -\/\ start,}
\DoxyCodeLine{06343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride,}
\DoxyCodeLine{06345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_instance\_count);}
\DoxyCodeLine{06346\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06347\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_LINE\_STRIP\_ADJACENCY,}
\DoxyCodeLine{06348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mins.get\_data1i(),\ maxs.get\_data1i(),}
\DoxyCodeLine{06349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,}
\DoxyCodeLine{06350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer\ +\ start\ *\ index\_stride);}
\DoxyCodeLine{06352\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06353\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{06354\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06355\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06356\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ start\ =\ 0;}
\DoxyCodeLine{06357\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ first\_vertex\ =\ reader-\/>get\_first\_vertex();}
\DoxyCodeLine{06358\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ ends.size();\ i++)\ \{}
\DoxyCodeLine{06359\ \ \ \ \ \ \ \ \ \ \ \_vertices\_other\_pcollector.add\_level(ends[i]\ -\/\ start);}
\DoxyCodeLine{06360\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06361\ \ \ \ \ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_LINE\_STRIP\_ADJACENCY,\ first\_vertex\ +\ start,}
\DoxyCodeLine{06362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ends[i]\ -\/\ start,\ \_instance\_count);}
\DoxyCodeLine{06363\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06364\ \ \ \ \ \ \ \ \ \ \ \ \ glDrawArrays(GL\_LINE\_STRIP\_ADJACENCY,\ first\_vertex\ +\ start,\ ends[i]\ -\/\ start);}
\DoxyCodeLine{06365\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06366\ \ \ \ \ \ \ \ \ \ \ start\ =\ ends[i]\ +\ 1;}
\DoxyCodeLine{06367\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{06368\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06369\ \ \ \ \ \}}
\DoxyCodeLine{06370\ \ \ \}}
\DoxyCodeLine{06371\ }
\DoxyCodeLine{06372\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06373\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06374\ \}}
\DoxyCodeLine{06375\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{06376\ }
\DoxyCodeLine{06380\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06381\ draw\_points(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{06382\ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_primitive\_pcollector,}}
\DoxyCodeLine{06383\ \ \ \textcolor{comment}{//\ reader-\/>get\_current\_thread());}}
\DoxyCodeLine{06384\ }
\DoxyCodeLine{06385\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06386\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06387\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}draw\_points:\ "{}}\ <<\ *(reader-\/>get\_object())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06388\ \ \ \}}
\DoxyCodeLine{06389\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{06390\ }
\DoxyCodeLine{06391\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06392\ \ \ \textcolor{keywordflow}{if}\ (\_use\_sender)\ \{}
\DoxyCodeLine{06393\ \ \ \ \ draw\_immediate\_simple\_primitives(reader,\ GL\_POINTS);}
\DoxyCodeLine{06394\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06395\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{06396\ \ \ \{}
\DoxyCodeLine{06397\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{06398\ \ \ \ \ \_vertices\_other\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{06399\ \ \ \ \ \_primitive\_batches\_other\_pcollector.add\_level(1);}
\DoxyCodeLine{06400\ }
\DoxyCodeLine{06401\ \ \ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{06402\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer;}
\DoxyCodeLine{06403\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!setup\_primitive(client\_pointer,\ reader,\ force))\ \{}
\DoxyCodeLine{06404\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06405\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06406\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06407\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06408\ \ \ \ \ \ \ \ \ \_glDrawElementsInstanced(GL\_POINTS,\ num\_vertices,}
\DoxyCodeLine{06409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer,\ \_instance\_count);}
\DoxyCodeLine{06411\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06412\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06413\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06414\ \ \ \ \ \ \ \ \ \_glDrawRangeElements(GL\_POINTS,}
\DoxyCodeLine{06415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_min\_vertex(),}
\DoxyCodeLine{06416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_max\_vertex(),}
\DoxyCodeLine{06417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,}
\DoxyCodeLine{06418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_numeric\_type(reader-\/>get\_index\_type()),}
\DoxyCodeLine{06419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{06420\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06421\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06422\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06423\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_instance\_count\ !=\ 1)\ \{}
\DoxyCodeLine{06424\ \ \ \ \ \ \ \ \ \_glDrawArraysInstanced(GL\_POINTS,}
\DoxyCodeLine{06425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ reader-\/>get\_first\_vertex(),}
\DoxyCodeLine{06426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_vertices,\ \_instance\_count);}
\DoxyCodeLine{06427\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{06428\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06429\ \ \ \ \ \ \ \{}
\DoxyCodeLine{06430\ \ \ \ \ \ \ \ \ glDrawArrays(GL\_POINTS,\ reader-\/>get\_first\_vertex(),\ num\_vertices);}
\DoxyCodeLine{06431\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06432\ \ \ \ \ \}}
\DoxyCodeLine{06433\ \ \ \}}
\DoxyCodeLine{06434\ }
\DoxyCodeLine{06435\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06436\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06437\ \}}
\DoxyCodeLine{06438\ }
\DoxyCodeLine{06443\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06444\ end\_draw\_primitives()\ \{}
\DoxyCodeLine{06445\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ \&\&\ defined(SUPPORT\_FIXED\_FUNCTION)\ \ }\textcolor{comment}{//\ Display\ lists\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{06446\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ \_geom\_display\_list\ !=\ 0)\ \{}
\DoxyCodeLine{06447\ \ \ \ \ \textcolor{comment}{//\ If\ we\ were\ building\ a\ display\ list,\ close\ it\ now.}}
\DoxyCodeLine{06448\ \ \ \ \ glEndList();}
\DoxyCodeLine{06449\ \ \ \ \ \_load\_display\_list\_pcollector.stop();}
\DoxyCodeLine{06450\ }
\DoxyCodeLine{06451\ \ \ \ \ \textcolor{keywordflow}{if}\ (!gl\_compile\_and\_execute)\ \{}
\DoxyCodeLine{06452\ \ \ \ \ \ \ glCallList(\_geom\_display\_list);}
\DoxyCodeLine{06453\ \ \ \ \ \}}
\DoxyCodeLine{06454\ \ \ \ \ \_primitive\_batches\_display\_list\_pcollector.add\_level(1);}
\DoxyCodeLine{06455\ \ \ \}}
\DoxyCodeLine{06456\ \ \ \_geom\_display\_list\ =\ 0;}
\DoxyCodeLine{06457\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06458\ }
\DoxyCodeLine{06459\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{06460\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ \_transform\_stale)\ \{}
\DoxyCodeLine{06461\ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{06462\ \ \ \ \ call\_glLoadMatrix(\_internal\_transform-\/>get\_mat());}
\DoxyCodeLine{06463\ \ \ \}}
\DoxyCodeLine{06464\ }
\DoxyCodeLine{06465\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ \&\&\ \_data\_reader-\/>is\_vertex\_transformed())\ \{}
\DoxyCodeLine{06466\ \ \ \ \ \textcolor{comment}{//\ Restore\ the\ matrices\ that\ we\ pushed\ above.}}
\DoxyCodeLine{06467\ \ \ \ \ glMatrixMode(GL\_PROJECTION);}
\DoxyCodeLine{06468\ \ \ \ \ glPopMatrix();}
\DoxyCodeLine{06469\ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{06470\ \ \ \ \ glPopMatrix();}
\DoxyCodeLine{06471\ \ \ \}}
\DoxyCodeLine{06472\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06473\ }
\DoxyCodeLine{06474\ \ \ \mbox{\hyperlink{classGraphicsStateGuardian_afb3b42dedbfe034a5dffa5b9464fcb64}{GraphicsStateGuardian::end\_draw\_primitives}}();}
\DoxyCodeLine{06475\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{06476\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06477\ \}}
\DoxyCodeLine{06478\ }
\DoxyCodeLine{06479\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06484\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06485\ issue\_memory\_barrier(GLbitfield\ barriers)\ \{}
\DoxyCodeLine{06486\ \ \ \textcolor{keywordflow}{if}\ (!gl\_enable\_memory\_barriers\ ||\ \_glMemoryBarrier\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06487\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{06488\ \ \ \}}
\DoxyCodeLine{06489\ }
\DoxyCodeLine{06490\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_memory\_barrier\_pcollector);}
\DoxyCodeLine{06491\ }
\DoxyCodeLine{06492\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06493\ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}Issuing\ memory\ barriers:"{}};}
\DoxyCodeLine{06494\ \ \ \}}
\DoxyCodeLine{06495\ }
\DoxyCodeLine{06496\ \ \ \_glMemoryBarrier(barriers);}
\DoxyCodeLine{06497\ }
\DoxyCodeLine{06498\ \ \ \textcolor{comment}{//\ Increment\ these\ counters\ to\ indicate\ that\ these\ barriers\ have\ been\ issued.}}
\DoxyCodeLine{06499\ \ \ \textcolor{keywordflow}{if}\ (barriers\ \&\ GL\_TEXTURE\_FETCH\_BARRIER\_BIT)\ \{}
\DoxyCodeLine{06500\ \ \ \ \ ++\_texture\_fetch\_barrier\_counter;}
\DoxyCodeLine{06501\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ texture\_fetch"{}};}
\DoxyCodeLine{06502\ \ \ \}}
\DoxyCodeLine{06503\ }
\DoxyCodeLine{06504\ \ \ \textcolor{keywordflow}{if}\ (barriers\ \&\ GL\_SHADER\_IMAGE\_ACCESS\_BARRIER\_BIT)\ \{}
\DoxyCodeLine{06505\ \ \ \ \ ++\_shader\_image\_access\_barrier\_counter;}
\DoxyCodeLine{06506\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ shader\_image\_access"{}};}
\DoxyCodeLine{06507\ \ \ \}}
\DoxyCodeLine{06508\ }
\DoxyCodeLine{06509\ \ \ \textcolor{keywordflow}{if}\ (barriers\ \&\ GL\_TEXTURE\_UPDATE\_BARRIER\_BIT)\ \{}
\DoxyCodeLine{06510\ \ \ \ \ ++\_texture\_update\_barrier\_counter;}
\DoxyCodeLine{06511\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ texture\_update"{}};}
\DoxyCodeLine{06512\ \ \ \}}
\DoxyCodeLine{06513\ }
\DoxyCodeLine{06514\ \ \ \textcolor{keywordflow}{if}\ (barriers\ \&\ GL\_FRAMEBUFFER\_BARRIER\_BIT)\ \{}
\DoxyCodeLine{06515\ \ \ \ \ ++\_framebuffer\_barrier\_counter;}
\DoxyCodeLine{06516\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ framebuffer"{}};}
\DoxyCodeLine{06517\ \ \ \}}
\DoxyCodeLine{06518\ }
\DoxyCodeLine{06519\ \ \ \textcolor{keywordflow}{if}\ (barriers\ \&\ GL\_SHADER\_STORAGE\_BARRIER\_BIT)\ \{}
\DoxyCodeLine{06520\ \ \ \ \ ++\_shader\_storage\_barrier\_counter;}
\DoxyCodeLine{06521\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ shader\_storage"{}};}
\DoxyCodeLine{06522\ \ \ \}}
\DoxyCodeLine{06523\ }
\DoxyCodeLine{06524\ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06525\ }
\DoxyCodeLine{06526\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06527\ \}}
\DoxyCodeLine{06528\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{06529\ }
\DoxyCodeLine{06540\ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06541\ prepare\_texture(\mbox{\hyperlink{classTexture}{Texture}}\ *tex)\ \{}
\DoxyCodeLine{06542\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_texture\_pcollector);}
\DoxyCodeLine{06543\ }
\DoxyCodeLine{06544\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06545\ \ \ \textcolor{comment}{//\ Make\ sure\ we'll\ support\ this\ texture\ when\ it's\ rendered.\ \ Don't\ bother\ to}}
\DoxyCodeLine{06546\ \ \ \textcolor{comment}{//\ prepare\ it\ if\ we\ won't.}}
\DoxyCodeLine{06547\ \ \ Texture::TextureType\ texture\_type\ =\ tex-\/>get\_texture\_type();}
\DoxyCodeLine{06548\ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{06549\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_3d\_texture:}
\DoxyCodeLine{06550\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{06551\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{06552\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}3-\/D\ textures\ are\ not\ supported\ by\ this\ OpenGL\ driver.\(\backslash\)n"{}};}
\DoxyCodeLine{06553\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06554\ \ \ \ \ \}}
\DoxyCodeLine{06555\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06556\ }
\DoxyCodeLine{06557\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture\_array:}
\DoxyCodeLine{06558\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{06559\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{06560\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}2-\/D\ texture\ arrays\ are\ not\ supported\ by\ this\ OpenGL\ driver.\(\backslash\)n"{}};}
\DoxyCodeLine{06561\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06562\ \ \ \ \ \}}
\DoxyCodeLine{06563\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06564\ }
\DoxyCodeLine{06565\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map:}
\DoxyCodeLine{06566\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_cube\_map)\ \{}
\DoxyCodeLine{06567\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{06568\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cube\ map\ textures\ are\ not\ supported\ by\ this\ OpenGL\ driver.\(\backslash\)n"{}};}
\DoxyCodeLine{06569\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06570\ \ \ \ \ \}}
\DoxyCodeLine{06571\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06572\ }
\DoxyCodeLine{06573\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_buffer\_texture:}
\DoxyCodeLine{06574\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffer\_texture)\ \{}
\DoxyCodeLine{06575\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{06576\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Buffer\ textures\ are\ not\ supported\ by\ this\ OpenGL\ driver.\(\backslash\)n"{}};}
\DoxyCodeLine{06577\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06578\ \ \ \ \ \}}
\DoxyCodeLine{06579\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06580\ }
\DoxyCodeLine{06581\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map\_array:}
\DoxyCodeLine{06582\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_cube\_map\_array)\ \{}
\DoxyCodeLine{06583\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{06584\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cube\ map\ arrays\ are\ not\ supported\ by\ this\ OpenGL\ driver.\(\backslash\)n"{}};}
\DoxyCodeLine{06585\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06586\ \ \ \ \ \}}
\DoxyCodeLine{06587\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06588\ }
\DoxyCodeLine{06589\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06590\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06591\ \ \ \}}
\DoxyCodeLine{06592\ }
\DoxyCodeLine{06593\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})(\textcolor{keyword}{this},\ \_prepared\_objects,\ tex);}
\DoxyCodeLine{06594\ }
\DoxyCodeLine{06595\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ have\ an\ index\ so\ that\ get\_native\_id()\ will\ already\ work.}}
\DoxyCodeLine{06596\ \ \ GLenum\ target\ =\ get\_texture\_target(texture\_type);}
\DoxyCodeLine{06597\ \ \ gtc-\/>reset\_data(target,\ 1);}
\DoxyCodeLine{06598\ }
\DoxyCodeLine{06599\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06600\ }
\DoxyCodeLine{06601\ \ \ \textcolor{keywordflow}{return}\ gtc;}
\DoxyCodeLine{06602\ \}}
\DoxyCodeLine{06603\ }
\DoxyCodeLine{06614\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06615\ update\_texture(\mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc,\ bool\ force,\ \mbox{\hyperlink{classCompletionToken}{CompletionToken}}\ token)\ \{}
\DoxyCodeLine{06616\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc;}
\DoxyCodeLine{06617\ \ \ DCAST\_INTO\_R(gtc,\ tc,\ \textcolor{keyword}{false});}
\DoxyCodeLine{06618\ }
\DoxyCodeLine{06619\ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>was\_image\_modified()\ ||\ !gtc-\/>\_has\_storage)\ \{}
\DoxyCodeLine{06620\ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_texture\_update\_pcollector);}
\DoxyCodeLine{06621\ }
\DoxyCodeLine{06622\ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ image\ was\ modified,\ reload\ the\ texture.}}
\DoxyCodeLine{06623\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ tc-\/>get\_texture();}
\DoxyCodeLine{06624\ \ \ \ \ \textcolor{keywordtype}{bool}\ okflag\ =\ upload\_texture(gtc,\ force,\ tex-\/>uses\_mipmaps(),\ std::move(token));}
\DoxyCodeLine{06625\ \ \ \ \ \textcolor{keywordflow}{if}\ (!okflag)\ \{}
\DoxyCodeLine{06626\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06627\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ load\ "{}}\ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06628\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06629\ \ \ \ \ \}}
\DoxyCodeLine{06630\ }
\DoxyCodeLine{06631\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>was\_properties\_modified())\ \{}
\DoxyCodeLine{06632\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ gtc-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{06633\ \ \ \ \ \ \ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{06634\ \ \ \ \ \ \ \ \ specify\_texture(gtc,\ tex-\/>get\_default\_sampler());}
\DoxyCodeLine{06635\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06636\ \ \ \ \ \}}
\DoxyCodeLine{06637\ \ \ \}}
\DoxyCodeLine{06638\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (gtc-\/>was\_properties\_modified())\ \{}
\DoxyCodeLine{06639\ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_texture\_update\_pcollector);}
\DoxyCodeLine{06640\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ tc-\/>get\_texture();}
\DoxyCodeLine{06641\ }
\DoxyCodeLine{06642\ \ \ \ \ \textcolor{comment}{//\ If\ only\ the\ properties\ have\ been\ modified,\ we\ don't\ necessarily\ need\ to}}
\DoxyCodeLine{06643\ \ \ \ \ \textcolor{comment}{//\ reload\ the\ texture.}}
\DoxyCodeLine{06644\ \ \ \ \ \textcolor{keywordtype}{bool}\ needs\_reload\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{06645\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ gtc-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{06646\ \ \ \ \ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{06647\ }
\DoxyCodeLine{06648\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (specify\_texture(gtc,\ tex-\/>get\_default\_sampler()))\ \{}
\DoxyCodeLine{06649\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Actually,\ looks\ like\ the\ texture\ *does*\ need\ to\ be\ reloaded.}}
\DoxyCodeLine{06650\ \ \ \ \ \ \ \ \ needs\_reload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06651\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06652\ \ \ \ \ \}}
\DoxyCodeLine{06653\ }
\DoxyCodeLine{06654\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{06655\ \ \ \ \ \ \ gtc-\/>mark\_needs\_reload();}
\DoxyCodeLine{06656\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ okflag\ =\ upload\_texture(gtc,\ force,\ tex-\/>uses\_mipmaps(),\ std::move(token));}
\DoxyCodeLine{06657\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!okflag)\ \{}
\DoxyCodeLine{06658\ \ \ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06659\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ load\ "{}}\ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{06661\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06662\ \ \ \ \ \}}
\DoxyCodeLine{06663\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06664\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ texture\ didn't\ need\ reloading,\ but\ mark\ it\ fully\ updated\ now.}}
\DoxyCodeLine{06665\ \ \ \ \ \ \ gtc-\/>mark\_loaded();}
\DoxyCodeLine{06666\ }
\DoxyCodeLine{06667\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (force)\ \{}
\DoxyCodeLine{06668\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ update\ is\ still\ underway.}}
\DoxyCodeLine{06669\ \ \ \ \ \ \ \ \ gtc-\/>wait\_pending\_uploads();}
\DoxyCodeLine{06670\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06671\ \ \ \ \ \ \ token.complete(\textcolor{keyword}{true});}
\DoxyCodeLine{06672\ \ \ \ \ \}}
\DoxyCodeLine{06673\ \ \ \}}
\DoxyCodeLine{06674\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06675\ \ \ \ \ \textcolor{keywordflow}{if}\ (force)\ \{}
\DoxyCodeLine{06676\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ update\ is\ still\ underway.}}
\DoxyCodeLine{06677\ \ \ \ \ \ \ gtc-\/>wait\_pending\_uploads();}
\DoxyCodeLine{06678\ \ \ \ \ \}}
\DoxyCodeLine{06679\ \ \ \ \ token.complete(\textcolor{keyword}{true});}
\DoxyCodeLine{06680\ \ \ \}}
\DoxyCodeLine{06681\ }
\DoxyCodeLine{06682\ \ \ gtc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{06683\ }
\DoxyCodeLine{06684\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06685\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{06686\ \}}
\DoxyCodeLine{06687\ }
\DoxyCodeLine{06693\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06694\ release\_texture(\mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc)\ \{}
\DoxyCodeLine{06695\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ DCAST(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}}),\ tc);}
\DoxyCodeLine{06696\ }
\DoxyCodeLine{06697\ \ \ gtc-\/>cancel\_pending\_uploads();}
\DoxyCodeLine{06698\ \ \ gtc-\/>wait\_pending\_uploads();}
\DoxyCodeLine{06699\ \ \ gtc-\/>delete\_unused\_pbos();}
\DoxyCodeLine{06700\ }
\DoxyCodeLine{06701\ \ \ gtc-\/>set\_num\_views(0);}
\DoxyCodeLine{06702\ \ \ \textcolor{keyword}{delete}\ gtc;}
\DoxyCodeLine{06703\ \}}
\DoxyCodeLine{06704\ }
\DoxyCodeLine{06710\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06711\ release\_textures(const\ \mbox{\hyperlink{classpvector}{pvector}}<\mbox{\hyperlink{classTextureContext}{TextureContext}}\ *>\ \&contexts)\ \{}
\DoxyCodeLine{06712\ \ \ \textcolor{keywordflow}{if}\ (contexts.empty())\ \{}
\DoxyCodeLine{06713\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{06714\ \ \ \}}
\DoxyCodeLine{06715\ }
\DoxyCodeLine{06716\ \ \ \textcolor{keywordtype}{size\_t}\ num\_indices\ =\ 0;}
\DoxyCodeLine{06717\ \ \ \textcolor{keywordtype}{size\_t}\ num\_buffers\ =\ 0;}
\DoxyCodeLine{06718\ }
\DoxyCodeLine{06719\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ :\ contexts)\ \{}
\DoxyCodeLine{06720\ \ \ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ DCAST(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}}),\ tc);}
\DoxyCodeLine{06721\ }
\DoxyCodeLine{06722\ \ \ \ \ num\_indices\ +=\ gtc-\/>\_num\_views;}
\DoxyCodeLine{06723\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_buffers\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06724\ \ \ \ \ \ \ num\_buffers\ +=\ gtc-\/>\_num\_views;}
\DoxyCodeLine{06725\ \ \ \ \ \}}
\DoxyCodeLine{06726\ \ \ \}}
\DoxyCodeLine{06727\ }
\DoxyCodeLine{06728\ \ \ GLuint\ *indices\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint)\ *\ num\_indices);}
\DoxyCodeLine{06729\ \ \ GLuint\ *buffers\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint)\ *\ num\_buffers);}
\DoxyCodeLine{06730\ \ \ num\_indices\ =\ 0;}
\DoxyCodeLine{06731\ \ \ num\_buffers\ =\ 0;}
\DoxyCodeLine{06732\ }
\DoxyCodeLine{06733\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ :\ contexts)\ \{}
\DoxyCodeLine{06734\ \ \ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ (CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *)tc;}
\DoxyCodeLine{06735\ }
\DoxyCodeLine{06736\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ gtc-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{06737\ \ \ \ \ \ \ indices[num\_indices++]\ =\ gtc-\/>\_indices[view];}
\DoxyCodeLine{06738\ }
\DoxyCodeLine{06739\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_buffers\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{06740\ \ \ \ \ \ \ \ \ buffers[num\_buffers++]\ =\ gtc-\/>\_buffers[view];}
\DoxyCodeLine{06741\ \ \ \ \ \ \ \}}
\DoxyCodeLine{06742\ \ \ \ \ \}}
\DoxyCodeLine{06743\ \ \ \ \ gtc-\/>\_num\_views\ =\ 0;}
\DoxyCodeLine{06744\ }
\DoxyCodeLine{06745\ \ \ \ \ \textcolor{keyword}{delete}\ gtc;}
\DoxyCodeLine{06746\ \ \ \}}
\DoxyCodeLine{06747\ }
\DoxyCodeLine{06748\ }
\DoxyCodeLine{06749\ \ \ glDeleteTextures(num\_indices,\ indices);}
\DoxyCodeLine{06750\ }
\DoxyCodeLine{06751\ \ \ \textcolor{keywordflow}{if}\ (num\_buffers\ >\ 0)\ \{}
\DoxyCodeLine{06752\ \ \ \ \ \_glDeleteBuffers(num\_buffers,\ buffers);}
\DoxyCodeLine{06753\ \ \ \}}
\DoxyCodeLine{06754\ \}}
\DoxyCodeLine{06755\ }
\DoxyCodeLine{06764\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06765\ extract\_texture\_data(\mbox{\hyperlink{classTexture}{Texture}}\ *tex)\ \{}
\DoxyCodeLine{06766\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06767\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ error\ stack\ is\ cleared\ out\ before\ we\ begin.}}
\DoxyCodeLine{06768\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06769\ }
\DoxyCodeLine{06770\ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ tex-\/>\mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{prepare\_now}}(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{06771\ \ \ nassertr(tc\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{06772\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ DCAST(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}}),\ tc);}
\DoxyCodeLine{06773\ }
\DoxyCodeLine{06774\ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{06775\ }
\DoxyCodeLine{06776\ \ \ \textcolor{keywordtype}{int}\ num\_views\ =\ tex-\/>get\_num\_views();}
\DoxyCodeLine{06777\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ num\_views;\ ++view)\ \{}
\DoxyCodeLine{06778\ \ \ \ \ GLuint\ index\ =\ gtc-\/>get\_view\_index(view);}
\DoxyCodeLine{06779\ \ \ \ \ glBindTexture(target,\ index);}
\DoxyCodeLine{06780\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06781\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{06782\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(0x"{}}\ <<\ hex\ <<\ target\ <<\ dec\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}}
\DoxyCodeLine{06783\ \ \ \ \ \ \ \ \ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{06784\ \ \ \ \ \}}
\DoxyCodeLine{06785\ }
\DoxyCodeLine{06786\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06787\ \ \ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{06788\ \ \ \ \ \ \ \_glBindBuffer(GL\_TEXTURE\_BUFFER,\ gtc-\/>get\_view\_buffer(view));}
\DoxyCodeLine{06789\ \ \ \ \ \}}
\DoxyCodeLine{06790\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06791\ }
\DoxyCodeLine{06792\ \ \ \ \ \textcolor{keywordflow}{if}\ (!do\_extract\_texture\_data(gtc,\ view))\ \{}
\DoxyCodeLine{06793\ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{06794\ \ \ \ \ \}}
\DoxyCodeLine{06795\ \ \ \}}
\DoxyCodeLine{06796\ }
\DoxyCodeLine{06797\ \ \ glBindTexture(target,\ 0);}
\DoxyCodeLine{06798\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{06799\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{06800\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(0x"{}}\ <<\ hex\ <<\ target\ <<\ dec\ <<\ \textcolor{stringliteral}{"{},\ 0)\(\backslash\)n"{}};}
\DoxyCodeLine{06801\ \ \ \}}
\DoxyCodeLine{06802\ }
\DoxyCodeLine{06803\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06804\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{06805\ \ \ \ \ \_glBindBuffer(GL\_TEXTURE\_BUFFER,\ 0);}
\DoxyCodeLine{06806\ \ \ \}}
\DoxyCodeLine{06807\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06808\ }
\DoxyCodeLine{06809\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{06810\ \}}
\DoxyCodeLine{06811\ }
\DoxyCodeLine{06812\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06823\ \mbox{\hyperlink{classSamplerContext}{SamplerContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06824\ prepare\_sampler(const\ \mbox{\hyperlink{classSamplerState}{SamplerState}}\ \&sampler)\ \{}
\DoxyCodeLine{06825\ \ \ nassertr(\_supports\_sampler\_objects,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{06826\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_sampler\_pcollector);}
\DoxyCodeLine{06827\ }
\DoxyCodeLine{06828\ \ \ CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}})\ *gsc\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}})(\textcolor{keyword}{this},\ sampler);}
\DoxyCodeLine{06829\ \ \ GLuint\ index\ =\ gsc-\/>\_index;}
\DoxyCodeLine{06830\ }
\DoxyCodeLine{06831\ \ \ \textcolor{comment}{//\ Sampler\ contexts\ are\ immutable\ in\ Panda,\ so\ might\ as\ well\ just\ initialize}}
\DoxyCodeLine{06832\ \ \ \textcolor{comment}{//\ all\ the\ settings\ here.}}
\DoxyCodeLine{06833\ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_WRAP\_S,}
\DoxyCodeLine{06834\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_u()));}
\DoxyCodeLine{06835\ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_WRAP\_T,}
\DoxyCodeLine{06836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_v()));}
\DoxyCodeLine{06837\ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_WRAP\_R,}
\DoxyCodeLine{06838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_w()));}
\DoxyCodeLine{06839\ }
\DoxyCodeLine{06840\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06841\ \textcolor{preprocessor}{\#ifdef\ STDFLOAT\_DOUBLE}}
\DoxyCodeLine{06842\ \ \ LVecBase4f\ fvalue\ =\ LCAST(\textcolor{keywordtype}{float},\ sampler.get\_border\_color());}
\DoxyCodeLine{06843\ \ \ \_glSamplerParameterfv(index,\ GL\_TEXTURE\_BORDER\_COLOR,\ fvalue.get\_data());}
\DoxyCodeLine{06844\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{06845\ \ \ \_glSamplerParameterfv(index,\ GL\_TEXTURE\_BORDER\_COLOR,}
\DoxyCodeLine{06846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sampler.get\_border\_color().get\_data());}
\DoxyCodeLine{06847\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06848\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{06849\ }
\DoxyCodeLine{06850\ \ \ SamplerState::FilterType\ minfilter\ =\ sampler.get\_effective\_minfilter();}
\DoxyCodeLine{06851\ \ \ SamplerState::FilterType\ magfilter\ =\ sampler.get\_effective\_magfilter();}
\DoxyCodeLine{06852\ \ \ \textcolor{keywordtype}{bool}\ uses\_mipmaps\ =\ SamplerState::is\_mipmap(minfilter)\ \&\&\ !gl\_ignore\_mipmaps;}
\DoxyCodeLine{06853\ }
\DoxyCodeLine{06854\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{06855\ \ \ \textcolor{keywordflow}{if}\ (gl\_force\_mipmaps)\ \{}
\DoxyCodeLine{06856\ \ \ \ \ minfilter\ =\ SamplerState::FT\_linear\_mipmap\_linear;}
\DoxyCodeLine{06857\ \ \ \ \ magfilter\ =\ SamplerState::FT\_linear;}
\DoxyCodeLine{06858\ \ \ \ \ uses\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{06859\ \ \ \}}
\DoxyCodeLine{06860\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06861\ }
\DoxyCodeLine{06862\ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_MIN\_FILTER,}
\DoxyCodeLine{06863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_filter\_type(minfilter,\ !uses\_mipmaps));}
\DoxyCodeLine{06864\ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_MAG\_FILTER,}
\DoxyCodeLine{06865\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_filter\_type(magfilter,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{06866\ }
\DoxyCodeLine{06867\ \ \ \textcolor{comment}{//\ Set\ anisotropic\ filtering.}}
\DoxyCodeLine{06868\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_anisotropy)\ \{}
\DoxyCodeLine{06869\ \ \ \ \ PN\_stdfloat\ anisotropy\ =\ sampler.get\_effective\_anisotropic\_degree();}
\DoxyCodeLine{06870\ \ \ \ \ anisotropy\ =\ min(anisotropy,\ \_max\_anisotropy);}
\DoxyCodeLine{06871\ \ \ \ \ anisotropy\ =\ max(anisotropy,\ (PN\_stdfloat)1.0);}
\DoxyCodeLine{06872\ \ \ \ \ \_glSamplerParameterf(index,\ GL\_TEXTURE\_MAX\_ANISOTROPY\_EXT,\ anisotropy);}
\DoxyCodeLine{06873\ \ \ \}}
\DoxyCodeLine{06874\ }
\DoxyCodeLine{06875\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_shadow\_filter)\ \{}
\DoxyCodeLine{06876\ \ \ \ \ \textcolor{keywordflow}{if}\ ((sampler.get\_magfilter()\ ==\ SamplerState::FT\_shadow)\ ||}
\DoxyCodeLine{06877\ \ \ \ \ \ \ \ \ (sampler.get\_minfilter()\ ==\ SamplerState::FT\_shadow))\ \{}
\DoxyCodeLine{06878\ \ \ \ \ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_COMPARE\_MODE\_ARB,\ GL\_COMPARE\_R\_TO\_TEXTURE\_ARB);}
\DoxyCodeLine{06879\ \ \ \ \ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_COMPARE\_FUNC\_ARB,\ GL\_LEQUAL);}
\DoxyCodeLine{06880\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06881\ \ \ \ \ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_COMPARE\_MODE\_ARB,\ GL\_NONE);}
\DoxyCodeLine{06882\ \ \ \ \ \ \ \_glSamplerParameteri(index,\ GL\_TEXTURE\_COMPARE\_FUNC\_ARB,\ GL\_LEQUAL);}
\DoxyCodeLine{06883\ \ \ \ \ \}}
\DoxyCodeLine{06884\ \ \ \}}
\DoxyCodeLine{06885\ }
\DoxyCodeLine{06886\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_lod)\ \{}
\DoxyCodeLine{06887\ \ \ \ \ \_glSamplerParameterf(index,\ GL\_TEXTURE\_MIN\_LOD,\ sampler.get\_min\_lod());}
\DoxyCodeLine{06888\ \ \ \ \ \_glSamplerParameterf(index,\ GL\_TEXTURE\_MAX\_LOD,\ sampler.get\_max\_lod());}
\DoxyCodeLine{06889\ \ \ \}}
\DoxyCodeLine{06890\ }
\DoxyCodeLine{06891\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{06892\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_lod\_bias)\ \{}
\DoxyCodeLine{06893\ \ \ \ \ \_glSamplerParameterf(index,\ GL\_TEXTURE\_LOD\_BIAS,\ sampler.get\_lod\_bias());}
\DoxyCodeLine{06894\ \ \ \}}
\DoxyCodeLine{06895\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06896\ }
\DoxyCodeLine{06897\ \ \ gsc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_sampler\_object\_lru);}
\DoxyCodeLine{06898\ }
\DoxyCodeLine{06899\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06900\ \ \ \textcolor{keywordflow}{return}\ gsc;}
\DoxyCodeLine{06901\ \}}
\DoxyCodeLine{06902\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{06903\ }
\DoxyCodeLine{06904\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06909\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06910\ release\_sampler(\mbox{\hyperlink{classSamplerContext}{SamplerContext}}\ *sc)\ \{}
\DoxyCodeLine{06911\ \ \ CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}})\ *gsc\ =\ DCAST(CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}}),\ sc);}
\DoxyCodeLine{06912\ }
\DoxyCodeLine{06913\ \ \ \textcolor{keywordflow}{if}\ (gsc-\/>\_index\ !=\ 0)\ \{}
\DoxyCodeLine{06914\ \ \ \ \ \_glDeleteSamplers(1,\ \&gsc-\/>\_index);}
\DoxyCodeLine{06915\ \ \ \}}
\DoxyCodeLine{06916\ }
\DoxyCodeLine{06917\ \ \ \textcolor{keyword}{delete}\ gsc;}
\DoxyCodeLine{06918\ \}}
\DoxyCodeLine{06919\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{06920\ }
\DoxyCodeLine{06930\ \mbox{\hyperlink{classGeomContext}{GeomContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06931\ prepare\_geom(\mbox{\hyperlink{classGeom}{Geom}}\ *geom)\ \{}
\DoxyCodeLine{06932\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_geom\_pcollector);}
\DoxyCodeLine{06933\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classGeomContext}{GeomContext}})(geom);}
\DoxyCodeLine{06934\ \}}
\DoxyCodeLine{06935\ }
\DoxyCodeLine{06941\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06942\ release\_geom(\mbox{\hyperlink{classGeomContext}{GeomContext}}\ *gc)\ \{}
\DoxyCodeLine{06943\ \ \ CLP(\mbox{\hyperlink{classGeomContext}{GeomContext}})\ *ggc\ =\ DCAST(CLP(\mbox{\hyperlink{classGeomContext}{GeomContext}}),\ gc);}
\DoxyCodeLine{06944\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{06945\ \ \ \ \ ggc-\/>release\_display\_lists();}
\DoxyCodeLine{06946\ \ \ \}}
\DoxyCodeLine{06947\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{06948\ }
\DoxyCodeLine{06949\ \ \ \textcolor{keyword}{delete}\ ggc;}
\DoxyCodeLine{06950\ \}}
\DoxyCodeLine{06951\ }
\DoxyCodeLine{06955\ \mbox{\hyperlink{classShaderContext}{ShaderContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{06956\ prepare\_shader(\mbox{\hyperlink{classShader}{Shader}}\ *se)\ \{}
\DoxyCodeLine{06957\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ se-\/>get\_prepare\_shader\_pcollector());}
\DoxyCodeLine{06958\ }
\DoxyCodeLine{06959\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{06960\ \ \ \mbox{\hyperlink{classShaderContext}{ShaderContext}}\ *result\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06961\ }
\DoxyCodeLine{06962\ \ \ \textcolor{keywordflow}{switch}\ (se-\/>get\_language())\ \{}
\DoxyCodeLine{06963\ \ \ \textcolor{keywordflow}{case}\ Shader::SL\_GLSL:}
\DoxyCodeLine{06964\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_glsl)\ \{}
\DoxyCodeLine{06965\ \ \ \ \ \ \ push\_group\_marker(std::string(\textcolor{stringliteral}{"{}Prepare\ Shader\ "{}})\ +\ se-\/>get\_debug\_name());}
\DoxyCodeLine{06966\ \ \ \ \ \ \ result\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classShaderContext}{ShaderContext}})(\textcolor{keyword}{this},\ se);}
\DoxyCodeLine{06967\ \ \ \ \ \ \ pop\_group\_marker();}
\DoxyCodeLine{06968\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06969\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06970\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06971\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Tried\ to\ load\ GLSL\ shader,\ but\ GLSL\ shaders\ not\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{06972\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06973\ \ \ \ \ \}}
\DoxyCodeLine{06974\ }
\DoxyCodeLine{06975\ \ \ \textcolor{keywordflow}{case}\ Shader::SL\_Cg:}
\DoxyCodeLine{06976\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{06977\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_basic\_shaders)\ \{}
\DoxyCodeLine{06978\ \ \ \ \ \ \ push\_group\_marker(std::string(\textcolor{stringliteral}{"{}Prepare\ Shader\ "{}})\ +\ se-\/>get\_debug\_name());}
\DoxyCodeLine{06979\ \ \ \ \ \ \ result\ =\ \textcolor{keyword}{new}\ CLP(CgShaderContext)(\textcolor{keyword}{this},\ se);}
\DoxyCodeLine{06980\ \ \ \ \ \ \ pop\_group\_marker();}
\DoxyCodeLine{06981\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{06982\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{06983\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06984\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Tried\ to\ load\ Cg\ shader,\ but\ basic\ shaders\ not\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{06985\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06986\ \ \ \ \ \}}
\DoxyCodeLine{06987\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES)}}
\DoxyCodeLine{06988\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06989\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Tried\ to\ load\ Cg\ shader,\ but\ Cg\ support\ is\ not\ available\ for\ OpenGL\ ES.\(\backslash\)n"{}};}
\DoxyCodeLine{06990\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06991\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{06992\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06993\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Tried\ to\ load\ Cg\ shader,\ but\ Cg\ support\ not\ compiled\ in.\(\backslash\)n"{}};}
\DoxyCodeLine{06994\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{06995\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{06996\ }
\DoxyCodeLine{06997\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{06998\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{06999\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Tried\ to\ load\ shader\ with\ unsupported\ shader\ language!\(\backslash\)n"{}};}
\DoxyCodeLine{07000\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07001\ \ \ \}}
\DoxyCodeLine{07002\ }
\DoxyCodeLine{07003\ \ \ \textcolor{keywordflow}{if}\ (result-\/>valid())\ \{}
\DoxyCodeLine{07004\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{07005\ \ \ \}}
\DoxyCodeLine{07006\ }
\DoxyCodeLine{07007\ \ \ \textcolor{keyword}{delete}\ result;}
\DoxyCodeLine{07008\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{07009\ }
\DoxyCodeLine{07010\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07011\ \}}
\DoxyCodeLine{07012\ }
\DoxyCodeLine{07016\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07017\ release\_shader(\mbox{\hyperlink{classShaderContext}{ShaderContext}}\ *sc)\ \{}
\DoxyCodeLine{07018\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{07019\ \ \ \textcolor{keywordflow}{if}\ (sc-\/>is\_of\_type(CLP(\mbox{\hyperlink{classShaderContext}{ShaderContext}})::get\_class\_type()))\ \{}
\DoxyCodeLine{07020\ \ \ \ \ ((CLP(\mbox{\hyperlink{classShaderContext}{ShaderContext}})\ *)sc)-\/>release\_resources();}
\DoxyCodeLine{07021\ \ \ \}}
\DoxyCodeLine{07022\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES\_2)}}
\DoxyCodeLine{07023\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (sc-\/>is\_of\_type(CLP(CgShaderContext)::get\_class\_type()))\ \{}
\DoxyCodeLine{07024\ \ \ \ \ ((CLP(CgShaderContext)\ *)sc)-\/>release\_resources();}
\DoxyCodeLine{07025\ \ \ \}}
\DoxyCodeLine{07026\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07027\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07028\ }
\DoxyCodeLine{07029\ \ \ \textcolor{keyword}{delete}\ sc;}
\DoxyCodeLine{07030\ \}}
\DoxyCodeLine{07031\ }
\DoxyCodeLine{07037\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07038\ record\_deleted\_display\_list(GLuint\ index)\ \{}
\DoxyCodeLine{07039\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{07040\ \ \ \_deleted\_display\_lists.push\_back(index);}
\DoxyCodeLine{07041\ \}}
\DoxyCodeLine{07042\ }
\DoxyCodeLine{07043\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{07049\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07050\ bind\_new\_client\_buffer(GLuint\ \&index,\ void\ *\&mapped\_ptr,\ GLenum\ target,\ size\_t\ size)\ \{}
\DoxyCodeLine{07051\ \ \ \_active\_ppbuffer\_memory\_pcollector.add\_level(size);}
\DoxyCodeLine{07052\ }
\DoxyCodeLine{07053\ \ \ \{}
\DoxyCodeLine{07054\ \ \ \ \ \textcolor{comment}{//\ Start\ at\ the\ end,\ because\ removing\ near\ the\ end\ is\ cheaper.}}
\DoxyCodeLine{07055\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{07056\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ i\ =\ \_deleted\_buffers.size();}
\DoxyCodeLine{07057\ \ \ \ \ \textcolor{keywordflow}{while}\ (i\ >\ 1)\ \{}
\DoxyCodeLine{07058\ \ \ \ \ \ \ -\/-\/i;}
\DoxyCodeLine{07059\ \ \ \ \ \ \ DeletedBuffer\ \&buffer\ =\ \_deleted\_buffers[i];}
\DoxyCodeLine{07060\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (buffer.\_size\ ==\ size)\ \{}
\DoxyCodeLine{07061\ \ \ \ \ \ \ \ \ index\ =\ buffer.\_index;}
\DoxyCodeLine{07062\ \ \ \ \ \ \ \ \ mapped\_ptr\ =\ buffer.\_mapped\_pointer;}
\DoxyCodeLine{07063\ \ \ \ \ \ \ \ \ \_glBindBuffer(target,\ buffer.\_index);}
\DoxyCodeLine{07064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffer\_storage\ \&\&\ mapped\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07065\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Need\ to\ unmap\ it\ before\ we\ can\ use\ it.}}
\DoxyCodeLine{07066\ \ \ \ \ \ \ \ \ \ \ \_glUnmapBuffer(target);}
\DoxyCodeLine{07067\ \ \ \ \ \ \ \ \ \ \ mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07068\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{07069\ \ \ \ \ \ \ \ \ \_deleted\_buffers.erase(\_deleted\_buffers.begin()\ +\ i);}
\DoxyCodeLine{07070\ \ \ \ \ \ \ \ \ \_inactive\_ppbuffer\_memory\_pcollector.sub\_level(size);}
\DoxyCodeLine{07071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07072\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07073\ \ \ \ \ \}}
\DoxyCodeLine{07074\ \ \ \}}
\DoxyCodeLine{07075\ }
\DoxyCodeLine{07076\ \ \ \_glGenBuffers(1,\ \&index);}
\DoxyCodeLine{07077\ \ \ \_glBindBuffer(target,\ index);}
\DoxyCodeLine{07078\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{07079\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{07080\ \ \ \ \ \textcolor{comment}{//\ Map\ persistently,\ we\ already\ use\ fences\ to\ synchronize\ access\ anyway.}}
\DoxyCodeLine{07081\ \ \ \ \ \_glBufferStorage(target,\ size,\ \textcolor{keyword}{nullptr},\ GL\_MAP\_READ\_BIT\ |}
\DoxyCodeLine{07082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_CLIENT\_STORAGE\_BIT\ |\ GL\_MAP\_PERSISTENT\_BIT);}
\DoxyCodeLine{07083\ \ \ \ \ mapped\_ptr\ =\ \_glMapBufferRange(target,\ 0,\ size,}
\DoxyCodeLine{07084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_MAP\_READ\_BIT\ |\ GL\_MAP\_PERSISTENT\_BIT);}
\DoxyCodeLine{07085\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{07086\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07087\ \ \ \{}
\DoxyCodeLine{07088\ \ \ \ \ \textcolor{comment}{//XXX\ does\ it\ matter\ what\ usage\ hint\ we\ pass\ here?\ \ None\ seem\ to\ fit\ well.}}
\DoxyCodeLine{07089\ \ \ \ \ \_glBufferData(target,\ size,\ \textcolor{keyword}{nullptr},\ GL\_DYNAMIC\_DRAW);}
\DoxyCodeLine{07090\ \ \ \ \ mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07091\ \ \ \}}
\DoxyCodeLine{07092\ \}}
\DoxyCodeLine{07093\ }
\DoxyCodeLine{07098\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07099\ release\_client\_buffer(GLuint\ index,\ void\ *mapped\_ptr,\ size\_t\ size)\ \{}
\DoxyCodeLine{07100\ \ \ \textcolor{comment}{//\ This\ may\ be\ called\ from\ any\ thread,\ so\ we\ can't\ make\ OpenGL\ calls\ here}}
\DoxyCodeLine{07101\ \ \ \textcolor{comment}{//\ (like\ unmapping\ the\ buffer).}}
\DoxyCodeLine{07102\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{07103\ \ \ \_deleted\_buffers.push\_back(\{index,\ 0,\ mapped\_ptr,\ size\});}
\DoxyCodeLine{07104\ \ \ \_active\_ppbuffer\_memory\_pcollector.sub\_level(size);}
\DoxyCodeLine{07105\ \ \ \_inactive\_ppbuffer\_memory\_pcollector.add\_level(size);}
\DoxyCodeLine{07106\ \}}
\DoxyCodeLine{07107\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{07108\ }
\DoxyCodeLine{07119\ \mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07120\ prepare\_vertex\_buffer(\mbox{\hyperlink{classGeomVertexArrayData}{GeomVertexArrayData}}\ *data)\ \{}
\DoxyCodeLine{07121\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{07122\ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_vertex\_buffer\_pcollector);}
\DoxyCodeLine{07123\ }
\DoxyCodeLine{07124\ \ \ \ \ CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *gvbc\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})(\textcolor{keyword}{this},\ \_prepared\_objects,\ data);}
\DoxyCodeLine{07125\ \ \ \ \ \_glGenBuffers(1,\ \&gvbc-\/>\_index);}
\DoxyCodeLine{07126\ }
\DoxyCodeLine{07127\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07128\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07129\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}creating\ vertex\ buffer\ "{}}\ <<\ (int)gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}:\ "{}}}
\DoxyCodeLine{07130\ \ \ \ \ \ \ \ \ <<\ data-\/>get\_num\_rows()\ <<\ \textcolor{stringliteral}{"{}\ vertices\ "{}}}
\DoxyCodeLine{07131\ \ \ \ \ \ \ \ \ <<\ *data-\/>get\_array\_format()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07132\ \ \ \ \ \}}
\DoxyCodeLine{07133\ }
\DoxyCodeLine{07134\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07135\ \ \ \ \ update\_vertex\_buffer(gvbc,\ data-\/>get\_handle(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{07136\ \ \ \ \ \textcolor{keywordflow}{return}\ gvbc;}
\DoxyCodeLine{07137\ \ \ \}}
\DoxyCodeLine{07138\ }
\DoxyCodeLine{07139\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07140\ \}}
\DoxyCodeLine{07141\ }
\DoxyCodeLine{07146\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07147\ update\_vertex\_buffer(CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *gvbc,}
\DoxyCodeLine{07148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classGeomVertexArrayDataHandle}{GeomVertexArrayDataHandle}}\ *reader,\ bool\ force)\ \{}
\DoxyCodeLine{07149\ \ \ nassertr(\_supports\_buffers,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07150\ \ \ \textcolor{keywordflow}{if}\ (reader-\/>get\_modified()\ ==\ UpdateSeq::initial())\ \{}
\DoxyCodeLine{07151\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ re-\/apply.}}
\DoxyCodeLine{07152\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07153\ \ \ \}}
\DoxyCodeLine{07154\ }
\DoxyCodeLine{07155\ \ \ gvbc-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{07156\ }
\DoxyCodeLine{07157\ \ \ \textcolor{keywordflow}{if}\ (gvbc-\/>was\_modified(reader))\ \{}
\DoxyCodeLine{07158\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_bytes\ =\ reader-\/>get\_data\_size\_bytes();}
\DoxyCodeLine{07159\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07160\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07161\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}copying\ "{}}\ <<\ num\_bytes}
\DoxyCodeLine{07162\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ bytes\ into\ vertex\ buffer\ "{}}\ <<\ (int)gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07163\ \ \ \ \ \}}
\DoxyCodeLine{07164\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_bytes\ !=\ 0)\ \{}
\DoxyCodeLine{07165\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer\ =\ reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07166\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (client\_pointer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07168\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07169\ }
\DoxyCodeLine{07170\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_load\_vertex\_buffer\_pcollector,\ reader-\/>get\_current\_thread());}
\DoxyCodeLine{07171\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ !=\ gvbc-\/>\_index)\ \{}
\DoxyCodeLine{07172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07173\ \ \ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07174\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}binding\ vertex\ buffer\ "{}}\ <<\ (int)gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{07176\ \ \ \ \ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ gvbc-\/>\_index);}
\DoxyCodeLine{07177\ \ \ \ \ \ \ \ \ \_current\_vbuffer\_index\ =\ gvbc-\/>\_index;}
\DoxyCodeLine{07178\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07179\ }
\DoxyCodeLine{07180\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gvbc-\/>changed\_size(reader)\ ||\ gvbc-\/>changed\_usage\_hint(reader))\ \{}
\DoxyCodeLine{07181\ \ \ \ \ \ \ \ \ \_glBufferData(GL\_ARRAY\_BUFFER,\ num\_bytes,\ client\_pointer,}
\DoxyCodeLine{07182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_usage(reader-\/>get\_usage\_hint()));}
\DoxyCodeLine{07183\ }
\DoxyCodeLine{07184\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07185\ \ \ \ \ \ \ \ \ \_glBufferSubData(GL\_ARRAY\_BUFFER,\ 0,\ num\_bytes,\ client\_pointer);}
\DoxyCodeLine{07186\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07187\ \ \ \ \ \ \ \_data\_transferred\_pcollector.add\_level(num\_bytes);}
\DoxyCodeLine{07188\ \ \ \ \ \}}
\DoxyCodeLine{07189\ }
\DoxyCodeLine{07190\ \ \ \ \ gvbc-\/>mark\_loaded(reader);}
\DoxyCodeLine{07191\ \ \ \}}
\DoxyCodeLine{07192\ \ \ gvbc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{07193\ }
\DoxyCodeLine{07194\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{07195\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07196\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07197\ \}}
\DoxyCodeLine{07198\ }
\DoxyCodeLine{07204\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07205\ release\_vertex\_buffer(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}}\ *vbc)\ \{}
\DoxyCodeLine{07206\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07207\ }
\DoxyCodeLine{07208\ \ \ CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *gvbc\ =\ DCAST(CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}}),\ vbc);}
\DoxyCodeLine{07209\ }
\DoxyCodeLine{07210\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07211\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07212\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ vertex\ buffer\ "{}}\ <<\ (int)gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07213\ \ \ \}}
\DoxyCodeLine{07214\ }
\DoxyCodeLine{07215\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07216\ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07217\ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07218\ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ ==\ gvbc-\/>\_index)\ \{}
\DoxyCodeLine{07219\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07220\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07221\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ vertex\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{07222\ \ \ \ \ \}}
\DoxyCodeLine{07223\ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07224\ \ \ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{07225\ \ \ \}}
\DoxyCodeLine{07226\ }
\DoxyCodeLine{07227\ \ \ \_glDeleteBuffers(1,\ \&gvbc-\/>\_index);}
\DoxyCodeLine{07228\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07229\ }
\DoxyCodeLine{07230\ \ \ gvbc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07231\ }
\DoxyCodeLine{07232\ \ \ \textcolor{keyword}{delete}\ gvbc;}
\DoxyCodeLine{07233\ \}}
\DoxyCodeLine{07234\ }
\DoxyCodeLine{07240\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07241\ release\_vertex\_buffers(const\ \mbox{\hyperlink{classpvector}{pvector}}<\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *>\ \&contexts)\ \{}
\DoxyCodeLine{07242\ \ \ \textcolor{keywordflow}{if}\ (contexts.empty())\ \{}
\DoxyCodeLine{07243\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07244\ \ \ \}}
\DoxyCodeLine{07245\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07246\ \ \ \textcolor{keywordtype}{bool}\ debug\ =\ GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers;}
\DoxyCodeLine{07247\ }
\DoxyCodeLine{07248\ \ \ GLuint\ *indices\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint)\ *\ contexts.size());}
\DoxyCodeLine{07249\ \ \ \textcolor{keywordtype}{size\_t}\ num\_indices\ =\ 0;}
\DoxyCodeLine{07250\ }
\DoxyCodeLine{07251\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc\ :\ contexts)\ \{}
\DoxyCodeLine{07252\ \ \ \ \ CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *gvbc\ =\ DCAST(CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}}),\ bc);}
\DoxyCodeLine{07253\ }
\DoxyCodeLine{07254\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07255\ \ \ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07256\ \ \ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07257\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ ==\ gvbc-\/>\_index)\ \{}
\DoxyCodeLine{07258\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug\ \&\&\ GLCAT.is\_spam())\ \{}
\DoxyCodeLine{07259\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07260\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ vertex\ buffer\ "{}}\ <<\ gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07261\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07262\ \ \ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07263\ \ \ \ \ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{07264\ \ \ \ \ \}}
\DoxyCodeLine{07265\ }
\DoxyCodeLine{07266\ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{07267\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07268\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ vertex\ buffer\ "{}}\ <<\ gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07269\ \ \ \ \ \}}
\DoxyCodeLine{07270\ }
\DoxyCodeLine{07271\ \ \ \ \ indices[num\_indices++]\ =\ gvbc-\/>\_index;}
\DoxyCodeLine{07272\ \ \ \ \ gvbc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07273\ }
\DoxyCodeLine{07274\ \ \ \ \ \textcolor{keyword}{delete}\ gvbc;}
\DoxyCodeLine{07275\ \ \ \}}
\DoxyCodeLine{07276\ }
\DoxyCodeLine{07277\ \ \ \_glDeleteBuffers(num\_indices,\ indices);}
\DoxyCodeLine{07278\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07279\ \}}
\DoxyCodeLine{07280\ }
\DoxyCodeLine{07294\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07295\ setup\_array\_data(const\ unsigned\ char\ *\&client\_pointer,}
\DoxyCodeLine{07296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classGeomVertexArrayDataHandle}{GeomVertexArrayDataHandle}}\ *array\_reader,}
\DoxyCodeLine{07297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ force)\ \{}
\DoxyCodeLine{07298\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffers)\ \{}
\DoxyCodeLine{07299\ \ \ \ \ \textcolor{comment}{//\ No\ support\ for\ buffer\ objects;\ always\ render\ from\ client.}}
\DoxyCodeLine{07300\ \ \ \ \ client\_pointer\ =\ array\_reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07301\ \ \ \ \ \textcolor{keywordflow}{return}\ (client\_pointer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07302\ \ \ \}}
\DoxyCodeLine{07303\ \ \ \textcolor{keywordflow}{if}\ (!vertex\_buffers\ ||\ \_geom\_display\_list\ !=\ 0\ ||}
\DoxyCodeLine{07304\ \ \ \ \ \ \ array\_reader-\/>get\_usage\_hint()\ <\ gl\_min\_buffer\_usage\_hint)\ \{}
\DoxyCodeLine{07305\ \ \ \ \ \textcolor{comment}{//\ The\ array\ specifies\ client\ rendering\ only,\ or\ buffer\ objects\ are}}
\DoxyCodeLine{07306\ \ \ \ \ \textcolor{comment}{//\ configured\ off.}}
\DoxyCodeLine{07307\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ !=\ 0)\ \{}
\DoxyCodeLine{07308\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07309\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07310\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ vertex\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{07311\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07312\ \ \ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07313\ \ \ \ \ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{07314\ \ \ \ \ \}}
\DoxyCodeLine{07315\ \ \ \ \ client\_pointer\ =\ array\_reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07316\ \ \ \ \ \textcolor{keywordflow}{return}\ (client\_pointer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07317\ \ \ \}}
\DoxyCodeLine{07318\ }
\DoxyCodeLine{07319\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{07320\ \ \ \textcolor{keywordtype}{int}\ stride\ =\ array\_reader-\/>get\_array\_format()-\/>get\_stride();}
\DoxyCodeLine{07321\ \ \ \textcolor{keywordflow}{if}\ (stride\ >\ \_max\_vertex\_attrib\_stride)\ \{}
\DoxyCodeLine{07322\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{07323\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Vertex\ array\ stride\ "{}}\ <<\ stride\ <<\ \textcolor{stringliteral}{"{}\ exceeds\ supported\ maximum\ "{}}}
\DoxyCodeLine{07324\ \ \ \ \ \ \ <<\ \_max\_vertex\_attrib\_stride\ <<\ \textcolor{stringliteral}{"{}!\(\backslash\)n"{}};}
\DoxyCodeLine{07325\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07326\ \ \ \}}
\DoxyCodeLine{07327\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07328\ }
\DoxyCodeLine{07329\ \ \ \textcolor{comment}{//\ Prepare\ the\ buffer\ object\ and\ bind\ it.}}
\DoxyCodeLine{07330\ \ \ CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *gvbc\ =\ DCAST(CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}}),}
\DoxyCodeLine{07331\ \ \ \ \ array\_reader-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this}));}
\DoxyCodeLine{07332\ }
\DoxyCodeLine{07333\ \ \ nassertr(gvbc\ !=\ (CLP(\mbox{\hyperlink{classVertexBufferContext}{VertexBufferContext}})\ *)\textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{07334\ \ \ \textcolor{keywordflow}{if}\ (!update\_vertex\_buffer(gvbc,\ array\_reader,\ force))\ \{}
\DoxyCodeLine{07335\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07336\ \ \ \}}
\DoxyCodeLine{07337\ }
\DoxyCodeLine{07338\ \ \ \textcolor{keywordflow}{if}\ (\_current\_vbuffer\_index\ !=\ gvbc-\/>\_index)\ \{}
\DoxyCodeLine{07339\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07340\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07341\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}binding\ vertex\ buffer\ "{}}\ <<\ (int)gvbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07342\ \ \ \ \ \}}
\DoxyCodeLine{07343\ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ gvbc-\/>\_index);}
\DoxyCodeLine{07344\ \ \ \ \ \_current\_vbuffer\_index\ =\ gvbc-\/>\_index;}
\DoxyCodeLine{07345\ \ \ \}}
\DoxyCodeLine{07346\ }
\DoxyCodeLine{07347\ \ \ \textcolor{comment}{//\ NULL\ is\ the\ OpenGL\ convention\ for\ the\ first\ byte\ of\ the\ buffer\ object.}}
\DoxyCodeLine{07348\ \ \ client\_pointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07349\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07350\ \}}
\DoxyCodeLine{07351\ }
\DoxyCodeLine{07361\ \mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07362\ prepare\_index\_buffer(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}}\ *data)\ \{}
\DoxyCodeLine{07363\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{07364\ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_index\_buffer\_pcollector);}
\DoxyCodeLine{07365\ }
\DoxyCodeLine{07366\ \ \ \ \ CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}})\ *gibc\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}})(\textcolor{keyword}{this},\ \_prepared\_objects,\ data);}
\DoxyCodeLine{07367\ \ \ \ \ \_glGenBuffers(1,\ \&gibc-\/>\_index);}
\DoxyCodeLine{07368\ }
\DoxyCodeLine{07369\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07370\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07371\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}creating\ index\ buffer\ "{}}\ <<\ (int)gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}:\ "{}}}
\DoxyCodeLine{07372\ \ \ \ \ \ \ \ \ <<\ data-\/>get\_num\_vertices()\ <<\ \textcolor{stringliteral}{"{}\ indices\ ("{}}}
\DoxyCodeLine{07373\ \ \ \ \ \ \ \ \ <<\ data-\/>get\_vertices()-\/>get\_array\_format()-\/>get\_column(0)-\/>get\_numeric\_type()}
\DoxyCodeLine{07374\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{07375\ \ \ \ \ \}}
\DoxyCodeLine{07376\ }
\DoxyCodeLine{07377\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07378\ \ \ \ \ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ reader(data,\ Thread::get\_current\_thread());}
\DoxyCodeLine{07379\ \ \ \ \ apply\_index\_buffer(gibc,\ \&reader,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07380\ \ \ \ \ \textcolor{keywordflow}{return}\ gibc;}
\DoxyCodeLine{07381\ \ \ \}}
\DoxyCodeLine{07382\ }
\DoxyCodeLine{07383\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07384\ \}}
\DoxyCodeLine{07385\ }
\DoxyCodeLine{07389\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07390\ apply\_index\_buffer(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}\ *ibc,}
\DoxyCodeLine{07391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,}
\DoxyCodeLine{07392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ force)\ \{}
\DoxyCodeLine{07393\ \ \ nassertr(\_supports\_buffers,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07394\ \ \ \textcolor{keywordflow}{if}\ (reader-\/>get\_modified()\ ==\ UpdateSeq::initial())\ \{}
\DoxyCodeLine{07395\ \ \ \ \ \textcolor{comment}{//\ No\ need\ to\ re-\/apply.}}
\DoxyCodeLine{07396\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07397\ \ \ \}}
\DoxyCodeLine{07398\ }
\DoxyCodeLine{07399\ \ \ CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}})\ *gibc\ =\ DCAST(CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}),\ ibc);}
\DoxyCodeLine{07400\ }
\DoxyCodeLine{07401\ \ \ \textcolor{keywordflow}{if}\ (\_current\_ibuffer\_index\ !=\ gibc-\/>\_index)\ \{}
\DoxyCodeLine{07402\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07403\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07404\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}binding\ index\ buffer\ "{}}\ <<\ (int)gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07405\ \ \ \ \ \}}
\DoxyCodeLine{07406\ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ gibc-\/>\_index);}
\DoxyCodeLine{07407\ \ \ \ \ \_current\_ibuffer\_index\ =\ gibc-\/>\_index;}
\DoxyCodeLine{07408\ \ \ \ \ gibc-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{07409\ \ \ \}}
\DoxyCodeLine{07410\ }
\DoxyCodeLine{07411\ \ \ \textcolor{keywordflow}{if}\ (gibc-\/>was\_modified(reader))\ \{}
\DoxyCodeLine{07412\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_bytes\ =\ reader-\/>get\_data\_size\_bytes();}
\DoxyCodeLine{07413\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07414\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07415\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}copying\ "{}}\ <<\ num\_bytes}
\DoxyCodeLine{07416\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ bytes\ into\ index\ buffer\ "{}}\ <<\ (int)gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07417\ \ \ \ \ \}}
\DoxyCodeLine{07418\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_bytes\ !=\ 0)\ \{}
\DoxyCodeLine{07419\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *client\_pointer\ =\ reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07420\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (client\_pointer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07421\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07422\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07423\ }
\DoxyCodeLine{07424\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_load\_index\_buffer\_pcollector,\ reader-\/>get\_current\_thread());}
\DoxyCodeLine{07425\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gibc-\/>changed\_size(reader)\ ||\ gibc-\/>changed\_usage\_hint(reader))\ \{}
\DoxyCodeLine{07426\ \ \ \ \ \ \ \ \ \_glBufferData(GL\_ELEMENT\_ARRAY\_BUFFER,\ num\_bytes,\ client\_pointer,}
\DoxyCodeLine{07427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_usage(reader-\/>get\_usage\_hint()));}
\DoxyCodeLine{07428\ }
\DoxyCodeLine{07429\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07430\ \ \ \ \ \ \ \ \ \_glBufferSubData(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0,\ num\_bytes,}
\DoxyCodeLine{07431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ client\_pointer);}
\DoxyCodeLine{07432\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07433\ \ \ \ \ \ \ \_data\_transferred\_pcollector.add\_level(num\_bytes);}
\DoxyCodeLine{07434\ \ \ \ \ \}}
\DoxyCodeLine{07435\ \ \ \ \ gibc-\/>mark\_loaded(reader);}
\DoxyCodeLine{07436\ \ \ \}}
\DoxyCodeLine{07437\ \ \ gibc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{07438\ }
\DoxyCodeLine{07439\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{07440\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07441\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07442\ \}}
\DoxyCodeLine{07443\ }
\DoxyCodeLine{07449\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07450\ release\_index\_buffer(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}\ *ibc)\ \{}
\DoxyCodeLine{07451\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07452\ }
\DoxyCodeLine{07453\ \ \ CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}})\ *gibc\ =\ DCAST(CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}),\ ibc);}
\DoxyCodeLine{07454\ }
\DoxyCodeLine{07455\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07456\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07457\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ index\ buffer\ "{}}\ <<\ (int)gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07458\ \ \ \}}
\DoxyCodeLine{07459\ }
\DoxyCodeLine{07460\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07461\ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07462\ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07463\ \ \ \textcolor{keywordflow}{if}\ (\_current\_ibuffer\_index\ ==\ gibc-\/>\_index)\ \{}
\DoxyCodeLine{07464\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07465\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07466\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ index\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{07467\ \ \ \ \ \}}
\DoxyCodeLine{07468\ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07469\ \ \ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{07470\ \ \ \}}
\DoxyCodeLine{07471\ }
\DoxyCodeLine{07472\ \ \ \_glDeleteBuffers(1,\ \&gibc-\/>\_index);}
\DoxyCodeLine{07473\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07474\ }
\DoxyCodeLine{07475\ \ \ gibc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07476\ }
\DoxyCodeLine{07477\ \ \ \textcolor{keyword}{delete}\ gibc;}
\DoxyCodeLine{07478\ \}}
\DoxyCodeLine{07479\ }
\DoxyCodeLine{07485\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07486\ release\_index\_buffers(const\ \mbox{\hyperlink{classpvector}{pvector}}<\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *>\ \&contexts)\ \{}
\DoxyCodeLine{07487\ \ \ \textcolor{keywordflow}{if}\ (contexts.empty())\ \{}
\DoxyCodeLine{07488\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07489\ \ \ \}}
\DoxyCodeLine{07490\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07491\ \ \ \textcolor{keywordtype}{bool}\ debug\ =\ GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers;}
\DoxyCodeLine{07492\ }
\DoxyCodeLine{07493\ \ \ GLuint\ *indices\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint)\ *\ contexts.size());}
\DoxyCodeLine{07494\ \ \ \textcolor{keywordtype}{size\_t}\ num\_indices\ =\ 0;}
\DoxyCodeLine{07495\ }
\DoxyCodeLine{07496\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc\ :\ contexts)\ \{}
\DoxyCodeLine{07497\ \ \ \ \ CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}})\ *gibc\ =\ DCAST(CLP(\mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}),\ bc);}
\DoxyCodeLine{07498\ }
\DoxyCodeLine{07499\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07500\ \ \ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07501\ \ \ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07502\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_ibuffer\_index\ ==\ gibc-\/>\_index)\ \{}
\DoxyCodeLine{07503\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug\ \&\&\ GLCAT.is\_spam())\ \{}
\DoxyCodeLine{07504\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07505\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ index\ buffer\ "{}}\ <<\ gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07506\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07507\ \ \ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07508\ \ \ \ \ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{07509\ \ \ \ \ \}}
\DoxyCodeLine{07510\ }
\DoxyCodeLine{07511\ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{07512\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07513\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ index\ buffer\ "{}}\ <<\ gibc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07514\ \ \ \ \ \}}
\DoxyCodeLine{07515\ }
\DoxyCodeLine{07516\ \ \ \ \ indices[num\_indices++]\ =\ gibc-\/>\_index;}
\DoxyCodeLine{07517\ \ \ \ \ gibc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07518\ }
\DoxyCodeLine{07519\ \ \ \ \ \textcolor{keyword}{delete}\ gibc;}
\DoxyCodeLine{07520\ \ \ \}}
\DoxyCodeLine{07521\ }
\DoxyCodeLine{07522\ \ \ \_glDeleteBuffers(num\_indices,\ indices);}
\DoxyCodeLine{07523\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07524\ \}}
\DoxyCodeLine{07525\ }
\DoxyCodeLine{07539\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07540\ setup\_primitive(const\ unsigned\ char\ *\&client\_pointer,}
\DoxyCodeLine{07541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,}
\DoxyCodeLine{07542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ force)\ \{}
\DoxyCodeLine{07543\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffers)\ \{}
\DoxyCodeLine{07544\ \ \ \ \ \textcolor{comment}{//\ No\ support\ for\ buffer\ objects;\ always\ render\ from\ client.}}
\DoxyCodeLine{07545\ \ \ \ \ client\_pointer\ =\ reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07546\ \ \ \ \ \textcolor{keywordflow}{return}\ (client\_pointer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07547\ \ \ \}}
\DoxyCodeLine{07548\ \ \ \textcolor{keywordflow}{if}\ (!vertex\_buffers\ ||\ \_geom\_display\_list\ !=\ 0\ ||}
\DoxyCodeLine{07549\ \ \ \ \ \ \ reader-\/>get\_usage\_hint()\ ==\ Geom::UH\_client)\ \{}
\DoxyCodeLine{07550\ \ \ \ \ \textcolor{comment}{//\ The\ array\ specifies\ client\ rendering\ only,\ or\ buffer\ objects\ are}}
\DoxyCodeLine{07551\ \ \ \ \ \textcolor{comment}{//\ configured\ off.}}
\DoxyCodeLine{07552\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_ibuffer\_index\ !=\ 0)\ \{}
\DoxyCodeLine{07553\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07554\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07555\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ index\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{07556\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07557\ \ \ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{07558\ \ \ \ \ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{07559\ \ \ \ \ \}}
\DoxyCodeLine{07560\ \ \ \ \ client\_pointer\ =\ reader-\/>get\_read\_pointer(force);}
\DoxyCodeLine{07561\ \ \ \ \ \textcolor{keywordflow}{return}\ (client\_pointer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07562\ \ \ \}}
\DoxyCodeLine{07563\ }
\DoxyCodeLine{07564\ \ \ \textcolor{comment}{//\ Prepare\ the\ buffer\ object\ and\ bind\ it.}}
\DoxyCodeLine{07565\ \ \ \mbox{\hyperlink{classIndexBufferContext}{IndexBufferContext}}\ *ibc\ =\ reader-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{07566\ \ \ nassertr(ibc\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{07567\ \ \ \textcolor{keywordflow}{if}\ (!apply\_index\_buffer(ibc,\ reader,\ force))\ \{}
\DoxyCodeLine{07568\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07569\ \ \ \}}
\DoxyCodeLine{07570\ }
\DoxyCodeLine{07571\ \ \ \textcolor{comment}{//\ NULL\ is\ the\ OpenGL\ convention\ for\ the\ first\ byte\ of\ the\ buffer\ object.}}
\DoxyCodeLine{07572\ \ \ client\_pointer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07573\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07574\ \}}
\DoxyCodeLine{07575\ }
\DoxyCodeLine{07576\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{07586\ \mbox{\hyperlink{classBufferContext}{BufferContext}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07587\ prepare\_shader\_buffer(\mbox{\hyperlink{classShaderBuffer}{ShaderBuffer}}\ *data)\ \{}
\DoxyCodeLine{07588\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_shader\_buffers)\ \{}
\DoxyCodeLine{07589\ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_prepare\_shader\_buffer\_pcollector);}
\DoxyCodeLine{07590\ }
\DoxyCodeLine{07591\ \ \ \ \ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *gbc\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})(\textcolor{keyword}{this},\ \_prepared\_objects,\ data);}
\DoxyCodeLine{07592\ \ \ \ \ \_glGenBuffers(1,\ \&gbc-\/>\_index);}
\DoxyCodeLine{07593\ }
\DoxyCodeLine{07594\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07595\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07596\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}creating\ shader\ buffer\ "{}}\ <<\ (int)gbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}:\ "{}}<<\ *data\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07597\ \ \ \ \ \}}
\DoxyCodeLine{07598\ \ \ \ \ \_glBindBuffer(GL\_SHADER\_STORAGE\_BUFFER,\ gbc-\/>\_index);}
\DoxyCodeLine{07599\ \ \ \ \ \_current\_sbuffer\_index\ =\ gbc-\/>\_index;}
\DoxyCodeLine{07600\ }
\DoxyCodeLine{07601\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_use\_object\_labels)\ \{}
\DoxyCodeLine{07602\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ name\ =\ data-\/>get\_name();}
\DoxyCodeLine{07603\ \ \ \ \ \ \ \_glObjectLabel(GL\_BUFFER,\ gbc-\/>\_index,\ name.size(),\ name.data());}
\DoxyCodeLine{07604\ \ \ \ \ \}}
\DoxyCodeLine{07605\ }
\DoxyCodeLine{07606\ \ \ \ \ \textcolor{comment}{//\ Some\ drivers\ require\ the\ buffer\ to\ be\ padded\ to\ 16\ byte\ boundary.}}
\DoxyCodeLine{07607\ \ \ \ \ uint64\_t\ num\_bytes\ =\ (data-\/>get\_data\_size\_bytes()\ +\ 15u)\ \&\ \string~15u;}
\DoxyCodeLine{07608\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{07609\ \ \ \ \ \ \ GLbitfield\ flags\ =\ 0;}
\DoxyCodeLine{07610\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (data-\/>get\_usage\_hint()\ ==\ GeomEnums::UH\_client)\ \{}
\DoxyCodeLine{07611\ \ \ \ \ \ \ \ \ flags\ |=\ GL\_CLIENT\_STORAGE\_BIT;}
\DoxyCodeLine{07612\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07613\ \ \ \ \ \ \ \_glBufferStorage(GL\_SHADER\_STORAGE\_BUFFER,\ num\_bytes,\ data-\/>get\_initial\_data(),\ flags);}
\DoxyCodeLine{07614\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{07615\ \ \ \ \ \ \ \_glBufferData(GL\_SHADER\_STORAGE\_BUFFER,\ num\_bytes,\ data-\/>get\_initial\_data(),\ get\_usage(data-\/>get\_usage\_hint()));}
\DoxyCodeLine{07616\ \ \ \ \ \}}
\DoxyCodeLine{07617\ }
\DoxyCodeLine{07618\ \ \ \ \ \textcolor{comment}{//\ Barrier\ not\ needed.}}
\DoxyCodeLine{07619\ \ \ \ \ gbc-\/>\_shader\_storage\_barrier\_counter\ =\ \_shader\_storage\_barrier\_counter\ -\/\ 1;}
\DoxyCodeLine{07620\ }
\DoxyCodeLine{07621\ \ \ \ \ gbc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{07622\ }
\DoxyCodeLine{07623\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07624\ \ \ \ \ \textcolor{keywordflow}{return}\ gbc;}
\DoxyCodeLine{07625\ \ \ \}}
\DoxyCodeLine{07626\ }
\DoxyCodeLine{07627\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07628\ \}}
\DoxyCodeLine{07629\ }
\DoxyCodeLine{07633\ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07634\ apply\_shader\_buffer(GLuint\ base,\ \mbox{\hyperlink{classShaderBuffer}{ShaderBuffer}}\ *buffer)\ \{}
\DoxyCodeLine{07635\ \ \ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *gbc\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07636\ }
\DoxyCodeLine{07637\ \ \ GLuint\ index\ =\ 0;}
\DoxyCodeLine{07638\ \ \ \textcolor{keywordflow}{if}\ (buffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07639\ \ \ \ \ \mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc\ =\ buffer-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{07640\ \ \ \ \ \textcolor{keywordflow}{if}\ (bc\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07641\ \ \ \ \ \ \ gbc\ =\ DCAST(CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}}),\ bc);}
\DoxyCodeLine{07642\ \ \ \ \ \ \ index\ =\ gbc-\/>\_index;}
\DoxyCodeLine{07643\ \ \ \ \ \ \ gbc-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{07644\ \ \ \ \ \}}
\DoxyCodeLine{07645\ \ \ \}}
\DoxyCodeLine{07646\ }
\DoxyCodeLine{07647\ \ \ \textcolor{keywordflow}{if}\ (base\ >=\ \_current\_sbuffer\_base.size())\ \{}
\DoxyCodeLine{07648\ \ \ \ \ \_current\_sbuffer\_base.resize(base\ +\ 1,\ 0);}
\DoxyCodeLine{07649\ \ \ \}}
\DoxyCodeLine{07650\ }
\DoxyCodeLine{07651\ \ \ \textcolor{keywordflow}{if}\ (\_current\_sbuffer\_base[base]\ !=\ index)\ \{}
\DoxyCodeLine{07652\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07653\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07654\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}binding\ shader\ buffer\ "{}}\ <<\ (int)index}
\DoxyCodeLine{07655\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ to\ index\ "{}}\ <<\ base\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07656\ \ \ \ \ \}}
\DoxyCodeLine{07657\ \ \ \ \ \_glBindBufferBase(GL\_SHADER\_STORAGE\_BUFFER,\ base,\ index);}
\DoxyCodeLine{07658\ \ \ \ \ \_current\_sbuffer\_base[base]\ =\ index;}
\DoxyCodeLine{07659\ \ \ \ \ \_current\_sbuffer\_index\ =\ index;}
\DoxyCodeLine{07660\ }
\DoxyCodeLine{07661\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07662\ \ \ \}}
\DoxyCodeLine{07663\ }
\DoxyCodeLine{07664\ \ \ \textcolor{keywordflow}{return}\ gbc;}
\DoxyCodeLine{07665\ \}}
\DoxyCodeLine{07666\ }
\DoxyCodeLine{07672\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07673\ release\_shader\_buffer(\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc)\ \{}
\DoxyCodeLine{07674\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07675\ }
\DoxyCodeLine{07676\ \ \ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *gbc\ =\ DCAST(CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}}),\ bc);}
\DoxyCodeLine{07677\ }
\DoxyCodeLine{07678\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07679\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07680\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ shader\ buffer\ "{}}\ <<\ (int)gbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07681\ \ \ \}}
\DoxyCodeLine{07682\ }
\DoxyCodeLine{07683\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07684\ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07685\ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07686\ \ \ \textcolor{keywordflow}{if}\ (\_current\_sbuffer\_index\ ==\ gbc-\/>\_index)\ \{}
\DoxyCodeLine{07687\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam()\ \&\&\ gl\_debug\_buffers)\ \{}
\DoxyCodeLine{07688\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07689\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ shader\ buffer\(\backslash\)n"{}};}
\DoxyCodeLine{07690\ \ \ \ \ \}}
\DoxyCodeLine{07691\ \ \ \ \ \_glBindBuffer(GL\_SHADER\_STORAGE\_BUFFER,\ 0);}
\DoxyCodeLine{07692\ \ \ \ \ \_current\_sbuffer\_index\ =\ 0;}
\DoxyCodeLine{07693\ \ \ \}}
\DoxyCodeLine{07694\ }
\DoxyCodeLine{07695\ \ \ \_glDeleteBuffers(1,\ \&gbc-\/>\_index);}
\DoxyCodeLine{07696\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07697\ }
\DoxyCodeLine{07698\ \ \ gbc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07699\ }
\DoxyCodeLine{07700\ \ \ \textcolor{keyword}{delete}\ gbc;}
\DoxyCodeLine{07701\ \}}
\DoxyCodeLine{07702\ }
\DoxyCodeLine{07708\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07709\ release\_shader\_buffers(const\ \mbox{\hyperlink{classpvector}{pvector}}<\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *>\ \&contexts)\ \{}
\DoxyCodeLine{07710\ \ \ \textcolor{keywordflow}{if}\ (contexts.empty())\ \{}
\DoxyCodeLine{07711\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07712\ \ \ \}}
\DoxyCodeLine{07713\ \ \ nassertv(\_supports\_buffers);}
\DoxyCodeLine{07714\ \ \ \textcolor{keywordtype}{bool}\ debug\ =\ GLCAT.is\_debug()\ \&\&\ gl\_debug\_buffers;}
\DoxyCodeLine{07715\ }
\DoxyCodeLine{07716\ \ \ GLuint\ *indices\ =\ (GLuint\ *)alloca(\textcolor{keyword}{sizeof}(GLuint)\ *\ contexts.size());}
\DoxyCodeLine{07717\ \ \ \textcolor{keywordtype}{size\_t}\ num\_indices\ =\ 0;}
\DoxyCodeLine{07718\ }
\DoxyCodeLine{07719\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc\ :\ contexts)\ \{}
\DoxyCodeLine{07720\ \ \ \ \ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *gbc\ =\ DCAST(CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}}),\ bc);}
\DoxyCodeLine{07721\ }
\DoxyCodeLine{07722\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ buffer\ is\ unbound\ before\ we\ delete\ it.\ \ Not\ strictly}}
\DoxyCodeLine{07723\ \ \ \ \ \textcolor{comment}{//\ necessary\ according\ to\ the\ OpenGL\ spec,\ but\ it\ might\ help\ out\ a\ flaky}}
\DoxyCodeLine{07724\ \ \ \ \ \textcolor{comment}{//\ driver,\ and\ we\ need\ to\ keep\ our\ internal\ state\ consistent\ anyway.}}
\DoxyCodeLine{07725\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_sbuffer\_index\ ==\ gbc-\/>\_index)\ \{}
\DoxyCodeLine{07726\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug\ \&\&\ GLCAT.is\_spam())\ \{}
\DoxyCodeLine{07727\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{07728\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}unbinding\ shader\ buffer\ "{}}\ <<\ gbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07729\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07730\ \ \ \ \ \ \ \_glBindBuffer(GL\_SHADER\_STORAGE\_BUFFER,\ 0);}
\DoxyCodeLine{07731\ \ \ \ \ \ \ \_current\_sbuffer\_index\ =\ 0;}
\DoxyCodeLine{07732\ \ \ \ \ \}}
\DoxyCodeLine{07733\ }
\DoxyCodeLine{07734\ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{07735\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07736\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}deleting\ shader\ buffer\ "{}}\ <<\ gbc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07737\ \ \ \ \ \}}
\DoxyCodeLine{07738\ }
\DoxyCodeLine{07739\ \ \ \ \ indices[num\_indices++]\ =\ gbc-\/>\_index;}
\DoxyCodeLine{07740\ \ \ \ \ gbc-\/>\_index\ =\ 0;}
\DoxyCodeLine{07741\ }
\DoxyCodeLine{07742\ \ \ \ \ \textcolor{keyword}{delete}\ gbc;}
\DoxyCodeLine{07743\ \ \ \}}
\DoxyCodeLine{07744\ }
\DoxyCodeLine{07745\ \ \ \_glDeleteBuffers(num\_indices,\ indices);}
\DoxyCodeLine{07746\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07747\ \}}
\DoxyCodeLine{07748\ }
\DoxyCodeLine{07756\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07757\ extract\_shader\_buffer\_data(\mbox{\hyperlink{classShaderBuffer}{ShaderBuffer}}\ *buffer,\ vector\_uchar\ \&data)\ \{}
\DoxyCodeLine{07758\ \ \ \mbox{\hyperlink{classBufferContext}{BufferContext}}\ *bc\ =\ buffer-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{07759\ \ \ \textcolor{keywordflow}{if}\ (bc\ ==\ \textcolor{keyword}{nullptr}\ ||\ !bc-\/>is\_of\_type(CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})::get\_class\_type()))\ \{}
\DoxyCodeLine{07760\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07761\ \ \ \}}
\DoxyCodeLine{07762\ \ \ CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}})\ *gbc\ =\ DCAST(CLP(\mbox{\hyperlink{classBufferContext}{BufferContext}}),\ bc);}
\DoxyCodeLine{07763\ }
\DoxyCodeLine{07764\ \ \ data.resize(buffer-\/>get\_data\_size\_bytes());}
\DoxyCodeLine{07765\ }
\DoxyCodeLine{07766\ \ \ \textcolor{keywordflow}{if}\ (\_glMemoryBarrier\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07767\ \ \ \ \ \_glMemoryBarrier(GL\_BUFFER\_UPDATE\_BARRIER\_BIT);}
\DoxyCodeLine{07768\ \ \ \}}
\DoxyCodeLine{07769\ }
\DoxyCodeLine{07770\ \ \ \_glBindBuffer(GL\_SHADER\_STORAGE\_BUFFER,\ gbc-\/>\_index);}
\DoxyCodeLine{07771\ }
\DoxyCodeLine{07772\ \ \ \_glGetBufferSubData(GL\_SHADER\_STORAGE\_BUFFER,\ 0,\ data.size(),\ \&data[0]);}
\DoxyCodeLine{07773\ }
\DoxyCodeLine{07774\ \ \ \_glBindBuffer(GL\_SHADER\_STORAGE\_BUFFER,\ 0);}
\DoxyCodeLine{07775\ \ \ \_current\_sbuffer\_index\ =\ 0;}
\DoxyCodeLine{07776\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07777\ }
\DoxyCodeLine{07778\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{07779\ \}}
\DoxyCodeLine{07780\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07781\ }
\DoxyCodeLine{07782\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{07794\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07795\ begin\_occlusion\_query()\ \{}
\DoxyCodeLine{07796\ \ \ nassertv(\_supports\_occlusion\_query);}
\DoxyCodeLine{07797\ \ \ nassertv(\_current\_occlusion\_query\ ==\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07798\ \ \ PT(CLP(\mbox{\hyperlink{classOcclusionQueryContext}{OcclusionQueryContext}}))\ query\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classOcclusionQueryContext}{OcclusionQueryContext}})(\textcolor{keyword}{this});}
\DoxyCodeLine{07799\ }
\DoxyCodeLine{07800\ \ \ \_glGenQueries(1,\ \&query-\/>\_index);}
\DoxyCodeLine{07801\ }
\DoxyCodeLine{07802\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{07803\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07804\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}beginning\ occlusion\ query\ index\ "{}}\ <<\ (int)query-\/>\_index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07805\ \ \ \}}
\DoxyCodeLine{07806\ }
\DoxyCodeLine{07807\ \ \ \_glBeginQuery(GL\_SAMPLES\_PASSED,\ query-\/>\_index);}
\DoxyCodeLine{07808\ \ \ \_current\_occlusion\_query\ =\ query;}
\DoxyCodeLine{07809\ }
\DoxyCodeLine{07810\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07811\ \}}
\DoxyCodeLine{07812\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{07813\ }
\DoxyCodeLine{07814\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{07821\ PT(\mbox{\hyperlink{classOcclusionQueryContext}{OcclusionQueryContext}})\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07822\ end\_occlusion\_query()\ \{}
\DoxyCodeLine{07823\ \ \ nassertr(\_current\_occlusion\_query\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07824\ \ \ PT(\mbox{\hyperlink{classOcclusionQueryContext}{OcclusionQueryContext}})\ result\ =\ \_current\_occlusion\_query;}
\DoxyCodeLine{07825\ }
\DoxyCodeLine{07826\ \ \ GLuint\ index\ =\ DCAST(CLP(\mbox{\hyperlink{classOcclusionQueryContext}{OcclusionQueryContext}}),\ result)-\/>\_index;}
\DoxyCodeLine{07827\ }
\DoxyCodeLine{07828\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{07829\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{07830\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}ending\ occlusion\ query\ index\ "{}}\ <<\ (int)index\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{07831\ \ \ \}}
\DoxyCodeLine{07832\ }
\DoxyCodeLine{07833\ \ \ \_current\_occlusion\_query\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{07834\ \ \ \_glEndQuery(GL\_SAMPLES\_PASSED);}
\DoxyCodeLine{07835\ }
\DoxyCodeLine{07836\ \ \ \textcolor{comment}{//\ Temporary\ hack\ to\ try\ working\ around\ an\ apparent\ driver\ bug\ on\ iMacs.}}
\DoxyCodeLine{07837\ \ \ \textcolor{comment}{//\ Occlusion\ queries\ sometimes\ incorrectly\ report\ 0\ samples,\ unless\ we\ stall}}
\DoxyCodeLine{07838\ \ \ \textcolor{comment}{//\ the\ pipe\ to\ keep\ fewer\ than\ a\ certain\ maximum\ number\ of\ queries\ pending}}
\DoxyCodeLine{07839\ \ \ \textcolor{comment}{//\ at\ once.}}
\DoxyCodeLine{07840\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classConfigVariableInt}{ConfigVariableInt}}\ limit\_occlusion\_queries(\textcolor{stringliteral}{"{}limit-\/occlusion-\/queries"{}},\ 0);}
\DoxyCodeLine{07841\ \ \ \textcolor{keywordflow}{if}\ (limit\_occlusion\_queries\ >\ 0)\ \{}
\DoxyCodeLine{07842\ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})limit\_occlusion\_queries)\ \{}
\DoxyCodeLine{07843\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_wait\_occlusion\_pcollector);}
\DoxyCodeLine{07844\ \ \ \ \ \ \ GLuint\ result;}
\DoxyCodeLine{07845\ \ \ \ \ \ \ \_glGetQueryObjectuiv(index\ -\/\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int})limit\_occlusion\_queries,}
\DoxyCodeLine{07846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_QUERY\_RESULT,\ \&result);}
\DoxyCodeLine{07847\ \ \ \ \ \}}
\DoxyCodeLine{07848\ \ \ \}}
\DoxyCodeLine{07849\ }
\DoxyCodeLine{07850\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{07851\ }
\DoxyCodeLine{07852\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{07853\ \}}
\DoxyCodeLine{07854\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{07855\ }
\DoxyCodeLine{07860\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07861\ issue\_timer\_query(int\ pstats\_index)\ \{}
\DoxyCodeLine{07862\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{07863\ \ \ FrameTiming\ *frame\ =\ \_current\_frame\_timing;}
\DoxyCodeLine{07864\ \ \ \textcolor{keywordflow}{if}\ (frame\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07865\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07866\ \ \ \}}
\DoxyCodeLine{07867\ }
\DoxyCodeLine{07868\ \ \ nassertv(\_supports\_timer\_query);}
\DoxyCodeLine{07869\ }
\DoxyCodeLine{07870\ \ \ \textcolor{keywordflow}{if}\ (\_deleted\_queries.empty())\ \{}
\DoxyCodeLine{07871\ \ \ \ \ \textcolor{comment}{//\ Allocate\ some\ number\ at\ a\ time,\ since\ we'll\ need\ a\ lot\ of\ these.}}
\DoxyCodeLine{07872\ \ \ \ \ \_deleted\_queries.resize(\_deleted\_queries.size()\ +\ 16);}
\DoxyCodeLine{07873\ \ \ \ \ \_glGenQueries(16,\ \_deleted\_queries.data()\ +\ \_deleted\_queries.size()\ -\/\ 16);}
\DoxyCodeLine{07874\ \ \ \}}
\DoxyCodeLine{07875\ }
\DoxyCodeLine{07876\ \ \ GLuint\ index\ =\ \_deleted\_queries.back();}
\DoxyCodeLine{07877\ \ \ \_deleted\_queries.pop\_back();}
\DoxyCodeLine{07878\ }
\DoxyCodeLine{07879\ \ \ \textcolor{comment}{//\ Issue\ the\ timestamp\ query.}}
\DoxyCodeLine{07880\ \ \ \_glQueryCounter(index,\ GL\_TIMESTAMP);}
\DoxyCodeLine{07881\ }
\DoxyCodeLine{07882\ \ \ \textcolor{comment}{//if\ (\_use\_object\_labels)\ \{}}
\DoxyCodeLine{07883\ \ \ \textcolor{comment}{//\ \ //\ Assign\ a\ label\ to\ it\ based\ on\ the\ PStatCollector\ name.}}
\DoxyCodeLine{07884\ \ \ \textcolor{comment}{//\ \ const\ PStatClient\ *client\ =\ PStatClient::get\_global\_pstats();}}
\DoxyCodeLine{07885\ \ \ \textcolor{comment}{//\ \ string\ name\ =\ client-\/>get\_collector\_fullname(pstats\_index\ \&\ 0x7fff);}}
\DoxyCodeLine{07886\ \ \ \textcolor{comment}{//\ \ \_glObjectLabel(GL\_QUERY,\ index,\ name.size(),\ name.data());}}
\DoxyCodeLine{07887\ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{07888\ }
\DoxyCodeLine{07889\ \ \ frame-\/>\_queries.push\_back(std::make\_pair(index,\ pstats\_index));}
\DoxyCodeLine{07890\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07891\ \}}
\DoxyCodeLine{07892\ }
\DoxyCodeLine{07898\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07899\ issue\_latency\_query(int\ pstats\_index)\ \{}
\DoxyCodeLine{07900\ \textcolor{preprocessor}{\#if\ defined(DO\_PSTATS)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{07901\ \ \ FrameTiming\ *frame\ =\ \_current\_frame\_timing;}
\DoxyCodeLine{07902\ \ \ \textcolor{keywordflow}{if}\ (frame\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{07903\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{07904\ \ \ \}}
\DoxyCodeLine{07905\ }
\DoxyCodeLine{07906\ \ \ GLint64\ time;}
\DoxyCodeLine{07907\ \ \ \_glGetInteger64v(GL\_TIMESTAMP,\ \&time);}
\DoxyCodeLine{07908\ \ \ issue\_timer\_query(pstats\_index\ |\ 0x10000);}
\DoxyCodeLine{07909\ }
\DoxyCodeLine{07910\ \ \ frame-\/>\_latency\_refs.push\_back(time);}
\DoxyCodeLine{07911\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07912\ \}}
\DoxyCodeLine{07913\ }
\DoxyCodeLine{07914\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{07919\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07920\ dispatch\_compute(int\ num\_groups\_x,\ int\ num\_groups\_y,\ int\ num\_groups\_z)\ \{}
\DoxyCodeLine{07921\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{07922\ }
\DoxyCodeLine{07923\ \ \ nassertv(get\_supports\_compute\_shaders());}
\DoxyCodeLine{07924\ \ \ nassertv(\_current\_shader\_context\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{07925\ \ \ CLP(\mbox{\hyperlink{classShaderContext}{ShaderContext}})\ *gsc;}
\DoxyCodeLine{07926\ \ \ DCAST\_INTO\_V(gsc,\ \_current\_shader\_context);}
\DoxyCodeLine{07927\ }
\DoxyCodeLine{07928\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{07929\ \ \ \_compute\_work\_groups\_pcollector.add\_level(num\_groups\_x\ *\ num\_groups\_y\ *\ num\_groups\_z);}
\DoxyCodeLine{07930\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ gsc-\/>\_compute\_dispatch\_pcollector);}
\DoxyCodeLine{07931\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{07932\ }
\DoxyCodeLine{07933\ \ \ gsc-\/>issue\_memory\_barriers();}
\DoxyCodeLine{07934\ }
\DoxyCodeLine{07935\ \ \ \_glDispatchCompute(num\_groups\_x,\ num\_groups\_y,\ num\_groups\_z);}
\DoxyCodeLine{07936\ }
\DoxyCodeLine{07937\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{07938\ \}}
\DoxyCodeLine{07939\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{07940\ }
\DoxyCodeLine{07945\ PT(\mbox{\hyperlink{classGeomMunger}{GeomMunger}})\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07946\ make\_geom\_munger(const\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *state,\ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{07947\ \ \ PT(CLP(\mbox{\hyperlink{classGeomMunger}{GeomMunger}}))\ munger\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classGeomMunger}{GeomMunger}})(\textcolor{keyword}{this},\ state);}
\DoxyCodeLine{07948\ \ \ \textcolor{keywordflow}{return}\ GeomMunger::register\_munger(munger,\ current\_thread);}
\DoxyCodeLine{07949\ \}}
\DoxyCodeLine{07950\ }
\DoxyCodeLine{07957\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{07958\ framebuffer\_copy\_to\_texture(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ int\ view,\ int\ z,}
\DoxyCodeLine{07959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr,\ const\ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ \&rb)\ \{}
\DoxyCodeLine{07960\ \ \ nassertr(tex\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ dr\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{07961\ \ \ set\_read\_buffer(rb.\_buffer\_type);}
\DoxyCodeLine{07962\ \ \ clear\_color\_write\_mask();}
\DoxyCodeLine{07963\ }
\DoxyCodeLine{07964\ \ \ \textcolor{keywordtype}{int}\ xo,\ yo,\ w,\ h;}
\DoxyCodeLine{07965\ \ \ dr-\/>get\_region\_pixels(xo,\ yo,\ w,\ h);}
\DoxyCodeLine{07966\ \ \ tex-\/>\mbox{\hyperlink{classTexture_ada1263a8e1050b11ea5bfe007cb34a83}{set\_size\_padded}}(w,\ h,\ tex-\/>get\_z\_size());}
\DoxyCodeLine{07967\ }
\DoxyCodeLine{07968\ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_compression()\ ==\ Texture::CM\_default)\ \{}
\DoxyCodeLine{07969\ \ \ \ \ \textcolor{comment}{//\ Unless\ the\ user\ explicitly\ turned\ on\ texture\ compression,\ turn\ it\ off}}
\DoxyCodeLine{07970\ \ \ \ \ \textcolor{comment}{//\ for\ the\ copy-\/to-\/texture\ case.}}
\DoxyCodeLine{07971\ \ \ \ \ tex-\/>set\_compression(Texture::CM\_off);}
\DoxyCodeLine{07972\ \ \ \}}
\DoxyCodeLine{07973\ }
\DoxyCodeLine{07974\ \ \ \textcolor{comment}{//\ Sanity\ check\ everything.}}
\DoxyCodeLine{07975\ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ 0)\ \{}
\DoxyCodeLine{07976\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ tex-\/>get\_z\_size())\ \{}
\DoxyCodeLine{07977\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ can\ happen,\ when\ textures\ with\ different\ layer\ counts\ are}}
\DoxyCodeLine{07978\ \ \ \ \ \ \ \textcolor{comment}{//\ attached\ to\ a\ buffer.\ \ We\ simply\ ignore\ this\ if\ it\ happens.}}
\DoxyCodeLine{07979\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07980\ \ \ \ \ \}}
\DoxyCodeLine{07981\ }
\DoxyCodeLine{07982\ \ \ \ \ \textcolor{keywordflow}{if}\ ((w\ !=\ tex-\/>get\_x\_size())\ ||}
\DoxyCodeLine{07983\ \ \ \ \ \ \ \ \ (h\ !=\ tex-\/>get\_y\_size()))\ \{}
\DoxyCodeLine{07984\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07985\ \ \ \ \ \}}
\DoxyCodeLine{07986\ }
\DoxyCodeLine{07987\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_texture\_type()\ ==\ Texture::TT\_cube\_map)\ \{}
\DoxyCodeLine{07988\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_cube\_map)\ \{}
\DoxyCodeLine{07989\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07990\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07991\ }
\DoxyCodeLine{07992\ \ \ \ \ \ \ nassertr(z\ <\ 6,\ \textcolor{keyword}{false});}
\DoxyCodeLine{07993\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ !=\ h)\ \{}
\DoxyCodeLine{07994\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{07995\ \ \ \ \ \ \ \}}
\DoxyCodeLine{07996\ }
\DoxyCodeLine{07997\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_texture\_type()\ ==\ Texture::TT\_3d\_texture)\ \{}
\DoxyCodeLine{07998\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{07999\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08000\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08001\ }
\DoxyCodeLine{08002\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_texture\_type()\ ==\ Texture::TT\_2d\_texture\_array)\ \{}
\DoxyCodeLine{08003\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{08004\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08005\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08006\ }
\DoxyCodeLine{08007\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_texture\_type()\ ==\ Texture::TT\_cube\_map\_array)\ \{}
\DoxyCodeLine{08008\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_cube\_map\_array)\ \{}
\DoxyCodeLine{08009\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{08010\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08011\ }
\DoxyCodeLine{08012\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08013\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{08014\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Don't\ know\ how\ to\ copy\ framebuffer\ to\ texture\ "{}}\ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{08015\ \ \ \ \ \}}
\DoxyCodeLine{08016\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08017\ \ \ \ \ nassertr(tex-\/>get\_texture\_type()\ ==\ Texture::TT\_2d\_texture,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08018\ \ \ \}}
\DoxyCodeLine{08019\ }
\DoxyCodeLine{08020\ \ \ \textcolor{comment}{//\ Match\ framebuffer\ format\ if\ necessary.}}
\DoxyCodeLine{08021\ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_match\_framebuffer\_format())\ \{}
\DoxyCodeLine{08022\ }
\DoxyCodeLine{08023\ \ \ \ \ \textcolor{keywordflow}{switch}\ (tex-\/>get\_format())\ \{}
\DoxyCodeLine{08024\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{08025\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{08026\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{08027\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{08028\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{08029\ \ \ \ \ \ \ \textcolor{comment}{//\ Don't\ remap\ if\ we're\ one\ of\ these\ special\ format.}}
\DoxyCodeLine{08030\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08031\ }
\DoxyCodeLine{08032\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08033\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ is\ a\ color\ format,\ we\ want\ to\ match\ the\ presence\ of}}
\DoxyCodeLine{08034\ \ \ \ \ \ \ \textcolor{comment}{//\ sRGB\ and\ alpha\ according\ to\ the\ framebuffer.}}
\DoxyCodeLine{08035\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_srgb\_color())\ \{}
\DoxyCodeLine{08036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_alpha\_bits())\ \{}
\DoxyCodeLine{08037\ \ \ \ \ \ \ \ \ \ \ tex-\/>set\_format(Texture::F\_srgb\_alpha);}
\DoxyCodeLine{08038\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08039\ \ \ \ \ \ \ \ \ \ \ tex-\/>set\_format(Texture::F\_srgb);}
\DoxyCodeLine{08040\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08041\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_alpha\_bits())\ \{}
\DoxyCodeLine{08043\ \ \ \ \ \ \ \ \ \ \ tex-\/>set\_format(Texture::F\_rgba);}
\DoxyCodeLine{08044\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08045\ \ \ \ \ \ \ \ \ \ \ tex-\/>set\_format(Texture::F\_rgb);}
\DoxyCodeLine{08046\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08047\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08048\ \ \ \ \ \}}
\DoxyCodeLine{08049\ \ \ \}}
\DoxyCodeLine{08050\ }
\DoxyCodeLine{08051\ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ tex-\/>\mbox{\hyperlink{classTexture_a6b3856662e05f463811735252aaae40f}{prepare\_now}}(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{08052\ \ \ nassertr(tc\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{08053\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ DCAST(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}}),\ tc);}
\DoxyCodeLine{08054\ }
\DoxyCodeLine{08055\ \ \ gtc-\/>cancel\_pending\_uploads();}
\DoxyCodeLine{08056\ }
\DoxyCodeLine{08057\ \ \ GLenum\ target\ =\ get\_texture\_target(tex-\/>get\_texture\_type());}
\DoxyCodeLine{08058\ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_target\ !=\ target)\ \{}
\DoxyCodeLine{08059\ \ \ \ \ gtc-\/>reset\_data(target,\ view\ +\ 1);}
\DoxyCodeLine{08060\ \ \ \}}
\DoxyCodeLine{08061\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (view\ >=\ gtc-\/>\_num\_views)\ \{}
\DoxyCodeLine{08062\ \ \ \ \ gtc-\/>set\_num\_views(view\ +\ 1);}
\DoxyCodeLine{08063\ \ \ \}}
\DoxyCodeLine{08064\ }
\DoxyCodeLine{08065\ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{08066\ \ \ \textcolor{keywordtype}{bool}\ needs\_reload\ =\ specify\_texture(gtc,\ tex-\/>get\_default\_sampler());}
\DoxyCodeLine{08067\ }
\DoxyCodeLine{08068\ \ \ GLint\ internal\_format\ =\ get\_internal\_image\_format(tex);}
\DoxyCodeLine{08069\ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_x\_size();}
\DoxyCodeLine{08070\ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_y\_size();}
\DoxyCodeLine{08071\ \ \ \textcolor{keywordtype}{int}\ depth\ =\ tex-\/>get\_z\_size();}
\DoxyCodeLine{08072\ }
\DoxyCodeLine{08073\ \ \ \textcolor{keywordtype}{bool}\ uses\_mipmaps\ =\ tex-\/>uses\_mipmaps()\ \&\&\ !gl\_ignore\_mipmaps;}
\DoxyCodeLine{08074\ \ \ \textcolor{keywordtype}{int}\ num\_levels\ =\ 1;}
\DoxyCodeLine{08075\ \ \ \textcolor{keywordtype}{bool}\ can\_generate\ =\ \_supports\_generate\_mipmap;}
\DoxyCodeLine{08076\ \textcolor{preprocessor}{\#if\ defined(OPENGLES)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{08077\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ doesn't\ support\ generating\ mipmaps\ for\ sRGB\ textures,\ so\ we}}
\DoxyCodeLine{08078\ \ \ \textcolor{comment}{//\ have\ to\ disable\ mipmaps,\ unless\ we\ have\ a\ special\ extension.}}
\DoxyCodeLine{08079\ \ \ \textcolor{keywordflow}{if}\ (internal\_format\ ==\ GL\_SRGB8\ ||\ internal\_format\ ==\ GL\_SRGB8\_ALPHA8)\ \{}
\DoxyCodeLine{08080\ \ \ \ \ can\_generate\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_generate\_mipmap\_sRGB"{}});}
\DoxyCodeLine{08081\ \ \ \}}
\DoxyCodeLine{08082\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08083\ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps)\ \{}
\DoxyCodeLine{08084\ \ \ \ \ \textcolor{keywordflow}{if}\ (can\_generate)\ \{}
\DoxyCodeLine{08085\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{08086\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glGenerateMipmap\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08087\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_GENERATE\_MIPMAP,\ \textcolor{keyword}{true});}
\DoxyCodeLine{08088\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08089\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08090\ \ \ \ \ \ \ num\_levels\ =\ tex-\/>get\_expected\_num\_mipmap\_levels();}
\DoxyCodeLine{08091\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08092\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ can't\ auto-\/generate\ mipmaps,\ do\ without\ mipmaps.}}
\DoxyCodeLine{08093\ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MIN\_FILTER,\ GL\_LINEAR);}
\DoxyCodeLine{08094\ \ \ \ \ \ \ uses\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{08095\ \ \ \ \ \}}
\DoxyCodeLine{08096\ \ \ \}}
\DoxyCodeLine{08097\ }
\DoxyCodeLine{08098\ \ \ \textcolor{keywordtype}{bool}\ new\_image\ =\ needs\_reload\ ||\ gtc-\/>was\_image\_modified();}
\DoxyCodeLine{08099\ }
\DoxyCodeLine{08100\ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ 0)\ \{}
\DoxyCodeLine{08101\ \ \ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_CUBE\_MAP)\ \{}
\DoxyCodeLine{08102\ \ \ \ \ \ \ \textcolor{comment}{//\ Copy\ to\ a\ cube\ map\ face,\ which\ is\ treated\ as\ a\ 2D\ texture.}}
\DoxyCodeLine{08103\ \ \ \ \ \ \ target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X\ +\ z;}
\DoxyCodeLine{08104\ \ \ \ \ \ \ depth\ =\ 1;}
\DoxyCodeLine{08105\ \ \ \ \ \ \ z\ =\ -\/1;}
\DoxyCodeLine{08106\ }
\DoxyCodeLine{08107\ \ \ \ \ \ \ \textcolor{comment}{//\ Cube\ map\ faces\ seem\ to\ have\ trouble\ with\ CopyTexSubImage,\ so\ we}}
\DoxyCodeLine{08108\ \ \ \ \ \ \ \textcolor{comment}{//\ always\ reload\ the\ image.}}
\DoxyCodeLine{08109\ \ \ \ \ \ \ new\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{08110\ \ \ \ \ \}}
\DoxyCodeLine{08111\ \ \ \}}
\DoxyCodeLine{08112\ }
\DoxyCodeLine{08113\ \ \ \textcolor{keywordflow}{if}\ (!gtc-\/>\_has\_storage\ ||}
\DoxyCodeLine{08114\ \ \ \ \ \ \ internal\_format\ !=\ gtc-\/>\_internal\_format\ ||}
\DoxyCodeLine{08115\ \ \ \ \ \ \ width\ !=\ gtc-\/>\_width\ ||}
\DoxyCodeLine{08116\ \ \ \ \ \ \ height\ !=\ gtc-\/>\_height\ ||}
\DoxyCodeLine{08117\ \ \ \ \ \ \ depth\ !=\ gtc-\/>\_depth\ ||}
\DoxyCodeLine{08118\ \ \ \ \ \ \ (gtc-\/>\_immutable\ \&\&\ num\_levels\ >\ gtc-\/>\_num\_levels))\ \{}
\DoxyCodeLine{08119\ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ properties\ have\ changed,\ we\ need\ to\ reload\ the\ image.}}
\DoxyCodeLine{08120\ \ \ \ \ new\_image\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{08121\ \ \ \}}
\DoxyCodeLine{08122\ }
\DoxyCodeLine{08123\ \ \ \textcolor{keywordflow}{if}\ (new\_image\ \&\&\ gtc-\/>\_immutable)\ \{}
\DoxyCodeLine{08124\ \ \ \ \ gtc-\/>reset\_data(target,\ view\ +\ 1);}
\DoxyCodeLine{08125\ \ \ \ \ GLuint\ index\ =\ gtc-\/>get\_view\_index(view);}
\DoxyCodeLine{08126\ \ \ \ \ glBindTexture(target,\ index);}
\DoxyCodeLine{08127\ }
\DoxyCodeLine{08128\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{08129\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{08130\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(0x"{}}\ <<\ hex\ <<\ target\ <<\ dec\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}}
\DoxyCodeLine{08131\ \ \ \ \ \ \ \ \ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{08132\ \ \ \ \ \}}
\DoxyCodeLine{08133\ \ \ \}}
\DoxyCodeLine{08134\ }
\DoxyCodeLine{08135\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08136\ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>needs\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT,\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{08137\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ any\ reads\ and\ writes\ to\ this\ texture\ have\ been\ synced.}}
\DoxyCodeLine{08138\ \ \ \ \ issue\_memory\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT);}
\DoxyCodeLine{08139\ \ \ \}}
\DoxyCodeLine{08140\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08141\ }
\DoxyCodeLine{08142\ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ 0)\ \{}
\DoxyCodeLine{08143\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08144\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_image)\ \{}
\DoxyCodeLine{08145\ \ \ \ \ \ \ \textcolor{comment}{//\ These\ won't\ be\ used\ because\ we\ pass\ a\ NULL\ image,\ but\ we\ still\ have}}
\DoxyCodeLine{08146\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ specify\ them.\ \ Might\ as\ well\ use\ the\ actual\ values.}}
\DoxyCodeLine{08147\ \ \ \ \ \ \ GLint\ external\_format\ =\ get\_external\_image\_format(tex);}
\DoxyCodeLine{08148\ \ \ \ \ \ \ GLint\ component\_type\ =\ get\_component\_type(tex-\/>get\_component\_type());}
\DoxyCodeLine{08149\ \ \ \ \ \ \ \_glTexImage3D(target,\ 0,\ internal\_format,\ width,\ height,\ depth,\ 0,\ external\_format,\ component\_type,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{08150\ \ \ \ \ \}}
\DoxyCodeLine{08151\ }
\DoxyCodeLine{08152\ \ \ \ \ \_glCopyTexSubImage3D(target,\ 0,\ 0,\ 0,\ z,\ xo,\ yo,\ w,\ h);}
\DoxyCodeLine{08153\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08154\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08155\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_image)\ \{}
\DoxyCodeLine{08156\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ create\ a\ new\ image.\ \ It\ seems\ that\ OpenGL\ accepts\ a\ size}}
\DoxyCodeLine{08157\ \ \ \ \ \ \ \textcolor{comment}{//\ higher\ than\ the\ framebuffer,\ but\ if\ we\ run\ into\ trouble\ we'll\ have\ to}}
\DoxyCodeLine{08158\ \ \ \ \ \ \ \textcolor{comment}{//\ replace\ this\ with\ something\ smarter.}}
\DoxyCodeLine{08159\ \ \ \ \ \ \ glCopyTexImage2D(target,\ 0,\ internal\_format,\ xo,\ yo,\ width,\ height,\ 0);}
\DoxyCodeLine{08160\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08161\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can\ overlay\ the\ existing\ image.}}
\DoxyCodeLine{08162\ \ \ \ \ \ \ glCopyTexSubImage2D(target,\ 0,\ 0,\ 0,\ xo,\ yo,\ w,\ h);}
\DoxyCodeLine{08163\ \ \ \ \ \}}
\DoxyCodeLine{08164\ \ \ \}}
\DoxyCodeLine{08165\ }
\DoxyCodeLine{08166\ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps\ \&\&\ \_glGenerateMipmap\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08167\ \ \ \ \ glEnable(target);}
\DoxyCodeLine{08168\ \ \ \ \ \_glGenerateMipmap(target);}
\DoxyCodeLine{08169\ \ \ \ \ glDisable(target);}
\DoxyCodeLine{08170\ \ \ \}}
\DoxyCodeLine{08171\ }
\DoxyCodeLine{08172\ \ \ gtc-\/>\_has\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{08173\ \ \ gtc-\/>\_internal\_format\ =\ internal\_format;}
\DoxyCodeLine{08174\ \ \ gtc-\/>\_width\ =\ width;}
\DoxyCodeLine{08175\ \ \ gtc-\/>\_height\ =\ height;}
\DoxyCodeLine{08176\ \ \ gtc-\/>\_depth\ =\ depth;}
\DoxyCodeLine{08177\ \ \ gtc-\/>\_num\_levels\ =\ num\_levels;}
\DoxyCodeLine{08178\ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ !uses\_mipmaps\ \&\&\ can\_generate;}
\DoxyCodeLine{08179\ }
\DoxyCodeLine{08180\ \ \ gtc-\/>mark\_loaded();}
\DoxyCodeLine{08181\ \ \ gtc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{08182\ }
\DoxyCodeLine{08183\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08184\ }
\DoxyCodeLine{08185\ \ \ \textcolor{comment}{//\ Force\ reload\ of\ texture\ state,\ since\ we've\ just\ monkeyed\ with\ it.}}
\DoxyCodeLine{08186\ \ \ \_state\_mask.clear\_bit(TextureAttrib::get\_class\_slot());}
\DoxyCodeLine{08187\ }
\DoxyCodeLine{08188\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{08189\ \}}
\DoxyCodeLine{08190\ }
\DoxyCodeLine{08198\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08199\ framebuffer\_copy\_to\_ram(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ int\ view,\ int\ z,}
\DoxyCodeLine{08200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr,\ const\ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ \&rb,}
\DoxyCodeLine{08201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}}\ *request)\ \{}
\DoxyCodeLine{08202\ \ \ nassertr(tex\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ dr\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{08203\ \ \ set\_read\_buffer(rb.\_buffer\_type);}
\DoxyCodeLine{08204\ \ \ glPixelStorei(GL\_PACK\_ALIGNMENT,\ 1);}
\DoxyCodeLine{08205\ \ \ clear\_color\_write\_mask();}
\DoxyCodeLine{08206\ }
\DoxyCodeLine{08207\ \ \ \textcolor{comment}{//\ Bug\ fix\ for\ RE,\ RE2,\ and\ VTX\ -\/\ need\ to\ disable\ texturing\ in\ order\ for}}
\DoxyCodeLine{08208\ \ \ \textcolor{comment}{//\ glReadPixels()\ to\ work\ NOTE:\ reading\ the\ depth\ buffer\ is\ *much*\ slower}}
\DoxyCodeLine{08209\ \ \ \textcolor{comment}{//\ than\ reading\ the\ color\ buffer}}
\DoxyCodeLine{08210\ \ \ set\_state\_and\_transform(RenderState::make\_empty(),\ \_internal\_transform);}
\DoxyCodeLine{08211\ }
\DoxyCodeLine{08212\ \ \ \textcolor{keywordtype}{int}\ xo,\ yo,\ w,\ h;}
\DoxyCodeLine{08213\ \ \ dr-\/>get\_region\_pixels(xo,\ yo,\ w,\ h);}
\DoxyCodeLine{08214\ }
\DoxyCodeLine{08215\ \ \ Texture::ComponentType\ component\_type\ =\ tex-\/>get\_component\_type();}
\DoxyCodeLine{08216\ }
\DoxyCodeLine{08217\ \ \ Texture::Format\ format\ =\ tex-\/>get\_format();}
\DoxyCodeLine{08218\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{08219\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{08220\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_float\_depth())\ \{}
\DoxyCodeLine{08221\ \ \ \ \ \ \ \textcolor{comment}{//NB.\ In\ the\ future\ we\ may\ need\ a\ T\_float\_32\_unsigned\_int\_24\_8\ format,\ but}}
\DoxyCodeLine{08222\ \ \ \ \ \ \ \textcolor{comment}{//\ for\ now\ we'll\ just\ try\ to\ grab\ the\ depth\ component.}}
\DoxyCodeLine{08223\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_float;}
\DoxyCodeLine{08224\ \ \ \ \ \ \ format\ =\ Texture::F\_depth\_component32;}
\DoxyCodeLine{08225\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08226\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_int\_24\_8;}
\DoxyCodeLine{08227\ \ \ \ \ \}}
\DoxyCodeLine{08228\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08229\ }
\DoxyCodeLine{08230\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{08231\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_float\_depth())\ \{}
\DoxyCodeLine{08232\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_float;}
\DoxyCodeLine{08233\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_depth\_bits()\ <=\ 8)\ \{}
\DoxyCodeLine{08234\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{08235\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_depth\_bits()\ <=\ 16)\ \{}
\DoxyCodeLine{08236\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{08237\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08238\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_float;}
\DoxyCodeLine{08239\ \ \ \ \ \}}
\DoxyCodeLine{08240\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08241\ }
\DoxyCodeLine{08242\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{08243\ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{08244\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08245\ }
\DoxyCodeLine{08246\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{08247\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{08248\ \ \ \ \ component\_type\ =\ Texture::T\_float;}
\DoxyCodeLine{08249\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08250\ }
\DoxyCodeLine{08251\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08252\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_srgb\_color())\ \{}
\DoxyCodeLine{08253\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_alpha\_bits())\ \{}
\DoxyCodeLine{08254\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{08255\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08256\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_srgb;}
\DoxyCodeLine{08257\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08258\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_float\_color())\ \{}
\DoxyCodeLine{08259\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_alpha\_bits())\ \{}
\DoxyCodeLine{08260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08261\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08262\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_blue\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08263\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_alpha\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08264\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgba16;}
\DoxyCodeLine{08265\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08266\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgba32;}
\DoxyCodeLine{08267\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08268\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_blue\_bits())\ \{}
\DoxyCodeLine{08269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 11\ \&\&}
\DoxyCodeLine{08270\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 11\ \&\&}
\DoxyCodeLine{08271\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_blue\_bits()\ ==\ 10)\ \{}
\DoxyCodeLine{08272\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_r11\_g11\_b10;}
\DoxyCodeLine{08273\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_blue\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08276\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgb16;}
\DoxyCodeLine{08277\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08278\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgb32;}
\DoxyCodeLine{08279\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08280\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_green\_bits())\ \{}
\DoxyCodeLine{08281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08282\ \ \ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08283\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rg16;}
\DoxyCodeLine{08284\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08285\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rg32;}
\DoxyCodeLine{08286\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08287\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08289\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_r16;}
\DoxyCodeLine{08290\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08291\ \ \ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_r32;}
\DoxyCodeLine{08292\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08293\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08294\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_alpha\_bits())\ \{}
\DoxyCodeLine{08295\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 10\ \&\&}
\DoxyCodeLine{08296\ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 10\ \&\&}
\DoxyCodeLine{08297\ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_blue\_bits()\ ==\ 10\ \&\&}
\DoxyCodeLine{08298\ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_alpha\_bits()\ ==\ 2)\ \{}
\DoxyCodeLine{08299\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgb10\_a2;}
\DoxyCodeLine{08300\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08301\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{08302\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08303\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_blue\_bits())\ \{}
\DoxyCodeLine{08304\ \ \ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{08305\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_green\_bits())\ \{}
\DoxyCodeLine{08306\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_red\_bits()\ ==\ 16\ \&\&}
\DoxyCodeLine{08307\ \ \ \ \ \ \ \ \ \ \ \_current\_properties-\/>get\_green\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08308\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rg16;}
\DoxyCodeLine{08309\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08310\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_rg;}
\DoxyCodeLine{08311\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08312\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08313\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_color\_bits()\ ==\ 16)\ \{}
\DoxyCodeLine{08314\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_r16;}
\DoxyCodeLine{08315\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08316\ \ \ \ \ \ \ \ \ format\ =\ Texture::F\_red;}
\DoxyCodeLine{08317\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08318\ \ \ \ \ \}}
\DoxyCodeLine{08319\ }
\DoxyCodeLine{08320\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_float\_color())\ \{}
\DoxyCodeLine{08321\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_float;}
\DoxyCodeLine{08322\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_color\_bits()\ <=\ 24}
\DoxyCodeLine{08323\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \_current\_properties-\/>get\_red\_bits()\ <=\ 8}
\DoxyCodeLine{08324\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \_current\_properties-\/>get\_green\_bits()\ <=\ 8}
\DoxyCodeLine{08325\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \_current\_properties-\/>get\_blue\_bits()\ <=\ 8}
\DoxyCodeLine{08326\ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ \_current\_properties-\/>get\_alpha\_bits()\ <=\ 8)\ \{}
\DoxyCodeLine{08327\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{08328\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08329\ \ \ \ \ \ \ component\_type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{08330\ \ \ \ \ \}}
\DoxyCodeLine{08331\ \ \ \}}
\DoxyCodeLine{08332\ }
\DoxyCodeLine{08333\ \ \ Texture::TextureType\ texture\_type;}
\DoxyCodeLine{08334\ \ \ \textcolor{keywordtype}{int}\ z\_size;}
\DoxyCodeLine{08335\ \ \ \textcolor{comment}{//\ TODO:\ should\ be\ extended\ to\ support\ 3D\ textures,\ 2D\ arrays\ and\ cube\ map}}
\DoxyCodeLine{08336\ \ \ \textcolor{comment}{//\ arrays.}}
\DoxyCodeLine{08337\ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ 0)\ \{}
\DoxyCodeLine{08338\ \ \ \ \ texture\_type\ =\ Texture::TT\_cube\_map;}
\DoxyCodeLine{08339\ \ \ \ \ z\_size\ =\ 6;}
\DoxyCodeLine{08340\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08341\ \ \ \ \ texture\_type\ =\ Texture::TT\_2d\_texture;}
\DoxyCodeLine{08342\ \ \ \ \ z\_size\ =\ 1;}
\DoxyCodeLine{08343\ \ \ \}}
\DoxyCodeLine{08344\ }
\DoxyCodeLine{08345\ \ \ \textcolor{keywordtype}{int}\ num\_views\ =\ tex-\/>get\_num\_views();}
\DoxyCodeLine{08346\ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_x\_size()\ !=\ w\ ||\ tex-\/>get\_y\_size()\ !=\ h\ ||}
\DoxyCodeLine{08347\ \ \ \ \ \ \ tex-\/>get\_z\_size()\ !=\ z\_size\ ||}
\DoxyCodeLine{08348\ \ \ \ \ \ \ tex-\/>get\_component\_type()\ !=\ component\_type\ ||}
\DoxyCodeLine{08349\ \ \ \ \ \ \ tex-\/>get\_format()\ !=\ format\ ||}
\DoxyCodeLine{08350\ \ \ \ \ \ \ tex-\/>get\_texture\_type()\ !=\ texture\_type\ ||}
\DoxyCodeLine{08351\ \ \ \ \ \ \ view\ >=\ num\_views)\ \{}
\DoxyCodeLine{08352\ }
\DoxyCodeLine{08353\ \ \ \ \ tex-\/>setup\_texture(texture\_type,\ w,\ h,\ z\_size,\ component\_type,\ format);}
\DoxyCodeLine{08354\ }
\DoxyCodeLine{08355\ \ \ \ \ \textcolor{comment}{//\ The\ above\ resets\ the\ number\ of\ views\ to\ 1,\ so\ set\ this\ back.}}
\DoxyCodeLine{08356\ \ \ \ \ num\_views\ =\ std::max(view\ +\ 1,\ num\_views);}
\DoxyCodeLine{08357\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_views\ >\ 1)\ \{}
\DoxyCodeLine{08358\ \ \ \ \ \ \ tex-\/>set\_num\_views(num\_views);}
\DoxyCodeLine{08359\ \ \ \ \ \}}
\DoxyCodeLine{08360\ \ \ \}}
\DoxyCodeLine{08361\ }
\DoxyCodeLine{08362\ \ \ nassertr(z\ <\ tex-\/>get\_z\_size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{08363\ }
\DoxyCodeLine{08364\ \ \ GLenum\ external\_format\ =\ get\_external\_image\_format(tex);}
\DoxyCodeLine{08365\ }
\DoxyCodeLine{08366\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ implementations\ may\ support\ BGRA,\ but\ that\ doesn't\ imply\ they}}
\DoxyCodeLine{08367\ \ \ \textcolor{comment}{//\ also\ support\ it\ for\ glReadPixels\ specifically.}}
\DoxyCodeLine{08368\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_bgra\_read\ \&\&\ external\_format\ ==\ GL\_BGRA)\ \{}
\DoxyCodeLine{08369\ \ \ \ \ external\_format\ =\ GL\_RGBA;}
\DoxyCodeLine{08370\ \ \ \}}
\DoxyCodeLine{08371\ }
\DoxyCodeLine{08372\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{08373\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{08374\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{08375\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glReadPixels("{}}\ <<\ xo\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ yo\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ w\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ h\ <<\ \textcolor{stringliteral}{"{},\ "{}};}
\DoxyCodeLine{08376\ \ \ \ \ \textcolor{keywordflow}{switch}\ (external\_format)\ \{}
\DoxyCodeLine{08377\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT:}
\DoxyCodeLine{08378\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_DEPTH\_COMPONENT,\ "{}};}
\DoxyCodeLine{08379\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08380\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_STENCIL:}
\DoxyCodeLine{08381\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_DEPTH\_STENCIL,\ "{}};}
\DoxyCodeLine{08382\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08383\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08384\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_RG:}
\DoxyCodeLine{08385\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_RG,\ "{}};}
\DoxyCodeLine{08386\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08387\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08388\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_RGB:}
\DoxyCodeLine{08389\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_RGB,\ "{}};}
\DoxyCodeLine{08390\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08391\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA:}
\DoxyCodeLine{08392\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_RGBA,\ "{}};}
\DoxyCodeLine{08393\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08394\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{08395\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_BGR:}
\DoxyCodeLine{08396\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_BGR,\ "{}};}
\DoxyCodeLine{08397\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08398\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08399\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_BGRA:}
\DoxyCodeLine{08400\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_BGRA,\ "{}};}
\DoxyCodeLine{08401\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08402\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08403\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}unknown,\ "{}};}
\DoxyCodeLine{08404\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08405\ \ \ \ \ \}}
\DoxyCodeLine{08406\ \ \ \ \ \textcolor{keywordflow}{switch}\ (get\_component\_type(component\_type))\ \{}
\DoxyCodeLine{08407\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_BYTE:}
\DoxyCodeLine{08408\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_BYTE"{}};}
\DoxyCodeLine{08409\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08410\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT:}
\DoxyCodeLine{08411\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT"{}};}
\DoxyCodeLine{08412\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08413\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_FLOAT:}
\DoxyCodeLine{08414\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_FLOAT"{}};}
\DoxyCodeLine{08415\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08416\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_4\_4\_4\_4:}
\DoxyCodeLine{08417\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_4\_4\_4\_4"{}};}
\DoxyCodeLine{08418\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08419\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_5\_5\_5\_1:}
\DoxyCodeLine{08420\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_5\_5\_5\_1"{}};}
\DoxyCodeLine{08421\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08422\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_5\_6\_5:}
\DoxyCodeLine{08423\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_5\_6\_5"{}};}
\DoxyCodeLine{08424\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08425\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08426\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_INT:}
\DoxyCodeLine{08427\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_INT"{}};}
\DoxyCodeLine{08428\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08429\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_BYTE:}
\DoxyCodeLine{08430\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_BYTE"{}};}
\DoxyCodeLine{08431\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08432\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_SHORT:}
\DoxyCodeLine{08433\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_SHORT"{}};}
\DoxyCodeLine{08434\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08435\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT:}
\DoxyCodeLine{08436\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT"{}};}
\DoxyCodeLine{08437\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08438\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_HALF\_FLOAT:}
\DoxyCodeLine{08439\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_HALF\_FLOAT"{}};}
\DoxyCodeLine{08440\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08441\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08442\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{08443\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_BYTE\_3\_3\_2:}
\DoxyCodeLine{08444\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_BYTE\_3\_3\_2"{}};}
\DoxyCodeLine{08445\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08446\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_BYTE\_2\_3\_3\_REV:}
\DoxyCodeLine{08447\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_BYTE\_2\_3\_3\_REV"{}};}
\DoxyCodeLine{08448\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08449\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_5\_6\_5\_REV:}
\DoxyCodeLine{08450\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_5\_6\_5\_REV"{}};}
\DoxyCodeLine{08451\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08452\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_4\_4\_4\_4\_REV:}
\DoxyCodeLine{08453\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_4\_4\_4\_4\_REV"{}};}
\DoxyCodeLine{08454\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08455\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_SHORT\_1\_5\_5\_5\_REV:}
\DoxyCodeLine{08456\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_SHORT\_1\_5\_5\_5\_REV"{}};}
\DoxyCodeLine{08457\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08458\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_8\_8\_8\_8:}
\DoxyCodeLine{08459\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_8\_8\_8\_8"{}};}
\DoxyCodeLine{08460\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08461\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_8\_8\_8\_8\_REV:}
\DoxyCodeLine{08462\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_8\_8\_8\_8\_REV"{}};}
\DoxyCodeLine{08463\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08464\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_10\_10\_10\_2:}
\DoxyCodeLine{08465\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_10\_10\_10\_2"{}};}
\DoxyCodeLine{08466\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08467\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_2\_10\_10\_10\_REV:}
\DoxyCodeLine{08468\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_2\_10\_10\_10\_REV"{}};}
\DoxyCodeLine{08469\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08470\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_24\_8:}
\DoxyCodeLine{08471\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_24\_8"{}};}
\DoxyCodeLine{08472\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08473\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_10F\_11F\_11F\_REV:}
\DoxyCodeLine{08474\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_10F\_11F\_11F\_REV"{}};}
\DoxyCodeLine{08475\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08476\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_UNSIGNED\_INT\_5\_9\_9\_9\_REV:}
\DoxyCodeLine{08477\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_UNSIGNED\_INT\_5\_9\_9\_9\_REV"{}};}
\DoxyCodeLine{08478\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08479\ \ \ \ \ \textcolor{keywordflow}{case}\ GL\_FLOAT\_32\_UNSIGNED\_INT\_24\_8\_REV:}
\DoxyCodeLine{08480\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}GL\_FLOAT\_32\_UNSIGNED\_INT\_24\_8\_REV"{}};}
\DoxyCodeLine{08481\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08482\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08483\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08484\ \ \ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}unknown"{}};}
\DoxyCodeLine{08485\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08486\ \ \ \ \ \}}
\DoxyCodeLine{08487\ \ \ \ \ GLCAT.spam(\textcolor{keyword}{false})}
\DoxyCodeLine{08488\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{})"{}}\ <<\ endl;}
\DoxyCodeLine{08489\ \ \ \}}
\DoxyCodeLine{08490\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{08491\ }
\DoxyCodeLine{08492\ \ \ \textcolor{keywordtype}{size\_t}\ image\_size\ =\ tex-\/>get\_expected\_ram\_page\_size();}
\DoxyCodeLine{08493\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *image\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{08494\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08495\ \ \ GLuint\ pbo\ =\ 0;}
\DoxyCodeLine{08496\ \ \ \textcolor{keywordtype}{void}\ *mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{08497\ \ \ \textcolor{keywordflow}{if}\ (request\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08498\ \ \ \ \ nassertr(z\ <=\ 0,\ \textcolor{keyword}{false});}
\DoxyCodeLine{08499\ \ \ \ \ image\_size\ *=\ tex-\/>get\_z\_size();}
\DoxyCodeLine{08500\ \ \ \ \ bind\_new\_client\_buffer(pbo,\ mapped\_ptr,\ GL\_PIXEL\_PACK\_BUFFER,\ image\_size);}
\DoxyCodeLine{08501\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{08502\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08503\ \ \ \{}
\DoxyCodeLine{08504\ \ \ \ \ image\_ptr\ =\ tex-\/>modify\_ram\_image();}
\DoxyCodeLine{08505\ \ \ \ \ \textcolor{keywordflow}{if}\ (z\ >=\ 0)\ \{}
\DoxyCodeLine{08506\ \ \ \ \ \ \ image\_ptr\ +=\ z\ *\ image\_size;}
\DoxyCodeLine{08507\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08508\ \ \ \ \ \ \ image\_size\ =\ tex-\/>get\_ram\_image\_size();}
\DoxyCodeLine{08509\ \ \ \ \ \}}
\DoxyCodeLine{08510\ \ \ \ \ \textcolor{keywordflow}{if}\ (view\ >\ 0)\ \{}
\DoxyCodeLine{08511\ \ \ \ \ \ \ image\_ptr\ +=\ (view\ *\ tex-\/>get\_z\_size())\ *\ image\_size;}
\DoxyCodeLine{08512\ \ \ \ \ \ \ nassertr(view\ <\ tex-\/>get\_num\_views(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{08513\ \ \ \ \ \}}
\DoxyCodeLine{08514\ \ \ \}}
\DoxyCodeLine{08515\ }
\DoxyCodeLine{08516\ \ \ glReadPixels(xo,\ yo,\ w,\ h,\ external\_format,}
\DoxyCodeLine{08517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_component\_type(component\_type),\ image\_ptr);}
\DoxyCodeLine{08518\ }
\DoxyCodeLine{08519\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08520\ \ \ \textcolor{keywordflow}{if}\ (request\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08521\ \ \ \ \ \_glBindBuffer(GL\_PIXEL\_PACK\_BUFFER,\ 0);}
\DoxyCodeLine{08522\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{08523\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{08524\ \ \ \ \ \ \ \_glMemoryBarrier(GL\_CLIENT\_MAPPED\_BUFFER\_BARRIER\_BIT);}
\DoxyCodeLine{08525\ \ \ \ \ \}}
\DoxyCodeLine{08526\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08527\ }
\DoxyCodeLine{08528\ \ \ \ \ insert\_fence([}
\DoxyCodeLine{08529\ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},\ request\ =\ PT(\mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}})(request),}
\DoxyCodeLine{08530\ \ \ \ \ \ \ \ \ mapped\_ptr,\ size\ =\ image\_size,}
\DoxyCodeLine{08531\ \ \ \ \ \ \ \ \ pbo,\ view,\ external\_format}
\DoxyCodeLine{08532\ \ \ \ \ \ \ ]\ (\textcolor{keywordtype}{bool}\ success)\ \{}
\DoxyCodeLine{08533\ }
\DoxyCodeLine{08534\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *ptr\ =\ mapped\_ptr;}
\DoxyCodeLine{08535\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08536\ \ \ \ \ \ \ \ \ ptr\ =\ map\_read\_buffer(GL\_PIXEL\_PACK\_BUFFER,\ pbo,\ size);}
\DoxyCodeLine{08537\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08538\ }
\DoxyCodeLine{08539\ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ the\ memcpy\ in\ the\ background,\ since\ it\ can\ be\ slow.}}
\DoxyCodeLine{08540\ \ \ \ \ \ \ \textcolor{keyword}{auto}\ func\ =\ [=](\mbox{\hyperlink{classAsyncTask}{AsyncTask}}\ *task)\ \{}
\DoxyCodeLine{08541\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *result\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)ptr;}
\DoxyCodeLine{08542\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ new\_image;}
\DoxyCodeLine{08543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (external\_format\ ==\ GL\_RGBA\ ||\ external\_format\ ==\ GL\_RGB)\ \{}
\DoxyCodeLine{08544\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ may\ have\ to\ reverse\ the\ byte\ ordering\ of\ the\ image\ if\ GL\ didn't\ do}}
\DoxyCodeLine{08545\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ it\ for\ us.}}
\DoxyCodeLine{08546\ \ \ \ \ \ \ \ \ \ \ result\ =\ fix\_component\_ordering(new\_image,\ result,\ size,}
\DoxyCodeLine{08547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ request-\/>get\_result());}
\DoxyCodeLine{08548\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{08549\ \ \ \ \ \ \ \ \ request-\/>set\_view\_data(view,\ result);}
\DoxyCodeLine{08550\ }
\DoxyCodeLine{08551\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Finishing\ can\ take\ a\ long\ time,\ release\ the\ client\ buffer\ first\ so\ it}}
\DoxyCodeLine{08552\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ can\ be\ reused\ for\ the\ next\ screenshot.}}
\DoxyCodeLine{08553\ \ \ \ \ \ \ \ \ this-\/>release\_client\_buffer(pbo,\ ptr,\ size);}
\DoxyCodeLine{08554\ \ \ \ \ \ \ \ \ request-\/>finish();}
\DoxyCodeLine{08555\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AsyncTask::DS\_done;}
\DoxyCodeLine{08556\ \ \ \ \ \ \ \};}
\DoxyCodeLine{08557\ \textcolor{preprocessor}{\#ifdef\ HAVE\_THREADS}}
\DoxyCodeLine{08558\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ assign\ a\ sort\ value\ based\ on\ the\ originating\ frame\ number,\ so\ that}}
\DoxyCodeLine{08559\ \ \ \ \ \ \ \textcolor{comment}{//\ earlier\ frames\ will\ be\ processed\ before\ subsequent\ frames,\ but\ we\ don't}}
\DoxyCodeLine{08560\ \ \ \ \ \ \ \textcolor{comment}{//\ make\ it\ unique\ for\ every\ frame,\ which\ would\ kill\ concurrency.}}
\DoxyCodeLine{08561\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ frame\_number\ =\ request-\/>get\_frame\_number();}
\DoxyCodeLine{08562\ \ \ \ \ \ \ \_async\_chain-\/>add(std::move(func),\ \textcolor{stringliteral}{"{}screenshot"{}},\ frame\_number\ >>\ 3,\ -\/(frame\_number\ \&\ ((1\ <<\ 3)\ -\/\ 1)));}
\DoxyCodeLine{08563\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{08564\ \ \ \ \ \ \ func(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{08565\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08566\ \ \ \ \ \});}
\DoxyCodeLine{08567\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{08568\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08569\ \ \ \textcolor{keywordflow}{if}\ (external\_format\ ==\ GL\_RGBA\ ||\ external\_format\ ==\ GL\_RGB)\ \{}
\DoxyCodeLine{08570\ \ \ \ \ \textcolor{comment}{//\ We\ may\ have\ to\ reverse\ the\ byte\ ordering\ of\ the\ image\ if\ GL\ didn't\ do\ it}}
\DoxyCodeLine{08571\ \ \ \ \ \textcolor{comment}{//\ for\ us.}}
\DoxyCodeLine{08572\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ new\_image;}
\DoxyCodeLine{08573\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *result\ =}
\DoxyCodeLine{08574\ \ \ \ \ \ \ fix\_component\_ordering(new\_image,\ image\_ptr,\ image\_size,}
\DoxyCodeLine{08575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ tex);}
\DoxyCodeLine{08576\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ image\_ptr)\ \{}
\DoxyCodeLine{08577\ \ \ \ \ \ \ memcpy(image\_ptr,\ result,\ image\_size);}
\DoxyCodeLine{08578\ \ \ \ \ \}}
\DoxyCodeLine{08579\ \ \ \}}
\DoxyCodeLine{08580\ }
\DoxyCodeLine{08581\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{08582\ \ \ \textcolor{keywordflow}{if}\ (request\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{08583\ \ \ \ \ request-\/>finish();}
\DoxyCodeLine{08584\ \ \ \}}
\DoxyCodeLine{08585\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08586\ }
\DoxyCodeLine{08587\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08588\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{08589\ \}}
\DoxyCodeLine{08590\ }
\DoxyCodeLine{08591\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08595\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08596\ apply\_fog(\mbox{\hyperlink{classFog}{Fog}}\ *fog)\ \{}
\DoxyCodeLine{08597\ \ \ Fog::Mode\ fmode\ =\ fog-\/>get\_mode();}
\DoxyCodeLine{08598\ \ \ glFogf(GL\_FOG\_MODE,\ get\_fog\_mode\_type(fmode));}
\DoxyCodeLine{08599\ }
\DoxyCodeLine{08600\ \ \ \textcolor{keywordflow}{if}\ (fmode\ ==\ Fog::M\_linear)\ \{}
\DoxyCodeLine{08601\ \ \ \ \ PN\_stdfloat\ onset,\ opaque;}
\DoxyCodeLine{08602\ \ \ \ \ fog-\/>get\_linear\_range(onset,\ opaque);}
\DoxyCodeLine{08603\ \ \ \ \ glFogf(GL\_FOG\_START,\ onset);}
\DoxyCodeLine{08604\ \ \ \ \ glFogf(GL\_FOG\_END,\ opaque);}
\DoxyCodeLine{08605\ }
\DoxyCodeLine{08606\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08607\ \ \ \ \ \textcolor{comment}{//\ Exponential\ fog\ is\ always\ camera-\/relative.}}
\DoxyCodeLine{08608\ \ \ \ \ glFogf(GL\_FOG\_DENSITY,\ fog-\/>get\_exp\_density());}
\DoxyCodeLine{08609\ \ \ \}}
\DoxyCodeLine{08610\ }
\DoxyCodeLine{08611\ \ \ call\_glFogfv(GL\_FOG\_COLOR,\ fog-\/>get\_color());}
\DoxyCodeLine{08612\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08613\ \}}
\DoxyCodeLine{08614\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08615\ }
\DoxyCodeLine{08623\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08624\ do\_issue\_transform()\ \{}
\DoxyCodeLine{08625\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08626\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{08627\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 2\ does\ not\ support\ glLoadMatrix.}}
\DoxyCodeLine{08628\ }
\DoxyCodeLine{08629\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *transform\ =\ \_internal\_transform;}
\DoxyCodeLine{08630\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{08631\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{08632\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glLoadMatrix(GL\_MODELVIEW):\ "{}}\ <<\ transform-\/>get\_mat()\ <<\ endl;}
\DoxyCodeLine{08633\ \ \ \ \ \}}
\DoxyCodeLine{08634\ }
\DoxyCodeLine{08635\ \ \ \ \ DO\_PSTATS\_STUFF(\_transform\_state\_pcollector.add\_level(1));}
\DoxyCodeLine{08636\ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{08637\ \ \ \ \ call\_glLoadMatrix(transform-\/>get\_mat());}
\DoxyCodeLine{08638\ \ \ \}}
\DoxyCodeLine{08639\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08640\ \ \ \_transform\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{08641\ }
\DoxyCodeLine{08642\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08643\ \}}
\DoxyCodeLine{08644\ }
\DoxyCodeLine{08645\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08649\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08650\ do\_issue\_shade\_model()\ \{}
\DoxyCodeLine{08651\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classShadeModelAttrib}{ShadeModelAttrib}}\ *target\_shade\_model;}
\DoxyCodeLine{08652\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_shade\_model);}
\DoxyCodeLine{08653\ }
\DoxyCodeLine{08654\ \ \ \textcolor{keywordflow}{switch}\ (target\_shade\_model-\/>get\_mode())\ \{}
\DoxyCodeLine{08655\ \ \ \textcolor{keywordflow}{case}\ ShadeModelAttrib::M\_smooth:}
\DoxyCodeLine{08656\ \ \ \ \ glShadeModel(GL\_SMOOTH);}
\DoxyCodeLine{08657\ \ \ \ \ \_flat\_shade\_model\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{08658\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08659\ }
\DoxyCodeLine{08660\ \ \ \textcolor{keywordflow}{case}\ ShadeModelAttrib::M\_flat:}
\DoxyCodeLine{08661\ \ \ \ \ glShadeModel(GL\_FLAT);}
\DoxyCodeLine{08662\ \ \ \ \ \_flat\_shade\_model\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{08663\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08664\ \ \ \}}
\DoxyCodeLine{08665\ \}}
\DoxyCodeLine{08666\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08667\ }
\DoxyCodeLine{08668\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08672\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08673\ do\_issue\_shader()\ \{}
\DoxyCodeLine{08674\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_draw\_set\_state\_shader\_pcollector);}
\DoxyCodeLine{08675\ }
\DoxyCodeLine{08676\ \ \ \mbox{\hyperlink{classShaderContext}{ShaderContext}}\ *context\ =\ 0;}
\DoxyCodeLine{08677\ \ \ \mbox{\hyperlink{classShader}{Shader}}\ *shader\ =\ (\mbox{\hyperlink{classShader}{Shader}}\ *)\_target\_shader-\/>get\_shader();}
\DoxyCodeLine{08678\ }
\DoxyCodeLine{08679\ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ a\ shader,\ apply\ the\ default\ shader.}}
\DoxyCodeLine{08680\ \ \ \textcolor{keywordflow}{if}\ (!has\_fixed\_function\_pipeline()\ \&\&\ !shader)\ \{}
\DoxyCodeLine{08681\ \ \ \ \ shader\ =\ \_default\_shader;}
\DoxyCodeLine{08682\ \ \ \ \ nassertv(shader\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{08683\ \ \ \}}
\DoxyCodeLine{08684\ }
\DoxyCodeLine{08685\ \ \ \textcolor{keywordflow}{if}\ (shader)\ \{}
\DoxyCodeLine{08686\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\ !=\ shader)\ \{}
\DoxyCodeLine{08687\ \ \ \ \ \ \ context\ =\ shader-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{08688\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08689\ \ \ \ \ \ \ context\ =\ \_current\_shader\_context;}
\DoxyCodeLine{08690\ \ \ \ \ \}}
\DoxyCodeLine{08691\ \ \ \}}
\DoxyCodeLine{08692\ }
\DoxyCodeLine{08693\ \ \ \textcolor{comment}{//\ If\ it\ failed,\ try\ applying\ the\ default\ shader.}}
\DoxyCodeLine{08694\ \ \ \textcolor{keywordflow}{if}\ (\_default\_shader\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ shader\ !=\ \_default\_shader\ \&\&}
\DoxyCodeLine{08695\ \ \ \ \ \ \ (context\ ==\ 0\ ||\ !context-\/>valid()))\ \{}
\DoxyCodeLine{08696\ \ \ \ \ shader\ =\ \_default\_shader;}
\DoxyCodeLine{08697\ \ \ \ \ nassertv(shader\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{08698\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\ !=\ shader)\ \{}
\DoxyCodeLine{08699\ \ \ \ \ \ \ context\ =\ shader-\/>prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{08700\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08701\ \ \ \ \ \ \ context\ =\ \_current\_shader\_context;}
\DoxyCodeLine{08702\ \ \ \ \ \}}
\DoxyCodeLine{08703\ \ \ \}}
\DoxyCodeLine{08704\ }
\DoxyCodeLine{08705\ \ \ \textcolor{keywordflow}{if}\ (context\ ==\ 0\ ||\ !context-\/>valid())\ \{}
\DoxyCodeLine{08706\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{08707\ \ \ \ \ \ \ \_current\_shader\_context-\/>unbind();}
\DoxyCodeLine{08708\ \ \ \ \ \ \ \_current\_shader\ =\ 0;}
\DoxyCodeLine{08709\ \ \ \ \ \ \ \_current\_shader\_context\ =\ 0;}
\DoxyCodeLine{08710\ \ \ \ \ \}}
\DoxyCodeLine{08711\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08712\ \ \ \ \ \textcolor{keywordflow}{if}\ (context\ !=\ \_current\_shader\_context)\ \{}
\DoxyCodeLine{08713\ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ a\ completely\ different\ shader\ than\ before.\ \ Unbind\ old\ shader,}}
\DoxyCodeLine{08714\ \ \ \ \ \ \ \textcolor{comment}{//\ bind\ the\ new\ one.}}
\DoxyCodeLine{08715\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{08716\ \ \ \ \ \ \ \ \ \ \ \_current\_shader-\/>get\_language()\ !=\ shader-\/>get\_language())\ \{}
\DoxyCodeLine{08717\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it's\ a\ different\ type\ of\ shader,\ make\ sure\ to\ unbind\ the\ old.}}
\DoxyCodeLine{08718\ \ \ \ \ \ \ \ \ \_current\_shader\_context-\/>unbind();}
\DoxyCodeLine{08719\ \ \ \ \ \ \ \}}
\DoxyCodeLine{08720\ \ \ \ \ \ \ context-\/>bind();}
\DoxyCodeLine{08721\ \ \ \ \ \ \ \_current\_shader\ =\ shader;}
\DoxyCodeLine{08722\ \ \ \ \ \}}
\DoxyCodeLine{08723\ }
\DoxyCodeLine{08724\ \ \ \ \ \textcolor{comment}{//\ Bind\ the\ shader\ storage\ buffers.}}
\DoxyCodeLine{08725\ \ \ \ \ context-\/>update\_shader\_buffer\_bindings(\_current\_shader\_context);}
\DoxyCodeLine{08726\ \ \ \ \ \_current\_shader\_context\ =\ context;}
\DoxyCodeLine{08727\ \ \ \}}
\DoxyCodeLine{08728\ }
\DoxyCodeLine{08729\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{08730\ \ \ \textcolor{comment}{//\ Is\ the\ point\ size\ provided\ by\ the\ shader\ or\ by\ OpenGL?}}
\DoxyCodeLine{08731\ \ \ \textcolor{keywordtype}{bool}\ shader\_point\_size\ =\ \_target\_shader-\/>get\_flag(ShaderAttrib::F\_shader\_point\_size);}
\DoxyCodeLine{08732\ \ \ \textcolor{keywordflow}{if}\ (shader\_point\_size\ !=\ \_shader\_point\_size)\ \{}
\DoxyCodeLine{08733\ \ \ \ \ \textcolor{keywordflow}{if}\ (shader\_point\_size)\ \{}
\DoxyCodeLine{08734\ \ \ \ \ \ \ glEnable(GL\_PROGRAM\_POINT\_SIZE);}
\DoxyCodeLine{08735\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08736\ \ \ \ \ \ \ glDisable(GL\_PROGRAM\_POINT\_SIZE);}
\DoxyCodeLine{08737\ \ \ \ \ \}}
\DoxyCodeLine{08738\ \ \ \ \ \_shader\_point\_size\ =\ shader\_point\_size;}
\DoxyCodeLine{08739\ \ \ \}}
\DoxyCodeLine{08740\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08741\ }
\DoxyCodeLine{08742\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08743\ \}}
\DoxyCodeLine{08744\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{08745\ }
\DoxyCodeLine{08749\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08750\ do\_issue\_render\_mode()\ \{}
\DoxyCodeLine{08751\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderModeAttrib}{RenderModeAttrib}}\ *target\_render\_mode;}
\DoxyCodeLine{08752\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_render\_mode);}
\DoxyCodeLine{08753\ }
\DoxyCodeLine{08754\ \ \ \_render\_mode\ =\ target\_render\_mode-\/>get\_mode();}
\DoxyCodeLine{08755\ \ \ PN\_stdfloat\ thickness\ =\ target\_render\_mode-\/>get\_thickness();}
\DoxyCodeLine{08756\ \ \ \_point\_perspective\ =\ target\_render\_mode-\/>get\_perspective();}
\DoxyCodeLine{08757\ }
\DoxyCodeLine{08758\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\ \ }\textcolor{comment}{//\ glPolygonMode\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{08759\ \ \ \textcolor{keywordflow}{switch}\ (\_render\_mode)\ \{}
\DoxyCodeLine{08760\ \ \ \textcolor{keywordflow}{case}\ RenderModeAttrib::M\_unchanged:}
\DoxyCodeLine{08761\ \ \ \textcolor{keywordflow}{case}\ RenderModeAttrib::M\_filled:}
\DoxyCodeLine{08762\ \ \ \textcolor{keywordflow}{case}\ RenderModeAttrib::M\_filled\_flat:}
\DoxyCodeLine{08763\ \ \ \ \ glPolygonMode(GL\_FRONT\_AND\_BACK,\ GL\_FILL);}
\DoxyCodeLine{08764\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08765\ }
\DoxyCodeLine{08766\ \ \ \textcolor{keywordflow}{case}\ RenderModeAttrib::M\_wireframe:}
\DoxyCodeLine{08767\ \ \ \ \ glPolygonMode(GL\_FRONT\_AND\_BACK,\ GL\_LINE);}
\DoxyCodeLine{08768\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08769\ }
\DoxyCodeLine{08770\ \ \ \textcolor{keywordflow}{case}\ RenderModeAttrib::M\_point:}
\DoxyCodeLine{08771\ \ \ \ \ glPolygonMode(GL\_FRONT\_AND\_BACK,\ GL\_POINT);}
\DoxyCodeLine{08772\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08773\ }
\DoxyCodeLine{08774\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08775\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{08776\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unknown\ render\ mode\ "{}}\ <<\ (int)\_render\_mode\ <<\ endl;}
\DoxyCodeLine{08777\ \ \ \}}
\DoxyCodeLine{08778\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{08779\ }
\DoxyCodeLine{08780\ \ \ \textcolor{comment}{//\ The\ thickness\ affects\ both\ the\ line\ width\ and\ the\ point\ size.}}
\DoxyCodeLine{08781\ \ \ \textcolor{keywordflow}{if}\ (thickness\ !=\ \_point\_size)\ \{}
\DoxyCodeLine{08782\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{08783\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}setting\ thickness\ to\ "{}}\ <<\ thickness\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{08784\ \ \ \ \ \}}
\DoxyCodeLine{08785\ }
\DoxyCodeLine{08786\ \ \ \ \ glLineWidth(std::min((GLfloat)thickness,\ \_max\_line\_width));}
\DoxyCodeLine{08787\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{08788\ \ \ \ \ glPointSize(thickness);}
\DoxyCodeLine{08789\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08790\ \ \ \ \ \_point\_size\ =\ thickness;}
\DoxyCodeLine{08791\ \ \ \}}
\DoxyCodeLine{08792\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08793\ }
\DoxyCodeLine{08794\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08795\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{08796\ \ \ \ \ do\_point\_size();}
\DoxyCodeLine{08797\ \ \ \}}
\DoxyCodeLine{08798\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08799\ \}}
\DoxyCodeLine{08800\ }
\DoxyCodeLine{08804\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08805\ do\_issue\_antialias()\ \{}
\DoxyCodeLine{08806\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAntialiasAttrib}{AntialiasAttrib}}\ *target\_antialias;}
\DoxyCodeLine{08807\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_antialias);}
\DoxyCodeLine{08808\ }
\DoxyCodeLine{08809\ \ \ \textcolor{keywordflow}{if}\ (target\_antialias-\/>get\_mode\_type()\ ==\ AntialiasAttrib::M\_auto)\ \{}
\DoxyCodeLine{08810\ \ \ \ \ \textcolor{comment}{//\ In\ this\ special\ mode,\ we\ must\ enable\ antialiasing\ on\ a\ case-\/by-\/case}}
\DoxyCodeLine{08811\ \ \ \ \ \textcolor{comment}{//\ basis,\ because\ we\ enable\ it\ differently\ for\ polygons\ and\ for\ points\ and}}
\DoxyCodeLine{08812\ \ \ \ \ \textcolor{comment}{//\ lines.}}
\DoxyCodeLine{08813\ \ \ \ \ \_auto\_antialias\_mode\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{08814\ }
\DoxyCodeLine{08815\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08816\ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ explicitly\ enable\ or\ disable\ according\ to\ the\ bits\ that\ are}}
\DoxyCodeLine{08817\ \ \ \ \ \textcolor{comment}{//\ set.\ \ But\ if\ multisample\ is\ requested\ and\ supported,\ don't\ use\ the}}
\DoxyCodeLine{08818\ \ \ \ \ \textcolor{comment}{//\ other\ bits\ at\ all\ (they\ will\ be\ ignored\ by\ GL\ anyway).}}
\DoxyCodeLine{08819\ \ \ \ \ \_auto\_antialias\_mode\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{08820\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ mode\ =\ target\_antialias-\/>get\_mode();}
\DoxyCodeLine{08821\ }
\DoxyCodeLine{08822\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_multisample\ \&\&}
\DoxyCodeLine{08823\ \ \ \ \ \ \ \ \ (mode\ \&\ AntialiasAttrib::M\_multisample)\ !=\ 0)\ \{}
\DoxyCodeLine{08824\ \ \ \ \ \ \ enable\_multisample\_antialias(\textcolor{keyword}{true});}
\DoxyCodeLine{08825\ }
\DoxyCodeLine{08826\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08827\ \ \ \ \ \ \ enable\_multisample\_antialias(\textcolor{keyword}{false});}
\DoxyCodeLine{08828\ \ \ \ \ \ \ enable\_line\_smooth((mode\ \&\ AntialiasAttrib::M\_line)\ !=\ 0);}
\DoxyCodeLine{08829\ \ \ \ \ \ \ enable\_point\_smooth((mode\ \&\ AntialiasAttrib::M\_point)\ !=\ 0);}
\DoxyCodeLine{08830\ \ \ \ \ \ \ enable\_polygon\_smooth((mode\ \&\ AntialiasAttrib::M\_polygon)\ !=\ 0);}
\DoxyCodeLine{08831\ \ \ \ \ \}}
\DoxyCodeLine{08832\ \ \ \}}
\DoxyCodeLine{08833\ }
\DoxyCodeLine{08834\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{08835\ \ \ GLenum\ quality;}
\DoxyCodeLine{08836\ \ \ \textcolor{keywordflow}{switch}\ (target\_antialias-\/>get\_mode\_quality())\ \{}
\DoxyCodeLine{08837\ \ \ \textcolor{keywordflow}{case}\ AntialiasAttrib::M\_faster:}
\DoxyCodeLine{08838\ \ \ \ \ quality\ =\ GL\_FASTEST;}
\DoxyCodeLine{08839\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08840\ }
\DoxyCodeLine{08841\ \ \ \textcolor{keywordflow}{case}\ AntialiasAttrib::M\_better:}
\DoxyCodeLine{08842\ \ \ \ \ quality\ =\ GL\_NICEST;}
\DoxyCodeLine{08843\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08844\ }
\DoxyCodeLine{08845\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08846\ \ \ \ \ quality\ =\ GL\_DONT\_CARE;}
\DoxyCodeLine{08847\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08848\ \ \ \}}
\DoxyCodeLine{08849\ }
\DoxyCodeLine{08850\ \ \ \textcolor{keywordflow}{if}\ (\_line\_smooth\_enabled)\ \{}
\DoxyCodeLine{08851\ \ \ \ \ glHint(GL\_LINE\_SMOOTH\_HINT,\ quality);}
\DoxyCodeLine{08852\ \ \ \}}
\DoxyCodeLine{08853\ \ \ \textcolor{keywordflow}{if}\ (\_point\_smooth\_enabled)\ \{}
\DoxyCodeLine{08854\ \ \ \ \ glHint(GL\_POINT\_SMOOTH\_HINT,\ quality);}
\DoxyCodeLine{08855\ \ \ \}}
\DoxyCodeLine{08856\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{08857\ \ \ \textcolor{keywordflow}{if}\ (\_polygon\_smooth\_enabled)\ \{}
\DoxyCodeLine{08858\ \ \ \ \ glHint(GL\_POLYGON\_SMOOTH\_HINT,\ quality);}
\DoxyCodeLine{08859\ \ \ \}}
\DoxyCodeLine{08860\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08861\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_2}}
\DoxyCodeLine{08862\ }
\DoxyCodeLine{08863\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08864\ \}}
\DoxyCodeLine{08865\ }
\DoxyCodeLine{08866\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION\ }\textcolor{comment}{//\ OpenGL\ ES\ 2.0\ doesn't\ support\ rescaling\ normals.}}
\DoxyCodeLine{08870\ void\ CLP(GraphicsStateGuardian)::}
\DoxyCodeLine{08871\ do\_issue\_rescale\_normal()\ \{}
\DoxyCodeLine{08872\ \ \ RescaleNormalAttrib::Mode\ mode\ =\ RescaleNormalAttrib::M\_none;}
\DoxyCodeLine{08873\ }
\DoxyCodeLine{08874\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}\ *target\_rescale\_normal;}
\DoxyCodeLine{08875\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(target\_rescale\_normal))\ \{}
\DoxyCodeLine{08876\ \ \ \ \ mode\ =\ target\_rescale\_normal-\/>get\_mode();}
\DoxyCodeLine{08877\ \ \ \}}
\DoxyCodeLine{08878\ }
\DoxyCodeLine{08879\ \ \ \textcolor{keywordflow}{switch}\ (mode)\ \{}
\DoxyCodeLine{08880\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_none:}
\DoxyCodeLine{08881\ \ \ \ \ glDisable(GL\_NORMALIZE);}
\DoxyCodeLine{08882\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_rescale\_normal\ \&\&\ support\_rescale\_normal)\ \{}
\DoxyCodeLine{08883\ \ \ \ \ \ \ glDisable(GL\_RESCALE\_NORMAL);}
\DoxyCodeLine{08884\ \ \ \ \ \}}
\DoxyCodeLine{08885\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08886\ }
\DoxyCodeLine{08887\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_rescale:}
\DoxyCodeLine{08888\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_rescale\_normal\ \&\&\ support\_rescale\_normal)\ \{}
\DoxyCodeLine{08889\ \ \ \ \ \ \ glEnable(GL\_RESCALE\_NORMAL);}
\DoxyCodeLine{08890\ \ \ \ \ \ \ glDisable(GL\_NORMALIZE);}
\DoxyCodeLine{08891\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08892\ \ \ \ \ \ \ glEnable(GL\_NORMALIZE);}
\DoxyCodeLine{08893\ \ \ \ \ \}}
\DoxyCodeLine{08894\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08895\ }
\DoxyCodeLine{08896\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_normalize:}
\DoxyCodeLine{08897\ \ \ \ \ glEnable(GL\_NORMALIZE);}
\DoxyCodeLine{08898\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_rescale\_normal\ \&\&\ support\_rescale\_normal)\ \{}
\DoxyCodeLine{08899\ \ \ \ \ \ \ glDisable(GL\_RESCALE\_NORMAL);}
\DoxyCodeLine{08900\ \ \ \ \ \}}
\DoxyCodeLine{08901\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08902\ }
\DoxyCodeLine{08903\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{08904\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{08905\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unknown\ rescale\_normal\ mode\ "{}}\ <<\ (int)mode\ <<\ endl;}
\DoxyCodeLine{08906\ \ \ \}}
\DoxyCodeLine{08907\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08908\ \}}
\DoxyCodeLine{08909\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08910\ }
\DoxyCodeLine{08911\ \textcolor{comment}{//\ PandaCompareFunc\ -\/\ 1\ +\ 0x200\ ===\ GL\_NEVER,\ etc.\ \ order\ is\ sequential}}
\DoxyCodeLine{08912\ \textcolor{preprocessor}{\#define\ PANDA\_TO\_GL\_COMPAREFUNC(PANDACMPFUNC)\ (PANDACMPFUNC-\/1\ +0x200)}}
\DoxyCodeLine{08913\ }
\DoxyCodeLine{08917\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08918\ do\_issue\_depth\_test()\ \{}
\DoxyCodeLine{08919\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDepthTestAttrib}{DepthTestAttrib}}\ *target\_depth\_test;}
\DoxyCodeLine{08920\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_depth\_test);}
\DoxyCodeLine{08921\ }
\DoxyCodeLine{08922\ \ \ DepthTestAttrib::PandaCompareFunc\ mode\ =\ target\_depth\_test-\/>get\_mode();}
\DoxyCodeLine{08923\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ DepthTestAttrib::M\_none)\ \{}
\DoxyCodeLine{08924\ \ \ \ \ enable\_depth\_test(\textcolor{keyword}{false});}
\DoxyCodeLine{08925\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08926\ \ \ \ \ enable\_depth\_test(\textcolor{keyword}{true});}
\DoxyCodeLine{08927\ \ \ \ \ glDepthFunc(PANDA\_TO\_GL\_COMPAREFUNC(mode));}
\DoxyCodeLine{08928\ \ \ \}}
\DoxyCodeLine{08929\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08930\ \}}
\DoxyCodeLine{08931\ }
\DoxyCodeLine{08932\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08936\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08937\ do\_issue\_alpha\_test()\ \{}
\DoxyCodeLine{08938\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{08939\ \ \ \textcolor{keywordflow}{if}\ (\_target\_shader-\/>get\_flag(ShaderAttrib::F\_subsume\_alpha\_test))\ \{}
\DoxyCodeLine{08940\ \ \ \ \ enable\_alpha\_test(\textcolor{keyword}{false});}
\DoxyCodeLine{08941\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{08942\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08943\ \ \ \{}
\DoxyCodeLine{08944\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAlphaTestAttrib}{AlphaTestAttrib}}\ *target\_alpha\_test;}
\DoxyCodeLine{08945\ \ \ \ \ \_target\_rs-\/>get\_attrib\_def(target\_alpha\_test);}
\DoxyCodeLine{08946\ }
\DoxyCodeLine{08947\ \ \ \ \ AlphaTestAttrib::PandaCompareFunc\ mode\ =\ target\_alpha\_test-\/>get\_mode();}
\DoxyCodeLine{08948\ \ \ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ AlphaTestAttrib::M\_none)\ \{}
\DoxyCodeLine{08949\ \ \ \ \ \ \ enable\_alpha\_test(\textcolor{keyword}{false});}
\DoxyCodeLine{08950\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08951\ \ \ \ \ \ \ nassertv(GL\_NEVER\ ==\ (AlphaTestAttrib::M\_never-\/1+0x200));}
\DoxyCodeLine{08952\ \ \ \ \ \ \ glAlphaFunc(PANDA\_TO\_GL\_COMPAREFUNC(mode),\ target\_alpha\_test-\/>get\_reference\_alpha());}
\DoxyCodeLine{08953\ \ \ \ \ \ \ enable\_alpha\_test(\textcolor{keyword}{true});}
\DoxyCodeLine{08954\ \ \ \ \ \}}
\DoxyCodeLine{08955\ \ \ \}}
\DoxyCodeLine{08956\ \}}
\DoxyCodeLine{08957\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{08958\ }
\DoxyCodeLine{08962\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08963\ do\_issue\_depth\_write()\ \{}
\DoxyCodeLine{08964\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDepthWriteAttrib}{DepthWriteAttrib}}\ *target\_depth\_write;}
\DoxyCodeLine{08965\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_depth\_write);}
\DoxyCodeLine{08966\ }
\DoxyCodeLine{08967\ \ \ DepthWriteAttrib::Mode\ mode\ =\ target\_depth\_write-\/>get\_mode();}
\DoxyCodeLine{08968\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ DepthWriteAttrib::M\_off)\ \{}
\DoxyCodeLine{08969\ \textcolor{preprocessor}{\#ifdef\ GSG\_VERBOSE}}
\DoxyCodeLine{08970\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{08971\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDepthMask(GL\_FALSE)"{}}\ <<\ endl;}
\DoxyCodeLine{08972\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08973\ \ \ \ \ glDepthMask(GL\_FALSE);}
\DoxyCodeLine{08974\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{08975\ \textcolor{preprocessor}{\#ifdef\ GSG\_VERBOSE}}
\DoxyCodeLine{08976\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{08977\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDepthMask(GL\_TRUE)"{}}\ <<\ endl;}
\DoxyCodeLine{08978\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{08979\ \ \ \ \ glDepthMask(GL\_TRUE);}
\DoxyCodeLine{08980\ \ \ \}}
\DoxyCodeLine{08981\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{08982\ \}}
\DoxyCodeLine{08983\ }
\DoxyCodeLine{08987\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{08988\ do\_issue\_cull\_face()\ \{}
\DoxyCodeLine{08989\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classCullFaceAttrib}{CullFaceAttrib}}\ *target\_cull\_face;}
\DoxyCodeLine{08990\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_cull\_face);}
\DoxyCodeLine{08991\ }
\DoxyCodeLine{08992\ \ \ CullFaceAttrib::Mode\ mode\ =\ target\_cull\_face-\/>get\_effective\_mode();}
\DoxyCodeLine{08993\ }
\DoxyCodeLine{08994\ \ \ \textcolor{keywordflow}{switch}\ (mode)\ \{}
\DoxyCodeLine{08995\ \ \ \textcolor{keywordflow}{case}\ CullFaceAttrib::M\_cull\_none:}
\DoxyCodeLine{08996\ \ \ \ \ glDisable(GL\_CULL\_FACE);}
\DoxyCodeLine{08997\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{08998\ \ \ \textcolor{keywordflow}{case}\ CullFaceAttrib::M\_cull\_clockwise:}
\DoxyCodeLine{08999\ \ \ \ \ glEnable(GL\_CULL\_FACE);}
\DoxyCodeLine{09000\ \ \ \ \ glCullFace(GL\_BACK);}
\DoxyCodeLine{09001\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09002\ \ \ \textcolor{keywordflow}{case}\ CullFaceAttrib::M\_cull\_counter\_clockwise:}
\DoxyCodeLine{09003\ \ \ \ \ glEnable(GL\_CULL\_FACE);}
\DoxyCodeLine{09004\ \ \ \ \ glCullFace(GL\_FRONT);}
\DoxyCodeLine{09005\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09006\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{09007\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{09008\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}invalid\ cull\ face\ mode\ "{}}\ <<\ (int)mode\ <<\ endl;}
\DoxyCodeLine{09009\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09010\ \ \ \}}
\DoxyCodeLine{09011\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09012\ \}}
\DoxyCodeLine{09013\ }
\DoxyCodeLine{09014\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09018\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09019\ do\_issue\_fog()\ \{}
\DoxyCodeLine{09020\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFogAttrib}{FogAttrib}}\ *target\_fog;}
\DoxyCodeLine{09021\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_fog);}
\DoxyCodeLine{09022\ }
\DoxyCodeLine{09023\ \ \ \textcolor{keywordflow}{if}\ (!target\_fog-\/>is\_off())\ \{}
\DoxyCodeLine{09024\ \ \ \ \ enable\_fog(\textcolor{keyword}{true});}
\DoxyCodeLine{09025\ \ \ \ \ \mbox{\hyperlink{classFog}{Fog}}\ *fog\ =\ target\_fog-\/>get\_fog();}
\DoxyCodeLine{09026\ \ \ \ \ nassertv(fog\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{09027\ \ \ \ \ apply\_fog(fog);}
\DoxyCodeLine{09028\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09029\ \ \ \ \ enable\_fog(\textcolor{keyword}{false});}
\DoxyCodeLine{09030\ \ \ \}}
\DoxyCodeLine{09031\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09032\ \}}
\DoxyCodeLine{09033\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09034\ }
\DoxyCodeLine{09038\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09039\ do\_issue\_depth\_bias()\ \{}
\DoxyCodeLine{09040\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDepthOffsetAttrib}{DepthOffsetAttrib}}\ *target\_depth\_offset;}
\DoxyCodeLine{09041\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_depth\_offset);}
\DoxyCodeLine{09042\ \ \ \textcolor{keywordtype}{int}\ offset\ =\ target\_depth\_offset-\/>get\_offset();}
\DoxyCodeLine{09043\ }
\DoxyCodeLine{09044\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDepthBiasAttrib}{DepthBiasAttrib}}\ *target\_depth\_bias;}
\DoxyCodeLine{09045\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(target\_depth\_bias))\ \{}
\DoxyCodeLine{09046\ \ \ \ \ GLfloat\ slope\_factor\ =\ target\_depth\_bias-\/>get\_slope\_factor();}
\DoxyCodeLine{09047\ \ \ \ \ GLfloat\ constant\_factor\ =\ target\_depth\_bias-\/>get\_constant\_factor();}
\DoxyCodeLine{09048\ }
\DoxyCodeLine{09049\ \ \ \ \ slope\_factor\ -\/=\ offset;}
\DoxyCodeLine{09050\ \ \ \ \ constant\_factor\ -\/=\ offset;}
\DoxyCodeLine{09051\ }
\DoxyCodeLine{09052\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{09053\ \ \ \ \ GLfloat\ clamp\ =\ target\_depth\_bias-\/>get\_clamp();}
\DoxyCodeLine{09054\ \ \ \ \ \_glPolygonOffsetClamp(slope\_factor,\ constant\_factor,\ clamp);}
\DoxyCodeLine{09055\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{09056\ \ \ \ \ glPolygonOffset(slope\_factor,\ constant\_factor);}
\DoxyCodeLine{09057\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09058\ \ \ \ \ enable\_polygon\_offset(\textcolor{keyword}{true});}
\DoxyCodeLine{09059\ \ \ \}}
\DoxyCodeLine{09060\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (offset\ !=\ 0)\ \{}
\DoxyCodeLine{09061\ \ \ \ \ \textcolor{comment}{//\ The\ relationship\ between\ these\ two\ parameters\ is\ a\ little\ unclear\ and}}
\DoxyCodeLine{09062\ \ \ \ \ \textcolor{comment}{//\ poorly\ explained\ in\ the\ GL\ man\ pages.}}
\DoxyCodeLine{09063\ \ \ \ \ glPolygonOffset((GLfloat)\ -\/offset,\ (GLfloat)\ -\/offset);}
\DoxyCodeLine{09064\ \ \ \ \ enable\_polygon\_offset(\textcolor{keyword}{true});}
\DoxyCodeLine{09065\ \ \ \}}
\DoxyCodeLine{09066\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09067\ \ \ \ \ enable\_polygon\_offset(\textcolor{keyword}{false});}
\DoxyCodeLine{09068\ \ \ \}}
\DoxyCodeLine{09069\ }
\DoxyCodeLine{09070\ \ \ PN\_stdfloat\ min\_value\ =\ target\_depth\_offset-\/>get\_min\_value();}
\DoxyCodeLine{09071\ \ \ PN\_stdfloat\ max\_value\ =\ target\_depth\_offset-\/>get\_max\_value();}
\DoxyCodeLine{09072\ \ \ \textcolor{keywordflow}{if}\ (min\_value\ !=\ (PN\_stdfloat)0.0\ ||}
\DoxyCodeLine{09073\ \ \ \ \ \ \ max\_value\ !=\ (PN\_stdfloat)1.0\ ||}
\DoxyCodeLine{09074\ \ \ \ \ \ \ \_has\_attrib\_depth\_range)\ \{}
\DoxyCodeLine{09075\ \ \ \ \ min\_value\ =\ \_depth\_range\_far\ *\ min\_value\ +\ \_depth\_range\_near\ *\ (1\ -\/\ min\_value);}
\DoxyCodeLine{09076\ \ \ \ \ max\_value\ =\ \_depth\_range\_far\ *\ max\_value\ +\ \_depth\_range\_near\ *\ (1\ -\/\ max\_value);}
\DoxyCodeLine{09077\ }
\DoxyCodeLine{09078\ \textcolor{preprocessor}{\#ifdef\ GSG\_VERBOSE}}
\DoxyCodeLine{09079\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09080\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{09081\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDepthRange("{}}\ <<\ min\_value\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ max\_value\ <<\ \textcolor{stringliteral}{"{})"{}}\ <<\ endl;}
\DoxyCodeLine{09082\ \ \ \ \ \}}
\DoxyCodeLine{09083\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09084\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{09085\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ uses\ a\ single-\/precision\ call.}}
\DoxyCodeLine{09086\ \ \ \ \ glDepthRangef((GLclampf)min\_value,\ (GLclampf)max\_value);}
\DoxyCodeLine{09087\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{09088\ \ \ \ \ \textcolor{comment}{//\ Mainline\ OpenGL\ uses\ a\ double-\/precision\ call.}}
\DoxyCodeLine{09089\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_use\_remapped\_depth\_range)\ \{}
\DoxyCodeLine{09090\ \ \ \ \ \ \ glDepthRange((GLclampd)min\_value,\ (GLclampd)max\_value);}
\DoxyCodeLine{09091\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09092\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ remapped\ depth\ range,\ we\ should\ adjust\ the\ values\ to\ range}}
\DoxyCodeLine{09093\ \ \ \ \ \ \ \textcolor{comment}{//\ from\ -\/1\ to\ 1.\ \ We\ need\ to\ use\ an\ NV\ extension\ to\ pass\ unclamped\ values.}}
\DoxyCodeLine{09094\ \ \ \ \ \ \ \_glDepthRangedNV(min\_value\ *\ 2.0\ -\/\ 1.0,\ max\_value\ *\ 2.0\ -\/\ 1.0);}
\DoxyCodeLine{09095\ \ \ \ \ \}}
\DoxyCodeLine{09096\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{09097\ }
\DoxyCodeLine{09098\ \ \ \ \ \_has\_attrib\_depth\_range\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{09099\ \ \ \}}
\DoxyCodeLine{09100\ }
\DoxyCodeLine{09101\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09102\ \}}
\DoxyCodeLine{09103\ }
\DoxyCodeLine{09104\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09108\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09109\ do\_issue\_material()\ \{}
\DoxyCodeLine{09110\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classMaterial}{Material}}\ empty;}
\DoxyCodeLine{09111\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaterial}{Material}}\ *material;}
\DoxyCodeLine{09112\ }
\DoxyCodeLine{09113\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classMaterialAttrib}{MaterialAttrib}}\ *target\_material;}
\DoxyCodeLine{09114\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_material);}
\DoxyCodeLine{09115\ }
\DoxyCodeLine{09116\ \ \ \textcolor{keywordflow}{if}\ (target\_material\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{09117\ \ \ \ \ \ \ target\_material-\/>is\_off())\ \{}
\DoxyCodeLine{09118\ \ \ \ \ material\ =\ \&empty;}
\DoxyCodeLine{09119\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09120\ \ \ \ \ material\ =\ target\_material-\/>get\_material();}
\DoxyCodeLine{09121\ \ \ \}}
\DoxyCodeLine{09122\ }
\DoxyCodeLine{09123\ \ \ \textcolor{keywordtype}{bool}\ has\_material\_force\_color\ =\ \_has\_material\_force\_color;}
\DoxyCodeLine{09124\ }
\DoxyCodeLine{09125\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{09126\ \ \ \textcolor{keywordflow}{if}\ (\_show\_texture\_usage)\ \{}
\DoxyCodeLine{09127\ \ \ \ \ \textcolor{comment}{//\ In\ show\_texture\_usage\ mode,\ all\ colors\ are\ white,\ so\ as\ not\ to}}
\DoxyCodeLine{09128\ \ \ \ \ \textcolor{comment}{//\ contaminate\ the\ texture\ color.\ \ This\ means\ we\ disable\ lighting}}
\DoxyCodeLine{09129\ \ \ \ \ \textcolor{comment}{//\ materials\ too.}}
\DoxyCodeLine{09130\ \ \ \ \ material\ =\ \&empty;}
\DoxyCodeLine{09131\ \ \ \ \ has\_material\_force\_color\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{09132\ \ \ \}}
\DoxyCodeLine{09133\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{09134\ }
\DoxyCodeLine{09135\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{09136\ \ \ \textcolor{keyword}{const}\ GLenum\ face\ =\ GL\_FRONT\_AND\_BACK;}
\DoxyCodeLine{09137\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{09138\ \ \ GLenum\ face\ =\ material-\/>get\_twoside()\ ?\ GL\_FRONT\_AND\_BACK\ :\ GL\_FRONT;}
\DoxyCodeLine{09139\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09140\ }
\DoxyCodeLine{09141\ \ \ call\_glMaterialfv(face,\ GL\_SPECULAR,\ material-\/>get\_specular());}
\DoxyCodeLine{09142\ \ \ call\_glMaterialfv(face,\ GL\_EMISSION,\ material-\/>get\_emission());}
\DoxyCodeLine{09143\ \ \ glMaterialf(face,\ GL\_SHININESS,\ max(min(material-\/>get\_shininess(),\ (PN\_stdfloat)128),\ (PN\_stdfloat)0));}
\DoxyCodeLine{09144\ }
\DoxyCodeLine{09145\ \ \ \textcolor{keywordflow}{if}\ ((material-\/>has\_ambient()\ \&\&\ material-\/>has\_diffuse())\ ||\ material-\/>has\_base\_color())\ \{}
\DoxyCodeLine{09146\ \ \ \ \ \textcolor{comment}{//\ The\ material\ has\ both\ an\ ambient\ and\ diffuse\ specified.\ \ This\ means\ we}}
\DoxyCodeLine{09147\ \ \ \ \ \textcolor{comment}{//\ do\ not\ need\ glMaterialColor().}}
\DoxyCodeLine{09148\ \ \ \ \ glDisable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09149\ \ \ \ \ call\_glMaterialfv(face,\ GL\_AMBIENT,\ material-\/>get\_ambient());}
\DoxyCodeLine{09150\ \ \ \ \ call\_glMaterialfv(face,\ GL\_DIFFUSE,\ material-\/>get\_diffuse());}
\DoxyCodeLine{09151\ }
\DoxyCodeLine{09152\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (material-\/>has\_ambient())\ \{}
\DoxyCodeLine{09153\ \ \ \ \ \textcolor{comment}{//\ The\ material\ specifies\ an\ ambient,\ but\ not\ a\ diffuse\ component.\ \ The}}
\DoxyCodeLine{09154\ \ \ \ \ \textcolor{comment}{//\ diffuse\ component\ comes\ from\ the\ object's\ color.}}
\DoxyCodeLine{09155\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_material\_force\_color)\ \{}
\DoxyCodeLine{09156\ \ \ \ \ \ \ glDisable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09157\ \ \ \ \ \ \ call\_glMaterialfv(face,\ GL\_DIFFUSE,\ \_material\_force\_color);}
\DoxyCodeLine{09158\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09159\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09160\ \ \ \ \ \ \ glColorMaterial(face,\ GL\_DIFFUSE);}
\DoxyCodeLine{09161\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{09162\ \ \ \ \ \ \ glEnable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09163\ \ \ \ \ \}}
\DoxyCodeLine{09164\ \ \ \ \ call\_glMaterialfv(face,\ GL\_AMBIENT,\ material-\/>get\_ambient());}
\DoxyCodeLine{09165\ }
\DoxyCodeLine{09166\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (material-\/>has\_diffuse())\ \{}
\DoxyCodeLine{09167\ \ \ \ \ \textcolor{comment}{//\ The\ material\ specifies\ a\ diffuse,\ but\ not\ an\ ambient\ component.\ \ The}}
\DoxyCodeLine{09168\ \ \ \ \ \textcolor{comment}{//\ ambient\ component\ comes\ from\ the\ object's\ color.}}
\DoxyCodeLine{09169\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_material\_force\_color)\ \{}
\DoxyCodeLine{09170\ \ \ \ \ \ \ glDisable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09171\ \ \ \ \ \ \ call\_glMaterialfv(face,\ GL\_AMBIENT,\ \_material\_force\_color);}
\DoxyCodeLine{09172\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09173\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09174\ \ \ \ \ \ \ glColorMaterial(face,\ GL\_AMBIENT);}
\DoxyCodeLine{09175\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{09176\ \ \ \ \ \ \ glEnable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09177\ \ \ \ \ \}}
\DoxyCodeLine{09178\ \ \ \ \ call\_glMaterialfv(face,\ GL\_DIFFUSE,\ material-\/>get\_diffuse());}
\DoxyCodeLine{09179\ }
\DoxyCodeLine{09180\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09181\ \ \ \ \ \textcolor{comment}{//\ The\ material\ specifies\ neither\ a\ diffuse\ nor\ an\ ambient\ component.}}
\DoxyCodeLine{09182\ \ \ \ \ \textcolor{comment}{//\ Both\ components\ come\ from\ the\ object's\ color.}}
\DoxyCodeLine{09183\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_material\_force\_color)\ \{}
\DoxyCodeLine{09184\ \ \ \ \ \ \ glDisable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09185\ \ \ \ \ \ \ call\_glMaterialfv(face,\ GL\_AMBIENT,\ \_material\_force\_color);}
\DoxyCodeLine{09186\ \ \ \ \ \ \ call\_glMaterialfv(face,\ GL\_DIFFUSE,\ \_material\_force\_color);}
\DoxyCodeLine{09187\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09188\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09189\ \ \ \ \ \ \ glColorMaterial(face,\ GL\_AMBIENT\_AND\_DIFFUSE);}
\DoxyCodeLine{09190\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{09191\ \ \ \ \ \ \ glEnable(GL\_COLOR\_MATERIAL);}
\DoxyCodeLine{09192\ \ \ \ \ \}}
\DoxyCodeLine{09193\ \ \ \}}
\DoxyCodeLine{09194\ }
\DoxyCodeLine{09195\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09196\ \ \ glLightModeli(GL\_LIGHT\_MODEL\_LOCAL\_VIEWER,\ material-\/>get\_local());}
\DoxyCodeLine{09197\ \ \ glLightModeli(GL\_LIGHT\_MODEL\_TWO\_SIDE,\ material-\/>get\_twoside());}
\DoxyCodeLine{09198\ }
\DoxyCodeLine{09199\ \ \ \textcolor{keywordflow}{if}\ (\_use\_separate\_specular\_color)\ \{}
\DoxyCodeLine{09200\ \ \ \ \ glLightModeli(GL\_LIGHT\_MODEL\_COLOR\_CONTROL,\ GL\_SEPARATE\_SPECULAR\_COLOR);}
\DoxyCodeLine{09201\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09202\ \ \ \ \ glLightModeli(GL\_LIGHT\_MODEL\_COLOR\_CONTROL,\ GL\_SINGLE\_COLOR);}
\DoxyCodeLine{09203\ \ \ \}}
\DoxyCodeLine{09204\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09205\ }
\DoxyCodeLine{09206\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09207\ \}}
\DoxyCodeLine{09208\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09209\ }
\DoxyCodeLine{09213\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ ||\ defined(OPENGLES\_1)}}
\DoxyCodeLine{09214\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09215\ do\_issue\_logic\_op()\ \{}
\DoxyCodeLine{09216\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLogicOpAttrib}{LogicOpAttrib}}\ *target\_logic\_op;}
\DoxyCodeLine{09217\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_logic\_op);}
\DoxyCodeLine{09218\ }
\DoxyCodeLine{09219\ \ \ \textcolor{keywordflow}{if}\ (target\_logic\_op-\/>get\_operation()\ !=\ LogicOpAttrib::O\_none)\ \{}
\DoxyCodeLine{09220\ \ \ \ \ glEnable(GL\_COLOR\_LOGIC\_OP);}
\DoxyCodeLine{09221\ \ \ \ \ glLogicOp(GL\_CLEAR\ -\/\ 1\ +\ (\textcolor{keywordtype}{int})target\_logic\_op-\/>get\_operation());}
\DoxyCodeLine{09222\ }
\DoxyCodeLine{09223\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09224\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glEnable(GL\_COLOR\_LOGIC\_OP)\(\backslash\)n"{}};}
\DoxyCodeLine{09225\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glLogicOp("{}}\ <<\ target\_logic\_op-\/>get\_operation()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{09226\ \ \ \ \ \}}
\DoxyCodeLine{09227\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09228\ \ \ \ \ glDisable(GL\_COLOR\_LOGIC\_OP);}
\DoxyCodeLine{09229\ \ \ \ \ glLogicOp(GL\_COPY);}
\DoxyCodeLine{09230\ }
\DoxyCodeLine{09231\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09232\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glDisable(GL\_COLOR\_LOGIC\_OP)\(\backslash\)n"{}};}
\DoxyCodeLine{09233\ \ \ \ \ \}}
\DoxyCodeLine{09234\ \ \ \}}
\DoxyCodeLine{09235\ \}}
\DoxyCodeLine{09236\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09237\ }
\DoxyCodeLine{09241\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09242\ do\_issue\_blending()\ \{}
\DoxyCodeLine{09243\ \ \ \textcolor{comment}{//\ Handle\ the\ color\_write\ attrib.\ \ If\ color\_write\ is\ off,\ then\ all\ the\ other}}
\DoxyCodeLine{09244\ \ \ \textcolor{comment}{//\ blending-\/related\ stuff\ doesn't\ matter.\ \ If\ the\ device\ doesn't\ support}}
\DoxyCodeLine{09245\ \ \ \textcolor{comment}{//\ color-\/write,\ we\ use\ blending\ tricks\ to\ effectively\ disable\ color\ write.}}
\DoxyCodeLine{09246\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classColorWriteAttrib}{ColorWriteAttrib}}\ *target\_color\_write;}
\DoxyCodeLine{09247\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_color\_write);}
\DoxyCodeLine{09248\ }
\DoxyCodeLine{09249\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ color\_channels\ =}
\DoxyCodeLine{09250\ \ \ \ \ target\_color\_write-\/>get\_channels()\ \&\ \_color\_write\_mask;}
\DoxyCodeLine{09251\ }
\DoxyCodeLine{09252\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{09253\ \ \ \textcolor{keywordflow}{if}\ (\_target\_shader-\/>get\_flag(ShaderAttrib::F\_disable\_alpha\_write))\ \{}
\DoxyCodeLine{09254\ \ \ \ \ color\_channels\ \&=\ \string~(ColorWriteAttrib::C\_alpha);}
\DoxyCodeLine{09255\ \ \ \}}
\DoxyCodeLine{09256\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09257\ }
\DoxyCodeLine{09258\ \ \ \textcolor{keywordflow}{if}\ (color\_channels\ ==\ ColorWriteAttrib::C\_off)\ \{}
\DoxyCodeLine{09259\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09260\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09261\ \ \ \ \ \textcolor{keywordflow}{if}\ (gl\_color\_mask)\ \{}
\DoxyCodeLine{09262\ \ \ \ \ \ \ enable\_blend(\textcolor{keyword}{false});}
\DoxyCodeLine{09263\ \ \ \ \ \ \ set\_color\_write\_mask(ColorWriteAttrib::C\_off);}
\DoxyCodeLine{09264\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09265\ \ \ \ \ \ \ enable\_blend(\textcolor{keyword}{true});}
\DoxyCodeLine{09266\ \ \ \ \ \ \ \_glBlendEquation(GL\_FUNC\_ADD);}
\DoxyCodeLine{09267\ \ \ \ \ \ \ glBlendFunc(GL\_ZERO,\ GL\_ONE);}
\DoxyCodeLine{09268\ \ \ \ \ \}}
\DoxyCodeLine{09269\ }
\DoxyCodeLine{09270\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09271\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquation(GL\_FUNC\_ADD)\(\backslash\)n"{}};}
\DoxyCodeLine{09272\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFunc(GL\_ZERO,\ GL\_ONE)\(\backslash\)n"{}};}
\DoxyCodeLine{09273\ \ \ \ \ \}}
\DoxyCodeLine{09274\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09275\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09276\ \ \ \ \ set\_color\_write\_mask(color\_channels);}
\DoxyCodeLine{09277\ \ \ \}}
\DoxyCodeLine{09278\ }
\DoxyCodeLine{09279\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classColorBlendAttrib}{ColorBlendAttrib}}\ *target\_color\_blend;}
\DoxyCodeLine{09280\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_color\_blend);}
\DoxyCodeLine{09281\ \ \ CPT(\mbox{\hyperlink{classColorBlendAttrib}{ColorBlendAttrib}})\ color\_blend\ =\ target\_color\_blend;}
\DoxyCodeLine{09282\ \ \ ColorBlendAttrib::Mode\ color\_blend\_mode\ =\ target\_color\_blend-\/>get\_mode();}
\DoxyCodeLine{09283\ \ \ ColorBlendAttrib::Mode\ alpha\_blend\_mode\ =\ target\_color\_blend-\/>get\_alpha\_mode();}
\DoxyCodeLine{09284\ }
\DoxyCodeLine{09285\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransparencyAttrib}{TransparencyAttrib}}\ *target\_transparency;}
\DoxyCodeLine{09286\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_transparency);}
\DoxyCodeLine{09287\ \ \ TransparencyAttrib::Mode\ transparency\_mode\ =\ target\_transparency-\/>get\_mode();}
\DoxyCodeLine{09288\ }
\DoxyCodeLine{09289\ \ \ \_color\_blend\_involves\_color\_scale\ =\ color\_blend-\/>involves\_color\_scale();}
\DoxyCodeLine{09290\ }
\DoxyCodeLine{09291\ \ \ \textcolor{comment}{//\ Is\ there\ a\ color\ blend\ set?}}
\DoxyCodeLine{09292\ \ \ \textcolor{keywordflow}{if}\ (color\_blend\_mode\ !=\ ColorBlendAttrib::M\_none)\ \{}
\DoxyCodeLine{09293\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09294\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09295\ \ \ \ \ enable\_blend(\textcolor{keyword}{true});}
\DoxyCodeLine{09296\ }
\DoxyCodeLine{09297\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_blend\_equation\_separate)\ \{}
\DoxyCodeLine{09298\ \ \ \ \ \ \ \_glBlendEquationSeparate(get\_blend\_equation\_type(color\_blend\_mode),}
\DoxyCodeLine{09299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_blend\_equation\_type(alpha\_blend\_mode));}
\DoxyCodeLine{09300\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09301\ \ \ \ \ \ \ \_glBlendEquation(get\_blend\_equation\_type(color\_blend\_mode));}
\DoxyCodeLine{09302\ \ \ \ \ \}}
\DoxyCodeLine{09303\ \ \ \ \ \_glBlendFuncSeparate(get\_blend\_func(color\_blend-\/>get\_operand\_a()),}
\DoxyCodeLine{09304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_blend\_func(color\_blend-\/>get\_operand\_b()),}
\DoxyCodeLine{09305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_blend\_func(color\_blend-\/>get\_alpha\_operand\_a()),}
\DoxyCodeLine{09306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_blend\_func(color\_blend-\/>get\_alpha\_operand\_b()));}
\DoxyCodeLine{09307\ }
\DoxyCodeLine{09308\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{09309\ \ \ \ \ LColor\ c;}
\DoxyCodeLine{09310\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_color\_blend\_involves\_color\_scale)\ \{}
\DoxyCodeLine{09311\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ the\ current\ color\ scale\ to\ the\ blend\ mode.}}
\DoxyCodeLine{09312\ \ \ \ \ \ \ c\ =\ \_current\_color\_scale;}
\DoxyCodeLine{09313\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09314\ \ \ \ \ \ \ c\ =\ color\_blend-\/>get\_color();}
\DoxyCodeLine{09315\ \ \ \ \ \}}
\DoxyCodeLine{09316\ }
\DoxyCodeLine{09317\ \ \ \ \ \_glBlendColor(c[0],\ c[1],\ c[2],\ c[3]);}
\DoxyCodeLine{09318\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09319\ }
\DoxyCodeLine{09320\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09321\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_blend\_equation\_separate)\ \{}
\DoxyCodeLine{09322\ \ \ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquationSeparate("{}}\ <<\ color\_blend\_mode\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{09323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ alpha\_blend\_mode\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{09324\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09325\ \ \ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquation("{}}\ <<\ color\_blend\_mode\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{09326\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09327\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFuncSeparate("{}}}
\DoxyCodeLine{09328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ color\_blend-\/>get\_operand\_a()\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{09329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ color\_blend-\/>get\_operand\_b()\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{09330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ color\_blend-\/>get\_alpha\_operand\_a()\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{09331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ color\_blend-\/>get\_alpha\_operand\_b()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{09332\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{09333\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendColor("{}}\ <<\ c\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{09334\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09335\ \ \ \ \ \}}
\DoxyCodeLine{09336\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09337\ \ \ \}}
\DoxyCodeLine{09338\ }
\DoxyCodeLine{09339\ \ \ \textcolor{comment}{//\ No\ color\ blend;\ is\ there\ a\ transparency\ set?}}
\DoxyCodeLine{09340\ \ \ \textcolor{keywordflow}{switch}\ (transparency\_mode)\ \{}
\DoxyCodeLine{09341\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_none:}
\DoxyCodeLine{09342\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_binary:}
\DoxyCodeLine{09343\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09344\ }
\DoxyCodeLine{09345\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_alpha:}
\DoxyCodeLine{09346\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_dual:}
\DoxyCodeLine{09347\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09348\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09349\ \ \ \ \ enable\_blend(\textcolor{keyword}{true});}
\DoxyCodeLine{09350\ \ \ \ \ \_glBlendEquation(GL\_FUNC\_ADD);}
\DoxyCodeLine{09351\ }
\DoxyCodeLine{09352\ \ \ \ \ \textcolor{keywordflow}{if}\ (old\_alpha\_blend)\ \{}
\DoxyCodeLine{09353\ \ \ \ \ \ \ glBlendFunc(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{09354\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09355\ \ \ \ \ \ \ \_glBlendFuncSeparate(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA,\ GL\_ONE,\ GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{09356\ \ \ \ \ \}}
\DoxyCodeLine{09357\ }
\DoxyCodeLine{09358\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09359\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquation(GL\_FUNC\_ADD)\(\backslash\)n"{}};}
\DoxyCodeLine{09360\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_blend\_equation\_separate\ \&\&\ !old\_alpha\_blend)\ \{}
\DoxyCodeLine{09361\ \ \ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFuncSeparate(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA,\ GL\_ONE,\ GL\_ONE\_MINUS\_SRC\_ALPHA)\(\backslash\)n"{}};}
\DoxyCodeLine{09362\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09363\ \ \ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFunc(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA)\(\backslash\)n"{}};}
\DoxyCodeLine{09364\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09365\ \ \ \ \ \}}
\DoxyCodeLine{09366\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09367\ }
\DoxyCodeLine{09368\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_premultiplied\_alpha:}
\DoxyCodeLine{09369\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09370\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09371\ \ \ \ \ enable\_blend(\textcolor{keyword}{true});}
\DoxyCodeLine{09372\ \ \ \ \ \_glBlendEquation(GL\_FUNC\_ADD);}
\DoxyCodeLine{09373\ \ \ \ \ glBlendFunc(GL\_ONE,\ GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{09374\ }
\DoxyCodeLine{09375\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09376\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquation(GL\_FUNC\_ADD)\(\backslash\)n"{}};}
\DoxyCodeLine{09377\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFunc(GL\_ONE,\ GL\_ONE\_MINUS\_SRC\_ALPHA)\(\backslash\)n"{}};}
\DoxyCodeLine{09378\ \ \ \ \ \}}
\DoxyCodeLine{09379\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09380\ }
\DoxyCodeLine{09381\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_multisample:}
\DoxyCodeLine{09382\ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ enable\ *both*\ of\ these\ in\ M\_multisample\ case.}}
\DoxyCodeLine{09383\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{true});}
\DoxyCodeLine{09384\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{true});}
\DoxyCodeLine{09385\ \ \ \ \ enable\_blend(\textcolor{keyword}{false});}
\DoxyCodeLine{09386\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09387\ }
\DoxyCodeLine{09388\ \ \ \textcolor{keywordflow}{case}\ TransparencyAttrib::M\_multisample\_mask:}
\DoxyCodeLine{09389\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09390\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{true});}
\DoxyCodeLine{09391\ \ \ \ \ enable\_blend(\textcolor{keyword}{false});}
\DoxyCodeLine{09392\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09393\ }
\DoxyCodeLine{09394\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{09395\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{09396\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}invalid\ transparency\ mode\ "{}}\ <<\ (int)transparency\_mode\ <<\ endl;}
\DoxyCodeLine{09397\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09398\ \ \ \}}
\DoxyCodeLine{09399\ }
\DoxyCodeLine{09400\ \ \ \textcolor{keywordflow}{if}\ (\_line\_smooth\_enabled\ ||\ \_point\_smooth\_enabled)\ \{}
\DoxyCodeLine{09401\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ either\ of\ these\ turned\ on,\ we\ also\ need\ to\ have\ blend\ mode}}
\DoxyCodeLine{09402\ \ \ \ \ \textcolor{comment}{//\ enabled\ in\ order\ to\ see\ it.}}
\DoxyCodeLine{09403\ \ \ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09404\ \ \ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09405\ \ \ \ \ enable\_blend(\textcolor{keyword}{true});}
\DoxyCodeLine{09406\ \ \ \ \ \_glBlendEquation(GL\_FUNC\_ADD);}
\DoxyCodeLine{09407\ \ \ \ \ glBlendFunc(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA);}
\DoxyCodeLine{09408\ }
\DoxyCodeLine{09409\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{09410\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendEquation(GL\_FUNC\_ADD)\(\backslash\)n"{}};}
\DoxyCodeLine{09411\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBlendFunc(GL\_SRC\_ALPHA,\ GL\_ONE\_MINUS\_SRC\_ALPHA)\(\backslash\)n"{}};}
\DoxyCodeLine{09412\ \ \ \ \ \}}
\DoxyCodeLine{09413\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09414\ \ \ \}}
\DoxyCodeLine{09415\ }
\DoxyCodeLine{09416\ \textcolor{comment}{/*}}
\DoxyCodeLine{09417\ \textcolor{comment}{\ *\ For\ best\ polygon\ smoothing,\ we\ need:\ (1)\ a\ frame\ buffer\ that\ supports\ alpha}}
\DoxyCodeLine{09418\ \textcolor{comment}{\ *\ (2)\ sort\ polygons\ front-\/to-\/back\ (3)\ glBlendFunc(GL\_SRC\_ALPHA\_SATURATE,}}
\DoxyCodeLine{09419\ \textcolor{comment}{\ *\ GL\_ONE);\ Since\ these\ modes\ have\ other\ implications\ for\ the\ application,\ we}}
\DoxyCodeLine{09420\ \textcolor{comment}{\ *\ don't\ attempt\ to\ do\ this\ by\ default.\ \ If\ you\ really\ want\ good\ polygon}}
\DoxyCodeLine{09421\ \textcolor{comment}{\ *\ smoothing\ (and\ you\ don't\ have\ multisample\ support),\ do\ all\ this\ yourself.}}
\DoxyCodeLine{09422\ \textcolor{comment}{\ */}}
\DoxyCodeLine{09423\ }
\DoxyCodeLine{09424\ \ \ \textcolor{comment}{//\ Nothing's\ set,\ so\ disable\ blending.}}
\DoxyCodeLine{09425\ \ \ enable\_multisample\_alpha\_one(\textcolor{keyword}{false});}
\DoxyCodeLine{09426\ \ \ enable\_multisample\_alpha\_mask(\textcolor{keyword}{false});}
\DoxyCodeLine{09427\ \ \ enable\_blend(\textcolor{keyword}{false});}
\DoxyCodeLine{09428\ \}}
\DoxyCodeLine{09429\ }
\DoxyCodeLine{09430\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09436\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09437\ bind\_light(\mbox{\hyperlink{classPointLight}{PointLight}}\ *light\_obj,\ const\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&light,\ int\ light\_id)\ \{}
\DoxyCodeLine{09438\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{09439\ }
\DoxyCodeLine{09440\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{09441\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_point\_pcollector("{}Draw:Set}}
\DoxyCodeLine{09442\ \ \ \textcolor{comment}{//\ State:Light:Bind:Point"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{09443\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_point\_pcollector);}}
\DoxyCodeLine{09444\ }
\DoxyCodeLine{09445\ \ \ GLenum\ \textcolor{keywordtype}{id}\ =\ get\_light\_id(light\_id);}
\DoxyCodeLine{09446\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ LColor\ black(0.0f,\ 0.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{09447\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_AMBIENT,\ black);}
\DoxyCodeLine{09448\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_DIFFUSE,\ get\_light\_color(light\_obj));}
\DoxyCodeLine{09449\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_SPECULAR,\ light\_obj-\/>get\_specular\_color());}
\DoxyCodeLine{09450\ }
\DoxyCodeLine{09451\ \ \ \textcolor{comment}{//\ Position\ needs\ to\ specify\ x,\ y,\ z,\ and\ w\ w\ ==\ 1\ implies\ non-\/infinite}}
\DoxyCodeLine{09452\ \ \ \textcolor{comment}{//\ position}}
\DoxyCodeLine{09453\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ transform\ =\ light.get\_transform(\_scene\_setup-\/>get\_scene\_root().get\_parent());}
\DoxyCodeLine{09454\ \ \ LPoint3\ pos\ =\ light\_obj-\/>get\_point()\ *\ transform-\/>get\_mat();}
\DoxyCodeLine{09455\ }
\DoxyCodeLine{09456\ \ \ LPoint4\ fpos(pos[0],\ pos[1],\ pos[2],\ 1.0f);}
\DoxyCodeLine{09457\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_POSITION,\ fpos);}
\DoxyCodeLine{09458\ }
\DoxyCodeLine{09459\ \ \ \textcolor{comment}{//\ GL\_SPOT\_DIRECTION\ is\ not\ significant\ when\ cutoff\ ==\ 180}}
\DoxyCodeLine{09460\ }
\DoxyCodeLine{09461\ \ \ \textcolor{comment}{//\ Exponent\ ==\ 0\ implies\ uniform\ light\ distribution}}
\DoxyCodeLine{09462\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_EXPONENT,\ 0.0f);}
\DoxyCodeLine{09463\ }
\DoxyCodeLine{09464\ \ \ \textcolor{comment}{//\ Cutoff\ ==\ 180\ means\ uniform\ point\ light\ source}}
\DoxyCodeLine{09465\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_CUTOFF,\ 180.0f);}
\DoxyCodeLine{09466\ }
\DoxyCodeLine{09467\ \ \ \textcolor{keyword}{const}\ LVecBase3\ \&att\ =\ light\_obj-\/>get\_attenuation();}
\DoxyCodeLine{09468\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_CONSTANT\_ATTENUATION,\ att[0]);}
\DoxyCodeLine{09469\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_LINEAR\_ATTENUATION,\ att[1]);}
\DoxyCodeLine{09470\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_QUADRATIC\_ATTENUATION,\ att[2]);}
\DoxyCodeLine{09471\ }
\DoxyCodeLine{09472\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09473\ \}}
\DoxyCodeLine{09474\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09475\ }
\DoxyCodeLine{09476\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09482\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09483\ bind\_light(\mbox{\hyperlink{classDirectionalLight}{DirectionalLight}}\ *light\_obj,\ const\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&light,\ int\ light\_id)\ \{}
\DoxyCodeLine{09484\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{09485\ }
\DoxyCodeLine{09486\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{09487\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_directional\_pcollector("{}Draw:Set}}
\DoxyCodeLine{09488\ \ \ \textcolor{comment}{//\ State:Light:Bind:Directional"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{09489\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_directional\_pcollector);}}
\DoxyCodeLine{09490\ }
\DoxyCodeLine{09491\ \ \ std::pair<DirectionalLights::iterator,\ bool>\ lookup\ =\ \_dlights.insert(DirectionalLights::value\_type(light,\ DirectionalLightFrameData()));}
\DoxyCodeLine{09492\ \ \ DirectionalLightFrameData\ \&fdata\ =\ (*lookup.first).second;}
\DoxyCodeLine{09493\ \ \ \textcolor{keywordflow}{if}\ (lookup.second)\ \{}
\DoxyCodeLine{09494\ \ \ \ \ \textcolor{comment}{//\ The\ light\ was\ not\ computed\ yet\ this\ frame.\ \ Compute\ it\ now.}}
\DoxyCodeLine{09495\ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ transform\ =\ light.get\_transform(\_scene\_setup-\/>get\_scene\_root().get\_parent());}
\DoxyCodeLine{09496\ \ \ \ \ LVector3\ dir\ =\ light\_obj-\/>get\_direction()\ *\ transform-\/>get\_mat();}
\DoxyCodeLine{09497\ \ \ \ \ fdata.\_neg\_dir.set(-\/dir[0],\ -\/dir[1],\ -\/dir[2],\ 0);}
\DoxyCodeLine{09498\ \ \ \}}
\DoxyCodeLine{09499\ }
\DoxyCodeLine{09500\ \ \ GLenum\ \textcolor{keywordtype}{id}\ =\ get\_light\_id(\ light\_id\ );}
\DoxyCodeLine{09501\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ LColor\ black(0.0f,\ 0.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{09502\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_AMBIENT,\ black);}
\DoxyCodeLine{09503\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_DIFFUSE,\ get\_light\_color(light\_obj));}
\DoxyCodeLine{09504\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_SPECULAR,\ light\_obj-\/>get\_specular\_color());}
\DoxyCodeLine{09505\ }
\DoxyCodeLine{09506\ \ \ \textcolor{comment}{//\ Position\ needs\ to\ specify\ x,\ y,\ z,\ and\ w.\ \ w\ ==\ 0\ implies\ light\ is\ at}}
\DoxyCodeLine{09507\ \ \ \textcolor{comment}{//\ infinity}}
\DoxyCodeLine{09508\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_POSITION,\ fdata.\_neg\_dir);}
\DoxyCodeLine{09509\ }
\DoxyCodeLine{09510\ \ \ \textcolor{comment}{//\ GL\_SPOT\_DIRECTION\ is\ not\ significant\ when\ cutoff\ ==\ 180\ In\ this\ case,}}
\DoxyCodeLine{09511\ \ \ \textcolor{comment}{//\ position\ x,\ y,\ z\ specifies\ direction}}
\DoxyCodeLine{09512\ }
\DoxyCodeLine{09513\ \ \ \textcolor{comment}{//\ Exponent\ ==\ 0\ implies\ uniform\ light\ distribution}}
\DoxyCodeLine{09514\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_EXPONENT,\ 0.0f);}
\DoxyCodeLine{09515\ }
\DoxyCodeLine{09516\ \ \ \textcolor{comment}{//\ Cutoff\ ==\ 180\ means\ uniform\ point\ light\ source}}
\DoxyCodeLine{09517\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_CUTOFF,\ 180.0f);}
\DoxyCodeLine{09518\ }
\DoxyCodeLine{09519\ \ \ \textcolor{comment}{//\ Default\ attenuation\ values\ (only\ spotlight\ and\ point\ light\ can\ modify}}
\DoxyCodeLine{09520\ \ \ \textcolor{comment}{//\ these)}}
\DoxyCodeLine{09521\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_CONSTANT\_ATTENUATION,\ 1.0f);}
\DoxyCodeLine{09522\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_LINEAR\_ATTENUATION,\ 0.0f);}
\DoxyCodeLine{09523\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_QUADRATIC\_ATTENUATION,\ 0.0f);}
\DoxyCodeLine{09524\ }
\DoxyCodeLine{09525\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09526\ \}}
\DoxyCodeLine{09527\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09528\ }
\DoxyCodeLine{09529\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09535\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09536\ bind\_light(\mbox{\hyperlink{classSpotlight}{Spotlight}}\ *light\_obj,\ const\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&light,\ int\ light\_id)\ \{}
\DoxyCodeLine{09537\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{09538\ }
\DoxyCodeLine{09539\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{09540\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_spotlight\_pcollector("{}Draw:Set}}
\DoxyCodeLine{09541\ \ \ \textcolor{comment}{//\ State:Light:Bind:Spotlight"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{09542\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_bind\_spotlight\_pcollector);}}
\DoxyCodeLine{09543\ }
\DoxyCodeLine{09544\ \ \ \mbox{\hyperlink{classLens}{Lens}}\ *lens\ =\ light\_obj-\/>get\_lens();}
\DoxyCodeLine{09545\ \ \ nassertv(lens\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{09546\ }
\DoxyCodeLine{09547\ \ \ GLenum\ \textcolor{keywordtype}{id}\ =\ get\_light\_id(light\_id);}
\DoxyCodeLine{09548\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ LColor\ black(0.0f,\ 0.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{09549\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_AMBIENT,\ black);}
\DoxyCodeLine{09550\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_DIFFUSE,\ get\_light\_color(light\_obj));}
\DoxyCodeLine{09551\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_SPECULAR,\ light\_obj-\/>get\_specular\_color());}
\DoxyCodeLine{09552\ }
\DoxyCodeLine{09553\ \ \ \textcolor{comment}{//\ Position\ needs\ to\ specify\ x,\ y,\ z,\ and\ w\ w\ ==\ 1\ implies\ non-\/infinite}}
\DoxyCodeLine{09554\ \ \ \textcolor{comment}{//\ position}}
\DoxyCodeLine{09555\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ transform\ =\ light.get\_transform(\_scene\_setup-\/>get\_scene\_root().get\_parent());}
\DoxyCodeLine{09556\ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&light\_mat\ =\ transform-\/>get\_mat();}
\DoxyCodeLine{09557\ \ \ LPoint3\ pos\ =\ lens-\/>\mbox{\hyperlink{classLens_a9e0dd414581ea98661d732d158b804f6}{get\_nodal\_point}}()\ *\ light\_mat;}
\DoxyCodeLine{09558\ \ \ LVector3\ dir\ =\ lens-\/>\mbox{\hyperlink{classLens_ae74283649a01f7358f0d6dba47225e77}{get\_view\_vector}}()\ *\ light\_mat;}
\DoxyCodeLine{09559\ }
\DoxyCodeLine{09560\ \ \ LPoint4\ fpos(pos[0],\ pos[1],\ pos[2],\ 1.0f);}
\DoxyCodeLine{09561\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_POSITION,\ fpos);}
\DoxyCodeLine{09562\ \ \ call\_glLightfv(\textcolor{keywordtype}{id},\ GL\_SPOT\_DIRECTION,\ dir);}
\DoxyCodeLine{09563\ }
\DoxyCodeLine{09564\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_EXPONENT,\ max(min(light\_obj-\/>get\_exponent(),\ (PN\_stdfloat)128),\ (PN\_stdfloat)0));}
\DoxyCodeLine{09565\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_SPOT\_CUTOFF,\ lens-\/>get\_hfov()\ *\ 0.5f);}
\DoxyCodeLine{09566\ }
\DoxyCodeLine{09567\ \ \ \textcolor{keyword}{const}\ LVecBase3\ \&att\ =\ light\_obj-\/>get\_attenuation();}
\DoxyCodeLine{09568\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_CONSTANT\_ATTENUATION,\ att[0]);}
\DoxyCodeLine{09569\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_LINEAR\_ATTENUATION,\ att[1]);}
\DoxyCodeLine{09570\ \ \ glLightf(\textcolor{keywordtype}{id},\ GL\_QUADRATIC\_ATTENUATION,\ att[2]);}
\DoxyCodeLine{09571\ }
\DoxyCodeLine{09572\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{09573\ \}}
\DoxyCodeLine{09574\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{09575\ }
\DoxyCodeLine{09580\ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09581\ make\_shadow\_buffer(\mbox{\hyperlink{classLightLensNode}{LightLensNode}}\ *light,\ \mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *host)\ \{}
\DoxyCodeLine{09582\ \ \ \textcolor{comment}{//\ We\ override\ this\ to\ circumvent\ the\ fact\ that\ GraphicsEngine::make\_output}}
\DoxyCodeLine{09583\ \ \ \textcolor{comment}{//\ can\ only\ be\ called\ from\ the\ app\ thread.}}
\DoxyCodeLine{09584\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_framebuffer\_object)\ \{}
\DoxyCodeLine{09585\ \ \ \ \ \textcolor{keywordflow}{return}\ GraphicsStateGuardian::make\_shadow\_buffer(light,\ tex,\ host);}
\DoxyCodeLine{09586\ \ \ \}}
\DoxyCodeLine{09587\ }
\DoxyCodeLine{09588\ \ \ \textcolor{keywordtype}{bool}\ is\_point\ =\ light-\/>is\_of\_type(PointLight::get\_class\_type());}
\DoxyCodeLine{09589\ }
\DoxyCodeLine{09590\ \ \ \textcolor{comment}{//\ Determine\ the\ properties\ for\ creating\ the\ depth\ buffer.}}
\DoxyCodeLine{09591\ \ \ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ fbp;}
\DoxyCodeLine{09592\ \ \ fbp.set\_depth\_bits(shadow\_depth\_bits);}
\DoxyCodeLine{09593\ }
\DoxyCodeLine{09594\ \ \ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ props\ =\ \mbox{\hyperlink{classWindowProperties_a19ea6ad41750bd4e983f64ee9e507d02}{WindowProperties::size}}(light-\/>get\_shadow\_buffer\_size());}
\DoxyCodeLine{09595\ \ \ \textcolor{keywordtype}{int}\ flags\ =\ GraphicsPipe::BF\_refuse\_window;}
\DoxyCodeLine{09596\ \ \ \textcolor{keywordflow}{if}\ (is\_point)\ \{}
\DoxyCodeLine{09597\ \ \ \ \ flags\ |=\ GraphicsPipe::BF\_size\_square;}
\DoxyCodeLine{09598\ \ \ \}}
\DoxyCodeLine{09599\ }
\DoxyCodeLine{09600\ \ \ \textcolor{keywordflow}{if}\ (host\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{09601\ \ \ \ \ host\ =\ host-\/>get\_host();}
\DoxyCodeLine{09602\ \ \ \}}
\DoxyCodeLine{09603\ }
\DoxyCodeLine{09604\ \ \ CLP(\mbox{\hyperlink{classGraphicsBuffer}{GraphicsBuffer}})\ *sbuffer\ =\ \textcolor{keyword}{new}\ CLP(\mbox{\hyperlink{classGraphicsBuffer}{GraphicsBuffer}})(get\_engine(),\ get\_pipe(),\ light-\/>get\_name(),\ fbp,\ props,\ flags,\ \textcolor{keyword}{this},\ host);}
\DoxyCodeLine{09605\ \ \ sbuffer-\/>add\_render\_texture(tex,\ GraphicsOutput::RTM\_bind\_or\_copy,\ GraphicsOutput::RTP\_depth);}
\DoxyCodeLine{09606\ \ \ get\_engine()-\/>add\_window(sbuffer,\ light-\/>get\_shadow\_buffer\_sort());}
\DoxyCodeLine{09607\ \ \ \textcolor{keywordflow}{return}\ sbuffer;}
\DoxyCodeLine{09608\ \}}
\DoxyCodeLine{09609\ }
\DoxyCodeLine{09610\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{09615\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09616\ draw\_immediate\_simple\_primitives(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ GLenum\ mode)\ \{}
\DoxyCodeLine{09617\ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{09618\ \ \ \_vertices\_immediate\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{09619\ \ \ glBegin(mode);}
\DoxyCodeLine{09620\ }
\DoxyCodeLine{09621\ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{09622\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ v\ =\ 0;\ v\ <\ num\_vertices;\ ++v)\ \{}
\DoxyCodeLine{09623\ \ \ \ \ \ \ \_sender.set\_vertex(reader-\/>get\_vertex(v));}
\DoxyCodeLine{09624\ \ \ \ \ \ \ \_sender.issue\_vertex();}
\DoxyCodeLine{09625\ \ \ \ \ \}}
\DoxyCodeLine{09626\ }
\DoxyCodeLine{09627\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09628\ \ \ \ \ \_sender.set\_vertex(reader-\/>get\_first\_vertex());}
\DoxyCodeLine{09629\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ v\ =\ 0;\ v\ <\ num\_vertices;\ ++v)\ \{}
\DoxyCodeLine{09630\ \ \ \ \ \ \ \_sender.issue\_vertex();}
\DoxyCodeLine{09631\ \ \ \ \ \}}
\DoxyCodeLine{09632\ \ \ \}}
\DoxyCodeLine{09633\ }
\DoxyCodeLine{09634\ \ \ glEnd();}
\DoxyCodeLine{09635\ \}}
\DoxyCodeLine{09636\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{09637\ }
\DoxyCodeLine{09638\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{09644\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09645\ draw\_immediate\_composite\_primitives(const\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,\ GLenum\ mode)\ \{}
\DoxyCodeLine{09646\ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ reader-\/>get\_num\_vertices();}
\DoxyCodeLine{09647\ \ \ \_vertices\_immediate\_pcollector.add\_level(num\_vertices);}
\DoxyCodeLine{09648\ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_int}}\ ends\ =\ reader-\/>get\_ends();}
\DoxyCodeLine{09649\ \ \ \textcolor{keywordtype}{int}\ num\_unused\_vertices\_per\_primitive\ =\ reader-\/>get\_object()-\/>get\_num\_unused\_vertices\_per\_primitive();}
\DoxyCodeLine{09650\ }
\DoxyCodeLine{09651\ \ \ \textcolor{keywordflow}{if}\ (reader-\/>is\_indexed())\ \{}
\DoxyCodeLine{09652\ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ 0;}
\DoxyCodeLine{09653\ \ \ \ \ CPTA\_int::const\_iterator\ ei;}
\DoxyCodeLine{09654\ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ ends.begin();\ ei\ !=\ ends.end();\ ++ei)\ \{}
\DoxyCodeLine{09655\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ end\ =\ (*ei);}
\DoxyCodeLine{09656\ }
\DoxyCodeLine{09657\ \ \ \ \ \ \ glBegin(mode);}
\DoxyCodeLine{09658\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ v\ =\ begin;\ v\ <\ end;\ ++v)\ \{}
\DoxyCodeLine{09659\ \ \ \ \ \ \ \ \ \_sender.set\_vertex(reader-\/>get\_vertex(v));}
\DoxyCodeLine{09660\ \ \ \ \ \ \ \ \ \_sender.issue\_vertex();}
\DoxyCodeLine{09661\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09662\ \ \ \ \ \ \ glEnd();}
\DoxyCodeLine{09663\ }
\DoxyCodeLine{09664\ \ \ \ \ \ \ begin\ =\ end\ +\ num\_unused\_vertices\_per\_primitive;}
\DoxyCodeLine{09665\ \ \ \ \ \}}
\DoxyCodeLine{09666\ }
\DoxyCodeLine{09667\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09668\ \ \ \ \ \_sender.set\_vertex(reader-\/>get\_first\_vertex());}
\DoxyCodeLine{09669\ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ 0;}
\DoxyCodeLine{09670\ \ \ \ \ CPTA\_int::const\_iterator\ ei;}
\DoxyCodeLine{09671\ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ ends.begin();\ ei\ !=\ ends.end();\ ++ei)\ \{}
\DoxyCodeLine{09672\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ end\ =\ (*ei);}
\DoxyCodeLine{09673\ }
\DoxyCodeLine{09674\ \ \ \ \ \ \ glBegin(mode);}
\DoxyCodeLine{09675\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ v\ =\ begin;\ v\ <\ end;\ ++v)\ \{}
\DoxyCodeLine{09676\ \ \ \ \ \ \ \ \ \_sender.issue\_vertex();}
\DoxyCodeLine{09677\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09678\ \ \ \ \ \ \ glEnd();}
\DoxyCodeLine{09679\ }
\DoxyCodeLine{09680\ \ \ \ \ \ \ begin\ =\ end\ +\ num\_unused\_vertices\_per\_primitive;}
\DoxyCodeLine{09681\ \ \ \ \ \}}
\DoxyCodeLine{09682\ \ \ \}}
\DoxyCodeLine{09683\ \}}
\DoxyCodeLine{09684\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_IMMEDIATE\_MODE}}
\DoxyCodeLine{09685\ }
\DoxyCodeLine{09689\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09690\ gl\_flush()\ const\ \{}
\DoxyCodeLine{09691\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_flush\_pcollector);}
\DoxyCodeLine{09692\ \ \ glFlush();}
\DoxyCodeLine{09693\ \}}
\DoxyCodeLine{09694\ }
\DoxyCodeLine{09698\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09699\ gl\_get\_error()\ const\ \{}
\DoxyCodeLine{09700\ \ \ if\ (\_check\_errors)\ \{}
\DoxyCodeLine{09701\ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_check\_error\_pcollector);}
\DoxyCodeLine{09702\ \ \ \ \ \textcolor{keywordflow}{return}\ glGetError();}
\DoxyCodeLine{09703\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09704\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NO\_ERROR;}
\DoxyCodeLine{09705\ \ \ \}}
\DoxyCodeLine{09706\ \}}
\DoxyCodeLine{09707\ }
\DoxyCodeLine{09713\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09714\ report\_errors\_loop(int\ line,\ const\ char\ *source\_file,\ GLenum\ error\_code,}
\DoxyCodeLine{09715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ \&error\_count)\ \{}
\DoxyCodeLine{09716\ \ \ \textcolor{keywordflow}{while}\ ((gl\_max\_errors\ <\ 0\ ||\ error\_count\ <\ gl\_max\_errors)\ \&\&}
\DoxyCodeLine{09717\ \ \ \ \ \ \ \ \ \ (error\_code\ !=\ GL\_NO\_ERROR))\ \{}
\DoxyCodeLine{09718\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{09719\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}at\ "{}}\ <<\ line\ <<\ \textcolor{stringliteral}{"{}\ of\ "{}}\ <<\ source\_file\ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}}
\DoxyCodeLine{09720\ \ \ \ \ \ \ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09721\ }
\DoxyCodeLine{09722\ \ \ \ \ error\_code\ =\ glGetError();}
\DoxyCodeLine{09723\ \ \ \ \ error\_count++;}
\DoxyCodeLine{09724\ \ \ \}}
\DoxyCodeLine{09725\ }
\DoxyCodeLine{09726\ \ \ \textcolor{keywordflow}{return}\ (error\_code\ ==\ GL\_NO\_ERROR);}
\DoxyCodeLine{09727\ \}}
\DoxyCodeLine{09728\ }
\DoxyCodeLine{09732\ \textcolor{keywordtype}{string}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09733\ get\_error\_string(GLenum\ error\_code)\ \{}
\DoxyCodeLine{09734\ \ \ \textcolor{comment}{//\ We\ used\ to\ use\ gluErrorString\ here,\ but\ I\ (rdb)\ took\ it\ out\ because\ that}}
\DoxyCodeLine{09735\ \ \ \textcolor{comment}{//\ was\ really\ the\ only\ function\ we\ used\ from\ GLU.\ The\ idea\ with\ the\ error}}
\DoxyCodeLine{09736\ \ \ \textcolor{comment}{//\ table\ was\ taken\ from\ SGI's\ sample\ implementation.}}
\DoxyCodeLine{09737\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *error\_strings[]\ =\ \{}
\DoxyCodeLine{09738\ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ enumerant"{}},}
\DoxyCodeLine{09739\ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ value"{}},}
\DoxyCodeLine{09740\ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ operation"{}},}
\DoxyCodeLine{09741\ \ \ \ \ \textcolor{stringliteral}{"{}stack\ overflow"{}},}
\DoxyCodeLine{09742\ \ \ \ \ \textcolor{stringliteral}{"{}stack\ underflow"{}},}
\DoxyCodeLine{09743\ \ \ \ \ \textcolor{stringliteral}{"{}out\ of\ memory"{}},}
\DoxyCodeLine{09744\ \ \ \ \ \textcolor{stringliteral}{"{}invalid\ framebuffer\ operation"{}},}
\DoxyCodeLine{09745\ \ \ \ \ \textcolor{stringliteral}{"{}context\ lost"{}},}
\DoxyCodeLine{09746\ \ \ \};}
\DoxyCodeLine{09747\ }
\DoxyCodeLine{09748\ \ \ \textcolor{keywordflow}{if}\ (error\_code\ ==\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{09749\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}no\ error"{}};}
\DoxyCodeLine{09750\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09751\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\_code\ ==\ GL\_TABLE\_TOO\_LARGE)\ \{}
\DoxyCodeLine{09752\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}table\ too\ large"{}};}
\DoxyCodeLine{09753\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09754\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (error\_code\ >=\ 0x0500\ \&\&\ error\_code\ <=\ 0x0507)\ \{}
\DoxyCodeLine{09755\ \ \ \ \ \textcolor{keywordflow}{return}\ error\_strings[error\_code\ -\/\ 0x0500];}
\DoxyCodeLine{09756\ \ \ \}}
\DoxyCodeLine{09757\ }
\DoxyCodeLine{09758\ \ \ \textcolor{comment}{//\ Other\ error,\ somehow?\ \ Just\ display\ the\ error\ code\ then.}}
\DoxyCodeLine{09759\ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ strm;}
\DoxyCodeLine{09760\ \ \ strm\ <<\ \textcolor{stringliteral}{"{}GL\ error\ "{}}\ <<\ (int)error\_code;}
\DoxyCodeLine{09761\ }
\DoxyCodeLine{09762\ \ \ \textcolor{keywordflow}{return}\ strm.str();}
\DoxyCodeLine{09763\ \}}
\DoxyCodeLine{09764\ }
\DoxyCodeLine{09769\ \textcolor{keywordtype}{string}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09770\ show\_gl\_string(const\ string\ \&name,\ GLenum\ id)\ \{}
\DoxyCodeLine{09771\ \ \ \textcolor{keywordtype}{string}\ result;}
\DoxyCodeLine{09772\ }
\DoxyCodeLine{09773\ \ \ \textcolor{keyword}{const}\ GLubyte\ *text\ =\ glGetString(\textcolor{keywordtype}{id});}
\DoxyCodeLine{09774\ }
\DoxyCodeLine{09775\ \ \ \textcolor{keywordflow}{if}\ (text\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{09776\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{09777\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ query\ "{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09778\ }
\DoxyCodeLine{09779\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09780\ \ \ \ \ result\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)text;}
\DoxyCodeLine{09781\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{09782\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{09783\ \ \ \ \ \ \ \ \ <<\ name\ <<\ \textcolor{stringliteral}{"{}\ =\ "{}}\ <<\ result\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09784\ \ \ \ \ \}}
\DoxyCodeLine{09785\ \ \ \}}
\DoxyCodeLine{09786\ }
\DoxyCodeLine{09787\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{09788\ \}}
\DoxyCodeLine{09789\ }
\DoxyCodeLine{09793\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09794\ query\_gl\_version()\ \{}
\DoxyCodeLine{09795\ \ \ \_gl\_vendor\ =\ show\_gl\_string(\textcolor{stringliteral}{"{}GL\_VENDOR"{}},\ GL\_VENDOR);}
\DoxyCodeLine{09796\ \ \ \_gl\_renderer\ =\ show\_gl\_string(\textcolor{stringliteral}{"{}GL\_RENDERER"{}},\ GL\_RENDERER);}
\DoxyCodeLine{09797\ \ \ \_gl\_version\ =\ show\_gl\_string(\textcolor{stringliteral}{"{}GL\_VERSION"{}},\ GL\_VERSION);}
\DoxyCodeLine{09798\ }
\DoxyCodeLine{09799\ \ \ \_gl\_version\_major\ =\ 0;}
\DoxyCodeLine{09800\ \ \ \_gl\_version\_minor\ =\ 0;}
\DoxyCodeLine{09801\ }
\DoxyCodeLine{09802\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ most\ preposterous\ driver\ bug:\ NVIDIA\ drivers\ will\ claim}}
\DoxyCodeLine{09803\ \ \ \ \ \textcolor{comment}{//\ that\ the\ version\ is\ 1.2\ as\ long\ as\ the\ process\ is\ named\ pview.exe!}}
\DoxyCodeLine{09804\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09805\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version.substr(0,\ 10)\ ==\ \textcolor{stringliteral}{"{}1.2\ NVIDIA"{}})\ \{}
\DoxyCodeLine{09806\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ exec\_name\ =\ ExecutionEnvironment::get\_binary\_name();}
\DoxyCodeLine{09807\ \ \ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(exec\_name.get\_basename(),\ \textcolor{stringliteral}{"{}pview.exe"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{09808\ \ \ \ \ \ \ glGetIntegerv(GL\_MAJOR\_VERSION,\ \&\_gl\_version\_major);}
\DoxyCodeLine{09809\ \ \ \ \ \ \ glGetIntegerv(GL\_MINOR\_VERSION,\ \&\_gl\_version\_minor);}
\DoxyCodeLine{09810\ }
\DoxyCodeLine{09811\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (glGetError()\ ==\ GL\_INVALID\_ENUM)\ \{}
\DoxyCodeLine{09812\ \ \ \ \ \ \ \ \ \_gl\_version\_major\ =\ 1;}
\DoxyCodeLine{09813\ \ \ \ \ \ \ \ \ \_gl\_version\_minor\ =\ 2;}
\DoxyCodeLine{09814\ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{09815\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Driver\ possibly\ misreported\ GL\_VERSION!\ \ Unable\ to\ detect\ "{}}}
\DoxyCodeLine{09816\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}correct\ OpenGL\ version.\(\backslash\)n"{}};}
\DoxyCodeLine{09817\ }
\DoxyCodeLine{09818\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ !=\ 1\ ||\ \_gl\_version\_minor\ !=\ 2)\ \{}
\DoxyCodeLine{09819\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{09820\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Driver\ misreported\ GL\_VERSION!\ \ Correct\ version\ detected\ as\ "{}}}
\DoxyCodeLine{09821\ \ \ \ \ \ \ \ \ \ \ <<\ \_gl\_version\_major\ <<\ \textcolor{stringliteral}{"{}."{}}\ <<\ \_gl\_version\_minor\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09822\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09823\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09824\ \ \ \ \ \}}
\DoxyCodeLine{09825\ \ \ \}}
\DoxyCodeLine{09826\ }
\DoxyCodeLine{09827\ \ \ \textcolor{comment}{//\ If\ we\ asked\ for\ a\ GL\ 3\ context,\ let's\ first\ try\ and\ see\ if\ we\ can\ use\ the}}
\DoxyCodeLine{09828\ \ \ \textcolor{comment}{//\ OpenGL\ 3\ way\ to\ query\ version.}}
\DoxyCodeLine{09829\ \ \ \textcolor{keywordflow}{if}\ (gl\_version.get\_num\_words()\ >\ 0\ \&\&\ gl\_version[0]\ >=\ 3)\ \{}
\DoxyCodeLine{09830\ \ \ \ \ glGetIntegerv(GL\_MAJOR\_VERSION,\ \&\_gl\_version\_major);}
\DoxyCodeLine{09831\ \ \ \ \ glGetIntegerv(GL\_MINOR\_VERSION,\ \&\_gl\_version\_minor);}
\DoxyCodeLine{09832\ }
\DoxyCodeLine{09833\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 1)\ \{}
\DoxyCodeLine{09834\ \ \ \ \ \ \ \textcolor{comment}{//\ Fair\ enough,\ seems\ to\ check\ out.}}
\DoxyCodeLine{09835\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{09836\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{09837\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Detected\ OpenGL\ version:\ "{}}}
\DoxyCodeLine{09838\ \ \ \ \ \ \ \ \ \ \ <<\ \_gl\_version\_major\ <<\ \textcolor{stringliteral}{"{}."{}}\ <<\ \_gl\_version\_minor\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09839\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09840\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{09841\ \ \ \ \ \}}
\DoxyCodeLine{09842\ \ \ \}}
\DoxyCodeLine{09843\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{09844\ }
\DoxyCodeLine{09845\ \ \ \textcolor{comment}{//\ Otherwise,\ parse\ the\ GL\_VERSION\ string.}}
\DoxyCodeLine{09846\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version.empty())\ \{}
\DoxyCodeLine{09847\ \ \ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Unable\ to\ detect\ OpenGL\ version\(\backslash\)n"{}};}
\DoxyCodeLine{09848\ }
\DoxyCodeLine{09849\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09850\ \ \ \ \ \textcolor{keywordtype}{string}\ input\ =\ \_gl\_version;}
\DoxyCodeLine{09851\ }
\DoxyCodeLine{09852\ \ \ \ \ \textcolor{comment}{//\ Skip\ any\ initial\ words\ that\ don't\ begin\ with\ a\ digit.}}
\DoxyCodeLine{09853\ \ \ \ \ \textcolor{keywordflow}{while}\ (!input.empty()\ \&\&\ !isdigit(input[0]))\ \{}
\DoxyCodeLine{09854\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ space\ =\ input.find(\textcolor{charliteral}{'\ '});}
\DoxyCodeLine{09855\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (space\ ==\ string::npos)\ \{}
\DoxyCodeLine{09856\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09857\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09858\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ next\ =\ space\ +\ 1;}
\DoxyCodeLine{09859\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (next\ <\ input.length()\ \&\&\ isspace(input[next]))\ \{}
\DoxyCodeLine{09860\ \ \ \ \ \ \ \ \ ++next;}
\DoxyCodeLine{09861\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09862\ \ \ \ \ \ \ input\ =\ input.substr(next);}
\DoxyCodeLine{09863\ \ \ \ \ \}}
\DoxyCodeLine{09864\ }
\DoxyCodeLine{09865\ \ \ \ \ \textcolor{comment}{//\ Truncate\ after\ the\ first\ space.}}
\DoxyCodeLine{09866\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ space\ =\ input.find(\textcolor{charliteral}{'\ '});}
\DoxyCodeLine{09867\ \ \ \ \ \textcolor{keywordflow}{if}\ (space\ !=\ string::npos)\ \{}
\DoxyCodeLine{09868\ \ \ \ \ \ \ input\ =\ input.substr(0,\ space);}
\DoxyCodeLine{09869\ \ \ \ \ \}}
\DoxyCodeLine{09870\ }
\DoxyCodeLine{09871\ \ \ \ \ vector\_string\ components;}
\DoxyCodeLine{09872\ \ \ \ \ \mbox{\hyperlink{string__utils_8cxx_afcc82a47a52a95f3b9f10cbd16a8f575}{tokenize}}(input,\ components,\ \textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{09873\ \ \ \ \ \textcolor{keywordflow}{if}\ (components.size()\ >=\ 1)\ \{}
\DoxyCodeLine{09874\ \ \ \ \ \ \ \mbox{\hyperlink{string__utils_8cxx_afb42bc2cbaf54ce7ba1030e0ef7d77b4}{string\_to\_int}}(components[0],\ \_gl\_version\_major);}
\DoxyCodeLine{09875\ \ \ \ \ \}}
\DoxyCodeLine{09876\ \ \ \ \ \textcolor{keywordflow}{if}\ (components.size()\ >=\ 2)\ \{}
\DoxyCodeLine{09877\ \ \ \ \ \ \ \mbox{\hyperlink{string__utils_8cxx_afb42bc2cbaf54ce7ba1030e0ef7d77b4}{string\_to\_int}}(components[1],\ \_gl\_version\_minor);}
\DoxyCodeLine{09878\ \ \ \ \ \}}
\DoxyCodeLine{09879\ }
\DoxyCodeLine{09880\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{09881\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{09882\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\_VERSION\ decoded\ to:\ "{}}}
\DoxyCodeLine{09883\ \ \ \ \ \ \ \ \ <<\ \_gl\_version\_major\ <<\ \textcolor{stringliteral}{"{}."{}}\ <<\ \_gl\_version\_minor}
\DoxyCodeLine{09884\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09885\ \ \ \ \ \}}
\DoxyCodeLine{09886\ \ \ \}}
\DoxyCodeLine{09887\ \}}
\DoxyCodeLine{09888\ }
\DoxyCodeLine{09892\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09893\ query\_glsl\_version()\ \{}
\DoxyCodeLine{09894\ \ \ \_gl\_shadlang\_ver\_major\ =\ 0;}
\DoxyCodeLine{09895\ \ \ \_gl\_shadlang\_ver\_minor\ =\ 0;}
\DoxyCodeLine{09896\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{09897\ }
\DoxyCodeLine{09898\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{09899\ \ \ \textcolor{comment}{//\ OpenGL\ 2.0\ introduces\ GLSL\ in\ the\ core.\ \ In\ 1.x,\ it\ is\ an\ extension.}}
\DoxyCodeLine{09900\ \ \ \textcolor{keywordflow}{if}\ (\_gl\_version\_major\ >=\ 2\ ||\ has\_extension(\textcolor{stringliteral}{"{}GL\_ARB\_shading\_language\_100"{}}))\ \{}
\DoxyCodeLine{09901\ \ \ \ \ \textcolor{keywordtype}{string}\ ver\ =\ show\_gl\_string(\textcolor{stringliteral}{"{}GL\_SHADING\_LANGUAGE\_VERSION"{}},\ GL\_SHADING\_LANGUAGE\_VERSION);}
\DoxyCodeLine{09902\ \ \ \ \ \_gl\_shadlang\_ver\_major\ =\ 1;}
\DoxyCodeLine{09903\ \ \ \ \ \_gl\_shadlang\_ver\_minor\ =\ (\_gl\_version\_major\ >=\ 2)\ ?\ 1\ :\ 0;}
\DoxyCodeLine{09904\ \ \ \ \ \textcolor{keywordflow}{if}\ (ver.empty()\ ||}
\DoxyCodeLine{09905\ \ \ \ \ \ \ \ \ sscanf(ver.c\_str(),\ \textcolor{stringliteral}{"{}\%d.\%d"{}},\ \&\_gl\_shadlang\_ver\_major,}
\DoxyCodeLine{09906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\_gl\_shadlang\_ver\_minor)\ !=\ 2)\ \{}
\DoxyCodeLine{09907\ \ \ \ \ \ \ GLCAT.warning()\ <<\ \textcolor{stringliteral}{"{}Invalid\ GL\_SHADING\_LANGUAGE\_VERSION\ format:\ "{}}\ <<\ ver\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09908\ \ \ \ \ \}}
\DoxyCodeLine{09909\ \ \ \}}
\DoxyCodeLine{09910\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{09911\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 2.0\ and\ above\ has\ shader\ support\ built-\/in.}}
\DoxyCodeLine{09912\ \ \ \textcolor{keywordtype}{string}\ ver\ =\ show\_gl\_string(\textcolor{stringliteral}{"{}GL\_SHADING\_LANGUAGE\_VERSION"{}},\ GL\_SHADING\_LANGUAGE\_VERSION);}
\DoxyCodeLine{09913\ \ \ \_gl\_shadlang\_ver\_major\ =\ 1;}
\DoxyCodeLine{09914\ \ \ \_gl\_shadlang\_ver\_minor\ =\ 0;}
\DoxyCodeLine{09915\ \ \ \textcolor{keywordflow}{if}\ (ver.empty()\ ||}
\DoxyCodeLine{09916\ \ \ \ \ \ \ sscanf(ver.c\_str(),\ \textcolor{stringliteral}{"{}OpenGL\ ES\ GLSL\ ES\ \%d.\%d"{}},\ \&\_gl\_shadlang\_ver\_major,}
\DoxyCodeLine{09917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\_gl\_shadlang\_ver\_minor)\ !=\ 2)\ \{}
\DoxyCodeLine{09918\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_\ \ }\textcolor{comment}{//\ See\ emscripten\ bug\ 4070}}
\DoxyCodeLine{09919\ \ \ \ \ \textcolor{keywordflow}{if}\ (sscanf(ver.c\_str(),\ \textcolor{stringliteral}{"{}OpenGL\ ES\ GLSL\ \%d.\%d"{}},\ \&\_gl\_shadlang\_ver\_major,}
\DoxyCodeLine{09920\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\_gl\_shadlang\_ver\_minor)\ !=\ 2)}
\DoxyCodeLine{09921\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09922\ \ \ \ \ GLCAT.warning()\ <<\ \textcolor{stringliteral}{"{}Invalid\ GL\_SHADING\_LANGUAGE\_VERSION\ format:\ "{}}\ <<\ ver\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09923\ \ \ \}}
\DoxyCodeLine{09924\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09925\ }
\DoxyCodeLine{09926\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{09927\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{09928\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Detected\ GLSL\ "{}}}
\DoxyCodeLine{09929\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{09930\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ES\ "{}}}
\DoxyCodeLine{09931\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{09932\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}version:\ "{}}}
\DoxyCodeLine{09933\ \ \ \ \ \ \ <<\ \_gl\_shadlang\_ver\_major\ <<\ \textcolor{stringliteral}{"{}."{}}\ <<\ \_gl\_shadlang\_ver\_minor\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{09934\ \ \ \}}
\DoxyCodeLine{09935\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{09936\ \}}
\DoxyCodeLine{09937\ }
\DoxyCodeLine{09942\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09943\ save\_extensions(const\ char\ *extensions)\ \{}
\DoxyCodeLine{09944\ \ \ \textcolor{keywordflow}{if}\ (extensions\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{09945\ \ \ \ \ vector\_string\ tokens;}
\DoxyCodeLine{09946\ \ \ \ \ \mbox{\hyperlink{string__utils_8cxx_a67cbdf41c41ef284b3d1579cefca761f}{extract\_words}}(extensions,\ tokens);}
\DoxyCodeLine{09947\ }
\DoxyCodeLine{09948\ \ \ \ \ vector\_string::iterator\ ti;}
\DoxyCodeLine{09949\ \ \ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ tokens.begin();\ ti\ !=\ tokens.end();\ ++ti)\ \{}
\DoxyCodeLine{09950\ \ \ \ \ \ \ \_extensions.insert(*ti);}
\DoxyCodeLine{09951\ \ \ \ \ \}}
\DoxyCodeLine{09952\ \ \ \}}
\DoxyCodeLine{09953\ \}}
\DoxyCodeLine{09954\ }
\DoxyCodeLine{09960\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09961\ get\_extra\_extensions()\ \{}
\DoxyCodeLine{09962\ \}}
\DoxyCodeLine{09963\ }
\DoxyCodeLine{09967\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{09968\ report\_extensions()\ const\ \{}
\DoxyCodeLine{09969\ \ \ if\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{09970\ \ \ \ \ std::ostream\ \&out\ =\ GLCAT.debug();}
\DoxyCodeLine{09971\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}GL\ Extensions:\(\backslash\)n"{}};}
\DoxyCodeLine{09972\ }
\DoxyCodeLine{09973\ \ \ \ \ \mbox{\hyperlink{classpset}{pset<string>::const\_iterator}}\ ei;}
\DoxyCodeLine{09974\ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_extensions.begin();\ ei\ !=\ \_extensions.end();\ ++ei)\ \{}
\DoxyCodeLine{09975\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ len\ =\ (*ei).size();}
\DoxyCodeLine{09976\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ (*ei);}
\DoxyCodeLine{09977\ }
\DoxyCodeLine{09978\ \ \ \ \ \ \ \textcolor{comment}{//\ Display\ a\ second\ column.}}
\DoxyCodeLine{09979\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (len\ <=\ 38)\ \{}
\DoxyCodeLine{09980\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (++ei\ !=\ \_extensions.end())\ \{}
\DoxyCodeLine{09981\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ len;\ i\ <\ 38;\ ++i)\ \{}
\DoxyCodeLine{09982\ \ \ \ \ \ \ \ \ \ \ \ \ out.put(\textcolor{charliteral}{'\ '});}
\DoxyCodeLine{09983\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09984\ \ \ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{charliteral}{'\ '}\ <<\ (*ei);}
\DoxyCodeLine{09985\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{09986\ \ \ \ \ \ \ \ \ \ \ out.put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{09987\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{09988\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{09989\ \ \ \ \ \ \ \}}
\DoxyCodeLine{09990\ \ \ \ \ \ \ out.put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{09991\ \ \ \ \ \}}
\DoxyCodeLine{09992\ \ \ \}}
\DoxyCodeLine{09993\ \}}
\DoxyCodeLine{09994\ }
\DoxyCodeLine{09999\ \textcolor{keywordtype}{void}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10000\ get\_extension\_func(const\ char\ *name)\ \{}
\DoxyCodeLine{10001\ \ \ \textcolor{comment}{//\ First,\ look\ in\ the\ static-\/compiled\ namespace.\ \ If\ we\ were\ compiled\ to}}
\DoxyCodeLine{10002\ \ \ \textcolor{comment}{//\ expect\ at\ least\ a\ certain\ minimum\ runtime\ version\ of\ OpenGL,\ then\ we\ can}}
\DoxyCodeLine{10003\ \ \ \textcolor{comment}{//\ expect\ those\ extension\ functions\ to\ be\ available\ at\ compile\ time.}}
\DoxyCodeLine{10004\ \ \ \textcolor{comment}{//\ Somewhat\ more\ reliable\ than\ poking\ around\ in\ the\ runtime\ pointers.}}
\DoxyCodeLine{10005\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{10006\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name;}
\DoxyCodeLine{10007\ \ \ \ \ \textcolor{keywordtype}{void}\ *fptr;}
\DoxyCodeLine{10008\ \ \ \}\ compiled\_function\_table[]\ =\ \{}
\DoxyCodeLine{10009\ \textcolor{preprocessor}{\#ifdef\ EXPECT\_GL\_VERSION\_1\_2}}
\DoxyCodeLine{10010\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBlendColor"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBlendColor\ \},}
\DoxyCodeLine{10011\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBlendEquation"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBlendEquation\ \},}
\DoxyCodeLine{10012\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glDrawRangeElements"{}},\ (\textcolor{keywordtype}{void}\ *)\&glDrawRangeElements\ \},}
\DoxyCodeLine{10013\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glTexImage3D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glTexImage3D\ \},}
\DoxyCodeLine{10014\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glTexSubImage3D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glTexSubImage3D\ \},}
\DoxyCodeLine{10015\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCopyTexSubImage3D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCopyTexSubImage3D\ \},}
\DoxyCodeLine{10016\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10017\ \textcolor{preprocessor}{\#ifdef\ EXPECT\_GL\_VERSION\_1\_3}}
\DoxyCodeLine{10018\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glActiveTexture"{}},\ (\textcolor{keywordtype}{void}\ *)\&glActiveTexture\ \},}
\DoxyCodeLine{10019\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glClientActiveTexture"{}},\ (\textcolor{keywordtype}{void}\ *)\&glClientActiveTexture\ \},}
\DoxyCodeLine{10020\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexImage1D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexImage1D\ \},}
\DoxyCodeLine{10021\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexImage2D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexImage2D\ \},}
\DoxyCodeLine{10022\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexImage3D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexImage3D\ \},}
\DoxyCodeLine{10023\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexSubImage1D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexSubImage1D\ \},}
\DoxyCodeLine{10024\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexSubImage2D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexSubImage2D\ \},}
\DoxyCodeLine{10025\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glCompressedTexSubImage3D"{}},\ (\textcolor{keywordtype}{void}\ *)\&glCompressedTexSubImage3D\ \},}
\DoxyCodeLine{10026\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGetCompressedTexImage"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGetCompressedTexImage\ \},}
\DoxyCodeLine{10027\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glMultiTexCoord1f"{}},\ (\textcolor{keywordtype}{void}\ *)\&glMultiTexCoord1f\ \},}
\DoxyCodeLine{10028\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glMultiTexCoord2"{}},\ (\textcolor{keywordtype}{void}\ *)\&glMultiTexCoord2\ \},}
\DoxyCodeLine{10029\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glMultiTexCoord3"{}},\ (\textcolor{keywordtype}{void}\ *)\&glMultiTexCoord3\ \},}
\DoxyCodeLine{10030\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glMultiTexCoord4"{}},\ (\textcolor{keywordtype}{void}\ *)\&glMultiTexCoord4\ \},}
\DoxyCodeLine{10031\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10032\ \textcolor{preprocessor}{\#ifdef\ EXPECT\_GL\_VERSION\_1\_4}}
\DoxyCodeLine{10033\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glPointParameterfv"{}},\ (\textcolor{keywordtype}{void}\ *)\&glPointParameterfv\ \},}
\DoxyCodeLine{10034\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glSecondaryColorPointer"{}},\ (\textcolor{keywordtype}{void}\ *)\&glSecondaryColorPointer\ \},}
\DoxyCodeLine{10035\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10036\ \textcolor{preprocessor}{\#ifdef\ EXPECT\_GL\_VERSION\_1\_5}}
\DoxyCodeLine{10037\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBeginQuery"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBeginQuery\ \},}
\DoxyCodeLine{10038\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBindBuffer"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBindBuffer\ \},}
\DoxyCodeLine{10039\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBufferData"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBufferData\ \},}
\DoxyCodeLine{10040\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBufferSubData"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBufferSubData\ \},}
\DoxyCodeLine{10041\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glDeleteBuffers"{}},\ (\textcolor{keywordtype}{void}\ *)\&glDeleteBuffers\ \},}
\DoxyCodeLine{10042\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glDeleteQueries"{}},\ (\textcolor{keywordtype}{void}\ *)\&glDeleteQueries\ \},}
\DoxyCodeLine{10043\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glEndQuery"{}},\ (\textcolor{keywordtype}{void}\ *)\&glEndQuery\ \},}
\DoxyCodeLine{10044\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGenBuffers"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGenBuffers\ \},}
\DoxyCodeLine{10045\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGenQueries"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGenQueries\ \},}
\DoxyCodeLine{10046\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGetQueryObjectuiv"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGetQueryObjectuiv\ \},}
\DoxyCodeLine{10047\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGetQueryiv"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGetQueryiv\ \},}
\DoxyCodeLine{10048\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10049\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10050\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glActiveTexture"{}},\ (\textcolor{keywordtype}{void}\ *)\&glActiveTexture\ \},}
\DoxyCodeLine{10051\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{10052\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glClientActiveTexture"{}},\ (\textcolor{keywordtype}{void}\ *)\&glClientActiveTexture\ \},}
\DoxyCodeLine{10053\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10054\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBindBuffer"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBindBuffer\ \},}
\DoxyCodeLine{10055\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBufferData"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBufferData\ \},}
\DoxyCodeLine{10056\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glBufferSubData"{}},\ (\textcolor{keywordtype}{void}\ *)\&glBufferSubData\ \},}
\DoxyCodeLine{10057\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glDeleteBuffers"{}},\ (\textcolor{keywordtype}{void}\ *)\&glDeleteBuffers\ \},}
\DoxyCodeLine{10058\ \ \ \ \ \{\ \textcolor{stringliteral}{"{}glGenBuffers"{}},\ (\textcolor{keywordtype}{void}\ *)\&glGenBuffers\ \},}
\DoxyCodeLine{10059\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10060\ \ \ \ \ \{\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr}\ \}}
\DoxyCodeLine{10061\ \ \ \};}
\DoxyCodeLine{10062\ }
\DoxyCodeLine{10063\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{10064\ \ \ \textcolor{keywordflow}{while}\ (compiled\_function\_table[i].name\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{10065\ \ \ \ \ \textcolor{keywordflow}{if}\ (strcmp(compiled\_function\_table[i].name,\ name)\ ==\ 0)\ \{}
\DoxyCodeLine{10066\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ compiled\_function\_table[i].fptr;}
\DoxyCodeLine{10067\ \ \ \ \ \}}
\DoxyCodeLine{10068\ \ \ \ \ ++i;}
\DoxyCodeLine{10069\ \ \ \}}
\DoxyCodeLine{10070\ }
\DoxyCodeLine{10071\ \ \ \textcolor{comment}{//\ If\ the\ extension\ function\ wasn't\ compiled\ in,\ then\ go\ get\ it\ from\ the}}
\DoxyCodeLine{10072\ \ \ \textcolor{comment}{//\ runtime.\ \ There's\ a\ different\ interface\ for\ each\ API.}}
\DoxyCodeLine{10073\ \ \ \textcolor{keywordflow}{return}\ do\_get\_extension\_func(name);}
\DoxyCodeLine{10074\ \}}
\DoxyCodeLine{10075\ }
\DoxyCodeLine{10082\ \textcolor{keywordtype}{void}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10083\ do\_get\_extension\_func(const\ char\ *)\ \{}
\DoxyCodeLine{10084\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{10085\ \}}
\DoxyCodeLine{10086\ }
\DoxyCodeLine{10092\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10093\ set\_draw\_buffer(int\ rbtype)\ \{}
\DoxyCodeLine{10094\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1\ \ }\textcolor{comment}{//\ Draw\ buffers\ not\ supported\ by\ OpenGL\ ES\ 1.}}
\DoxyCodeLine{10095\ \ \ \textcolor{keywordflow}{if}\ (\_current\_fbo)\ \{}
\DoxyCodeLine{10096\ \ \ \ \ GLuint\ buffers[16];}
\DoxyCodeLine{10097\ \ \ \ \ \textcolor{keywordtype}{int}\ nbuffers\ =\ 0;}
\DoxyCodeLine{10098\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ 0;}
\DoxyCodeLine{10099\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>get\_color\_bits()\ >\ 0)\ \{}
\DoxyCodeLine{10100\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ RenderBuffer::T\_left)\ \{}
\DoxyCodeLine{10101\ \ \ \ \ \ \ \ \ buffers[nbuffers++]\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10102\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10103\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10104\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>is\_stereo())\ \{}
\DoxyCodeLine{10105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ RenderBuffer::T\_right)\ \{}
\DoxyCodeLine{10106\ \ \ \ \ \ \ \ \ \ \ buffers[nbuffers++]\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10108\ \ \ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10109\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10110\ \ \ \ \ \}}
\DoxyCodeLine{10111\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_rgba();\ ++i)\ \{}
\DoxyCodeLine{10112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_rgba\_0\ <<\ i))\ \{}
\DoxyCodeLine{10113\ \ \ \ \ \ \ \ \ buffers[nbuffers++]\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10114\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10115\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10116\ \ \ \ \ \}}
\DoxyCodeLine{10117\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_hrgba();\ ++i)\ \{}
\DoxyCodeLine{10118\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_hrgba\_0\ <<\ i))\ \{}
\DoxyCodeLine{10119\ \ \ \ \ \ \ \ \ buffers[nbuffers++]\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10120\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10121\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10122\ \ \ \ \ \}}
\DoxyCodeLine{10123\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_float();\ ++i)\ \{}
\DoxyCodeLine{10124\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_float\_0\ <<\ i))\ \{}
\DoxyCodeLine{10125\ \ \ \ \ \ \ \ \ buffers[nbuffers++]\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10126\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10127\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10128\ \ \ \ \ \}}
\DoxyCodeLine{10129\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_glDrawBuffers\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{10130\ \ \ \ \ \ \ \_glDrawBuffers(nbuffers,\ buffers);}
\DoxyCodeLine{10131\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10132\ \ \ \ \ \ \ nassertv(nbuffers\ ==\ 1\ \&\&\ buffers[0]\ ==\ GL\_COLOR\_ATTACHMENT0\_EXT);}
\DoxyCodeLine{10133\ \ \ \ \ \}}
\DoxyCodeLine{10134\ }
\DoxyCodeLine{10135\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10136\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10137\ \ \ \ \ \textcolor{keywordflow}{switch}\ (rbtype\ \&\ RenderBuffer::T\_color)\ \{}
\DoxyCodeLine{10138\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front:}
\DoxyCodeLine{10139\ \ \ \ \ \ \ glDrawBuffer(GL\_FRONT);}
\DoxyCodeLine{10140\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10141\ }
\DoxyCodeLine{10142\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back:}
\DoxyCodeLine{10143\ \ \ \ \ \ \ glDrawBuffer(GL\_BACK);}
\DoxyCodeLine{10144\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10145\ }
\DoxyCodeLine{10146\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_right:}
\DoxyCodeLine{10147\ \ \ \ \ \ \ glDrawBuffer(GL\_RIGHT);}
\DoxyCodeLine{10148\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10149\ }
\DoxyCodeLine{10150\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_left:}
\DoxyCodeLine{10151\ \ \ \ \ \ \ glDrawBuffer(GL\_LEFT);}
\DoxyCodeLine{10152\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10153\ }
\DoxyCodeLine{10154\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front\_right:}
\DoxyCodeLine{10155\ \ \ \ \ \ \ nassertv(\_current\_properties-\/>is\_stereo());}
\DoxyCodeLine{10156\ \ \ \ \ \ \ glDrawBuffer(GL\_FRONT\_RIGHT);}
\DoxyCodeLine{10157\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10158\ }
\DoxyCodeLine{10159\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front\_left:}
\DoxyCodeLine{10160\ \ \ \ \ \ \ nassertv(\_current\_properties-\/>is\_stereo());}
\DoxyCodeLine{10161\ \ \ \ \ \ \ glDrawBuffer(GL\_FRONT\_LEFT);}
\DoxyCodeLine{10162\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10163\ }
\DoxyCodeLine{10164\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back\_right:}
\DoxyCodeLine{10165\ \ \ \ \ \ \ nassertv(\_current\_properties-\/>is\_stereo());}
\DoxyCodeLine{10166\ \ \ \ \ \ \ glDrawBuffer(GL\_BACK\_RIGHT);}
\DoxyCodeLine{10167\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10168\ }
\DoxyCodeLine{10169\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back\_left:}
\DoxyCodeLine{10170\ \ \ \ \ \ \ nassertv(\_current\_properties-\/>is\_stereo());}
\DoxyCodeLine{10171\ \ \ \ \ \ \ glDrawBuffer(GL\_BACK\_LEFT);}
\DoxyCodeLine{10172\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10173\ }
\DoxyCodeLine{10174\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10175\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10176\ \ \ \ \ \}}
\DoxyCodeLine{10177\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{10178\ \ \ \}}
\DoxyCodeLine{10179\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{10180\ }
\DoxyCodeLine{10181\ \ \ \textcolor{comment}{//\ Also\ ensure\ that\ any\ global\ color\ channels\ are\ masked\ out.}}
\DoxyCodeLine{10182\ \ \ set\_color\_write\_mask(\_color\_write\_mask);}
\DoxyCodeLine{10183\ }
\DoxyCodeLine{10184\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{10185\ \}}
\DoxyCodeLine{10186\ }
\DoxyCodeLine{10192\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10193\ set\_read\_buffer(int\ rbtype)\ \{}
\DoxyCodeLine{10194\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1\ \ }\textcolor{comment}{//\ Draw\ buffers\ not\ supported\ by\ OpenGL\ ES\ 1.}}
\DoxyCodeLine{10195\ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_depth\ |\ RenderBuffer::T\_stencil))\ \{}
\DoxyCodeLine{10196\ \ \ \ \ \textcolor{comment}{//\ Special\ case:\ don't\ have\ to\ call\ ReadBuffer\ for\ these.}}
\DoxyCodeLine{10197\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{10198\ \ \ \}}
\DoxyCodeLine{10199\ }
\DoxyCodeLine{10200\ \ \ \textcolor{keywordflow}{if}\ (\_current\_fbo)\ \{}
\DoxyCodeLine{10201\ \ \ \ \ GLuint\ buffer\ =\ GL\_COLOR\_ATTACHMENT0\_EXT;}
\DoxyCodeLine{10202\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ 1;}
\DoxyCodeLine{10203\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_properties-\/>is\_stereo())\ \{}
\DoxyCodeLine{10204\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ RenderBuffer::T\_right)\ \{}
\DoxyCodeLine{10205\ \ \ \ \ \ \ \ \ buffer\ =\ GL\_COLOR\_ATTACHMENT1\_EXT;}
\DoxyCodeLine{10206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10207\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10208\ \ \ \ \ \}}
\DoxyCodeLine{10209\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_rgba();\ ++i)\ \{}
\DoxyCodeLine{10210\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_rgba\_0\ <<\ i))\ \{}
\DoxyCodeLine{10211\ \ \ \ \ \ \ \ \ buffer\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10212\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10213\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10214\ \ \ \ \ \}}
\DoxyCodeLine{10215\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_hrgba();\ ++i)\ \{}
\DoxyCodeLine{10216\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_hrgba\_0\ <<\ i))\ \{}
\DoxyCodeLine{10217\ \ \ \ \ \ \ \ \ buffer\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10218\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10219\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10220\ \ \ \ \ \}}
\DoxyCodeLine{10221\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_current\_properties-\/>get\_aux\_float();\ ++i)\ \{}
\DoxyCodeLine{10222\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rbtype\ \&\ (RenderBuffer::T\_aux\_float\_0\ <<\ i))\ \{}
\DoxyCodeLine{10223\ \ \ \ \ \ \ \ \ buffer\ =\ GL\_COLOR\_ATTACHMENT0\_EXT\ +\ index;}
\DoxyCodeLine{10224\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10225\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{10226\ \ \ \ \ \}}
\DoxyCodeLine{10227\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10228\ \ \ \ \ \_glReadBuffer(buffer);}
\DoxyCodeLine{10229\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10230\ \ \ \ \ glReadBuffer(buffer);}
\DoxyCodeLine{10231\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10232\ }
\DoxyCodeLine{10233\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10234\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10235\ \ \ \ \ \textcolor{keywordflow}{switch}\ (rbtype\ \&\ RenderBuffer::T\_color)\ \{}
\DoxyCodeLine{10236\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front:}
\DoxyCodeLine{10237\ \ \ \ \ \ \ glReadBuffer(GL\_FRONT);}
\DoxyCodeLine{10238\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10239\ }
\DoxyCodeLine{10240\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back:}
\DoxyCodeLine{10241\ \ \ \ \ \ \ glReadBuffer(GL\_BACK);}
\DoxyCodeLine{10242\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10243\ }
\DoxyCodeLine{10244\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_right:}
\DoxyCodeLine{10245\ \ \ \ \ \ \ glReadBuffer(GL\_RIGHT);}
\DoxyCodeLine{10246\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10247\ }
\DoxyCodeLine{10248\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_left:}
\DoxyCodeLine{10249\ \ \ \ \ \ \ glReadBuffer(GL\_LEFT);}
\DoxyCodeLine{10250\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10251\ }
\DoxyCodeLine{10252\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front\_right:}
\DoxyCodeLine{10253\ \ \ \ \ \ \ glReadBuffer(GL\_FRONT\_RIGHT);}
\DoxyCodeLine{10254\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10255\ }
\DoxyCodeLine{10256\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_front\_left:}
\DoxyCodeLine{10257\ \ \ \ \ \ \ glReadBuffer(GL\_FRONT\_LEFT);}
\DoxyCodeLine{10258\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10259\ }
\DoxyCodeLine{10260\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back\_right:}
\DoxyCodeLine{10261\ \ \ \ \ \ \ glReadBuffer(GL\_BACK\_RIGHT);}
\DoxyCodeLine{10262\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10263\ }
\DoxyCodeLine{10264\ \ \ \ \ \textcolor{keywordflow}{case}\ RenderBuffer::T\_back\_left:}
\DoxyCodeLine{10265\ \ \ \ \ \ \ glReadBuffer(GL\_BACK\_LEFT);}
\DoxyCodeLine{10266\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10267\ }
\DoxyCodeLine{10268\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10269\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10270\ \ \ \ \ \}}
\DoxyCodeLine{10271\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{10272\ \ \ \}}
\DoxyCodeLine{10273\ }
\DoxyCodeLine{10274\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{10275\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{10276\ \}}
\DoxyCodeLine{10277\ }
\DoxyCodeLine{10281\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10282\ get\_numeric\_type(\mbox{\hyperlink{classGeom}{Geom}}::NumericType\ numeric\_type)\ \{}
\DoxyCodeLine{10283\ \ \ \textcolor{keywordflow}{switch}\ (numeric\_type)\ \{}
\DoxyCodeLine{10284\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_uint16:}
\DoxyCodeLine{10285\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_SHORT;}
\DoxyCodeLine{10286\ }
\DoxyCodeLine{10287\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_uint32:}
\DoxyCodeLine{10288\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10289\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_INT;}
\DoxyCodeLine{10290\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10291\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10292\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10293\ }
\DoxyCodeLine{10294\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_uint8:}
\DoxyCodeLine{10295\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_packed\_dcba:}
\DoxyCodeLine{10296\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_packed\_dabc:}
\DoxyCodeLine{10297\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{10298\ }
\DoxyCodeLine{10299\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_float32:}
\DoxyCodeLine{10300\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_FLOAT;}
\DoxyCodeLine{10301\ }
\DoxyCodeLine{10302\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_float64:}
\DoxyCodeLine{10303\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10304\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DOUBLE;}
\DoxyCodeLine{10305\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10306\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10307\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10308\ }
\DoxyCodeLine{10309\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_stdfloat:}
\DoxyCodeLine{10310\ \ \ \ \ \textcolor{comment}{//\ Shouldn't\ happen,\ display\ error.}}
\DoxyCodeLine{10311\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10312\ }
\DoxyCodeLine{10313\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_int8:}
\DoxyCodeLine{10314\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_BYTE;}
\DoxyCodeLine{10315\ }
\DoxyCodeLine{10316\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_int16:}
\DoxyCodeLine{10317\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SHORT;}
\DoxyCodeLine{10318\ }
\DoxyCodeLine{10319\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_int32:}
\DoxyCodeLine{10320\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10321\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_INT;}
\DoxyCodeLine{10322\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10323\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10324\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10325\ }
\DoxyCodeLine{10326\ \ \ \textcolor{keywordflow}{case}\ Geom::NT\_packed\_ufloat:}
\DoxyCodeLine{10327\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10328\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_INT\_10F\_11F\_11F\_REV;}
\DoxyCodeLine{10329\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10330\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10331\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10332\ \ \ \}}
\DoxyCodeLine{10333\ }
\DoxyCodeLine{10334\ \ \ GLCAT.error()}
\DoxyCodeLine{10335\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ NumericType\ value\ ("{}}\ <<\ (int)numeric\_type\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{10336\ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{10337\ \}}
\DoxyCodeLine{10338\ }
\DoxyCodeLine{10342\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10343\ get\_texture\_target(\mbox{\hyperlink{classTexture}{Texture}}::TextureType\ texture\_type)\ const\ \{}
\DoxyCodeLine{10344\ \ \ switch\ (texture\_type)\ \{}
\DoxyCodeLine{10345\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_1d\_texture:}
\DoxyCodeLine{10346\ \ \ \ \ \textcolor{comment}{//\ There\ are\ no\ 1D\ textures\ in\ OpenGL\ ES.\ \ Fall\ back\ to\ 2D\ textures.}}
\DoxyCodeLine{10347\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10348\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_1D;}
\DoxyCodeLine{10349\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10350\ }
\DoxyCodeLine{10351\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_1d\_texture\_array:}
\DoxyCodeLine{10352\ \ \ \ \ \textcolor{comment}{//\ There\ are\ no\ 1D\ array\ textures\ in\ OpenGL\ ES.\ \ Fall\ back\ to\ 2D\ textures.}}
\DoxyCodeLine{10353\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10354\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_1D\_ARRAY;}
\DoxyCodeLine{10355\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10356\ }
\DoxyCodeLine{10357\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture:}
\DoxyCodeLine{10358\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_2D;}
\DoxyCodeLine{10359\ }
\DoxyCodeLine{10360\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_3d\_texture:}
\DoxyCodeLine{10361\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10362\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{10363\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_3D;}
\DoxyCodeLine{10364\ \ \ \ \ \}}
\DoxyCodeLine{10365\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10366\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NONE;}
\DoxyCodeLine{10367\ }
\DoxyCodeLine{10368\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture\_array:}
\DoxyCodeLine{10369\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10370\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{10371\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_2D\_ARRAY;}
\DoxyCodeLine{10372\ \ \ \ \ \}}
\DoxyCodeLine{10373\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10374\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NONE;}
\DoxyCodeLine{10375\ }
\DoxyCodeLine{10376\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map:}
\DoxyCodeLine{10377\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{10378\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_CUBE\_MAP;}
\DoxyCodeLine{10379\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10380\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NONE;}
\DoxyCodeLine{10381\ \ \ \ \ \}}
\DoxyCodeLine{10382\ }
\DoxyCodeLine{10383\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map\_array:}
\DoxyCodeLine{10384\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10385\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map\_array)\ \{}
\DoxyCodeLine{10386\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_CUBE\_MAP\_ARRAY;}
\DoxyCodeLine{10387\ \ \ \ \ \}}
\DoxyCodeLine{10388\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10389\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NONE;}
\DoxyCodeLine{10390\ }
\DoxyCodeLine{10391\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_buffer\_texture:}
\DoxyCodeLine{10392\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10393\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_texture)\ \{}
\DoxyCodeLine{10394\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_BUFFER;}
\DoxyCodeLine{10395\ \ \ \ \ \}}
\DoxyCodeLine{10396\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10397\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NONE;}
\DoxyCodeLine{10398\ \ \ \}}
\DoxyCodeLine{10399\ }
\DoxyCodeLine{10400\ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::TextureType\ value!\(\backslash\)n"{}};}
\DoxyCodeLine{10401\ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE\_2D;}
\DoxyCodeLine{10402\ \}}
\DoxyCodeLine{10403\ }
\DoxyCodeLine{10407\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10408\ get\_texture\_wrap\_mode(\mbox{\hyperlink{classSamplerState}{SamplerState}}::WrapMode\ wm)\ const\ \{}
\DoxyCodeLine{10409\ \ \ if\ (gl\_ignore\_clamp)\ \{}
\DoxyCodeLine{10410\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_REPEAT;}
\DoxyCodeLine{10411\ \ \ \}}
\DoxyCodeLine{10412\ \ \ \textcolor{keywordflow}{switch}\ (wm)\ \{}
\DoxyCodeLine{10413\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_clamp:}
\DoxyCodeLine{10414\ \ \ \ \ \textcolor{keywordflow}{return}\ \_edge\_clamp;}
\DoxyCodeLine{10415\ }
\DoxyCodeLine{10416\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_repeat:}
\DoxyCodeLine{10417\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_REPEAT;}
\DoxyCodeLine{10418\ }
\DoxyCodeLine{10419\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_mirror:}
\DoxyCodeLine{10420\ \ \ \ \ \textcolor{keywordflow}{return}\ \_mirror\_repeat;}
\DoxyCodeLine{10421\ }
\DoxyCodeLine{10422\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_mirror\_once:}
\DoxyCodeLine{10423\ \ \ \ \ \textcolor{keywordflow}{return}\ \_mirror\_border\_clamp;}
\DoxyCodeLine{10424\ }
\DoxyCodeLine{10425\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_border\_color:}
\DoxyCodeLine{10426\ \ \ \ \ \textcolor{keywordflow}{return}\ \_border\_clamp;}
\DoxyCodeLine{10427\ }
\DoxyCodeLine{10428\ \ \ \textcolor{keywordflow}{case}\ SamplerState::WM\_invalid:}
\DoxyCodeLine{10429\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10430\ \ \ \}}
\DoxyCodeLine{10431\ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Invalid\ SamplerState::WrapMode\ value!\(\backslash\)n"{}};}
\DoxyCodeLine{10432\ \ \ \textcolor{keywordflow}{return}\ \_edge\_clamp;}
\DoxyCodeLine{10433\ \}}
\DoxyCodeLine{10434\ }
\DoxyCodeLine{10438\ SamplerState::WrapMode\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10439\ get\_panda\_wrap\_mode(GLenum\ wm)\ \{}
\DoxyCodeLine{10440\ \ \ \textcolor{keywordflow}{switch}\ (wm)\ \{}
\DoxyCodeLine{10441\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10442\ \ \ \textcolor{keywordflow}{case}\ GL\_CLAMP:}
\DoxyCodeLine{10443\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10444\ \ \ \textcolor{keywordflow}{case}\ GL\_CLAMP\_TO\_EDGE:}
\DoxyCodeLine{10445\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_clamp;}
\DoxyCodeLine{10446\ }
\DoxyCodeLine{10447\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10448\ \ \ \textcolor{keywordflow}{case}\ GL\_CLAMP\_TO\_BORDER:}
\DoxyCodeLine{10449\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_border\_color;}
\DoxyCodeLine{10450\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10451\ }
\DoxyCodeLine{10452\ \ \ \textcolor{keywordflow}{case}\ GL\_REPEAT:}
\DoxyCodeLine{10453\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_repeat;}
\DoxyCodeLine{10454\ }
\DoxyCodeLine{10455\ \ \ \textcolor{keywordflow}{case}\ GL\_MIRRORED\_REPEAT:}
\DoxyCodeLine{10456\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_mirror;}
\DoxyCodeLine{10457\ }
\DoxyCodeLine{10458\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10459\ \ \ \textcolor{keywordflow}{case}\ GL\_MIRROR\_CLAMP\_EXT:}
\DoxyCodeLine{10460\ \ \ \textcolor{keywordflow}{case}\ GL\_MIRROR\_CLAMP\_TO\_EDGE\_EXT:}
\DoxyCodeLine{10461\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_mirror;}
\DoxyCodeLine{10462\ }
\DoxyCodeLine{10463\ \ \ \textcolor{keywordflow}{case}\ GL\_MIRROR\_CLAMP\_TO\_BORDER\_EXT:}
\DoxyCodeLine{10464\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_mirror\_once;}
\DoxyCodeLine{10465\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10466\ \ \ \}}
\DoxyCodeLine{10467\ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Unexpected\ GL\ wrap\ mode\ "{}}\ <<\ (int)wm\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10468\ \ \ \textcolor{keywordflow}{return}\ SamplerState::WM\_clamp;}
\DoxyCodeLine{10469\ \}}
\DoxyCodeLine{10470\ }
\DoxyCodeLine{10474\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10475\ get\_texture\_filter\_type(\mbox{\hyperlink{classSamplerState}{SamplerState}}::FilterType\ ft,\ bool\ ignore\_mipmaps)\ \{}
\DoxyCodeLine{10476\ \ \ \textcolor{keywordflow}{if}\ (gl\_ignore\_filters)\ \{}
\DoxyCodeLine{10477\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST;}
\DoxyCodeLine{10478\ }
\DoxyCodeLine{10479\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ignore\_mipmaps)\ \{}
\DoxyCodeLine{10480\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ft)\ \{}
\DoxyCodeLine{10481\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest\_mipmap\_nearest:}
\DoxyCodeLine{10482\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest:}
\DoxyCodeLine{10483\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST;}
\DoxyCodeLine{10484\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear:}
\DoxyCodeLine{10485\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear\_mipmap\_nearest:}
\DoxyCodeLine{10486\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest\_mipmap\_linear:}
\DoxyCodeLine{10487\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear\_mipmap\_linear:}
\DoxyCodeLine{10488\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR;}
\DoxyCodeLine{10489\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_shadow:}
\DoxyCodeLine{10490\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR;}
\DoxyCodeLine{10491\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_default:}
\DoxyCodeLine{10492\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_invalid:}
\DoxyCodeLine{10493\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10494\ \ \ \ \ \}}
\DoxyCodeLine{10495\ }
\DoxyCodeLine{10496\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10497\ \ \ \ \ \textcolor{keywordflow}{switch}\ (ft)\ \{}
\DoxyCodeLine{10498\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest:}
\DoxyCodeLine{10499\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST;}
\DoxyCodeLine{10500\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear:}
\DoxyCodeLine{10501\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR;}
\DoxyCodeLine{10502\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest\_mipmap\_nearest:}
\DoxyCodeLine{10503\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST\_MIPMAP\_NEAREST;}
\DoxyCodeLine{10504\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear\_mipmap\_nearest:}
\DoxyCodeLine{10505\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR\_MIPMAP\_NEAREST;}
\DoxyCodeLine{10506\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_nearest\_mipmap\_linear:}
\DoxyCodeLine{10507\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST\_MIPMAP\_LINEAR;}
\DoxyCodeLine{10508\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_linear\_mipmap\_linear:}
\DoxyCodeLine{10509\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR\_MIPMAP\_LINEAR;}
\DoxyCodeLine{10510\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_shadow:}
\DoxyCodeLine{10511\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LINEAR;}
\DoxyCodeLine{10512\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_default:}
\DoxyCodeLine{10513\ \ \ \ \ \textcolor{keywordflow}{case}\ SamplerState::FT\_invalid:}
\DoxyCodeLine{10514\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10515\ \ \ \ \ \}}
\DoxyCodeLine{10516\ \ \ \}}
\DoxyCodeLine{10517\ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Invalid\ SamplerState::FilterType\ value!\(\backslash\)n"{}};}
\DoxyCodeLine{10518\ \ \ \textcolor{keywordflow}{return}\ GL\_NEAREST;}
\DoxyCodeLine{10519\ \}}
\DoxyCodeLine{10520\ }
\DoxyCodeLine{10524\ SamplerState::FilterType\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10525\ get\_panda\_filter\_type(GLenum\ ft)\ \{}
\DoxyCodeLine{10526\ \ \ \textcolor{keywordflow}{switch}\ (ft)\ \{}
\DoxyCodeLine{10527\ \ \ \textcolor{keywordflow}{case}\ GL\_NEAREST:}
\DoxyCodeLine{10528\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_nearest;}
\DoxyCodeLine{10529\ \ \ \textcolor{keywordflow}{case}\ GL\_LINEAR:}
\DoxyCodeLine{10530\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_linear;}
\DoxyCodeLine{10531\ \ \ \textcolor{keywordflow}{case}\ GL\_NEAREST\_MIPMAP\_NEAREST:}
\DoxyCodeLine{10532\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_nearest\_mipmap\_nearest;}
\DoxyCodeLine{10533\ \ \ \textcolor{keywordflow}{case}\ GL\_LINEAR\_MIPMAP\_NEAREST:}
\DoxyCodeLine{10534\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_linear\_mipmap\_nearest;}
\DoxyCodeLine{10535\ \ \ \textcolor{keywordflow}{case}\ GL\_NEAREST\_MIPMAP\_LINEAR:}
\DoxyCodeLine{10536\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_nearest\_mipmap\_linear;}
\DoxyCodeLine{10537\ \ \ \textcolor{keywordflow}{case}\ GL\_LINEAR\_MIPMAP\_LINEAR:}
\DoxyCodeLine{10538\ \ \ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_linear\_mipmap\_linear;}
\DoxyCodeLine{10539\ \ \ \}}
\DoxyCodeLine{10540\ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Unexpected\ GL\ filter\ type\ "{}}\ <<\ (int)ft\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10541\ \ \ \textcolor{keywordflow}{return}\ SamplerState::FT\_linear;}
\DoxyCodeLine{10542\ \}}
\DoxyCodeLine{10543\ }
\DoxyCodeLine{10547\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10548\ get\_component\_type(\mbox{\hyperlink{classTexture}{Texture}}::ComponentType\ component\_type)\ \{}
\DoxyCodeLine{10549\ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{10550\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_byte:}
\DoxyCodeLine{10551\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{10552\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:}
\DoxyCodeLine{10553\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_SHORT;}
\DoxyCodeLine{10554\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:}
\DoxyCodeLine{10555\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_FLOAT;}
\DoxyCodeLine{10556\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_int\_24\_8:}
\DoxyCodeLine{10557\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_depth\_stencil)\ \{}
\DoxyCodeLine{10558\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_INT\_24\_8\_EXT;}
\DoxyCodeLine{10559\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10560\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{10561\ \ \ \ \ \}}
\DoxyCodeLine{10562\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_int:}
\DoxyCodeLine{10563\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10564\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_INT;}
\DoxyCodeLine{10565\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10566\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_byte:}
\DoxyCodeLine{10567\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_BYTE;}
\DoxyCodeLine{10568\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:}
\DoxyCodeLine{10569\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SHORT;}
\DoxyCodeLine{10570\ }
\DoxyCodeLine{10571\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10572\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:}
\DoxyCodeLine{10573\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_HALF\_FLOAT;}
\DoxyCodeLine{10574\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10575\ }
\DoxyCodeLine{10576\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10577\ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_int:}
\DoxyCodeLine{10578\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_INT;}
\DoxyCodeLine{10579\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10580\ }
\DoxyCodeLine{10581\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10582\ \ \ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::Type\ value!\(\backslash\)n"{}};}
\DoxyCodeLine{10583\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{10584\ \ \ \}}
\DoxyCodeLine{10585\ \}}
\DoxyCodeLine{10586\ }
\DoxyCodeLine{10590\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10591\ get\_external\_image\_format(\mbox{\hyperlink{classTexture}{Texture}}\ *tex)\ const\ \{}
\DoxyCodeLine{10592\ \ \ \mbox{\hyperlink{classTexture}{Texture}}::CompressionMode\ compression\ =\ tex-\/>get\_ram\_image\_compression();}
\DoxyCodeLine{10593\ \ \ Texture::Format\ format\ =\ tex-\/>get\_format();}
\DoxyCodeLine{10594\ \ \ \textcolor{keywordflow}{if}\ (compression\ !=\ Texture::CM\_off\ \&\&}
\DoxyCodeLine{10595\ \ \ \ \ \ \ get\_supports\_compressed\_texture\_format(compression))\ \{}
\DoxyCodeLine{10596\ \ \ \ \ \textcolor{keywordflow}{switch}\ (compression)\ \{}
\DoxyCodeLine{10597\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_on:}
\DoxyCodeLine{10598\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10599\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{10600\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_color\_index:}
\DoxyCodeLine{10601\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{10602\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{10603\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{10604\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{10605\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{10606\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r11\_g11\_b10:}
\DoxyCodeLine{10607\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb9\_e5:}
\DoxyCodeLine{10608\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ shouldn't\ be\ possible.}}
\DoxyCodeLine{10609\ \ \ \ \ \ \ \ \ nassertr(\textcolor{keyword}{false},\ GL\_RGB);}
\DoxyCodeLine{10610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10611\ }
\DoxyCodeLine{10612\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{10613\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{10614\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{10615\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{10616\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{10617\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{10618\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{10619\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8i:}
\DoxyCodeLine{10620\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16i:}
\DoxyCodeLine{10621\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32i:}
\DoxyCodeLine{10622\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{10623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA;}
\DoxyCodeLine{10624\ }
\DoxyCodeLine{10625\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{10626\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{10627\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{10628\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{10629\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8i:}
\DoxyCodeLine{10630\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{10631\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{10632\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{10633\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16i:}
\DoxyCodeLine{10634\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{10635\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32i:}
\DoxyCodeLine{10636\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB;}
\DoxyCodeLine{10637\ }
\DoxyCodeLine{10638\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{10639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_ALPHA;}
\DoxyCodeLine{10640\ }
\DoxyCodeLine{10641\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{10642\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_green:}
\DoxyCodeLine{10643\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_blue:}
\DoxyCodeLine{10644\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r8i:}
\DoxyCodeLine{10645\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{10646\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16i:}
\DoxyCodeLine{10647\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32:}
\DoxyCodeLine{10648\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32i:}
\DoxyCodeLine{10649\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RED;}
\DoxyCodeLine{10650\ }
\DoxyCodeLine{10651\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{10652\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg8i:}
\DoxyCodeLine{10653\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{10654\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16i:}
\DoxyCodeLine{10655\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32:}
\DoxyCodeLine{10656\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32i:}
\DoxyCodeLine{10657\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG;}
\DoxyCodeLine{10658\ }
\DoxyCodeLine{10659\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{10660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE;}
\DoxyCodeLine{10661\ }
\DoxyCodeLine{10662\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{10663\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alphamask:}
\DoxyCodeLine{10664\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{10665\ }
\DoxyCodeLine{10666\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{10667\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB;}
\DoxyCodeLine{10668\ }
\DoxyCodeLine{10669\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{10670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA;}
\DoxyCodeLine{10671\ }
\DoxyCodeLine{10672\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{10673\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SLUMINANCE;}
\DoxyCodeLine{10674\ }
\DoxyCodeLine{10675\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{10676\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SLUMINANCE\_ALPHA;}
\DoxyCodeLine{10677\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10678\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10679\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10680\ }
\DoxyCodeLine{10681\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt1:}
\DoxyCodeLine{10682\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10683\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{10684\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{10685\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb)\ \{}
\DoxyCodeLine{10686\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{10687\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{10688\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10689\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{10690\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{10691\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10692\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{10693\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10694\ }
\DoxyCodeLine{10695\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt3:}
\DoxyCodeLine{10696\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10697\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\ ||\ format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{10698\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3\_EXT;}
\DoxyCodeLine{10699\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10700\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10701\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10702\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT;}
\DoxyCodeLine{10703\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10704\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10705\ }
\DoxyCodeLine{10706\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt5:}
\DoxyCodeLine{10707\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10708\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\ ||\ format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{10709\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{10710\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10711\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10712\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10713\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{10714\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10715\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10716\ }
\DoxyCodeLine{10717\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_fxt1:}
\DoxyCodeLine{10718\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10719\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{10720\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{10721\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10722\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{10723\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10724\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10725\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10726\ }
\DoxyCodeLine{10727\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10728\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_2bpp:}
\DoxyCodeLine{10729\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{10730\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG;}
\DoxyCodeLine{10731\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10732\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG;}
\DoxyCodeLine{10733\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10734\ }
\DoxyCodeLine{10735\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_4bpp:}
\DoxyCodeLine{10736\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{10737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG;}
\DoxyCodeLine{10738\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10739\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG;}
\DoxyCodeLine{10740\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10741\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10742\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_2bpp:}
\DoxyCodeLine{10743\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_4bpp:}
\DoxyCodeLine{10744\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10745\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{10746\ }
\DoxyCodeLine{10747\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_rgtc:}
\DoxyCodeLine{10748\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10749\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_luminance)\ \{}
\DoxyCodeLine{10750\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_LATC1\_EXT;}
\DoxyCodeLine{10751\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_luminance\_alpha)\ \{}
\DoxyCodeLine{10752\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\_EXT;}
\DoxyCodeLine{10753\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{10754\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RED\_RGTC1;}
\DoxyCodeLine{10755\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10756\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG\_RGTC2;}
\DoxyCodeLine{10757\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10758\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10759\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10760\ }
\DoxyCodeLine{10761\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_etc1:}
\DoxyCodeLine{10762\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10763\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ETC1\_RGB8\_OES;}
\DoxyCodeLine{10764\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10765\ \ \ \ \ \ \ \textcolor{comment}{//\ Fall\ through\ -\/\ ETC2\ is\ backward\ compatible}}
\DoxyCodeLine{10766\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_etc2:}
\DoxyCodeLine{10767\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_rgbm)\ \{}
\DoxyCodeLine{10768\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2;}
\DoxyCodeLine{10769\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{10770\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC;}
\DoxyCodeLine{10771\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb)\ \{}
\DoxyCodeLine{10772\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ETC2;}
\DoxyCodeLine{10773\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{10774\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA8\_ETC2\_EAC;}
\DoxyCodeLine{10775\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10776\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_ETC2;}
\DoxyCodeLine{10777\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10778\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10779\ }
\DoxyCodeLine{10780\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_eac:}
\DoxyCodeLine{10781\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(tex-\/>get\_component\_type()))\ \{}
\DoxyCodeLine{10782\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{10783\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_R11\_EAC;}
\DoxyCodeLine{10784\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10785\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG11\_EAC;}
\DoxyCodeLine{10786\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10787\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10788\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{10789\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_R11\_EAC;}
\DoxyCodeLine{10790\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{10791\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_RG11\_EAC;}
\DoxyCodeLine{10792\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10793\ \ \ \ \ \ \ \}}
\DoxyCodeLine{10794\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10795\ }
\DoxyCodeLine{10796\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_default:}
\DoxyCodeLine{10797\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_off:}
\DoxyCodeLine{10798\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt2:}
\DoxyCodeLine{10799\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt4:}
\DoxyCodeLine{10800\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ shouldn't\ happen.}}
\DoxyCodeLine{10801\ \ \ \ \ \ \ nassertr(\textcolor{keyword}{false},\ GL\_RGB);}
\DoxyCodeLine{10802\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10803\ \ \ \ \ \}}
\DoxyCodeLine{10804\ \ \ \}}
\DoxyCodeLine{10805\ }
\DoxyCodeLine{10806\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{10807\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10808\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_color\_index:}
\DoxyCodeLine{10809\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COLOR\_INDEX;}
\DoxyCodeLine{10810\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10811\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{10812\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{10813\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{10814\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{10815\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT;}
\DoxyCodeLine{10816\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{10817\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_depth\_stencil\ ?\ GL\_DEPTH\_STENCIL\ :\ GL\_DEPTH\_COMPONENT;}
\DoxyCodeLine{10818\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10819\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{10820\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{10821\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32:}
\DoxyCodeLine{10822\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RED;}
\DoxyCodeLine{10823\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_green:}
\DoxyCodeLine{10824\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_GREEN;}
\DoxyCodeLine{10825\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_blue:}
\DoxyCodeLine{10826\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_BLUE;}
\DoxyCodeLine{10827\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10828\ }
\DoxyCodeLine{10829\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{10830\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10831\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ALPHA;}
\DoxyCodeLine{10832\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10833\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_luminance\_texture\ ?\ GL\_ALPHA\ :\ GL\_RED;}
\DoxyCodeLine{10834\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10835\ }
\DoxyCodeLine{10836\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10837\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{10838\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{10839\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32:}
\DoxyCodeLine{10840\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG;}
\DoxyCodeLine{10841\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10842\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{10843\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{10844\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{10845\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{10846\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{10847\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{10848\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{10849\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{10850\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r11\_g11\_b10:}
\DoxyCodeLine{10851\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb9\_e5:}
\DoxyCodeLine{10852\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10853\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ never\ supports\ BGR,\ even\ if\ \_supports\_bgr\ is\ true.}}
\DoxyCodeLine{10854\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB;}
\DoxyCodeLine{10855\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10856\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGR\ :\ GL\_RGB;}
\DoxyCodeLine{10857\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10858\ }
\DoxyCodeLine{10859\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{10860\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{10861\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{10862\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{10863\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGRA\ :\ GL\_RGBA;}
\DoxyCodeLine{10864\ }
\DoxyCodeLine{10865\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{10866\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{10867\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{10868\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{10869\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{10870\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{10871\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10872\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ doesn't\ have\ sized\ BGRA\ formats.}}
\DoxyCodeLine{10873\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA;}
\DoxyCodeLine{10874\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10875\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGRA\ :\ GL\_RGBA;}
\DoxyCodeLine{10876\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10877\ }
\DoxyCodeLine{10878\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{10879\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10880\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE;}
\DoxyCodeLine{10881\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10882\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_luminance\_texture\ ?\ GL\_LUMINANCE\ :\ GL\_RED;}
\DoxyCodeLine{10883\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10884\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alphamask:}
\DoxyCodeLine{10885\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{10886\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10887\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{10888\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10889\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_luminance\_texture\ ?\ GL\_LUMINANCE\_ALPHA\ :\ GL\_RG;}
\DoxyCodeLine{10890\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10891\ }
\DoxyCodeLine{10892\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{10893\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10894\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE;}
\DoxyCodeLine{10895\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10896\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_luminance\_texture\ ?\ GL\_LUMINANCE\ :\ GL\_RGB;}
\DoxyCodeLine{10897\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10898\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{10899\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{10900\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{10901\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{10902\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_luminance\_texture\ ?\ GL\_LUMINANCE\_ALPHA\ :\ GL\_RGBA;}
\DoxyCodeLine{10903\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10904\ }
\DoxyCodeLine{10905\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{10906\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r8i:}
\DoxyCodeLine{10907\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16i:}
\DoxyCodeLine{10908\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32i:}
\DoxyCodeLine{10909\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RED\_INTEGER;}
\DoxyCodeLine{10910\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg8i:}
\DoxyCodeLine{10911\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16i:}
\DoxyCodeLine{10912\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32i:}
\DoxyCodeLine{10913\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG\_INTEGER;}
\DoxyCodeLine{10914\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8i:}
\DoxyCodeLine{10915\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16i:}
\DoxyCodeLine{10916\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32i:}
\DoxyCodeLine{10917\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB\_INTEGER;}
\DoxyCodeLine{10918\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8i:}
\DoxyCodeLine{10919\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16i:}
\DoxyCodeLine{10920\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32i:}
\DoxyCodeLine{10921\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA\_INTEGER;}
\DoxyCodeLine{10922\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{10923\ }
\DoxyCodeLine{10924\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{10925\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10926\ \ \ \}}
\DoxyCodeLine{10927\ \ \ GLCAT.error()}
\DoxyCodeLine{10928\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ Texture::Format\ value\ in\ get\_external\_image\_format():\ "{}}}
\DoxyCodeLine{10929\ \ \ \ \ <<\ format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{10930\ \ \ \textcolor{keywordflow}{return}\ GL\_RGB;}
\DoxyCodeLine{10931\ \}}
\DoxyCodeLine{10932\ }
\DoxyCodeLine{10937\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{10938\ get\_internal\_image\_format(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ bool\ force\_sized)\ const\ \{}
\DoxyCodeLine{10939\ \ \ \mbox{\hyperlink{classTexture}{Texture}}::CompressionMode\ compression\ =\ tex-\/>get\_compression();}
\DoxyCodeLine{10940\ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ Texture::CM\_default)\ \{}
\DoxyCodeLine{10941\ \ \ \ \ compression\ =\ (compressed\_textures)\ ?\ Texture::CM\_on\ :\ \mbox{\hyperlink{classTexture}{Texture}}::CM\_off;}
\DoxyCodeLine{10942\ \ \ \}}
\DoxyCodeLine{10943\ \ \ Texture::Format\ format\ =\ tex-\/>get\_format();}
\DoxyCodeLine{10944\ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_render\_to\_texture())\ \{}
\DoxyCodeLine{10945\ \ \ \ \ \textcolor{comment}{//\ no\ compression\ for\ render\ targets}}
\DoxyCodeLine{10946\ \ \ \ \ compression\ =\ Texture::CM\_off;}
\DoxyCodeLine{10947\ \ \ \}}
\DoxyCodeLine{10948\ \ \ Texture::ComponentType\ component\_type\ =\ tex-\/>get\_component\_type();}
\DoxyCodeLine{10949\ \ \ Texture::TextureType\ texture\_type\ =\ tex-\/>get\_texture\_type();}
\DoxyCodeLine{10950\ \ \ \textcolor{keywordtype}{bool}\ is\_3d\ =\ (texture\_type\ ==\ Texture::TT\_3d\_texture\ ||}
\DoxyCodeLine{10951\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ texture\_type\ ==\ Texture::TT\_2d\_texture\_array);}
\DoxyCodeLine{10952\ }
\DoxyCodeLine{10953\ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(compression)\ \&\&}
\DoxyCodeLine{10954\ \ \ \ \ \ \ texture\_type\ !=\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{10955\ \ \ \ \ \textcolor{keywordflow}{switch}\ (compression)\ \{}
\DoxyCodeLine{10956\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_on:}
\DoxyCodeLine{10957\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ user\ asked\ for\ just\ generic\ compression.\ \ OpenGL\ supports}}
\DoxyCodeLine{10958\ \ \ \ \ \ \ \textcolor{comment}{//\ requesting\ just\ generic\ compression,\ but\ we'd\ like\ to\ go\ ahead\ and}}
\DoxyCodeLine{10959\ \ \ \ \ \ \ \textcolor{comment}{//\ request\ a\ specific\ type\ (if\ we\ can\ figure\ out\ an\ appropriate\ choice),}}
\DoxyCodeLine{10960\ \ \ \ \ \ \ \textcolor{comment}{//\ since\ that\ makes\ saving\ the\ result\ as\ a\ pre-\/compressed\ texture\ more}}
\DoxyCodeLine{10961\ \ \ \ \ \ \ \textcolor{comment}{//\ dependable-\/-\/this\ way,\ we\ will\ know\ which\ compression\ algorithm\ was}}
\DoxyCodeLine{10962\ \ \ \ \ \ \ \textcolor{comment}{//\ applied.}}
\DoxyCodeLine{10963\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{10964\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_color\_index:}
\DoxyCodeLine{10965\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{10966\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{10967\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{10968\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{10969\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{10970\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r8i:}
\DoxyCodeLine{10971\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg8i:}
\DoxyCodeLine{10972\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8i:}
\DoxyCodeLine{10973\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8i:}
\DoxyCodeLine{10974\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16i:}
\DoxyCodeLine{10975\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16i:}
\DoxyCodeLine{10976\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16i:}
\DoxyCodeLine{10977\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16i:}
\DoxyCodeLine{10978\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32i:}
\DoxyCodeLine{10979\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32i:}
\DoxyCodeLine{10980\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32i:}
\DoxyCodeLine{10981\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32i:}
\DoxyCodeLine{10982\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r11\_g11\_b10:}
\DoxyCodeLine{10983\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb9\_e5:}
\DoxyCodeLine{10984\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Unsupported;\ fall\ through\ to\ below.}}
\DoxyCodeLine{10985\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{10986\ }
\DoxyCodeLine{10987\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{10988\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{10989\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{10990\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{10991\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{10992\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10993\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{10994\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2;}
\DoxyCodeLine{10995\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{10996\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{10997\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{10998\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{10999\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11000\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA;}
\DoxyCodeLine{11001\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11002\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11003\ }
\DoxyCodeLine{11004\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{11005\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11006\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt3)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11007\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT;}
\DoxyCodeLine{11008\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11009\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11010\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11011\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA8\_ETC2\_EAC;}
\DoxyCodeLine{11012\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11013\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11014\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11015\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{11016\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA;}
\DoxyCodeLine{11018\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11019\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11020\ }
\DoxyCodeLine{11021\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{11022\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{11023\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{11024\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{11025\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{11026\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt5)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11028\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11029\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11030\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11031\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11032\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA8\_ETC2\_EAC;}
\DoxyCodeLine{11033\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11034\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11036\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{11037\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA;}
\DoxyCodeLine{11039\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11041\ }
\DoxyCodeLine{11042\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{11043\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{11044\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{11045\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{11046\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{11047\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{11048\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{11049\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11050\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11053\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_ETC2;}
\DoxyCodeLine{11054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11055\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11057\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ETC1\_RGB8\_OES;}
\DoxyCodeLine{11058\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11059\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11061\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{11062\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB;}
\DoxyCodeLine{11064\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11066\ }
\DoxyCodeLine{11067\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{11068\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt5)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11070\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11071\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11072\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11073\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11074\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11075\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{11076\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_ALPHA;}
\DoxyCodeLine{11078\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11080\ }
\DoxyCodeLine{11081\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{11082\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_green:}
\DoxyCodeLine{11083\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_blue:}
\DoxyCodeLine{11084\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{11085\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32:}
\DoxyCodeLine{11086\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11087\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_rgtc)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11088\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RED\_RGTC1;}
\DoxyCodeLine{11089\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11090\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11091\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_eac)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11092\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_R11\_EAC;}
\DoxyCodeLine{11094\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_R11\_EAC;}
\DoxyCodeLine{11096\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11097\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11099\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11101\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11103\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{11104\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RED;}
\DoxyCodeLine{11106\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11107\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11108\ }
\DoxyCodeLine{11109\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{11110\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{11111\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32:}
\DoxyCodeLine{11112\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_rgtc)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11114\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG\_RGTC2;}
\DoxyCodeLine{11115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11116\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_eac)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11118\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG11\_EAC;}
\DoxyCodeLine{11120\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11121\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_RG11\_EAC;}
\DoxyCodeLine{11122\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11124\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11125\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11126\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11127\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11128\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11129\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{11130\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11131\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG;}
\DoxyCodeLine{11132\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11134\ }
\DoxyCodeLine{11135\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{11136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11137\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11138\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11139\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11141\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{11142\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE;}
\DoxyCodeLine{11144\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11146\ }
\DoxyCodeLine{11147\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{11148\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alphamask:}
\DoxyCodeLine{11149\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt5)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11151\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11152\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11153\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11154\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_fxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11156\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{11157\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11158\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{11159\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11161\ }
\DoxyCodeLine{11162\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11163\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{11164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt1)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11165\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11166\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11168\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ETC2;}
\DoxyCodeLine{11169\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB;}
\DoxyCodeLine{11171\ }
\DoxyCodeLine{11172\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{11173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_dxt5)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11174\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11175\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_compressed\_texture\_format(Texture::CM\_etc2)\ \&\&\ !is\_3d)\ \{}
\DoxyCodeLine{11177\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC;}
\DoxyCodeLine{11178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA;}
\DoxyCodeLine{11180\ }
\DoxyCodeLine{11181\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{11182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SLUMINANCE;}
\DoxyCodeLine{11183\ }
\DoxyCodeLine{11184\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{11185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SLUMINANCE\_ALPHA;}
\DoxyCodeLine{11186\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11187\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ now,\ we\ don't\ support\ compressed\ sRGB\ textures\ in\ OpenGL\ ES.}}
\DoxyCodeLine{11188\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{11189\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{11190\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{11191\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{11192\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11193\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11194\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11195\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11196\ }
\DoxyCodeLine{11197\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt1:}
\DoxyCodeLine{11198\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11199\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{11200\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11201\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb)\ \{}
\DoxyCodeLine{11202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11203\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{11204\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11205\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{11206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11207\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT;}
\DoxyCodeLine{11209\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11210\ }
\DoxyCodeLine{11211\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt3:}
\DoxyCodeLine{11212\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11213\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\ ||\ format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{11214\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3\_EXT;}
\DoxyCodeLine{11215\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11216\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11217\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11218\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT;}
\DoxyCodeLine{11219\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11220\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11221\ }
\DoxyCodeLine{11222\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt5:}
\DoxyCodeLine{11223\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11224\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\ ||\ format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{11225\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11226\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11227\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11228\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11229\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT;}
\DoxyCodeLine{11230\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11231\ }
\DoxyCodeLine{11232\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_fxt1:}
\DoxyCodeLine{11233\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{11235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX;}
\DoxyCodeLine{11236\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX;}
\DoxyCodeLine{11238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11239\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11240\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11241\ }
\DoxyCodeLine{11242\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11243\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_2bpp:}
\DoxyCodeLine{11244\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{11245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG;}
\DoxyCodeLine{11246\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG;}
\DoxyCodeLine{11248\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11249\ }
\DoxyCodeLine{11250\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_4bpp:}
\DoxyCodeLine{11251\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{11252\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG;}
\DoxyCodeLine{11253\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG;}
\DoxyCodeLine{11255\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11256\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11257\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_2bpp:}
\DoxyCodeLine{11258\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_pvr1\_4bpp:}
\DoxyCodeLine{11259\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11260\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11261\ }
\DoxyCodeLine{11262\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_rgtc:}
\DoxyCodeLine{11263\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11264\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_luminance)\ \{}
\DoxyCodeLine{11265\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_LATC1\_EXT;}
\DoxyCodeLine{11266\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_luminance\_alpha)\ \{}
\DoxyCodeLine{11267\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\_EXT;}
\DoxyCodeLine{11268\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{11269\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RED\_RGTC1;}
\DoxyCodeLine{11270\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 2)\ \{}
\DoxyCodeLine{11271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG\_RGTC2;}
\DoxyCodeLine{11272\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11273\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11274\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11275\ }
\DoxyCodeLine{11276\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_etc1:}
\DoxyCodeLine{11277\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11278\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ETC1\_RGB8\_OES;}
\DoxyCodeLine{11279\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11280\ \ \ \ \ \ \ \textcolor{comment}{//\ Fall\ through\ -\/\ ETC2\ is\ backward\ compatible}}
\DoxyCodeLine{11281\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_etc2:}
\DoxyCodeLine{11282\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_rgbm)\ \{}
\DoxyCodeLine{11283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2;}
\DoxyCodeLine{11284\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb\_alpha)\ \{}
\DoxyCodeLine{11285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC;}
\DoxyCodeLine{11286\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (format\ ==\ Texture::F\_srgb)\ \{}
\DoxyCodeLine{11287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SRGB8\_ETC2;}
\DoxyCodeLine{11288\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_adab479f28ca4194cf345d375e45f026b}{Texture::has\_alpha}}(format))\ \{}
\DoxyCodeLine{11289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGBA8\_ETC2\_EAC;}
\DoxyCodeLine{11290\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11291\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RGB8\_ETC2;}
\DoxyCodeLine{11292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11293\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11294\ }
\DoxyCodeLine{11295\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_eac:}
\DoxyCodeLine{11296\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{11298\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_R11\_EAC;}
\DoxyCodeLine{11299\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11300\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_RG11\_EAC;}
\DoxyCodeLine{11301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11302\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_components()\ ==\ 1)\ \{}
\DoxyCodeLine{11304\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_R11\_EAC;}
\DoxyCodeLine{11305\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11306\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COMPRESSED\_SIGNED\_RG11\_EAC;}
\DoxyCodeLine{11307\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{11308\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11309\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11310\ }
\DoxyCodeLine{11311\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_default:}
\DoxyCodeLine{11312\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_off:}
\DoxyCodeLine{11313\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt2:}
\DoxyCodeLine{11314\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::CM\_dxt4:}
\DoxyCodeLine{11315\ \ \ \ \ \ \ \textcolor{comment}{//\ No\ compression:\ fall\ through\ to\ below.}}
\DoxyCodeLine{11316\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11317\ \ \ \ \ \}}
\DoxyCodeLine{11318\ \ \ \}}
\DoxyCodeLine{11319\ }
\DoxyCodeLine{11320\ \textcolor{preprocessor}{\#if\ defined(\_\_EMSCRIPTEN\_\_)\ \&\&\ defined(OPENGLES)}}
\DoxyCodeLine{11321\ \ \ \textcolor{comment}{//\ WebGL\ 1\ has\ no\ sized\ formats,\ it\ would\ seem.}}
\DoxyCodeLine{11322\ \ \ \textcolor{keywordflow}{if}\ (!is\_at\_least\_gles\_version(3,\ 0))\ \{}
\DoxyCodeLine{11323\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_external\_image\_format(tex);}
\DoxyCodeLine{11324\ \ \ \}}
\DoxyCodeLine{11325\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11326\ }
\DoxyCodeLine{11327\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{11328\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11329\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_color\_index:}
\DoxyCodeLine{11330\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_COLOR\_INDEX;}
\DoxyCodeLine{11331\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11332\ }
\DoxyCodeLine{11333\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{11334\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_depth\_stencil)\ \{}
\DoxyCodeLine{11335\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11336\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float)\ \{}
\DoxyCodeLine{11337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH32F\_STENCIL8;}
\DoxyCodeLine{11338\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{11339\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11340\ \ \ \ \ \ \ \{}
\DoxyCodeLine{11341\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_DEPTH24\_STENCIL8\ :\ GL\_DEPTH\_STENCIL;}
\DoxyCodeLine{11342\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11343\ \ \ \ \ \}}
\DoxyCodeLine{11344\ \ \ \ \ \textcolor{comment}{//\ Fall\ through.}}
\DoxyCodeLine{11345\ }
\DoxyCodeLine{11346\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{11347\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11348\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float)\ \{}
\DoxyCodeLine{11349\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT32F;}
\DoxyCodeLine{11350\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{11351\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11352\ \ \ \ \ \{}
\DoxyCodeLine{11353\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_DEPTH\_COMPONENT16\ :\ GL\_DEPTH\_COMPONENT;}
\DoxyCodeLine{11354\ \ \ \ \ \}}
\DoxyCodeLine{11355\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{11356\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11357\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT16\_OES;}
\DoxyCodeLine{11358\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11359\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT16;}
\DoxyCodeLine{11360\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11361\ }
\DoxyCodeLine{11362\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{11363\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11364\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_depth24)\ \{}
\DoxyCodeLine{11365\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT24\_OES;}
\DoxyCodeLine{11366\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11367\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT16\_OES;}
\DoxyCodeLine{11368\ \ \ \ \ \}}
\DoxyCodeLine{11369\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11370\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT24;}
\DoxyCodeLine{11371\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11372\ }
\DoxyCodeLine{11373\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{11374\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11375\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_depth32)\ \{}
\DoxyCodeLine{11376\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT32\_OES;}
\DoxyCodeLine{11377\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_depth24)\ \{}
\DoxyCodeLine{11378\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT24\_OES;}
\DoxyCodeLine{11379\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11380\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT16\_OES;}
\DoxyCodeLine{11381\ \ \ \ \ \}}
\DoxyCodeLine{11382\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11383\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float)\ \{}
\DoxyCodeLine{11384\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT32F;}
\DoxyCodeLine{11385\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11386\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DEPTH\_COMPONENT32;}
\DoxyCodeLine{11387\ \ \ \ \ \}}
\DoxyCodeLine{11388\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11389\ }
\DoxyCodeLine{11390\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba:}
\DoxyCodeLine{11391\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgbm:}
\DoxyCodeLine{11392\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11393\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float\ ||}
\DoxyCodeLine{11394\ \ \ \ \ \ \ \ \ component\_type\ ==\ Texture::T\_half\_float)\ \{}
\DoxyCodeLine{11395\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16F;}
\DoxyCodeLine{11396\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{11397\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11398\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11399\ \ \ \ \ \{}
\DoxyCodeLine{11400\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ OpenGL\ ES,\ the\ internal\ format\ must\ match\ the\ external\ format.}}
\DoxyCodeLine{11401\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGRA\ :\ GL\_RGBA;}
\DoxyCodeLine{11402\ \ \ \ \ \}}
\DoxyCodeLine{11403\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11404\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_unsigned\_short)\ \{}
\DoxyCodeLine{11405\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16;}
\DoxyCodeLine{11406\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_short)\ \{}
\DoxyCodeLine{11407\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16\_SNORM;}
\DoxyCodeLine{11408\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_byte)\ \{}
\DoxyCodeLine{11409\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA8\_SNORM;}
\DoxyCodeLine{11410\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11411\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RGBA8\ :\ GL\_RGBA;}
\DoxyCodeLine{11412\ \ \ \ \ \}}
\DoxyCodeLine{11413\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11414\ }
\DoxyCodeLine{11415\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba4:}
\DoxyCodeLine{11416\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA4;}
\DoxyCodeLine{11417\ }
\DoxyCodeLine{11418\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11419\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{11420\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGRA\ :\ GL\_RGBA8\_OES;}
\DoxyCodeLine{11421\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{11422\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_bgr\ ?\ GL\_BGRA\ :\ (force\_sized\ ?\ GL\_RGBA8\ :\ GL\_RGBA);}
\DoxyCodeLine{11423\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11424\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8:}
\DoxyCodeLine{11425\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11426\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA8;}
\DoxyCodeLine{11427\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11428\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA8\_SNORM;}
\DoxyCodeLine{11429\ \ \ \ \ \}}
\DoxyCodeLine{11430\ }
\DoxyCodeLine{11431\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r8i:}
\DoxyCodeLine{11432\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11433\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R8UI;}
\DoxyCodeLine{11434\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11435\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R8I;}
\DoxyCodeLine{11436\ \ \ \ \ \}}
\DoxyCodeLine{11437\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg8i:}
\DoxyCodeLine{11438\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11439\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG8UI;}
\DoxyCodeLine{11440\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11441\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG8I;}
\DoxyCodeLine{11442\ \ \ \ \ \}}
\DoxyCodeLine{11443\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8i:}
\DoxyCodeLine{11444\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11445\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB8UI;}
\DoxyCodeLine{11446\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11447\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB8I;}
\DoxyCodeLine{11448\ \ \ \ \ \}}
\DoxyCodeLine{11449\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba8i:}
\DoxyCodeLine{11450\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11451\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA8UI;}
\DoxyCodeLine{11452\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11453\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA8I;}
\DoxyCodeLine{11454\ \ \ \ \ \}}
\DoxyCodeLine{11455\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba12:}
\DoxyCodeLine{11456\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA12;}
\DoxyCodeLine{11457\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{11458\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11459\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{11460\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float\ ||}
\DoxyCodeLine{11461\ \ \ \ \ \ \ \ \ component\_type\ ==\ Texture::T\_half\_float)\ \{}
\DoxyCodeLine{11462\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16F;}
\DoxyCodeLine{11463\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11464\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16;}
\DoxyCodeLine{11465\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11466\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16\_SNORM;}
\DoxyCodeLine{11467\ \ \ \ \ \}}
\DoxyCodeLine{11468\ \textcolor{preprocessor}{\#elif\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{11469\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16:}
\DoxyCodeLine{11470\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16F;}
\DoxyCodeLine{11471\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{11472\ }
\DoxyCodeLine{11473\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11474\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32:}
\DoxyCodeLine{11475\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA32F;}
\DoxyCodeLine{11476\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11477\ }
\DoxyCodeLine{11478\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb:}
\DoxyCodeLine{11479\ \ \ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{11480\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:\ \textcolor{keywordflow}{return}\ GL\_RGB16F;}
\DoxyCodeLine{11481\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:\ \textcolor{keywordflow}{return}\ GL\_RGB16F;}
\DoxyCodeLine{11482\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11483\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:\ \textcolor{keywordflow}{return}\ GL\_RGB16;}
\DoxyCodeLine{11484\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:\ \textcolor{keywordflow}{return}\ GL\_RGB16\_SNORM;}
\DoxyCodeLine{11485\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_byte:\ \textcolor{keywordflow}{return}\ GL\_RGB8\_SNORM;}
\DoxyCodeLine{11486\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11487\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11488\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RGB8\ :\ GL\_RGB;}
\DoxyCodeLine{11489\ \ \ \ \ \}}
\DoxyCodeLine{11490\ }
\DoxyCodeLine{11491\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb5:}
\DoxyCodeLine{11492\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11493\ \ \ \ \ \textcolor{comment}{//\ Close\ enough.}}
\DoxyCodeLine{11494\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB565\_OES;}
\DoxyCodeLine{11495\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11496\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB5;}
\DoxyCodeLine{11497\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11498\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba5:}
\DoxyCodeLine{11499\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB5\_A1;}
\DoxyCodeLine{11500\ }
\DoxyCodeLine{11501\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11502\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{11503\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB8\_OES;}
\DoxyCodeLine{11504\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{11505\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RGB8\ :\ GL\_RGB;}
\DoxyCodeLine{11506\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{11507\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16F;}
\DoxyCodeLine{11508\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11509\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb8:}
\DoxyCodeLine{11510\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11511\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB8;}
\DoxyCodeLine{11512\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11513\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB8\_SNORM;}
\DoxyCodeLine{11514\ \ \ \ \ \}}
\DoxyCodeLine{11515\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb12:}
\DoxyCodeLine{11516\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB12;}
\DoxyCodeLine{11517\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16:}
\DoxyCodeLine{11518\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float\ ||}
\DoxyCodeLine{11519\ \ \ \ \ \ \ \ \ component\_type\ ==\ Texture::T\_half\_float)\ \{}
\DoxyCodeLine{11520\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16F;}
\DoxyCodeLine{11521\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11522\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16;}
\DoxyCodeLine{11523\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11524\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16\_SNORM;}
\DoxyCodeLine{11525\ \ \ \ \ \}}
\DoxyCodeLine{11526\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{11527\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32:}
\DoxyCodeLine{11528\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB32F;}
\DoxyCodeLine{11529\ }
\DoxyCodeLine{11530\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11531\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb332:}
\DoxyCodeLine{11532\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R3\_G3\_B2;}
\DoxyCodeLine{11533\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11534\ }
\DoxyCodeLine{11535\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_2)}}
\DoxyCodeLine{11536\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{11537\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16F\_EXT;}
\DoxyCodeLine{11538\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{11539\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16F\_EXT;}
\DoxyCodeLine{11540\ \textcolor{preprocessor}{\#elif\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{11541\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16:}
\DoxyCodeLine{11542\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float\ ||}
\DoxyCodeLine{11543\ \ \ \ \ \ \ \ \ component\_type\ ==\ Texture::T\_half\_float)\ \{}
\DoxyCodeLine{11544\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16F;}
\DoxyCodeLine{11545\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11546\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16;}
\DoxyCodeLine{11547\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11548\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16\_SNORM;}
\DoxyCodeLine{11549\ \ \ \ \ \}}
\DoxyCodeLine{11550\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16:}
\DoxyCodeLine{11551\ \ \ \ \ \textcolor{keywordflow}{if}\ (component\_type\ ==\ Texture::T\_float\ ||}
\DoxyCodeLine{11552\ \ \ \ \ \ \ \ \ component\_type\ ==\ Texture::T\_half\_float)\ \{}
\DoxyCodeLine{11553\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16F;}
\DoxyCodeLine{11554\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11555\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16;}
\DoxyCodeLine{11556\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11557\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16\_SNORM;}
\DoxyCodeLine{11558\ \ \ \ \ \}}
\DoxyCodeLine{11559\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r16i:}
\DoxyCodeLine{11560\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11561\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16UI;}
\DoxyCodeLine{11562\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11563\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16I;}
\DoxyCodeLine{11564\ \ \ \ \ \}}
\DoxyCodeLine{11565\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg16i:}
\DoxyCodeLine{11566\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11567\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16UI;}
\DoxyCodeLine{11568\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11569\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16I;}
\DoxyCodeLine{11570\ \ \ \ \ \}}
\DoxyCodeLine{11571\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb16i:}
\DoxyCodeLine{11572\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11573\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16UI;}
\DoxyCodeLine{11574\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11575\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB16I;}
\DoxyCodeLine{11576\ \ \ \ \ \}}
\DoxyCodeLine{11577\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba16i:}
\DoxyCodeLine{11578\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11579\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16UI;}
\DoxyCodeLine{11580\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11581\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA16I;}
\DoxyCodeLine{11582\ \ \ \ \ \}}
\DoxyCodeLine{11583\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11584\ }
\DoxyCodeLine{11585\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11586\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32:}
\DoxyCodeLine{11587\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R32F;}
\DoxyCodeLine{11588\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32:}
\DoxyCodeLine{11589\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG32F;}
\DoxyCodeLine{11590\ }
\DoxyCodeLine{11591\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_red:}
\DoxyCodeLine{11592\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_green:}
\DoxyCodeLine{11593\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_blue:}
\DoxyCodeLine{11594\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11595\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11596\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R8\_SNORM;}
\DoxyCodeLine{11597\ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{11598\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11599\ \ \ \ \ \{}
\DoxyCodeLine{11600\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_R8\ :\ GL\_RED;}
\DoxyCodeLine{11601\ \ \ \ \ \}}
\DoxyCodeLine{11602\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11603\ }
\DoxyCodeLine{11604\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{11605\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11606\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_ALPHA8\ :\ GL\_ALPHA;}
\DoxyCodeLine{11607\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11608\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_luminance\_texture)\ \{}
\DoxyCodeLine{11609\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_ALPHA8\ :\ GL\_ALPHA;}
\DoxyCodeLine{11610\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11611\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_R8\ :\ GL\_RED;}
\DoxyCodeLine{11612\ \ \ \ \ \}}
\DoxyCodeLine{11613\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11614\ }
\DoxyCodeLine{11615\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{11616\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11617\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_LUMINANCE8\ :\ GL\_LUMINANCE;}
\DoxyCodeLine{11618\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11619\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_luminance\_texture)\ \{}
\DoxyCodeLine{11620\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{11621\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:}
\DoxyCodeLine{11622\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:}
\DoxyCodeLine{11623\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE16F\_ARB;}
\DoxyCodeLine{11624\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:}
\DoxyCodeLine{11625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE16\_SNORM;}
\DoxyCodeLine{11626\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:}
\DoxyCodeLine{11627\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE16;}
\DoxyCodeLine{11628\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11629\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_LUMINANCE8\ :\ GL\_LUMINANCE;}
\DoxyCodeLine{11630\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11631\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11632\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{11633\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:}
\DoxyCodeLine{11634\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:}
\DoxyCodeLine{11635\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16F;}
\DoxyCodeLine{11636\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:}
\DoxyCodeLine{11637\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16\_SNORM;}
\DoxyCodeLine{11638\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:}
\DoxyCodeLine{11639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R16;}
\DoxyCodeLine{11640\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11641\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_R8\ :\ GL\_RED;}
\DoxyCodeLine{11642\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11643\ \ \ \ \ \}}
\DoxyCodeLine{11644\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11645\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{11646\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alphamask:}
\DoxyCodeLine{11647\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11648\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_LUMINANCE8\_ALPHA8\ :\ GL\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{11649\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11650\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_luminance\_texture)\ \{}
\DoxyCodeLine{11651\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{11652\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:}
\DoxyCodeLine{11653\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:}
\DoxyCodeLine{11654\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE\_ALPHA16F\_ARB;}
\DoxyCodeLine{11655\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:}
\DoxyCodeLine{11656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE16\_SNORM;}
\DoxyCodeLine{11657\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:}
\DoxyCodeLine{11658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_LUMINANCE16\_ALPHA16;}
\DoxyCodeLine{11659\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_LUMINANCE8\_ALPHA8\ :\ GL\_LUMINANCE\_ALPHA;}
\DoxyCodeLine{11661\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11662\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11663\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (component\_type)\ \{}
\DoxyCodeLine{11664\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_float:}
\DoxyCodeLine{11665\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_half\_float:}
\DoxyCodeLine{11666\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16F;}
\DoxyCodeLine{11667\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_short:}
\DoxyCodeLine{11668\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16\_SNORM;}
\DoxyCodeLine{11669\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::T\_unsigned\_short:}
\DoxyCodeLine{11670\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG16;}
\DoxyCodeLine{11671\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11672\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RG8\ :\ GL\_RG;}
\DoxyCodeLine{11673\ \ \ \ \ \ \ \}}
\DoxyCodeLine{11674\ \ \ \ \ \}}
\DoxyCodeLine{11675\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11676\ }
\DoxyCodeLine{11677\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11678\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg:}
\DoxyCodeLine{11679\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RG8\ :\ GL\_RG;}
\DoxyCodeLine{11680\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11681\ }
\DoxyCodeLine{11682\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11683\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb:}
\DoxyCodeLine{11684\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_texture\_srgb\ ?\ GL\_SRGB8\ :\ GL\_RGB8;}
\DoxyCodeLine{11685\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_srgb\_alpha:}
\DoxyCodeLine{11686\ \ \ \ \ \textcolor{keywordflow}{return}\ \_supports\_texture\_srgb\ ?\ GL\_SRGB8\_ALPHA8\ :\ GL\_RGBA8;}
\DoxyCodeLine{11687\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11688\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{11689\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance:}
\DoxyCodeLine{11690\ \ \ \ \ \textcolor{keywordflow}{return}\ \_core\_profile\ ?\ GL\_SRGB8\ :\ GL\_SLUMINANCE8;}
\DoxyCodeLine{11691\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_sluminance\_alpha:}
\DoxyCodeLine{11692\ \ \ \ \ \textcolor{keywordflow}{return}\ \_core\_profile\ ?\ GL\_SRGB8\_ALPHA8\ :\ GL\_SLUMINANCE8\_ALPHA8;}
\DoxyCodeLine{11693\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11694\ }
\DoxyCodeLine{11695\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11696\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r32i:}
\DoxyCodeLine{11697\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11698\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R32UI;}
\DoxyCodeLine{11699\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11700\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R32I;}
\DoxyCodeLine{11701\ \ \ \ \ \}}
\DoxyCodeLine{11702\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rg32i:}
\DoxyCodeLine{11703\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11704\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG32UI;}
\DoxyCodeLine{11705\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11706\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RG32I;}
\DoxyCodeLine{11707\ \ \ \ \ \}}
\DoxyCodeLine{11708\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb32i:}
\DoxyCodeLine{11709\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11710\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB32UI;}
\DoxyCodeLine{11711\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11712\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB32I;}
\DoxyCodeLine{11713\ \ \ \ \ \}}
\DoxyCodeLine{11714\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgba32i:}
\DoxyCodeLine{11715\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_aff3d8f4f70d960180161a6143fc3e727}{Texture::is\_unsigned}}(component\_type))\ \{}
\DoxyCodeLine{11716\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA32UI;}
\DoxyCodeLine{11717\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11718\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGBA32I;}
\DoxyCodeLine{11719\ \ \ \ \ \}}
\DoxyCodeLine{11720\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11721\ }
\DoxyCodeLine{11722\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{11723\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_r11\_g11\_b10:}
\DoxyCodeLine{11724\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_R11F\_G11F\_B10F;}
\DoxyCodeLine{11725\ }
\DoxyCodeLine{11726\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb9\_e5:}
\DoxyCodeLine{11727\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB9\_E5;}
\DoxyCodeLine{11728\ }
\DoxyCodeLine{11729\ \ \ \textcolor{keywordflow}{case}\ Texture::F\_rgb10\_a2:}
\DoxyCodeLine{11730\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_RGB10\_A2;}
\DoxyCodeLine{11731\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11732\ }
\DoxyCodeLine{11733\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11734\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{11735\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ image\ format\ in\ get\_internal\_image\_format():\ "{}}}
\DoxyCodeLine{11736\ \ \ \ \ \ \ <<\ (int)format\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{11737\ \ \ \ \ \textcolor{keywordflow}{return}\ force\_sized\ ?\ GL\_RGB8\ :\ GL\_RGB;}
\DoxyCodeLine{11738\ \ \ \}}
\DoxyCodeLine{11739\ \}}
\DoxyCodeLine{11740\ }
\DoxyCodeLine{11745\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11746\ is\_mipmap\_filter(GLenum\ min\_filter)\ \{}
\DoxyCodeLine{11747\ \ \ \textcolor{keywordflow}{switch}\ (min\_filter)\ \{}
\DoxyCodeLine{11748\ \ \ \textcolor{keywordflow}{case}\ GL\_NEAREST\_MIPMAP\_NEAREST:}
\DoxyCodeLine{11749\ \ \ \textcolor{keywordflow}{case}\ GL\_LINEAR\_MIPMAP\_NEAREST:}
\DoxyCodeLine{11750\ \ \ \textcolor{keywordflow}{case}\ GL\_NEAREST\_MIPMAP\_LINEAR:}
\DoxyCodeLine{11751\ \ \ \textcolor{keywordflow}{case}\ GL\_LINEAR\_MIPMAP\_LINEAR:}
\DoxyCodeLine{11752\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{11753\ }
\DoxyCodeLine{11754\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11755\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{11756\ \ \ \}}
\DoxyCodeLine{11757\ \}}
\DoxyCodeLine{11758\ }
\DoxyCodeLine{11763\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11764\ is\_compressed\_format(GLenum\ format)\ \{}
\DoxyCodeLine{11765\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{11766\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{11767\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{11768\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11769\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{11770\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{11771\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{11772\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{11773\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11774\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT:}
\DoxyCodeLine{11775\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT:}
\DoxyCodeLine{11776\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX:}
\DoxyCodeLine{11777\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX:}
\DoxyCodeLine{11778\ }
\DoxyCodeLine{11779\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RED\_RGTC1:}
\DoxyCodeLine{11780\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_RED\_RGTC1:}
\DoxyCodeLine{11781\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RG\_RGTC2:}
\DoxyCodeLine{11782\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_RG\_RGTC2:}
\DoxyCodeLine{11783\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_LATC1\_EXT:}
\DoxyCodeLine{11784\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_LUMINANCE\_LATC1\_EXT:}
\DoxyCodeLine{11785\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\_EXT:}
\DoxyCodeLine{11786\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_LUMINANCE\_ALPHA\_LATC2\_EXT:}
\DoxyCodeLine{11787\ }
\DoxyCodeLine{11788\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB:}
\DoxyCodeLine{11789\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_EXT:}
\DoxyCodeLine{11790\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA:}
\DoxyCodeLine{11791\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_ALPHA\_EXT:}
\DoxyCodeLine{11792\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_ALPHA:}
\DoxyCodeLine{11793\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE:}
\DoxyCodeLine{11794\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{11795\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11796\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{11797\ }
\DoxyCodeLine{11798\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11799\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{11800\ \ \ \}}
\DoxyCodeLine{11801\ \}}
\DoxyCodeLine{11802\ }
\DoxyCodeLine{11806\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11807\ get\_texture\_apply\_mode\_type(\mbox{\hyperlink{classTextureStage}{TextureStage}}::Mode\ am)\ \{}
\DoxyCodeLine{11808\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{11809\ \ \ \textcolor{keywordflow}{switch}\ (am)\ \{}
\DoxyCodeLine{11810\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_modulate:\ \textcolor{keywordflow}{return}\ GL\_MODULATE;}
\DoxyCodeLine{11811\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_decal:\ \textcolor{keywordflow}{return}\ GL\_DECAL;}
\DoxyCodeLine{11812\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_blend:\ \textcolor{keywordflow}{return}\ GL\_BLEND;}
\DoxyCodeLine{11813\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_replace:\ \textcolor{keywordflow}{return}\ GL\_REPLACE;}
\DoxyCodeLine{11814\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_add:\ \textcolor{keywordflow}{return}\ GL\_ADD;}
\DoxyCodeLine{11815\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_combine:\ \textcolor{keywordflow}{return}\ GL\_COMBINE;}
\DoxyCodeLine{11816\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_blend\_color\_scale:\ \textcolor{keywordflow}{return}\ GL\_BLEND;}
\DoxyCodeLine{11817\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_modulate\_glow:\ \textcolor{keywordflow}{return}\ GL\_MODULATE;}
\DoxyCodeLine{11818\ \ \ \textcolor{keywordflow}{case}\ TextureStage::M\_modulate\_gloss:\ \textcolor{keywordflow}{return}\ GL\_MODULATE;}
\DoxyCodeLine{11819\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11820\ \ \ \ \ \textcolor{comment}{//\ Other\ modes\ shouldn't\ get\ here.\ \ Fall\ through\ and\ error.}}
\DoxyCodeLine{11821\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{11822\ \ \ \}}
\DoxyCodeLine{11823\ }
\DoxyCodeLine{11824\ \ \ GLCAT.error()}
\DoxyCodeLine{11825\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ TextureStage::Mode\ value"{}}\ <<\ endl;}
\DoxyCodeLine{11826\ \ \ \textcolor{keywordflow}{return}\ GL\_MODULATE;}
\DoxyCodeLine{11827\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11828\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{11829\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11830\ \}}
\DoxyCodeLine{11831\ }
\DoxyCodeLine{11836\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11837\ get\_texture\_combine\_type(\mbox{\hyperlink{classTextureStage}{TextureStage}}::CombineMode\ cm)\ \{}
\DoxyCodeLine{11838\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{11839\ \ \ \textcolor{keywordflow}{switch}\ (cm)\ \{}
\DoxyCodeLine{11840\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_undefined:\ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{11841\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_replace:\ \textcolor{keywordflow}{return}\ GL\_REPLACE;}
\DoxyCodeLine{11842\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_modulate:\ \textcolor{keywordflow}{return}\ GL\_MODULATE;}
\DoxyCodeLine{11843\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_add:\ \textcolor{keywordflow}{return}\ GL\_ADD;}
\DoxyCodeLine{11844\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_add\_signed:\ \textcolor{keywordflow}{return}\ GL\_ADD\_SIGNED;}
\DoxyCodeLine{11845\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_interpolate:\ \textcolor{keywordflow}{return}\ GL\_INTERPOLATE;}
\DoxyCodeLine{11846\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_subtract:\ \textcolor{keywordflow}{return}\ GL\_SUBTRACT;}
\DoxyCodeLine{11847\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_dot3\_rgb:\ \textcolor{keywordflow}{return}\ GL\_DOT3\_RGB;}
\DoxyCodeLine{11848\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CM\_dot3\_rgba:\ \textcolor{keywordflow}{return}\ GL\_DOT3\_RGBA;}
\DoxyCodeLine{11849\ \ \ \}}
\DoxyCodeLine{11850\ \ \ GLCAT.error()}
\DoxyCodeLine{11851\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ TextureStage::CombineMode\ value"{}}\ <<\ endl;}
\DoxyCodeLine{11852\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11853\ \ \ \textcolor{keywordflow}{return}\ GL\_REPLACE;}
\DoxyCodeLine{11854\ \}}
\DoxyCodeLine{11855\ }
\DoxyCodeLine{11860\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11861\ get\_texture\_src\_type(\mbox{\hyperlink{classTextureStage}{TextureStage}}::CombineSource\ cs,}
\DoxyCodeLine{11862\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ last\_stage,\ int\ last\_saved\_result,}
\DoxyCodeLine{11863\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ this\_stage)\ const\ \{}
\DoxyCodeLine{11864\ \#ifdef\ SUPPORT\_FIXED\_FUNCTION}
\DoxyCodeLine{11865\ \ \ switch\ (cs)\ \{}
\DoxyCodeLine{11866\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_undefined:\ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{11867\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_texture:\ \textcolor{keywordflow}{return}\ GL\_TEXTURE;}
\DoxyCodeLine{11868\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_constant:\ \textcolor{keywordflow}{return}\ GL\_CONSTANT;}
\DoxyCodeLine{11869\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_primary\_color:\ \textcolor{keywordflow}{return}\ GL\_PRIMARY\_COLOR;}
\DoxyCodeLine{11870\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_constant\_color\_scale:\ \textcolor{keywordflow}{return}\ GL\_CONSTANT;}
\DoxyCodeLine{11871\ }
\DoxyCodeLine{11872\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_previous:}
\DoxyCodeLine{11873\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_stage\ ==\ this\_stage\ -\/\ 1)\ \{}
\DoxyCodeLine{11874\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PREVIOUS;}
\DoxyCodeLine{11875\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (last\_stage\ ==\ -\/1)\ \{}
\DoxyCodeLine{11876\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PRIMARY\_COLOR;}
\DoxyCodeLine{11877\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_texture\_saved\_result)\ \{}
\DoxyCodeLine{11878\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE0\ +\ last\_stage;}
\DoxyCodeLine{11879\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11880\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{11881\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Current\ OpenGL\ driver\ does\ not\ support\ texture\ crossbar\ blending.\(\backslash\)n"{}};}
\DoxyCodeLine{11882\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PRIMARY\_COLOR;}
\DoxyCodeLine{11883\ \ \ \ \ \}}
\DoxyCodeLine{11884\ }
\DoxyCodeLine{11885\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CS\_last\_saved\_result:}
\DoxyCodeLine{11886\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_saved\_result\ ==\ this\_stage\ -\/\ 1)\ \{}
\DoxyCodeLine{11887\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PREVIOUS;}
\DoxyCodeLine{11888\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (last\_saved\_result\ ==\ -\/1)\ \{}
\DoxyCodeLine{11889\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PRIMARY\_COLOR;}
\DoxyCodeLine{11890\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_texture\_saved\_result)\ \{}
\DoxyCodeLine{11891\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE0\ +\ last\_saved\_result;}
\DoxyCodeLine{11892\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{11893\ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{11894\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Current\ OpenGL\ driver\ does\ not\ support\ texture\ crossbar\ blending.\(\backslash\)n"{}};}
\DoxyCodeLine{11895\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_PRIMARY\_COLOR;}
\DoxyCodeLine{11896\ \ \ \ \ \}}
\DoxyCodeLine{11897\ \ \ \}}
\DoxyCodeLine{11898\ }
\DoxyCodeLine{11899\ \ \ GLCAT.error()}
\DoxyCodeLine{11900\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ TextureStage::CombineSource\ value"{}}\ <<\ endl;}
\DoxyCodeLine{11901\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11902\ \ \ \textcolor{keywordflow}{return}\ GL\_TEXTURE;}
\DoxyCodeLine{11903\ \}}
\DoxyCodeLine{11904\ }
\DoxyCodeLine{11909\ GLint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11910\ get\_texture\_operand\_type(\mbox{\hyperlink{classTextureStage}{TextureStage}}::CombineOperand\ co)\ \{}
\DoxyCodeLine{11911\ \ \ \textcolor{keywordflow}{switch}\ (co)\ \{}
\DoxyCodeLine{11912\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CO\_undefined:\ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{11913\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CO\_src\_alpha:\ \textcolor{keywordflow}{return}\ GL\_SRC\_ALPHA;}
\DoxyCodeLine{11914\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CO\_one\_minus\_src\_alpha:\ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC\_ALPHA;}
\DoxyCodeLine{11915\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CO\_src\_color:\ \textcolor{keywordflow}{return}\ GL\_SRC\_COLOR;}
\DoxyCodeLine{11916\ \ \ \textcolor{keywordflow}{case}\ TextureStage::CO\_one\_minus\_src\_color:\ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC\_COLOR;}
\DoxyCodeLine{11917\ \ \ \}}
\DoxyCodeLine{11918\ }
\DoxyCodeLine{11919\ \ \ GLCAT.error()}
\DoxyCodeLine{11920\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ TextureStage::CombineOperand\ value"{}}\ <<\ endl;}
\DoxyCodeLine{11921\ \ \ \textcolor{keywordflow}{return}\ GL\_SRC\_COLOR;}
\DoxyCodeLine{11922\ \}}
\DoxyCodeLine{11923\ }
\DoxyCodeLine{11924\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{11928\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11929\ get\_fog\_mode\_type(\mbox{\hyperlink{classFog}{Fog}}::Mode\ m)\ \{}
\DoxyCodeLine{11930\ \ \ \textcolor{keywordflow}{switch}(m)\ \{}
\DoxyCodeLine{11931\ \ \ \textcolor{keywordflow}{case}\ Fog::M\_linear:\ \textcolor{keywordflow}{return}\ GL\_LINEAR;}
\DoxyCodeLine{11932\ \ \ \textcolor{keywordflow}{case}\ Fog::M\_exponential:\ \textcolor{keywordflow}{return}\ GL\_EXP;}
\DoxyCodeLine{11933\ \ \ \textcolor{keywordflow}{case}\ Fog::M\_exponential\_squared:\ \textcolor{keywordflow}{return}\ GL\_EXP2;}
\DoxyCodeLine{11934\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{11935\ \textcolor{comment}{\ \ \ \ \ \ case\ Fog::M\_spline:\ return\ GL\_FOG\_FUNC\_SGIS;}}
\DoxyCodeLine{11936\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{11937\ }
\DoxyCodeLine{11938\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{11939\ \ \ \ \ GLCAT.error()\ <<\ \textcolor{stringliteral}{"{}Invalid\ Fog::Mode\ value"{}}\ <<\ endl;}
\DoxyCodeLine{11940\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_EXP;}
\DoxyCodeLine{11941\ \ \ \}}
\DoxyCodeLine{11942\ \}}
\DoxyCodeLine{11943\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11944\ }
\DoxyCodeLine{11948\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11949\ get\_blend\_equation\_type(\mbox{\hyperlink{classColorBlendAttrib}{ColorBlendAttrib}}::Mode\ mode)\ \{}
\DoxyCodeLine{11950\ \ \ \textcolor{keywordflow}{switch}\ (mode)\ \{}
\DoxyCodeLine{11951\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_none:}
\DoxyCodeLine{11952\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_add:}
\DoxyCodeLine{11953\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_FUNC\_ADD;}
\DoxyCodeLine{11954\ }
\DoxyCodeLine{11955\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_subtract:}
\DoxyCodeLine{11956\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_FUNC\_SUBTRACT;}
\DoxyCodeLine{11957\ }
\DoxyCodeLine{11958\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_inv\_subtract:}
\DoxyCodeLine{11959\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_FUNC\_REVERSE\_SUBTRACT;}
\DoxyCodeLine{11960\ }
\DoxyCodeLine{11961\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{11962\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_min:}
\DoxyCodeLine{11963\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_MIN\_EXT;}
\DoxyCodeLine{11964\ }
\DoxyCodeLine{11965\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_max:}
\DoxyCodeLine{11966\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_MAX\_EXT;}
\DoxyCodeLine{11967\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{11968\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_min:}
\DoxyCodeLine{11969\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_MIN;}
\DoxyCodeLine{11970\ }
\DoxyCodeLine{11971\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::M\_max:}
\DoxyCodeLine{11972\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_MAX;}
\DoxyCodeLine{11973\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{11974\ \ \ \}}
\DoxyCodeLine{11975\ }
\DoxyCodeLine{11976\ \ \ GLCAT.error()}
\DoxyCodeLine{11977\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unknown\ color\ blend\ mode\ "{}}\ <<\ (int)mode\ <<\ endl;}
\DoxyCodeLine{11978\ \ \ \textcolor{keywordflow}{return}\ GL\_FUNC\_ADD;}
\DoxyCodeLine{11979\ \}}
\DoxyCodeLine{11980\ }
\DoxyCodeLine{11984\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{11985\ get\_blend\_func(\mbox{\hyperlink{classColorBlendAttrib}{ColorBlendAttrib}}::Operand\ operand)\ \{}
\DoxyCodeLine{11986\ \ \ \textcolor{keywordflow}{switch}\ (operand)\ \{}
\DoxyCodeLine{11987\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_zero:}
\DoxyCodeLine{11988\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ZERO;}
\DoxyCodeLine{11989\ }
\DoxyCodeLine{11990\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one:}
\DoxyCodeLine{11991\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE;}
\DoxyCodeLine{11992\ }
\DoxyCodeLine{11993\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming\_color:}
\DoxyCodeLine{11994\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SRC\_COLOR;}
\DoxyCodeLine{11995\ }
\DoxyCodeLine{11996\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming\_color:}
\DoxyCodeLine{11997\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC\_COLOR;}
\DoxyCodeLine{11998\ }
\DoxyCodeLine{11999\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_fbuffer\_color:}
\DoxyCodeLine{12000\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DST\_COLOR;}
\DoxyCodeLine{12001\ }
\DoxyCodeLine{12002\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_fbuffer\_color:}
\DoxyCodeLine{12003\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_DST\_COLOR;}
\DoxyCodeLine{12004\ }
\DoxyCodeLine{12005\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming\_alpha:}
\DoxyCodeLine{12006\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SRC\_ALPHA;}
\DoxyCodeLine{12007\ }
\DoxyCodeLine{12008\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming\_alpha:}
\DoxyCodeLine{12009\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC\_ALPHA;}
\DoxyCodeLine{12010\ }
\DoxyCodeLine{12011\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_fbuffer\_alpha:}
\DoxyCodeLine{12012\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DST\_ALPHA;}
\DoxyCodeLine{12013\ }
\DoxyCodeLine{12014\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_fbuffer\_alpha:}
\DoxyCodeLine{12015\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_DST\_ALPHA;}
\DoxyCodeLine{12016\ }
\DoxyCodeLine{12017\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{12018\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ 1\ has\ no\ constant\ blend\ factor.}}
\DoxyCodeLine{12019\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_constant\_color:}
\DoxyCodeLine{12020\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_color\_scale:}
\DoxyCodeLine{12021\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_constant\_color:}
\DoxyCodeLine{12022\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_color\_scale:}
\DoxyCodeLine{12023\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_constant\_alpha:}
\DoxyCodeLine{12024\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_alpha\_scale:}
\DoxyCodeLine{12025\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_constant\_alpha:}
\DoxyCodeLine{12026\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_alpha\_scale:}
\DoxyCodeLine{12027\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{12028\ }
\DoxyCodeLine{12029\ \ \ \textcolor{comment}{//\ No\ dual-\/source\ blending,\ either.}}
\DoxyCodeLine{12030\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming1\_color:}
\DoxyCodeLine{12031\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming1\_color:}
\DoxyCodeLine{12032\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming1\_alpha:}
\DoxyCodeLine{12033\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming1\_alpha:}
\DoxyCodeLine{12034\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{12035\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12036\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_constant\_color:}
\DoxyCodeLine{12037\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_color\_scale:}
\DoxyCodeLine{12038\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_CONSTANT\_COLOR;}
\DoxyCodeLine{12039\ }
\DoxyCodeLine{12040\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_constant\_color:}
\DoxyCodeLine{12041\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_color\_scale:}
\DoxyCodeLine{12042\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_CONSTANT\_COLOR;}
\DoxyCodeLine{12043\ }
\DoxyCodeLine{12044\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_constant\_alpha:}
\DoxyCodeLine{12045\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_alpha\_scale:}
\DoxyCodeLine{12046\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_CONSTANT\_ALPHA;}
\DoxyCodeLine{12047\ }
\DoxyCodeLine{12048\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_constant\_alpha:}
\DoxyCodeLine{12049\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_alpha\_scale:}
\DoxyCodeLine{12050\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_CONSTANT\_ALPHA;}
\DoxyCodeLine{12051\ }
\DoxyCodeLine{12052\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming1\_color:}
\DoxyCodeLine{12053\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SRC1\_COLOR;}
\DoxyCodeLine{12054\ }
\DoxyCodeLine{12055\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming1\_color:}
\DoxyCodeLine{12056\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC1\_COLOR;}
\DoxyCodeLine{12057\ }
\DoxyCodeLine{12058\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming1\_alpha:}
\DoxyCodeLine{12059\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SRC1\_ALPHA;}
\DoxyCodeLine{12060\ }
\DoxyCodeLine{12061\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_one\_minus\_incoming1\_alpha:}
\DoxyCodeLine{12062\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_ONE\_MINUS\_SRC1\_ALPHA;}
\DoxyCodeLine{12063\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12064\ }
\DoxyCodeLine{12065\ \ \ \textcolor{keywordflow}{case}\ ColorBlendAttrib::O\_incoming\_color\_saturate:}
\DoxyCodeLine{12066\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_SRC\_ALPHA\_SATURATE;}
\DoxyCodeLine{12067\ \ \ \}}
\DoxyCodeLine{12068\ }
\DoxyCodeLine{12069\ \ \ GLCAT.error()}
\DoxyCodeLine{12070\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unknown\ color\ blend\ operand\ "{}}\ <<\ (int)operand\ <<\ endl;}
\DoxyCodeLine{12071\ \ \ \textcolor{keywordflow}{return}\ GL\_ZERO;}
\DoxyCodeLine{12072\ \}}
\DoxyCodeLine{12073\ }
\DoxyCodeLine{12077\ GLenum\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12078\ get\_usage(\mbox{\hyperlink{classGeom}{Geom}}::UsageHint\ usage\_hint)\ \{}
\DoxyCodeLine{12079\ \ \ \textcolor{keywordflow}{switch}\ (usage\_hint)\ \{}
\DoxyCodeLine{12080\ \ \ \textcolor{keywordflow}{case}\ Geom::UH\_stream:}
\DoxyCodeLine{12081\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{12082\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DYNAMIC\_DRAW;}
\DoxyCodeLine{12083\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12084\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_STREAM\_DRAW;}
\DoxyCodeLine{12085\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{12086\ }
\DoxyCodeLine{12087\ \ \ \textcolor{keywordflow}{case}\ Geom::UH\_static:}
\DoxyCodeLine{12088\ \ \ \textcolor{keywordflow}{case}\ Geom::UH\_unspecified:}
\DoxyCodeLine{12089\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_STATIC\_DRAW;}
\DoxyCodeLine{12090\ }
\DoxyCodeLine{12091\ \ \ \textcolor{keywordflow}{case}\ Geom::UH\_dynamic:}
\DoxyCodeLine{12092\ \ \ \ \ \textcolor{keywordflow}{return}\ GL\_DYNAMIC\_DRAW;}
\DoxyCodeLine{12093\ }
\DoxyCodeLine{12094\ \ \ \textcolor{keywordflow}{case}\ Geom::UH\_client:}
\DoxyCodeLine{12095\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{12096\ \ \ \}}
\DoxyCodeLine{12097\ }
\DoxyCodeLine{12098\ \ \ GLCAT.error()}
\DoxyCodeLine{12099\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unexpected\ usage\_hint\ "{}}\ <<\ (int)usage\_hint\ <<\ endl;}
\DoxyCodeLine{12100\ \ \ \textcolor{keywordflow}{return}\ GL\_STATIC\_DRAW;}
\DoxyCodeLine{12101\ \}}
\DoxyCodeLine{12102\ }
\DoxyCodeLine{12103\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{12107\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12108\ get\_compressed\_format\_string(GLenum\ format)\ \{}
\DoxyCodeLine{12109\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{12110\ \ \ \textcolor{keywordflow}{case}\ 0x83F0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT"{}};}
\DoxyCodeLine{12111\ \ \ \textcolor{keywordflow}{case}\ 0x83F1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT"{}};}
\DoxyCodeLine{12112\ \ \ \textcolor{keywordflow}{case}\ 0x83F2:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT"{}};}
\DoxyCodeLine{12113\ \ \ \textcolor{keywordflow}{case}\ 0x83F3:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT"{}};}
\DoxyCodeLine{12114\ \ \ \textcolor{keywordflow}{case}\ 0x86B0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_FXT1\_3DFX"{}};}
\DoxyCodeLine{12115\ \ \ \textcolor{keywordflow}{case}\ 0x86B1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_FXT1\_3DFX"{}};}
\DoxyCodeLine{12116\ \ \ \textcolor{keywordflow}{case}\ 0x88EE:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_ETC1\_SRGB8\_NV"{}};}
\DoxyCodeLine{12117\ \ \ \textcolor{keywordflow}{case}\ 0x8A54:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_PVRTC\_2BPPV1\_EXT"{}};}
\DoxyCodeLine{12118\ \ \ \textcolor{keywordflow}{case}\ 0x8A55:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_PVRTC\_4BPPV1\_EXT"{}};}
\DoxyCodeLine{12119\ \ \ \textcolor{keywordflow}{case}\ 0x8A56:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_2BPPV1\_EXT"{}};}
\DoxyCodeLine{12120\ \ \ \textcolor{keywordflow}{case}\ 0x8A57:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_4BPPV1\_EXT"{}};}
\DoxyCodeLine{12121\ \ \ \textcolor{keywordflow}{case}\ 0x8B90:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE4\_RGB8\_OES"{}};}
\DoxyCodeLine{12122\ \ \ \textcolor{keywordflow}{case}\ 0x8B91:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE4\_RGBA8\_OES"{}};}
\DoxyCodeLine{12123\ \ \ \textcolor{keywordflow}{case}\ 0x8B92:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE4\_R5\_G6\_B5\_OES"{}};}
\DoxyCodeLine{12124\ \ \ \textcolor{keywordflow}{case}\ 0x8B93:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE4\_RGBA4\_OES"{}};}
\DoxyCodeLine{12125\ \ \ \textcolor{keywordflow}{case}\ 0x8B94:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE4\_RGB5\_A1\_OES"{}};}
\DoxyCodeLine{12126\ \ \ \textcolor{keywordflow}{case}\ 0x8B95:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE8\_RGB8\_OES"{}};}
\DoxyCodeLine{12127\ \ \ \textcolor{keywordflow}{case}\ 0x8B96:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE8\_RGBA8\_OES"{}};}
\DoxyCodeLine{12128\ \ \ \textcolor{keywordflow}{case}\ 0x8B97:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE8\_R5\_G6\_B5\_OES"{}};}
\DoxyCodeLine{12129\ \ \ \textcolor{keywordflow}{case}\ 0x8B98:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE8\_RGBA4\_OES"{}};}
\DoxyCodeLine{12130\ \ \ \textcolor{keywordflow}{case}\ 0x8B99:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_PALETTE8\_RGB5\_A1\_OES"{}};}
\DoxyCodeLine{12131\ \ \ \textcolor{keywordflow}{case}\ 0x8C00:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG"{}};}
\DoxyCodeLine{12132\ \ \ \textcolor{keywordflow}{case}\ 0x8C01:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG"{}};}
\DoxyCodeLine{12133\ \ \ \textcolor{keywordflow}{case}\ 0x8C02:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG"{}};}
\DoxyCodeLine{12134\ \ \ \textcolor{keywordflow}{case}\ 0x8C03:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG"{}};}
\DoxyCodeLine{12135\ \ \ \textcolor{keywordflow}{case}\ 0x8C48:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_EXT"{}};}
\DoxyCodeLine{12136\ \ \ \textcolor{keywordflow}{case}\ 0x8C49:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_EXT"{}};}
\DoxyCodeLine{12137\ \ \ \textcolor{keywordflow}{case}\ 0x8C4A:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SLUMINANCE\_EXT"{}};}
\DoxyCodeLine{12138\ \ \ \textcolor{keywordflow}{case}\ 0x8C4B:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SLUMINANCE\_ALPHA\_EXT"{}};}
\DoxyCodeLine{12139\ \ \ \textcolor{keywordflow}{case}\ 0x8C4C:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_S3TC\_DXT1\_EXT"{}};}
\DoxyCodeLine{12140\ \ \ \textcolor{keywordflow}{case}\ 0x8C4D:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1\_EXT"{}};}
\DoxyCodeLine{12141\ \ \ \textcolor{keywordflow}{case}\ 0x8C4E:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3\_EXT"{}};}
\DoxyCodeLine{12142\ \ \ \textcolor{keywordflow}{case}\ 0x8C4F:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\_EXT"{}};}
\DoxyCodeLine{12143\ \ \ \textcolor{keywordflow}{case}\ 0x8C70:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_LUMINANCE\_LATC1\_EXT"{}};}
\DoxyCodeLine{12144\ \ \ \textcolor{keywordflow}{case}\ 0x8C71:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_LUMINANCE\_LATC1\_EXT"{}};}
\DoxyCodeLine{12145\ \ \ \textcolor{keywordflow}{case}\ 0x8C72:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\_EXT"{}};}
\DoxyCodeLine{12146\ \ \ \textcolor{keywordflow}{case}\ 0x8C73:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_LUMINANCE\_ALPHA\_LATC2\_EXT"{}};}
\DoxyCodeLine{12147\ \ \ \textcolor{keywordflow}{case}\ 0x8D64:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_ETC1\_RGB8\_OES"{}};}
\DoxyCodeLine{12148\ \ \ \textcolor{keywordflow}{case}\ 0x8DBB:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RED\_RGTC1"{}};}
\DoxyCodeLine{12149\ \ \ \textcolor{keywordflow}{case}\ 0x8DBC:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_RED\_RGTC1"{}};}
\DoxyCodeLine{12150\ \ \ \textcolor{keywordflow}{case}\ 0x8DBD:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RG\_RGTC2"{}};}
\DoxyCodeLine{12151\ \ \ \textcolor{keywordflow}{case}\ 0x8DBE:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_RG\_RGTC2"{}};}
\DoxyCodeLine{12152\ \ \ \textcolor{keywordflow}{case}\ 0x8E8C:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_BPTC\_UNORM"{}};}
\DoxyCodeLine{12153\ \ \ \textcolor{keywordflow}{case}\ 0x8E8D:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_BPTC\_UNORM"{}};}
\DoxyCodeLine{12154\ \ \ \textcolor{keywordflow}{case}\ 0x8E8E:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_BPTC\_SIGNED\_FLOAT"{}};}
\DoxyCodeLine{12155\ \ \ \textcolor{keywordflow}{case}\ 0x8E8F:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB\_BPTC\_UNSIGNED\_FLOAT"{}};}
\DoxyCodeLine{12156\ \ \ \textcolor{keywordflow}{case}\ 0x9137:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV2\_IMG"{}};}
\DoxyCodeLine{12157\ \ \ \textcolor{keywordflow}{case}\ 0x9138:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV2\_IMG"{}};}
\DoxyCodeLine{12158\ \ \ \textcolor{keywordflow}{case}\ 0x9270:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_R11\_EAC"{}};}
\DoxyCodeLine{12159\ \ \ \textcolor{keywordflow}{case}\ 0x9271:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_R11\_EAC"{}};}
\DoxyCodeLine{12160\ \ \ \textcolor{keywordflow}{case}\ 0x9272:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RG11\_EAC"{}};}
\DoxyCodeLine{12161\ \ \ \textcolor{keywordflow}{case}\ 0x9273:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SIGNED\_RG11\_EAC"{}};}
\DoxyCodeLine{12162\ \ \ \textcolor{keywordflow}{case}\ 0x9274:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB8\_ETC2"{}};}
\DoxyCodeLine{12163\ \ \ \textcolor{keywordflow}{case}\ 0x9275:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ETC2"{}};}
\DoxyCodeLine{12164\ \ \ \textcolor{keywordflow}{case}\ 0x9276:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2"{}};}
\DoxyCodeLine{12165\ \ \ \textcolor{keywordflow}{case}\ 0x9277:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_PUNCHTHROUGH\_ALPHA1\_ETC2"{}};}
\DoxyCodeLine{12166\ \ \ \textcolor{keywordflow}{case}\ 0x9278:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA8\_ETC2\_EAC"{}};}
\DoxyCodeLine{12167\ \ \ \textcolor{keywordflow}{case}\ 0x9279:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ETC2\_EAC"{}};}
\DoxyCodeLine{12168\ \ \ \textcolor{keywordflow}{case}\ 0x93B0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_4x4\_KHR"{}};}
\DoxyCodeLine{12169\ \ \ \textcolor{keywordflow}{case}\ 0x93B1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_5x4\_KHR"{}};}
\DoxyCodeLine{12170\ \ \ \textcolor{keywordflow}{case}\ 0x93B2:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_5x5\_KHR"{}};}
\DoxyCodeLine{12171\ \ \ \textcolor{keywordflow}{case}\ 0x93B3:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_6x5\_KHR"{}};}
\DoxyCodeLine{12172\ \ \ \textcolor{keywordflow}{case}\ 0x93B4:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_6x6\_KHR"{}};}
\DoxyCodeLine{12173\ \ \ \textcolor{keywordflow}{case}\ 0x93B5:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_8x5\_KHR"{}};}
\DoxyCodeLine{12174\ \ \ \textcolor{keywordflow}{case}\ 0x93B6:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_8x6\_KHR"{}};}
\DoxyCodeLine{12175\ \ \ \textcolor{keywordflow}{case}\ 0x93B7:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_8x8\_KHR"{}};}
\DoxyCodeLine{12176\ \ \ \textcolor{keywordflow}{case}\ 0x93B8:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_10x5\_KHR"{}};}
\DoxyCodeLine{12177\ \ \ \textcolor{keywordflow}{case}\ 0x93B9:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_10x6\_KHR"{}};}
\DoxyCodeLine{12178\ \ \ \textcolor{keywordflow}{case}\ 0x93BA:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_10x8\_KHR"{}};}
\DoxyCodeLine{12179\ \ \ \textcolor{keywordflow}{case}\ 0x93BB:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_10x10\_KHR"{}};}
\DoxyCodeLine{12180\ \ \ \textcolor{keywordflow}{case}\ 0x93BC:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_12x10\_KHR"{}};}
\DoxyCodeLine{12181\ \ \ \textcolor{keywordflow}{case}\ 0x93BD:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_12x12\_KHR"{}};}
\DoxyCodeLine{12182\ \ \ \textcolor{keywordflow}{case}\ 0x93C0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_3x3x3\_OES"{}};}
\DoxyCodeLine{12183\ \ \ \textcolor{keywordflow}{case}\ 0x93C1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_4x3x3\_OES"{}};}
\DoxyCodeLine{12184\ \ \ \textcolor{keywordflow}{case}\ 0x93C2:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_4x4x3\_OES"{}};}
\DoxyCodeLine{12185\ \ \ \textcolor{keywordflow}{case}\ 0x93C3:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_4x4x4\_OES"{}};}
\DoxyCodeLine{12186\ \ \ \textcolor{keywordflow}{case}\ 0x93C4:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_5x4x4\_OES"{}};}
\DoxyCodeLine{12187\ \ \ \textcolor{keywordflow}{case}\ 0x93C5:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_5x5x4\_OES"{}};}
\DoxyCodeLine{12188\ \ \ \textcolor{keywordflow}{case}\ 0x93C6:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_5x5x5\_OES"{}};}
\DoxyCodeLine{12189\ \ \ \textcolor{keywordflow}{case}\ 0x93C7:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_6x5x5\_OES"{}};}
\DoxyCodeLine{12190\ \ \ \textcolor{keywordflow}{case}\ 0x93C8:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_6x6x5\_OES"{}};}
\DoxyCodeLine{12191\ \ \ \textcolor{keywordflow}{case}\ 0x93C9:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_RGBA\_ASTC\_6x6x6\_OES"{}};}
\DoxyCodeLine{12192\ \ \ \textcolor{keywordflow}{case}\ 0x93D0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_4x4\_KHR"{}};}
\DoxyCodeLine{12193\ \ \ \textcolor{keywordflow}{case}\ 0x93D1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_5x4\_KHR"{}};}
\DoxyCodeLine{12194\ \ \ \textcolor{keywordflow}{case}\ 0x93D2:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_5x5\_KHR"{}};}
\DoxyCodeLine{12195\ \ \ \textcolor{keywordflow}{case}\ 0x93D3:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_6x5\_KHR"{}};}
\DoxyCodeLine{12196\ \ \ \textcolor{keywordflow}{case}\ 0x93D4:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_6x6\_KHR"{}};}
\DoxyCodeLine{12197\ \ \ \textcolor{keywordflow}{case}\ 0x93D5:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_8x5\_KHR"{}};}
\DoxyCodeLine{12198\ \ \ \textcolor{keywordflow}{case}\ 0x93D6:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_8x6\_KHR"{}};}
\DoxyCodeLine{12199\ \ \ \textcolor{keywordflow}{case}\ 0x93D7:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_8x8\_KHR"{}};}
\DoxyCodeLine{12200\ \ \ \textcolor{keywordflow}{case}\ 0x93D8:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_10x5\_KHR"{}};}
\DoxyCodeLine{12201\ \ \ \textcolor{keywordflow}{case}\ 0x93D9:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_10x6\_KHR"{}};}
\DoxyCodeLine{12202\ \ \ \textcolor{keywordflow}{case}\ 0x93DA:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_10x8\_KHR"{}};}
\DoxyCodeLine{12203\ \ \ \textcolor{keywordflow}{case}\ 0x93DB:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_10x10\_KHR"{}};}
\DoxyCodeLine{12204\ \ \ \textcolor{keywordflow}{case}\ 0x93DC:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_12x10\_KHR"{}};}
\DoxyCodeLine{12205\ \ \ \textcolor{keywordflow}{case}\ 0x93DD:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_12x12\_KHR"{}};}
\DoxyCodeLine{12206\ \ \ \textcolor{keywordflow}{case}\ 0x93E0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_3x3x3\_OES"{}};}
\DoxyCodeLine{12207\ \ \ \textcolor{keywordflow}{case}\ 0x93E1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_4x3x3\_OES"{}};}
\DoxyCodeLine{12208\ \ \ \textcolor{keywordflow}{case}\ 0x93E2:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_4x4x3\_OES"{}};}
\DoxyCodeLine{12209\ \ \ \textcolor{keywordflow}{case}\ 0x93E3:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_4x4x4\_OES"{}};}
\DoxyCodeLine{12210\ \ \ \textcolor{keywordflow}{case}\ 0x93E4:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_5x4x4\_OES"{}};}
\DoxyCodeLine{12211\ \ \ \textcolor{keywordflow}{case}\ 0x93E5:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_5x5x4\_OES"{}};}
\DoxyCodeLine{12212\ \ \ \textcolor{keywordflow}{case}\ 0x93E6:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_5x5x5\_OES"{}};}
\DoxyCodeLine{12213\ \ \ \textcolor{keywordflow}{case}\ 0x93E7:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_6x5x5\_OES"{}};}
\DoxyCodeLine{12214\ \ \ \textcolor{keywordflow}{case}\ 0x93E8:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_6x6x5\_OES"{}};}
\DoxyCodeLine{12215\ \ \ \textcolor{keywordflow}{case}\ 0x93E9:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB8\_ALPHA8\_ASTC\_6x6x6\_OES"{}};}
\DoxyCodeLine{12216\ \ \ \textcolor{keywordflow}{case}\ 0x93F0:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_2BPPV2\_IMG"{}};}
\DoxyCodeLine{12217\ \ \ \textcolor{keywordflow}{case}\ 0x93F1:\ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}GL\_COMPRESSED\_SRGB\_ALPHA\_PVRTC\_4BPPV2\_IMG"{}};}
\DoxyCodeLine{12218\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{12219\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{12220\ \ \ \}}
\DoxyCodeLine{12221\ \}}
\DoxyCodeLine{12222\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12223\ }
\DoxyCodeLine{12229\ LVecBase4\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12230\ get\_light\_color(\mbox{\hyperlink{classLight}{Light}}\ *light)\ const\ \{}
\DoxyCodeLine{12231\ \#ifndef\ NDEBUG}
\DoxyCodeLine{12232\ \ \ if\ (\_show\_texture\_usage)\ \{}
\DoxyCodeLine{12233\ \ \ \ \ \textcolor{comment}{//\ In\ show\_texture\_usage\ mode,\ all\ lights\ are\ white,\ so\ as\ not\ to}}
\DoxyCodeLine{12234\ \ \ \ \ \textcolor{comment}{//\ contaminate\ the\ texture\ color.}}
\DoxyCodeLine{12235\ \ \ \ \ \textcolor{keywordflow}{return}\ LVecBase4(1.0,\ 1.0,\ 1.0,\ 1.0);}
\DoxyCodeLine{12236\ \ \ \}}
\DoxyCodeLine{12237\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{12238\ }
\DoxyCodeLine{12239\ \ \ \textcolor{keyword}{const}\ LColor\ \&c\ =\ light-\/>get\_color();}
\DoxyCodeLine{12240\ }
\DoxyCodeLine{12241\ \ \ LVecBase4\ light\_color(c[0]\ *\ \_light\_color\_scale[0],}
\DoxyCodeLine{12242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[1]\ *\ \_light\_color\_scale[1],}
\DoxyCodeLine{12243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[2]\ *\ \_light\_color\_scale[2],}
\DoxyCodeLine{12244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ c[3]\ *\ \_light\_color\_scale[3]);}
\DoxyCodeLine{12245\ \ \ \textcolor{keywordflow}{return}\ light\_color;}
\DoxyCodeLine{12246\ \}}
\DoxyCodeLine{12247\ }
\DoxyCodeLine{12248\ }
\DoxyCodeLine{12254\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12255\ reissue\_transforms()\ \{}
\DoxyCodeLine{12256\ \ \ prepare\_lens();}
\DoxyCodeLine{12257\ \ \ do\_issue\_transform();}
\DoxyCodeLine{12258\ }
\DoxyCodeLine{12259\ \ \ \_active\_texture\_stage\ =\ -\/1;}
\DoxyCodeLine{12260\ }
\DoxyCodeLine{12261\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{12262\ \ \ \textcolor{comment}{//\ Might\ also\ want\ to\ reissue\ the\ vertex\ format,\ for\ good\ measure.}}
\DoxyCodeLine{12263\ \ \ \_current\_vertex\_format.clear();}
\DoxyCodeLine{12264\ \ \ memset(\_vertex\_attrib\_columns,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomVertexColumn}{GeomVertexColumn}}\ *)\ *\ 32);}
\DoxyCodeLine{12265\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12266\ }
\DoxyCodeLine{12267\ \ \ \textcolor{comment}{//\ Some\ libraries\ (Kivy)\ leave\ their\ buffers\ bound.\ \ How\ clumsy\ of\ them.}}
\DoxyCodeLine{12268\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffers)\ \{}
\DoxyCodeLine{12269\ \ \ \ \ \_glBindBuffer(GL\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{12270\ \ \ \ \ \_glBindBuffer(GL\_ELEMENT\_ARRAY\_BUFFER,\ 0);}
\DoxyCodeLine{12271\ \ \ \ \ \_current\_vbuffer\_index\ =\ 0;}
\DoxyCodeLine{12272\ \ \ \ \ \_current\_ibuffer\_index\ =\ 0;}
\DoxyCodeLine{12273\ \ \ \}}
\DoxyCodeLine{12274\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{12275\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_glsl)\ \{}
\DoxyCodeLine{12276\ \ \ \ \ \_glDisableVertexAttribArray(0);}
\DoxyCodeLine{12277\ \ \ \ \ \_glDisableVertexAttribArray(1);}
\DoxyCodeLine{12278\ \ \ \}}
\DoxyCodeLine{12279\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12280\ }
\DoxyCodeLine{12281\ \ \ \textcolor{comment}{//\ Since\ this\ is\ called\ by\ clear\_state\_and\_transform(),\ we\ also\ should\ reset}}
\DoxyCodeLine{12282\ \ \ \textcolor{comment}{//\ the\ states\ that\ won't\ automatically\ be\ respecified\ when\ clearing\ the}}
\DoxyCodeLine{12283\ \ \ \textcolor{comment}{//\ state\ mask.}}
\DoxyCodeLine{12284\ \ \ \_active\_color\_write\_mask\ =\ ColorWriteAttrib::C\_all;}
\DoxyCodeLine{12285\ \ \ glColorMask(GL\_TRUE,\ GL\_TRUE,\ GL\_TRUE,\ GL\_TRUE);}
\DoxyCodeLine{12286\ }
\DoxyCodeLine{12287\ \ \ \textcolor{keywordflow}{if}\ (\_dithering\_enabled)\ \{}
\DoxyCodeLine{12288\ \ \ \ \ glEnable(GL\_DITHER);}
\DoxyCodeLine{12289\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12290\ \ \ \ \ glDisable(GL\_DITHER);}
\DoxyCodeLine{12291\ \ \ \}}
\DoxyCodeLine{12292\ \ \ \textcolor{keywordflow}{if}\ (\_depth\_test\_enabled)\ \{}
\DoxyCodeLine{12293\ \ \ \ \ glEnable(GL\_DEPTH\_TEST);}
\DoxyCodeLine{12294\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12295\ \ \ \ \ glDisable(GL\_DEPTH\_TEST);}
\DoxyCodeLine{12296\ \ \ \}}
\DoxyCodeLine{12297\ \ \ \textcolor{keywordflow}{if}\ (\_stencil\_test\_enabled)\ \{}
\DoxyCodeLine{12298\ \ \ \ \ glEnable(GL\_STENCIL\_TEST);}
\DoxyCodeLine{12299\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12300\ \ \ \ \ glDisable(GL\_STENCIL\_TEST);}
\DoxyCodeLine{12301\ \ \ \}}
\DoxyCodeLine{12302\ \ \ \textcolor{keywordflow}{if}\ (\_blend\_enabled)\ \{}
\DoxyCodeLine{12303\ \ \ \ \ glEnable(GL\_BLEND);}
\DoxyCodeLine{12304\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12305\ \ \ \ \ glDisable(GL\_BLEND);}
\DoxyCodeLine{12306\ \ \ \}}
\DoxyCodeLine{12307\ }
\DoxyCodeLine{12308\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{12309\ \ \ \textcolor{keywordflow}{if}\ (\_multisample\_mode\ !=\ 0)\ \{}
\DoxyCodeLine{12310\ \ \ \ \ glEnable(GL\_MULTISAMPLE);}
\DoxyCodeLine{12311\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12312\ \ \ \ \ glDisable(GL\_MULTISAMPLE);}
\DoxyCodeLine{12313\ \ \ \ \ glDisable(GL\_SAMPLE\_ALPHA\_TO\_ONE);}
\DoxyCodeLine{12314\ \ \ \ \ glDisable(GL\_SAMPLE\_ALPHA\_TO\_COVERAGE);}
\DoxyCodeLine{12315\ \ \ \}}
\DoxyCodeLine{12316\ \ \ \textcolor{keywordflow}{if}\ (\_line\_smooth\_enabled)\ \{}
\DoxyCodeLine{12317\ \ \ \ \ glEnable(GL\_LINE\_SMOOTH);}
\DoxyCodeLine{12318\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12319\ \ \ \ \ glDisable(GL\_LINE\_SMOOTH);}
\DoxyCodeLine{12320\ \ \ \}}
\DoxyCodeLine{12321\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12322\ }
\DoxyCodeLine{12323\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{12324\ \ \ \textcolor{keywordflow}{if}\ (\_polygon\_smooth\_enabled)\ \{}
\DoxyCodeLine{12325\ \ \ \ \ glEnable(GL\_POLYGON\_SMOOTH);}
\DoxyCodeLine{12326\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12327\ \ \ \ \ glDisable(GL\_POLYGON\_SMOOTH);}
\DoxyCodeLine{12328\ \ \ \}}
\DoxyCodeLine{12329\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12330\ }
\DoxyCodeLine{12331\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12332\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12333\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_alpha\_test\_enabled)\ \{}
\DoxyCodeLine{12334\ \ \ \ \ \ \ glEnable(GL\_ALPHA\_TEST);}
\DoxyCodeLine{12335\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12336\ \ \ \ \ \ \ glDisable(GL\_ALPHA\_TEST);}
\DoxyCodeLine{12337\ \ \ \ \ \}}
\DoxyCodeLine{12338\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_point\_smooth\_enabled)\ \{}
\DoxyCodeLine{12339\ \ \ \ \ \ \ glEnable(GL\_POINT\_SMOOTH);}
\DoxyCodeLine{12340\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12341\ \ \ \ \ \ \ glDisable(GL\_POINT\_SMOOTH);}
\DoxyCodeLine{12342\ \ \ \ \ \}}
\DoxyCodeLine{12343\ \ \ \}}
\DoxyCodeLine{12344\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12345\ \}}
\DoxyCodeLine{12346\ }
\DoxyCodeLine{12347\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12353\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12354\ enable\_lighting(bool\ enable)\ \{}
\DoxyCodeLine{12355\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12356\ }
\DoxyCodeLine{12357\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{12358\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_enable\_lighting\_pcollector("{}Draw:Set}}
\DoxyCodeLine{12359\ \ \ \textcolor{comment}{//\ State:Light:Enable\ lighting"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{12360\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_enable\_lighting\_pcollector);}}
\DoxyCodeLine{12361\ }
\DoxyCodeLine{12362\ \ \ \textcolor{keywordflow}{if}\ (enable)\ \{}
\DoxyCodeLine{12363\ \ \ \ \ glEnable(GL\_LIGHTING);}
\DoxyCodeLine{12364\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12365\ \ \ \ \ glDisable(GL\_LIGHTING);}
\DoxyCodeLine{12366\ \ \ \}}
\DoxyCodeLine{12367\ \}}
\DoxyCodeLine{12368\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12369\ }
\DoxyCodeLine{12370\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12376\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12377\ set\_ambient\_light(const\ LColor\ \&\mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{12378\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12379\ }
\DoxyCodeLine{12380\ \ \ \textcolor{comment}{//\ static\ PStatCollector\ \_draw\_set\_state\_light\_ambient\_pcollector("{}Draw:Set}}
\DoxyCodeLine{12381\ \ \ \textcolor{comment}{//\ State:Light:Ambient"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{12382\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_ambient\_pcollector);}}
\DoxyCodeLine{12383\ }
\DoxyCodeLine{12384\ \ \ LColor\ c\ =\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{12385\ \ \ c.set(c[0]\ *\ \_light\_color\_scale[0],}
\DoxyCodeLine{12386\ \ \ \ \ \ \ \ \ c[1]\ *\ \_light\_color\_scale[1],}
\DoxyCodeLine{12387\ \ \ \ \ \ \ \ \ c[2]\ *\ \_light\_color\_scale[2],}
\DoxyCodeLine{12388\ \ \ \ \ \ \ \ \ c[3]\ *\ \_light\_color\_scale[3]);}
\DoxyCodeLine{12389\ \ \ call\_glLightModelfv(GL\_LIGHT\_MODEL\_AMBIENT,\ c);}
\DoxyCodeLine{12390\ \}}
\DoxyCodeLine{12391\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12392\ }
\DoxyCodeLine{12393\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12399\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12400\ enable\_light(int\ light\_id,\ bool\ enable)\ \{}
\DoxyCodeLine{12401\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12402\ }
\DoxyCodeLine{12403\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{12404\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_enable\_light\_pcollector("{}Draw:Set}}
\DoxyCodeLine{12405\ \ \ \textcolor{comment}{//\ State:Light:Enable\ light"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{12406\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_enable\_light\_pcollector);}}
\DoxyCodeLine{12407\ }
\DoxyCodeLine{12408\ \ \ \textcolor{keywordflow}{if}\ (enable)\ \{}
\DoxyCodeLine{12409\ \ \ \ \ glEnable(get\_light\_id(light\_id));}
\DoxyCodeLine{12410\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12411\ \ \ \ \ glDisable(get\_light\_id(light\_id));}
\DoxyCodeLine{12412\ \ \ \}}
\DoxyCodeLine{12413\ \}}
\DoxyCodeLine{12414\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12415\ }
\DoxyCodeLine{12416\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12425\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12426\ begin\_bind\_lights()\ \{}
\DoxyCodeLine{12427\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12428\ }
\DoxyCodeLine{12429\ \ \ \textcolor{comment}{//\ static\ PStatCollector}}
\DoxyCodeLine{12430\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_begin\_bind\_pcollector("{}Draw:Set\ State:Light:Begin}}
\DoxyCodeLine{12431\ \ \ \textcolor{comment}{//\ bind"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{12432\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_begin\_bind\_pcollector);}}
\DoxyCodeLine{12433\ }
\DoxyCodeLine{12434\ \ \ \textcolor{comment}{//\ We\ need\ to\ temporarily\ load\ a\ new\ matrix\ so\ we\ can\ define\ the\ light\ in\ a}}
\DoxyCodeLine{12435\ \ \ \textcolor{comment}{//\ known\ coordinate\ system.\ \ We\ pick\ the\ transform\ of\ the\ root.}}
\DoxyCodeLine{12436\ \ \ \textcolor{comment}{//\ (Alternatively,\ we\ could\ leave\ the\ current\ transform\ where\ it\ is\ and}}
\DoxyCodeLine{12437\ \ \ \textcolor{comment}{//\ compute\ the\ light\ position\ relative\ to\ that\ transform\ instead\ of\ relative}}
\DoxyCodeLine{12438\ \ \ \textcolor{comment}{//\ to\ the\ root,\ by\ composing\ with\ the\ matrix\ computed\ by}}
\DoxyCodeLine{12439\ \ \ \textcolor{comment}{//\ \_internal\_transform-\/>invert\_compose(render\_transform).\ But\ I\ think}}
\DoxyCodeLine{12440\ \ \ \textcolor{comment}{//\ loading\ a\ completely\ new\ matrix\ is\ simpler.)}}
\DoxyCodeLine{12441\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ render\_transform\ =}
\DoxyCodeLine{12442\ \ \ \ \ \_cs\_transform-\/>compose(\_scene\_setup-\/>get\_world\_transform());}
\DoxyCodeLine{12443\ }
\DoxyCodeLine{12444\ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{12445\ \ \ glPushMatrix();}
\DoxyCodeLine{12446\ \ \ call\_glLoadMatrix(render\_transform-\/>get\_mat());}
\DoxyCodeLine{12447\ \}}
\DoxyCodeLine{12448\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12449\ }
\DoxyCodeLine{12450\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12457\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12458\ end\_bind\_lights()\ \{}
\DoxyCodeLine{12459\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12460\ }
\DoxyCodeLine{12461\ \ \ \textcolor{comment}{//\ static\ PStatCollector\ \_draw\_set\_state\_light\_end\_bind\_pcollector("{}Draw:Set}}
\DoxyCodeLine{12462\ \ \ \textcolor{comment}{//\ State:Light:End\ bind"{});\ PStatGPUTimer\ timer(this,}}
\DoxyCodeLine{12463\ \ \ \textcolor{comment}{//\ \_draw\_set\_state\_light\_end\_bind\_pcollector);}}
\DoxyCodeLine{12464\ }
\DoxyCodeLine{12465\ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{12466\ \ \ glPopMatrix();}
\DoxyCodeLine{12467\ \}}
\DoxyCodeLine{12468\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12469\ }
\DoxyCodeLine{12470\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12476\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12477\ enable\_clip\_plane(int\ plane\_id,\ bool\ enable)\ \{}
\DoxyCodeLine{12478\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12479\ }
\DoxyCodeLine{12480\ \ \ \textcolor{keywordflow}{if}\ (enable)\ \{}
\DoxyCodeLine{12481\ \ \ \ \ glEnable(get\_clip\_plane\_id(plane\_id));}
\DoxyCodeLine{12482\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12483\ \ \ \ \ glDisable(get\_clip\_plane\_id(plane\_id));}
\DoxyCodeLine{12484\ \ \ \}}
\DoxyCodeLine{12485\ \}}
\DoxyCodeLine{12486\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12487\ }
\DoxyCodeLine{12488\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12497\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12498\ begin\_bind\_clip\_planes()\ \{}
\DoxyCodeLine{12499\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12500\ }
\DoxyCodeLine{12501\ \ \ \textcolor{comment}{//\ We\ need\ to\ temporarily\ load\ a\ new\ matrix\ so\ we\ can\ define\ the\ clip\_plane}}
\DoxyCodeLine{12502\ \ \ \textcolor{comment}{//\ in\ a\ known\ coordinate\ system.\ \ We\ pick\ the\ transform\ of\ the\ root.}}
\DoxyCodeLine{12503\ \ \ \textcolor{comment}{//\ (Alternatively,\ we\ could\ leave\ the\ current\ transform\ where\ it\ is\ and}}
\DoxyCodeLine{12504\ \ \ \textcolor{comment}{//\ compute\ the\ clip\_plane\ position\ relative\ to\ that\ transform\ instead\ of}}
\DoxyCodeLine{12505\ \ \ \textcolor{comment}{//\ relative\ to\ the\ root,\ by\ composing\ with\ the\ matrix\ computed\ by}}
\DoxyCodeLine{12506\ \ \ \textcolor{comment}{//\ \_internal\_transform-\/>invert\_compose(render\_transform).\ But\ I\ think}}
\DoxyCodeLine{12507\ \ \ \textcolor{comment}{//\ loading\ a\ completely\ new\ matrix\ is\ simpler.)}}
\DoxyCodeLine{12508\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ render\_transform\ =}
\DoxyCodeLine{12509\ \ \ \ \ \_cs\_transform-\/>compose(\_scene\_setup-\/>get\_world\_transform());}
\DoxyCodeLine{12510\ }
\DoxyCodeLine{12511\ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{12512\ \ \ glPushMatrix();}
\DoxyCodeLine{12513\ \ \ call\_glLoadMatrix(render\_transform-\/>get\_mat());}
\DoxyCodeLine{12514\ \}}
\DoxyCodeLine{12515\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12516\ }
\DoxyCodeLine{12517\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12523\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12524\ bind\_clip\_plane(const\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&plane,\ int\ plane\_id)\ \{}
\DoxyCodeLine{12525\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12526\ }
\DoxyCodeLine{12527\ \ \ GLenum\ \textcolor{keywordtype}{id}\ =\ get\_clip\_plane\_id(plane\_id);}
\DoxyCodeLine{12528\ }
\DoxyCodeLine{12529\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ transform\ =\ plane.get\_transform(\_scene\_setup-\/>get\_scene\_root().get\_parent());}
\DoxyCodeLine{12530\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPlaneNode}{PlaneNode}}\ *plane\_node;}
\DoxyCodeLine{12531\ \ \ DCAST\_INTO\_V(plane\_node,\ plane.node());}
\DoxyCodeLine{12532\ \ \ LPlane\ xformed\_plane\ =\ plane\_node-\/>get\_plane()\ *\ transform-\/>get\_mat();}
\DoxyCodeLine{12533\ }
\DoxyCodeLine{12534\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{12535\ \ \ \textcolor{comment}{//\ OpenGL\ ES\ uses\ a\ single-\/precision\ call.}}
\DoxyCodeLine{12536\ \ \ LPlanef\ single\_plane(LCAST(\textcolor{keywordtype}{float},\ xformed\_plane));}
\DoxyCodeLine{12537\ \ \ glClipPlanef(\textcolor{keywordtype}{id},\ single\_plane.get\_data());}
\DoxyCodeLine{12538\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12539\ \ \ \textcolor{comment}{//\ Mainline\ OpenGL\ uses\ a\ double-\/precision\ call.}}
\DoxyCodeLine{12540\ \ \ LPlaned\ double\_plane(LCAST(\textcolor{keywordtype}{double},\ xformed\_plane));}
\DoxyCodeLine{12541\ \ \ glClipPlane(\textcolor{keywordtype}{id},\ double\_plane.get\_data());}
\DoxyCodeLine{12542\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{12543\ }
\DoxyCodeLine{12544\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{12545\ \}}
\DoxyCodeLine{12546\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12547\ }
\DoxyCodeLine{12548\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12555\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12556\ end\_bind\_clip\_planes()\ \{}
\DoxyCodeLine{12557\ \ \ nassertv(has\_fixed\_function\_pipeline());}
\DoxyCodeLine{12558\ }
\DoxyCodeLine{12559\ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{12560\ \ \ glPopMatrix();}
\DoxyCodeLine{12561\ \}}
\DoxyCodeLine{12562\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12563\ }
\DoxyCodeLine{12576\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12577\ set\_state\_and\_transform(const\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *target,}
\DoxyCodeLine{12578\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *transform)\ \{}
\DoxyCodeLine{12579\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{12580\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{12581\ \ \ \textcolor{keywordflow}{if}\ (gsg\_cat.is\_spam())\ \{}
\DoxyCodeLine{12582\ \ \ \ \ gsg\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}Setting\ GSG\ state\ to\ "{}}\ <<\ (\textcolor{keywordtype}{void}\ *)target\ <<\ \textcolor{stringliteral}{"{}:\(\backslash\)n"{}};}
\DoxyCodeLine{12583\ \ \ \ \ target-\/>write(gsg\_cat.spam(\textcolor{keyword}{false}),\ 2);}
\DoxyCodeLine{12584\ \ \ \}}
\DoxyCodeLine{12585\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12586\ }
\DoxyCodeLine{12587\ \ \ \_state\_pcollector.add\_level(1);}
\DoxyCodeLine{12588\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer1(\_draw\_set\_state\_pcollector);}
\DoxyCodeLine{12589\ }
\DoxyCodeLine{12590\ \ \ \textcolor{keywordtype}{bool}\ transform\_changed\ =\ transform\ !=\ \_internal\_transform;}
\DoxyCodeLine{12591\ \ \ \textcolor{keywordflow}{if}\ (transform\_changed)\ \{}
\DoxyCodeLine{12592\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_transform\_pcollector);}}
\DoxyCodeLine{12593\ \ \ \ \ \_transform\_state\_pcollector.add\_level(1);}
\DoxyCodeLine{12594\ \ \ \ \ \_internal\_transform\ =\ transform;}
\DoxyCodeLine{12595\ \ \ \ \ do\_issue\_transform();}
\DoxyCodeLine{12596\ \ \ \}}
\DoxyCodeLine{12597\ }
\DoxyCodeLine{12598\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ \_state\_rs\ \&\&\ (\_state\_mask\ |\ \_inv\_state\_mask).is\_all\_on())\ \{}
\DoxyCodeLine{12599\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{12600\ \ \ \ \ \textcolor{keywordflow}{if}\ (transform\_changed)\ \{}
\DoxyCodeLine{12601\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ state\ has\ not\ changed,\ but\ the\ transform\ has.\ Set\ the\ new}}
\DoxyCodeLine{12602\ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ on\ the\ shader,\ if\ we\ have\ one.}}
\DoxyCodeLine{12603\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{12604\ \ \ \ \ \ \ \ \ \_current\_shader\_context-\/>set\_state\_and\_transform(\_state\_rs,\ transform,}
\DoxyCodeLine{12605\ \ \ \ \ \ \ \ \ \ \ \_scene\_setup-\/>get\_camera\_transform(),\ \_projection\_mat);}
\DoxyCodeLine{12606\ \ \ \ \ \ \ \}}
\DoxyCodeLine{12607\ \ \ \ \ \}}
\DoxyCodeLine{12608\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12609\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{12610\ \ \ \}}
\DoxyCodeLine{12611\ \ \ \_target\_rs\ =\ target;}
\DoxyCodeLine{12612\ }
\DoxyCodeLine{12613\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{12614\ \ \ determine\_target\_shader();}
\DoxyCodeLine{12615\ \ \ \_sattr\_instance\_count\ =\ \_target\_shader-\/>get\_instance\_count();}
\DoxyCodeLine{12616\ }
\DoxyCodeLine{12617\ \ \ \textcolor{keywordflow}{if}\ (\_target\_shader\ !=\ \_state\_shader)\ \{}
\DoxyCodeLine{12618\ \ \ \ \ do\_issue\_shader();}
\DoxyCodeLine{12619\ \ \ \ \ \_state\_shader\ =\ \_target\_shader;}
\DoxyCodeLine{12620\ \ \ \ \ \_state\_mask.clear\_bit(TextureAttrib::get\_class\_slot());}
\DoxyCodeLine{12621\ \ \ \ \ \_state\_mask.set\_bit(ShaderAttrib::get\_class\_slot());}
\DoxyCodeLine{12622\ \ \ \}}
\DoxyCodeLine{12623\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!has\_fixed\_function\_pipeline()\ \&\&\ \_current\_shader\ ==\ \textcolor{keyword}{nullptr})\ \{\ \textcolor{comment}{//\ In\ the\ case\ of\ OpenGL\ ES\ 2.x,\ we\ need\ to\ glUseShader\ before\ we\ draw\ anything.}}
\DoxyCodeLine{12624\ \ \ \ \ do\_issue\_shader();}
\DoxyCodeLine{12625\ \ \ \ \ \_state\_mask.clear\_bit(TextureAttrib::get\_class\_slot());}
\DoxyCodeLine{12626\ \ \ \ \ \_state\_mask.set\_bit(ShaderAttrib::get\_class\_slot());}
\DoxyCodeLine{12627\ \ \ \}}
\DoxyCodeLine{12628\ }
\DoxyCodeLine{12629\ \ \ \textcolor{comment}{//\ Update\ all\ of\ the\ state\ that\ is\ bound\ to\ the\ shader\ program.}}
\DoxyCodeLine{12630\ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{12631\ \ \ \ \ \_current\_shader\_context-\/>set\_state\_and\_transform(target,\ transform,\ \_scene\_setup-\/>get\_camera\_transform(),\ \_projection\_mat);}
\DoxyCodeLine{12632\ \ \ \}}
\DoxyCodeLine{12633\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12634\ }
\DoxyCodeLine{12635\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12636\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12637\ \ \ \ \ \textcolor{keywordtype}{int}\ alpha\_test\_slot\ =\ AlphaTestAttrib::get\_class\_slot();}
\DoxyCodeLine{12638\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(alpha\_test\_slot)\ !=\ \_state\_rs-\/>get\_attrib(alpha\_test\_slot)\ ||}
\DoxyCodeLine{12639\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(alpha\_test\_slot)}
\DoxyCodeLine{12640\ \#ifndef\ OPENGLES\_1}
\DoxyCodeLine{12641\ \ \ \ \ \ \ \ \ ||\ (\_target\_shader-\/>get\_flag(ShaderAttrib::F\_subsume\_alpha\_test)\ !=}
\DoxyCodeLine{12642\ \ \ \ \ \ \ \ \ \ \ \ \ \_state\_shader-\/>get\_flag(ShaderAttrib::F\_subsume\_alpha\_test))}
\DoxyCodeLine{12643\ \#endif}
\DoxyCodeLine{12644\ \ \ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{12645\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_alpha\_test\_pcollector);}}
\DoxyCodeLine{12646\ \ \ \ \ \ \ do\_issue\_alpha\_test();}
\DoxyCodeLine{12647\ \ \ \ \ \ \ \_state\_mask.set\_bit(alpha\_test\_slot);}
\DoxyCodeLine{12648\ \ \ \ \ \}}
\DoxyCodeLine{12649\ \ \ \}}
\DoxyCodeLine{12650\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12651\ }
\DoxyCodeLine{12652\ \ \ \textcolor{keywordtype}{int}\ antialias\_slot\ =\ AntialiasAttrib::get\_class\_slot();}
\DoxyCodeLine{12653\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(antialias\_slot)\ !=\ \_state\_rs-\/>get\_attrib(antialias\_slot)\ ||}
\DoxyCodeLine{12654\ \ \ \ \ \ \ !\_state\_mask.get\_bit(antialias\_slot))\ \{}
\DoxyCodeLine{12655\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_antialias\_pcollector);}}
\DoxyCodeLine{12656\ \ \ \ \ do\_issue\_antialias();}
\DoxyCodeLine{12657\ \ \ \ \ \_state\_mask.set\_bit(antialias\_slot);}
\DoxyCodeLine{12658\ \ \ \}}
\DoxyCodeLine{12659\ }
\DoxyCodeLine{12660\ \ \ \textcolor{keywordtype}{int}\ clip\_plane\_slot\ =\ ClipPlaneAttrib::get\_class\_slot();}
\DoxyCodeLine{12661\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(clip\_plane\_slot)\ !=\ \_state\_rs-\/>get\_attrib(clip\_plane\_slot)\ ||}
\DoxyCodeLine{12662\ \ \ \ \ \ \ !\_state\_mask.get\_bit(clip\_plane\_slot))\ \{}
\DoxyCodeLine{12663\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_clip\_plane\_pcollector);}}
\DoxyCodeLine{12664\ \ \ \ \ do\_issue\_clip\_plane();}
\DoxyCodeLine{12665\ \ \ \ \ \_state\_mask.set\_bit(clip\_plane\_slot);}
\DoxyCodeLine{12666\ \ \ \}}
\DoxyCodeLine{12667\ }
\DoxyCodeLine{12668\ \ \ \textcolor{keywordtype}{int}\ color\_slot\ =\ ColorAttrib::get\_class\_slot();}
\DoxyCodeLine{12669\ \ \ \textcolor{keywordtype}{int}\ color\_scale\_slot\ =\ ColorScaleAttrib::get\_class\_slot();}
\DoxyCodeLine{12670\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(color\_slot)\ !=\ \_state\_rs-\/>get\_attrib(color\_slot)\ ||}
\DoxyCodeLine{12671\ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib(color\_scale\_slot)\ !=\ \_state\_rs-\/>get\_attrib(color\_scale\_slot)\ ||}
\DoxyCodeLine{12672\ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_slot)\ ||}
\DoxyCodeLine{12673\ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_scale\_slot))\ \{}
\DoxyCodeLine{12674\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_color\_pcollector);}}
\DoxyCodeLine{12675\ \ \ \ \ do\_issue\_color();}
\DoxyCodeLine{12676\ \ \ \ \ do\_issue\_color\_scale();}
\DoxyCodeLine{12677\ \ \ \ \ \_state\_mask.set\_bit(color\_slot);}
\DoxyCodeLine{12678\ \ \ \ \ \_state\_mask.set\_bit(color\_scale\_slot);}
\DoxyCodeLine{12679\ \ \ \}}
\DoxyCodeLine{12680\ }
\DoxyCodeLine{12681\ \ \ \textcolor{keywordtype}{int}\ cull\_face\_slot\ =\ CullFaceAttrib::get\_class\_slot();}
\DoxyCodeLine{12682\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(cull\_face\_slot)\ !=\ \_state\_rs-\/>get\_attrib(cull\_face\_slot)\ ||}
\DoxyCodeLine{12683\ \ \ \ \ \ \ !\_state\_mask.get\_bit(cull\_face\_slot))\ \{}
\DoxyCodeLine{12684\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_cull\_face\_pcollector);}}
\DoxyCodeLine{12685\ \ \ \ \ do\_issue\_cull\_face();}
\DoxyCodeLine{12686\ \ \ \ \ \_state\_mask.set\_bit(cull\_face\_slot);}
\DoxyCodeLine{12687\ \ \ \}}
\DoxyCodeLine{12688\ }
\DoxyCodeLine{12689\ \ \ \textcolor{keywordtype}{int}\ depth\_bias\_slot\ =\ DepthBiasAttrib::get\_class\_slot();}
\DoxyCodeLine{12690\ \ \ \textcolor{keywordtype}{int}\ depth\_offset\_slot\ =\ DepthOffsetAttrib::get\_class\_slot();}
\DoxyCodeLine{12691\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(depth\_bias\_slot)\ !=\ \_state\_rs-\/>get\_attrib(depth\_bias\_slot)\ ||}
\DoxyCodeLine{12692\ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib(depth\_offset\_slot)\ !=\ \_state\_rs-\/>get\_attrib(depth\_offset\_slot)\ ||}
\DoxyCodeLine{12693\ \ \ \ \ \ \ !\_state\_mask.get\_bit(depth\_bias\_slot)\ ||}
\DoxyCodeLine{12694\ \ \ \ \ \ \ !\_state\_mask.get\_bit(depth\_offset\_slot))\ \{}
\DoxyCodeLine{12695\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_depth\_offset\_pcollector);}}
\DoxyCodeLine{12696\ \ \ \ \ do\_issue\_depth\_bias();}
\DoxyCodeLine{12697\ \ \ \ \ \_state\_mask.set\_bit(depth\_bias\_slot);}
\DoxyCodeLine{12698\ \ \ \ \ \_state\_mask.set\_bit(depth\_offset\_slot);}
\DoxyCodeLine{12699\ \ \ \}}
\DoxyCodeLine{12700\ }
\DoxyCodeLine{12701\ \ \ \textcolor{keywordtype}{int}\ depth\_test\_slot\ =\ DepthTestAttrib::get\_class\_slot();}
\DoxyCodeLine{12702\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(depth\_test\_slot)\ !=\ \_state\_rs-\/>get\_attrib(depth\_test\_slot)\ ||}
\DoxyCodeLine{12703\ \ \ \ \ \ \ !\_state\_mask.get\_bit(depth\_test\_slot))\ \{}
\DoxyCodeLine{12704\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_depth\_test\_pcollector);}}
\DoxyCodeLine{12705\ \ \ \ \ do\_issue\_depth\_test();}
\DoxyCodeLine{12706\ \ \ \ \ \_state\_mask.set\_bit(depth\_test\_slot);}
\DoxyCodeLine{12707\ \ \ \}}
\DoxyCodeLine{12708\ }
\DoxyCodeLine{12709\ \ \ \textcolor{keywordtype}{int}\ depth\_write\_slot\ =\ DepthWriteAttrib::get\_class\_slot();}
\DoxyCodeLine{12710\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(depth\_write\_slot)\ !=\ \_state\_rs-\/>get\_attrib(depth\_write\_slot)\ ||}
\DoxyCodeLine{12711\ \ \ \ \ \ \ !\_state\_mask.get\_bit(depth\_write\_slot))\ \{}
\DoxyCodeLine{12712\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_depth\_write\_pcollector);}}
\DoxyCodeLine{12713\ \ \ \ \ do\_issue\_depth\_write();}
\DoxyCodeLine{12714\ \ \ \ \ \_state\_mask.set\_bit(depth\_write\_slot);}
\DoxyCodeLine{12715\ \ \ \}}
\DoxyCodeLine{12716\ }
\DoxyCodeLine{12717\ \ \ \textcolor{keywordtype}{int}\ render\_mode\_slot\ =\ RenderModeAttrib::get\_class\_slot();}
\DoxyCodeLine{12718\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(render\_mode\_slot)\ !=\ \_state\_rs-\/>get\_attrib(render\_mode\_slot)\ ||}
\DoxyCodeLine{12719\ \ \ \ \ \ \ !\_state\_mask.get\_bit(render\_mode\_slot))\ \{}
\DoxyCodeLine{12720\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_render\_mode\_pcollector);}}
\DoxyCodeLine{12721\ \ \ \ \ do\_issue\_render\_mode();}
\DoxyCodeLine{12722\ \ \ \ \ \_state\_mask.set\_bit(render\_mode\_slot);}
\DoxyCodeLine{12723\ \ \ \}}
\DoxyCodeLine{12724\ }
\DoxyCodeLine{12725\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12726\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12727\ \ \ \ \ \textcolor{keywordtype}{int}\ rescale\_normal\_slot\ =\ RescaleNormalAttrib::get\_class\_slot();}
\DoxyCodeLine{12728\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(rescale\_normal\_slot)\ !=\ \_state\_rs-\/>get\_attrib(rescale\_normal\_slot)\ ||}
\DoxyCodeLine{12729\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(rescale\_normal\_slot))\ \{}
\DoxyCodeLine{12730\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_rescale\_normal\_pcollector);}}
\DoxyCodeLine{12731\ \ \ \ \ \ \ do\_issue\_rescale\_normal();}
\DoxyCodeLine{12732\ \ \ \ \ \ \ \_state\_mask.set\_bit(rescale\_normal\_slot);}
\DoxyCodeLine{12733\ \ \ \ \ \}}
\DoxyCodeLine{12734\ }
\DoxyCodeLine{12735\ \ \ \ \ \textcolor{keywordtype}{int}\ shade\_model\_slot\ =\ ShadeModelAttrib::get\_class\_slot();}
\DoxyCodeLine{12736\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(shade\_model\_slot)\ !=\ \_state\_rs-\/>get\_attrib(shade\_model\_slot)\ ||}
\DoxyCodeLine{12737\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(shade\_model\_slot))\ \{}
\DoxyCodeLine{12738\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_shade\_model\_pcollector);}}
\DoxyCodeLine{12739\ \ \ \ \ \ \ do\_issue\_shade\_model();}
\DoxyCodeLine{12740\ \ \ \ \ \ \ \_state\_mask.set\_bit(shade\_model\_slot);}
\DoxyCodeLine{12741\ \ \ \ \ \}}
\DoxyCodeLine{12742\ \ \ \}}
\DoxyCodeLine{12743\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12744\ }
\DoxyCodeLine{12745\ \textcolor{preprocessor}{\#if\ !defined(OPENGLES)\ ||\ defined(OPENGLES\_1)}}
\DoxyCodeLine{12746\ \ \ \textcolor{keywordtype}{int}\ logic\_op\_slot\ =\ LogicOpAttrib::get\_class\_slot();}
\DoxyCodeLine{12747\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(logic\_op\_slot)\ !=\ \_state\_rs-\/>get\_attrib(logic\_op\_slot)\ ||}
\DoxyCodeLine{12748\ \ \ \ \ \ \ !\_state\_mask.get\_bit(logic\_op\_slot))\ \{}
\DoxyCodeLine{12749\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_logic\_op\_pcollector);}}
\DoxyCodeLine{12750\ \ \ \ \ do\_issue\_logic\_op();}
\DoxyCodeLine{12751\ \ \ \ \ \_state\_mask.set\_bit(logic\_op\_slot);}
\DoxyCodeLine{12752\ \ \ \}}
\DoxyCodeLine{12753\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12754\ }
\DoxyCodeLine{12755\ \ \ \textcolor{keywordtype}{int}\ transparency\_slot\ =\ TransparencyAttrib::get\_class\_slot();}
\DoxyCodeLine{12756\ \ \ \textcolor{keywordtype}{int}\ color\_write\_slot\ =\ ColorWriteAttrib::get\_class\_slot();}
\DoxyCodeLine{12757\ \ \ \textcolor{keywordtype}{int}\ color\_blend\_slot\ =\ ColorBlendAttrib::get\_class\_slot();}
\DoxyCodeLine{12758\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(transparency\_slot)\ !=\ \_state\_rs-\/>get\_attrib(transparency\_slot)\ ||}
\DoxyCodeLine{12759\ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib(color\_write\_slot)\ !=\ \_state\_rs-\/>get\_attrib(color\_write\_slot)\ ||}
\DoxyCodeLine{12760\ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib(color\_blend\_slot)\ !=\ \_state\_rs-\/>get\_attrib(color\_blend\_slot)\ ||}
\DoxyCodeLine{12761\ \ \ \ \ \ \ !\_state\_mask.get\_bit(transparency\_slot)\ ||}
\DoxyCodeLine{12762\ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_write\_slot)\ ||}
\DoxyCodeLine{12763\ \ \ \ \ \ \ !\_state\_mask.get\_bit(color\_blend\_slot)}
\DoxyCodeLine{12764\ \#ifndef\ OPENGLES\_1}
\DoxyCodeLine{12765\ \ \ \ \ \ \ ||\ (\_target\_shader-\/>get\_flag(ShaderAttrib::F\_disable\_alpha\_write)\ !=}
\DoxyCodeLine{12766\ \ \ \ \ \ \ \ \ \ \ \_state\_shader-\/>get\_flag(ShaderAttrib::F\_disable\_alpha\_write))}
\DoxyCodeLine{12767\ \#endif}
\DoxyCodeLine{12768\ \ \ \ \ \ \ )\ \{}
\DoxyCodeLine{12769\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_blending\_pcollector);}}
\DoxyCodeLine{12770\ \ \ \ \ do\_issue\_blending();}
\DoxyCodeLine{12771\ \ \ \ \ \_state\_mask.set\_bit(transparency\_slot);}
\DoxyCodeLine{12772\ \ \ \ \ \_state\_mask.set\_bit(color\_write\_slot);}
\DoxyCodeLine{12773\ \ \ \ \ \_state\_mask.set\_bit(color\_blend\_slot);}
\DoxyCodeLine{12774\ \ \ \}}
\DoxyCodeLine{12775\ }
\DoxyCodeLine{12776\ \ \ \textcolor{keywordtype}{int}\ texture\_slot\ =\ TextureAttrib::get\_class\_slot();}
\DoxyCodeLine{12777\ \ \ \textcolor{keywordtype}{int}\ tex\_gen\_slot\ =\ TexGenAttrib::get\_class\_slot();}
\DoxyCodeLine{12778\ \ \ \textcolor{keywordtype}{int}\ tex\_matrix\_slot\ =\ TexMatrixAttrib::get\_class\_slot();}
\DoxyCodeLine{12779\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(texture\_slot)\ !=\ \_state\_rs-\/>get\_attrib(texture\_slot)\ ||}
\DoxyCodeLine{12780\ \ \ \ \ \ \ !\_state\_mask.get\_bit(texture\_slot))\ \{}
\DoxyCodeLine{12781\ \ \ \ \ \textcolor{comment}{//PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_texture\_pcollector);}}
\DoxyCodeLine{12782\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{12783\ \ \ \ \ determine\_target\_texture();}
\DoxyCodeLine{12784\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12785\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline()\ ||}
\DoxyCodeLine{12786\ \ \ \ \ \ \ \ \ \_current\_shader\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{12787\ \ \ \ \ \ \ \ \ \_current\_shader\ ==\ \_default\_shader)\ \{}
\DoxyCodeLine{12788\ \ \ \ \ \ \ determine\_target\_texture();}
\DoxyCodeLine{12789\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12790\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ custom\ shader,\ don't\ filter\ down\ the\ list\ of\ textures.}}
\DoxyCodeLine{12791\ \ \ \ \ \ \ \_target\_texture\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classTextureAttrib}{TextureAttrib}}\ *)}
\DoxyCodeLine{12792\ \ \ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib\_def(TextureAttrib::get\_class\_slot());}
\DoxyCodeLine{12793\ \ \ \ \ \ \ \_target\_tex\_gen\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexGenAttrib}{TexGenAttrib}}\ *)}
\DoxyCodeLine{12794\ \ \ \ \ \ \ \ \ \_target\_rs-\/>get\_attrib\_def(tex\_gen\_slot);}
\DoxyCodeLine{12795\ \ \ \ \ \}}
\DoxyCodeLine{12796\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12797\ \ \ \ \ do\_issue\_texture();}
\DoxyCodeLine{12798\ }
\DoxyCodeLine{12799\ \ \ \ \ \textcolor{comment}{//\ Since\ the\ TexGen\ and\ TexMatrix\ states\ depend\ partly\ on\ the\ particular}}
\DoxyCodeLine{12800\ \ \ \ \ \textcolor{comment}{//\ set\ of\ textures\ in\ use,\ we\ should\ force\ both\ of\ those\ to\ be\ reissued}}
\DoxyCodeLine{12801\ \ \ \ \ \textcolor{comment}{//\ every\ time\ we\ change\ the\ texture\ state.}}
\DoxyCodeLine{12802\ \ \ \ \ \_state\_mask.clear\_bit(tex\_gen\_slot);}
\DoxyCodeLine{12803\ \ \ \ \ \_state\_mask.clear\_bit(tex\_matrix\_slot);}
\DoxyCodeLine{12804\ }
\DoxyCodeLine{12805\ \ \ \ \ \_state\_texture\ =\ \_target\_texture;}
\DoxyCodeLine{12806\ \ \ \ \ \_state\_mask.set\_bit(texture\_slot);}
\DoxyCodeLine{12807\ \ \ \}}
\DoxyCodeLine{12808\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(tex\_gen\_slot)\ !=\ \_state\_rs-\/>get\_attrib(tex\_gen\_slot)\ ||}
\DoxyCodeLine{12809\ \ \ \ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(tex\_gen\_slot))\ \{}
\DoxyCodeLine{12810\ \ \ \ \ \_target\_tex\_gen\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classTexGenAttrib}{TexGenAttrib}}\ *)\_target\_rs-\/>get\_attrib\_def(tex\_gen\_slot);}
\DoxyCodeLine{12811\ }
\DoxyCodeLine{12812\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12813\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{12814\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_has\_texture\_alpha\_scale)\ \{}
\DoxyCodeLine{12815\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12816\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_has\_texture\_alpha\_scale\ \&\&\ \_current\_shader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{12817\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12818\ \ \ \ \ \ \ PT(\mbox{\hyperlink{classTextureStage}{TextureStage}})\ stage\ =\ get\_alpha\_scale\_texture\_stage();}
\DoxyCodeLine{12819\ \ \ \ \ \ \ \_target\_tex\_gen\ =\ DCAST(\mbox{\hyperlink{classTexGenAttrib}{TexGenAttrib}},\ \_target\_tex\_gen-\/>add\_stage}
\DoxyCodeLine{12820\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (stage,\ TexGenAttrib::M\_constant,\ LTexCoord3(\_current\_color\_scale[3],\ 0.0f,\ 0.0f)));}
\DoxyCodeLine{12821\ \ \ \ \ \}}
\DoxyCodeLine{12822\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12823\ }
\DoxyCodeLine{12824\ \ \ \ \ \textcolor{comment}{//\ If\ one\ of\ the\ previously-\/loaded\ TexGen\ modes\ modified\ the\ texture\ matrix,}}
\DoxyCodeLine{12825\ \ \ \ \ \textcolor{comment}{//\ then\ if\ either\ state\ changed,\ we\ have\ to\ change\ both\ of\ them\ now.}}
\DoxyCodeLine{12826\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tex\_gen\_modifies\_mat)\ \{}
\DoxyCodeLine{12827\ \ \ \ \ \ \ \_state\_mask.clear\_bit(tex\_gen\_slot);}
\DoxyCodeLine{12828\ \ \ \ \ \ \ \_state\_mask.clear\_bit(tex\_matrix\_slot);}
\DoxyCodeLine{12829\ \ \ \ \ \}}
\DoxyCodeLine{12830\ \ \ \}}
\DoxyCodeLine{12831\ }
\DoxyCodeLine{12832\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(tex\_matrix\_slot)\ !=\ \_state\_rs-\/>get\_attrib(tex\_matrix\_slot)\ ||}
\DoxyCodeLine{12833\ \ \ \ \ \ \ !\_state\_mask.get\_bit(tex\_matrix\_slot))\ \{}
\DoxyCodeLine{12834\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_tex\_matrix\_pcollector);}}
\DoxyCodeLine{12835\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12836\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12837\ \ \ \ \ \ \ do\_issue\_tex\_matrix();}
\DoxyCodeLine{12838\ \ \ \ \ \}}
\DoxyCodeLine{12839\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12840\ \ \ \ \ \_state\_mask.set\_bit(tex\_matrix\_slot);}
\DoxyCodeLine{12841\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{12842\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context)\ \{}
\DoxyCodeLine{12843\ \ \ \ \ \ \ \_current\_shader\_context-\/>issue\_parameters(Shader::SSD\_tex\_matrix);}
\DoxyCodeLine{12844\ \ \ \ \ \}}
\DoxyCodeLine{12845\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12846\ }
\DoxyCodeLine{12847\ \ \ \ \ \textcolor{comment}{//\ See\ previous\ occurrence\ of\ this\ check.}}
\DoxyCodeLine{12848\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tex\_gen\_modifies\_mat)\ \{}
\DoxyCodeLine{12849\ \ \ \ \ \ \ \_state\_mask.clear\_bit(tex\_gen\_slot);}
\DoxyCodeLine{12850\ \ \ \ \ \}}
\DoxyCodeLine{12851\ \ \ \}}
\DoxyCodeLine{12852\ }
\DoxyCodeLine{12853\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12854\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12855\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_tex\_gen\ !=\ \_state\_tex\_gen\ ||}
\DoxyCodeLine{12856\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(tex\_gen\_slot))\ \{}
\DoxyCodeLine{12857\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_tex\_gen\_pcollector);}}
\DoxyCodeLine{12858\ \ \ \ \ \ \ do\_issue\_tex\_gen();}
\DoxyCodeLine{12859\ \ \ \ \ \ \ \_state\_tex\_gen\ =\ \_target\_tex\_gen;}
\DoxyCodeLine{12860\ \ \ \ \ \ \ \_state\_mask.set\_bit(tex\_gen\_slot);}
\DoxyCodeLine{12861\ \ \ \ \ \}}
\DoxyCodeLine{12862\ }
\DoxyCodeLine{12863\ \ \ \ \ \textcolor{keywordtype}{int}\ material\_slot\ =\ MaterialAttrib::get\_class\_slot();}
\DoxyCodeLine{12864\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(material\_slot)\ !=\ \_state\_rs-\/>get\_attrib(material\_slot)\ ||}
\DoxyCodeLine{12865\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(material\_slot))\ \{}
\DoxyCodeLine{12866\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_material\_pcollector);}}
\DoxyCodeLine{12867\ \ \ \ \ \ \ do\_issue\_material();}
\DoxyCodeLine{12868\ \ \ \ \ \ \ \_state\_mask.set\_bit(material\_slot);}
\DoxyCodeLine{12869\ \ \ \ \ \}}
\DoxyCodeLine{12870\ }
\DoxyCodeLine{12871\ \ \ \ \ \textcolor{keywordtype}{int}\ light\_slot\ =\ LightAttrib::get\_class\_slot();}
\DoxyCodeLine{12872\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(light\_slot)\ !=\ \_state\_rs-\/>get\_attrib(light\_slot)\ ||}
\DoxyCodeLine{12873\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(light\_slot))\ \{}
\DoxyCodeLine{12874\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_light\_pcollector);}}
\DoxyCodeLine{12875\ \ \ \ \ \ \ do\_issue\_light();}
\DoxyCodeLine{12876\ \ \ \ \ \ \ \_state\_mask.set\_bit(light\_slot);}
\DoxyCodeLine{12877\ \ \ \ \ \}}
\DoxyCodeLine{12878\ }
\DoxyCodeLine{12879\ \ \ \ \ \textcolor{keywordtype}{int}\ fog\_slot\ =\ FogAttrib::get\_class\_slot();}
\DoxyCodeLine{12880\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(fog\_slot)\ !=\ \_state\_rs-\/>get\_attrib(fog\_slot)\ ||}
\DoxyCodeLine{12881\ \ \ \ \ \ \ \ \ !\_state\_mask.get\_bit(fog\_slot))\ \{}
\DoxyCodeLine{12882\ \ \ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_fog\_pcollector);}}
\DoxyCodeLine{12883\ \ \ \ \ \ \ do\_issue\_fog();}
\DoxyCodeLine{12884\ \ \ \ \ \ \ \_state\_mask.set\_bit(fog\_slot);}
\DoxyCodeLine{12885\ \ \ \ \ \}}
\DoxyCodeLine{12886\ \ \ \}}
\DoxyCodeLine{12887\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12888\ }
\DoxyCodeLine{12889\ \ \ \textcolor{keywordtype}{int}\ stencil\_slot\ =\ StencilAttrib::get\_class\_slot();}
\DoxyCodeLine{12890\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(stencil\_slot)\ !=\ \_state\_rs-\/>get\_attrib(stencil\_slot)\ ||}
\DoxyCodeLine{12891\ \ \ \ \ \ \ !\_state\_mask.get\_bit(stencil\_slot))\ \{}
\DoxyCodeLine{12892\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_stencil\_pcollector);}}
\DoxyCodeLine{12893\ \ \ \ \ do\_issue\_stencil();}
\DoxyCodeLine{12894\ \ \ \ \ \_state\_mask.set\_bit(stencil\_slot);}
\DoxyCodeLine{12895\ \ \ \}}
\DoxyCodeLine{12896\ }
\DoxyCodeLine{12897\ \ \ \textcolor{keywordtype}{int}\ scissor\_slot\ =\ ScissorAttrib::get\_class\_slot();}
\DoxyCodeLine{12898\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(scissor\_slot)\ !=\ \_state\_rs-\/>get\_attrib(scissor\_slot)\ ||}
\DoxyCodeLine{12899\ \ \ \ \ \ \ !\_state\_mask.get\_bit(scissor\_slot))\ \{}
\DoxyCodeLine{12900\ \ \ \ \ \textcolor{comment}{//\ PStatGPUTimer\ timer(this,\ \_draw\_set\_state\_scissor\_pcollector);}}
\DoxyCodeLine{12901\ \ \ \ \ do\_issue\_scissor();}
\DoxyCodeLine{12902\ \ \ \ \ \_state\_mask.set\_bit(scissor\_slot);}
\DoxyCodeLine{12903\ \ \ \}}
\DoxyCodeLine{12904\ }
\DoxyCodeLine{12905\ \ \ \_state\_rs\ =\ \_target\_rs;}
\DoxyCodeLine{12906\ \ \ maybe\_gl\_finish();}
\DoxyCodeLine{12907\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{12908\ \}}
\DoxyCodeLine{12909\ }
\DoxyCodeLine{12913\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12914\ free\_pointers()\ \{}
\DoxyCodeLine{12915\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{12916\ \ \ \textcolor{keywordflow}{if}\ (\_cg\_context)\ \{}
\DoxyCodeLine{12917\ \ \ \ \ \_destroyed\_cg\_contexts.push\_back(\_cg\_context);}
\DoxyCodeLine{12918\ \ \ \ \ \_cg\_context\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{12919\ }
\DoxyCodeLine{12920\ \ \ \ \ \textcolor{comment}{//\ Don't\ destroy\ the\ Cg\ context\ until\ the\ last\ GSG\ that\ uses\ Cg\ has\ been}}
\DoxyCodeLine{12921\ \ \ \ \ \textcolor{comment}{//\ destroyed.\ \ This\ works\ around\ a\ Cg\ bug,\ see\ \#1117.}}
\DoxyCodeLine{12922\ \ \ \ \ \textcolor{keywordflow}{if}\ (!AtomicAdjust::dec(\_num\_gsgs\_with\_cg\_contexts))\ \{}
\DoxyCodeLine{12923\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (CGcontext\ context\ :\ \_destroyed\_cg\_contexts)\ \{}
\DoxyCodeLine{12924\ \ \ \ \ \ \ \ \ cgDestroyContext(context);}
\DoxyCodeLine{12925\ \ \ \ \ \ \ \}}
\DoxyCodeLine{12926\ \ \ \ \ \ \ \_destroyed\_cg\_contexts.clear();}
\DoxyCodeLine{12927\ \ \ \ \ \}}
\DoxyCodeLine{12928\ \ \ \}}
\DoxyCodeLine{12929\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12930\ \}}
\DoxyCodeLine{12931\ }
\DoxyCodeLine{12935\ \textcolor{preprocessor}{\#if\ defined(HAVE\_CG)\ \&\&\ !defined(OPENGLES)}}
\DoxyCodeLine{12936\ CGcontext\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12937\ get\_cg\_context()\ \{}
\DoxyCodeLine{12938\ \ \ CGcontext\ context\ =\ \_cg\_context;}
\DoxyCodeLine{12939\ \ \ \textcolor{keywordflow}{if}\ (context\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{12940\ \ \ \ \ context\ =\ cgCreateContext();}
\DoxyCodeLine{12941\ }
\DoxyCodeLine{12942\ \textcolor{preprocessor}{\#if\ CG\_VERSION\_NUM\ >=\ 3100}}
\DoxyCodeLine{12943\ \ \ \ \ \textcolor{comment}{//\ This\ just\ sounds\ like\ a\ good\ thing\ to\ do.}}
\DoxyCodeLine{12944\ \ \ \ \ cgGLSetContextGLSLVersion(context,\ cgGLDetectGLSLVersion());}
\DoxyCodeLine{12945\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_shader\_caps.\_active\_vprofile\ ==\ CG\_PROFILE\_GLSLV)\ \{}
\DoxyCodeLine{12946\ \ \ \ \ \ \ cgGLSetContextOptimalOptions(context,\ CG\_PROFILE\_GLSLC);}
\DoxyCodeLine{12947\ \ \ \ \ \}}
\DoxyCodeLine{12948\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12949\ }
\DoxyCodeLine{12950\ \ \ \ \ AtomicAdjust::inc(\_num\_gsgs\_with\_cg\_contexts);}
\DoxyCodeLine{12951\ \ \ \ \ \_cg\_context\ =\ context;}
\DoxyCodeLine{12952\ \ \ \}}
\DoxyCodeLine{12953\ }
\DoxyCodeLine{12954\ \ \ \textcolor{keywordflow}{return}\ context;}
\DoxyCodeLine{12955\ \}}
\DoxyCodeLine{12956\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12957\ }
\DoxyCodeLine{12962\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{12963\ do\_issue\_texture()\ \{}
\DoxyCodeLine{12964\ \ \ DO\_PSTATS\_STUFF(\_texture\_state\_pcollector.add\_level(1));}
\DoxyCodeLine{12965\ }
\DoxyCodeLine{12966\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{12967\ \ \ update\_standard\_texture\_bindings();}
\DoxyCodeLine{12968\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{12969\ \ \ \textcolor{keywordflow}{if}\ (\_current\_shader\_context\ ==\ 0)\ \{}
\DoxyCodeLine{12970\ \ \ \ \ \textcolor{comment}{//\ No\ shader,\ or\ a\ non-\/Cg\ shader.}}
\DoxyCodeLine{12971\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_texture\_binding\_shader\_context\ !=\ 0)\ \{}
\DoxyCodeLine{12972\ \ \ \ \ \ \ \_texture\_binding\_shader\_context-\/>disable\_shader\_texture\_bindings();}
\DoxyCodeLine{12973\ \ \ \ \ \}}
\DoxyCodeLine{12974\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12975\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12976\ \ \ \ \ \ \ update\_standard\_texture\_bindings();}
\DoxyCodeLine{12977\ \ \ \ \ \}}
\DoxyCodeLine{12978\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12979\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12980\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_texture\_binding\_shader\_context\ ==\ 0)\ \{}
\DoxyCodeLine{12981\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{12982\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{12983\ \ \ \ \ \ \ \ \ disable\_standard\_texture\_bindings();}
\DoxyCodeLine{12984\ \ \ \ \ \ \ \}}
\DoxyCodeLine{12985\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12986\ \ \ \ \ \ \ \_current\_shader\_context-\/>update\_shader\_texture\_bindings(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{12987\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{12988\ \ \ \ \ \ \ \_current\_shader\_context-\/>}
\DoxyCodeLine{12989\ \ \ \ \ \ \ \ \ update\_shader\_texture\_bindings(\_texture\_binding\_shader\_context);}
\DoxyCodeLine{12990\ \ \ \ \ \}}
\DoxyCodeLine{12991\ \ \ \}}
\DoxyCodeLine{12992\ }
\DoxyCodeLine{12993\ \ \ \_texture\_binding\_shader\ =\ \_current\_shader;}
\DoxyCodeLine{12994\ \ \ \_texture\_binding\_shader\_context\ =\ \_current\_shader\_context;}
\DoxyCodeLine{12995\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{12996\ \}}
\DoxyCodeLine{12997\ }
\DoxyCodeLine{12998\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13003\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13004\ update\_standard\_texture\_bindings()\ \{}
\DoxyCodeLine{13005\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{13006\ \ \ \textcolor{keywordflow}{if}\ (\_show\_texture\_usage)\ \{}
\DoxyCodeLine{13007\ \ \ \ \ update\_show\_usage\_texture\_bindings(-\/1);}
\DoxyCodeLine{13008\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{13009\ \ \ \}}
\DoxyCodeLine{13010\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{13011\ }
\DoxyCodeLine{13012\ \ \ \textcolor{keywordtype}{int}\ num\_stages\ =\ \_target\_texture-\/>get\_num\_on\_ff\_stages();}
\DoxyCodeLine{13013\ }
\DoxyCodeLine{13014\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{13015\ \ \ \textcolor{comment}{//\ Also\ check\ the\ \_flash\_texture.\ \ If\ it\ is\ non-\/NULL,\ we\ need\ to\ check\ to}}
\DoxyCodeLine{13016\ \ \ \textcolor{comment}{//\ see\ if\ our\ flash\_texture\ is\ in\ the\ texture\ stack\ here.\ \ If\ so,\ then\ we}}
\DoxyCodeLine{13017\ \ \ \textcolor{comment}{//\ need\ to\ call\ the\ special\ show\_texture\ method\ instead\ of\ the\ normal}}
\DoxyCodeLine{13018\ \ \ \textcolor{comment}{//\ texture\ stack.}}
\DoxyCodeLine{13019\ \ \ \textcolor{keywordflow}{if}\ (\_flash\_texture\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{13020\ \ \ \ \ \textcolor{keywordtype}{double}\ now\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_time();}
\DoxyCodeLine{13021\ \ \ \ \ \textcolor{keywordtype}{int}\ this\_second\ =\ (int)floor(now);}
\DoxyCodeLine{13022\ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_second\ \&\ 1)\ \{}
\DoxyCodeLine{13023\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ show\_stage\_index\ =\ -\/1;}
\DoxyCodeLine{13024\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_stages\ \&\&\ show\_stage\_index\ <\ 0;\ ++i)\ \{}
\DoxyCodeLine{13025\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13026\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ \_target\_texture-\/>get\_on\_texture(stage);}
\DoxyCodeLine{13027\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\ ==\ \_flash\_texture)\ \{}
\DoxyCodeLine{13028\ \ \ \ \ \ \ \ \ \ \ show\_stage\_index\ =\ i;}
\DoxyCodeLine{13029\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{13030\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13031\ }
\DoxyCodeLine{13032\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (show\_stage\_index\ >=\ 0)\ \{}
\DoxyCodeLine{13033\ \ \ \ \ \ \ \ \ update\_show\_usage\_texture\_bindings(show\_stage\_index);}
\DoxyCodeLine{13034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{13035\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13036\ \ \ \ \ \}}
\DoxyCodeLine{13037\ \ \ \}}
\DoxyCodeLine{13038\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{13039\ }
\DoxyCodeLine{13040\ \ \ nassertv(num\_stages\ <=\ \_max\_texture\_stages\ \&\&}
\DoxyCodeLine{13041\ \ \ \ \ \ \ \ \ \ \ \ \_num\_active\_texture\_stages\ <=\ \_max\_texture\_stages);}
\DoxyCodeLine{13042\ }
\DoxyCodeLine{13043\ \ \ \_texture\_involves\_color\_scale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{13044\ }
\DoxyCodeLine{13045\ \ \ \textcolor{keywordtype}{int}\ last\_saved\_result\ =\ -\/1;}
\DoxyCodeLine{13046\ \ \ \textcolor{keywordtype}{int}\ last\_stage\ =\ -\/1;}
\DoxyCodeLine{13047\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{13048\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_stages;\ i++)\ \{}
\DoxyCodeLine{13049\ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13050\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ \_target\_texture-\/>get\_on\_texture(stage);}
\DoxyCodeLine{13051\ \ \ \ \ nassertv(texture\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{13052\ }
\DoxyCodeLine{13053\ \ \ \ \ \textcolor{comment}{//\ Issue\ the\ texture\ on\ stage\ i.}}
\DoxyCodeLine{13054\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13055\ }
\DoxyCodeLine{13056\ \ \ \ \ \textcolor{comment}{//\ First,\ turn\ off\ the\ previous\ texture\ mode.}}
\DoxyCodeLine{13057\ \ \ \ \ glDisable(GL\_TEXTURE\_2D);}
\DoxyCodeLine{13058\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13059\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_CUBE\_MAP);}
\DoxyCodeLine{13060\ \ \ \ \ \}}
\DoxyCodeLine{13061\ }
\DoxyCodeLine{13062\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13063\ \ \ \ \ glDisable(GL\_TEXTURE\_1D);}
\DoxyCodeLine{13064\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{13065\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_3D);}
\DoxyCodeLine{13066\ \ \ \ \ \}}
\DoxyCodeLine{13067\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13068\ }
\DoxyCodeLine{13069\ \ \ \ \ \textcolor{keywordtype}{int}\ view\ =\ get\_current\_tex\_view\_offset()\ +\ stage-\/>get\_tex\_view\_offset();}
\DoxyCodeLine{13070\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ texture-\/>prepare\_now(\_prepared\_objects,\ \textcolor{keyword}{this});}
\DoxyCodeLine{13071\ \ \ \ \ \textcolor{keywordflow}{if}\ (tc\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{13072\ \ \ \ \ \ \ \textcolor{comment}{//\ Something\ wrong\ with\ this\ texture;\ skip\ it.}}
\DoxyCodeLine{13073\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{13074\ \ \ \ \ \}}
\DoxyCodeLine{13075\ }
\DoxyCodeLine{13076\ \ \ \ \ \textcolor{comment}{//\ Then,\ turn\ on\ the\ current\ texture\ mode.}}
\DoxyCodeLine{13077\ \ \ \ \ GLenum\ target\ =\ get\_texture\_target(texture-\/>get\_texture\_type());}
\DoxyCodeLine{13078\ \ \ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_NONE)\ \{}
\DoxyCodeLine{13079\ \ \ \ \ \ \ \textcolor{comment}{//\ Unsupported\ texture\ mode.}}
\DoxyCodeLine{13080\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{13081\ \ \ \ \ \}}
\DoxyCodeLine{13082\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13083\ \ \ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_2D\_ARRAY\ ||\ target\ ==\ GL\_TEXTURE\_CUBE\_MAP\_ARRAY)\ \{}
\DoxyCodeLine{13084\ \ \ \ \ \ \ \textcolor{comment}{//\ Cannot\ be\ applied\ via\ the\ FFP.}}
\DoxyCodeLine{13085\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{13086\ \ \ \ \ \}}
\DoxyCodeLine{13087\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13088\ \ \ \ \ glEnable(target);}
\DoxyCodeLine{13089\ }
\DoxyCodeLine{13090\ \ \ \ \ \textcolor{keywordflow}{if}\ (!update\_texture(tc,\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{13091\ \ \ \ \ \ \ glDisable(target);}
\DoxyCodeLine{13092\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{13093\ \ \ \ \ \}}
\DoxyCodeLine{13094\ \ \ \ \ \textcolor{comment}{//\ Don't\ DCAST();\ we\ already\ did\ the\ verification\ in\ update\_texture.}}
\DoxyCodeLine{13095\ \ \ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ (CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *)tc;}
\DoxyCodeLine{13096\ \ \ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{13097\ \ \ \ \ apply\_sampler(i,\ \_target\_texture-\/>get\_on\_sampler(stage),\ gtc,\ view);}
\DoxyCodeLine{13098\ }
\DoxyCodeLine{13099\ \ \ \ \ \textcolor{keywordflow}{if}\ (stage-\/>involves\_color\_scale()\ \&\&\ \_color\_scale\_enabled)\ \{}
\DoxyCodeLine{13100\ \ \ \ \ \ \ LColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ stage-\/>get\_color();}
\DoxyCodeLine{13101\ \ \ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}.set(\mbox{\hyperlink{structcolor}{color}}[0]\ *\ \_current\_color\_scale[0],}
\DoxyCodeLine{13102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}[1]\ *\ \_current\_color\_scale[1],}
\DoxyCodeLine{13103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}[2]\ *\ \_current\_color\_scale[2],}
\DoxyCodeLine{13104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}[3]\ *\ \_current\_color\_scale[3]);}
\DoxyCodeLine{13105\ \ \ \ \ \ \ \_texture\_involves\_color\_scale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13106\ \ \ \ \ \ \ call\_glTexEnvfv(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_COLOR,\ \mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{13107\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13108\ \ \ \ \ \ \ call\_glTexEnvfv(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_COLOR,\ stage-\/>get\_color());}
\DoxyCodeLine{13109\ \ \ \ \ \}}
\DoxyCodeLine{13110\ }
\DoxyCodeLine{13111\ \ \ \ \ \textcolor{keywordflow}{if}\ (stage-\/>get\_mode()\ ==\ TextureStage::M\_decal)\ \{}
\DoxyCodeLine{13112\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (texture-\/>get\_num\_components()\ <\ 3\ \&\&\ \_supports\_texture\_combine)\ \{}
\DoxyCodeLine{13113\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ a\ special\ case\ for\ 1-\/\ and\ 2-\/channel\ decal\ textures.\ \ OpenGL}}
\DoxyCodeLine{13114\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ does\ not\ define\ their\ use\ with\ GL\_DECAL\ for\ some\ reason,\ so}}
\DoxyCodeLine{13115\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ implement\ them\ using\ the\ combiner\ instead.}}
\DoxyCodeLine{13116\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_MODE,\ GL\_COMBINE);}
\DoxyCodeLine{13117\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_COMBINE\_RGB,\ GL\_INTERPOLATE);}
\DoxyCodeLine{13118\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_RGB\_SCALE,\ 1);}
\DoxyCodeLine{13119\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_ALPHA\_SCALE,\ 1);}
\DoxyCodeLine{13120\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC0\_RGB,\ GL\_TEXTURE);}
\DoxyCodeLine{13121\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND0\_RGB,\ GL\_SRC\_COLOR);}
\DoxyCodeLine{13122\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC1\_RGB,\ GL\_PREVIOUS);}
\DoxyCodeLine{13123\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND1\_RGB,\ GL\_SRC\_COLOR);}
\DoxyCodeLine{13124\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC2\_RGB,\ GL\_TEXTURE);}
\DoxyCodeLine{13125\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND2\_RGB,\ GL\_SRC\_ALPHA);}
\DoxyCodeLine{13126\ }
\DoxyCodeLine{13127\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13128\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Normal\ 3-\/\ and\ 4-\/channel\ decal\ textures.}}
\DoxyCodeLine{13129\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_MODE,\ GL\_DECAL);}
\DoxyCodeLine{13130\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13131\ }
\DoxyCodeLine{13132\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (stage-\/>get\_mode()\ ==\ TextureStage::M\_combine)\ \{}
\DoxyCodeLine{13133\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_texture\_combine)\ \{}
\DoxyCodeLine{13134\ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{13135\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}TextureStage::M\_combine\ mode\ is\ not\ supported.\(\backslash\)n"{}};}
\DoxyCodeLine{13136\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_MODE,\ GL\_MODULATE);}
\DoxyCodeLine{13137\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13138\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_MODE,\ GL\_COMBINE);}
\DoxyCodeLine{13139\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_COMBINE\_RGB,\ GL\_INTERPOLATE);}
\DoxyCodeLine{13140\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_RGB\_SCALE,\ stage-\/>get\_rgb\_scale());}
\DoxyCodeLine{13141\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_ALPHA\_SCALE,\ stage-\/>get\_alpha\_scale());}
\DoxyCodeLine{13142\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_COMBINE\_RGB,}
\DoxyCodeLine{13143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_combine\_type(stage-\/>get\_combine\_rgb\_mode()));}
\DoxyCodeLine{13144\ }
\DoxyCodeLine{13145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (stage-\/>get\_num\_combine\_rgb\_operands())\ \{}
\DoxyCodeLine{13146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{13147\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC2\_RGB,}
\DoxyCodeLine{13148\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_rgb\_source2(),}
\DoxyCodeLine{13149\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13150\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND2\_RGB,}
\DoxyCodeLine{13151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_rgb\_operand2()));}
\DoxyCodeLine{13152\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13153\ }
\DoxyCodeLine{13154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{13155\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC1\_RGB,}
\DoxyCodeLine{13156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_rgb\_source1(),}
\DoxyCodeLine{13157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13158\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND1\_RGB,}
\DoxyCodeLine{13159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_rgb\_operand1()));}
\DoxyCodeLine{13160\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13161\ }
\DoxyCodeLine{13162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{13163\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC0\_RGB,}
\DoxyCodeLine{13164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_rgb\_source0(),}
\DoxyCodeLine{13165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13166\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND0\_RGB,}
\DoxyCodeLine{13167\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_rgb\_operand0()));}
\DoxyCodeLine{13168\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13169\ }
\DoxyCodeLine{13170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{13171\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{13173\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_COMBINE\_ALPHA,}
\DoxyCodeLine{13174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_combine\_type(stage-\/>get\_combine\_alpha\_mode()));}
\DoxyCodeLine{13175\ }
\DoxyCodeLine{13176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (stage-\/>get\_num\_combine\_alpha\_operands())\ \{}
\DoxyCodeLine{13177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{13178\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC2\_ALPHA,}
\DoxyCodeLine{13179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_alpha\_source2(),}
\DoxyCodeLine{13180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13181\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND2\_ALPHA,}
\DoxyCodeLine{13182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_alpha\_operand2()));}
\DoxyCodeLine{13183\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13184\ }
\DoxyCodeLine{13185\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{13186\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC1\_ALPHA,}
\DoxyCodeLine{13187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_alpha\_source1(),}
\DoxyCodeLine{13188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13189\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND1\_ALPHA,}
\DoxyCodeLine{13190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_alpha\_operand1()));}
\DoxyCodeLine{13191\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13192\ }
\DoxyCodeLine{13193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{13194\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_SRC0\_ALPHA,}
\DoxyCodeLine{13195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_src\_type(stage-\/>get\_combine\_alpha\_source0(),}
\DoxyCodeLine{13196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ last\_stage,\ last\_saved\_result,\ i));}
\DoxyCodeLine{13197\ \ \ \ \ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_OPERAND0\_ALPHA,}
\DoxyCodeLine{13198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_operand\_type(stage-\/>get\_combine\_alpha\_operand0()));}
\DoxyCodeLine{13199\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fall\ through}}
\DoxyCodeLine{13200\ }
\DoxyCodeLine{13201\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{13202\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13203\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{13204\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13205\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13206\ \ \ \ \ \ \ GLint\ glmode\ =\ get\_texture\_apply\_mode\_type(stage-\/>get\_mode());}
\DoxyCodeLine{13207\ \ \ \ \ \ \ glTexEnvi(GL\_TEXTURE\_ENV,\ GL\_TEXTURE\_ENV\_MODE,\ glmode);}
\DoxyCodeLine{13208\ \ \ \ \ \}}
\DoxyCodeLine{13209\ }
\DoxyCodeLine{13210\ \ \ \ \ \textcolor{keywordflow}{if}\ (stage-\/>get\_saved\_result())\ \{}
\DoxyCodeLine{13211\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ texture's\ result\ will\ be\ "{}saved"{}\ for\ a\ future\ stage's\ input.}}
\DoxyCodeLine{13212\ \ \ \ \ \ \ last\_saved\_result\ =\ i;}
\DoxyCodeLine{13213\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13214\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ regular\ texture\ stage;\ it\ will\ be\ the\ "{}previous"{}\ input\ for}}
\DoxyCodeLine{13215\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ next\ stage.}}
\DoxyCodeLine{13216\ \ \ \ \ \ \ last\_stage\ =\ i;}
\DoxyCodeLine{13217\ \ \ \ \ \}}
\DoxyCodeLine{13218\ \ \ \}}
\DoxyCodeLine{13219\ }
\DoxyCodeLine{13220\ \ \ \textcolor{comment}{//\ Disable\ the\ texture\ stages\ that\ are\ no\ longer\ used.}}
\DoxyCodeLine{13221\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ num\_stages;\ i\ <\ \_num\_active\_texture\_stages;\ i++)\ \{}
\DoxyCodeLine{13222\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13223\ \ \ \ \ glDisable(GL\_TEXTURE\_2D);}
\DoxyCodeLine{13224\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13225\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_CUBE\_MAP);}
\DoxyCodeLine{13226\ \ \ \ \ \}}
\DoxyCodeLine{13227\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13228\ \ \ \ \ glDisable(GL\_TEXTURE\_1D);}
\DoxyCodeLine{13229\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{13230\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_3D);}
\DoxyCodeLine{13231\ \ \ \ \ \}}
\DoxyCodeLine{13232\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13233\ \ \ \}}
\DoxyCodeLine{13234\ }
\DoxyCodeLine{13235\ \ \ \textcolor{comment}{//\ Save\ the\ count\ of\ texture\ stages\ for\ next\ time.}}
\DoxyCodeLine{13236\ \ \ \_num\_active\_texture\_stages\ =\ num\_stages;}
\DoxyCodeLine{13237\ }
\DoxyCodeLine{13238\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13239\ \}}
\DoxyCodeLine{13240\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13241\ }
\DoxyCodeLine{13246\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13247\ apply\_white\_texture(GLuint\ unit)\ \{}
\DoxyCodeLine{13248\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13249\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_dsa)\ \{}
\DoxyCodeLine{13250\ \ \ \ \ \_glBindTextureUnit(unit,\ get\_white\_texture());}
\DoxyCodeLine{13251\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{13252\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13253\ \ \ \{}
\DoxyCodeLine{13254\ \ \ \ \ set\_active\_texture\_stage(unit);}
\DoxyCodeLine{13255\ }
\DoxyCodeLine{13256\ \ \ \ \ GLuint\ index\ =\ get\_white\_texture();}
\DoxyCodeLine{13257\ \ \ \ \ glBindTexture(GL\_TEXTURE\_2D,\ index);}
\DoxyCodeLine{13258\ }
\DoxyCodeLine{13259\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{13260\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{13261\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(GL\_TEXTURE\_2D,\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ all-\/white\ texture\(\backslash\)n"{}};}
\DoxyCodeLine{13262\ \ \ \ \ \}}
\DoxyCodeLine{13263\ \ \ \}}
\DoxyCodeLine{13264\ }
\DoxyCodeLine{13265\ \ \ \textcolor{comment}{//\ Also\ apply\ the\ default\ sampler,\ if\ there's\ a\ chance\ we'd\ applied\ anything}}
\DoxyCodeLine{13266\ \ \ \textcolor{comment}{//\ else.}}
\DoxyCodeLine{13267\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13268\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_sampler\_objects)\ \{}
\DoxyCodeLine{13269\ \ \ \ \ \_glBindSampler(unit,\ 0);}
\DoxyCodeLine{13270\ \ \ \}}
\DoxyCodeLine{13271\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13272\ \}}
\DoxyCodeLine{13273\ }
\DoxyCodeLine{13278\ GLuint\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13279\ get\_white\_texture()\ \{}
\DoxyCodeLine{13280\ \ \ \textcolor{keywordflow}{if}\ (\_white\_texture\ !=\ 0)\ \{}
\DoxyCodeLine{13281\ \ \ \ \ \textcolor{keywordflow}{return}\ \_white\_texture;}
\DoxyCodeLine{13282\ \ \ \}}
\DoxyCodeLine{13283\ }
\DoxyCodeLine{13284\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ data[]\ =\ \{0xff,\ 0xff,\ 0xff,\ 0xff\};}
\DoxyCodeLine{13285\ }
\DoxyCodeLine{13286\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13287\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_dsa\ \&\&\ \_supports\_tex\_storage)\ \{}
\DoxyCodeLine{13288\ \ \ \ \ \_glCreateTextures(GL\_TEXTURE\_2D,\ 1,\ \&\_white\_texture);}
\DoxyCodeLine{13289\ \ \ \ \ \_glTextureParameteri(\_white\_texture,\ GL\_TEXTURE\_WRAP\_S,\ GL\_REPEAT);}
\DoxyCodeLine{13290\ \ \ \ \ \_glTextureParameteri(\_white\_texture,\ GL\_TEXTURE\_WRAP\_T,\ GL\_REPEAT);}
\DoxyCodeLine{13291\ \ \ \ \ \_glTextureParameteri(\_white\_texture,\ GL\_TEXTURE\_MIN\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13292\ \ \ \ \ \_glTextureParameteri(\_white\_texture,\ GL\_TEXTURE\_MAG\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13293\ \ \ \ \ \_glTextureStorage2D(\_white\_texture,\ 1,\ GL\_RGBA8,\ 1,\ 1);}
\DoxyCodeLine{13294\ \ \ \ \ \_glTextureSubImage2D(\_white\_texture,\ 0,\ 0,\ 0,\ 1,\ 1,\ GL\_RGBA,\ GL\_UNSIGNED\_BYTE,\ data);}
\DoxyCodeLine{13295\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{13296\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13297\ \ \ \{}
\DoxyCodeLine{13298\ \ \ \ \ glGenTextures(1,\ \&\_white\_texture);}
\DoxyCodeLine{13299\ \ \ \ \ glBindTexture(GL\_TEXTURE\_2D,\ \_white\_texture);}
\DoxyCodeLine{13300\ \ \ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_WRAP\_S,\ GL\_REPEAT);}
\DoxyCodeLine{13301\ \ \ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_WRAP\_T,\ GL\_REPEAT);}
\DoxyCodeLine{13302\ \ \ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_MIN\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13303\ \ \ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_MAG\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13304\ }
\DoxyCodeLine{13305\ \ \ \ \ glTexImage2D(GL\_TEXTURE\_2D,\ 0,\ GL\_RGBA,\ 1,\ 1,\ 0,}
\DoxyCodeLine{13306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_RGBA,\ GL\_UNSIGNED\_BYTE,\ data);}
\DoxyCodeLine{13307\ \ \ \}}
\DoxyCodeLine{13308\ \ \ \textcolor{keywordflow}{return}\ \_white\_texture;}
\DoxyCodeLine{13309\ \}}
\DoxyCodeLine{13310\ }
\DoxyCodeLine{13311\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{13320\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13321\ update\_show\_usage\_texture\_bindings(int\ show\_stage\_index)\ \{}
\DoxyCodeLine{13322\ \ \ \textcolor{keywordtype}{int}\ num\_stages\ =\ \_target\_texture-\/>get\_num\_on\_ff\_stages();}
\DoxyCodeLine{13323\ }
\DoxyCodeLine{13324\ \ \ nassertv(num\_stages\ <=\ \_max\_texture\_stages\ \&\&}
\DoxyCodeLine{13325\ \ \ \ \ \ \ \ \ \ \ \ \_num\_active\_texture\_stages\ <=\ \_max\_texture\_stages);}
\DoxyCodeLine{13326\ }
\DoxyCodeLine{13327\ \ \ \_texture\_involves\_color\_scale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{13328\ }
\DoxyCodeLine{13329\ \ \ \textcolor{comment}{//\ First,\ we\ walk\ through\ the\ list\ of\ textures\ and\ pretend\ to\ render\ them}}
\DoxyCodeLine{13330\ \ \ \textcolor{comment}{//\ all,\ even\ though\ we\ don't\ actually\ render\ them,\ just\ so\ Panda\ will\ keep}}
\DoxyCodeLine{13331\ \ \ \textcolor{comment}{//\ track\ of\ the\ list\ of\ "{}active"{}\ textures\ correctly\ during\ the\ flash.}}
\DoxyCodeLine{13332\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{13333\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_stages;\ i++)\ \{}
\DoxyCodeLine{13334\ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13335\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ \_target\_texture-\/>get\_on\_texture(stage);}
\DoxyCodeLine{13336\ \ \ \ \ nassertv(texture\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{13337\ }
\DoxyCodeLine{13338\ \ \ \ \ \mbox{\hyperlink{classTextureContext}{TextureContext}}\ *tc\ =\ texture-\/>prepare\_now(\_prepared\_objects,\ \textcolor{keyword}{this});}
\DoxyCodeLine{13339\ \ \ \ \ \textcolor{keywordflow}{if}\ (tc\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{13340\ \ \ \ \ \ \ \textcolor{comment}{//\ Something\ wrong\ with\ this\ texture;\ skip\ it.}}
\DoxyCodeLine{13341\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13342\ \ \ \ \ \}}
\DoxyCodeLine{13343\ \ \ \ \ tc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_graphics\_memory\_lru);}
\DoxyCodeLine{13344\ \ \ \}}
\DoxyCodeLine{13345\ }
\DoxyCodeLine{13346\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13347\ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{13348\ \ \ \ \ \textcolor{comment}{//\ Disable\ all\ texture\ stages.}}
\DoxyCodeLine{13349\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \_num\_active\_texture\_stages;\ i++)\ \{}
\DoxyCodeLine{13350\ \ \ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13351\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13352\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_1D);}
\DoxyCodeLine{13353\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13354\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_2D);}
\DoxyCodeLine{13355\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{13356\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13357\ \ \ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_3D);}
\DoxyCodeLine{13358\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{13359\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13360\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13361\ \ \ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_CUBE\_MAP);}
\DoxyCodeLine{13362\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13363\ \ \ \ \ \}}
\DoxyCodeLine{13364\ \ \ \}}
\DoxyCodeLine{13365\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13366\ }
\DoxyCodeLine{13367\ \ \ \textcolor{comment}{//\ Save\ the\ count\ of\ texture\ stages\ for\ next\ time.}}
\DoxyCodeLine{13368\ \ \ \_num\_active\_texture\_stages\ =\ num\_stages;}
\DoxyCodeLine{13369\ }
\DoxyCodeLine{13370\ \ \ \textcolor{keywordflow}{if}\ (num\_stages\ >\ 0)\ \{}
\DoxyCodeLine{13371\ \ \ \ \ \textcolor{comment}{//\ Now,\ pick\ just\ one\ texture\ stage\ to\ apply.}}
\DoxyCodeLine{13372\ \ \ \ \ \textcolor{keywordflow}{if}\ (show\_stage\_index\ >=\ 0\ \&\&\ show\_stage\_index\ <\ num\_stages)\ \{}
\DoxyCodeLine{13373\ \ \ \ \ \ \ i\ =\ show\_stage\_index;}
\DoxyCodeLine{13374\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13375\ \ \ \ \ \ \ i\ =\ \_show\_texture\_usage\_index\ \%\ num\_stages;}
\DoxyCodeLine{13376\ \ \ \ \ \}}
\DoxyCodeLine{13377\ }
\DoxyCodeLine{13378\ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13379\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ \_target\_texture-\/>get\_on\_texture(stage);}
\DoxyCodeLine{13380\ \ \ \ \ nassertv(texture\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{13381\ }
\DoxyCodeLine{13382\ \ \ \ \ \textcolor{comment}{//\ Choose\ the\ corresponding\ usage\ texture\ and\ apply\ it.}}
\DoxyCodeLine{13383\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13384\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13385\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{13386\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_2D);}
\DoxyCodeLine{13387\ \ \ \ \ \}}
\DoxyCodeLine{13388\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13389\ }
\DoxyCodeLine{13390\ \ \ \ \ UsageTextureKey\ key(texture-\/>get\_x\_size(),\ texture-\/>get\_y\_size());}
\DoxyCodeLine{13391\ \ \ \ \ UsageTextures::iterator\ ui\ =\ \_usage\_textures.find(key);}
\DoxyCodeLine{13392\ \ \ \ \ GLuint\ index;}
\DoxyCodeLine{13393\ \ \ \ \ \textcolor{keywordflow}{if}\ (ui\ ==\ \_usage\_textures.end())\ \{}
\DoxyCodeLine{13394\ \ \ \ \ \ \ \textcolor{comment}{//\ Need\ to\ create\ a\ new\ texture\ for\ this\ size.}}
\DoxyCodeLine{13395\ \ \ \ \ \ \ glGenTextures(1,\ \&index);}
\DoxyCodeLine{13396\ \ \ \ \ \ \ glBindTexture(GL\_TEXTURE\_2D,\ index);}
\DoxyCodeLine{13397\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ this\ could\ be\ a\ lot\ simpler\ with\ glTexStorage2D\ followed\ by\ a}}
\DoxyCodeLine{13398\ \ \ \ \ \ \ \textcolor{comment}{//\ call\ to\ glClearTexImage.}}
\DoxyCodeLine{13399\ \ \ \ \ \ \ upload\_usage\_texture(texture-\/>get\_x\_size(),\ texture-\/>get\_y\_size());}
\DoxyCodeLine{13400\ \ \ \ \ \ \ \_usage\_textures[key]\ =\ index;}
\DoxyCodeLine{13401\ }
\DoxyCodeLine{13402\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13403\ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ bind\ the\ previously-\/created\ texture.}}
\DoxyCodeLine{13404\ \ \ \ \ \ \ index\ =\ (*ui).second;}
\DoxyCodeLine{13405\ \ \ \ \ \ \ glBindTexture(GL\_TEXTURE\_2D,\ index);}
\DoxyCodeLine{13406\ \ \ \ \ \}}
\DoxyCodeLine{13407\ }
\DoxyCodeLine{13408\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{13409\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{13410\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(GL\_TEXTURE\_2D,\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{13411\ \ \ \ \ \}}
\DoxyCodeLine{13412\ }
\DoxyCodeLine{13413\ \ \ \ \ \textcolor{comment}{//\ TODO:\ glBindSampler(0)\ ?}}
\DoxyCodeLine{13414\ \ \ \}}
\DoxyCodeLine{13415\ }
\DoxyCodeLine{13416\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13417\ \}}
\DoxyCodeLine{13418\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{13419\ }
\DoxyCodeLine{13420\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{13425\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13426\ upload\_usage\_texture(int\ width,\ int\ height)\ \{}
\DoxyCodeLine{13427\ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_WRAP\_S,\ GL\_REPEAT);}
\DoxyCodeLine{13428\ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_WRAP\_T,\ GL\_REPEAT);}
\DoxyCodeLine{13429\ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_MIN\_FILTER,\ GL\_NEAREST\_MIPMAP\_NEAREST);}
\DoxyCodeLine{13430\ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_MAG\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13431\ }
\DoxyCodeLine{13432\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{13433\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{13434\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}upload\_usage\_texture("{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{13435\ \ \ \}}
\DoxyCodeLine{13436\ }
\DoxyCodeLine{13437\ \ \ \textcolor{keyword}{static}\ LColor\ colors[3]\ =\ \{}
\DoxyCodeLine{13438\ \ \ \ \ LColor(0.4,\ 0.5f,\ 0.8f,\ 1.0f),\ \ \ \textcolor{comment}{//\ mipmap\ 0:\ blue}}
\DoxyCodeLine{13439\ \ \ \ \ LColor(1.0f,\ 1.0f,\ 0.0f,\ 1.0f),\ \ \ \textcolor{comment}{//\ mipmap\ 1:\ yellow}}
\DoxyCodeLine{13440\ \ \ \ \ LColor(0.8f,\ 0.3,\ 0.3,\ 1.0f),\ \ \ \textcolor{comment}{//\ mipmap\ 2\ and\ higher:\ red}}
\DoxyCodeLine{13441\ \ \ \};}
\DoxyCodeLine{13442\ }
\DoxyCodeLine{13443\ }
\DoxyCodeLine{13444\ \ \ \textcolor{comment}{//\ Allocate\ a\ temporary\ array\ large\ enough\ to\ contain\ the\ toplevel\ mipmap.}}
\DoxyCodeLine{13445\ \ \ uint32\_t\ *buffer\ =\ (uint32\_t\ *)PANDA\_MALLOC\_ARRAY(width\ *\ height\ *\ 4);}
\DoxyCodeLine{13446\ }
\DoxyCodeLine{13447\ \ \ \textcolor{keywordtype}{int}\ n\ =\ 0;}
\DoxyCodeLine{13448\ \ \ \textcolor{keywordflow}{while}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{13449\ \ \ \ \ \textcolor{comment}{//\ Choose\ the\ color\ for\ the\ nth\ mipmap.}}
\DoxyCodeLine{13450\ \ \ \ \ LColor\ c\ =\ colors[min(n,\ 2)];}
\DoxyCodeLine{13451\ }
\DoxyCodeLine{13452\ \ \ \ \ \textcolor{comment}{//\ A\ simple\ union\ to\ store\ the\ colors\ values\ bytewise,\ and\ get\ the\ answer}}
\DoxyCodeLine{13453\ \ \ \ \ \textcolor{comment}{//\ wordwise,\ independently\ of\ machine\ byte-\/ordernig.}}
\DoxyCodeLine{13454\ \ \ \ \ \textcolor{keyword}{union\ }\{}
\DoxyCodeLine{13455\ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{13456\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ r,\ g,\ b,\ a;}
\DoxyCodeLine{13457\ \ \ \ \ \ \ \}\ b;}
\DoxyCodeLine{13458\ \ \ \ \ \ \ uint32\_t\ w;}
\DoxyCodeLine{13459\ \ \ \ \ \}\ store;}
\DoxyCodeLine{13460\ }
\DoxyCodeLine{13461\ \ \ \ \ store.b.r\ =\ (\textcolor{keywordtype}{unsigned}\ char)(c[0]\ *\ 255.0f);}
\DoxyCodeLine{13462\ \ \ \ \ store.b.g\ =\ (\textcolor{keywordtype}{unsigned}\ char)(c[1]\ *\ 255.0f);}
\DoxyCodeLine{13463\ \ \ \ \ store.b.b\ =\ (\textcolor{keywordtype}{unsigned}\ char)(c[2]\ *\ 255.0f);}
\DoxyCodeLine{13464\ \ \ \ \ store.b.a\ =\ 0xff;}
\DoxyCodeLine{13465\ }
\DoxyCodeLine{13466\ \ \ \ \ \textcolor{comment}{//\ Fill\ in\ the\ array.}}
\DoxyCodeLine{13467\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pixels\ =\ width\ *\ height;}
\DoxyCodeLine{13468\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ p\ =\ 0;\ p\ <\ num\_pixels;\ ++p)\ \{}
\DoxyCodeLine{13469\ \ \ \ \ \ \ buffer[p]\ =\ store.w;}
\DoxyCodeLine{13470\ \ \ \ \ \}}
\DoxyCodeLine{13471\ }
\DoxyCodeLine{13472\ \ \ \ \ glTexImage2D(GL\_TEXTURE\_2D,\ n,\ GL\_RGBA,\ width,\ height,\ 0,}
\DoxyCodeLine{13473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_RGBA,\ GL\_UNSIGNED\_BYTE,\ buffer);}
\DoxyCodeLine{13474\ \ \ \ \ \textcolor{keywordflow}{if}\ (width\ ==\ 1\ \&\&\ height\ ==\ 1)\ \{}
\DoxyCodeLine{13475\ \ \ \ \ \ \ \textcolor{comment}{//\ That\ was\ the\ last\ mipmap\ level.}}
\DoxyCodeLine{13476\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13477\ \ \ \ \ \}}
\DoxyCodeLine{13478\ }
\DoxyCodeLine{13479\ \ \ \ \ width\ =\ max(width\ >>\ 1,\ 1);}
\DoxyCodeLine{13480\ \ \ \ \ height\ =\ max(height\ >>\ 1,\ 1);}
\DoxyCodeLine{13481\ \ \ \ \ ++n;}
\DoxyCodeLine{13482\ \ \ \}}
\DoxyCodeLine{13483\ }
\DoxyCodeLine{13484\ \ \ PANDA\_FREE\_ARRAY(buffer);}
\DoxyCodeLine{13485\ \}}
\DoxyCodeLine{13486\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{13487\ }
\DoxyCodeLine{13488\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13492\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13493\ disable\_standard\_texture\_bindings()\ \{}
\DoxyCodeLine{13494\ \ \ \textcolor{comment}{//\ Disable\ the\ texture\ stages\ that\ are\ no\ longer\ used.}}
\DoxyCodeLine{13495\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_num\_active\_texture\_stages;\ i++)\ \{}
\DoxyCodeLine{13496\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13497\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13498\ \ \ \ \ glDisable(GL\_TEXTURE\_1D);}
\DoxyCodeLine{13499\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13500\ \ \ \ \ glDisable(GL\_TEXTURE\_2D);}
\DoxyCodeLine{13501\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{13502\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13503\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_3D);}
\DoxyCodeLine{13504\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{13505\ \ \ \ \ \}}
\DoxyCodeLine{13506\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13507\ \ \ \ \ \ \ glDisable(GL\_TEXTURE\_CUBE\_MAP);}
\DoxyCodeLine{13508\ \ \ \ \ \}}
\DoxyCodeLine{13509\ \ \ \}}
\DoxyCodeLine{13510\ }
\DoxyCodeLine{13511\ \ \ \_num\_active\_texture\_stages\ =\ 0;}
\DoxyCodeLine{13512\ }
\DoxyCodeLine{13513\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13514\ \}}
\DoxyCodeLine{13515\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13516\ }
\DoxyCodeLine{13517\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13521\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13522\ do\_issue\_tex\_matrix()\ \{}
\DoxyCodeLine{13523\ \ \ nassertv(\_num\_active\_texture\_stages\ <=\ \_max\_texture\_stages);}
\DoxyCodeLine{13524\ }
\DoxyCodeLine{13525\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_num\_active\_texture\_stages;\ i++)\ \{}
\DoxyCodeLine{13526\ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13527\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13528\ }
\DoxyCodeLine{13529\ \ \ \ \ glMatrixMode(GL\_TEXTURE);}
\DoxyCodeLine{13530\ }
\DoxyCodeLine{13531\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTexMatrixAttrib}{TexMatrixAttrib}}\ *target\_tex\_matrix;}
\DoxyCodeLine{13532\ \ \ \ \ \_target\_rs-\/>get\_attrib\_def(target\_tex\_matrix);}
\DoxyCodeLine{13533\ }
\DoxyCodeLine{13534\ \ \ \ \ \textcolor{keywordflow}{if}\ (target\_tex\_matrix-\/>has\_stage(stage))\ \{}
\DoxyCodeLine{13535\ \ \ \ \ \ \ call\_glLoadMatrix(target\_tex\_matrix-\/>get\_mat(stage));}
\DoxyCodeLine{13536\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13537\ \ \ \ \ \ \ glLoadIdentity();}
\DoxyCodeLine{13538\ }
\DoxyCodeLine{13539\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ some\ reason,\ the\ glLoadIdentity()\ call\ doesn't\ work\ on\ my\ Dell}}
\DoxyCodeLine{13540\ \ \ \ \ \ \ \textcolor{comment}{//\ laptop's\ IBM\ OpenGL\ driver,\ when\ used\ in\ conjunction\ with\ glTexGen(),}}
\DoxyCodeLine{13541\ \ \ \ \ \ \ \textcolor{comment}{//\ below.\ \ But\ explicitly\ loading\ an\ identity\ matrix\ does\ work.\ \ But}}
\DoxyCodeLine{13542\ \ \ \ \ \ \ \textcolor{comment}{//\ this\ buggy-\/driver\ workaround\ might\ have\ other\ performance}}
\DoxyCodeLine{13543\ \ \ \ \ \ \ \textcolor{comment}{//\ implications,\ so\ I\ leave\ it\ out.}}
\DoxyCodeLine{13544\ \ \ \ \ \ \ \textcolor{comment}{//\ call\_glLoadMatrix(LMatrix4::ident\_mat());}}
\DoxyCodeLine{13545\ \ \ \ \ \}}
\DoxyCodeLine{13546\ \ \ \}}
\DoxyCodeLine{13547\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13548\ \}}
\DoxyCodeLine{13549\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13550\ }
\DoxyCodeLine{13551\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13555\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13556\ do\_issue\_tex\_gen()\ \{}
\DoxyCodeLine{13557\ \ \ nassertv(\_num\_active\_texture\_stages\ <=\ \_max\_texture\_stages);}
\DoxyCodeLine{13558\ }
\DoxyCodeLine{13559\ \ \ \textcolor{comment}{//\ These\ are\ passed\ in\ for\ the\ four\ OBJECT\_PLANE\ or\ EYE\_PLANE\ values;\ they}}
\DoxyCodeLine{13560\ \ \ \textcolor{comment}{//\ effectively\ define\ an\ identity\ matrix\ that\ maps\ the\ spatial\ coordinates}}
\DoxyCodeLine{13561\ \ \ \textcolor{comment}{//\ one-\/for-\/one\ to\ UV's.\ \ If\ you\ want\ a\ mapping\ other\ than\ identity,\ use\ a}}
\DoxyCodeLine{13562\ \ \ \textcolor{comment}{//\ TexMatrixAttrib\ (or\ a\ TexProjectorEffect).}}
\DoxyCodeLine{13563\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13564\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ s\_data[4]\ =\ \{\ 1,\ 0,\ 0,\ 0\ \};}
\DoxyCodeLine{13565\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ t\_data[4]\ =\ \{\ 0,\ 1,\ 0,\ 0\ \};}
\DoxyCodeLine{13566\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ r\_data[4]\ =\ \{\ 0,\ 0,\ 1,\ 0\ \};}
\DoxyCodeLine{13567\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ PN\_stdfloat\ q\_data[4]\ =\ \{\ 0,\ 0,\ 0,\ 1\ \};}
\DoxyCodeLine{13568\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13569\ }
\DoxyCodeLine{13570\ \ \ \_tex\_gen\_modifies\_mat\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{13571\ }
\DoxyCodeLine{13572\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ \_num\_active\_texture\_stages;\ i++)\ \{}
\DoxyCodeLine{13573\ \ \ \ \ set\_active\_texture\_stage(i);}
\DoxyCodeLine{13574\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_point\_sprite)\ \{}
\DoxyCodeLine{13575\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{13576\ \ \ \ \ \ \ glTexEnvi(GL\_POINT\_SPRITE\_OES,\ GL\_COORD\_REPLACE\_OES,\ GL\_FALSE);}
\DoxyCodeLine{13577\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{13578\ \ \ \ \ \ \ glTexEnvi(GL\_POINT\_SPRITE\_ARB,\ GL\_COORD\_REPLACE\_ARB,\ GL\_FALSE);}
\DoxyCodeLine{13579\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13580\ \ \ \ \ \}}
\DoxyCodeLine{13581\ }
\DoxyCodeLine{13582\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\ \ }\textcolor{comment}{//\ TexGen\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{13583\ \ \ \ \ glDisable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13584\ \ \ \ \ glDisable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13585\ \ \ \ \ glDisable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13586\ \ \ \ \ glDisable(GL\_TEXTURE\_GEN\_Q);}
\DoxyCodeLine{13587\ }
\DoxyCodeLine{13588\ \ \ \ \ \mbox{\hyperlink{classTextureStage}{TextureStage}}\ *stage\ =\ \_target\_texture-\/>get\_on\_ff\_stage(i);}
\DoxyCodeLine{13589\ \ \ \ \ TexGenAttrib::Mode\ mode\ =\ \_target\_tex\_gen-\/>get\_mode(stage);}
\DoxyCodeLine{13590\ \ \ \ \ \textcolor{keywordflow}{switch}\ (mode)\ \{}
\DoxyCodeLine{13591\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_off:}
\DoxyCodeLine{13592\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_unused2:}
\DoxyCodeLine{13593\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13594\ }
\DoxyCodeLine{13595\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_eye\_sphere\_map:}
\DoxyCodeLine{13596\ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_SPHERE\_MAP);}
\DoxyCodeLine{13597\ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_SPHERE\_MAP);}
\DoxyCodeLine{13598\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13599\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13600\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13601\ }
\DoxyCodeLine{13602\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_eye\_cube\_map:}
\DoxyCodeLine{13603\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13604\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ rotate\ the\ normals\ out\ of\ GL's\ coordinate\ system\ and}}
\DoxyCodeLine{13605\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ into\ the\ user's\ coordinate\ system.\ \ We\ do\ this\ by\ composing\ a}}
\DoxyCodeLine{13606\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ onto\ the\ texture\ matrix.}}
\DoxyCodeLine{13607\ \ \ \ \ \ \ \ \ LMatrix4\ mat\ =\ \_inv\_cs\_transform-\/>get\_mat();}
\DoxyCodeLine{13608\ \ \ \ \ \ \ \ \ mat.set\_row(3,\ LVecBase3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{13609\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_TEXTURE);}
\DoxyCodeLine{13610\ \ \ \ \ \ \ \ \ GLPf(MultMatrix)(mat.get\_data());}
\DoxyCodeLine{13611\ }
\DoxyCodeLine{13612\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ need\ to\ reset\ the\ texture\ matrix\ next\ time\ around\ to\ undo}}
\DoxyCodeLine{13613\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this.}}
\DoxyCodeLine{13614\ \ \ \ \ \ \ \ \ \_tex\_gen\_modifies\_mat\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13615\ }
\DoxyCodeLine{13616\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13617\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13618\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13619\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13620\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13621\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13622\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13623\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13624\ }
\DoxyCodeLine{13625\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_world\_cube\_map:}
\DoxyCodeLine{13626\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13627\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ dynamically\ transform\ normals\ from\ eye\ space\ to\ world\ space\ by}}
\DoxyCodeLine{13628\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ applying\ the\ appropriate\ rotation\ transform\ to\ the\ current\ texture}}
\DoxyCodeLine{13629\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ matrix.\ \ Unlike\ M\_world\_position,\ we\ can't\ achieve\ this\ effect\ by}}
\DoxyCodeLine{13630\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ monkeying\ with\ the\ modelview\ transform,\ since\ the\ current\ modelview}}
\DoxyCodeLine{13631\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ doesn't\ affect\ GL\_REFLECTION\_MAP.}}
\DoxyCodeLine{13632\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ camera\_transform\ =\ \_scene\_setup-\/>get\_camera\_transform()-\/>compose(\_inv\_cs\_transform);}
\DoxyCodeLine{13633\ }
\DoxyCodeLine{13634\ \ \ \ \ \ \ \ \ LMatrix4\ mat\ =\ camera\_transform-\/>get\_mat();}
\DoxyCodeLine{13635\ \ \ \ \ \ \ \ \ mat.set\_row(3,\ LVecBase3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{13636\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_TEXTURE);}
\DoxyCodeLine{13637\ \ \ \ \ \ \ \ \ GLPf(MultMatrix)(mat.get\_data());}
\DoxyCodeLine{13638\ }
\DoxyCodeLine{13639\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ need\ to\ reset\ the\ texture\ matrix\ next\ time\ around\ to\ undo}}
\DoxyCodeLine{13640\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this.}}
\DoxyCodeLine{13641\ \ \ \ \ \ \ \ \ \_tex\_gen\_modifies\_mat\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13642\ }
\DoxyCodeLine{13643\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13644\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13645\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_REFLECTION\_MAP);}
\DoxyCodeLine{13646\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13647\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13648\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13649\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13650\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13651\ }
\DoxyCodeLine{13652\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_eye\_normal:}
\DoxyCodeLine{13653\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13654\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ rotate\ the\ normals\ out\ of\ GL's\ coordinate\ system\ and}}
\DoxyCodeLine{13655\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ into\ the\ user's\ coordinate\ system.\ \ We\ do\ this\ by\ composing\ a}}
\DoxyCodeLine{13656\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ onto\ the\ texture\ matrix.}}
\DoxyCodeLine{13657\ \ \ \ \ \ \ \ \ LMatrix4\ mat\ =\ \_inv\_cs\_transform-\/>get\_mat();}
\DoxyCodeLine{13658\ \ \ \ \ \ \ \ \ mat.set\_row(3,\ LVecBase3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{13659\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_TEXTURE);}
\DoxyCodeLine{13660\ \ \ \ \ \ \ \ \ GLPf(MultMatrix)(mat.get\_data());}
\DoxyCodeLine{13661\ }
\DoxyCodeLine{13662\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ need\ to\ reset\ the\ texture\ matrix\ next\ time\ around\ to\ undo}}
\DoxyCodeLine{13663\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this.}}
\DoxyCodeLine{13664\ \ \ \ \ \ \ \ \ \_tex\_gen\_modifies\_mat\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13665\ }
\DoxyCodeLine{13666\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13667\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13668\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13669\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13670\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13671\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13672\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13673\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13674\ }
\DoxyCodeLine{13675\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_world\_normal:}
\DoxyCodeLine{13676\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_cube\_map)\ \{}
\DoxyCodeLine{13677\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ dynamically\ transform\ normals\ from\ eye\ space\ to\ world\ space\ by}}
\DoxyCodeLine{13678\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ applying\ the\ appropriate\ rotation\ transform\ to\ the\ current\ texture}}
\DoxyCodeLine{13679\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ matrix.\ \ Unlike\ M\_world\_position,\ we\ can't\ achieve\ this\ effect\ by}}
\DoxyCodeLine{13680\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ monkeying\ with\ the\ modelview\ transform,\ since\ the\ current\ modelview}}
\DoxyCodeLine{13681\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ doesn't\ affect\ GL\_NORMAL\_MAP.}}
\DoxyCodeLine{13682\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ camera\_transform\ =\ \_scene\_setup-\/>get\_camera\_transform()-\/>compose(\_inv\_cs\_transform);}
\DoxyCodeLine{13683\ }
\DoxyCodeLine{13684\ \ \ \ \ \ \ \ \ LMatrix4\ mat\ =\ camera\_transform-\/>get\_mat();}
\DoxyCodeLine{13685\ \ \ \ \ \ \ \ \ mat.set\_row(3,\ LVecBase3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{13686\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_TEXTURE);}
\DoxyCodeLine{13687\ \ \ \ \ \ \ \ \ GLPf(MultMatrix)(mat.get\_data());}
\DoxyCodeLine{13688\ }
\DoxyCodeLine{13689\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ need\ to\ reset\ the\ texture\ matrix\ next\ time\ around\ to\ undo}}
\DoxyCodeLine{13690\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ this.}}
\DoxyCodeLine{13691\ \ \ \ \ \ \ \ \ \_tex\_gen\_modifies\_mat\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13692\ }
\DoxyCodeLine{13693\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13694\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13695\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_NORMAL\_MAP);}
\DoxyCodeLine{13696\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13697\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13698\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13699\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13700\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13701\ }
\DoxyCodeLine{13702\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_eye\_position:}
\DoxyCodeLine{13703\ \ \ \ \ \ \ \textcolor{comment}{//\ To\ represent\ eye\ position\ correctly,\ we\ need\ to\ temporarily\ load\ the}}
\DoxyCodeLine{13704\ \ \ \ \ \ \ \textcolor{comment}{//\ coordinate-\/system\ transform.}}
\DoxyCodeLine{13705\ \ \ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{13706\ \ \ \ \ \ \ glPushMatrix();}
\DoxyCodeLine{13707\ \ \ \ \ \ \ call\_glLoadMatrix(\_cs\_transform-\/>get\_mat());}
\DoxyCodeLine{13708\ }
\DoxyCodeLine{13709\ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13710\ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13711\ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13712\ \ \ \ \ \ \ glTexGeni(GL\_Q,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13713\ }
\DoxyCodeLine{13714\ \ \ \ \ \ \ GLPfv(TexGen)(GL\_S,\ GL\_EYE\_PLANE,\ s\_data);}
\DoxyCodeLine{13715\ \ \ \ \ \ \ GLPfv(TexGen)(GL\_T,\ GL\_EYE\_PLANE,\ t\_data);}
\DoxyCodeLine{13716\ \ \ \ \ \ \ GLPfv(TexGen)(GL\_R,\ GL\_EYE\_PLANE,\ r\_data);}
\DoxyCodeLine{13717\ \ \ \ \ \ \ GLPfv(TexGen)(GL\_Q,\ GL\_EYE\_PLANE,\ q\_data);}
\DoxyCodeLine{13718\ }
\DoxyCodeLine{13719\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13720\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13721\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13722\ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_Q);}
\DoxyCodeLine{13723\ }
\DoxyCodeLine{13724\ \ \ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{13725\ \ \ \ \ \ \ glPopMatrix();}
\DoxyCodeLine{13726\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13727\ }
\DoxyCodeLine{13728\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_world\_position:}
\DoxyCodeLine{13729\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ achieve\ world\ position\ coordinates\ by\ using\ the\ eye\ position\ mode,}}
\DoxyCodeLine{13730\ \ \ \ \ \ \ \textcolor{comment}{//\ and\ loading\ the\ transform\ of\ the\ root\ node-\/-\/thus\ putting\ the\ "{}eye"{}\ at}}
\DoxyCodeLine{13731\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ root.}}
\DoxyCodeLine{13732\ \ \ \ \ \ \ \{}
\DoxyCodeLine{13733\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{13734\ \ \ \ \ \ \ \ \ glPushMatrix();}
\DoxyCodeLine{13735\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ root\_transform\ =\ \_cs\_transform-\/>compose(\_scene\_setup-\/>get\_world\_transform());}
\DoxyCodeLine{13736\ \ \ \ \ \ \ \ \ call\_glLoadMatrix(root\_transform-\/>get\_mat());}
\DoxyCodeLine{13737\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13738\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13739\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13740\ \ \ \ \ \ \ \ \ glTexGeni(GL\_Q,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_EYE\_LINEAR);}
\DoxyCodeLine{13741\ }
\DoxyCodeLine{13742\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_S,\ GL\_EYE\_PLANE,\ s\_data);}
\DoxyCodeLine{13743\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_T,\ GL\_EYE\_PLANE,\ t\_data);}
\DoxyCodeLine{13744\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_R,\ GL\_EYE\_PLANE,\ r\_data);}
\DoxyCodeLine{13745\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_Q,\ GL\_EYE\_PLANE,\ q\_data);}
\DoxyCodeLine{13746\ }
\DoxyCodeLine{13747\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13748\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13749\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13750\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_Q);}
\DoxyCodeLine{13751\ }
\DoxyCodeLine{13752\ \ \ \ \ \ \ \ \ glMatrixMode(GL\_MODELVIEW);}
\DoxyCodeLine{13753\ \ \ \ \ \ \ \ \ glPopMatrix();}
\DoxyCodeLine{13754\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13755\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13756\ }
\DoxyCodeLine{13757\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_point\_sprite:}
\DoxyCodeLine{13758\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_point\_sprite)\ \{}
\DoxyCodeLine{13759\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{13760\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_POINT\_SPRITE\_OES,\ GL\_COORD\_REPLACE\_OES,\ GL\_TRUE);}
\DoxyCodeLine{13761\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{13762\ \ \ \ \ \ \ \ \ glTexEnvi(GL\_POINT\_SPRITE\_ARB,\ GL\_COORD\_REPLACE\_ARB,\ GL\_TRUE);}
\DoxyCodeLine{13763\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13764\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13765\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13766\ }
\DoxyCodeLine{13767\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_constant:}
\DoxyCodeLine{13768\ \ \ \ \ \ \ \textcolor{comment}{//\ To\ generate\ a\ constant\ UV(w)\ coordinate\ everywhere,\ we\ use\ EYE\_LINEAR}}
\DoxyCodeLine{13769\ \ \ \ \ \ \ \textcolor{comment}{//\ mode,\ but\ we\ construct\ a\ special\ matrix\ that\ flattens\ the\ vertex}}
\DoxyCodeLine{13770\ \ \ \ \ \ \ \textcolor{comment}{//\ position\ to\ zero\ and\ then\ adds\ our\ desired\ value.}}
\DoxyCodeLine{13771\ \ \ \ \ \ \ \{}
\DoxyCodeLine{13772\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LTexCoord3\ \&v\ =\ \_target\_tex\_gen-\/>get\_constant\_value(stage);}
\DoxyCodeLine{13773\ }
\DoxyCodeLine{13774\ \ \ \ \ \ \ \ \ glTexGeni(GL\_S,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_OBJECT\_LINEAR);}
\DoxyCodeLine{13775\ \ \ \ \ \ \ \ \ glTexGeni(GL\_T,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_OBJECT\_LINEAR);}
\DoxyCodeLine{13776\ \ \ \ \ \ \ \ \ glTexGeni(GL\_R,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_OBJECT\_LINEAR);}
\DoxyCodeLine{13777\ \ \ \ \ \ \ \ \ glTexGeni(GL\_Q,\ GL\_TEXTURE\_GEN\_MODE,\ GL\_OBJECT\_LINEAR);}
\DoxyCodeLine{13778\ }
\DoxyCodeLine{13779\ \ \ \ \ \ \ \ \ LVecBase4\ s(0.0f,\ 0.0f,\ 0.0f,\ v[0]);}
\DoxyCodeLine{13780\ \ \ \ \ \ \ \ \ LVecBase4\ t(0.0f,\ 0.0f,\ 0.0f,\ v[1]);}
\DoxyCodeLine{13781\ \ \ \ \ \ \ \ \ LVecBase4\ r(0.0f,\ 0.0f,\ 0.0f,\ v[2]);}
\DoxyCodeLine{13782\ }
\DoxyCodeLine{13783\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_S,\ GL\_OBJECT\_PLANE,\ s.get\_data());}
\DoxyCodeLine{13784\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_T,\ GL\_OBJECT\_PLANE,\ t.get\_data());}
\DoxyCodeLine{13785\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_R,\ GL\_OBJECT\_PLANE,\ r.get\_data());}
\DoxyCodeLine{13786\ \ \ \ \ \ \ \ \ GLPfv(TexGen)(GL\_Q,\ GL\_OBJECT\_PLANE,\ q\_data);}
\DoxyCodeLine{13787\ }
\DoxyCodeLine{13788\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_S);}
\DoxyCodeLine{13789\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_T);}
\DoxyCodeLine{13790\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_R);}
\DoxyCodeLine{13791\ \ \ \ \ \ \ \ \ glEnable(GL\_TEXTURE\_GEN\_Q);}
\DoxyCodeLine{13792\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13793\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13794\ }
\DoxyCodeLine{13795\ \ \ \ \ \textcolor{keywordflow}{case}\ TexGenAttrib::M\_unused:}
\DoxyCodeLine{13796\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{13797\ \ \ \ \ \}}
\DoxyCodeLine{13798\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13799\ \ \ \}}
\DoxyCodeLine{13800\ }
\DoxyCodeLine{13801\ \ \ \textcolor{keywordtype}{bool}\ got\_point\_sprites\ =\ \_supports\_point\_sprite\ \&\&}
\DoxyCodeLine{13802\ \ \ \ \ (\_target\_tex\_gen-\/>get\_geom\_rendering(Geom::GR\_point)\ \&\ GeomEnums::GR\_point\_sprite)\ !=\ 0;}
\DoxyCodeLine{13803\ }
\DoxyCodeLine{13804\ \ \ \textcolor{keywordflow}{if}\ (got\_point\_sprites\ !=\ \_tex\_gen\_point\_sprite)\ \{}
\DoxyCodeLine{13805\ \ \ \ \ \_tex\_gen\_point\_sprite\ =\ got\_point\_sprites;}
\DoxyCodeLine{13806\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{13807\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tex\_gen\_point\_sprite)\ \{}
\DoxyCodeLine{13808\ \ \ \ \ \ \ glEnable(GL\_POINT\_SPRITE\_OES);}
\DoxyCodeLine{13809\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13810\ \ \ \ \ \ \ glDisable(GL\_POINT\_SPRITE\_OES);}
\DoxyCodeLine{13811\ \ \ \ \ \}}
\DoxyCodeLine{13812\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{13813\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tex\_gen\_point\_sprite)\ \{}
\DoxyCodeLine{13814\ \ \ \ \ \ \ glEnable(GL\_POINT\_SPRITE\_ARB);}
\DoxyCodeLine{13815\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13816\ \ \ \ \ \ \ glDisable(GL\_POINT\_SPRITE\_ARB);}
\DoxyCodeLine{13817\ \ \ \ \ \}}
\DoxyCodeLine{13818\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13819\ \ \ \}}
\DoxyCodeLine{13820\ }
\DoxyCodeLine{13821\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13822\ \}}
\DoxyCodeLine{13823\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13824\ }
\DoxyCodeLine{13830\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13831\ specify\_texture(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ const\ \mbox{\hyperlink{classSamplerState}{SamplerState}}\ \&sampler)\ \{}
\DoxyCodeLine{13832\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{13833\ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{13834\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_NONE)\ \{}
\DoxyCodeLine{13835\ \ \ \ \ \textcolor{comment}{//\ Unsupported\ target\ (e.g.\ \ 3-\/d\ texturing\ on\ GL\ 1.1).}}
\DoxyCodeLine{13836\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{13837\ \ \ \}}
\DoxyCodeLine{13838\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13839\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{13840\ \ \ \ \ \textcolor{comment}{//\ Buffer\ textures\ may\ not\ receive\ texture\ parameters.}}
\DoxyCodeLine{13841\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{13842\ \ \ \}}
\DoxyCodeLine{13843\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13844\ }
\DoxyCodeLine{13845\ \ \ \textcolor{comment}{//\ Record\ the\ active\ sampler\ settings.}}
\DoxyCodeLine{13846\ \ \ gtc-\/>\_active\_sampler\ =\ sampler;}
\DoxyCodeLine{13847\ }
\DoxyCodeLine{13848\ \ \ glTexParameteri(target,\ GL\_TEXTURE\_WRAP\_S,}
\DoxyCodeLine{13849\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_u()));}
\DoxyCodeLine{13850\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13851\ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_1D)}
\DoxyCodeLine{13852\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13853\ \ \ \{}
\DoxyCodeLine{13854\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_WRAP\_T,}
\DoxyCodeLine{13855\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_v()));}
\DoxyCodeLine{13856\ \ \ \}}
\DoxyCodeLine{13857\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13858\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_3D)\ \{}
\DoxyCodeLine{13859\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_WRAP\_R,}
\DoxyCodeLine{13860\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_wrap\_mode(sampler.get\_wrap\_w()));}
\DoxyCodeLine{13861\ \ \ \}}
\DoxyCodeLine{13862\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13863\ }
\DoxyCodeLine{13864\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13865\ \ \ LColor\ border\_color\ =\ sampler.get\_border\_color();}
\DoxyCodeLine{13866\ \ \ call\_glTexParameterfv(target,\ GL\_TEXTURE\_BORDER\_COLOR,\ border\_color);}
\DoxyCodeLine{13867\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{13868\ }
\DoxyCodeLine{13869\ \ \ SamplerState::FilterType\ minfilter\ =\ sampler.get\_effective\_minfilter();}
\DoxyCodeLine{13870\ \ \ SamplerState::FilterType\ magfilter\ =\ sampler.get\_effective\_magfilter();}
\DoxyCodeLine{13871\ \ \ \textcolor{keywordtype}{bool}\ uses\_mipmaps\ =\ SamplerState::is\_mipmap(minfilter)\ \&\&\ !gl\_ignore\_mipmaps;}
\DoxyCodeLine{13872\ }
\DoxyCodeLine{13873\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{13874\ \ \ \textcolor{keywordflow}{if}\ (gl\_force\_mipmaps)\ \{}
\DoxyCodeLine{13875\ \ \ \ \ minfilter\ =\ SamplerState::FT\_linear\_mipmap\_linear;}
\DoxyCodeLine{13876\ \ \ \ \ magfilter\ =\ SamplerState::FT\_linear;}
\DoxyCodeLine{13877\ \ \ \ \ uses\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{13878\ \ \ \}}
\DoxyCodeLine{13879\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13880\ }
\DoxyCodeLine{13881\ \ \ \textcolor{keywordflow}{if}\ (!tex-\/>might\_have\_ram\_image())\ \{}
\DoxyCodeLine{13882\ \ \ \ \ \textcolor{comment}{//\ If\ it's\ a\ dynamically\ generated\ texture\ (that\ is,\ the\ RAM\ image\ isn't}}
\DoxyCodeLine{13883\ \ \ \ \ \textcolor{comment}{//\ available\ so\ it\ didn't\ pass\ through\ the\ CPU),\ we\ should\ enable\ GL-\/}}
\DoxyCodeLine{13884\ \ \ \ \ \textcolor{comment}{//\ generated\ mipmaps\ if\ we\ can.}}
\DoxyCodeLine{13885\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_generate\_mipmap)\ \{}
\DoxyCodeLine{13886\ \ \ \ \ \ \ \textcolor{comment}{//\ However,\ if\ the\ GPU\ doesn't\ support\ mipmap\ generation,\ we\ have\ to}}
\DoxyCodeLine{13887\ \ \ \ \ \ \ \textcolor{comment}{//\ turn\ it\ off.}}
\DoxyCodeLine{13888\ \ \ \ \ \ \ uses\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{13889\ \ \ \ \ \}}
\DoxyCodeLine{13890\ \ \ \}}
\DoxyCodeLine{13891\ }
\DoxyCodeLine{13892\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexture_ab79a121187081015be45d321509da170}{Texture::is\_integer}}(tex-\/>get\_format()))\ \{}
\DoxyCodeLine{13893\ \ \ \ \ \textcolor{comment}{//\ Integer\ format\ textures\ can't\ have\ filtering\ enabled,\ and\ in\ fact,\ some}}
\DoxyCodeLine{13894\ \ \ \ \ \textcolor{comment}{//\ drivers\ (looking\ at\ you,\ Intel)\ will\ always\ sample\ (0,\ 0,\ 0,\ 1)\ if\ we}}
\DoxyCodeLine{13895\ \ \ \ \ \textcolor{comment}{//\ don't\ set\ this\ correctly!}}
\DoxyCodeLine{13896\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MIN\_FILTER,}
\DoxyCodeLine{13897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uses\_mipmaps\ ?\ GL\_NEAREST\_MIPMAP\_NEAREST}
\DoxyCodeLine{13898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ GL\_NEAREST);}
\DoxyCodeLine{13899\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAG\_FILTER,\ GL\_NEAREST);}
\DoxyCodeLine{13900\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13901\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MIN\_FILTER,}
\DoxyCodeLine{13902\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_filter\_type(minfilter,\ !uses\_mipmaps));}
\DoxyCodeLine{13903\ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAG\_FILTER,}
\DoxyCodeLine{13904\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_texture\_filter\_type(magfilter,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{13905\ \ \ \}}
\DoxyCodeLine{13906\ }
\DoxyCodeLine{13907\ \ \ \textcolor{comment}{//\ Set\ anisotropic\ filtering.}}
\DoxyCodeLine{13908\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_anisotropy)\ \{}
\DoxyCodeLine{13909\ \ \ \ \ PN\_stdfloat\ anisotropy\ =\ sampler.get\_effective\_anisotropic\_degree();}
\DoxyCodeLine{13910\ \ \ \ \ anisotropy\ =\ min(anisotropy,\ \_max\_anisotropy);}
\DoxyCodeLine{13911\ \ \ \ \ anisotropy\ =\ max(anisotropy,\ (PN\_stdfloat)1.0);}
\DoxyCodeLine{13912\ \ \ \ \ glTexParameterf(target,\ GL\_TEXTURE\_MAX\_ANISOTROPY\_EXT,\ anisotropy);}
\DoxyCodeLine{13913\ \ \ \}}
\DoxyCodeLine{13914\ }
\DoxyCodeLine{13915\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13916\ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_format()\ ==\ Texture::F\_depth\_stencil\ ||}
\DoxyCodeLine{13917\ \ \ \ \ \ \ tex-\/>get\_format()\ ==\ Texture::F\_depth\_component\ ||}
\DoxyCodeLine{13918\ \ \ \ \ \ \ tex-\/>get\_format()\ ==\ Texture::F\_depth\_component16\ ||}
\DoxyCodeLine{13919\ \ \ \ \ \ \ tex-\/>get\_format()\ ==\ Texture::F\_depth\_component24\ ||}
\DoxyCodeLine{13920\ \ \ \ \ \ \ tex-\/>get\_format()\ ==\ Texture::F\_depth\_component32)\ \{}
\DoxyCodeLine{13921\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{13922\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_fixed\_function\_pipeline())\ \{}
\DoxyCodeLine{13923\ \ \ \ \ \ \ glTexParameteri(target,\ GL\_DEPTH\_TEXTURE\_MODE\_ARB,\ GL\_INTENSITY);}
\DoxyCodeLine{13924\ \ \ \ \ \}}
\DoxyCodeLine{13925\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13926\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_shadow\_filter)\ \{}
\DoxyCodeLine{13927\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((sampler.get\_magfilter()\ ==\ SamplerState::FT\_shadow)\ ||}
\DoxyCodeLine{13928\ \ \ \ \ \ \ \ \ \ \ (sampler.get\_minfilter()\ ==\ SamplerState::FT\_shadow))\ \{}
\DoxyCodeLine{13929\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_COMPARE\_MODE\_ARB,\ GL\_COMPARE\_R\_TO\_TEXTURE\_ARB);}
\DoxyCodeLine{13930\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_COMPARE\_FUNC\_ARB,\ GL\_LEQUAL);}
\DoxyCodeLine{13931\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{13932\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_COMPARE\_MODE\_ARB,\ GL\_NONE);}
\DoxyCodeLine{13933\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_COMPARE\_FUNC\_ARB,\ GL\_LEQUAL);}
\DoxyCodeLine{13934\ \ \ \ \ \ \ \}}
\DoxyCodeLine{13935\ \ \ \ \ \}}
\DoxyCodeLine{13936\ \ \ \}}
\DoxyCodeLine{13937\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13938\ }
\DoxyCodeLine{13939\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{13940\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_lod)\ \{}
\DoxyCodeLine{13941\ \ \ \ \ glTexParameterf(target,\ GL\_TEXTURE\_MIN\_LOD,\ sampler.get\_min\_lod());}
\DoxyCodeLine{13942\ \ \ \ \ glTexParameterf(target,\ GL\_TEXTURE\_MAX\_LOD,\ sampler.get\_max\_lod());}
\DoxyCodeLine{13943\ \ \ \}}
\DoxyCodeLine{13944\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13945\ }
\DoxyCodeLine{13946\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{13947\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_lod\_bias)\ \{}
\DoxyCodeLine{13948\ \ \ \ \ glTexParameterf(target,\ GL\_TEXTURE\_LOD\_BIAS,\ sampler.get\_lod\_bias());}
\DoxyCodeLine{13949\ \ \ \}}
\DoxyCodeLine{13950\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{13951\ }
\DoxyCodeLine{13952\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13953\ }
\DoxyCodeLine{13954\ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps\ \&\&\ gtc-\/>\_may\_reload\_with\_mipmaps)\ \{}
\DoxyCodeLine{13955\ \ \ \ \ \textcolor{comment}{//\ Suddenly\ we\ require\ mipmaps,\ which\ means\ the\ texture\ may\ need\ reloading.}}
\DoxyCodeLine{13956\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{13957\ \ \ \}}
\DoxyCodeLine{13958\ }
\DoxyCodeLine{13959\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{13960\ \}}
\DoxyCodeLine{13961\ }
\DoxyCodeLine{13968\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{13969\ apply\_texture(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ int\ view)\ \{}
\DoxyCodeLine{13970\ \ \ gtc-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{13971\ }
\DoxyCodeLine{13972\ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{13973\ \ \ assert(target\ !=\ GL\_NONE);\ \textcolor{comment}{//\ REMOVE\ ME}}
\DoxyCodeLine{13974\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_NONE)\ \{}
\DoxyCodeLine{13975\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{13976\ \ \ \}}
\DoxyCodeLine{13977\ }
\DoxyCodeLine{13978\ \ \ GLuint\ index\ =\ gtc-\/>get\_view\_index(view);}
\DoxyCodeLine{13979\ \ \ glBindTexture(target,\ index);}
\DoxyCodeLine{13980\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{13981\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{13982\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{13983\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(GL\_TEXTURE\_2D,\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}\ <<\ *tex}
\DoxyCodeLine{13984\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{13985\ \ \ \}}
\DoxyCodeLine{13986\ }
\DoxyCodeLine{13987\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{13988\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{13989\ \}}
\DoxyCodeLine{13990\ }
\DoxyCodeLine{13999\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{14000\ apply\_sampler(GLuint\ unit,\ const\ \mbox{\hyperlink{classSamplerState}{SamplerState}}\ \&sampler,\ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ int\ view)\ \{}
\DoxyCodeLine{14001\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{14002\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_sampler\_objects)\ \{}
\DoxyCodeLine{14003\ \ \ \ \ \textcolor{comment}{//\ We\ support\ sampler\ objects.\ \ Prepare\ the\ sampler\ object\ and\ bind\ it\ to}}
\DoxyCodeLine{14004\ \ \ \ \ \textcolor{comment}{//\ the\ indicated\ texture\ unit.}}
\DoxyCodeLine{14005\ \ \ \ \ \mbox{\hyperlink{classSamplerContext}{SamplerContext}}\ *sc\ =\ sampler.prepare\_now(get\_prepared\_objects(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{14006\ \ \ \ \ nassertr(sc\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{14007\ \ \ \ \ CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}})\ *gsc\ =\ DCAST(CLP(\mbox{\hyperlink{classSamplerContext}{SamplerContext}}),\ sc);}
\DoxyCodeLine{14008\ }
\DoxyCodeLine{14009\ \ \ \ \ gsc-\/>enqueue\_lru(\&\_prepared\_objects-\/>\_sampler\_object\_lru);}
\DoxyCodeLine{14010\ }
\DoxyCodeLine{14011\ \ \ \ \ \_glBindSampler(unit,\ gsc-\/>\_index);}
\DoxyCodeLine{14012\ }
\DoxyCodeLine{14013\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{14014\ \ \ \ \ \ \ GLCAT.spam()\ <<\ \textcolor{stringliteral}{"{}glBindSampler("{}}\ <<\ unit\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{14015\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ gsc-\/>\_index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}\ <<\ sampler\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14016\ \ \ \ \ \}}
\DoxyCodeLine{14017\ }
\DoxyCodeLine{14018\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{14019\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{14020\ \ \ \{}
\DoxyCodeLine{14021\ \ \ \ \ \textcolor{comment}{//\ We\ don't\ support\ sampler\ objects.\ \ We'll\ have\ to\ bind\ the\ texture\ and}}
\DoxyCodeLine{14022\ \ \ \ \ \textcolor{comment}{//\ change\ the\ texture\ parameters\ if\ they\ don't\ match.}}
\DoxyCodeLine{14023\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_active\_sampler\ !=\ sampler)\ \{}
\DoxyCodeLine{14024\ \ \ \ \ \ \ set\_active\_texture\_stage(unit);}
\DoxyCodeLine{14025\ \ \ \ \ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{14026\ \ \ \ \ \ \ specify\_texture(gtc,\ sampler);}
\DoxyCodeLine{14027\ \ \ \ \ \}}
\DoxyCodeLine{14028\ \ \ \}}
\DoxyCodeLine{14029\ }
\DoxyCodeLine{14030\ \ \ \textcolor{keywordflow}{if}\ (sampler.uses\_mipmaps()\ \&\&\ gtc-\/>\_may\_reload\_with\_mipmaps)\ \{}
\DoxyCodeLine{14031\ \ \ \ \ \textcolor{comment}{//\ The\ texture\ wasn't\ created\ with\ mipmaps,\ but\ we\ are\ trying\ to\ sample\ it}}
\DoxyCodeLine{14032\ \ \ \ \ \textcolor{comment}{//\ with\ mipmaps.\ \ We\ will\ need\ to\ reload\ it.}}
\DoxyCodeLine{14033\ \ \ \ \ GLCAT.info()}
\DoxyCodeLine{14034\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}reloading\ texture\ "{}}\ <<\ gtc-\/>get\_texture()-\/>get\_name()}
\DoxyCodeLine{14035\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ with\ mipmaps\(\backslash\)n"{}};}
\DoxyCodeLine{14036\ }
\DoxyCodeLine{14037\ \ \ \ \ gtc-\/>mark\_needs\_reload();}
\DoxyCodeLine{14038\ \ \ \ \ \textcolor{keywordtype}{bool}\ okflag\ =\ upload\_texture(gtc,\ \textcolor{keyword}{false},\ \textcolor{keyword}{true});}
\DoxyCodeLine{14039\ \ \ \ \ \textcolor{keywordflow}{if}\ (!okflag)\ \{}
\DoxyCodeLine{14040\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{14041\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ load\ "{}}\ <<\ *gtc-\/>get\_texture()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14042\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{14043\ \ \ \ \ \}}
\DoxyCodeLine{14044\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ the\ correct\ view\ is\ bound\ again\ after\ upload\_texture.}}
\DoxyCodeLine{14045\ \ \ \ \ apply\_texture(gtc,\ view);}
\DoxyCodeLine{14046\ \ \ \}}
\DoxyCodeLine{14047\ }
\DoxyCodeLine{14048\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{14049\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{14050\ \}}
\DoxyCodeLine{14051\ }
\DoxyCodeLine{14060\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{14061\ upload\_texture(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ bool\ force,\ bool\ uses\_mipmaps,}
\DoxyCodeLine{14062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCompletionToken}{CompletionToken}}\ token)\ \{}
\DoxyCodeLine{14063\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_load\_texture\_pcollector);}
\DoxyCodeLine{14064\ }
\DoxyCodeLine{14065\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{14066\ }
\DoxyCodeLine{14067\ \ \ \textcolor{comment}{//FIXME:\ upload\ simple\ texture\ for\ async\ uploaded\ thing}}
\DoxyCodeLine{14068\ \ \ \textcolor{keywordtype}{bool}\ async\_upload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14069\ \ \ \textcolor{keywordflow}{if}\ (\_effective\_incomplete\_render\ \&\&\ !force\ \&\&\ !async\_upload)\ \{}
\DoxyCodeLine{14070\ \ \ \ \ \textcolor{keywordtype}{bool}\ has\_image\ =\ \_supports\_compressed\_texture\ ?\ tex-\/>has\_ram\_image()\ :\ tex-\/>has\_uncompressed\_ram\_image();}
\DoxyCodeLine{14071\ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_image\ \&\&\ tex-\/>might\_have\_ram\_image()\ \&\&}
\DoxyCodeLine{14072\ \ \ \ \ \ \ \ \ tex-\/>has\_simple\_ram\_image()\ \&\&}
\DoxyCodeLine{14073\ \ \ \ \ \ \ \ \ !\_loader.is\_null())\ \{}
\DoxyCodeLine{14074\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ the\ texture\ data\ right\ now,\ go\ get\ it,\ but\ in\ the}}
\DoxyCodeLine{14075\ \ \ \ \ \ \ \textcolor{comment}{//\ meantime\ load\ a\ temporary\ simple\ image\ in\ its\ place.}}
\DoxyCodeLine{14076\ \ \ \ \ \ \ async\_reload\_texture(gtc);}
\DoxyCodeLine{14077\ \ \ \ \ \ \ has\_image\ =\ \_supports\_compressed\_texture\ ?\ tex-\/>has\_ram\_image()\ :\ tex-\/>has\_uncompressed\_ram\_image();}
\DoxyCodeLine{14078\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_image)\ \{}
\DoxyCodeLine{14079\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ upload\_simple\_texture(gtc);}
\DoxyCodeLine{14080\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14081\ \ \ \ \ \}}
\DoxyCodeLine{14082\ \ \ \}}
\DoxyCodeLine{14083\ }
\DoxyCodeLine{14084\ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image;}
\DoxyCodeLine{14085\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_compressed\_texture)\ \{}
\DoxyCodeLine{14086\ \ \ \ \ image\ =\ tex-\/>get\_ram\_image();}
\DoxyCodeLine{14087\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14088\ \ \ \ \ image\ =\ tex-\/>get\_uncompressed\_ram\_image();}
\DoxyCodeLine{14089\ \ \ \}}
\DoxyCodeLine{14090\ }
\DoxyCodeLine{14091\ \ \ Texture::TextureType\ texture\_type\ =\ tex-\/>get\_texture\_type();}
\DoxyCodeLine{14092\ \ \ Texture::CompressionMode\ image\_compression;}
\DoxyCodeLine{14093\ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{14094\ \ \ \ \ image\_compression\ =\ Texture::CM\_off;}
\DoxyCodeLine{14095\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14096\ \ \ \ \ image\_compression\ =\ tex-\/>get\_ram\_image\_compression();}
\DoxyCodeLine{14097\ }
\DoxyCodeLine{14098\ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ ==\ Texture::TT\_buffer\_texture\ ||}
\DoxyCodeLine{14099\ \ \ \ \ \ \ \ \ !get\_supports\_compressed\_texture\_format(image\_compression))\ \{}
\DoxyCodeLine{14100\ \ \ \ \ \ \ image\ =\ tex-\/>get\_uncompressed\_ram\_image();}
\DoxyCodeLine{14101\ \ \ \ \ \ \ image\_compression\ =\ Texture::CM\_off;}
\DoxyCodeLine{14102\ }
\DoxyCodeLine{14103\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ this\ triggers,\ Panda\ cannot\ decompress\ the\ texture.\ \ Compile\ with}}
\DoxyCodeLine{14104\ \ \ \ \ \ \ \textcolor{comment}{//\ libsquish\ support\ or\ precompress\ the\ texture.}}
\DoxyCodeLine{14105\ \ \ \ \ \ \ nassertr(!image.is\_null(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{14106\ \ \ \ \ \}}
\DoxyCodeLine{14107\ \ \ \}}
\DoxyCodeLine{14108\ }
\DoxyCodeLine{14109\ \ \ \textcolor{comment}{//\ If\ we'll\ use\ immutable\ texture\ storage,\ we\ have\ to\ pick\ a\ sized\ image}}
\DoxyCodeLine{14110\ \ \ \textcolor{comment}{//\ format.}}
\DoxyCodeLine{14111\ \ \ \textcolor{keywordtype}{bool}\ force\_sized\ =\ (gl\_immutable\_texture\_storage\ \&\&\ \_supports\_tex\_storage)\ ||}
\DoxyCodeLine{14112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (texture\_type\ ==\ Texture::TT\_buffer\_texture);}
\DoxyCodeLine{14113\ }
\DoxyCodeLine{14114\ \ \ GLint\ internal\_format\ =\ get\_internal\_image\_format(tex,\ force\_sized);}
\DoxyCodeLine{14115\ \ \ GLint\ external\_format\ =\ get\_external\_image\_format(tex);}
\DoxyCodeLine{14116\ \ \ GLenum\ component\_type\ =\ get\_component\_type(tex-\/>get\_component\_type());}
\DoxyCodeLine{14117\ }
\DoxyCodeLine{14118\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{14119\ \ \ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{14120\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14121\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ texture\ with\ NULL\ image"{}};}
\DoxyCodeLine{14122\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (image\_compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{14123\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14124\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ pre-\/compressed\ texture"{}};}
\DoxyCodeLine{14125\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_compressed\_format(internal\_format))\ \{}
\DoxyCodeLine{14126\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14127\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ compressed\ texture"{}};}
\DoxyCodeLine{14128\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14129\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14130\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ uncompressed\ texture"{}};}
\DoxyCodeLine{14131\ \ \ \ \ \}}
\DoxyCodeLine{14132\ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14133\ \ \ \}}
\DoxyCodeLine{14134\ }
\DoxyCodeLine{14135\ \ \ \textcolor{comment}{//\ Ensure\ that\ the\ texture\ fits\ within\ the\ GL's\ specified\ limits.\ \ Need\ to}}
\DoxyCodeLine{14136\ \ \ \textcolor{comment}{//\ split\ dimensions\ because\ of\ texture\ arrays}}
\DoxyCodeLine{14137\ \ \ \textcolor{keywordtype}{int}\ max\_dimension\_x;}
\DoxyCodeLine{14138\ \ \ \textcolor{keywordtype}{int}\ max\_dimension\_y;}
\DoxyCodeLine{14139\ \ \ \textcolor{keywordtype}{int}\ max\_dimension\_z;}
\DoxyCodeLine{14140\ }
\DoxyCodeLine{14141\ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{14142\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_3d\_texture:}
\DoxyCodeLine{14143\ \ \ \ \ max\_dimension\_x\ =\ \_max\_3d\_texture\_dimension;}
\DoxyCodeLine{14144\ \ \ \ \ max\_dimension\_y\ =\ \_max\_3d\_texture\_dimension;}
\DoxyCodeLine{14145\ \ \ \ \ max\_dimension\_z\ =\ \_max\_3d\_texture\_dimension;}
\DoxyCodeLine{14146\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14147\ }
\DoxyCodeLine{14148\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map:}
\DoxyCodeLine{14149\ \ \ \ \ max\_dimension\_x\ =\ \_max\_cube\_map\_dimension;}
\DoxyCodeLine{14150\ \ \ \ \ max\_dimension\_y\ =\ \_max\_cube\_map\_dimension;}
\DoxyCodeLine{14151\ \ \ \ \ max\_dimension\_z\ =\ 6;}
\DoxyCodeLine{14152\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14153\ }
\DoxyCodeLine{14154\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture\_array:}
\DoxyCodeLine{14155\ \ \ \ \ max\_dimension\_x\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14156\ \ \ \ \ max\_dimension\_y\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14157\ \ \ \ \ max\_dimension\_z\ =\ \_max\_2d\_texture\_array\_layers;}
\DoxyCodeLine{14158\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14159\ }
\DoxyCodeLine{14160\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map\_array:}
\DoxyCodeLine{14161\ \ \ \ \ max\_dimension\_x\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14162\ \ \ \ \ max\_dimension\_y\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14163\ \ \ \ \ max\_dimension\_z\ =\ int(\_max\_2d\_texture\_array\_layers\ /\ 6)\ *\ 6;}
\DoxyCodeLine{14164\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14165\ }
\DoxyCodeLine{14166\ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_buffer\_texture:}
\DoxyCodeLine{14167\ \ \ \ \ max\_dimension\_x\ =\ \_max\_buffer\_texture\_size;}
\DoxyCodeLine{14168\ \ \ \ \ max\_dimension\_y\ =\ 1;}
\DoxyCodeLine{14169\ \ \ \ \ max\_dimension\_z\ =\ 1;}
\DoxyCodeLine{14170\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14171\ }
\DoxyCodeLine{14172\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{14173\ \ \ \ \ max\_dimension\_x\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14174\ \ \ \ \ max\_dimension\_y\ =\ \_max\_texture\_dimension;}
\DoxyCodeLine{14175\ \ \ \ \ max\_dimension\_z\ =\ 1;}
\DoxyCodeLine{14176\ \ \ \}}
\DoxyCodeLine{14177\ }
\DoxyCodeLine{14178\ \ \ \textcolor{keywordflow}{if}\ (max\_dimension\_x\ ==\ 0\ ||\ max\_dimension\_y\ ==\ 0\ ||\ max\_dimension\_z\ ==\ 0)\ \{}
\DoxyCodeLine{14179\ \ \ \ \ \textcolor{comment}{//\ Guess\ this\ GL\ doesn't\ support\ cube\ mapping3d\ textures2d\ texture\ arrays.}}
\DoxyCodeLine{14180\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{14181\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{14182\ \ \ \}}
\DoxyCodeLine{14183\ }
\DoxyCodeLine{14184\ \ \ \textcolor{comment}{//\ If\ it\ doesn't\ fit,\ we\ have\ to\ reduce\ it\ on-\/the-\/fly.\ \ We\ do\ this\ by}}
\DoxyCodeLine{14185\ \ \ \textcolor{comment}{//\ incrementing\ the\ mipmap\_bias,\ so\ we're\ effectively\ loading\ a\ lower\ mipmap}}
\DoxyCodeLine{14186\ \ \ \textcolor{comment}{//\ level.\ \ This\ requires\ generating\ the\ mipmaps\ on\ the\ CPU\ if\ they\ haven't}}
\DoxyCodeLine{14187\ \ \ \textcolor{comment}{//\ already\ been\ generated.\ \ It\ would\ have\ been\ better\ if\ the\ user\ had}}
\DoxyCodeLine{14188\ \ \ \textcolor{comment}{//\ specified\ max-\/texture-\/dimension\ to\ reduce\ the\ texture\ at\ load\ time}}
\DoxyCodeLine{14189\ \ \ \textcolor{comment}{//\ instead;\ of\ course,\ the\ user\ doesn't\ always\ know\ ahead\ of\ time\ what\ the}}
\DoxyCodeLine{14190\ \ \ \textcolor{comment}{//\ hardware\ limits\ are.}}
\DoxyCodeLine{14191\ }
\DoxyCodeLine{14192\ \ \ \textcolor{keywordtype}{int}\ mipmap\_bias\ =\ 0;}
\DoxyCodeLine{14193\ \ \ \textcolor{keywordflow}{if}\ ((max\_dimension\_x\ >\ 0\ \&\&\ max\_dimension\_y\ >\ 0\ \&\&\ max\_dimension\_z\ >\ 0)\ \&\&}
\DoxyCodeLine{14194\ \ \ \ \ \ \ image\_compression\ ==\ Texture::CM\_off)\ \{}
\DoxyCodeLine{14195\ \ \ \ \ \textcolor{keywordflow}{while}\ (tex-\/>get\_expected\_mipmap\_x\_size(mipmap\_bias)\ >\ max\_dimension\_x\ ||}
\DoxyCodeLine{14196\ \ \ \ \ \ \ \ \ \ \ \ tex-\/>get\_expected\_mipmap\_y\_size(mipmap\_bias)\ >\ max\_dimension\_y\ ||}
\DoxyCodeLine{14197\ \ \ \ \ \ \ \ \ \ \ \ tex-\/>get\_expected\_mipmap\_z\_size(mipmap\_bias)\ >\ max\_dimension\_z)\ \{}
\DoxyCodeLine{14198\ \ \ \ \ \ \ ++mipmap\_bias;}
\DoxyCodeLine{14199\ \ \ \ \ \}}
\DoxyCodeLine{14200\ }
\DoxyCodeLine{14201\ \ \ \ \ \textcolor{keywordflow}{if}\ (mipmap\_bias\ >=\ tex-\/>get\_num\_ram\_mipmap\_images())\ \{}
\DoxyCodeLine{14202\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ generate\ some\ more\ mipmap\ images.}}
\DoxyCodeLine{14203\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>has\_ram\_image())\ \{}
\DoxyCodeLine{14204\ \ \ \ \ \ \ \ \ tex-\/>generate\_ram\_mipmap\_images();}
\DoxyCodeLine{14205\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mipmap\_bias\ >=\ tex-\/>get\_num\_ram\_mipmap\_images())\ \{}
\DoxyCodeLine{14206\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ didn't\ work.\ \ Send\ the\ smallest\ we've\ got,\ and\ hope\ for\ the}}
\DoxyCodeLine{14207\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ best.}}
\DoxyCodeLine{14208\ \ \ \ \ \ \ \ \ \ \ mipmap\_bias\ =\ tex-\/>get\_num\_ram\_mipmap\_images()\ -\/\ 1;}
\DoxyCodeLine{14209\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14210\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14211\ \ \ \ \ \}}
\DoxyCodeLine{14212\ \ \ \}}
\DoxyCodeLine{14213\ }
\DoxyCodeLine{14214\ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_expected\_mipmap\_x\_size(mipmap\_bias);}
\DoxyCodeLine{14215\ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_expected\_mipmap\_y\_size(mipmap\_bias);}
\DoxyCodeLine{14216\ \ \ \textcolor{keywordtype}{int}\ depth\ =\ tex-\/>get\_expected\_mipmap\_z\_size(mipmap\_bias);}
\DoxyCodeLine{14217\ }
\DoxyCodeLine{14218\ \ \ \textcolor{keywordflow}{if}\ (mipmap\_bias\ !=\ 0)\ \{}
\DoxyCodeLine{14219\ \ \ \ \ GLCAT.info()}
\DoxyCodeLine{14220\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reducing\ image\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{14221\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ tex-\/>get\_x\_size()\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ tex-\/>get\_y\_size()}
\DoxyCodeLine{14222\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ tex-\/>get\_z\_size()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{14223\ \ \ \ \ \ \ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14224\ \ \ \}}
\DoxyCodeLine{14225\ }
\DoxyCodeLine{14226\ \ \ \textcolor{keywordflow}{if}\ (image\_compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{14227\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{14228\ \ \ \ \ \textcolor{keywordflow}{switch}\ (tex-\/>get\_effective\_quality\_level())\ \{}
\DoxyCodeLine{14229\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::QL\_fastest:}
\DoxyCodeLine{14230\ \ \ \ \ \ \ glHint(GL\_TEXTURE\_COMPRESSION\_HINT,\ GL\_FASTEST);}
\DoxyCodeLine{14231\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14232\ }
\DoxyCodeLine{14233\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::QL\_default:}
\DoxyCodeLine{14234\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::QL\_normal:}
\DoxyCodeLine{14235\ \ \ \ \ \ \ glHint(GL\_TEXTURE\_COMPRESSION\_HINT,\ GL\_DONT\_CARE);}
\DoxyCodeLine{14236\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14237\ }
\DoxyCodeLine{14238\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::QL\_best:}
\DoxyCodeLine{14239\ \ \ \ \ \ \ glHint(GL\_TEXTURE\_COMPRESSION\_HINT,\ GL\_NICEST);}
\DoxyCodeLine{14240\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14241\ \ \ \ \ \}}
\DoxyCodeLine{14242\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14243\ \ \ \}}
\DoxyCodeLine{14244\ }
\DoxyCodeLine{14245\ \ \ glPixelStorei(GL\_UNPACK\_ALIGNMENT,\ 1);}
\DoxyCodeLine{14246\ }
\DoxyCodeLine{14247\ \ \ \textcolor{keywordtype}{bool}\ needs\_reload\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14248\ \ \ \textcolor{keywordflow}{if}\ (!gtc-\/>\_has\_storage\ ||}
\DoxyCodeLine{14249\ \ \ \ \ \ \ gtc-\/>\_internal\_format\ !=\ internal\_format\ ||}
\DoxyCodeLine{14250\ \ \ \ \ \ \ gtc-\/>\_width\ !=\ width\ ||}
\DoxyCodeLine{14251\ \ \ \ \ \ \ gtc-\/>\_height\ !=\ height\ ||}
\DoxyCodeLine{14252\ \ \ \ \ \ \ gtc-\/>\_depth\ !=\ depth)\ \{}
\DoxyCodeLine{14253\ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ reload\ a\ new\ GL\ Texture\ object.}}
\DoxyCodeLine{14254\ \ \ \ \ needs\_reload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14255\ \ \ \}}
\DoxyCodeLine{14256\ }
\DoxyCodeLine{14257\ \ \ \textcolor{comment}{//\ Figure\ out\ whether\ mipmaps\ will\ be\ generated\ by\ the\ GPU\ or\ by\ Panda\ (or}}
\DoxyCodeLine{14258\ \ \ \textcolor{comment}{//\ not\ at\ all),\ and\ how\ many\ mipmap\ levels\ should\ be\ created.}}
\DoxyCodeLine{14259\ \ \ uses\_mipmaps\ =\ (uses\_mipmaps\ \&\&\ !gl\_ignore\_mipmaps)\ ||\ gl\_force\_mipmaps;}
\DoxyCodeLine{14260\ \ \ \textcolor{keywordtype}{int}\ num\_levels\ =\ 1;}
\DoxyCodeLine{14261\ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ ==\ Texture::TT\_buffer\_texture\ ||}
\DoxyCodeLine{14262\ \ \ \ \ \ \ (width\ ==\ 1\ \&\&\ height\ ==\ 1\ \&\&\ depth\ ==\ 1))\ \{}
\DoxyCodeLine{14263\ \ \ \ \ \textcolor{comment}{//\ Buffer\ textures,\ or\ 1x1x1\ textures,\ never\ have\ mipmaps.}}
\DoxyCodeLine{14264\ \ \ \ \ gtc-\/>\_num\_levels\ =\ 1;}
\DoxyCodeLine{14265\ \ \ \ \ gtc-\/>\_generate\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14266\ \ \ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14267\ \ \ \}}
\DoxyCodeLine{14268\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (needs\_reload\ ||\ (uses\_mipmaps\ \&\&\ gtc-\/>\_num\_levels\ <=\ 1))\ \{}
\DoxyCodeLine{14269\ \ \ \ \ gtc-\/>\_generate\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14270\ \ \ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14271\ }
\DoxyCodeLine{14272\ \ \ \ \ \textcolor{keywordtype}{bool}\ can\_generate\ =\ \_supports\_generate\_mipmap;}
\DoxyCodeLine{14273\ \textcolor{preprocessor}{\#if\ defined(OPENGLES)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{14274\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ ES\ doesn't\ support\ generating\ mipmaps\ for\ sRGB\ textures,\ so\ we}}
\DoxyCodeLine{14275\ \ \ \ \ \textcolor{comment}{//\ have\ to\ do\ this\ on\ the\ CPU,\ unless\ we\ have\ a\ special\ extension.}}
\DoxyCodeLine{14276\ \ \ \ \ \textcolor{keywordflow}{if}\ (internal\_format\ ==\ GL\_SRGB8\ ||\ internal\_format\ ==\ GL\_SRGB8\_ALPHA8)\ \{}
\DoxyCodeLine{14277\ \ \ \ \ \ \ can\_generate\ =\ has\_extension(\textcolor{stringliteral}{"{}GL\_NV\_generate\_mipmap\_sRGB"{}});}
\DoxyCodeLine{14278\ \ \ \ \ \}}
\DoxyCodeLine{14279\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14280\ }
\DoxyCodeLine{14281\ \ \ \ \ \textcolor{keywordflow}{if}\ (image.is\_null())\ \{}
\DoxyCodeLine{14282\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ even\ have\ a\ RAM\ image,\ so\ we\ have\ no\ choice\ but\ to\ let}}
\DoxyCodeLine{14283\ \ \ \ \ \ \ \textcolor{comment}{//\ mipmaps\ be\ generated\ on\ the\ GPU.}}
\DoxyCodeLine{14284\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (can\_generate)\ \{}
\DoxyCodeLine{14285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps)\ \{}
\DoxyCodeLine{14286\ \ \ \ \ \ \ \ \ \ \ num\_levels\ =\ tex-\/>get\_expected\_num\_mipmap\_levels()\ -\/\ mipmap\_bias;}
\DoxyCodeLine{14287\ \ \ \ \ \ \ \ \ \ \ gtc-\/>\_generate\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14289\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!gl\_ignore\_mipmaps)\ \{}
\DoxyCodeLine{14290\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ someone\ asks\ for\ mipmaps,\ we\ can\ generate\ them.}}
\DoxyCodeLine{14291\ \ \ \ \ \ \ \ \ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14292\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14293\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14294\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14295\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uses\_mipmaps)\ \{}
\DoxyCodeLine{14296\ \ \ \ \ \ \ \ \ num\_levels\ =\ tex-\/>get\_num\_ram\_mipmap\_images()\ -\/\ mipmap\_bias;}
\DoxyCodeLine{14297\ }
\DoxyCodeLine{14298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_levels\ <=\ 1)\ \{}
\DoxyCodeLine{14299\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ RAM\ mipmap\ levels\ available.\ \ Should\ we\ generate\ some?}}
\DoxyCodeLine{14300\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!can\_generate\ ||\ !driver\_generate\_mipmaps\ ||}
\DoxyCodeLine{14301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{14302\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yes,\ the\ GL\ can't\ or\ won't\ generate\ them,\ so\ we\ need\ to.\ \ Note}}
\DoxyCodeLine{14303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ some\ drivers\ (nVidia)\ will\ *corrupt\ memory*\ if\ you\ ask}}
\DoxyCodeLine{14304\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ them\ to\ generate\ mipmaps\ for\ a\ pre-\/compressed\ texture.}}
\DoxyCodeLine{14305\ \ \ \ \ \ \ \ \ \ \ \ \ tex-\/>generate\_ram\_mipmap\_images();}
\DoxyCodeLine{14306\ \ \ \ \ \ \ \ \ \ \ \ \ num\_levels\ =\ tex-\/>get\_num\_ram\_mipmap\_images()\ -\/\ mipmap\_bias;}
\DoxyCodeLine{14307\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14308\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14309\ }
\DoxyCodeLine{14310\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_levels\ <=\ 1)\ \{}
\DoxyCodeLine{14311\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ have\ mipmap\ levels\ in\ RAM.\ \ Ask\ the\ GL\ to\ generate\ them}}
\DoxyCodeLine{14312\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ it\ can.}}
\DoxyCodeLine{14313\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (can\_generate)\ \{}
\DoxyCodeLine{14314\ \ \ \ \ \ \ \ \ \ \ \ \ num\_levels\ =\ tex-\/>get\_expected\_num\_mipmap\_levels()\ -\/\ mipmap\_bias;}
\DoxyCodeLine{14315\ \ \ \ \ \ \ \ \ \ \ \ \ gtc-\/>\_generate\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14316\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14317\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it\ can't,\ do\ without\ mipmaps.}}
\DoxyCodeLine{14318\ \ \ \ \ \ \ \ \ \ \ \ \ uses\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14319\ \ \ \ \ \ \ \ \ \ \ \ \ num\_levels\ =\ 1;}
\DoxyCodeLine{14320\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14321\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14322\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14323\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!gl\_ignore\_mipmaps)\ \{}
\DoxyCodeLine{14324\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ yet\ know\ whether\ this\ might\ succeed,\ so\ we\ will\ try\ if}}
\DoxyCodeLine{14325\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ someone\ asks\ for\ it.}}
\DoxyCodeLine{14326\ \ \ \ \ \ \ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14327\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14328\ \ \ \ \ \}}
\DoxyCodeLine{14329\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_levels\ >\ gtc-\/>\_num\_levels)\ \{}
\DoxyCodeLine{14330\ \ \ \ \ \ \ \textcolor{comment}{//\ Always\ need\ to\ reallocate\ storage\ when\ we're\ adding\ new\ mipmap\ levels.}}
\DoxyCodeLine{14331\ \ \ \ \ \ \ needs\_reload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14332\ \ \ \ \ \}}
\DoxyCodeLine{14333\ \ \ \}}
\DoxyCodeLine{14334\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14335\ \ \ \ \ \textcolor{comment}{//\ Maybe\ we\ need\ to\ generate\ mipmaps\ on\ the\ CPU.}}
\DoxyCodeLine{14336\ \ \ \ \ num\_levels\ =\ gtc-\/>\_num\_levels;}
\DoxyCodeLine{14337\ \ \ \ \ \textcolor{keywordflow}{if}\ (!image.is\_null()\ \&\&\ uses\_mipmaps)\ \{}
\DoxyCodeLine{14338\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_ram\_mipmap\_images()\ -\/\ mipmap\_bias\ <=\ 1)\ \{}
\DoxyCodeLine{14339\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ RAM\ mipmap\ levels\ available.\ \ Should\ we\ generate\ some?}}
\DoxyCodeLine{14340\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_generate\_mipmap\ ||\ !driver\_generate\_mipmaps\ ||}
\DoxyCodeLine{14341\ \ \ \ \ \ \ \ \ \ \ \ \ image\_compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{14342\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yes,\ the\ GL\ can't\ or\ won't\ generate\ them,\ so\ we\ need\ to.\ \ Note}}
\DoxyCodeLine{14343\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ that\ some\ drivers\ (nVidia)\ will\ *corrupt\ memory*\ if\ you\ ask\ them}}
\DoxyCodeLine{14344\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ generate\ mipmaps\ for\ a\ pre-\/compressed\ texture.}}
\DoxyCodeLine{14345\ \ \ \ \ \ \ \ \ \ \ tex-\/>generate\_ram\_mipmap\_images();}
\DoxyCodeLine{14346\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14347\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14348\ \ \ \ \ \}}
\DoxyCodeLine{14349\ \ \ \}}
\DoxyCodeLine{14350\ }
\DoxyCodeLine{14351\ \ \ \textcolor{keywordtype}{int}\ num\_views\ =\ tex-\/>get\_num\_views();}
\DoxyCodeLine{14352\ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14353\ \ \ \ \ gtc-\/>cancel\_pending\_uploads();}
\DoxyCodeLine{14354\ }
\DoxyCodeLine{14355\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_immutable)\ \{}
\DoxyCodeLine{14356\ \ \ \ \ \ \ GLCAT.info()}
\DoxyCodeLine{14357\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Attempt\ to\ modify\ texture\ with\ immutable\ storage,\ recreating\ texture.\(\backslash\)n"{}};}
\DoxyCodeLine{14358\ \ \ \ \ \ \ gtc-\/>reset\_data(gtc-\/>\_target,\ num\_views);}
\DoxyCodeLine{14359\ \ \ \ \ \}}
\DoxyCodeLine{14360\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_tex\_storage\ \&\&\ gl\_immutable\_texture\_storage\ \&\&}
\DoxyCodeLine{14361\ \ \ \ \ \ \ \ \ \ \ \ \ \ texture\_type\ !=\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{14362\ \ \ \ \ \ \ gtc-\/>\_immutable\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14363\ \ \ \ \ \}}
\DoxyCodeLine{14364\ \ \ \}}
\DoxyCodeLine{14365\ }
\DoxyCodeLine{14366\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{14367\ \ \ \textcolor{keywordflow}{if}\ (needs\_reload\ ||\ !image.is\_null())\ \{}
\DoxyCodeLine{14368\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ any\ reads\ and\ writes\ to\ this\ texture\ have\ been\ synced.}}
\DoxyCodeLine{14369\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>needs\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT,\ \textcolor{keyword}{true}))\ \{}
\DoxyCodeLine{14370\ \ \ \ \ \ \ issue\_memory\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT);}
\DoxyCodeLine{14371\ \ \ \ \ \}}
\DoxyCodeLine{14372\ \ \ \}}
\DoxyCodeLine{14373\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14374\ }
\DoxyCodeLine{14375\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ have\ a\ GL\ texture\ name\ for\ every\ view\ of\ the\ texture.}}
\DoxyCodeLine{14376\ \ \ \textcolor{keywordtype}{int}\ old\_num\_views\ =\ gtc-\/>\_num\_views;}
\DoxyCodeLine{14377\ \ \ \textcolor{keywordflow}{if}\ (old\_num\_views\ !=\ num\_views)\ \{}
\DoxyCodeLine{14378\ \ \ \ \ gtc-\/>set\_num\_views(num\_views);}
\DoxyCodeLine{14379\ \ \ \}}
\DoxyCodeLine{14380\ }
\DoxyCodeLine{14381\ \ \ \textcolor{comment}{//\ For\ a\ buffer\ texture,\ make\ sure\ we've\ created\ the\ buffer\ indices.}}
\DoxyCodeLine{14382\ \ \ \textcolor{keywordflow}{if}\ (texture\_type\ ==\ Texture::TT\_buffer\_texture)\ \{}
\DoxyCodeLine{14383\ \ \ \ \ nassertr(gtc-\/>\_buffers\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{14384\ \ \ \}}
\DoxyCodeLine{14385\ }
\DoxyCodeLine{14386\ \ \ \textcolor{keywordtype}{bool}\ compressed\ =\ image\_compression\ !=\ Texture::CM\_off;}
\DoxyCodeLine{14387\ \ \ \textcolor{keywordflow}{if}\ (compressed\ \&\&\ !\_supports\_compressed\_texture)\ \{}
\DoxyCodeLine{14388\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{14389\ \ \ \}}
\DoxyCodeLine{14390\ }
\DoxyCodeLine{14391\ \ \ \textcolor{comment}{//\ Does\ this\ texture\ require\ asynchronous\ uploads?}}
\DoxyCodeLine{14392\ \textcolor{preprocessor}{\#if\ defined(HAVE\_THREADS)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{14393\ \ \ \textcolor{keywordtype}{int}\ async\_buffers\ =\ \_supports\_pixel\_buffers\ ?\ tex-\/>get\_num\_async\_transfer\_buffers()\ :\ 0;}
\DoxyCodeLine{14394\ \ \ \textcolor{keywordflow}{if}\ (async\_buffers\ !=\ 0)\ \{}
\DoxyCodeLine{14395\ \ \ \ \ \textcolor{comment}{//\ Prefer\ immutable\ storage,\ if\ supported.}}
\DoxyCodeLine{14396\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload\ \&\&\ \_supports\_tex\_storage)\ \{}
\DoxyCodeLine{14397\ \ \ \ \ \ \ gtc-\/>\_immutable\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14398\ \ \ \ \ \}}
\DoxyCodeLine{14399\ \ \ \}}
\DoxyCodeLine{14400\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (async\_buffers\ ==\ 0\ \&\&\ gtc-\/>\_num\_pbos\ >\ 0)\ \{}
\DoxyCodeLine{14401\ \ \ \ \ gtc-\/>delete\_unused\_pbos();}
\DoxyCodeLine{14402\ \ \ \}}
\DoxyCodeLine{14403\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{14404\ \ \ \textcolor{keywordtype}{int}\ async\_buffers\ =\ 0;}
\DoxyCodeLine{14405\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14406\ }
\DoxyCodeLine{14407\ \ \ \textcolor{comment}{//\ Keep\ track\ of\ which\ views\ are\ uploaded.}}
\DoxyCodeLine{14408\ \ \ \mbox{\hyperlink{classCompletionCounter}{CompletionCounter}}\ counter;}
\DoxyCodeLine{14409\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14410\ }
\DoxyCodeLine{14411\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ num\_views;\ ++view)\ \{}
\DoxyCodeLine{14412\ \ \ \ \ \textcolor{keywordflow}{if}\ (upload\_texture\_view(gtc,\ view,\ needs\_reload\ ||\ view\ >=\ old\_num\_views,}
\DoxyCodeLine{14413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mipmap\_bias,\ num\_levels,}
\DoxyCodeLine{14414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal\_format,\ external\_format,}
\DoxyCodeLine{14415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ compressed,\ async\_buffers,}
\DoxyCodeLine{14416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ counter.make\_token()))\ \{}
\DoxyCodeLine{14417\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ always\ create\ storage\ right\ away\ even\ if\ we\ do\ the\ upload\ of\ the}}
\DoxyCodeLine{14418\ \ \ \ \ \ \ \textcolor{comment}{//\ actual\ data\ asynchronously.}}
\DoxyCodeLine{14419\ \ \ \ \ \ \ gtc-\/>\_has\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14420\ \ \ \ \ \ \ gtc-\/>\_internal\_format\ =\ internal\_format;}
\DoxyCodeLine{14421\ \ \ \ \ \ \ gtc-\/>\_width\ =\ width;}
\DoxyCodeLine{14422\ \ \ \ \ \ \ gtc-\/>\_height\ =\ height;}
\DoxyCodeLine{14423\ \ \ \ \ \ \ gtc-\/>\_depth\ =\ depth;}
\DoxyCodeLine{14424\ \ \ \ \ \ \ gtc-\/>\_num\_levels\ =\ num\_levels;}
\DoxyCodeLine{14425\ \ \ \ \ \}}
\DoxyCodeLine{14426\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14427\ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14428\ \ \ \ \ \}}
\DoxyCodeLine{14429\ \ \ \}}
\DoxyCodeLine{14430\ }
\DoxyCodeLine{14431\ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{14432\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{14433\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{14434\ \ \ \}}
\DoxyCodeLine{14435\ }
\DoxyCodeLine{14436\ \ \ gtc-\/>\_uploads\_pending++;}
\DoxyCodeLine{14437\ }
\DoxyCodeLine{14438\ \ \ std::move(counter).then([=,\ token\ =\ std::move(token)]\ (\textcolor{keywordtype}{bool}\ success)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{14439\ \ \ \ \ -\/-\/gtc-\/>\_uploads\_pending;}
\DoxyCodeLine{14440\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{14441\ \ \ \ \ \ \ token.complete(\textcolor{keyword}{false});}
\DoxyCodeLine{14442\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{14443\ \ \ \ \ \}}
\DoxyCodeLine{14444\ }
\DoxyCodeLine{14445\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14446\ \ \ \ \ \ \ gtc-\/>update\_data\_size\_bytes(get\_texture\_memory\_size(gtc));}
\DoxyCodeLine{14447\ \ \ \ \ \}}
\DoxyCodeLine{14448\ }
\DoxyCodeLine{14449\ \ \ \ \ nassertv(gtc-\/>\_has\_storage);}
\DoxyCodeLine{14450\ }
\DoxyCodeLine{14451\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{14452\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_post\_load\_store\_cache())\ \{}
\DoxyCodeLine{14453\ \ \ \ \ \ \ tex-\/>set\_post\_load\_store\_cache(\textcolor{keyword}{false});}
\DoxyCodeLine{14454\ \ \ \ \ \ \ \textcolor{comment}{//\ OK,\ get\ the\ RAM\ image,\ and\ save\ it\ in\ a\ BamCache\ record.}}
\DoxyCodeLine{14455\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>has\_ram\_image())\ \{}
\DoxyCodeLine{14456\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classBamCache}{BamCache}}\ *cache\ =\ BamCache::get\_global\_ptr();}
\DoxyCodeLine{14457\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classBamCacheRecord}{BamCacheRecord}})\ record\ =\ cache-\/>lookup(tex-\/>get\_fullpath(),\ \textcolor{stringliteral}{"{}txo"{}});}
\DoxyCodeLine{14458\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (record\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14459\ \ \ \ \ \ \ \ \ \ \ record-\/>set\_data(tex,\ tex);}
\DoxyCodeLine{14460\ \ \ \ \ \ \ \ \ \ \ cache-\/>store(record);}
\DoxyCodeLine{14461\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14462\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14463\ \ \ \ \ \}}
\DoxyCodeLine{14464\ }
\DoxyCodeLine{14465\ \ \ \ \ \mbox{\hyperlink{classGraphicsEngine}{GraphicsEngine}}\ *engine\ =\ get\_engine();}
\DoxyCodeLine{14466\ \ \ \ \ nassertv(engine\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{14467\ \ \ \ \ engine-\/>\mbox{\hyperlink{classGraphicsEngine_ac68a5c48416a5e3217516e7355cd501d}{texture\_uploaded}}(tex);}
\DoxyCodeLine{14468\ }
\DoxyCodeLine{14469\ \ \ \ \ token.complete(\textcolor{keyword}{true});}
\DoxyCodeLine{14470\ \ \ \});}
\DoxyCodeLine{14471\ }
\DoxyCodeLine{14472\ \ \ \textcolor{comment}{//\ Update\ the\ modified\ counters\ now,\ even\ if\ we've\ only\ spawned\ an\ async}}
\DoxyCodeLine{14473\ \ \ \textcolor{comment}{//\ upload,\ because\ we've\ already\ set\ things\ in\ motion\ to\ update\ the\ texture}}
\DoxyCodeLine{14474\ \ \ \textcolor{comment}{//\ to\ this\ version.\ \ Otherwise,\ future\ calls\ to\ update\_texture\ will\ continue}}
\DoxyCodeLine{14475\ \ \ \textcolor{comment}{//\ to\ try\ to\ update\ the\ image\ over\ and\ over\ again.}}
\DoxyCodeLine{14476\ \ \ gtc-\/>mark\_loaded();}
\DoxyCodeLine{14477\ }
\DoxyCodeLine{14478\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{14479\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{14480\ \}}
\DoxyCodeLine{14481\ }
\DoxyCodeLine{14486\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{14487\ upload\_texture\_view(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ int\ view,\ bool\ needs\_reload,}
\DoxyCodeLine{14488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ mipmap\_bias,\ int\ num\_levels,\ GLint\ internal\_format,}
\DoxyCodeLine{14489\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLint\ external\_format,\ GLenum\ component\_type,}
\DoxyCodeLine{14490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ compressed,\ int\ async\_buffers,\ \mbox{\hyperlink{classCompletionToken}{CompletionToken}}\ token)\ \{}
\DoxyCodeLine{14491\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ error\ stack\ is\ cleared\ out\ before\ we\ begin.}}
\DoxyCodeLine{14492\ \ \ clear\_my\_gl\_errors();}
\DoxyCodeLine{14493\ }
\DoxyCodeLine{14494\ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{14495\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_NONE)\ \{}
\DoxyCodeLine{14496\ \ \ \ \ \textcolor{comment}{//\ Unsupported\ target\ (e.g.\ \ 3-\/d\ texturing\ on\ GL\ 1.1).}}
\DoxyCodeLine{14497\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{14498\ \ \ \}}
\DoxyCodeLine{14499\ }
\DoxyCodeLine{14500\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{14501\ \ \ nassertr(tex\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{14502\ \ \ Texture::TextureType\ texture\_type\ =\ tex-\/>get\_texture\_type();}
\DoxyCodeLine{14503\ }
\DoxyCodeLine{14504\ \ \ GLuint\ index\ =\ gtc-\/>get\_view\_index(view);}
\DoxyCodeLine{14505\ \ \ glBindTexture(target,\ index);}
\DoxyCodeLine{14506\ }
\DoxyCodeLine{14507\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{14508\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{14509\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(0x"{}}\ <<\ hex\ <<\ target\ <<\ dec\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}}
\DoxyCodeLine{14510\ \ \ \ \ \ \ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14511\ \ \ \}}
\DoxyCodeLine{14512\ }
\DoxyCodeLine{14513\ \ \ \textcolor{keywordflow}{if}\ (\_use\_object\_labels\ \&\&\ needs\_reload)\ \{}
\DoxyCodeLine{14514\ \ \ \ \ \textcolor{comment}{//\ This\ seems\ like\ a\ good\ time\ to\ assign\ a\ label\ for\ the\ debug\ messages.}}
\DoxyCodeLine{14515\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name\ =\ tex-\/>get\_name();}
\DoxyCodeLine{14516\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_num\_views\ ==\ 1)\ \{}
\DoxyCodeLine{14517\ \ \ \ \ \ \ \_glObjectLabel(GL\_TEXTURE,\ index,\ name.size(),\ name.data());}
\DoxyCodeLine{14518\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14519\ \ \ \ \ \ \ \textcolor{comment}{//\ Add\ a\ suffix\ for\ a\ multiview\ texture.}}
\DoxyCodeLine{14520\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ *buffer\ =\ (\textcolor{keywordtype}{char}\ *)alloca(name.size()\ +\ 32);}
\DoxyCodeLine{14521\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ size\ =\ sprintf(buffer,\ \textcolor{stringliteral}{"{}\%s\#\%d"{}},\ name.c\_str(),\ view);}
\DoxyCodeLine{14522\ \ \ \ \ \ \ \_glObjectLabel(GL\_TEXTURE,\ index,\ size,\ buffer);}
\DoxyCodeLine{14523\ \ \ \ \ \}}
\DoxyCodeLine{14524\ \ \ \}}
\DoxyCodeLine{14525\ }
\DoxyCodeLine{14526\ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image\ =\ tex-\/>\mbox{\hyperlink{classTexture_ae7896287821c803caaee9f58d025471c}{get\_ram\_mipmap\_image}}(mipmap\_bias);}
\DoxyCodeLine{14527\ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_expected\_mipmap\_x\_size(mipmap\_bias);}
\DoxyCodeLine{14528\ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_expected\_mipmap\_y\_size(mipmap\_bias);}
\DoxyCodeLine{14529\ \ \ \textcolor{keywordtype}{int}\ depth\ =\ tex-\/>get\_expected\_mipmap\_z\_size(mipmap\_bias);}
\DoxyCodeLine{14530\ \ \ \textcolor{keywordtype}{int}\ num\_components\ =\ tex-\/>get\_num\_components();}
\DoxyCodeLine{14531\ \ \ \textcolor{keywordtype}{int}\ expected\_num\_components\ =\ compressed\ ?\ num\_components\ :\ get\_external\_format\_components(external\_format);}
\DoxyCodeLine{14532\ \ \ \textcolor{keywordtype}{int}\ component\_width\ =\ tex-\/>get\_component\_width();}
\DoxyCodeLine{14533\ \ \ GLenum\ usage\ =\ GL\_STATIC\_DRAW;}
\DoxyCodeLine{14534\ }
\DoxyCodeLine{14535\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{14536\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{14537\ \ \ \ \ usage\ =\ get\_usage(tex-\/>get\_usage\_hint());}
\DoxyCodeLine{14538\ \ \ \ \ GLuint\ buffer\ =\ gtc-\/>get\_view\_buffer(view);}
\DoxyCodeLine{14539\ \ \ \ \ nassertr(buffer\ !=\ 0,\ \textcolor{keyword}{false});}
\DoxyCodeLine{14540\ \ \ \ \ \_glBindBuffer(GL\_TEXTURE\_BUFFER,\ buffer);}
\DoxyCodeLine{14541\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14542\ \ \ \ \ \ \ \_glTexBuffer(GL\_TEXTURE\_BUFFER,\ internal\_format,\ buffer);}
\DoxyCodeLine{14543\ \ \ \ \ \}}
\DoxyCodeLine{14544\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{14545\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{14546\ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14547\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_levels\ <=\ 1)\ \{}
\DoxyCodeLine{14548\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ no\ mipmaps,\ tell\ OpenGL\ this\ before\ we\ upload\ the\ texture}}
\DoxyCodeLine{14549\ \ \ \ \ \ \ \textcolor{comment}{//\ images,\ to\ give\ it\ a\ hint\ not\ to\ expect\ them.}}
\DoxyCodeLine{14550\ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MIN\_FILTER,\ GL\_LINEAR);}
\DoxyCodeLine{14551\ \ \ \ \ \}}
\DoxyCodeLine{14552\ }
\DoxyCodeLine{14553\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{14554\ \ \ \ \ \ \ \textcolor{comment}{//\ By\ the\ time\ we\ get\ here,\ we\ have\ a\ pretty\ good\ prediction\ for\ the}}
\DoxyCodeLine{14555\ \ \ \ \ \ \ \textcolor{comment}{//\ number\ of\ mipmaps\ we're\ going\ to\ have,\ so\ tell\ the\ GL\ that's\ all\ it's}}
\DoxyCodeLine{14556\ \ \ \ \ \ \ \textcolor{comment}{//\ going\ to\ get.}}
\DoxyCodeLine{14557\ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAX\_LEVEL,\ num\_levels\ -\/\ 1);}
\DoxyCodeLine{14558\ \ \ \ \ \}}
\DoxyCodeLine{14559\ }
\DoxyCodeLine{14560\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_2}}
\DoxyCodeLine{14561\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_generate\_mipmaps\ \&\&\ \_glGenerateMipmap\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14562\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ old,\ deprecated\ way\ to\ generate\ mipmaps.}}
\DoxyCodeLine{14563\ \ \ \ \ \ \ glTexParameteri(target,\ GL\_GENERATE\_MIPMAP,\ GL\_TRUE);}
\DoxyCodeLine{14564\ \ \ \ \ \}}
\DoxyCodeLine{14565\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14566\ }
\DoxyCodeLine{14567\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{14568\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_luminance\_texture)\ \{}
\DoxyCodeLine{14569\ \ \ \ \ \ \ \textcolor{comment}{//\ Do\ we\ need\ to\ apply\ a\ swizzle\ mask\ to\ emulate\ these\ deprecated\ texture}}
\DoxyCodeLine{14570\ \ \ \ \ \ \ \textcolor{comment}{//\ formats?}}
\DoxyCodeLine{14571\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (tex-\/>get\_format())\ \{}
\DoxyCodeLine{14572\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_alpha:}
\DoxyCodeLine{14573\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_R,\ GL\_ZERO);}
\DoxyCodeLine{14574\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_G,\ GL\_ZERO);}
\DoxyCodeLine{14575\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_B,\ GL\_ZERO);}
\DoxyCodeLine{14576\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_A,\ GL\_RED);}
\DoxyCodeLine{14577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14578\ }
\DoxyCodeLine{14579\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance:}
\DoxyCodeLine{14580\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_R,\ GL\_RED);}
\DoxyCodeLine{14581\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_G,\ GL\_RED);}
\DoxyCodeLine{14582\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_B,\ GL\_RED);}
\DoxyCodeLine{14583\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_A,\ GL\_ONE);}
\DoxyCodeLine{14584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14585\ }
\DoxyCodeLine{14586\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_luminance\_alpha:}
\DoxyCodeLine{14587\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_R,\ GL\_RED);}
\DoxyCodeLine{14588\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_G,\ GL\_RED);}
\DoxyCodeLine{14589\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_B,\ GL\_RED);}
\DoxyCodeLine{14590\ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_SWIZZLE\_A,\ GL\_GREEN);}
\DoxyCodeLine{14591\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14592\ }
\DoxyCodeLine{14593\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{14594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14595\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14596\ \ \ \ \ \}}
\DoxyCodeLine{14597\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14598\ }
\DoxyCodeLine{14599\ \ \ \ \ \textcolor{comment}{//\ Allocate\ immutable\ storage\ for\ the\ texture,\ after\ which\ we\ can\ subload}}
\DoxyCodeLine{14600\ \ \ \ \ \textcolor{comment}{//\ it.\ \ Pre-\/allocating\ storage\ using\ glTexStorage\ is\ more\ efficient\ than}}
\DoxyCodeLine{14601\ \ \ \ \ \textcolor{comment}{//\ using\ glTexImage\ to\ load\ all\ of\ the\ individual\ images\ one\ by\ one\ later,}}
\DoxyCodeLine{14602\ \ \ \ \ \textcolor{comment}{//\ but\ we\ are\ not\ allowed\ to\ change\ the\ texture\ size\ or\ number\ of\ mipmap}}
\DoxyCodeLine{14603\ \ \ \ \ \textcolor{comment}{//\ levels\ after\ this\ point.}}
\DoxyCodeLine{14604\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_immutable)\ \{}
\DoxyCodeLine{14605\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_create\_texture\_storage\_pcollector);}
\DoxyCodeLine{14606\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{14607\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14608\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}allocating\ storage\ for\ texture\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{14609\ \ \ \ \ \ \ \ \ \ \ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth\ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ "{}}}
\DoxyCodeLine{14610\ \ \ \ \ \ \ \ \ \ \ <<\ num\_levels\ <<\ \textcolor{stringliteral}{"{},\ internal\_format\ =\ 0x"{}}\ <<\ std::hex}
\DoxyCodeLine{14611\ \ \ \ \ \ \ \ \ \ \ <<\ internal\_format\ <<\ std::dec\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14612\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14613\ }
\DoxyCodeLine{14614\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (texture\_type)\ \{}
\DoxyCodeLine{14615\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_buffer\_texture:}
\DoxyCodeLine{14616\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Won't\ get\ here,\ but\ squelch\ compiler\ warning}}
\DoxyCodeLine{14617\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_1d\_texture:}
\DoxyCodeLine{14618\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{14619\ \ \ \ \ \ \ \ \ \_glTexStorage1D(target,\ num\_levels,\ internal\_format,\ width);}
\DoxyCodeLine{14620\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14621\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14622\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture:}
\DoxyCodeLine{14623\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map:}
\DoxyCodeLine{14624\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_1d\_texture\_array:}
\DoxyCodeLine{14625\ \ \ \ \ \ \ \ \ \_glTexStorage2D(target,\ num\_levels,\ internal\_format,\ width,\ height);}
\DoxyCodeLine{14626\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14627\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_3d\_texture:}
\DoxyCodeLine{14628\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_2d\_texture\_array:}
\DoxyCodeLine{14629\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::TT\_cube\_map\_array:}
\DoxyCodeLine{14630\ \ \ \ \ \ \ \ \ \_glTexStorage3D(target,\ num\_levels,\ internal\_format,\ width,\ height,\ depth);}
\DoxyCodeLine{14631\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14632\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14633\ }
\DoxyCodeLine{14634\ \ \ \ \ \ \ needs\_reload\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14635\ \ \ \ \ \}}
\DoxyCodeLine{14636\ \ \ \}}
\DoxyCodeLine{14637\ }
\DoxyCodeLine{14638\ \ \ \textcolor{comment}{//\ How\ many\ mipmap\ levels\ do\ we\ have\ available\ to\ upload?}}
\DoxyCodeLine{14639\ \ \ \textcolor{keywordtype}{int}\ num\_ram\_mipmap\_levels\ =\ 0;}
\DoxyCodeLine{14640\ \ \ GLuint\ pbo\ =\ 0;}
\DoxyCodeLine{14641\ \ \ \textcolor{keywordtype}{size\_t}\ pbo\_size\ =\ 0;}
\DoxyCodeLine{14642\ \ \ \textcolor{keywordtype}{void}\ *mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{14643\ \ \ \textcolor{keywordflow}{if}\ (!image.is\_null())\ \{}
\DoxyCodeLine{14644\ \ \ \ \ num\_ram\_mipmap\_levels\ =\ std::min(num\_levels,\ tex-\/>get\_num\_ram\_mipmap\_images()\ -\/\ mipmap\_bias);}
\DoxyCodeLine{14645\ }
\DoxyCodeLine{14646\ \ \ \ \ \textcolor{comment}{//\ Create\ a\ PBO\ that\ can\ hold\ all\ the\ mipmap\ levels.}}
\DoxyCodeLine{14647\ \textcolor{preprocessor}{\#if\ defined(HAVE\_THREADS)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{14648\ \ \ \ \ \textcolor{keywordflow}{if}\ (async\_buffers\ !=\ 0)\ \{}
\DoxyCodeLine{14649\ \ \ \ \ \ \ pbo\_size\ =\ 0;}
\DoxyCodeLine{14650\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ mipmap\_bias;\ n\ <\ num\_ram\_mipmap\_levels\ +\ mipmap\_bias;\ ++n)\ \{}
\DoxyCodeLine{14651\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ view\_size\ =\ tex-\/>get\_ram\_mipmap\_view\_size(n);}
\DoxyCodeLine{14652\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{14653\ \ \ \ \ \ \ \ \ \ \ view\_size\ =\ expected\_num\_components\ *\ (view\_size\ /\ num\_components);}
\DoxyCodeLine{14654\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14655\ \ \ \ \ \ \ \ \ pbo\_size\ +=\ view\_size;}
\DoxyCodeLine{14656\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14657\ }
\DoxyCodeLine{14658\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ create\_storage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14659\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pbo\_size\ !=\ gtc-\/>\_pbo\_size)\ \{}
\DoxyCodeLine{14660\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ PBOs\ yet,\ or\ they\ aren't\ of\ the\ right\ size.}}
\DoxyCodeLine{14661\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{14662\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ using\ buffer\ storage,\ need\ to\ deallocate\ all\ of\ them.}}
\DoxyCodeLine{14663\ \ \ \ \ \ \ \ \ \ \ gtc-\/>delete\_unused\_pbos();}
\DoxyCodeLine{14664\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14665\ \ \ \ \ \ \ \ \ gtc-\/>\_pbo\_size\ =\ pbo\_size;}
\DoxyCodeLine{14666\ \ \ \ \ \ \ \ \ create\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14667\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14668\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (async\_buffers\ >\ 0)\ \{}
\DoxyCodeLine{14669\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wait\ for\ a\ PBO\ to\ become\ available\ if\ we're\ at\ our\ limit.}}
\DoxyCodeLine{14670\ \ \ \ \ \ \ \ \ gtc-\/>wait\_for\_unused\_pbo(async\_buffers);}
\DoxyCodeLine{14671\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14672\ }
\DoxyCodeLine{14673\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_create\_map\_pbo\_pcollector);}
\DoxyCodeLine{14674\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_unused\_pbos.empty())\ \{}
\DoxyCodeLine{14675\ \ \ \ \ \ \ \ \ \_glGenBuffers(1,\ \&pbo);}
\DoxyCodeLine{14676\ \ \ \ \ \ \ \ \ gtc-\/>\_num\_pbos++;}
\DoxyCodeLine{14677\ \ \ \ \ \ \ \ \ create\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14678\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14679\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Map\ an\ existing\ PBO.}}
\DoxyCodeLine{14680\ \ \ \ \ \ \ \ \ pbo\ =\ gtc-\/>\_unused\_pbos.back();}
\DoxyCodeLine{14681\ \ \ \ \ \ \ \ \ gtc-\/>\_unused\_pbos.pop\_back();}
\DoxyCodeLine{14682\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14683\ }
\DoxyCodeLine{14684\ \ \ \ \ \ \ mapped\_ptr\ =\ map\_write\_discard\_buffer(GL\_PIXEL\_UNPACK\_BUFFER,\ pbo,}
\DoxyCodeLine{14685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pbo\_size,\ create\_storage);}
\DoxyCodeLine{14686\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mapped\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14687\ \ \ \ \ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{14688\ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{14689\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ map\ pixel\ unpack\ buffer.\(\backslash\)n"{}};}
\DoxyCodeLine{14690\ \ \ \ \ \ \ \ \ gtc-\/>\_unused\_pbos.push\_back(pbo);}
\DoxyCodeLine{14691\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14692\ \ \ \ \ \}}
\DoxyCodeLine{14693\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14694\ \ \ \}}
\DoxyCodeLine{14695\ }
\DoxyCodeLine{14696\ \ \ \textcolor{keywordflow}{if}\ (needs\_reload\ \&\&\ num\_ram\_mipmap\_levels\ ==\ 0\ \&\&}
\DoxyCodeLine{14697\ \ \ \ \ \ \ external\_format\ ==\ GL\_DEPTH\_STENCIL\ \&\&\ get\_supports\_depth\_stencil())\ \{}
\DoxyCodeLine{14698\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{14699\ \ \ \ \ component\_type\ =\ GL\_UNSIGNED\_INT\_24\_8\_OES;}
\DoxyCodeLine{14700\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{14701\ \ \ \ \ component\_type\ =\ GL\_UNSIGNED\_INT\_24\_8\_EXT;}
\DoxyCodeLine{14702\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14703\ \ \ \}}
\DoxyCodeLine{14704\ }
\DoxyCodeLine{14705\ \ \ \textcolor{keywordtype}{int}\ upload\_count\ =\ ++gtc-\/>\_uploads\_started;}
\DoxyCodeLine{14706\ }
\DoxyCodeLine{14707\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{14708\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14709\ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ the\ image\ up\ from\ scratch,\ creating\ a\ new\ GL\ Texture\ object.}}
\DoxyCodeLine{14710\ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14711\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ new\ texture\ object\ for\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}}
\DoxyCodeLine{14712\ \ \ \ \ \ \ \ \ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth}
\DoxyCodeLine{14713\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ "{}}\ <<\ num\_ram\_mipmap\_levels\ <<\ \textcolor{stringliteral}{"{}\ /\ "{}}\ <<\ num\_levels;}
\DoxyCodeLine{14714\ }
\DoxyCodeLine{14715\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_ram\_mipmap\_levels\ ==\ 0\ \&\&\ tex-\/>has\_clear\_color())\ \{}
\DoxyCodeLine{14716\ \ \ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})}
\DoxyCodeLine{14717\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ clearing\ to\ "{}}\ <<\ tex-\/>get\_clear\_color();}
\DoxyCodeLine{14718\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14719\ \ \ \ \ \}}
\DoxyCodeLine{14720\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14721\ \ \ \ \ \ \ \textcolor{comment}{//\ Try\ to\ subload\ the\ image\ over\ the\ existing\ GL\ Texture\ object,\ possibly}}
\DoxyCodeLine{14722\ \ \ \ \ \ \ \textcolor{comment}{//\ saving\ on\ texture\ memory\ fragmentation.}}
\DoxyCodeLine{14723\ \ \ \ \ \ \ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ pages\ =\ gtc-\/>get\_view\_modified\_pages(view,\ 0);}
\DoxyCodeLine{14724\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_ram\_mipmap\_levels\ ==\ 0)\ \{}
\DoxyCodeLine{14725\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>has\_clear\_color())\ \{}
\DoxyCodeLine{14726\ \ \ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14727\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}clearing\ texture\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}}
\DoxyCodeLine{14728\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth\ <<\ \textcolor{stringliteral}{"{},\ pages\ "{}}\ <<\ pages}
\DoxyCodeLine{14729\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ "{}}\ <<\ num\_levels\ <<\ \textcolor{stringliteral}{"{},\ clear\_color\ =\ "{}}}
\DoxyCodeLine{14730\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ tex-\/>get\_clear\_color();}
\DoxyCodeLine{14731\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14732\ \ \ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14733\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}not\ loading\ NULL\ image\ for\ texture\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{14734\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth}
\DoxyCodeLine{14735\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ pages\ "{}}\ <<\ pages\ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ =\ "{}}\ <<\ num\_levels;}
\DoxyCodeLine{14736\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14737\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14738\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{14739\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}updating\ image\ data\ of\ texture\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}}
\DoxyCodeLine{14740\ \ \ \ \ \ \ \ \ \ \ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth}
\DoxyCodeLine{14741\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ pages\ "{}}\ <<\ pages\ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ "{}}\ <<\ num\_ram\_mipmap\_levels}
\DoxyCodeLine{14742\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ /\ "{}}\ <<\ num\_levels;}
\DoxyCodeLine{14743\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14744\ \ \ \ \ \}}
\DoxyCodeLine{14745\ \ \ \ \ \textcolor{keywordflow}{if}\ (mapped\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14746\ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ (async\ \#"{}}\ <<\ upload\_count\ <<\ \textcolor{stringliteral}{"{}\ via\ buffer\ "{}}\ <<\ pbo\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{14747\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14748\ \ \ \ \ \ \ GLCAT.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}\ (\#"{}}\ <<\ upload\_count\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{14749\ \ \ \ \ \}}
\DoxyCodeLine{14750\ \ \ \}}
\DoxyCodeLine{14751\ }
\DoxyCodeLine{14752\ \ \ \textcolor{comment}{//\ Keeps\ track\ of\ any\ async\ jobs\ we've\ spawned.}}
\DoxyCodeLine{14753\ \textcolor{preprocessor}{\#if\ defined(HAVE\_THREADS)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{14754\ \ \ \mbox{\hyperlink{classCompletionCounter}{CompletionCounter}}\ counter;}
\DoxyCodeLine{14755\ \ \ \textcolor{keyword}{struct\ }AsyncLevel\ \{}
\DoxyCodeLine{14756\ \ \ \ \ \textcolor{keywordtype}{int}\ width,\ height,\ depth;}
\DoxyCodeLine{14757\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size;}
\DoxyCodeLine{14758\ \ \ \ \ uintptr\_t\ pbo\_offset;}
\DoxyCodeLine{14759\ \ \ \ \ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ pages;}
\DoxyCodeLine{14760\ \ \ \};}
\DoxyCodeLine{14761\ \ \ AsyncLevel\ *async\_levels\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{14762\ \ \ \textcolor{keywordtype}{size\_t}\ num\_async\_levels\ =\ 0;}
\DoxyCodeLine{14763\ \ \ uintptr\_t\ pbo\_offset\ =\ 0u;}
\DoxyCodeLine{14764\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14765\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{14766\ }
\DoxyCodeLine{14767\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ mipmap\_bias;\ n\ <\ num\_levels\ +\ mipmap\_bias;\ ++n)\ \{}
\DoxyCodeLine{14768\ \ \ \ \ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ pages\ =\ gtc-\/>get\_view\_modified\_pages(view,\ n);}
\DoxyCodeLine{14769\ \ \ \ \ \textcolor{keywordtype}{int}\ level\ =\ n\ -\/\ mipmap\_bias;}
\DoxyCodeLine{14770\ }
\DoxyCodeLine{14771\ \ \ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_expected\_mipmap\_x\_size(n);}
\DoxyCodeLine{14772\ \ \ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_expected\_mipmap\_y\_size(n);}
\DoxyCodeLine{14773\ }
\DoxyCodeLine{14774\ \ \ \ \ \textcolor{comment}{//\ we\ grab\ the\ mipmap\ pointer\ first,\ if\ it\ is\ NULL\ we\ grab\ the\ normal}}
\DoxyCodeLine{14775\ \ \ \ \ \textcolor{comment}{//\ mipmap\ image\ pointer\ which\ is\ a\ PTA\_uchar}}
\DoxyCodeLine{14776\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *image\_ptr\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)tex-\/>\mbox{\hyperlink{classTexture_a45dc53f3f3f36a177321d88b6c006fd2}{get\_ram\_mipmap\_pointer}}(n);}
\DoxyCodeLine{14777\ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ ptimage;}
\DoxyCodeLine{14778\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14779\ \ \ \ \ \ \ ptimage\ =\ tex-\/>\mbox{\hyperlink{classTexture_ae7896287821c803caaee9f58d025471c}{get\_ram\_mipmap\_image}}(n);}
\DoxyCodeLine{14780\ \ \ \ \ \ \ image\_ptr\ =\ ptimage;}
\DoxyCodeLine{14781\ \ \ \ \ \}}
\DoxyCodeLine{14782\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14783\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{14784\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>is\_of\_type(HTMLVideoTexture::get\_class\_type()))\ \{}
\DoxyCodeLine{14785\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Load\ directly\ from\ the\ video\ element\ into\ WebGL.}}
\DoxyCodeLine{14786\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ result\ =\ EM\_ASM\_INT(\{}
\DoxyCodeLine{14787\ \ \ \ \ \ \ \ \ \ \ var\ video\ =\ window.\_htmlVideoData[\$7].video;}
\DoxyCodeLine{14788\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (video.readyState\ <\ video.HAVE\_CURRENT\_DATA)\ \{}
\DoxyCodeLine{14789\ \ \ \ \ \ \ \ \ \ \ \ \ return\ 0;}
\DoxyCodeLine{14790\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14791\ \ \ \ \ \ \ \ \ \ \ GLctx.pixelStorei(GLctx.UNPACK\_FLIP\_Y\_WEBGL,\ \textcolor{keyword}{true});}
\DoxyCodeLine{14792\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\$8)\ \{}
\DoxyCodeLine{14793\ \ \ \ \ \ \ \ \ \ \ \ \ GLctx.texImage2D(\$0,\ \$1,\ \$2,\ \$3,\ \$4,\ 0,\ \$5,\ \$6,\ video);}
\DoxyCodeLine{14794\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14795\ \ \ \ \ \ \ \ \ \ \ \ \ GLctx.texSubImage2D(\$0,\ \$1,\ 0,\ 0,\ \$3,\ \$4,\ \$5,\ \$6,\ video);}
\DoxyCodeLine{14796\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14797\ \ \ \ \ \ \ \ \ \ \ GLctx.pixelStorei(GLctx.UNPACK\_FLIP\_Y\_WEBGL,\ \textcolor{keyword}{false});}
\DoxyCodeLine{14798\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{14799\ \ \ \ \ \ \ \ \ \},\ target,\ 0,\ internal\_format,\ width,\ height,\ external\_format,\ component\_type,\ tex,\ needs\_reload);}
\DoxyCodeLine{14800\ }
\DoxyCodeLine{14801\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result)\ \{}
\DoxyCodeLine{14802\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{14803\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14805\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14806\ }
\DoxyCodeLine{14807\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ <\ num\_ram\_mipmap\_levels)\ \{}
\DoxyCodeLine{14808\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ were\ told\ we'd\ have\ this\ many\ RAM\ mipmap\ images,\ but\ we}}
\DoxyCodeLine{14809\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ don't.\ \ Raise\ a\ warning.}}
\DoxyCodeLine{14810\ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{14811\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}No\ mipmap\ level\ "{}}\ <<\ n\ <<\ \textcolor{stringliteral}{"{}\ defined\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{14812\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{14813\ }
\DoxyCodeLine{14814\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload\ \&\&\ \_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{14815\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Tell\ the\ GL\ we\ have\ no\ more\ mipmaps\ for\ it\ to\ use.}}
\DoxyCodeLine{14816\ \ \ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAX\_LEVEL,\ level\ -\/\ 1);}
\DoxyCodeLine{14817\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14818\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14819\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14820\ }
\DoxyCodeLine{14821\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>has\_clear\_color())\ \{}
\DoxyCodeLine{14822\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ texture\ has\ a\ clear\ color,\ so\ we\ should\ fill\ this\ mipmap}}
\DoxyCodeLine{14823\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ level\ to\ a\ solid\ color.}}
\DoxyCodeLine{14824\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{14825\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{14826\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_clear\_texture\ \&\&\ !compressed)\ \{}
\DoxyCodeLine{14827\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ storage,\ we\ create\ it\ with\ a\ NULL\ image\ first.}}
\DoxyCodeLine{14828\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!needs\_reload\ ||}
\DoxyCodeLine{14829\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ upload\_texture\_level(\textcolor{keyword}{true},\ \textcolor{keyword}{false},\ target,\ level,}
\DoxyCodeLine{14830\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ internal\_format,}
\DoxyCodeLine{14831\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,}
\DoxyCodeLine{14832\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ 0,\ pages,\ usage))\ \{}
\DoxyCodeLine{14833\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vector\_uchar\ clear\_data\ =\ tex-\/>get\_clear\_data();}
\DoxyCodeLine{14834\ }
\DoxyCodeLine{14835\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload\ ||\ pages.has\_all\_of(0,\ depth))\ \{}
\DoxyCodeLine{14836\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_glClearTexImage(index,\ level,\ external\_format,}
\DoxyCodeLine{14837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ (\textcolor{keywordtype}{void}\ *)\&clear\_data[0]);}
\DoxyCodeLine{14838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ sri\ =\ 0;\ sri\ <\ pages.get\_num\_subranges();\ ++sri)\ \{}
\DoxyCodeLine{14840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ pages.get\_subrange\_begin(sri);}
\DoxyCodeLine{14841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ pages.get\_subrange\_end(sri)\ -\/\ begin;}
\DoxyCodeLine{14842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_glClearTexSubImage(index,\ level,\ 0,\ 0,\ begin,}
\DoxyCodeLine{14843\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ num\_pages,\ external\_format,}
\DoxyCodeLine{14844\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ (\textcolor{keywordtype}{void}\ *)\&clear\_data[0]);}
\DoxyCodeLine{14845\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14846\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{14847\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14848\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14849\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{14850\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_clear\_buffer)\ \{}
\DoxyCodeLine{14851\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ For\ buffer\ textures\ we\ need\ to\ clear\ the\ underlying}}
\DoxyCodeLine{14852\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ storage.}}
\DoxyCodeLine{14853\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14854\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_glBufferData(GL\_TEXTURE\_BUFFER,\ tex-\/>get\_expected\_ram\_mipmap\_view\_size(n),\ \textcolor{keyword}{nullptr},\ usage);}
\DoxyCodeLine{14855\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14856\ \ \ \ \ \ \ \ \ \ \ \ \ vector\_uchar\ clear\_data\ =\ tex-\/>get\_clear\_data();}
\DoxyCodeLine{14857\ }
\DoxyCodeLine{14858\ \ \ \ \ \ \ \ \ \ \ \ \ \_glClearBufferData(GL\_TEXTURE\_BUFFER,\ internal\_format,\ external\_format,}
\DoxyCodeLine{14859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *)\&clear\_data[0]);}
\DoxyCodeLine{14860\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{14861\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14862\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14863\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{14864\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Ask\ the\ Texture\ class\ to\ create\ the\ mipmap\ level\ in\ RAM.\ It'll}}
\DoxyCodeLine{14865\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fill\ it\ in\ with\ the\ correct\ clear\ color,\ which\ we\ can\ then}}
\DoxyCodeLine{14866\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ upload.}}
\DoxyCodeLine{14867\ \ \ \ \ \ \ \ \ ptimage\ =\ tex-\/>make\_ram\_mipmap\_image(n);}
\DoxyCodeLine{14868\ \ \ \ \ \ \ \ \ image\_ptr\ =\ ptimage;}
\DoxyCodeLine{14869\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14870\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!needs\_reload)\ \{}
\DoxyCodeLine{14871\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ clear\ color\ and\ no\ more\ images,\ and\ no\ storage\ to\ create.}}
\DoxyCodeLine{14872\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14873\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14874\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (compressed)\ \{}
\DoxyCodeLine{14875\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can't\ upload\ a\ NULL\ compressed\ texture.}}
\DoxyCodeLine{14876\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{14877\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Tell\ the\ GL\ we\ have\ no\ more\ mipmaps\ for\ it\ to\ use.}}
\DoxyCodeLine{14878\ \ \ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAX\_LEVEL,\ level\ -\/\ 1);}
\DoxyCodeLine{14879\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14880\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14881\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14882\ \ \ \ \ \}}
\DoxyCodeLine{14883\ }
\DoxyCodeLine{14884\ \ \ \ \ \textcolor{comment}{//\ Select\ the\ correct\ view.}}
\DoxyCodeLine{14885\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ orig\_view\_size\ =\ 0;}
\DoxyCodeLine{14886\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ orig\_page\_size\ =\ 0;}
\DoxyCodeLine{14887\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ 0;}
\DoxyCodeLine{14888\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14889\ \ \ \ \ \ \ orig\_view\_size\ =\ tex-\/>get\_ram\_mipmap\_view\_size(n);}
\DoxyCodeLine{14890\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (view\ >\ 0)\ \{}
\DoxyCodeLine{14891\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *orig\_image\_ptr\ =\ image\_ptr;}
\DoxyCodeLine{14892\ \ \ \ \ \ \ \ \ image\_ptr\ +=\ orig\_view\_size\ *\ view;}
\DoxyCodeLine{14893\ \ \ \ \ \ \ \ \ nassertd(image\_ptr\ >=\ orig\_image\_ptr\ \&\&\ image\_ptr\ +\ orig\_view\_size\ <=\ orig\_image\_ptr\ +\ tex-\/>get\_ram\_mipmap\_image\_size(n))\ \{}
\DoxyCodeLine{14894\ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14895\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14896\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14897\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14898\ }
\DoxyCodeLine{14899\ \ \ \ \ \ \ orig\_page\_size\ =\ tex-\/>get\_ram\_mipmap\_page\_size(n);}
\DoxyCodeLine{14900\ \ \ \ \ \ \ page\_size\ =\ orig\_page\_size;}
\DoxyCodeLine{14901\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{14902\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ May\ need\ to\ convert.}}
\DoxyCodeLine{14903\ \ \ \ \ \ \ \ \ page\_size\ =\ get\_external\_format\_components(external\_format)\ *\ (page\_size\ /\ num\_components);}
\DoxyCodeLine{14904\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14905\ \ \ \ \ \}}
\DoxyCodeLine{14906\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{14907\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{14908\ \ \ \ \ \ \ \textcolor{comment}{//\ page\_size\ for\ buffer\ texture\ indicates\ the\ size\ even\ for\ a\ null\ image.}}
\DoxyCodeLine{14909\ \ \ \ \ \ \ page\_size\ =\ tex-\/>get\_expected\_ram\_mipmap\_view\_size(n);}
\DoxyCodeLine{14910\ \ \ \ \ \}}
\DoxyCodeLine{14911\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14912\ }
\DoxyCodeLine{14913\ \ \ \ \ \textcolor{comment}{//\ Don't\ need\ to\ update\ the\ padded\ area\ at\ the\ bottom.}}
\DoxyCodeLine{14914\ \ \ \ \ \textcolor{keywordtype}{int}\ sub\_height\ =\ height;}
\DoxyCodeLine{14915\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ ==\ 0\ \&\&\ (target\ ==\ GL\_TEXTURE\_2D\ ||\ target\ ==\ GL\_TEXTURE\_CUBE\_MAP))\ \{}
\DoxyCodeLine{14916\ \ \ \ \ \ \ sub\_height\ -\/=\ tex-\/>get\_pad\_y\_size();}
\DoxyCodeLine{14917\ \ \ \ \ \}}
\DoxyCodeLine{14918\ }
\DoxyCodeLine{14919\ \textcolor{preprocessor}{\#if\ defined(HAVE\_THREADS)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{14920\ \ \ \ \ \textcolor{keywordflow}{if}\ (mapped\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14921\ \ \ \ \ \ \ \textcolor{comment}{//\ Let's\ make\ sure\ we\ have\ texture\ storage\ (normally\ this\ is\ handled\ by}}
\DoxyCodeLine{14922\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ glTexStorage2D\ calls\ above,\ if\ immutable\ texture\ storage\ is}}
\DoxyCodeLine{14923\ \ \ \ \ \ \ \textcolor{comment}{//\ supported\ and\ enabled),\ it\ makes\ other\ things\ easier\ down\ the\ line.}}
\DoxyCodeLine{14924\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{14925\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_create\_texture\_storage\_pcollector);}
\DoxyCodeLine{14926\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!upload\_texture\_level(\textcolor{keyword}{true},\ compressed,\ target,\ level,}
\DoxyCodeLine{14927\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ internal\_format,}
\DoxyCodeLine{14928\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,}
\DoxyCodeLine{14929\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ page\_size,\ pages,\ usage))\ \{}
\DoxyCodeLine{14930\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ ==\ 0)\ \{}
\DoxyCodeLine{14931\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ level\ 0\ failed\ to\ create,\ this\ texture\ is\ useless.}}
\DoxyCodeLine{14932\ \ \ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{14933\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14934\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{14935\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apparently,\ this\ is\ all\ it's\ going\ to\ get.}}
\DoxyCodeLine{14936\ \ \ \ \ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAX\_LEVEL,\ level\ -\/\ 1);}
\DoxyCodeLine{14937\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14938\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14939\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14940\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14941\ }
\DoxyCodeLine{14942\ \ \ \ \ \ \ \textcolor{comment}{//\ Spawn\ a\ task\ to\ do\ the\ upload\ asynchronously\ into\ the\ PBO.}}
\DoxyCodeLine{14943\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14944\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *mapped\_level\_ptr\ =\ (\textcolor{keywordtype}{char}\ *)mapped\_ptr\ +\ pbo\_offset;}
\DoxyCodeLine{14945\ }
\DoxyCodeLine{14946\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ptimage)\ \{}
\DoxyCodeLine{14947\ \ \ \ \ \ \ \ \ \ \ ptimage.node\_ref();}
\DoxyCodeLine{14948\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14949\ \ \ \ \ \ \ \ \ \_async\_chain-\/>add([=,\ ptimage\ =\ std::move(ptimage),\ token\ =\ counter.make\_token()](\mbox{\hyperlink{classAsyncTask}{AsyncTask}}\ *task)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{14950\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{14951\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_load\_texture\_copy\_pcollector);}
\DoxyCodeLine{14952\ \ \ \ \ \ \ \ \ \ \ \ \ copy\_image((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)mapped\_level\_ptr,\ image\_ptr,\ orig\_view\_size,}
\DoxyCodeLine{14953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ num\_components,\ component\_width);}
\DoxyCodeLine{14954\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14955\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ptimage)\ \{}
\DoxyCodeLine{14956\ \ \ \ \ \ \ \ \ \ \ \ \ ptimage.node\_unref();}
\DoxyCodeLine{14957\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14958\ }
\DoxyCodeLine{14959\ \ \ \ \ \ \ \ \ \ \ token.complete(\textcolor{keyword}{true});}
\DoxyCodeLine{14960\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ AsyncTask::DS\_done;}
\DoxyCodeLine{14961\ \ \ \ \ \ \ \ \ \},\ \textcolor{stringliteral}{"{}copy:"{}}\ +\ tex-\/>get\_name());}
\DoxyCodeLine{14962\ }
\DoxyCodeLine{14963\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (async\_levels\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14964\ \ \ \ \ \ \ \ \ \ \ async\_levels\ =\ \textcolor{keyword}{new}\ AsyncLevel[num\_levels\ +\ 1];}
\DoxyCodeLine{14965\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{14966\ \ \ \ \ \ \ \ \ async\_levels[num\_async\_levels++]\ =\ \{width,\ sub\_height,\ depth,\ page\_size,\ pbo\_offset,\ std::move(pages)\};}
\DoxyCodeLine{14967\ \ \ \ \ \ \ \ \ pbo\_offset\ +=\ page\_size\ *\ depth;}
\DoxyCodeLine{14968\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{14969\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14970\ \ \ \ \ \}}
\DoxyCodeLine{14971\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{14972\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{14973\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (page\_size\ !=\ orig\_page\_size\ ||\ external\_format\ ==\ GL\_RGBA\ ||\ external\_format\ ==\ GL\_RGB)\ \{}
\DoxyCodeLine{14974\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ GL\ doesn't\ claim\ to\ support\ BGR,\ we\ may\ have\ to\ reverse}}
\DoxyCodeLine{14975\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ component\ ordering\ of\ the\ image.}}
\DoxyCodeLine{14976\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_load\_texture\_copy\_pcollector);}
\DoxyCodeLine{14977\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ new\_image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ depth);}
\DoxyCodeLine{14978\ \ \ \ \ \ \ \ \ copy\_image(\&new\_image[0],\ image\_ptr,\ orig\_view\_size,}
\DoxyCodeLine{14979\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ num\_components,\ component\_width);}
\DoxyCodeLine{14980\ }
\DoxyCodeLine{14981\ \ \ \ \ \ \ \ \ ptimage\ =\ std::move(new\_image);}
\DoxyCodeLine{14982\ \ \ \ \ \ \ \ \ image\_ptr\ =\ ptimage;}
\DoxyCodeLine{14983\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14984\ \ \ \ \ \}}
\DoxyCodeLine{14985\ }
\DoxyCodeLine{14986\ \ \ \ \ \textcolor{comment}{//\ Try\ updating\ the\ existing\ storage\ (sub-\/loading)\ first.}}
\DoxyCodeLine{14987\ \ \ \ \ \textcolor{keywordflow}{if}\ (!needs\_reload)\ \{}
\DoxyCodeLine{14988\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!upload\_texture\_level(\textcolor{keyword}{false},\ compressed,\ target,\ level,}
\DoxyCodeLine{14989\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ sub\_height,\ depth,\ internal\_format,}
\DoxyCodeLine{14990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,}
\DoxyCodeLine{14991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_ptr,\ page\_size,\ pages,\ usage))\ \{}
\DoxyCodeLine{14992\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{14993\ \ \ \ \ \ \ \}}
\DoxyCodeLine{14994\ }
\DoxyCodeLine{14995\ \ \ \ \ \ \ \textcolor{comment}{//\ Did\ that\ fail?\ \ If\ it\ did,\ we'll\ immediately\ try\ again,\ this\ time}}
\DoxyCodeLine{14996\ \ \ \ \ \ \ \textcolor{comment}{//\ loading\ the\ texture\ from\ scratch.}}
\DoxyCodeLine{14997\ \ \ \ \ \ \ GLenum\ error\_code\ =\ gl\_get\_error();}
\DoxyCodeLine{14998\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{14999\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_warning())\ \{}
\DoxyCodeLine{15000\ \ \ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{15001\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\ texture\ subload\ failed\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{15002\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ level\ "{}}\ <<\ level\ <<\ \textcolor{stringliteral}{"{}:\ "{}}\ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15003\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15004\ \ \ \ \ \ \ \ \ needs\_reload\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{15005\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15006\ \ \ \ \ \}}
\DoxyCodeLine{15007\ }
\DoxyCodeLine{15008\ \ \ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{15009\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!upload\_texture\_level(\textcolor{keyword}{true},\ compressed,\ target,\ level,}
\DoxyCodeLine{15010\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ internal\_format,}
\DoxyCodeLine{15011\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,}
\DoxyCodeLine{15012\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image\_ptr,\ page\_size,\ pages,\ usage))\ \{}
\DoxyCodeLine{15013\ }
\DoxyCodeLine{15014\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{15015\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apparently,\ this\ is\ all\ it's\ going\ to\ get.}}
\DoxyCodeLine{15016\ \ \ \ \ \ \ \ \ \ \ glTexParameteri(target,\ GL\_TEXTURE\_MAX\_LEVEL,\ level);}
\DoxyCodeLine{15017\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15018\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level\ ==\ 0)\ \{}
\DoxyCodeLine{15019\ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15020\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15021\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15022\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15023\ \ \ \ \ \}}
\DoxyCodeLine{15024\ \ \ \}}
\DoxyCodeLine{15025\ }
\DoxyCodeLine{15026\ \ \ \textcolor{comment}{//\ Purely\ synchronous\ path,\ we\ can\ finish\ up\ the\ creation\ now.}}
\DoxyCodeLine{15027\ \ \ \textcolor{comment}{//\ Report\ the\ error\ message\ explicitly\ if\ the\ GL\ texture\ creation\ failed.}}
\DoxyCodeLine{15028\ \ \ \textcolor{keywordflow}{if}\ (needs\_reload)\ \{}
\DoxyCodeLine{15029\ \ \ \ \ GLenum\ error\_code\ =\ gl\_get\_error();}
\DoxyCodeLine{15030\ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{15031\ \ \ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{15032\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\ texture\ creation\ failed\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{15033\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15034\ }
\DoxyCodeLine{15035\ \ \ \ \ \ \ gtc-\/>\_has\_storage\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15036\ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15037\ \ \ \ \ \}}
\DoxyCodeLine{15038\ \ \ \}}
\DoxyCodeLine{15039\ }
\DoxyCodeLine{15040\ \textcolor{preprocessor}{\#if\ defined(HAVE\_THREADS)\ \&\&\ !defined(OPENGLES\_1)}}
\DoxyCodeLine{15041\ \ \ \textcolor{keywordflow}{if}\ (async\_levels\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{15042\ \ \ \ \ \textcolor{comment}{//\ Schedule\ a\ follow-\/up\ task\ to\ finish\ the\ upload,\ which\ needs\ to\ happen}}
\DoxyCodeLine{15043\ \ \ \ \ \textcolor{comment}{//\ with\ bound\ context,\ so\ we\ use\ a\ special\ mini\ job\ queue\ for\ that.}}
\DoxyCodeLine{15044\ }
\DoxyCodeLine{15045\ \ \ \ \ \textcolor{comment}{//\ Storing\ 0\ as\ last\ item\ saves\ some\ closure\ space.}}
\DoxyCodeLine{15046\ \ \ \ \ async\_levels[num\_async\_levels]\ =\ \{0\};}
\DoxyCodeLine{15047\ }
\DoxyCodeLine{15048\ \ \ \ \ std::move(counter).then([}
\DoxyCodeLine{15049\ \ \ \ \ \ \ \ \ \textcolor{keyword}{this},\ token\ =\ std::move(token),}
\DoxyCodeLine{15050\ \ \ \ \ \ \ \ \ async\_levels,\ gtc,\ view,\ pbo,\ pbo\_size,\ upload\_count,}
\DoxyCodeLine{15051\ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ compressed}
\DoxyCodeLine{15052\ \ \ \ \ \ \ ]\ (\textcolor{keywordtype}{bool}\ success)\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{15053\ \ \ \ \ \ \ call\_later([=,\ token\ =\ std::move(token)]\ ()\ \textcolor{keyword}{mutable}\ \{}
\DoxyCodeLine{15054\ \ \ \ \ \ \ \ \ \_glBindBuffer(GL\_PIXEL\_UNPACK\_BUFFER,\ pbo);}
\DoxyCodeLine{15055\ \ \ \ \ \ \ \ \ \_glUnmapBuffer(GL\_PIXEL\_UNPACK\_BUFFER);}
\DoxyCodeLine{15056\ }
\DoxyCodeLine{15057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_uploads\_finished\ -\/\ upload\_count\ >=\ 0)\ \{}
\DoxyCodeLine{15058\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Updates\ arrived\ out\ of\ order,\ so\ we\ skip\ this\ one,\ since\ a\ newer}}
\DoxyCodeLine{15059\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ was\ already\ finished.}}
\DoxyCodeLine{15060\ \ \ \ \ \ \ \ \ \ \ GLCAT.info()}
\DoxyCodeLine{15061\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Discarding\ async\ update\ \#"{}}\ <<\ upload\_count\ <<\ \textcolor{stringliteral}{"{}\ to\ texture\ "{}}}
\DoxyCodeLine{15062\ \ \ \ \ \ \ \ \ \ \ \ \ <<\ gtc-\/>get\_texture()-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15063\ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15064\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (view\ >=\ gtc-\/>\_num\_views)\ \{}
\DoxyCodeLine{15066\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ uploaded\ a\ view\ that\ is\ no\ longer\ needed,\ we\ silently}}
\DoxyCodeLine{15067\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ consider\ it\ a\ success,\ even\ if\ the\ task\ failed.}}
\DoxyCodeLine{15068\ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{15069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!apply\_texture(gtc,\ view))\ \{}
\DoxyCodeLine{15071\ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15072\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15073\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{15074\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_load\_texture\_pcollector);}
\DoxyCodeLine{15075\ }
\DoxyCodeLine{15076\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{15077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can\ use\ a\ trick\ for\ buffer\ textures:\ just\ swap\ the\ "{}PBO"{}\ with}}
\DoxyCodeLine{15078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ existing\ texture\ storage.\ \ The\ existing\ storage\ becomes\ the}}
\DoxyCodeLine{15079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ new\ PBO.\ \ Note\ also\ that\ buffer\ textures\ have\ no\ mipmaps.}}
\DoxyCodeLine{15080\ \ \ \ \ \ \ \ \ \ \ \ \ \_glTexBuffer(GL\_TEXTURE\_BUFFER,\ gtc-\/>\_internal\_format,\ pbo);}
\DoxyCodeLine{15081\ \ \ \ \ \ \ \ \ \ \ \ \ std::swap(pbo,\ gtc-\/>\_buffers[view]);}
\DoxyCodeLine{15082\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15083\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ level\ =\ 0;\ async\_levels[level].width\ !=\ 0;\ ++level)\ \{}
\DoxyCodeLine{15085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AsyncLevel\ \&data\ =\ async\_levels[level];}
\DoxyCodeLine{15086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!upload\_texture\_level(\textcolor{keyword}{false},\ compressed,\ gtc-\/>\_target,\ level,}
\DoxyCodeLine{15087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.width,\ data.height,\ data.depth,}
\DoxyCodeLine{15088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gtc-\/>\_internal\_format,\ external\_format,}
\DoxyCodeLine{15089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ component\_type,\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)data.pbo\_offset,}
\DoxyCodeLine{15090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.page\_size,\ data.pages,\ GL\_STATIC\_DRAW))\ \{}
\DoxyCodeLine{15091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level\ \&\&\ !gtc-\/>\_generate\_mipmaps)\ \{}
\DoxyCodeLine{15092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apparently,\ this\ is\ all\ it's\ going\ to\ get.}}
\DoxyCodeLine{15093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ glTexParameteri(gtc-\/>\_target,\ GL\_TEXTURE\_MAX\_LEVEL,\ level\ -\/\ 1);}
\DoxyCodeLine{15094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15098\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15099\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15100\ }
\DoxyCodeLine{15101\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{15102\ \ \ \ \ \ \ \ \ \ \ \ \ gtc-\/>\_uploads\_finished\ =\ upload\_count;}
\DoxyCodeLine{15103\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15104\ }
\DoxyCodeLine{15105\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_generate\_mipmaps\ \&\&\ \_glGenerateMipmap\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{15106\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ uploaded\ an\ image;\ we\ may\ need\ to\ generate\ mipmaps.}}
\DoxyCodeLine{15107\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{15108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{15109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}generating\ mipmaps\ for\ texture\ "{}}\ <<\ gtc-\/>get\_texture()-\/>get\_name()}
\DoxyCodeLine{15110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}\ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ async\_levels[0].width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}}
\DoxyCodeLine{15111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ async\_levels[0].height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ async\_levels[0].depth}
\DoxyCodeLine{15112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ =\ "{}}\ <<\ gtc-\/>\_num\_levels}
\DoxyCodeLine{15113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ (async\ update\ \#"{}}\ <<\ upload\_count\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{15114\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15115\ \ \ \ \ \ \ \ \ \ \ \ \ \_glGenerateMipmap(gtc-\/>\_target);}
\DoxyCodeLine{15116\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15117\ }
\DoxyCodeLine{15118\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (success\ \&\&\ gtc-\/>get\_texture()-\/>get\_post\_load\_store\_cache())\ \{}
\DoxyCodeLine{15119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!do\_extract\_texture\_data(gtc,\ view))\ \{}
\DoxyCodeLine{15120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15121\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15122\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15124\ \ \ \ \ \ \ \ \ \_glBindBuffer(GL\_PIXEL\_UNPACK\_BUFFER,\ 0);}
\DoxyCodeLine{15125\ }
\DoxyCodeLine{15126\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ goes\ back\ into\ the\ pool.}}
\DoxyCodeLine{15127\ \ \ \ \ \ \ \ \ gtc-\/>return\_pbo(pbo,\ pbo\_size);}
\DoxyCodeLine{15128\ }
\DoxyCodeLine{15129\ \ \ \ \ \ \ \ \ token.complete(success);}
\DoxyCodeLine{15130\ }
\DoxyCodeLine{15131\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}[]\ async\_levels;}
\DoxyCodeLine{15132\ \ \ \ \ \ \ \});}
\DoxyCodeLine{15133\ \ \ \ \ \});}
\DoxyCodeLine{15134\ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{15135\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15136\ \ \ \{}
\DoxyCodeLine{15137\ \ \ \ \ \textcolor{comment}{//\ This\ ensures\ any\ pending\ async\ op\ will\ not\ overwrite\ what\ we\ just\ did.}}
\DoxyCodeLine{15138\ \ \ \ \ gtc-\/>\_uploads\_finished\ =\ upload\_count;}
\DoxyCodeLine{15139\ }
\DoxyCodeLine{15140\ \ \ \ \ \textcolor{keywordflow}{if}\ (pbo\ !=\ 0)\ \{}
\DoxyCodeLine{15141\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ whatever\ reason,\ we\ haven't\ used\ the\ PBO,\ so\ return\ it.}}
\DoxyCodeLine{15142\ \ \ \ \ \ \ gtc-\/>return\_pbo(pbo,\ pbo\_size);}
\DoxyCodeLine{15143\ \ \ \ \ \}}
\DoxyCodeLine{15144\ }
\DoxyCodeLine{15145\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_generate\_mipmaps\ \&\&\ \_glGenerateMipmap\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !image.is\_null())\ \{}
\DoxyCodeLine{15146\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ uploaded\ an\ image;\ we\ may\ need\ to\ generate\ mipmaps.}}
\DoxyCodeLine{15147\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{15148\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{15149\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}generating\ mipmaps\ for\ texture\ "{}}\ <<\ gtc-\/>get\_texture()-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\ view\ "{}}}
\DoxyCodeLine{15150\ \ \ \ \ \ \ \ \ \ \ <<\ view\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{}\ x\ "{}}\ <<\ depth}
\DoxyCodeLine{15151\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ mipmaps\ =\ "{}}\ <<\ num\_levels\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15152\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15153\ \ \ \ \ \ \ \_glGenerateMipmap(gtc-\/>\_target);}
\DoxyCodeLine{15154\ \ \ \ \ \}}
\DoxyCodeLine{15155\ }
\DoxyCodeLine{15156\ \ \ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>get\_texture()-\/>get\_post\_load\_store\_cache())\ \{}
\DoxyCodeLine{15157\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!do\_extract\_texture\_data(gtc,\ view))\ \{}
\DoxyCodeLine{15158\ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15159\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15160\ \ \ \ \ \}}
\DoxyCodeLine{15161\ }
\DoxyCodeLine{15162\ \ \ \ \ token.complete(success);}
\DoxyCodeLine{15163\ \ \ \}}
\DoxyCodeLine{15164\ }
\DoxyCodeLine{15165\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15166\ }
\DoxyCodeLine{15167\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{15168\ \}}
\DoxyCodeLine{15169\ }
\DoxyCodeLine{15181\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15182\ upload\_texture\_level(bool\ full\_reload,\ bool\ compressed,\ GLenum\ target,}
\DoxyCodeLine{15183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int\ level,\ int\ width,\ int\ height,\ int\ depth,}
\DoxyCodeLine{15184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLint\ internal\_format,\ GLint\ external\_format,}
\DoxyCodeLine{15185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLenum\ component\_type,\ const\ unsigned\ char\ *image\_ptr,}
\DoxyCodeLine{15186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ size\_t\ page\_size,\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ pages,}
\DoxyCodeLine{15187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GLenum\ usage\_hint)\ \{}
\DoxyCodeLine{15188\ }
\DoxyCodeLine{15189\ \ \ \textcolor{keywordflow}{switch}\ (target)\ \{}
\DoxyCodeLine{15190\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15191\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_3D:}
\DoxyCodeLine{15192\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{15193\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15194\ \ \ \ \ \}}
\DoxyCodeLine{15195\ }
\DoxyCodeLine{15196\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15197\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15198\ \ \ \ \ \ \ \ \ \_glTexImage3D(target,\ level,\ internal\_format,}
\DoxyCodeLine{15199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ 0,}
\DoxyCodeLine{15200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15201\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15202\ \ \ \ \ \ \ \ \ \_glCompressedTexImage3D(target,\ level,\ external\_format,}
\DoxyCodeLine{15203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ 0,\ page\_size\ *\ depth,\ image\_ptr);}
\DoxyCodeLine{15204\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15205\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15206\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ sri\ =\ 0;\ sri\ <\ pages.get\_num\_subranges();\ ++sri)\ \{}
\DoxyCodeLine{15207\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ pages.get\_subrange\_begin(sri);}
\DoxyCodeLine{15208\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ pages.get\_subrange\_end(sri)\ -\/\ begin;}
\DoxyCodeLine{15209\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *page\_ptr\ =\ image\_ptr\ +\ page\_size\ *\ begin;}
\DoxyCodeLine{15210\ }
\DoxyCodeLine{15211\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15212\ \ \ \ \ \ \ \ \ \ \ \_glTexSubImage3D(target,\ level,}
\DoxyCodeLine{15213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ begin,\ width,\ height,\ num\_pages,}
\DoxyCodeLine{15214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ page\_ptr);}
\DoxyCodeLine{15215\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15216\ \ \ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage3D(target,\ level,}
\DoxyCodeLine{15217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ begin,\ width,\ height,\ num\_pages,}
\DoxyCodeLine{15218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,}
\DoxyCodeLine{15219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ page\_size\ *\ num\_pages,\ page\_ptr);}
\DoxyCodeLine{15220\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15221\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15222\ \ \ \ \ \}}
\DoxyCodeLine{15223\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15224\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{15225\ }
\DoxyCodeLine{15226\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15227\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_2D\_ARRAY:}
\DoxyCodeLine{15228\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_CUBE\_MAP\_ARRAY:}
\DoxyCodeLine{15229\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{15230\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15231\ \ \ \ \ \}}
\DoxyCodeLine{15232\ }
\DoxyCodeLine{15233\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15235\ \ \ \ \ \ \ \ \ \_glTexImage3D(target,\ level,\ internal\_format,\ width,\ height,\ depth,\ 0,}
\DoxyCodeLine{15236\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15237\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15238\ \ \ \ \ \ \ \ \ \_glCompressedTexImage3D(target,\ level,\ external\_format,}
\DoxyCodeLine{15239\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ depth,\ 0,}
\DoxyCodeLine{15240\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ page\_size\ *\ depth,\ image\_ptr);}
\DoxyCodeLine{15241\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15242\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15243\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ sri\ =\ 0;\ sri\ <\ pages.get\_num\_subranges();\ ++sri)\ \{}
\DoxyCodeLine{15244\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ pages.get\_subrange\_begin(sri);}
\DoxyCodeLine{15245\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_pages\ =\ pages.get\_subrange\_end(sri)\ -\/\ begin;}
\DoxyCodeLine{15246\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *page\_ptr\ =\ image\_ptr\ +\ page\_size\ *\ begin;}
\DoxyCodeLine{15247\ }
\DoxyCodeLine{15248\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15249\ \ \ \ \ \ \ \ \ \ \ \_glTexSubImage3D(target,\ level,}
\DoxyCodeLine{15250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ begin,\ width,\ height,\ num\_pages,}
\DoxyCodeLine{15251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ page\_ptr);}
\DoxyCodeLine{15252\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15253\ \ \ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage3D(target,\ level,}
\DoxyCodeLine{15254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ begin,\ width,\ height,\ num\_pages,}
\DoxyCodeLine{15255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,}
\DoxyCodeLine{15256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ page\_size\ *\ num\_pages,\ page\_ptr);}
\DoxyCodeLine{15257\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15258\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15259\ \ \ \ \ \}}
\DoxyCodeLine{15260\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15261\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{15262\ }
\DoxyCodeLine{15263\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15264\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_BUFFER:}
\DoxyCodeLine{15265\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_buffer\_texture)\ \{}
\DoxyCodeLine{15266\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15267\ \ \ \ \ \}}
\DoxyCodeLine{15268\ }
\DoxyCodeLine{15269\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15270\ \ \ \ \ \ \ \_glBufferData(GL\_TEXTURE\_BUFFER,\ page\_size,\ image\_ptr,\ usage\_hint);}
\DoxyCodeLine{15271\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15272\ \ \ \ \ \ \ \_glBufferSubData(GL\_TEXTURE\_BUFFER,\ 0,\ page\_size,\ image\_ptr);}
\DoxyCodeLine{15273\ \ \ \ \ \}}
\DoxyCodeLine{15274\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15275\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{15276\ }
\DoxyCodeLine{15277\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_CUBE\_MAP:}
\DoxyCodeLine{15278\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_cube\_map)\ \{}
\DoxyCodeLine{15279\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15280\ \ \ \ \ \}}
\DoxyCodeLine{15281\ }
\DoxyCodeLine{15282\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ only\ texture\ type\ that\ must\ be\ specified\ using\ separate}}
\DoxyCodeLine{15283\ \ \ \ \ \textcolor{comment}{//\ per-\/page\ calls.}}
\DoxyCodeLine{15284\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15285\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ 6;\ ++z)\ \{}
\DoxyCodeLine{15286\ \ \ \ \ \ \ \ \ GLenum\ page\_target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X\ +\ z;}
\DoxyCodeLine{15287\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *page\_ptr\ =}
\DoxyCodeLine{15288\ \ \ \ \ \ \ \ \ \ \ (image\_ptr\ !=\ \textcolor{keyword}{nullptr})\ ?\ image\_ptr\ +\ page\_size\ *\ z\ :\ nullptr;}
\DoxyCodeLine{15289\ }
\DoxyCodeLine{15290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15291\ \ \ \ \ \ \ \ \ \ \ glTexImage2D(page\_target,\ level,\ internal\_format,\ width,\ height,\ 0,}
\DoxyCodeLine{15292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ page\_ptr);}
\DoxyCodeLine{15293\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15294\ \ \ \ \ \ \ \ \ \ \ \_glCompressedTexImage2D(page\_target,\ level,\ external\_format,}
\DoxyCodeLine{15295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ 0,\ page\_size,\ page\_ptr);}
\DoxyCodeLine{15296\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15297\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15298\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15299\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ 6;\ ++z)\ \{}
\DoxyCodeLine{15300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pages.get\_bit(z))\ \{}
\DoxyCodeLine{15301\ \ \ \ \ \ \ \ \ \ \ GLenum\ page\_target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X\ +\ z;}
\DoxyCodeLine{15302\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *page\_ptr\ =\ image\_ptr\ +\ page\_size\ *\ z;}
\DoxyCodeLine{15303\ }
\DoxyCodeLine{15304\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15305\ \ \ \ \ \ \ \ \ \ \ \ \ glTexSubImage2D(page\_target,\ level,\ 0,\ 0,\ width,\ height,}
\DoxyCodeLine{15306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ page\_ptr);}
\DoxyCodeLine{15307\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15308\ \ \ \ \ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage2D(page\_target,\ level,}
\DoxyCodeLine{15309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ width,\ height,}
\DoxyCodeLine{15310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ page\_size,\ page\_ptr);}
\DoxyCodeLine{15311\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15312\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{15313\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15314\ \ \ \ \ \}}
\DoxyCodeLine{15315\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15316\ }
\DoxyCodeLine{15317\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15318\ \ \ \textcolor{keywordflow}{case}\ GL\_TEXTURE\_1D:}
\DoxyCodeLine{15319\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15320\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15321\ \ \ \ \ \ \ \ \ glTexImage1D(target,\ level,\ internal\_format,}
\DoxyCodeLine{15322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ 0,\ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15323\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15324\ \ \ \ \ \ \ \ \ \_glCompressedTexImage1D(target,\ level,\ external\_format,}
\DoxyCodeLine{15325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ 0,\ page\_size,\ image\_ptr);}
\DoxyCodeLine{15326\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15327\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15328\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15329\ \ \ \ \ \ \ \ \ glTexSubImage1D(target,\ level,\ 0,\ width,}
\DoxyCodeLine{15330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15331\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15332\ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage1D(target,\ level,\ 0,\ width,}
\DoxyCodeLine{15333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ page\_size,\ image\_ptr);}
\DoxyCodeLine{15334\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15335\ \ \ \ \ \}}
\DoxyCodeLine{15336\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15337\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES}}
\DoxyCodeLine{15338\ }
\DoxyCodeLine{15339\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{15340\ \ \ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15341\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15342\ \ \ \ \ \ \ \ \ glTexImage2D(target,\ level,\ internal\_format,\ width,\ height,\ 0,}
\DoxyCodeLine{15343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15344\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15345\ \ \ \ \ \ \ \ \ \_glCompressedTexImage2D(target,\ level,\ external\_format,}
\DoxyCodeLine{15346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ 0,\ page\_size,\ image\_ptr);}
\DoxyCodeLine{15347\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15348\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15349\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!compressed)\ \{}
\DoxyCodeLine{15350\ \ \ \ \ \ \ \ \ glTexSubImage2D(target,\ level,\ 0,\ 0,\ width,\ height,}
\DoxyCodeLine{15351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15352\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15353\ \ \ \ \ \ \ \ \ \_glCompressedTexSubImage2D(target,\ level,\ 0,\ 0,\ width,\ height,}
\DoxyCodeLine{15354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ page\_size,\ image\_ptr);}
\DoxyCodeLine{15355\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15356\ \ \ \ \ \}}
\DoxyCodeLine{15357\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15358\ \ \ \}}
\DoxyCodeLine{15359\ }
\DoxyCodeLine{15360\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{15361\ \ \ \textcolor{keywordflow}{if}\ (full\_reload)\ \{}
\DoxyCodeLine{15362\ \ \ \ \ \_data\_transferred\_pcollector.add\_level(page\_size\ *\ depth);}
\DoxyCodeLine{15363\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15364\ \ \ \ \ \_data\_transferred\_pcollector.add\_level(pages.get\_num\_on\_bits()\ *\ depth);}
\DoxyCodeLine{15365\ \ \ \}}
\DoxyCodeLine{15366\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15367\ }
\DoxyCodeLine{15368\ \ \ \textcolor{comment}{//\ Did\ that\ fail?\ \ If\ it\ did,\ we'll\ immediately\ try\ again,\ this\ time}}
\DoxyCodeLine{15369\ \ \ \textcolor{comment}{//\ loading\ the\ texture\ from\ scratch.}}
\DoxyCodeLine{15370\ \ \ \textcolor{comment}{/*GLenum\ error\_code\ =\ gl\_get\_error();}}
\DoxyCodeLine{15371\ \textcolor{comment}{\ \ if\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}}
\DoxyCodeLine{15372\ \textcolor{comment}{\ \ \ \ if\ (GLCAT.is\_debug())\ \{}}
\DoxyCodeLine{15373\ \textcolor{comment}{\ \ \ \ \ \ GLCAT.debug()}}
\DoxyCodeLine{15374\ \textcolor{comment}{\ \ \ \ \ \ \ \ <<\ "{}GL\ texture\ subload\ failed\ for\ "{}\ <<\ tex-\/>get\_name()}}
\DoxyCodeLine{15375\ \textcolor{comment}{\ \ \ \ \ \ \ \ <<\ "{}\ :\ "{}\ <<\ get\_error\_string(error\_code)\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{15376\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{15377\ \textcolor{comment}{\ \ \ \ full\_reload\ =\ true;}}
\DoxyCodeLine{15378\ \textcolor{comment}{\ \ \}*/}}
\DoxyCodeLine{15379\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{15380\ \}}
\DoxyCodeLine{15381\ }
\DoxyCodeLine{15385\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15386\ generate\_mipmaps(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc)\ \{}
\DoxyCodeLine{15387\ \ \ gtc-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{15388\ }
\DoxyCodeLine{15389\ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>\_num\_levels\ <=\ 1)\ \{}
\DoxyCodeLine{15390\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{15391\ \ \ \}}
\DoxyCodeLine{15392\ }
\DoxyCodeLine{15393\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15394\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_dsa)\ \{}
\DoxyCodeLine{15395\ \ \ \ \ \textcolor{comment}{//\ OpenGL\ 4.5\ offers\ an\ easy\ way\ to\ do\ this\ without\ binding.}}
\DoxyCodeLine{15396\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ gtc-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{15397\ \ \ \ \ \ \ \_glGenerateTextureMipmap(gtc-\/>\_indices[view]);}
\DoxyCodeLine{15398\ \ \ \ \ \}}
\DoxyCodeLine{15399\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{15400\ \ \ \}}
\DoxyCodeLine{15401\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15402\ }
\DoxyCodeLine{15403\ \ \ \textcolor{keywordflow}{if}\ (\_glGenerateMipmap\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{15404\ \ \ \ \ \_state\_texture\ =\ 0;}
\DoxyCodeLine{15405\ \ \ \ \ update\_texture(gtc,\ \textcolor{keyword}{true});}
\DoxyCodeLine{15406\ }
\DoxyCodeLine{15407\ \ \ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{15408\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ view\ =\ 0;\ view\ <\ gtc-\/>\_num\_views;\ ++view)\ \{}
\DoxyCodeLine{15409\ \ \ \ \ \ \ glBindTexture(target,\ gtc-\/>\_indices[view]);}
\DoxyCodeLine{15410\ \ \ \ \ \ \ \_glGenerateMipmap(target);}
\DoxyCodeLine{15411\ \ \ \ \ \}}
\DoxyCodeLine{15412\ \ \ \ \ glBindTexture(target,\ 0);}
\DoxyCodeLine{15413\ }
\DoxyCodeLine{15414\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{15415\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{15416\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(0x"{}}\ <<\ hex\ <<\ target\ <<\ dec\ <<\ \textcolor{stringliteral}{"{},\ 0)\(\backslash\)n"{}};}
\DoxyCodeLine{15417\ \ \ \ \ \}}
\DoxyCodeLine{15418\ }
\DoxyCodeLine{15419\ \ \ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15420\ \ \ \}}
\DoxyCodeLine{15421\ \}}
\DoxyCodeLine{15422\ }
\DoxyCodeLine{15429\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15430\ upload\_simple\_texture(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc)\ \{}
\DoxyCodeLine{15431\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15432\ }
\DoxyCodeLine{15433\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_load\_texture\_pcollector);}
\DoxyCodeLine{15434\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{15435\ \ \ nassertr(tex\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{15436\ }
\DoxyCodeLine{15437\ \ \ gtc-\/>set\_num\_views(1);}
\DoxyCodeLine{15438\ \ \ GLuint\ index\ =\ gtc-\/>get\_view\_index(0);}
\DoxyCodeLine{15439\ \ \ glBindTexture(GL\_TEXTURE\_2D,\ index);}
\DoxyCodeLine{15440\ }
\DoxyCodeLine{15441\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{15442\ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{15443\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glBindTexture(GL\_TEXTURE\_2D,\ "{}}\ <<\ index\ <<\ \textcolor{stringliteral}{"{}):\ "{}}\ <<\ *tex\ <<\ \textcolor{stringliteral}{"{}\ simple\(\backslash\)n"{}};}
\DoxyCodeLine{15444\ \ \ \}}
\DoxyCodeLine{15445\ }
\DoxyCodeLine{15446\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{15447\ \ \ GLenum\ internal\_format\ =\ GL\_BGRA;}
\DoxyCodeLine{15448\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{15449\ \ \ GLenum\ internal\_format\ =\ GL\_RGBA;}
\DoxyCodeLine{15450\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15451\ \ \ GLenum\ external\_format\ =\ GL\_BGRA;}
\DoxyCodeLine{15452\ }
\DoxyCodeLine{15453\ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image\ =\ tex-\/>get\_simple\_ram\_image();}
\DoxyCodeLine{15454\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *image\_ptr\ =\ image.p();}
\DoxyCodeLine{15455\ \ \ \textcolor{keywordflow}{if}\ (image\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{15456\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15457\ \ \ \}}
\DoxyCodeLine{15458\ }
\DoxyCodeLine{15459\ \ \ \textcolor{keywordtype}{size\_t}\ image\_size\ =\ tex-\/>get\_simple\_ram\_image\_size();}
\DoxyCodeLine{15460\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ bgr\_image;}
\DoxyCodeLine{15461\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_bgr)\ \{}
\DoxyCodeLine{15462\ \ \ \ \ \textcolor{comment}{//\ If\ the\ GL\ doesn't\ claim\ to\ support\ BGR,\ we\ may\ have\ to\ reverse\ the}}
\DoxyCodeLine{15463\ \ \ \ \ \textcolor{comment}{//\ component\ ordering\ of\ the\ image.}}
\DoxyCodeLine{15464\ \ \ \ \ external\_format\ =\ GL\_RGBA;}
\DoxyCodeLine{15465\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{15466\ \ \ \ \ internal\_format\ =\ GL\_RGBA;}
\DoxyCodeLine{15467\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15468\ \ \ \ \ image\_ptr\ =\ fix\_component\_ordering(bgr\_image,\ image\_ptr,\ image\_size,}
\DoxyCodeLine{15469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ tex);}
\DoxyCodeLine{15470\ \ \ \}}
\DoxyCodeLine{15471\ }
\DoxyCodeLine{15472\ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_simple\_x\_size();}
\DoxyCodeLine{15473\ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_simple\_y\_size();}
\DoxyCodeLine{15474\ \ \ GLenum\ component\_type\ =\ GL\_UNSIGNED\_BYTE;}
\DoxyCodeLine{15475\ }
\DoxyCodeLine{15476\ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{15477\ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{15478\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}loading\ simple\ image\ for\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15479\ \ \ \}}
\DoxyCodeLine{15480\ }
\DoxyCodeLine{15481\ \ \ \textcolor{comment}{//\ Turn\ off\ mipmaps\ for\ the\ simple\ texture.}}
\DoxyCodeLine{15482\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_texture\_max\_level)\ \{}
\DoxyCodeLine{15483\ \ \ \ \ glTexParameteri(GL\_TEXTURE\_2D,\ GL\_TEXTURE\_MAX\_LEVEL,\ 0);}
\DoxyCodeLine{15484\ \ \ \}}
\DoxyCodeLine{15485\ }
\DoxyCodeLine{15486\ \textcolor{preprocessor}{\#ifdef\ DO\_PSTATS}}
\DoxyCodeLine{15487\ \ \ \_data\_transferred\_pcollector.add\_level(image\_size);}
\DoxyCodeLine{15488\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15489\ }
\DoxyCodeLine{15490\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{15491\ \ \ internal\_format\ =\ external\_format;}
\DoxyCodeLine{15492\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15493\ \ \ glTexImage2D(GL\_TEXTURE\_2D,\ 0,\ internal\_format,}
\DoxyCodeLine{15494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ width,\ height,\ 0,}
\DoxyCodeLine{15495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ external\_format,\ component\_type,\ image\_ptr);}
\DoxyCodeLine{15496\ }
\DoxyCodeLine{15497\ \ \ gtc-\/>\_has\_storage\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{15498\ \ \ gtc-\/>\_immutable\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15499\ \ \ gtc-\/>\_internal\_format\ =\ internal\_format;}
\DoxyCodeLine{15500\ \ \ gtc-\/>\_width\ =\ width;}
\DoxyCodeLine{15501\ \ \ gtc-\/>\_height\ =\ height;}
\DoxyCodeLine{15502\ \ \ gtc-\/>\_depth\ =\ 1;}
\DoxyCodeLine{15503\ \ \ gtc-\/>\_num\_levels\ =\ 1;}
\DoxyCodeLine{15504\ \ \ gtc-\/>\_may\_reload\_with\_mipmaps\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{15505\ \ \ gtc-\/>update\_data\_size\_bytes(width\ *\ height\ *\ 4);}
\DoxyCodeLine{15506\ }
\DoxyCodeLine{15507\ \ \ gtc-\/>mark\_loaded();}
\DoxyCodeLine{15508\ }
\DoxyCodeLine{15509\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15510\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{15511\ \}}
\DoxyCodeLine{15512\ }
\DoxyCodeLine{15517\ \textcolor{keywordtype}{size\_t}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15518\ get\_texture\_memory\_size(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc)\ \{}
\DoxyCodeLine{15519\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{15520\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\ \ }\textcolor{comment}{//\ Texture\ querying\ not\ supported\ on\ OpenGL\ ES.}}
\DoxyCodeLine{15521\ \ \ \textcolor{keywordtype}{int}\ width\ =\ tex-\/>get\_x\_size();}
\DoxyCodeLine{15522\ \ \ \textcolor{keywordtype}{int}\ height\ =\ tex-\/>get\_y\_size();}
\DoxyCodeLine{15523\ \ \ \textcolor{keywordtype}{int}\ depth\ =\ 1;}
\DoxyCodeLine{15524\ \ \ \textcolor{keywordtype}{int}\ scale\ =\ 1;}
\DoxyCodeLine{15525\ }
\DoxyCodeLine{15526\ \ \ \textcolor{keywordtype}{size\_t}\ num\_bytes\ =\ 2;\ \ \textcolor{comment}{//\ Temporary\ assumption?}}
\DoxyCodeLine{15527\ }
\DoxyCodeLine{15528\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{15529\ \ \ GLenum\ target\ =\ get\_texture\_target(tex-\/>get\_texture\_type());}
\DoxyCodeLine{15530\ }
\DoxyCodeLine{15531\ \ \ GLenum\ page\_target\ =\ target;}
\DoxyCodeLine{15532\ \ \ GLint\ scale\ =\ 1;}
\DoxyCodeLine{15533\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_CUBE\_MAP)\ \{}
\DoxyCodeLine{15534\ \ \ \ \ \textcolor{comment}{//\ We\ need\ a\ particular\ page\ to\ get\ the\ level\ parameter\ from.}}
\DoxyCodeLine{15535\ \ \ \ \ page\_target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X;}
\DoxyCodeLine{15536\ \ \ \ \ scale\ =\ 6;}
\DoxyCodeLine{15537\ }
\DoxyCodeLine{15538\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{15539\ \ \ \ \ \textcolor{comment}{//\ In\ the\ case\ of\ buffer\ textures,\ we\ provided\ the\ size\ to\ begin\ with,\ so}}
\DoxyCodeLine{15540\ \ \ \ \ \textcolor{comment}{//\ no\ point\ in\ querying\ anything.\ \ Plus,\ glGetTexParameter\ is\ not\ even}}
\DoxyCodeLine{15541\ \ \ \ \ \textcolor{comment}{//\ supported\ for\ buffer\ textures.}}
\DoxyCodeLine{15542\ \ \ \ \ \textcolor{keywordflow}{return}\ tex-\/>get\_expected\_ram\_image\_size();}
\DoxyCodeLine{15543\ \ \ \}}
\DoxyCodeLine{15544\ }
\DoxyCodeLine{15545\ \ \ clear\_my\_gl\_errors();}
\DoxyCodeLine{15546\ }
\DoxyCodeLine{15547\ \ \ GLint\ internal\_format;}
\DoxyCodeLine{15548\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_INTERNAL\_FORMAT,\ \&internal\_format);}
\DoxyCodeLine{15549\ }
\DoxyCodeLine{15550\ \ \ \textcolor{keywordflow}{if}\ (is\_compressed\_format(internal\_format))\ \{}
\DoxyCodeLine{15551\ \ \ \ \ \textcolor{comment}{//\ Try\ to\ get\ the\ compressed\ size.}}
\DoxyCodeLine{15552\ \ \ \ \ GLint\ image\_size;}
\DoxyCodeLine{15553\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15554\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_COMPRESSED\_IMAGE\_SIZE,\ \&image\_size);}
\DoxyCodeLine{15555\ }
\DoxyCodeLine{15556\ \ \ \ \ GLenum\ error\_code\ =\ gl\_get\_error();}
\DoxyCodeLine{15557\ \ \ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{15558\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_debug())\ \{}
\DoxyCodeLine{15559\ \ \ \ \ \ \ \ \ GLCAT.debug()}
\DoxyCodeLine{15560\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Couldn't\ get\ compressed\ size\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{15561\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15562\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15563\ \ \ \ \ \ \ \textcolor{comment}{//\ Fall\ through\ to\ the\ noncompressed\ case.}}
\DoxyCodeLine{15564\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15565\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ image\_size\ *\ scale;}
\DoxyCodeLine{15566\ \ \ \ \ \}}
\DoxyCodeLine{15567\ \ \ \}}
\DoxyCodeLine{15568\ }
\DoxyCodeLine{15569\ \ \ \textcolor{comment}{//\ OK,\ get\ the\ noncompressed\ size.}}
\DoxyCodeLine{15570\ \ \ GLint\ red\_size,\ green\_size,\ blue\_size,\ alpha\_size;}
\DoxyCodeLine{15571\ \ \ GLint\ depth\_size\ =\ 0,\ luminance\_size\ =\ 0,\ intensity\_size\ =\ 0;}
\DoxyCodeLine{15572\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_RED\_SIZE,\ \&red\_size);}
\DoxyCodeLine{15574\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15575\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_GREEN\_SIZE,\ \&green\_size);}
\DoxyCodeLine{15576\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15577\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_BLUE\_SIZE,\ \&blue\_size);}
\DoxyCodeLine{15578\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_ALPHA\_SIZE,\ \&alpha\_size);}
\DoxyCodeLine{15580\ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_luminance\_texture())\ \{}
\DoxyCodeLine{15581\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15582\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_LUMINANCE\_SIZE,\ \&luminance\_size);}
\DoxyCodeLine{15583\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15584\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_INTENSITY\_SIZE,\ \&intensity\_size);}
\DoxyCodeLine{15585\ \ \ \}}
\DoxyCodeLine{15586\ \ \ \textcolor{keywordflow}{if}\ (get\_supports\_depth\_texture())\ \{}
\DoxyCodeLine{15587\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,}
\DoxyCodeLine{15588\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_DEPTH\_SIZE,\ \&depth\_size);}
\DoxyCodeLine{15589\ \ \ \}}
\DoxyCodeLine{15590\ }
\DoxyCodeLine{15591\ \ \ GLint\ width\ =\ 1,\ height\ =\ 1,\ depth\ =\ 1;}
\DoxyCodeLine{15592\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_WIDTH,\ \&width);}
\DoxyCodeLine{15593\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_HEIGHT,\ \&height);}
\DoxyCodeLine{15594\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture\ ||\ \_supports\_2d\_texture\_array)\ \{}
\DoxyCodeLine{15595\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_DEPTH,\ \&depth);}
\DoxyCodeLine{15596\ \ \ \}}
\DoxyCodeLine{15597\ }
\DoxyCodeLine{15598\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15599\ }
\DoxyCodeLine{15600\ \ \ \textcolor{keywordtype}{size\_t}\ num\_bits\ =\ (red\_size\ +\ green\_size\ +\ blue\_size\ +\ alpha\_size\ +\ luminance\_size\ +\ intensity\_size\ +\ depth\_size);}
\DoxyCodeLine{15601\ \ \ \textcolor{keywordtype}{size\_t}\ num\_bytes\ =\ (num\_bits\ +\ 7)\ /\ 8;}
\DoxyCodeLine{15602\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{15603\ }
\DoxyCodeLine{15604\ \ \ \textcolor{keywordtype}{size\_t}\ result\ =\ num\_bytes\ *\ width\ *\ height\ *\ depth\ *\ scale;}
\DoxyCodeLine{15605\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 1;\ n\ <\ gtc-\/>\_num\_levels;\ ++n)\ \{}
\DoxyCodeLine{15606\ \ \ \ \ width\ =\ max(1,\ width\ <<\ 1);}
\DoxyCodeLine{15607\ \ \ \ \ height\ =\ max(1,\ height\ <<\ 1);}
\DoxyCodeLine{15608\ \ \ \ \ depth\ =\ max(1,\ depth\ <<\ 1);}
\DoxyCodeLine{15609\ \ \ \ \ result\ +=\ num\_bytes\ *\ width\ *\ height\ *\ depth\ *\ scale;}
\DoxyCodeLine{15610\ \ \ \}}
\DoxyCodeLine{15611\ }
\DoxyCodeLine{15612\ \ \ \textcolor{keywordflow}{return}\ result\ *\ gtc-\/>\_num\_views;}
\DoxyCodeLine{15613\ \}}
\DoxyCodeLine{15614\ }
\DoxyCodeLine{15619\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15620\ check\_nonresident\_texture(\mbox{\hyperlink{classBufferContextChain}{BufferContextChain}}\ \&chain)\ \{}
\DoxyCodeLine{15621\ \textcolor{preprocessor}{\#if\ defined(SUPPORT\_FIXED\_FUNCTION)\ \&\&\ !defined(OPENGLES)\ \ }\textcolor{comment}{//\ Residency\ queries\ not\ supported\ by\ OpenGL\ ES.}}
\DoxyCodeLine{15622\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(chain.\_lock);}
\DoxyCodeLine{15623\ \ \ \textcolor{keywordtype}{size\_t}\ num\_textures\ =\ chain.get\_count();}
\DoxyCodeLine{15624\ \ \ \textcolor{keywordflow}{if}\ (num\_textures\ ==\ 0)\ \{}
\DoxyCodeLine{15625\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{15626\ \ \ \}}
\DoxyCodeLine{15627\ }
\DoxyCodeLine{15628\ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ **gtc\_list\ =\ (CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ **)alloca(num\_textures\ *\ \textcolor{keyword}{sizeof}(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *));}
\DoxyCodeLine{15629\ \ \ GLuint\ *texture\_list\ =\ (GLuint\ *)alloca(num\_textures\ *\ \textcolor{keyword}{sizeof}(GLuint));}
\DoxyCodeLine{15630\ \ \ \textcolor{keywordtype}{size\_t}\ ti\ =\ 0;}
\DoxyCodeLine{15631\ \ \ \mbox{\hyperlink{classBufferContext}{BufferContext}}\ *node\ =\ chain.get\_first();}
\DoxyCodeLine{15632\ \ \ \textcolor{keywordflow}{while}\ (node\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{15633\ \ \ \ \ \textcolor{comment}{//\ For\ now,\ we\ just\ check\ whether\ the\ first\ view\ is\ resident.}}
\DoxyCodeLine{15634\ \ \ \ \ CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc\ =\ DCAST(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}}),\ node);}
\DoxyCodeLine{15635\ \ \ \ \ gtc\_list[ti]\ =\ gtc;}
\DoxyCodeLine{15636\ \ \ \ \ texture\_list[ti]\ =\ gtc-\/>get\_view\_index(0);}
\DoxyCodeLine{15637\ \ \ \ \ node\ =\ node-\/>get\_next();}
\DoxyCodeLine{15638\ \ \ \ \ ++ti;}
\DoxyCodeLine{15639\ \ \ \}}
\DoxyCodeLine{15640\ \ \ nassertv(ti\ ==\ num\_textures);}
\DoxyCodeLine{15641\ \ \ GLboolean\ *results\ =\ (GLboolean\ *)alloca(num\_textures\ *\ \textcolor{keyword}{sizeof}(GLboolean));}
\DoxyCodeLine{15642\ \ \ \textcolor{keywordtype}{bool}\ all\_resident\ =\ (glAreTexturesResident(num\_textures,\ texture\_list,\ results)\ !=\ 0);}
\DoxyCodeLine{15643\ }
\DoxyCodeLine{15644\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15645\ }
\DoxyCodeLine{15646\ \ \ \textcolor{keywordflow}{if}\ (!all\_resident)\ \{}
\DoxyCodeLine{15647\ \ \ \ \ \textcolor{comment}{//\ Some\ are\ now\ nonresident.}}
\DoxyCodeLine{15648\ \ \ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ 0;\ ti\ <\ num\_textures;\ ++ti)\ \{}
\DoxyCodeLine{15649\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!results[ti])\ \{}
\DoxyCodeLine{15650\ \ \ \ \ \ \ \ \ gtc\_list[ti]-\/>set\_resident(\textcolor{keyword}{false});}
\DoxyCodeLine{15651\ \ \ \ \ \ \ \}}
\DoxyCodeLine{15652\ \ \ \ \ \}}
\DoxyCodeLine{15653\ \ \ \}}
\DoxyCodeLine{15654\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{15655\ \}}
\DoxyCodeLine{15656\ }
\DoxyCodeLine{15663\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{15664\ do\_extract\_texture\_data(CLP(\mbox{\hyperlink{classTextureContext}{TextureContext}})\ *gtc,\ int\ view)\ \{}
\DoxyCodeLine{15665\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{15666\ }
\DoxyCodeLine{15667\ \ \ GLenum\ target\ =\ gtc-\/>\_target;}
\DoxyCodeLine{15668\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_NONE)\ \{}
\DoxyCodeLine{15669\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15670\ \ \ \}}
\DoxyCodeLine{15671\ }
\DoxyCodeLine{15672\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15673\ \ \ \textcolor{comment}{//\ Make\ sure\ any\ incoherent\ writes\ to\ the\ texture\ have\ been\ synced.}}
\DoxyCodeLine{15674\ \ \ \textcolor{keywordflow}{if}\ (gtc-\/>needs\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT,\ \textcolor{keyword}{false}))\ \{}
\DoxyCodeLine{15675\ \ \ \ \ issue\_memory\_barrier(GL\_TEXTURE\_UPDATE\_BARRIER\_BIT);}
\DoxyCodeLine{15676\ \ \ \}}
\DoxyCodeLine{15677\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15678\ }
\DoxyCodeLine{15679\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ gtc-\/>get\_texture();}
\DoxyCodeLine{15680\ }
\DoxyCodeLine{15681\ \ \ GLint\ wrap\_u,\ wrap\_v,\ wrap\_w;}
\DoxyCodeLine{15682\ \ \ GLint\ minfilter,\ magfilter;}
\DoxyCodeLine{15683\ }
\DoxyCodeLine{15684\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15685\ \ \ GLfloat\ border\_color[4];}
\DoxyCodeLine{15686\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15687\ }
\DoxyCodeLine{15688\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{15689\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{15690\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{15691\ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{15692\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15693\ \ \ \ \ glGetTexParameteriv(target,\ GL\_TEXTURE\_WRAP\_S,\ \&wrap\_u);}
\DoxyCodeLine{15694\ \ \ \ \ glGetTexParameteriv(target,\ GL\_TEXTURE\_WRAP\_T,\ \&wrap\_v);}
\DoxyCodeLine{15695\ \ \ \ \ wrap\_w\ =\ GL\_REPEAT;}
\DoxyCodeLine{15696\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15697\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture)\ \{}
\DoxyCodeLine{15698\ \ \ \ \ \ \ glGetTexParameteriv(target,\ GL\_TEXTURE\_WRAP\_R,\ \&wrap\_w);}
\DoxyCodeLine{15699\ \ \ \ \ \}}
\DoxyCodeLine{15700\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15701\ \ \ \ \ glGetTexParameteriv(target,\ GL\_TEXTURE\_MIN\_FILTER,\ \&minfilter);}
\DoxyCodeLine{15702\ \ \ \ \ glGetTexParameteriv(target,\ GL\_TEXTURE\_MAG\_FILTER,\ \&magfilter);}
\DoxyCodeLine{15703\ }
\DoxyCodeLine{15704\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15705\ \ \ \ \ glGetTexParameterfv(target,\ GL\_TEXTURE\_BORDER\_COLOR,\ border\_color);}
\DoxyCodeLine{15706\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15707\ \ \ \}}
\DoxyCodeLine{15708\ }
\DoxyCodeLine{15709\ \ \ GLenum\ page\_target\ =\ target;}
\DoxyCodeLine{15710\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_CUBE\_MAP)\ \{}
\DoxyCodeLine{15711\ \ \ \ \ \textcolor{comment}{//\ We\ need\ a\ particular\ page\ to\ get\ the\ level\ parameter\ from.}}
\DoxyCodeLine{15712\ \ \ \ \ page\_target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X;}
\DoxyCodeLine{15713\ \ \ \}}
\DoxyCodeLine{15714\ }
\DoxyCodeLine{15715\ \ \ GLint\ width\ =\ gtc-\/>\_width,\ height\ =\ gtc-\/>\_height,\ depth\ =\ gtc-\/>\_depth;}
\DoxyCodeLine{15716\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15717\ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_WIDTH,\ \&width);}
\DoxyCodeLine{15718\ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_1D)\ \{}
\DoxyCodeLine{15719\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_HEIGHT,\ \&height);}
\DoxyCodeLine{15720\ \ \ \}}
\DoxyCodeLine{15721\ }
\DoxyCodeLine{15722\ \ \ \textcolor{keywordflow}{if}\ (\_supports\_3d\_texture\ \&\&\ target\ ==\ GL\_TEXTURE\_3D)\ \{}
\DoxyCodeLine{15723\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_DEPTH,\ \&depth);}
\DoxyCodeLine{15724\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_2D\_ARRAY\ ||\ target\ ==\ GL\_TEXTURE\_CUBE\_MAP\_ARRAY)\ \{}
\DoxyCodeLine{15725\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_DEPTH,\ \&depth);}
\DoxyCodeLine{15726\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_CUBE\_MAP)\ \{}
\DoxyCodeLine{15727\ \ \ \ \ depth\ =\ 6;}
\DoxyCodeLine{15728\ \ \ \}}
\DoxyCodeLine{15729\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15730\ \ \ clear\_my\_gl\_errors();}
\DoxyCodeLine{15731\ \ \ \textcolor{keywordflow}{if}\ (width\ <=\ 0\ ||\ height\ <=\ 0\ ||\ depth\ <=\ 0)\ \{}
\DoxyCodeLine{15732\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{15733\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}No\ texture\ data\ for\ "{}}\ <<\ tex-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15734\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15735\ \ \ \}}
\DoxyCodeLine{15736\ }
\DoxyCodeLine{15737\ \ \ GLint\ internal\_format\ =\ GL\_RGBA;}
\DoxyCodeLine{15738\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15739\ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{15740\ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ 0,\ GL\_TEXTURE\_INTERNAL\_FORMAT,\ \&internal\_format);}
\DoxyCodeLine{15741\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{15742\ \ \ \ \ \textcolor{comment}{//\ Some\ drivers\ give\ the\ wrong\ result\ for\ the\ above\ call.\ \ No\ problem;\ we}}
\DoxyCodeLine{15743\ \ \ \ \ \textcolor{comment}{//\ already\ know\ the\ internal\ format\ of\ a\ buffer\ texture\ since\ glTexBuffer}}
\DoxyCodeLine{15744\ \ \ \ \ \textcolor{comment}{//\ required\ passing\ the\ exact\ sized\ format.}}
\DoxyCodeLine{15745\ \ \ \ \ internal\_format\ =\ gtc-\/>\_internal\_format;}
\DoxyCodeLine{15746\ \ \ \}}
\DoxyCodeLine{15747\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{15748\ }
\DoxyCodeLine{15749\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ were\ able\ to\ query\ those\ parameters\ properly.}}
\DoxyCodeLine{15750\ \ \ GLenum\ error\_code\ =\ gl\_get\_error();}
\DoxyCodeLine{15751\ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{15752\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{15753\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ query\ texture\ parameters\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{15754\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{15755\ }
\DoxyCodeLine{15756\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{15757\ \ \ \}}
\DoxyCodeLine{15758\ }
\DoxyCodeLine{15759\ \ \ Texture::ComponentType\ type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{15760\ \ \ Texture::Format\ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{15761\ \ \ Texture::CompressionMode\ compression\ =\ Texture::CM\_off;}
\DoxyCodeLine{15762\ }
\DoxyCodeLine{15763\ \ \ \textcolor{keywordflow}{switch}\ (internal\_format)\ \{}
\DoxyCodeLine{15764\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15765\ \ \ \textcolor{keywordflow}{case}\ GL\_COLOR\_INDEX:}
\DoxyCodeLine{15766\ \ \ \ \ format\ =\ Texture::F\_color\_index;}
\DoxyCodeLine{15767\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15768\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15769\ \textcolor{preprocessor}{\#if\ GL\_DEPTH\_COMPONENT\ !=\ GL\_DEPTH\_COMPONENT24}}
\DoxyCodeLine{15770\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT:}
\DoxyCodeLine{15771\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15772\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT16:}
\DoxyCodeLine{15773\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT24:}
\DoxyCodeLine{15774\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT32:}
\DoxyCodeLine{15775\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15776\ \ \ \ \ format\ =\ Texture::F\_depth\_component;}
\DoxyCodeLine{15777\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15778\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15779\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_COMPONENT32F:}
\DoxyCodeLine{15780\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15781\ \ \ \ \ format\ =\ Texture::F\_depth\_component;}
\DoxyCodeLine{15782\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15783\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15784\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH\_STENCIL:}
\DoxyCodeLine{15785\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH24\_STENCIL8:}
\DoxyCodeLine{15786\ \ \ \ \ type\ =\ Texture::T\_unsigned\_int\_24\_8;}
\DoxyCodeLine{15787\ \ \ \ \ format\ =\ Texture::F\_depth\_stencil;}
\DoxyCodeLine{15788\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15789\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15790\ \ \ \textcolor{keywordflow}{case}\ GL\_DEPTH32F\_STENCIL8:}
\DoxyCodeLine{15791\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15792\ \ \ \ \ format\ =\ Texture::F\_depth\_stencil;}
\DoxyCodeLine{15793\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15794\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15795\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA:}
\DoxyCodeLine{15796\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{15797\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{15798\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15799\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA4:}
\DoxyCodeLine{15800\ \ \ \ \ format\ =\ Texture::F\_rgba4;}
\DoxyCodeLine{15801\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15802\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{15803\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA8\_OES:}
\DoxyCodeLine{15804\ \ \ \ \ format\ =\ Texture::F\_rgba8;}
\DoxyCodeLine{15805\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15806\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{15807\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA8:}
\DoxyCodeLine{15808\ \ \ \ \ format\ =\ Texture::F\_rgba8;}
\DoxyCodeLine{15809\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15810\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15811\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15812\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA12:}
\DoxyCodeLine{15813\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15814\ \ \ \ \ format\ =\ Texture::F\_rgba12;}
\DoxyCodeLine{15815\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15816\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15817\ }
\DoxyCodeLine{15818\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB:}
\DoxyCodeLine{15819\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{15820\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{15821\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15822\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15823\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB5:}
\DoxyCodeLine{15824\ \ \ \ \ format\ =\ Texture::F\_rgb5;}
\DoxyCodeLine{15825\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15826\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15827\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB5\_A1:}
\DoxyCodeLine{15828\ \ \ \ \ format\ =\ Texture::F\_rgba5;}
\DoxyCodeLine{15829\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15830\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15831\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB8:}
\DoxyCodeLine{15832\ \ \ \ \ format\ =\ Texture::F\_rgb8;}
\DoxyCodeLine{15833\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15834\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB12:}
\DoxyCodeLine{15835\ \ \ \ \ format\ =\ Texture::F\_rgb12;}
\DoxyCodeLine{15836\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15837\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA16:}
\DoxyCodeLine{15838\ \ \ \ \ format\ =\ Texture::F\_rgba16;}
\DoxyCodeLine{15839\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15840\ \ \ \textcolor{keywordflow}{case}\ GL\_R3\_G3\_B2:}
\DoxyCodeLine{15841\ \ \ \ \ format\ =\ Texture::F\_rgb332;}
\DoxyCodeLine{15842\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15843\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15844\ }
\DoxyCodeLine{15845\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15846\ \ \ \textcolor{keywordflow}{case}\ GL\_R8I:}
\DoxyCodeLine{15847\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{15848\ \ \ \ \ format\ =\ Texture::F\_r8i;}
\DoxyCodeLine{15849\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15850\ \ \ \textcolor{keywordflow}{case}\ GL\_RG8I:}
\DoxyCodeLine{15851\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{15852\ \ \ \ \ format\ =\ Texture::F\_rg8i;}
\DoxyCodeLine{15853\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15854\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB8I:}
\DoxyCodeLine{15855\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{15856\ \ \ \ \ format\ =\ Texture::F\_rgb8i;}
\DoxyCodeLine{15857\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15858\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA8I:}
\DoxyCodeLine{15859\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{15860\ \ \ \ \ format\ =\ Texture::F\_rgba8i;}
\DoxyCodeLine{15861\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15862\ }
\DoxyCodeLine{15863\ \ \ \textcolor{keywordflow}{case}\ GL\_R8UI:}
\DoxyCodeLine{15864\ \ \ \ \ type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{15865\ \ \ \ \ format\ =\ Texture::F\_r8i;}
\DoxyCodeLine{15866\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15867\ \ \ \textcolor{keywordflow}{case}\ GL\_RG8UI:}
\DoxyCodeLine{15868\ \ \ \ \ type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{15869\ \ \ \ \ format\ =\ Texture::F\_rg8i;}
\DoxyCodeLine{15870\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15871\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB8UI:}
\DoxyCodeLine{15872\ \ \ \ \ type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{15873\ \ \ \ \ format\ =\ Texture::F\_rgb8i;}
\DoxyCodeLine{15874\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15875\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA8UI:}
\DoxyCodeLine{15876\ \ \ \ \ type\ =\ Texture::T\_unsigned\_byte;}
\DoxyCodeLine{15877\ \ \ \ \ format\ =\ Texture::F\_rgba8i;}
\DoxyCodeLine{15878\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15879\ }
\DoxyCodeLine{15880\ \ \ \textcolor{keywordflow}{case}\ GL\_R16I:}
\DoxyCodeLine{15881\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{15882\ \ \ \ \ format\ =\ Texture::F\_r16i;}
\DoxyCodeLine{15883\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15884\ \ \ \textcolor{keywordflow}{case}\ GL\_RG16I:}
\DoxyCodeLine{15885\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{15886\ \ \ \ \ format\ =\ Texture::F\_rg16i;}
\DoxyCodeLine{15887\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15888\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB16I:}
\DoxyCodeLine{15889\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{15890\ \ \ \ \ format\ =\ Texture::F\_rgb16i;}
\DoxyCodeLine{15891\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15892\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA16I:}
\DoxyCodeLine{15893\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{15894\ \ \ \ \ format\ =\ Texture::F\_rgba16i;}
\DoxyCodeLine{15895\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15896\ }
\DoxyCodeLine{15897\ \ \ \textcolor{keywordflow}{case}\ GL\_R16UI:}
\DoxyCodeLine{15898\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15899\ \ \ \ \ format\ =\ Texture::F\_r16i;}
\DoxyCodeLine{15900\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15901\ \ \ \textcolor{keywordflow}{case}\ GL\_RG16UI:}
\DoxyCodeLine{15902\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15903\ \ \ \ \ format\ =\ Texture::F\_rg16i;}
\DoxyCodeLine{15904\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15905\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB16UI:}
\DoxyCodeLine{15906\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15907\ \ \ \ \ format\ =\ Texture::F\_rgb16i;}
\DoxyCodeLine{15908\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15909\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA16UI:}
\DoxyCodeLine{15910\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15911\ \ \ \ \ format\ =\ Texture::F\_rgba16i;}
\DoxyCodeLine{15912\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15913\ }
\DoxyCodeLine{15914\ \ \ \textcolor{keywordflow}{case}\ GL\_R32I:}
\DoxyCodeLine{15915\ \ \ \ \ type\ =\ Texture::T\_int;}
\DoxyCodeLine{15916\ \ \ \ \ format\ =\ Texture::F\_r32i;}
\DoxyCodeLine{15917\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15918\ \ \ \textcolor{keywordflow}{case}\ GL\_RG32I:}
\DoxyCodeLine{15919\ \ \ \ \ type\ =\ Texture::T\_int;}
\DoxyCodeLine{15920\ \ \ \ \ format\ =\ Texture::F\_rg32i;}
\DoxyCodeLine{15921\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15922\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB32I:}
\DoxyCodeLine{15923\ \ \ \ \ type\ =\ Texture::T\_int;}
\DoxyCodeLine{15924\ \ \ \ \ format\ =\ Texture::F\_rgb32i;}
\DoxyCodeLine{15925\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15926\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA32I:}
\DoxyCodeLine{15927\ \ \ \ \ type\ =\ Texture::T\_int;}
\DoxyCodeLine{15928\ \ \ \ \ format\ =\ Texture::F\_rgba32i;}
\DoxyCodeLine{15929\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15930\ }
\DoxyCodeLine{15931\ \ \ \textcolor{keywordflow}{case}\ GL\_R32UI:}
\DoxyCodeLine{15932\ \ \ \ \ type\ =\ Texture::T\_unsigned\_int;}
\DoxyCodeLine{15933\ \ \ \ \ format\ =\ Texture::F\_r32i;}
\DoxyCodeLine{15934\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15935\ \ \ \textcolor{keywordflow}{case}\ GL\_RG32UI:}
\DoxyCodeLine{15936\ \ \ \ \ type\ =\ Texture::T\_unsigned\_int;}
\DoxyCodeLine{15937\ \ \ \ \ format\ =\ Texture::F\_rg32i;}
\DoxyCodeLine{15938\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15939\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB32UI:}
\DoxyCodeLine{15940\ \ \ \ \ type\ =\ Texture::T\_unsigned\_int;}
\DoxyCodeLine{15941\ \ \ \ \ format\ =\ Texture::F\_rgb32i;}
\DoxyCodeLine{15942\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15943\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA32UI:}
\DoxyCodeLine{15944\ \ \ \ \ type\ =\ Texture::T\_unsigned\_int;}
\DoxyCodeLine{15945\ \ \ \ \ format\ =\ Texture::F\_rgba32i;}
\DoxyCodeLine{15946\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15947\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15948\ }
\DoxyCodeLine{15949\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{15950\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA16F:}
\DoxyCodeLine{15951\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15952\ \ \ \ \ format\ =\ Texture::F\_rgba16;}
\DoxyCodeLine{15953\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15954\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB16F:}
\DoxyCodeLine{15955\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15956\ \ \ \ \ format\ =\ Texture::F\_rgb16;}
\DoxyCodeLine{15957\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15958\ \ \ \textcolor{keywordflow}{case}\ GL\_RG16F:}
\DoxyCodeLine{15959\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15960\ \ \ \ \ format\ =\ Texture::F\_rg16;}
\DoxyCodeLine{15961\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15962\ \ \ \textcolor{keywordflow}{case}\ GL\_R16F:}
\DoxyCodeLine{15963\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15964\ \ \ \ \ format\ =\ Texture::F\_r16;}
\DoxyCodeLine{15965\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15966\ \ \ \textcolor{keywordflow}{case}\ GL\_RGBA32F:}
\DoxyCodeLine{15967\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15968\ \ \ \ \ format\ =\ Texture::F\_rgba32;}
\DoxyCodeLine{15969\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15970\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB32F:}
\DoxyCodeLine{15971\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15972\ \ \ \ \ format\ =\ Texture::F\_rgb32;}
\DoxyCodeLine{15973\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15974\ \ \ \textcolor{keywordflow}{case}\ GL\_RG32F:}
\DoxyCodeLine{15975\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15976\ \ \ \ \ format\ =\ Texture::F\_rg32;}
\DoxyCodeLine{15977\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15978\ \ \ \textcolor{keywordflow}{case}\ GL\_R32F:}
\DoxyCodeLine{15979\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{15980\ \ \ \ \ format\ =\ Texture::F\_r32;}
\DoxyCodeLine{15981\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15982\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{15983\ }
\DoxyCodeLine{15984\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{15985\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB16:}
\DoxyCodeLine{15986\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15987\ \ \ \ \ format\ =\ Texture::F\_rgb16;}
\DoxyCodeLine{15988\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15989\ \ \ \textcolor{keywordflow}{case}\ GL\_RG16:}
\DoxyCodeLine{15990\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15991\ \ \ \ \ format\ =\ Texture::F\_rg16;}
\DoxyCodeLine{15992\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15993\ \ \ \textcolor{keywordflow}{case}\ GL\_R16:}
\DoxyCodeLine{15994\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{15995\ \ \ \ \ format\ =\ Texture::F\_r16;}
\DoxyCodeLine{15996\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{15997\ }
\DoxyCodeLine{15998\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB16\_SNORM:}
\DoxyCodeLine{15999\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{16000\ \ \ \ \ format\ =\ Texture::F\_rgb16;}
\DoxyCodeLine{16001\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16002\ \ \ \textcolor{keywordflow}{case}\ GL\_RG16\_SNORM:}
\DoxyCodeLine{16003\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{16004\ \ \ \ \ format\ =\ Texture::F\_rg16;}
\DoxyCodeLine{16005\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16006\ \ \ \textcolor{keywordflow}{case}\ GL\_R16\_SNORM:}
\DoxyCodeLine{16007\ \ \ \ \ type\ =\ Texture::T\_short;}
\DoxyCodeLine{16008\ \ \ \ \ format\ =\ Texture::F\_r16;}
\DoxyCodeLine{16009\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16010\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16011\ }
\DoxyCodeLine{16012\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{16013\ \ \ \textcolor{keywordflow}{case}\ GL\_R11F\_G11F\_B10F:}
\DoxyCodeLine{16014\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{16015\ \ \ \ \ format\ =\ Texture::F\_r11\_g11\_b10;}
\DoxyCodeLine{16016\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16017\ }
\DoxyCodeLine{16018\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB9\_E5:}
\DoxyCodeLine{16019\ \ \ \ \ type\ =\ Texture::T\_float;}
\DoxyCodeLine{16020\ \ \ \ \ format\ =\ Texture::F\_rgb9\_e5;}
\DoxyCodeLine{16021\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16022\ }
\DoxyCodeLine{16023\ \ \ \textcolor{keywordflow}{case}\ GL\_RGB10\_A2:}
\DoxyCodeLine{16024\ \ \ \ \ type\ =\ Texture::T\_unsigned\_short;}
\DoxyCodeLine{16025\ \ \ \ \ format\ =\ Texture::F\_rgb10\_a2;}
\DoxyCodeLine{16026\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16027\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16028\ }
\DoxyCodeLine{16029\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_2}}
\DoxyCodeLine{16030\ \ \ \textcolor{keywordflow}{case}\ GL\_RED\_EXT:}
\DoxyCodeLine{16031\ \ \ \textcolor{keywordflow}{case}\ GL\_R8\_EXT:}
\DoxyCodeLine{16032\ \ \ \ \ format\ =\ Texture::F\_red;}
\DoxyCodeLine{16033\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16034\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16035\ }
\DoxyCodeLine{16036\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16037\ \ \ \textcolor{keywordflow}{case}\ GL\_RED:}
\DoxyCodeLine{16038\ \ \ \ \ format\ =\ Texture::F\_red;}
\DoxyCodeLine{16039\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16040\ \ \ \textcolor{keywordflow}{case}\ GL\_GREEN:}
\DoxyCodeLine{16041\ \ \ \ \ format\ =\ Texture::F\_green;}
\DoxyCodeLine{16042\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16043\ \ \ \textcolor{keywordflow}{case}\ GL\_BLUE:}
\DoxyCodeLine{16044\ \ \ \ \ format\ =\ Texture::F\_blue;}
\DoxyCodeLine{16045\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16046\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16047\ \ \ \textcolor{keywordflow}{case}\ GL\_ALPHA:}
\DoxyCodeLine{16048\ \ \ \ \ format\ =\ Texture::F\_alpha;}
\DoxyCodeLine{16049\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16050\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE:}
\DoxyCodeLine{16051\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16052\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE8\_EXT:}
\DoxyCodeLine{16053\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE16:}
\DoxyCodeLine{16054\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE16F\_ARB:}
\DoxyCodeLine{16055\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16056\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{16057\ \ \ \ \ format\ =\ Texture::F\_luminance;}
\DoxyCodeLine{16058\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16059\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{16060\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16061\ \ \ \textcolor{keywordflow}{case}\ GL\_LUMINANCE\_ALPHA16F\_ARB:}
\DoxyCodeLine{16062\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16063\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{16064\ \ \ \ \ format\ =\ Texture::F\_luminance\_alpha;}
\DoxyCodeLine{16065\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16066\ }
\DoxyCodeLine{16067\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{16068\ \ \ \textcolor{keywordflow}{case}\ GL\_SRGB:}
\DoxyCodeLine{16069\ \ \ \textcolor{keywordflow}{case}\ GL\_SRGB8:}
\DoxyCodeLine{16070\ \ \ \ \ format\ =\ Texture::F\_srgb;}
\DoxyCodeLine{16071\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16072\ \ \ \textcolor{keywordflow}{case}\ GL\_SRGB\_ALPHA:}
\DoxyCodeLine{16073\ \ \ \textcolor{keywordflow}{case}\ GL\_SRGB8\_ALPHA8:}
\DoxyCodeLine{16074\ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{16075\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16076\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES\_1}}
\DoxyCodeLine{16077\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16078\ \ \ \textcolor{keywordflow}{case}\ GL\_SLUMINANCE:}
\DoxyCodeLine{16079\ \ \ \textcolor{keywordflow}{case}\ GL\_SLUMINANCE8:}
\DoxyCodeLine{16080\ \ \ \ \ format\ =\ Texture::F\_sluminance;}
\DoxyCodeLine{16081\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16082\ \ \ \textcolor{keywordflow}{case}\ GL\_SLUMINANCE\_ALPHA:}
\DoxyCodeLine{16083\ \ \ \textcolor{keywordflow}{case}\ GL\_SLUMINANCE8\_ALPHA8:}
\DoxyCodeLine{16084\ \ \ \ \ format\ =\ Texture::F\_sluminance\_alpha;}
\DoxyCodeLine{16085\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16086\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16087\ }
\DoxyCodeLine{16088\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16089\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB:}
\DoxyCodeLine{16090\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{16091\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16092\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16093\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA:}
\DoxyCodeLine{16094\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16095\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16096\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16097\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_ALPHA:}
\DoxyCodeLine{16098\ \ \ \ \ format\ =\ Texture::F\_alpha;}
\DoxyCodeLine{16099\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16100\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16101\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE:}
\DoxyCodeLine{16102\ \ \ \ \ format\ =\ Texture::F\_luminance;}
\DoxyCodeLine{16103\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16104\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16105\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA:}
\DoxyCodeLine{16106\ \ \ \ \ format\ =\ Texture::F\_luminance\_alpha;}
\DoxyCodeLine{16107\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16108\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16109\ }
\DoxyCodeLine{16110\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB:}
\DoxyCodeLine{16111\ \ \ \ \ format\ =\ Texture::F\_srgb;}
\DoxyCodeLine{16112\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16113\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16114\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_ALPHA:}
\DoxyCodeLine{16115\ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{16116\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16117\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16118\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SLUMINANCE:}
\DoxyCodeLine{16119\ \ \ \ \ format\ =\ Texture::F\_sluminance;}
\DoxyCodeLine{16120\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16121\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16122\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SLUMINANCE\_ALPHA:}
\DoxyCodeLine{16123\ \ \ \ \ format\ =\ Texture::F\_sluminance\_alpha;}
\DoxyCodeLine{16124\ \ \ \ \ compression\ =\ Texture::CM\_on;}
\DoxyCodeLine{16125\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16126\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16127\ }
\DoxyCodeLine{16128\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{16129\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{16130\ \ \ \ \ compression\ =\ Texture::CM\_dxt1;}
\DoxyCodeLine{16131\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16132\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{16133\ \ \ \ \ format\ =\ Texture::F\_rgbm;}
\DoxyCodeLine{16134\ \ \ \ \ compression\ =\ Texture::CM\_dxt1;}
\DoxyCodeLine{16135\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16136\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16137\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{16138\ \ \ \ \ format\ =\ Texture::F\_srgb;}
\DoxyCodeLine{16139\ \ \ \ \ compression\ =\ Texture::CM\_dxt1;}
\DoxyCodeLine{16140\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16141\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT1\_EXT:}
\DoxyCodeLine{16142\ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{16143\ \ \ \ \ compression\ =\ Texture::CM\_dxt1;}
\DoxyCodeLine{16144\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16145\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16146\ }
\DoxyCodeLine{16147\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{16148\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{16149\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{16150\ \ \ \ \ compression\ =\ Texture::CM\_pvr1\_2bpp;}
\DoxyCodeLine{16151\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16152\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_2BPPV1\_IMG:}
\DoxyCodeLine{16153\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16154\ \ \ \ \ compression\ =\ Texture::CM\_pvr1\_2bpp;}
\DoxyCodeLine{16155\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16156\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{16157\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{16158\ \ \ \ \ compression\ =\ Texture::CM\_pvr1\_4bpp;}
\DoxyCodeLine{16159\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16160\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_PVRTC\_4BPPV1\_IMG:}
\DoxyCodeLine{16161\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16162\ \ \ \ \ compression\ =\ Texture::CM\_pvr1\_4bpp;}
\DoxyCodeLine{16163\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16164\ }
\DoxyCodeLine{16165\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16166\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT3\_EXT:}
\DoxyCodeLine{16167\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16168\ \ \ \ \ compression\ =\ Texture::CM\_dxt3;}
\DoxyCodeLine{16169\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16170\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_S3TC\_DXT5\_EXT:}
\DoxyCodeLine{16171\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16172\ \ \ \ \ compression\ =\ Texture::CM\_dxt5;}
\DoxyCodeLine{16173\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16174\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT3\_EXT:}
\DoxyCodeLine{16175\ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{16176\ \ \ \ \ compression\ =\ Texture::CM\_dxt3;}
\DoxyCodeLine{16177\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16178\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SRGB\_ALPHA\_S3TC\_DXT5\_EXT:}
\DoxyCodeLine{16179\ \ \ \ \ format\ =\ Texture::F\_srgb\_alpha;}
\DoxyCodeLine{16180\ \ \ \ \ compression\ =\ Texture::CM\_dxt5;}
\DoxyCodeLine{16181\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16182\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGB\_FXT1\_3DFX:}
\DoxyCodeLine{16183\ \ \ \ \ format\ =\ Texture::F\_rgb;}
\DoxyCodeLine{16184\ \ \ \ \ compression\ =\ Texture::CM\_fxt1;}
\DoxyCodeLine{16185\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16186\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RGBA\_FXT1\_3DFX:}
\DoxyCodeLine{16187\ \ \ \ \ format\ =\ Texture::F\_rgba;}
\DoxyCodeLine{16188\ \ \ \ \ compression\ =\ Texture::CM\_fxt1;}
\DoxyCodeLine{16189\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16190\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_LATC1\_EXT:}
\DoxyCodeLine{16191\ \ \ \ \ format\ =\ Texture::F\_luminance;}
\DoxyCodeLine{16192\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16193\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16194\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_LUMINANCE\_ALPHA\_LATC2\_EXT:}
\DoxyCodeLine{16195\ \ \ \ \ format\ =\ Texture::F\_luminance\_alpha;}
\DoxyCodeLine{16196\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16197\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16198\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RED\_RGTC1:}
\DoxyCodeLine{16199\ \ \ \ \ format\ =\ Texture::F\_red;}
\DoxyCodeLine{16200\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16201\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16202\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_RED\_RGTC1:}
\DoxyCodeLine{16203\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{16204\ \ \ \ \ format\ =\ Texture::F\_red;}
\DoxyCodeLine{16205\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16206\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16207\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_RG\_RGTC2:}
\DoxyCodeLine{16208\ \ \ \ \ format\ =\ Texture::F\_rg;}
\DoxyCodeLine{16209\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16210\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16211\ \ \ \textcolor{keywordflow}{case}\ GL\_COMPRESSED\_SIGNED\_RG\_RGTC2:}
\DoxyCodeLine{16212\ \ \ \ \ type\ =\ Texture::T\_byte;}
\DoxyCodeLine{16213\ \ \ \ \ format\ =\ Texture::F\_rg;}
\DoxyCodeLine{16214\ \ \ \ \ compression\ =\ Texture::CM\_rgtc;}
\DoxyCodeLine{16215\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16216\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16217\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{16218\ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{16219\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unhandled\ internal\ format\ for\ "{}}\ <<\ tex-\/>get\_name()}
\DoxyCodeLine{16220\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ hex\ <<\ \textcolor{stringliteral}{"{}0x"{}}\ <<\ internal\_format\ <<\ dec\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{16221\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16222\ \ \ \}}
\DoxyCodeLine{16223\ }
\DoxyCodeLine{16224\ \ \ \textcolor{comment}{//\ We\ don't\ want\ to\ call\ setup\_texture()\ again;\ that\ resets\ too\ much.}}
\DoxyCodeLine{16225\ \ \ \textcolor{comment}{//\ Instead,\ we'll\ just\ set\ the\ individual\ components.}}
\DoxyCodeLine{16226\ \ \ tex-\/>set\_x\_size(width);}
\DoxyCodeLine{16227\ \ \ tex-\/>set\_y\_size(height);}
\DoxyCodeLine{16228\ \ \ tex-\/>set\_z\_size(depth);}
\DoxyCodeLine{16229\ \ \ tex-\/>set\_component\_type(type);}
\DoxyCodeLine{16230\ \ \ tex-\/>set\_format(format);}
\DoxyCodeLine{16231\ }
\DoxyCodeLine{16232\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{16233\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{true})\ \{}
\DoxyCodeLine{16234\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16235\ \ \ \textcolor{keywordflow}{if}\ (target\ !=\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{16236\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16237\ \ \ \ \ tex-\/>set\_wrap\_u(get\_panda\_wrap\_mode(wrap\_u));}
\DoxyCodeLine{16238\ \ \ \ \ tex-\/>set\_wrap\_v(get\_panda\_wrap\_mode(wrap\_v));}
\DoxyCodeLine{16239\ \ \ \ \ tex-\/>set\_wrap\_w(get\_panda\_wrap\_mode(wrap\_w));}
\DoxyCodeLine{16240\ \ \ \ \ tex-\/>set\_minfilter(get\_panda\_filter\_type(minfilter));}
\DoxyCodeLine{16241\ \ \ \ \ \textcolor{comment}{//tex-\/>set\_magfilter(get\_panda\_filter\_type(magfilter));}}
\DoxyCodeLine{16242\ }
\DoxyCodeLine{16243\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16244\ \ \ \ \ tex-\/>set\_border\_color(LColor(border\_color[0],\ border\_color[1],}
\DoxyCodeLine{16245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ border\_color[2],\ border\_color[3]));}
\DoxyCodeLine{16246\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16247\ \ \ \}}
\DoxyCodeLine{16248\ }
\DoxyCodeLine{16249\ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ image;}
\DoxyCodeLine{16250\ \ \ \textcolor{keywordtype}{size\_t}\ page\_size\ =\ 0;}
\DoxyCodeLine{16251\ }
\DoxyCodeLine{16252\ \ \ \textcolor{keywordflow}{if}\ (!extract\_texture\_image(image,\ page\_size,\ tex,\ target,\ page\_target,}
\DoxyCodeLine{16253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type,\ compression,\ 0))\ \{}
\DoxyCodeLine{16254\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16255\ \ \ \}}
\DoxyCodeLine{16256\ }
\DoxyCodeLine{16257\ \ \ \textcolor{keywordtype}{int}\ num\_views\ =\ tex-\/>get\_num\_views();}
\DoxyCodeLine{16258\ \ \ \textcolor{keywordflow}{if}\ (num\_views\ ==\ 1)\ \{}
\DoxyCodeLine{16259\ \ \ \ \ \textcolor{comment}{//\ Replace\ the\ entire\ image,\ since\ we\ are\ modifying\ the\ only\ view.}}
\DoxyCodeLine{16260\ \ \ \ \ tex-\/>set\_ram\_image(image,\ compression,\ page\_size);}
\DoxyCodeLine{16261\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16262\ \ \ \ \ \textcolor{comment}{//\ We're\ only\ modifying\ a\ single\ view,\ so\ we\ can't\ stomp\ all\ over\ the}}
\DoxyCodeLine{16263\ \ \ \ \ \textcolor{comment}{//\ existing\ content.}}
\DoxyCodeLine{16264\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ ram\_image\ =\ tex-\/>modify\_ram\_image();}
\DoxyCodeLine{16265\ \ \ \ \ nassertr(ram\_image.size()\ ==\ image.size()\ *\ num\_views,\ \textcolor{keyword}{false});}
\DoxyCodeLine{16266\ \ \ \ \ memcpy(ram\_image.p()\ +\ image.size()\ *\ view,\ image.p(),\ image.size());}
\DoxyCodeLine{16267\ \ \ \}}
\DoxyCodeLine{16268\ }
\DoxyCodeLine{16269\ \ \ \textcolor{comment}{//\ Also\ get\ the\ mipmap\ levels.}}
\DoxyCodeLine{16270\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ n\ =\ 1;\ n\ <\ gtc-\/>\_num\_levels;\ ++n)\ \{}
\DoxyCodeLine{16271\ \ \ \ \ \textcolor{keywordflow}{if}\ (!extract\_texture\_image(image,\ page\_size,\ tex,\ target,\ page\_target,}
\DoxyCodeLine{16272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type,\ compression,\ n))\ \{}
\DoxyCodeLine{16273\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16274\ \ \ \ \ \}}
\DoxyCodeLine{16275\ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_views\ ==\ 1)\ \{}
\DoxyCodeLine{16276\ \ \ \ \ \ \ tex-\/>set\_ram\_mipmap\_image(n,\ image,\ page\_size);}
\DoxyCodeLine{16277\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16278\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ ram\_mipmap\_image\ =\ tex-\/>modify\_ram\_mipmap\_image(n);}
\DoxyCodeLine{16279\ \ \ \ \ \ \ memcpy(ram\_mipmap\_image.p()\ +\ image.size()\ *\ view,\ image.p(),\ image.size());}
\DoxyCodeLine{16280\ \ \ \ \ \}}
\DoxyCodeLine{16281\ \ \ \}}
\DoxyCodeLine{16282\ }
\DoxyCodeLine{16283\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{16284\ \}}
\DoxyCodeLine{16285\ }
\DoxyCodeLine{16290\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16291\ extract\_texture\_image(\mbox{\hyperlink{classPointerToArray}{PTA\_uchar}}\ \&image,\ size\_t\ \&page\_size,}
\DoxyCodeLine{16292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ GLenum\ target,\ GLenum\ page\_target,}
\DoxyCodeLine{16293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}::ComponentType\ type,}
\DoxyCodeLine{16294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}::CompressionMode\ compression,\ int\ n)\ \{}
\DoxyCodeLine{16295\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\ \ }\textcolor{comment}{//\ Extracting\ texture\ data\ unsupported\ in\ OpenGL\ ES.}}
\DoxyCodeLine{16296\ \ \ nassert\_raise(\textcolor{stringliteral}{"{}OpenGL\ ES\ does\ not\ support\ extracting\ texture\ data"{}});}
\DoxyCodeLine{16297\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16298\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16299\ }
\DoxyCodeLine{16300\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ GL\ driver\ does\ not\ align\ textures,\ otherwise\ we\ get\ corrupt}}
\DoxyCodeLine{16301\ \ \ \textcolor{comment}{//\ memory,\ since\ we\ don't\ take\ alignment\ into\ account.}}
\DoxyCodeLine{16302\ \ \ glPixelStorei(GL\_PACK\_ALIGNMENT,\ 1);}
\DoxyCodeLine{16303\ }
\DoxyCodeLine{16304\ \ \ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_CUBE\_MAP)\ \{}
\DoxyCodeLine{16305\ \ \ \ \ \textcolor{comment}{//\ A\ cube\ map,\ compressed\ or\ uncompressed.\ \ This\ we\ must\ extract\ one\ page}}
\DoxyCodeLine{16306\ \ \ \ \ \textcolor{comment}{//\ at\ a\ time.}}
\DoxyCodeLine{16307\ }
\DoxyCodeLine{16308\ \ \ \ \ \textcolor{comment}{//\ If\ the\ cube\ map\ is\ compressed,\ we\ assume\ that\ all\ the\ compressed\ pages}}
\DoxyCodeLine{16309\ \ \ \ \ \textcolor{comment}{//\ are\ exactly\ the\ same\ size.\ \ OpenGL\ doesn't\ make\ this\ assumption,\ but\ it}}
\DoxyCodeLine{16310\ \ \ \ \ \textcolor{comment}{//\ happens\ to\ be\ true\ for\ all\ currently\ extant\ compression\ schemes,\ and\ it}}
\DoxyCodeLine{16311\ \ \ \ \ \textcolor{comment}{//\ makes\ things\ simpler\ for\ us.\ \ (It\ also\ makes\ things\ much\ simpler\ for}}
\DoxyCodeLine{16312\ \ \ \ \ \textcolor{comment}{//\ the\ graphics\ hardware,\ so\ it's\ likely\ to\ continue\ to\ be\ true\ for\ a}}
\DoxyCodeLine{16313\ \ \ \ \ \textcolor{comment}{//\ while\ at\ least.)}}
\DoxyCodeLine{16314\ }
\DoxyCodeLine{16315\ \ \ \ \ GLenum\ external\_format\ =\ get\_external\_image\_format(tex);}
\DoxyCodeLine{16316\ \ \ \ \ GLenum\ pixel\_type\ =\ get\_component\_type(type);}
\DoxyCodeLine{16317\ \ \ \ \ page\_size\ =\ tex-\/>get\_expected\_ram\_mipmap\_page\_size(n);}
\DoxyCodeLine{16318\ }
\DoxyCodeLine{16319\ \ \ \ \ \textcolor{keywordflow}{if}\ (compression\ !=\ Texture::CM\_off)\ \{}
\DoxyCodeLine{16320\ \ \ \ \ \ \ GLint\ image\_size;}
\DoxyCodeLine{16321\ \ \ \ \ \ \ glGetTexLevelParameteriv(page\_target,\ n,}
\DoxyCodeLine{16322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GL\_TEXTURE\_COMPRESSED\_IMAGE\_SIZE,\ \&image\_size);}
\DoxyCodeLine{16323\ \ \ \ \ \ \ nassertr(image\_size\ <=\ (\textcolor{keywordtype}{int})page\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{16324\ \ \ \ \ \ \ page\_size\ =\ image\_size;}
\DoxyCodeLine{16325\ \ \ \ \ \}}
\DoxyCodeLine{16326\ }
\DoxyCodeLine{16327\ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(page\_size\ *\ 6);}
\DoxyCodeLine{16328\ }
\DoxyCodeLine{16329\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ z\ =\ 0;\ z\ <\ 6;\ ++z)\ \{}
\DoxyCodeLine{16330\ \ \ \ \ \ \ page\_target\ =\ GL\_TEXTURE\_CUBE\_MAP\_POSITIVE\_X\ +\ z;}
\DoxyCodeLine{16331\ }
\DoxyCodeLine{16332\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (compression\ ==\ Texture::CM\_off)\ \{}
\DoxyCodeLine{16333\ \ \ \ \ \ \ \ \ glGetTexImage(page\_target,\ n,\ external\_format,\ pixel\_type,}
\DoxyCodeLine{16334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ image.p()\ +\ z\ *\ page\_size);}
\DoxyCodeLine{16335\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16336\ \ \ \ \ \ \ \ \ \_glGetCompressedTexImage(page\_target,\ 0,\ image.p()\ +\ z\ *\ page\_size);}
\DoxyCodeLine{16337\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16338\ \ \ \ \ \}}
\DoxyCodeLine{16339\ }
\DoxyCodeLine{16340\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{16341\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (target\ ==\ GL\_TEXTURE\_BUFFER)\ \{}
\DoxyCodeLine{16342\ \ \ \ \ \textcolor{comment}{//\ In\ the\ case\ of\ a\ buffer\ texture,\ we\ need\ to\ get\ it\ from\ the\ buffer.}}
\DoxyCodeLine{16343\ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(tex-\/>get\_expected\_ram\_mipmap\_view\_size(n));}
\DoxyCodeLine{16344\ \ \ \ \ \_glGetBufferSubData(target,\ 0,\ image.size(),\ image.p());}
\DoxyCodeLine{16345\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16346\ }
\DoxyCodeLine{16347\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (compression\ ==\ Texture::CM\_off)\ \{}
\DoxyCodeLine{16348\ \ \ \ \ \textcolor{comment}{//\ An\ uncompressed\ 1-\/d,\ 2-\/d,\ or\ 3-\/d\ texture.}}
\DoxyCodeLine{16349\ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(tex-\/>get\_expected\_ram\_mipmap\_view\_size(n));}
\DoxyCodeLine{16350\ \ \ \ \ GLenum\ external\_format\ =\ get\_external\_image\_format(tex);}
\DoxyCodeLine{16351\ \ \ \ \ GLenum\ pixel\_type\ =\ get\_component\_type(type);}
\DoxyCodeLine{16352\ \ \ \ \ glGetTexImage(target,\ n,\ external\_format,\ pixel\_type,\ image.p());}
\DoxyCodeLine{16353\ }
\DoxyCodeLine{16354\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16355\ \ \ \ \ \textcolor{comment}{//\ A\ compressed\ 1-\/d,\ 2-\/d,\ or\ 3-\/d\ texture.}}
\DoxyCodeLine{16356\ \ \ \ \ GLint\ image\_size;}
\DoxyCodeLine{16357\ \ \ \ \ glGetTexLevelParameteriv(target,\ n,\ GL\_TEXTURE\_COMPRESSED\_IMAGE\_SIZE,\ \&image\_size);}
\DoxyCodeLine{16358\ \ \ \ \ page\_size\ =\ image\_size\ /\ tex-\/>get\_z\_size();}
\DoxyCodeLine{16359\ \ \ \ \ image\ =\ PTA\_uchar::empty\_array(image\_size);}
\DoxyCodeLine{16360\ }
\DoxyCodeLine{16361\ \ \ \ \ \textcolor{comment}{//\ Some\ drivers\ (ATI!)\ seem\ to\ try\ to\ overstuff\ more\ bytes\ in\ the\ array}}
\DoxyCodeLine{16362\ \ \ \ \ \textcolor{comment}{//\ than\ they\ asked\ us\ to\ allocate\ (that\ is,\ more\ bytes\ than}}
\DoxyCodeLine{16363\ \ \ \ \ \textcolor{comment}{//\ GL\_TEXTURE\_COMPRESSED\_IMAGE\_SIZE),\ requiring\ us\ to\ overallocate\ and}}
\DoxyCodeLine{16364\ \ \ \ \ \textcolor{comment}{//\ then\ copy\ the\ result\ into\ our\ final\ buffer.\ \ Sheesh.}}
\DoxyCodeLine{16365\ }
\DoxyCodeLine{16366\ \ \ \ \ \textcolor{comment}{//\ We'll\ only\ do\ this\ for\ small\ textures\ (the\ ATI\ bug\ doesn't\ *seem*\ to}}
\DoxyCodeLine{16367\ \ \ \ \ \textcolor{comment}{//\ affect\ large\ textures),\ to\ save\ on\ the\ overhead\ of\ the\ double-\/copy,\ and}}
\DoxyCodeLine{16368\ \ \ \ \ \textcolor{comment}{//\ reduce\ risk\ from\ an\ overly-\/large\ alloca().}}
\DoxyCodeLine{16369\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{16370\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_trouble\_buffer\ =\ 102400;}
\DoxyCodeLine{16371\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16372\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ max\_trouble\_buffer\ =\ 1024;}
\DoxyCodeLine{16373\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16374\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\_size\ <\ max\_trouble\_buffer)\ \{}
\DoxyCodeLine{16375\ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ extra\_space\ =\ 32;}
\DoxyCodeLine{16376\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *buffer\ =\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *)alloca(image\_size\ +\ extra\_space);}
\DoxyCodeLine{16377\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{16378\ \ \ \ \ \ \ \textcolor{comment}{//\ Tag\ the\ buffer\ with\ a\ specific\ byte\ so\ we\ can\ report\ on\ whether\ that}}
\DoxyCodeLine{16379\ \ \ \ \ \ \ \textcolor{comment}{//\ driver\ bug\ is\ still\ active.}}
\DoxyCodeLine{16380\ \ \ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ keep\_token\ =\ 0x00;}
\DoxyCodeLine{16381\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ token\ =\ ++keep\_token;}
\DoxyCodeLine{16382\ \ \ \ \ \ \ memset(buffer\ +\ image\_size,\ token,\ extra\_space);}
\DoxyCodeLine{16383\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16384\ \ \ \ \ \ \ \_glGetCompressedTexImage(target,\ n,\ buffer);}
\DoxyCodeLine{16385\ \ \ \ \ \ \ memcpy(image.p(),\ buffer,\ image\_size);}
\DoxyCodeLine{16386\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{16387\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ extra\_space;}
\DoxyCodeLine{16388\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (count\ >\ 0\ \&\&\ buffer[image\_size\ +\ count\ -\/\ 1]\ ==\ token)\ \{}
\DoxyCodeLine{16389\ \ \ \ \ \ \ \ \ -\/-\/count;}
\DoxyCodeLine{16390\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16391\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ !=\ 0)\ \{}
\DoxyCodeLine{16392\ \ \ \ \ \ \ \ \ GLCAT.warning()}
\DoxyCodeLine{16393\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}GL\ graphics\ driver\ overfilled\ "{}}\ <<\ count}
\DoxyCodeLine{16394\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ bytes\ into\ a\ "{}}\ <<\ image\_size}
\DoxyCodeLine{16395\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}-\/byte\ buffer\ provided\ to\ glGetCompressedTexImage()\(\backslash\)n"{}};}
\DoxyCodeLine{16396\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16397\ }
\DoxyCodeLine{16398\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ had\ better\ not\ equal\ the\ amount\ of\ buffer\ space\ we\ set\ aside.}}
\DoxyCodeLine{16399\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it\ does,\ we\ assume\ the\ driver\ might\ have\ overfilled\ even\ our}}
\DoxyCodeLine{16400\ \ \ \ \ \ \ \textcolor{comment}{//\ provided\ extra\ buffer.}}
\DoxyCodeLine{16401\ \ \ \ \ \ \ nassertr(count\ !=\ extra\_space,\ \textcolor{keyword}{true})}
\DoxyCodeLine{16402\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ NDEBUG}}
\DoxyCodeLine{16403\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16404\ \ \ \ \ \ \ \_glGetCompressedTexImage(target,\ n,\ image.p());}
\DoxyCodeLine{16405\ \ \ \ \ \}}
\DoxyCodeLine{16406\ \ \ \}}
\DoxyCodeLine{16407\ }
\DoxyCodeLine{16408\ \ \ \textcolor{comment}{//\ Now\ see\ if\ we\ were\ successful.}}
\DoxyCodeLine{16409\ \ \ GLenum\ error\_code\ =\ gl\_get\_error();}
\DoxyCodeLine{16410\ \ \ \textcolor{keywordflow}{if}\ (error\_code\ !=\ GL\_NO\_ERROR)\ \{}
\DoxyCodeLine{16411\ \ \ \ \ GLCAT.error()}
\DoxyCodeLine{16412\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ extract\ texture\ for\ "{}}\ <<\ *tex}
\DoxyCodeLine{16413\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ mipmap\ level\ "{}}\ <<\ n}
\DoxyCodeLine{16414\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ :\ "{}}\ <<\ get\_error\_string(error\_code)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{16415\ \ \ \ \ nassertr(\textcolor{keyword}{false},\ \textcolor{keyword}{false});}
\DoxyCodeLine{16416\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16417\ \ \ \}}
\DoxyCodeLine{16418\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{16419\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16420\ \}}
\DoxyCodeLine{16421\ }
\DoxyCodeLine{16426\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_FIXED\_FUNCTION}}
\DoxyCodeLine{16427\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16428\ do\_point\_size()\ \{}
\DoxyCodeLine{16429\ \ \ \textcolor{keywordflow}{if}\ (!\_point\_perspective)\ \{}
\DoxyCodeLine{16430\ \ \ \ \ \textcolor{comment}{//\ Normal,\ constant-\/sized\ points.\ \ Here\ \_point\_size\ is\ a\ width\ in\ pixels.}}
\DoxyCodeLine{16431\ \ \ \ \ \textcolor{keyword}{static}\ LVecBase3f\ constant(1.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{16432\ \ \ \ \ \_glPointParameterfv(GL\_POINT\_DISTANCE\_ATTENUATION,\ constant.get\_data());}
\DoxyCodeLine{16433\ }
\DoxyCodeLine{16434\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16435\ \ \ \ \ \textcolor{comment}{//\ Perspective-\/sized\ points.\ \ Here\ \_point\_size\ is\ a\ width\ in\ 3-\/d\ units.}}
\DoxyCodeLine{16436\ \ \ \ \ \textcolor{comment}{//\ To\ arrange\ that,\ we\ need\ to\ figure\ out\ the\ appropriate\ scaling\ factor}}
\DoxyCodeLine{16437\ \ \ \ \ \textcolor{comment}{//\ based\ on\ the\ current\ viewport\ and\ projection\ matrix.}}
\DoxyCodeLine{16438\ \ \ \ \ LVector3\ height(0.0f,\ \_point\_size,\ 1.0f);}
\DoxyCodeLine{16439\ \ \ \ \ height\ =\ height\ *\ \_projection\_mat-\/>get\_mat();}
\DoxyCodeLine{16440\ \ \ \ \ height\ =\ height\ *\ \_internal\_transform-\/>get\_scale()[1];}
\DoxyCodeLine{16441\ \ \ \ \ PN\_stdfloat\ s\ =\ height[1]\ *\ \_viewport\_height\ /\ \_point\_size;}
\DoxyCodeLine{16442\ }
\DoxyCodeLine{16443\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_current\_lens-\/>is\_orthographic())\ \{}
\DoxyCodeLine{16444\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ an\ orthographic\ lens\ in\ effect,\ we\ don't\ actually\ apply\ a}}
\DoxyCodeLine{16445\ \ \ \ \ \ \ \textcolor{comment}{//\ perspective\ transform:\ we\ just\ scale\ the\ points\ once,\ regardless\ of}}
\DoxyCodeLine{16446\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ distance\ from\ the\ camera.}}
\DoxyCodeLine{16447\ \ \ \ \ \ \ LVecBase3f\ constant(1.0f\ /\ (s\ *\ s),\ 0.0f,\ 0.0f);}
\DoxyCodeLine{16448\ \ \ \ \ \ \ \_glPointParameterfv(GL\_POINT\_DISTANCE\_ATTENUATION,\ constant.get\_data());}
\DoxyCodeLine{16449\ }
\DoxyCodeLine{16450\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16451\ \ \ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ we\ give\ it\ a\ true\ perspective\ adjustment.}}
\DoxyCodeLine{16452\ \ \ \ \ \ \ LVecBase3f\ square(0.0f,\ 0.0f,\ 1.0f\ /\ (s\ *\ s));}
\DoxyCodeLine{16453\ \ \ \ \ \ \ \_glPointParameterfv(GL\_POINT\_DISTANCE\_ATTENUATION,\ square.get\_data());}
\DoxyCodeLine{16454\ \ \ \ \ \}}
\DoxyCodeLine{16455\ \ \ \}}
\DoxyCodeLine{16456\ }
\DoxyCodeLine{16457\ \ \ report\_my\_gl\_errors();}
\DoxyCodeLine{16458\ \}}
\DoxyCodeLine{16459\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16460\ }
\DoxyCodeLine{16465\ \textcolor{keywordtype}{bool}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16466\ get\_supports\_cg\_profile(const\ string\ \&name)\ const\ \{}
\DoxyCodeLine{16467\ \#if\ !defined(HAVE\_CG)\ ||\ defined(OPENGLES)}
\DoxyCodeLine{16468\ \ \ return\ false;}
\DoxyCodeLine{16469\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16470\ \ \ CGprofile\ profile\ =\ cgGetProfile(name.c\_str());}
\DoxyCodeLine{16471\ }
\DoxyCodeLine{16472\ \ \ \textcolor{keywordflow}{if}\ (profile\ ==\ CG\_PROFILE\_UNKNOWN)\ \{}
\DoxyCodeLine{16473\ \ \ \ \ GLCAT.error()\ <<\ name\ <<\ \textcolor{stringliteral}{"{},\ unknown\ Cg-\/profile\(\backslash\)n"{}};}
\DoxyCodeLine{16474\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{16475\ \ \ \}}
\DoxyCodeLine{16476\ \ \ \textcolor{keywordflow}{return}\ (cgGLIsProfileSupported(profile)\ !=\ 0);}
\DoxyCodeLine{16477\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16478\ \}}
\DoxyCodeLine{16479\ }
\DoxyCodeLine{16483\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16484\ bind\_fbo(GLuint\ fbo)\ \{}
\DoxyCodeLine{16485\ \ \ \textcolor{keywordflow}{if}\ (\_current\_fbo\ ==\ fbo)\ \{}
\DoxyCodeLine{16486\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{16487\ \ \ \}}
\DoxyCodeLine{16488\ }
\DoxyCodeLine{16489\ \ \ \mbox{\hyperlink{classPStatGPUTimer}{PStatGPUTimer}}\ timer(\textcolor{keyword}{this},\ \_fbo\_bind\_pcollector);}
\DoxyCodeLine{16490\ }
\DoxyCodeLine{16491\ \ \ nassertv(\_glBindFramebuffer\ !=\ 0);}
\DoxyCodeLine{16492\ \textcolor{preprocessor}{\#if\ defined(OPENGLES\_2)}}
\DoxyCodeLine{16493\ \ \ \_glBindFramebuffer(GL\_FRAMEBUFFER,\ fbo);}
\DoxyCodeLine{16494\ \textcolor{preprocessor}{\#elif\ defined(OPENGLES\_1)}}
\DoxyCodeLine{16495\ \ \ \_glBindFramebuffer(GL\_FRAMEBUFFER\_OES,\ fbo);}
\DoxyCodeLine{16496\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16497\ \ \ \_glBindFramebuffer(GL\_FRAMEBUFFER\_EXT,\ fbo);}
\DoxyCodeLine{16498\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16499\ }
\DoxyCodeLine{16500\ \ \ \_current\_fbo\ =\ fbo;}
\DoxyCodeLine{16501\ \}}
\DoxyCodeLine{16502\ }
\DoxyCodeLine{16503\ \textcolor{comment}{//\ GL\ stencil\ code\ section}}
\DoxyCodeLine{16504\ }
\DoxyCodeLine{16505\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ gl\_stencil\_operations\_array[]\ =\ \{}
\DoxyCodeLine{16506\ \ \ GL\_KEEP,}
\DoxyCodeLine{16507\ \ \ GL\_ZERO,}
\DoxyCodeLine{16508\ \ \ GL\_REPLACE,}
\DoxyCodeLine{16509\ \textcolor{preprocessor}{\#ifdef\ OPENGLES\_1}}
\DoxyCodeLine{16510\ \ \ GL\_INCR\_WRAP\_OES,}
\DoxyCodeLine{16511\ \ \ GL\_DECR\_WRAP\_OES,}
\DoxyCodeLine{16512\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16513\ \ \ GL\_INCR\_WRAP,}
\DoxyCodeLine{16514\ \ \ GL\_DECR\_WRAP,}
\DoxyCodeLine{16515\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16516\ \ \ GL\_INVERT,}
\DoxyCodeLine{16517\ }
\DoxyCodeLine{16518\ \ \ GL\_INCR,}
\DoxyCodeLine{16519\ \ \ GL\_DECR,}
\DoxyCodeLine{16520\ \};}
\DoxyCodeLine{16521\ }
\DoxyCodeLine{16525\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16526\ do\_issue\_stencil()\ \{}
\DoxyCodeLine{16527\ \ \ \textcolor{keywordflow}{if}\ (!\_supports\_stencil)\ \{}
\DoxyCodeLine{16528\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{16529\ \ \ \}}
\DoxyCodeLine{16530\ }
\DoxyCodeLine{16531\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classStencilAttrib}{StencilAttrib}}\ *stencil;}
\DoxyCodeLine{16532\ \ \ \textcolor{keywordflow}{if}\ (\_target\_rs-\/>get\_attrib(stencil))\ \{}
\DoxyCodeLine{16533\ \ \ \ \ \textcolor{comment}{//\ DEBUG}}
\DoxyCodeLine{16534\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keyword}{false})\ \{}
\DoxyCodeLine{16535\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}STENCIL\ STATE\ CHANGE\(\backslash\)n"{}};}
\DoxyCodeLine{16536\ \ \ \ \ \ \ GLCAT.debug()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_front\_comparison\_function\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_comparison\_function)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_front\_stencil\_fail\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_fail\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_front\_stencil\_pass\_z\_fail\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_pass\_z\_fail\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_front\_stencil\_pass\_z\_pass\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_pass\_z\_pass\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_reference\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_reference)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_read\_mask\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_read\_mask)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_write\_mask\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_write\_mask)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16544\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_back\_comparison\_function\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_comparison\_function)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_back\_stencil\_fail\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_fail\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_back\_stencil\_pass\_z\_fail\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_pass\_z\_fail\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{16547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SRS\_back\_stencil\_pass\_z\_pass\_operation\ "{}}\ <<\ (int)stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_pass\_z\_pass\_operation)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{16548\ \ \ \ \ \}}
\DoxyCodeLine{16549\ }
\DoxyCodeLine{16550\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16551\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_two\_sided\_stencil)\ \{}
\DoxyCodeLine{16552\ \ \ \ \ \ \ \textcolor{comment}{//\ TODO:\ add\ support\ for\ OpenGL\ 2.0-\/style\ glStencilFuncSeparate.}}
\DoxyCodeLine{16553\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ back\_compare;}
\DoxyCodeLine{16554\ \ \ \ \ \ \ back\_compare\ =\ stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_comparison\_function);}
\DoxyCodeLine{16555\ }
\DoxyCodeLine{16556\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (back\_compare\ !=\ RenderAttrib::M\_none)\ \{}
\DoxyCodeLine{16557\ \ \ \ \ \ \ \ \ glEnable(GL\_STENCIL\_TEST\_TWO\_SIDE\_EXT);}
\DoxyCodeLine{16558\ \ \ \ \ \ \ \ \ \_glActiveStencilFaceEXT(GL\_BACK);}
\DoxyCodeLine{16559\ }
\DoxyCodeLine{16560\ \ \ \ \ \ \ \ \ glStencilFunc(}
\DoxyCodeLine{16561\ \ \ \ \ \ \ \ \ \ \ PANDA\_TO\_GL\_COMPAREFUNC(back\_compare),}
\DoxyCodeLine{16562\ \ \ \ \ \ \ \ \ \ \ stencil-\/>get\_render\_state(StencilAttrib::SRS\_reference),}
\DoxyCodeLine{16563\ \ \ \ \ \ \ \ \ \ \ stencil-\/>get\_render\_state(StencilAttrib::SRS\_read\_mask));}
\DoxyCodeLine{16564\ }
\DoxyCodeLine{16565\ \ \ \ \ \ \ \ \ glStencilOp(}
\DoxyCodeLine{16566\ \ \ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_fail\_operation)],}
\DoxyCodeLine{16567\ \ \ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_pass\_z\_fail\_operation)],}
\DoxyCodeLine{16568\ \ \ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_back\_stencil\_pass\_z\_pass\_operation)]}
\DoxyCodeLine{16569\ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{16570\ \ \ \ \ \ \ \ \ glStencilMask(stencil-\/>get\_render\_state(StencilAttrib::SRS\_write\_mask));}
\DoxyCodeLine{16571\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16572\ \ \ \ \ \ \ \ \ glDisable(GL\_STENCIL\_TEST\_TWO\_SIDE\_EXT);}
\DoxyCodeLine{16573\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16574\ }
\DoxyCodeLine{16575\ \ \ \ \ \ \ \_glActiveStencilFaceEXT(GL\_FRONT);}
\DoxyCodeLine{16576\ \ \ \ \ \}}
\DoxyCodeLine{16577\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16578\ }
\DoxyCodeLine{16579\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ front\_compare;}
\DoxyCodeLine{16580\ \ \ \ \ front\_compare\ =\ stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_comparison\_function);}
\DoxyCodeLine{16581\ }
\DoxyCodeLine{16582\ \ \ \ \ \textcolor{keywordflow}{if}\ (front\_compare\ !=\ RenderAttrib::M\_none)\ \{}
\DoxyCodeLine{16583\ \ \ \ \ \ \ glEnable(GL\_STENCIL\_TEST);}
\DoxyCodeLine{16584\ }
\DoxyCodeLine{16585\ \ \ \ \ \ \ glStencilFunc(}
\DoxyCodeLine{16586\ \ \ \ \ \ \ \ \ PANDA\_TO\_GL\_COMPAREFUNC(front\_compare),}
\DoxyCodeLine{16587\ \ \ \ \ \ \ \ \ stencil-\/>get\_render\_state(StencilAttrib::SRS\_reference),}
\DoxyCodeLine{16588\ \ \ \ \ \ \ \ \ stencil-\/>get\_render\_state(StencilAttrib::SRS\_read\_mask));}
\DoxyCodeLine{16589\ }
\DoxyCodeLine{16590\ \ \ \ \ \ \ glStencilOp(}
\DoxyCodeLine{16591\ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_fail\_operation)],}
\DoxyCodeLine{16592\ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_pass\_z\_fail\_operation)],}
\DoxyCodeLine{16593\ \ \ \ \ \ \ \ \ \ gl\_stencil\_operations\_array[stencil-\/>get\_render\_state(StencilAttrib::SRS\_front\_stencil\_pass\_z\_pass\_operation)]}
\DoxyCodeLine{16594\ \ \ \ \ \ \ );}
\DoxyCodeLine{16595\ \ \ \ \ \ \ glStencilMask(stencil-\/>get\_render\_state(StencilAttrib::SRS\_write\_mask));}
\DoxyCodeLine{16596\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16597\ \ \ \ \ \ \ glDisable(GL\_STENCIL\_TEST);}
\DoxyCodeLine{16598\ \ \ \ \ \}}
\DoxyCodeLine{16599\ }
\DoxyCodeLine{16600\ \ \ \ \ \textcolor{keywordflow}{if}\ (stencil-\/>get\_render\_state(StencilAttrib::SRS\_clear))\ \{}
\DoxyCodeLine{16601\ \ \ \ \ \ \ \textcolor{comment}{//\ clear\ stencil\ buffer}}
\DoxyCodeLine{16602\ \ \ \ \ \ \ glClearStencil(stencil-\/>get\_render\_state(StencilAttrib::SRS\_clear\_value));}
\DoxyCodeLine{16603\ \ \ \ \ \ \ glClear(GL\_STENCIL\_BUFFER\_BIT);}
\DoxyCodeLine{16604\ \ \ \ \ \}}
\DoxyCodeLine{16605\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16606\ \ \ \ \ glDisable(GL\_STENCIL\_TEST);}
\DoxyCodeLine{16607\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16608\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_two\_sided\_stencil)\ \{}
\DoxyCodeLine{16609\ \ \ \ \ \ \ glDisable(GL\_STENCIL\_TEST\_TWO\_SIDE\_EXT);}
\DoxyCodeLine{16610\ \ \ \ \ \}}
\DoxyCodeLine{16611\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16612\ \ \ \}}
\DoxyCodeLine{16613\ \}}
\DoxyCodeLine{16614\ }
\DoxyCodeLine{16618\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16619\ do\_issue\_scissor()\ \{}
\DoxyCodeLine{16620\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classScissorAttrib}{ScissorAttrib}}\ *target\_scissor;}
\DoxyCodeLine{16621\ \ \ \_target\_rs-\/>get\_attrib\_def(target\_scissor);}
\DoxyCodeLine{16622\ }
\DoxyCodeLine{16623\ \ \ \textcolor{keywordflow}{if}\ (!target\_scissor-\/>is\_off())\ \{}
\DoxyCodeLine{16624\ \ \ \ \ \textcolor{comment}{//\ A\ non-\/off\ ScissorAttrib\ means\ to\ override\ the\ scissor\ setting\ that\ was}}
\DoxyCodeLine{16625\ \ \ \ \ \textcolor{comment}{//\ specified\ by\ the\ DisplayRegion.}}
\DoxyCodeLine{16626\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_scissor\_enabled)\ \{}
\DoxyCodeLine{16627\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{16628\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{16629\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glEnable(GL\_SCISSOR\_TEST)\(\backslash\)n"{}};}
\DoxyCodeLine{16630\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16631\ \ \ \ \ \ \ glEnable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{16632\ \ \ \ \ \ \ \_scissor\_enabled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{16633\ \ \ \ \ \}}
\DoxyCodeLine{16634\ }
\DoxyCodeLine{16635\ \ \ \ \ \textcolor{keyword}{const}\ LVecBase4\ \&frame\ =\ target\_scissor-\/>get\_frame();}
\DoxyCodeLine{16636\ }
\DoxyCodeLine{16637\ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ (int)(\_viewport\_x\ +\ \_viewport\_width\ *\ frame[0]\ +\ 0.5f);}
\DoxyCodeLine{16638\ \ \ \ \ \textcolor{keywordtype}{int}\ y\ =\ (int)(\_viewport\_y\ +\ \_viewport\_height\ *\ frame[2]\ +\ 0.5f);}
\DoxyCodeLine{16639\ \ \ \ \ \textcolor{keywordtype}{int}\ width\ =\ (int)(\_viewport\_width\ *\ (frame[1]\ -\/\ frame[0])\ +\ 0.5f);}
\DoxyCodeLine{16640\ \ \ \ \ \textcolor{keywordtype}{int}\ height\ =\ (int)(\_viewport\_height\ *\ (frame[3]\ -\/\ frame[2])\ +\ 0.5f);}
\DoxyCodeLine{16641\ }
\DoxyCodeLine{16642\ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{16643\ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{16644\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glScissor("{}}\ <<\ x\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ y\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ width\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ height\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{16645\ \ \ \ \ \}}
\DoxyCodeLine{16646\ \ \ \ \ glScissor(x,\ y,\ width,\ height);}
\DoxyCodeLine{16647\ }
\DoxyCodeLine{16648\ \ \ \ \ \_scissor\_attrib\_active\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{16649\ }
\DoxyCodeLine{16650\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_scissor\_attrib\_active)\ \{}
\DoxyCodeLine{16651\ \ \ \ \ \_scissor\_attrib\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{16652\ }
\DoxyCodeLine{16653\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_scissor\_array.size()\ >\ 0)\ \{}
\DoxyCodeLine{16654\ \ \ \ \ \ \ \textcolor{comment}{//\ Scissoring\ is\ enabled\ on\ the\ display\ region.\ \ Revert\ to\ the\ scissor}}
\DoxyCodeLine{16655\ \ \ \ \ \ \ \textcolor{comment}{//\ state\ specified\ in\ the\ DisplayRegion.}}
\DoxyCodeLine{16656\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16657\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_viewport\_arrays)\ \{}
\DoxyCodeLine{16658\ \ \ \ \ \ \ \ \ \_glScissorArrayv(0,\ \_scissor\_array.size(),\ \_scissor\_array[0].get\_data());}
\DoxyCodeLine{16659\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}}
\DoxyCodeLine{16660\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ OPENGLES}}
\DoxyCodeLine{16661\ \ \ \ \ \ \ \{}
\DoxyCodeLine{16662\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LVecBase4i\ sr\ =\ \_scissor\_array[0];}
\DoxyCodeLine{16663\ \ \ \ \ \ \ \ \ glScissor(sr[0],\ sr[1],\ sr[2],\ sr[3]);}
\DoxyCodeLine{16664\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16665\ }
\DoxyCodeLine{16666\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_scissor\_enabled)\ \{}
\DoxyCodeLine{16667\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ display\ region\ had\ no\ scissor\ enabled.\ \ Disable\ scissoring.}}
\DoxyCodeLine{16668\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GLCAT.is\_spam())\ \{}
\DoxyCodeLine{16669\ \ \ \ \ \ \ \ \ GLCAT.spam()}
\DoxyCodeLine{16670\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}glDisable(GL\_SCISSOR\_TEST)\(\backslash\)n"{}};}
\DoxyCodeLine{16671\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16672\ \ \ \ \ \ \ glDisable(GL\_SCISSOR\_TEST);}
\DoxyCodeLine{16673\ \ \ \ \ \ \ \_scissor\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{16674\ \ \ \ \ \}}
\DoxyCodeLine{16675\ \ \ \}}
\DoxyCodeLine{16676\ \}}
\DoxyCodeLine{16677\ }
\DoxyCodeLine{16678\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{16682\ \textcolor{keywordtype}{void}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16683\ map\_read\_buffer(GLenum\ target,\ GLuint\ buffer,\ size\_t\ size)\ \{}
\DoxyCodeLine{16684\ \ \ nassertr(buffer\ !=\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{16685\ }
\DoxyCodeLine{16686\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16687\ \ \ \textcolor{keywordflow}{if}\ (\_glMapNamedBufferRange\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{16688\ \ \ \ \ \textcolor{keywordflow}{return}\ \_glMapNamedBufferRange(buffer,\ 0,\ size,\ GL\_MAP\_READ\_BIT);}
\DoxyCodeLine{16689\ \ \ \}}
\DoxyCodeLine{16690\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16691\ }
\DoxyCodeLine{16692\ \ \ \textcolor{keywordtype}{void}\ *mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{16693\ }
\DoxyCodeLine{16694\ \ \ \_glBindBuffer(target,\ buffer);}
\DoxyCodeLine{16695\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{16696\ \ \ \textcolor{comment}{//\ There\ is\ neither\ glMapBuffer\ nor\ persistent\ mapping\ in\ OpenGL\ ES}}
\DoxyCodeLine{16697\ \ \ mapped\_ptr\ =\ \_glMapBufferRange(target,\ 0,\ size,\ GL\_MAP\_READ\_BIT);}
\DoxyCodeLine{16698\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16699\ \ \ \textcolor{comment}{//\ If\ we\ get\ here\ in\ desktop\ GL,\ we\ must\ not\ have\ persistent\ mapping}}
\DoxyCodeLine{16700\ \ \ mapped\_ptr\ =\ \_glMapBuffer(target,\ GL\_READ\_ONLY);}
\DoxyCodeLine{16701\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16702\ }
\DoxyCodeLine{16703\ \ \ \_glBindBuffer(target,\ 0);}
\DoxyCodeLine{16704\ \ \ \textcolor{keywordflow}{return}\ mapped\_ptr;}
\DoxyCodeLine{16705\ \}}
\DoxyCodeLine{16706\ }
\DoxyCodeLine{16712\ \textcolor{keywordtype}{void}\ *CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16713\ map\_write\_discard\_buffer(GLenum\ target,\ GLuint\ buffer,\ size\_t\ size,}
\DoxyCodeLine{16714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ create\_storage)\ \{}
\DoxyCodeLine{16715\ \ \ nassertr(buffer\ !=\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{16716\ }
\DoxyCodeLine{16717\ \textcolor{preprocessor}{\#ifndef\ OPENGLES}}
\DoxyCodeLine{16718\ \ \ \textcolor{keywordflow}{if}\ (!create\_storage\ \&\&\ \_glMapNamedBufferRange\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{16719\ \ \ \ \ \textcolor{keywordflow}{return}\ \_glMapNamedBufferRange(buffer,\ 0,\ size,\ GL\_MAP\_WRITE\_BIT\ |\ GL\_MAP\_INVALIDATE\_BUFFER\_BIT);}
\DoxyCodeLine{16720\ \ \ \}}
\DoxyCodeLine{16721\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16722\ }
\DoxyCodeLine{16723\ \ \ \_glBindBuffer(target,\ buffer);}
\DoxyCodeLine{16724\ }
\DoxyCodeLine{16725\ \ \ \textcolor{keywordtype}{void}\ *mapped\_ptr;}
\DoxyCodeLine{16726\ \ \ \textcolor{keywordflow}{if}\ (\_glMapBufferRange\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{16727\ \ \ \ \ \textcolor{keywordflow}{if}\ (create\_storage)\ \{}
\DoxyCodeLine{16728\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_supports\_buffer\_storage)\ \{}
\DoxyCodeLine{16729\ \ \ \ \ \ \ \ \ \_glBufferStorage(target,\ size,\ \textcolor{keyword}{nullptr},\ GL\_MAP\_WRITE\_BIT);}
\DoxyCodeLine{16730\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16731\ \ \ \ \ \ \ \ \ \_glBufferData(target,\ size,\ \textcolor{keyword}{nullptr},\ GL\_STATIC\_DRAW);}
\DoxyCodeLine{16732\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16733\ \ \ \ \ \}}
\DoxyCodeLine{16734\ \ \ \ \ mapped\_ptr\ =\ \_glMapBufferRange(target,\ 0,\ size,\ GL\_MAP\_WRITE\_BIT\ |\ GL\_MAP\_INVALIDATE\_BUFFER\_BIT);}
\DoxyCodeLine{16735\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{16736\ \textcolor{preprocessor}{\#ifdef\ OPENGLES}}
\DoxyCodeLine{16737\ \ \ \ \ mapped\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{16738\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{16739\ \ \ \ \ \textcolor{comment}{//\ Explicitly\ orphan\ the\ buffer\ before\ mapping.}}
\DoxyCodeLine{16740\ \ \ \ \ \_glBufferData(target,\ size,\ \textcolor{keyword}{nullptr},\ GL\_STATIC\_DRAW);}
\DoxyCodeLine{16741\ \ \ \ \ mapped\_ptr\ =\ \_glMapBuffer(target,\ GL\_WRITE\_ONLY);}
\DoxyCodeLine{16742\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{16743\ \ \ \}}
\DoxyCodeLine{16744\ }
\DoxyCodeLine{16745\ \ \ \_glBindBuffer(target,\ 0);}
\DoxyCodeLine{16746\ \ \ \textcolor{keywordflow}{return}\ mapped\_ptr;}
\DoxyCodeLine{16747\ \}}
\DoxyCodeLine{16748\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{16749\ }
\DoxyCodeLine{16750\ \textcolor{preprocessor}{\#ifndef\ OPENGLES\_1}}
\DoxyCodeLine{16754\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16755\ insert\_fence(\mbox{\hyperlink{classCompletionToken}{CompletionToken}}\ \&\&callback)\ \{}
\DoxyCodeLine{16756\ \ \ GLsync\ fence\ =\ \_glFenceSync(GL\_SYNC\_GPU\_COMMANDS\_COMPLETE,\ 0);}
\DoxyCodeLine{16757\ \ \ \_fences.push\_back(\{fence,\ std::move(callback)\});}
\DoxyCodeLine{16758\ \}}
\DoxyCodeLine{16759\ }
\DoxyCodeLine{16763\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16764\ process\_fences(bool\ force)\ \{}
\DoxyCodeLine{16765\ \ \ \textcolor{keywordflow}{if}\ (\_fences.empty())\ \{}
\DoxyCodeLine{16766\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{16767\ \ \ \}}
\DoxyCodeLine{16768\ }
\DoxyCodeLine{16769\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_copy\_texture\_finish\_pcollector);}
\DoxyCodeLine{16770\ }
\DoxyCodeLine{16771\ \ \ \textcolor{keywordflow}{if}\ (force)\ \{}
\DoxyCodeLine{16772\ \ \ \ \ \textcolor{comment}{//\ Just\ wait\ for\ the\ last\ fence,\ the\ rest\ must\ be\ complete\ too\ then.}}
\DoxyCodeLine{16773\ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_wait\_fence\_pcollector);}
\DoxyCodeLine{16774\ \ \ \ \ GLsync\ fence\ =\ \_fences.back().\_object;}
\DoxyCodeLine{16775\ \ \ \ \ \_glClientWaitSync(fence,\ 0,\ (GLuint64)-\/1);}
\DoxyCodeLine{16776\ \ \ \}}
\DoxyCodeLine{16777\ }
\DoxyCodeLine{16778\ \ \ \textcolor{keywordflow}{while}\ (!\_fences.empty())\ \{}
\DoxyCodeLine{16779\ \ \ \ \ Fence\ \&fence\ =\ \_fences.front();}
\DoxyCodeLine{16780\ \ \ \ \ \textcolor{keywordflow}{if}\ (!force)\ \{}
\DoxyCodeLine{16781\ \ \ \ \ \ \ GLenum\ result\ =\ \_glClientWaitSync(fence.\_object,\ 0,\ 0);}
\DoxyCodeLine{16782\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ GL\_ALREADY\_SIGNALED\ \&\&\ result\ !=\ GL\_CONDITION\_SATISFIED)\ \{}
\DoxyCodeLine{16783\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Not\ yet\ done.\ \ The\ rest\ must\ not\ yet\ be\ done\ then,\ either.}}
\DoxyCodeLine{16784\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16785\ \ \ \ \ \ \ \}}
\DoxyCodeLine{16786\ \ \ \ \ \}}
\DoxyCodeLine{16787\ \ \ \ \ \_glDeleteSync(fence.\_object);}
\DoxyCodeLine{16788\ }
\DoxyCodeLine{16789\ \ \ \ \ std::move(fence.\_token).complete(\textcolor{keyword}{true});}
\DoxyCodeLine{16790\ \ \ \ \ \_fences.pop\_front();}
\DoxyCodeLine{16791\ }
\DoxyCodeLine{16792\ \ \ \ \ \textcolor{comment}{//\ If\ there\ is\ 1\ remaining,\ save\ it\ for\ next\ frame.\ \ This\ helps\ prevent\ an}}
\DoxyCodeLine{16793\ \ \ \ \ \textcolor{comment}{//\ inconsistent\ frame\ rate\ when\ the\ number\ of\ fetched\ frames\ alternates}}
\DoxyCodeLine{16794\ \ \ \ \ \textcolor{comment}{//\ between\ 0\ and\ 2,\ which\ can\ settle\ into\ a\ stable\ feedback\ loop.}}
\DoxyCodeLine{16795\ \ \ \ \ \textcolor{keywordflow}{if}\ (!force\ \&\&\ \_fences.size()\ ==\ 1)\ \{}
\DoxyCodeLine{16796\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{16797\ \ \ \ \ \}}
\DoxyCodeLine{16798\ \ \ \}}
\DoxyCodeLine{16799\ \}}
\DoxyCodeLine{16800\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ !OPENGLES\_1}}
\DoxyCodeLine{16801\ }
\DoxyCodeLine{16806\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16807\ call\_later(\mbox{\hyperlink{classCompletable}{Completable}}\ \&\&job)\ \{}
\DoxyCodeLine{16808\ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_job\_queue\_mutex);}
\DoxyCodeLine{16809\ \ \ \_job\_queue.push\_back(std::move(job));}
\DoxyCodeLine{16810\ \ \ \_job\_queue\_cvar.notify();}
\DoxyCodeLine{16811\ \}}
\DoxyCodeLine{16812\ }
\DoxyCodeLine{16819\ \textcolor{keywordtype}{void}\ CLP(\mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}})::}
\DoxyCodeLine{16820\ process\_pending\_jobs(bool\ wait)\ \{}
\DoxyCodeLine{16821\ \ \ JobQueue\ jobs;}
\DoxyCodeLine{16822\ \ \ \{}
\DoxyCodeLine{16823\ \ \ \ \ \mbox{\hyperlink{classMutexHolder}{MutexHolder}}\ holder(\_job\_queue\_mutex);}
\DoxyCodeLine{16824\ \ \ \ \ \textcolor{keywordflow}{if}\ (wait\ \&\&\ \_job\_queue.empty())\ \{}
\DoxyCodeLine{16825\ \ \ \ \ \ \ \_job\_queue\_cvar.wait();}
\DoxyCodeLine{16826\ \ \ \ \ \}}
\DoxyCodeLine{16827\ \ \ \ \ \_job\_queue.swap(jobs);}
\DoxyCodeLine{16828\ \ \ \}}
\DoxyCodeLine{16829\ }
\DoxyCodeLine{16830\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{auto}\ \&job\ :\ jobs)\ \{}
\DoxyCodeLine{16831\ \ \ \ \ std::move(job)();}
\DoxyCodeLine{16832\ \ \ \}}
\DoxyCodeLine{16833\ \}}

\end{DoxyCode}
