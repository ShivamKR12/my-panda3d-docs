\doxysection{anim\+Channel\+Matrix\+Xfm\+Table.\+cxx}
\hypertarget{animChannelMatrixXfmTable_8cxx_source}{}\label{animChannelMatrixXfmTable_8cxx_source}\index{panda/src/chan/animChannelMatrixXfmTable.cxx@{panda/src/chan/animChannelMatrixXfmTable.cxx}}
\mbox{\hyperlink{animChannelMatrixXfmTable_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{animChannelMatrixXfmTable_8h}{animChannelMatrixXfmTable.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{animBundle_8h}{animBundle.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__chan_8h}{config\_chan.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{compose__matrix_8h}{compose\_matrix.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fftCompressor_8h}{fftCompressor.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__linmath_8h}{config\_linmath.h}}"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ AnimChannelMatrixXfmTable::\_type\_handle;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00033\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable}}()\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00035\ \ \ \ \ \_tables[i]\ =\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_stdfloat}}(get\_class\_type());}
\DoxyCodeLine{00036\ \ \ \}}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00044\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00045\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable}}(\mbox{\hyperlink{classAnimGroup}{AnimGroup}}\ *parent,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable}{AnimChannelMatrixXfmTable}}\ \&copy)\ :}
\DoxyCodeLine{00046\ \ \ \mbox{\hyperlink{classAnimChannel}{AnimChannelMatrix}}(parent,\ copy)}
\DoxyCodeLine{00047\ \{}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \_tables[i]\ =\ copy.\_tables[i];}
\DoxyCodeLine{00050\ \ \ \}}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00056\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00057\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable}}(\mbox{\hyperlink{classAnimGroup}{AnimGroup}}\ *parent,\ \textcolor{keyword}{const}\ std::string\ \&name)}
\DoxyCodeLine{00058\ \ \ :\ \mbox{\hyperlink{classAnimChannel}{AnimChannelMatrix}}(parent,\ name)}
\DoxyCodeLine{00059\ \{}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \_tables[i]\ =\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_stdfloat}}(get\_class\_type());}
\DoxyCodeLine{00062\ \ \ \}}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00068\ AnimChannelMatrixXfmTable::}
\DoxyCodeLine{00069\ \string~AnimChannelMatrixXfmTable()\ \{}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00078\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac7e51d181dedba1689de54af54d24520}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00079\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac7e51d181dedba1689de54af54d24520}{has\_changed}}(\textcolor{keywordtype}{int}\ last\_frame,\ \textcolor{keywordtype}{double}\ last\_frac,}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ this\_frame,\ \textcolor{keywordtype}{double}\ this\_frac)\ \{}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{if}\ (last\_frame\ !=\ this\_frame)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i].size()\ >\ 1)\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i][last\_frame\ \%\ \_tables[i].size()]\ !=}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \_tables[i][this\_frame\ \%\ \_tables[i].size()])\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{if}\ (last\_frac\ !=\ this\_frac)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ some\ fractional\ changes,\ also\ check\ the\ next\ subsequent}}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{comment}{//\ frame\ (since\ we'll\ be\ blending\ with\ that).}}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i].size()\ >\ 1)\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i][last\_frame\ \%\ \_tables[i].size()]\ !=}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \_tables[i][(this\_frame\ +\ 1)\ \%\ \_tables[i].size()])\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ \ \ \ \ \}}
\DoxyCodeLine{00103\ \ \ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00111\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac8469cab64cb909ea5ff5ec26f4ba719}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac8469cab64cb909ea5ff5ec26f4ba719}{get\_value}}(\textcolor{keywordtype}{int}\ frame,\ LMatrix4\ \&mat)\ \{}
\DoxyCodeLine{00113\ \ \ PN\_stdfloat\ components[num\_matrix\_components];}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i].empty())\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ components[i]\ =\ get\_default\_value(i);}
\DoxyCodeLine{00118\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ components[i]\ =\ \_tables[i][frame\ \%\ \_tables[i].size()];}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{compose__matrix__src_8cxx_aa46bdf9de1e1e04a5e2cdd7af6b39c64}{compose\_matrix}}(mat,\ components);}
\DoxyCodeLine{00124\ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00130\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a10b5147abfa096379a9b55c9a5f223a7}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00131\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a10b5147abfa096379a9b55c9a5f223a7}{get\_value\_no\_scale\_shear}}(\textcolor{keywordtype}{int}\ frame,\ LMatrix4\ \&mat)\ \{}
\DoxyCodeLine{00132\ \ \ PN\_stdfloat\ components[num\_matrix\_components];}
\DoxyCodeLine{00133\ \ \ components[0]\ =\ 1.0f;}
\DoxyCodeLine{00134\ \ \ components[1]\ =\ 1.0f;}
\DoxyCodeLine{00135\ \ \ components[2]\ =\ 1.0f;}
\DoxyCodeLine{00136\ \ \ components[3]\ =\ 0.0f;}
\DoxyCodeLine{00137\ \ \ components[4]\ =\ 0.0f;}
\DoxyCodeLine{00138\ \ \ components[5]\ =\ 0.0f;}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 6;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i].empty())\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ components[i]\ =\ get\_default\_value(i);}
\DoxyCodeLine{00143\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ components[i]\ =\ \_tables[i][frame\ \%\ \_tables[i].size()];}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{compose__matrix__src_8cxx_aa46bdf9de1e1e04a5e2cdd7af6b39c64}{compose\_matrix}}(mat,\ components);}
\DoxyCodeLine{00149\ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00154\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a83aabe693957e3636ec0317631e1c9f0}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00155\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a83aabe693957e3636ec0317631e1c9f0}{get\_scale}}(\textcolor{keywordtype}{int}\ frame,\ LVecBase3\ \&scale)\ \{}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i].empty())\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ scale[i]\ =\ 1.0f;}
\DoxyCodeLine{00159\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ scale[i]\ =\ \_tables[i][frame\ \%\ \_tables[i].size()];}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00169\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a9170ee8c1f3ab343d826fdb0fe2618e9}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00170\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a9170ee8c1f3ab343d826fdb0fe2618e9}{get\_hpr}}(\textcolor{keywordtype}{int}\ frame,\ LVecBase3\ \&hpr)\ \{}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i\ +\ 6].empty())\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ hpr[i]\ =\ 0.0f;}
\DoxyCodeLine{00174\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ hpr[i]\ =\ \_tables[i\ +\ 6][frame\ \%\ \_tables[i\ +\ 6].size()];}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \}}
\DoxyCodeLine{00178\ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00185\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a3ddbeeef3d0c37a9bcfb37f096618277}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00186\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a3ddbeeef3d0c37a9bcfb37f096618277}{get\_quat}}(\textcolor{keywordtype}{int}\ frame,\ LQuaternion\ \&quat)\ \{}
\DoxyCodeLine{00187\ \ \ LVecBase3\ hpr;}
\DoxyCodeLine{00188\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i\ +\ 6].empty())\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ hpr[i]\ =\ 0.0f;}
\DoxyCodeLine{00191\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ hpr[i]\ =\ \_tables[i\ +\ 6][frame\ \%\ \_tables[i\ +\ 6].size()];}
\DoxyCodeLine{00193\ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ quat.set\_hpr(hpr);}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_aae12006273df7e0d12318b90e4b883b1}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00204\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_aae12006273df7e0d12318b90e4b883b1}{get\_pos}}(\textcolor{keywordtype}{int}\ frame,\ LVecBase3\ \&pos)\ \{}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i\ +\ 9].empty())\ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ pos[i]\ =\ 0.0f;}
\DoxyCodeLine{00208\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ pos[i]\ =\ \_tables[i\ +\ 9][frame\ \%\ \_tables[i\ +\ 9].size()];}
\DoxyCodeLine{00210\ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \}}
\DoxyCodeLine{00212\ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00218\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ae2149e6c5a90aecfa68a8f9f5de18140}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00219\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ae2149e6c5a90aecfa68a8f9f5de18140}{get\_shear}}(\textcolor{keywordtype}{int}\ frame,\ LVecBase3\ \&shear)\ \{}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_tables[i\ +\ 3].empty())\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ shear[i]\ =\ 0.0f;}
\DoxyCodeLine{00223\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ shear[i]\ =\ \_tables[i\ +\ 3][frame\ \%\ \_tables[i\ +\ 3].size()];}
\DoxyCodeLine{00225\ \ \ \ \ \}}
\DoxyCodeLine{00226\ \ \ \}}
\DoxyCodeLine{00227\ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00235\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a7569f11e8cc2a8a8d0541a28ff0fb31d}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00236\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a7569f11e8cc2a8a8d0541a28ff0fb31d}{set\_table}}(\textcolor{keywordtype}{char}\ table\_id,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_stdfloat}}\ \&table)\ \{}
\DoxyCodeLine{00237\ \ \ \textcolor{keywordtype}{int}\ num\_frames\ =\ \_root-\/>get\_num\_frames();}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{if}\ (table.size()\ >\ 1\ \&\&\ (\textcolor{keywordtype}{int})table.size()\ <\ num\_frames)\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{comment}{//\ The\ new\ table\ has\ an\ invalid\ number\ of\ frames-\/-\/it\ doesn't\ match\ the}}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{comment}{//\ bundle's\ requirement.}}
\DoxyCodeLine{00242\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}mismatched\ number\ of\ frames"{}});}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keywordtype}{int}\ i\ =\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_affbdb75567fff4b7a14d586c3630cc56}{get\_table\_index}}(table\_id);}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordflow}{if}\ (i\ <\ 0)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00249\ \ \ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \_tables[i]\ =\ table;}
\DoxyCodeLine{00252\ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00259\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a5e6879c4954465f4c7cf43f6225c2b92}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00260\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a5e6879c4954465f4c7cf43f6225c2b92}{clear\_all\_tables}}()\ \{}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \_tables[i]\ =\ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_stdfloat}}(get\_class\_type());}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00269\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac8b2996d171fbd62e1870cc3023e19e8}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00270\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ac8b2996d171fbd62e1870cc3023e19e8}{write}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00271\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00272\ \ \ \ \ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ Write\ a\ list\ of\ all\ the\ sub-\/tables\ that\ have\ data.}}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordtype}{bool}\ found\_any\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00276\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_tables[i].empty())\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ out\ <<\ get\_table\_id(i)\ <<\ \_tables[i].size();}
\DoxyCodeLine{00279\ \ \ \ \ \ \ found\_any\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00280\ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{if}\ (!found\_any)\ \{}
\DoxyCodeLine{00284\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}(no\ data)"{}};}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{if}\ (!\_children.empty())\ \{}
\DoxyCodeLine{00288\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \{\(\backslash\)n"{}};}
\DoxyCodeLine{00289\ \ \ \ \ \mbox{\hyperlink{classAnimGroup_af0e2255c521ed767f02eff6bcdd043d2}{write\_descendants}}(out,\ indent\_level\ +\ 2);}
\DoxyCodeLine{00290\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00291\ \ \ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00294\ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00301\ \mbox{\hyperlink{classAnimGroup}{AnimGroup}}\ *\mbox{\hyperlink{classAnimChannelMatrixXfmTable_a0bbfc3d06094fbb8f7c8a03e26054fb8}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00302\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a0bbfc3d06094fbb8f7c8a03e26054fb8}{make\_copy}}(\mbox{\hyperlink{classAnimGroup}{AnimGroup}}\ *parent)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable}}(parent,\ *\textcolor{keyword}{this});}
\DoxyCodeLine{00304\ \}}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00311\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_affbdb75567fff4b7a14d586c3630cc56}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00312\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_affbdb75567fff4b7a14d586c3630cc56}{get\_table\_index}}(\textcolor{keywordtype}{char}\ table\_id)\ \{}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{keywordflow}{if}\ (table\_id\ ==\ get\_table\_id(i))\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ i;}
\DoxyCodeLine{00316\ \ \ \ \ \}}
\DoxyCodeLine{00317\ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00320\ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00326\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ae43be18eb690b143aa80506f934ecb2f}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00327\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ae43be18eb690b143aa80506f934ecb2f}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{00328\ \ \ \mbox{\hyperlink{classAnimChannelBase_a3fe5cec86bcb87e3f3cd8c5274db094a}{AnimChannelMatrix::write\_datagram}}(manager,\ me);}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{if}\ (compress\_channels)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ chan\_cat.warning()}
\DoxyCodeLine{00332\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}FFT\ compression\ of\ animations\ is\ deprecated.\ \ For\ compatibility\ "{}}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}with\ future\ versions\ of\ Panda3D,\ set\ compress-\/channels\ to\ false.\(\backslash\)n"{}};}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFFTCompressor_adaa64eb86e996609d2f7b3dcc9c47abe}{FFTCompressor::is\_compression\_available}}())\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ chan\_cat.error()}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Compression\ is\ not\ available;\ writing\ uncompressed\ channels.\(\backslash\)n"{}};}
\DoxyCodeLine{00338\ \ \ \ \ \ \ compress\_channels\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00339\ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ me.add\_bool(compress\_channels);}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//\ We\ now\ always\ use\ the\ new\ HPR\ conventions.}}
\DoxyCodeLine{00345\ \ \ me.add\_bool(\textcolor{keyword}{true});}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \textcolor{keywordflow}{if}\ (!compress\_channels)\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{comment}{//\ Write\ out\ everything\ uncompressed,\ as\ a\ stream\ of\ floats.}}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ me.add\_uint16(\_tables[i].size());}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ (int)\_tables[i].size();\ j++)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ me.add\_stdfloat(\_tables[i][j]);}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00354\ \ \ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{comment}{//\ Write\ out\ everything\ using\ lossy\ compression.}}
\DoxyCodeLine{00358\ \ \ \ \ \mbox{\hyperlink{classFFTCompressor}{FFTCompressor}}\ compressor;}
\DoxyCodeLine{00359\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a53b0db870b069e6bd5513963af476fe2}{set\_quality}}(compress\_chan\_quality);}
\DoxyCodeLine{00360\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a1ee5f3c053b9f9e3909bd9411ac471d9}{set\_use\_error\_threshold}}(\textcolor{keyword}{true});}
\DoxyCodeLine{00361\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_ae4cae5073d6e047daeb3a2ed61a32838}{write\_header}}(me);}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{comment}{//\ First,\ write\ out\ the\ scales\ and\ shears.}}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 6;\ i++)\ \{}
\DoxyCodeLine{00366\ \ \ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_ae97e74c103db5941590843c2cc88bcab}{write\_reals}}(me,\ \_tables[i],\ \_tables[i].size());}
\DoxyCodeLine{00367\ \ \ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{comment}{//\ Now,\ write\ out\ the\ joint\ angles.\ \ For\ these\ we\ need\ to\ build\ up\ a\ HPR}}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{comment}{//\ array.}}
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<LVecBase3>}}\ hprs;}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordtype}{int}\ hprs\_length\ =\ std::max(std::max(\_tables[6].size(),\ \_tables[7].size()),\ \_tables[8].size());}
\DoxyCodeLine{00373\ \ \ \ \ hprs.reserve(hprs\_length);}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ hprs\_length;\ i++)\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ PN\_stdfloat\ h\ =\ \_tables[6].empty()\ ?\ 0.0f\ :\ \_tables[6][i\ \%\ \_tables[6].size()];}
\DoxyCodeLine{00376\ \ \ \ \ \ \ PN\_stdfloat\ p\ =\ \_tables[7].empty()\ ?\ 0.0f\ :\ \_tables[7][i\ \%\ \_tables[7].size()];}
\DoxyCodeLine{00377\ \ \ \ \ \ \ PN\_stdfloat\ r\ =\ \_tables[8].empty()\ ?\ 0.0f\ :\ \_tables[8][i\ \%\ \_tables[8].size()];}
\DoxyCodeLine{00378\ \ \ \ \ \ \ hprs.push\_back(LVecBase3(h,\ p,\ r));}
\DoxyCodeLine{00379\ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{keyword}{const}\ LVecBase3\ *hprs\_array\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{if}\ (hprs\_length\ !=\ 0)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ hprs\_array\ =\ \&hprs[0];}
\DoxyCodeLine{00383\ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_aedf56c07b9bf59a1abeba6cb65b73dfe}{write\_hprs}}(me,\ hprs\_array,\ hprs\_length);}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{comment}{//\ And\ now\ the\ translations.}}
\DoxyCodeLine{00387\ \ \ \ \ \textcolor{keywordflow}{for}(i\ =\ 9;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_ae97e74c103db5941590843c2cc88bcab}{write\_reals}}(me,\ \_tables[i],\ \_tables[i].size());}
\DoxyCodeLine{00389\ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \}}
\DoxyCodeLine{00391\ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00398\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ab90eb60f976f07a58475f606cffd6c8c}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00399\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_ab90eb60f976f07a58475f606cffd6c8c}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00400\ \ \ \mbox{\hyperlink{classAnimChannelBase_a83cbae12fb62fcde4d2e90ed3f483489}{AnimChannelMatrix::fillin}}(scan,\ manager);}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \textcolor{keywordtype}{bool}\ wrote\_compressed\ =\ scan.get\_bool();}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \textcolor{comment}{//\ If\ this\ is\ false,\ the\ file\ still\ uses\ the\ old\ HPR\ conventions,\ and\ we'll}}
\DoxyCodeLine{00405\ \ \ \textcolor{comment}{//\ have\ to\ convert\ the\ HPR\ values\ to\ the\ new\ convention.}}
\DoxyCodeLine{00406\ \ \ \textcolor{keywordtype}{bool}\ new\_hpr\ =\ scan.get\_bool();}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \textcolor{keywordflow}{if}\ (!wrote\_compressed)\ \{}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{comment}{//\ Regular\ floats.}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ size\ =\ scan.get\_uint16();}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ ind\_table(get\_class\_type());}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ j\ =\ 0;\ j\ <\ size;\ j++)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ ind\_table.push\_back(scan.get\_stdfloat());}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \_tables[i]\ =\ ind\_table;}
\DoxyCodeLine{00418\ \ \ \ \ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordflow}{if}\ (!new\_hpr)\ \{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ between\ the\ old\ HPR\ form\ and\ the\ new\ HPR\ form.}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_hprs\ =\ std::max(std::max(\_tables[6].size(),\ \_tables[7].size()),}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_tables[8].size());}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ LVecBase3\ default\_hpr(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_tables[6].empty())\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ default\_hpr[0]\ =\ \_tables[6][0];}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_tables[7].empty())\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ default\_hpr[1]\ =\ \_tables[7][0];}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_tables[8].empty())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ default\_hpr[2]\ =\ \_tables[8][0];}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ h\_table\ =\ PTA\_stdfloat::empty\_array(num\_hprs,\ get\_class\_type());}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ p\_table\ =\ PTA\_stdfloat::empty\_array(num\_hprs,\ get\_class\_type());}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ r\_table\ =\ PTA\_stdfloat::empty\_array(num\_hprs,\ get\_class\_type());}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ hi\ =\ 0;\ hi\ <\ num\_hprs;\ hi++)\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ PN\_stdfloat\ h\ =\ (hi\ <\ \_tables[6].size()\ ?\ \_tables[6][hi]\ :\ default\_hpr[0]);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ PN\_stdfloat\ p\ =\ (hi\ <\ \_tables[7].size()\ ?\ \_tables[7][hi]\ :\ default\_hpr[1]);}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ PN\_stdfloat\ r\ =\ (hi\ <\ \_tables[8].size()\ ?\ \_tables[8][hi]\ :\ default\_hpr[2]);}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ LVecBase3\ hpr\ =\ \mbox{\hyperlink{compose__matrix__src_8cxx_a98616986d213790723c720a84f9ec2b2}{old\_to\_new\_hpr}}(LVecBase3(h,\ p,\ r));}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ h\_table[hi]\ =\ hpr[0];}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ p\_table[hi]\ =\ hpr[1];}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ r\_table[hi]\ =\ hpr[2];}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \_tables[6]\ =\ h\_table;}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \_tables[7]\ =\ p\_table;}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \_tables[8]\ =\ r\_table;}
\DoxyCodeLine{00453\ \ \ \ \ \}}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00456\ \ \ \ \ \textcolor{comment}{//\ Compressed\ channels.}}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{if}\ (!read\_compressed\_channels)\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ chan\_cat.info()}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Not\ reading\ compressed\ animation\ channels.\(\backslash\)n"{}};}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a5e6879c4954465f4c7cf43f6225c2b92}{clear\_all\_tables}}();}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00462\ \ \ \ \ \}}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ \mbox{\hyperlink{classFFTCompressor}{FFTCompressor}}\ compressor;}
\DoxyCodeLine{00465\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a67f6b46d2ee1d06ad4549eabdcc2c439}{read\_header}}(scan,\ manager-\/>get\_file\_minor\_ver());}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{comment}{//\ First,\ read\ in\ the\ scales\ and\ shears.}}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ 6;\ i++)\ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ ind\_table\ =\ PTA\_stdfloat::empty\_array(0,\ get\_class\_type());}
\DoxyCodeLine{00471\ \ \ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a1be8ffd0b57154f9e36b163ebb85f2d0}{read\_reals}}(scan,\ ind\_table.v());}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \_tables[i]\ =\ ind\_table;}
\DoxyCodeLine{00473\ \ \ \ \ \}}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \ \ \textcolor{comment}{//\ Read\ in\ the\ HPR\ array\ and\ store\ it\ back\ in\ the\ joint\ angles.}}
\DoxyCodeLine{00476\ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<LVecBase3>}}\ hprs;}
\DoxyCodeLine{00477\ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a2e5f1f242aa11d39af0a111739d8c3da}{read\_hprs}}(scan,\ hprs,\ new\_hpr);}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ h\_table\ =\ PTA\_stdfloat::empty\_array(hprs.size(),\ get\_class\_type());}
\DoxyCodeLine{00479\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ p\_table\ =\ PTA\_stdfloat::empty\_array(hprs.size(),\ get\_class\_type());}
\DoxyCodeLine{00480\ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ r\_table\ =\ PTA\_stdfloat::empty\_array(hprs.size(),\ get\_class\_type());}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ (int)hprs.size();\ i++)\ \{}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!new\_hpr)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Convert\ the\ old\ HPR\ form\ to\ the\ new\ HPR\ form.}}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ LVecBase3\ hpr\ =\ \mbox{\hyperlink{compose__matrix__src_8cxx_a98616986d213790723c720a84f9ec2b2}{old\_to\_new\_hpr}}(hprs[i]);}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ h\_table[i]\ =\ hpr[0];}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ p\_table[i]\ =\ hpr[1];}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ r\_table[i]\ =\ hpr[2];}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Store\ the\ HPR\ angle\ directly.}}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ h\_table[i]\ =\ hprs[i][0];}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ p\_table[i]\ =\ hprs[i][1];}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ r\_table[i]\ =\ hprs[i][2];}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00496\ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \_tables[6]\ =\ h\_table;}
\DoxyCodeLine{00498\ \ \ \ \ \_tables[7]\ =\ p\_table;}
\DoxyCodeLine{00499\ \ \ \ \ \_tables[8]\ =\ r\_table;}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{comment}{//\ Now\ read\ in\ the\ translations.}}
\DoxyCodeLine{00502\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 9;\ i\ <\ num\_matrix\_components;\ i++)\ \{}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerToArray}{PTA\_stdfloat}}\ ind\_table\ =\ PTA\_stdfloat::empty\_array(0,\ get\_class\_type());}
\DoxyCodeLine{00504\ \ \ \ \ \ \ compressor.\mbox{\hyperlink{classFFTCompressor_a1be8ffd0b57154f9e36b163ebb85f2d0}{read\_reals}}(scan,\ ind\_table.v());}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \_tables[i]\ =\ ind\_table;}
\DoxyCodeLine{00506\ \ \ \ \ \}}
\DoxyCodeLine{00507\ \ \ \}}
\DoxyCodeLine{00508\ \}}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00513\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classAnimChannelMatrixXfmTable_a3d53b7f00e803aa7906907fd64013878}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00514\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a3d53b7f00e803aa7906907fd64013878}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00515\ \ \ \mbox{\hyperlink{classAnimChannelMatrixXfmTable}{AnimChannelMatrixXfmTable}}\ *me\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a4771bb4309f84064c51cc006b705fd58}{AnimChannelMatrixXfmTable}};}
\DoxyCodeLine{00516\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00517\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00520\ \ \ me-\/>\mbox{\hyperlink{classAnimChannelMatrixXfmTable_ab90eb60f976f07a58475f606cffd6c8c}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{00522\ \}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00527\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a25721a82edb50432df6fc3931ccbed06}{AnimChannelMatrixXfmTable::}}}
\DoxyCodeLine{00528\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a25721a82edb50432df6fc3931ccbed06}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00529\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classAnimChannelMatrixXfmTable_a3d53b7f00e803aa7906907fd64013878}{make\_from\_bam}});}
\DoxyCodeLine{00530\ \}}

\end{DoxyCode}
