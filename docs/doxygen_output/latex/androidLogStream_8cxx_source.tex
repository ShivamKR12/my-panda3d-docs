\doxysection{android\+Log\+Stream.\+cxx}
\hypertarget{androidLogStream_8cxx_source}{}\label{androidLogStream_8cxx_source}\index{dtool/src/prc/androidLogStream.cxx@{dtool/src/prc/androidLogStream.cxx}}
\mbox{\hyperlink{androidLogStream_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{androidLogStream_8h}{androidLogStream.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableString_8h}{configVariableString.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#ifdef\ ANDROID}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <android/log.h>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00024\ AndroidLogStream::AndroidLogStreamBuf::}
\DoxyCodeLine{00025\ AndroidLogStreamBuf(\textcolor{keywordtype}{int}\ priority)\ :}
\DoxyCodeLine{00026\ \ \ \_priority(priority)\ \{}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classConfigVariableString}{ConfigVariableString}}\ android\_log\_tag}
\DoxyCodeLine{00029\ \ \ (\textcolor{stringliteral}{"{}android-\/log-\/tag"{}},\ \textcolor{stringliteral}{"{}Panda3D"{}},}
\DoxyCodeLine{00030\ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}This\ defines\ the\ tag\ that\ Panda3D\ will\ use\ when\ writing\ to\ the\ "{}}}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Android\ log.\ \ The\ default\ is\ \(\backslash\)"{}Panda3D\(\backslash\)"{}."{}}));}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{if}\ (\_tag.empty())\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \_tag\ =\ android\_log\_tag.get\_value();}
\DoxyCodeLine{00035\ \ \ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ The\ AndroidLogStreamBuf\ doesn't\ actually\ need\ a\ buffer-\/-\/it's\ happy}}
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ writing\ characters\ one\ at\ a\ time,\ since\ they're\ just\ getting\ stuffed\ into}}
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ a\ string.\ \ (Although\ the\ code\ is\ written\ portably\ enough\ to\ use\ a\ buffer}}
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ correctly,\ if\ we\ had\ one.)}}
\DoxyCodeLine{00041\ \ \ setg(0,\ 0,\ 0);}
\DoxyCodeLine{00042\ \ \ setp(0,\ 0);}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00048\ AndroidLogStream::AndroidLogStreamBuf::}
\DoxyCodeLine{00049\ \string~AndroidLogStreamBuf()\ \{}
\DoxyCodeLine{00050\ \ \ sync();}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ \textcolor{keywordtype}{int}\ AndroidLogStream::AndroidLogStreamBuf::}
\DoxyCodeLine{00058\ sync()\ \{}
\DoxyCodeLine{00059\ \ \ std::streamsize\ n\ =\ pptr()\ -\/\ pbase();}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//\ Write\ the\ characters\ that\ remain\ in\ the\ buffer.}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{char}\ *p\ =\ pbase();\ p\ <\ pptr();\ ++p)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ write\_char(*p);}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ pbump(-\/n);\ \ \textcolor{comment}{//\ Reset\ pptr().}}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordflow}{return}\ 0;\ \ \textcolor{comment}{//\ EOF\ to\ indicate\ write\ full.}}
\DoxyCodeLine{00068\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{int}\ AndroidLogStream::AndroidLogStreamBuf::}
\DoxyCodeLine{00075\ overflow(\textcolor{keywordtype}{int}\ ch)\ \{}
\DoxyCodeLine{00076\ \ \ std::streamsize\ n\ =\ pptr()\ -\/\ pbase();}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \textcolor{keywordflow}{if}\ (n\ !=\ 0\ \&\&\ sync()\ !=\ 0)\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{return}\ EOF;}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{if}\ (ch\ !=\ EOF)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{comment}{//\ Write\ one\ more\ character.}}
\DoxyCodeLine{00084\ \ \ \ \ write\_char(ch);}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{void}\ AndroidLogStream::AndroidLogStreamBuf::}
\DoxyCodeLine{00094\ write\_char(\textcolor{keywordtype}{char}\ c)\ \{}
\DoxyCodeLine{00095\ \ \ \textcolor{comment}{//nout.put(c);}}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{if}\ (c\ ==\ \textcolor{charliteral}{'\(\backslash\)n'})\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ line\ to\ the\ log\ file.}}
\DoxyCodeLine{00098\ \ \ \ \ \_\_android\_log\_write(\_priority,\ \_tag.c\_str(),\ \_data.c\_str());}
\DoxyCodeLine{00099\ \ \ \ \ \_data.clear();}
\DoxyCodeLine{00100\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \_data\ +=\ c;}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00108\ AndroidLogStream::}
\DoxyCodeLine{00109\ AndroidLogStream(\textcolor{keywordtype}{int}\ priority)\ :}
\DoxyCodeLine{00110\ \ \ std::ostream(new\ AndroidLogStreamBuf(priority))\ \{}
\DoxyCodeLine{00111\ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00116\ AndroidLogStream::}
\DoxyCodeLine{00117\ \string~AndroidLogStream()\ \{}
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{delete}\ rdbuf();}
\DoxyCodeLine{00119\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ ANDROID}}

\end{DoxyCode}
