\doxysection{bam\+Reader.\+h}
\hypertarget{bamReader_8h_source}{}\label{bamReader_8h_source}\index{panda/src/putil/bamReader.h@{panda/src/putil/bamReader.h}}
\mbox{\hyperlink{bamReader_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ \_\_BAM\_READER\_}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ \_\_BAM\_READER\_}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnotify_8h}{pnotify.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{typedWritable_8h}{typedWritable.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{typedWritableReferenceCount_8h}{typedWritableReferenceCount.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pointerTo_8h}{pointerTo.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramGenerator_8h}{datagramGenerator.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReaderParam_8h}{bamReaderParam.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamEnums_8h}{bamEnums.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{subfileInfo_8h}{subfileInfo.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{loaderOptions_8h}{loaderOptions.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{factory_8h}{factory.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vector__int_8h}{vector\_int.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pset_8h}{pset.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pmap_8h}{pmap.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pdeque_8h}{pdeque.h}}"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pipelineCyclerBase_8h}{pipelineCyclerBase.h}}"{}}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{referenceCount_8h}{referenceCount.h}}"{}}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{//\ A\ handy\ macro\ for\ reading\ PointerToArrays.}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ READ\_PTA(Manager,\ source,\ Read\_func,\ array)\ \ \ \(\backslash\)}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ void\ *t;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\ \ if\ ((t\ =\ Manager-\/>get\_pta(source))\ ==\ nullptr)\ \ \(\backslash\)}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\ \ \ \ array\ =\ Read\_func(Manager,\ source);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\ \ \ \ Manager-\/>register\_pta(array.get\_void\_ptr());\ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\ \ else\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\ \ \ \ array.set\_void\_ptr(t);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\ \ \}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\}}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00061\ \textcolor{keyword}{class\ }EXPCL\_PANDA\_PUTIL\ \mbox{\hyperlink{classBamReaderAuxData}{BamReaderAuxData}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classTypedReferenceCount}{TypedReferenceCount}}\ \{}
\DoxyCodeLine{00062\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00063\ \ \ INLINE\ \mbox{\hyperlink{classBamReaderAuxData}{BamReaderAuxData}}();}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00066\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ get\_type()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_class\_type();}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ force\_init\_type()\ \{init\_type();\ \textcolor{keywordflow}{return}\ get\_class\_type();\}}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ get\_class\_type()\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{return}\ \_type\_handle;}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00075\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ init\_type()\ \{}
\DoxyCodeLine{00076\ \ \ \ \ TypedReferenceCount::init\_type();}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{register__type_8h_a54fc7cae2908ec9e8da7174a8d027735}{register\_type}}(\_type\_handle,\ \textcolor{stringliteral}{"{}BamReaderAuxData"{}},}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TypedReferenceCount::get\_class\_type());}
\DoxyCodeLine{00079\ \ \ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00082\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ \_type\_handle;}
\DoxyCodeLine{00083\ \};}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{class\ }EXPCL\_PANDA\_PUTIL\ \mbox{\hyperlink{classBamReader}{BamReader}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classBamEnums}{BamEnums}}\ \{}
\DoxyCodeLine{00111\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00112\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classFactory}{Factory<TypedWritable>}}\ \mbox{\hyperlink{classFactory}{WritableFactory}};}
\DoxyCodeLine{00113\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *\textcolor{keyword}{const}\ Null;}
\DoxyCodeLine{00114\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classFactory}{WritableFactory}}\ *\textcolor{keyword}{const}\ NullFactory;}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ PUBLISHED:}
\DoxyCodeLine{00117\ \ \ \textcolor{comment}{//\ The\ primary\ interface\ for\ a\ caller.}}
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{classBamReader}{BamReader}}(\mbox{\hyperlink{classDatagramGenerator}{DatagramGenerator}}\ *source\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00119\ \ \ \mbox{\hyperlink{classBamReader}{\string~BamReader}}();}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keywordtype}{void}\ set\_source(\mbox{\hyperlink{classDatagramGenerator}{DatagramGenerator}}\ *source);}
\DoxyCodeLine{00122\ \ \ INLINE\ \mbox{\hyperlink{classDatagramGenerator}{DatagramGenerator}}\ *get\_source();}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{bool}\ init();}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classBamReader_1_1AuxData}{AuxData}};}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{void}\ set\_aux\_data(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *obj,\ \textcolor{keyword}{const}\ std::string\ \&name,\ \mbox{\hyperlink{classBamReader_1_1AuxData}{AuxData}}\ *data);}
\DoxyCodeLine{00128\ \ \ \mbox{\hyperlink{classBamReader_1_1AuxData}{AuxData}}\ *get\_aux\_data(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *obj,\ \textcolor{keyword}{const}\ std::string\ \&name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ INLINE\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&get\_filename()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ INLINE\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&get\_loader\_options()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00133\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_loader\_options(\textcolor{keyword}{const}\ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \&options);}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \textcolor{preprocessor}{\#if\ defined(CPPPARSER)\ \&\&\ defined(HAVE\_PYTHON)}}
\DoxyCodeLine{00136\ \ \ EXTENSION(PyObject\ *read\_object());}
\DoxyCodeLine{00137\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00138\ \ \ BLOCKING\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *read\_object();}
\DoxyCodeLine{00139\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ read\_object(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\&ptr,\ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ *\&ref\_ptr);}
\DoxyCodeLine{00140\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_eof()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00143\ \ \ \textcolor{keywordtype}{bool}\ resolve();}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordtype}{bool}\ change\_pointer(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *orig\_pointer,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *new\_pointer);}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_file\_major\_ver()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00148\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_file\_minor\_ver()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00149\ \ \ INLINE\ BamEndian\ get\_file\_endian()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00150\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ get\_file\_stdfloat\_double()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_current\_major\_ver()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00153\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_current\_minor\_ver()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ PY\_EXTENSION(PyObject\ *get\_file\_version()\ \textcolor{keyword}{const});}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ PUBLISHED:}
\DoxyCodeLine{00158\ \ \ MAKE\_PROPERTY(source,\ get\_source,\ set\_source);}
\DoxyCodeLine{00159\ \ \ MAKE\_PROPERTY(filename,\ get\_filename);}
\DoxyCodeLine{00160\ \ \ MAKE\_PROPERTY(loader\_options,\ get\_loader\_options,\ set\_loader\_options);}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ PY\_MAKE\_PROPERTY(file\_version,\ get\_file\_version);}
\DoxyCodeLine{00163\ \ \ MAKE\_PROPERTY(file\_endian,\ get\_file\_endian);}
\DoxyCodeLine{00164\ \ \ MAKE\_PROPERTY(file\_stdfloat\_double,\ get\_file\_stdfloat\_double);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00167\ \ \ \textcolor{comment}{//\ Functions\ to\ support\ classes\ that\ read\ themselves\ from\ the\ Bam.}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{keywordtype}{bool}\ read\_pointer(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{void}\ read\_pointers(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \textcolor{keywordtype}{int}\ count);}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordtype}{void}\ skip\_pointer(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordtype}{void}\ read\_file\_data(\mbox{\hyperlink{classSubfileInfo}{SubfileInfo}}\ \&info);}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \textcolor{keywordtype}{void}\ read\_cdata(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{structPipelineCyclerTrivialImpl}{PipelineCyclerBase}}\ \&cycler);}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordtype}{void}\ read\_cdata(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{structPipelineCyclerTrivialImpl}{PipelineCyclerBase}}\ \&cycler,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *extra\_data);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{keywordtype}{void}\ set\_int\_tag(\textcolor{keyword}{const}\ std::string\ \&tag,\ \textcolor{keywordtype}{int}\ value);}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordtype}{int}\ get\_int\_tag(\textcolor{keyword}{const}\ std::string\ \&tag)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \textcolor{keywordtype}{void}\ set\_aux\_tag(\textcolor{keyword}{const}\ std::string\ \&tag,\ \mbox{\hyperlink{classBamReaderAuxData}{BamReaderAuxData}}\ *value);}
\DoxyCodeLine{00183\ \ \ \mbox{\hyperlink{classBamReaderAuxData}{BamReaderAuxData}}\ *get\_aux\_tag(\textcolor{keyword}{const}\ std::string\ \&tag)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \textcolor{keywordtype}{void}\ register\_finalize(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *whom);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *(*ChangeThisFunc)(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *object,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager);}
\DoxyCodeLine{00188\ \ \ \textcolor{keyword}{typedef}\ PT(\mbox{\hyperlink{classTypedWritableReferenceCount}{TypedWritableReferenceCount}})\ (*ChangeThisRefFunc)(\mbox{\hyperlink{classTypedWritableReferenceCount}{TypedWritableReferenceCount}}\ *object,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager);}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordtype}{void}\ register\_change\_this(ChangeThisFunc\ func,\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *whom);}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{void}\ register\_change\_this(ChangeThisRefFunc\ func,\ \mbox{\hyperlink{classTypedWritableReferenceCount}{TypedWritableReferenceCount}}\ *whom);}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \textcolor{keywordtype}{void}\ finalize\_now(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *whom);}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keywordtype}{void}\ *get\_pta(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordtype}{void}\ register\_pta(\textcolor{keywordtype}{void}\ *ptr);}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ read\_handle(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ INLINE\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFileReference}{FileReference}}\ *get\_file();}
\DoxyCodeLine{00200\ \ \ INLINE\ \mbox{\hyperlink{classVirtualFile}{VirtualFile}}\ *get\_vfile();}
\DoxyCodeLine{00201\ \ \ INLINE\ std::streampos\ get\_file\_pos();}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00204\ \ \ INLINE\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ register\_factory(\mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ type,\ WritableFactory::CreateFunc\ *func,}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ *user\_data\ =\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00206\ \ \ INLINE\ \textcolor{keyword}{static}\ \mbox{\hyperlink{classFactory}{WritableFactory}}\ *get\_factory();}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ PUBLISHED:}
\DoxyCodeLine{00209\ \ \ PY\_EXTENSION(\textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ register\_factory(\mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ handle,\ PyObject\ *func));}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00212\ \ \ INLINE\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ create\_factory();}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00215\ \ \ \textcolor{keyword}{class\ }PointerReference;}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{keywordtype}{void}\ free\_object\_ids(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordtype}{int}\ read\_object\_id(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00219\ \ \ \textcolor{keywordtype}{int}\ read\_pta\_id(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan);}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordtype}{int}\ p\_read\_object();}
\DoxyCodeLine{00221\ \ \ \textcolor{keywordtype}{bool}\ resolve\_object\_pointers(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\textcolor{keywordtype}{object},\ PointerReference\ \&pref);}
\DoxyCodeLine{00222\ \ \ \textcolor{keywordtype}{bool}\ resolve\_cycler\_pointers(\mbox{\hyperlink{structPipelineCyclerTrivialImpl}{PipelineCyclerBase}}\ *cycler,\ \textcolor{keyword}{const}\ vector\_int\ \&pointer\_ids,}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ require\_fully\_complete);}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{void}\ finalize();}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ get\_datagram(\mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ Inherit\ from\ this\ class\ to\ piggyback\ additional\ temporary\ data\ on\ the}}
\DoxyCodeLine{00230\ \ \ \textcolor{comment}{//\ bamReader\ (via\ set\_aux\_data()\ and\ get\_aux\_data())\ for\ any\ particular}}
\DoxyCodeLine{00231\ \ \ \textcolor{comment}{//\ objects\ during\ the\ bam\ reading\ process.}}
\DoxyCodeLine{00232\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classBamReader_1_1AuxData}{AuxData}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ \{}
\DoxyCodeLine{00233\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00234\ \ \ \ \ INLINE\ \mbox{\hyperlink{classBamReader_1_1AuxData}{AuxData}}();}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keyword}{virtual}\ \mbox{\hyperlink{classBamReader_1_1AuxData}{\string~AuxData}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00236\ \ \ \};}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00239\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classFactory}{WritableFactory}}\ *\_factory;}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \mbox{\hyperlink{classDatagramGenerator}{DatagramGenerator}}\ *\_source;}
\DoxyCodeLine{00242\ \ \ \textcolor{keywordtype}{bool}\ \_needs\_init;}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \textcolor{keywordtype}{bool}\ \_long\_object\_id;}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordtype}{bool}\ \_long\_pta\_id;}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \textcolor{comment}{//\ This\ maps\ the\ type\ index\ numbers\ encountered\ within\ the\ Bam\ file\ to}}
\DoxyCodeLine{00248\ \ \ \textcolor{comment}{//\ actual\ TypeHandles.}}
\DoxyCodeLine{00249\ \ \ \textcolor{keyword}{typedef}\ phash\_map<int,\ TypeHandle,\ int\_hash>\ IndexMap;}
\DoxyCodeLine{00250\ \ \ IndexMap\ \_index\_map;}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{classLoaderOptions}{LoaderOptions}}\ \_loader\_options;}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \textcolor{comment}{//\ This\ maps\ the\ object\ ID\ numbers\ encountered\ within\ the\ Bam\ file\ to\ the}}
\DoxyCodeLine{00255\ \ \ \textcolor{comment}{//\ actual\ pointers\ of\ the\ corresponding\ generated\ objects.}}
\DoxyCodeLine{00256\ \ \ \textcolor{keyword}{class\ }CreatedObj\ \{}
\DoxyCodeLine{00257\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00258\ \ \ \ \ INLINE\ CreatedObj();}
\DoxyCodeLine{00259\ \ \ \ \ INLINE\ \string~CreatedObj();}
\DoxyCodeLine{00260\ \ \ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_ptr(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *ptr,\ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ *ref\_ptr);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordtype}{bool}\ \_created;}
\DoxyCodeLine{00264\ \ \ \ \ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\_ptr;}
\DoxyCodeLine{00265\ \ \ \ \ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ *\_ref\_ptr;}
\DoxyCodeLine{00266\ \ \ \ \ ChangeThisFunc\ \_change\_this;}
\DoxyCodeLine{00267\ \ \ \ \ ChangeThisRefFunc\ \_change\_this\_ref;}
\DoxyCodeLine{00268\ \ \ \};}
\DoxyCodeLine{00269\ \ \ \textcolor{keyword}{typedef}\ phash\_map<int,\ CreatedObj,\ int\_hash>\ CreatedObjs;}
\DoxyCodeLine{00270\ \ \ CreatedObjs\ \_created\_objs;}
\DoxyCodeLine{00271\ \ \ \textcolor{comment}{//\ This\ is\ the\ iterator\ into\ the\ above\ map\ for\ the\ object\ we\ are\ currently}}
\DoxyCodeLine{00272\ \ \ \textcolor{comment}{//\ reading\ in\ p\_read\_object().\ \ It\ is\ carefully\ maintained\ during\ recursion.}}
\DoxyCodeLine{00273\ \ \ \textcolor{comment}{//\ We\ need\ this\ so\ we\ can\ associate\ read\_pointer()\ calls\ with\ the\ proper}}
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ objects.}}
\DoxyCodeLine{00275\ \ \ CreatedObjs::iterator\ \_now\_creating;}
\DoxyCodeLine{00276\ \ \ \textcolor{comment}{//\ This\ is\ the\ pointer\ to\ the\ current\ PipelineCycler\ we\ are\ reading,\ if\ we}}
\DoxyCodeLine{00277\ \ \ \textcolor{comment}{//\ are\ within\ a\ read\_cdata()\ call.}}
\DoxyCodeLine{00278\ \ \ \mbox{\hyperlink{structPipelineCyclerTrivialImpl}{PipelineCyclerBase}}\ *\_reading\_cycler;}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{comment}{//\ This\ is\ the\ reverse\ lookup\ into\ the\ above\ map.}}
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{typedef}\ phash\_map<const\ TypedWritable\ *,\ vector\_int,\ pointer\_hash>\ CreatedObjsByPointer;}
\DoxyCodeLine{00282\ \ \ CreatedObjsByPointer\ \_created\_objs\_by\_pointer;}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{comment}{//\ This\ records\ all\ the\ objects\ that\ still\ need\ their\ pointers\ completed,}}
\DoxyCodeLine{00285\ \ \ \textcolor{comment}{//\ along\ with\ the\ object\ ID's\ of\ the\ pointers\ they\ need,\ in\ the\ order\ in}}
\DoxyCodeLine{00286\ \ \ \textcolor{comment}{//\ which\ read\_pointer()\ was\ called,\ so\ that\ we\ may\ call\ the\ appropriate}}
\DoxyCodeLine{00287\ \ \ \textcolor{comment}{//\ complete\_pointers()\ later.}}
\DoxyCodeLine{00288\ \ \ \textcolor{keyword}{typedef}\ phash\_map<PipelineCyclerBase\ *,\ vector\_int,\ pointer\_hash>\ CyclerPointers;}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpmap}{pmap<std::string,\ int>}}\ IntTags;}
\DoxyCodeLine{00290\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpmap}{pmap}}<std::string,\ PT(\mbox{\hyperlink{classBamReaderAuxData}{BamReaderAuxData}})\ >\ AuxTags;}
\DoxyCodeLine{00291\ \ \ \textcolor{keyword}{class\ }PointerReference\ \{}
\DoxyCodeLine{00292\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00293\ \ \ \ \ vector\_int\ \_objects;}
\DoxyCodeLine{00294\ \ \ \ \ CyclerPointers\ \_cycler\_pointers;}
\DoxyCodeLine{00295\ \ \ \ \ IntTags\ \_int\_tags;}
\DoxyCodeLine{00296\ \ \ \ \ AuxTags\ \_aux\_tags;}
\DoxyCodeLine{00297\ \ \ \};}
\DoxyCodeLine{00298\ \ \ \textcolor{keyword}{typedef}\ phash\_map<int,\ PointerReference,\ int\_hash>\ ObjectPointers;}
\DoxyCodeLine{00299\ \ \ ObjectPointers\ \_object\_pointers;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{comment}{//\ This\ is\ the\ number\ of\ extra\ objects\ that\ must\ still\ be\ read\ (and\ saved\ in}}
\DoxyCodeLine{00302\ \ \ \textcolor{comment}{//\ the\ \_created\_objs\ map)\ before\ returning\ from\ read\_object().\ \ It\ is\ only}}
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{//\ used\ when\ read\ bam\ versions\ prior\ to\ 6.20.}}
\DoxyCodeLine{00304\ \ \ \textcolor{keywordtype}{int}\ \_num\_extra\_objects;}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{comment}{//\ The\ current\ nesting\ level.\ \ We\ are\ not\ done\ reading\ an\ object\ until\ we}}
\DoxyCodeLine{00307\ \ \ \textcolor{comment}{//\ return\ to\ our\ starting\ nesting\ level.\ \ It\ is\ only\ used\ when\ reading\ bam}}
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ versions\ of\ 6.20\ or\ higher.}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{int}\ \_nesting\_level;}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{comment}{//\ This\ is\ the\ set\ of\ all\ objects\ that\ registered\ themselves\ for}}
\DoxyCodeLine{00312\ \ \ \textcolor{comment}{//\ finalization.}}
\DoxyCodeLine{00313\ \ \ \textcolor{keyword}{typedef}\ phash\_set<TypedWritable\ *,\ pointer\_hash>\ Finalize;}
\DoxyCodeLine{00314\ \ \ Finalize\ \_finalize\_list;}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{comment}{//\ These\ are\ used\ by\ get\_pta()\ and\ register\_pta()\ to\ unify\ multiple}}
\DoxyCodeLine{00317\ \ \ \textcolor{comment}{//\ references\ to\ the\ same\ PointerToArray.}}
\DoxyCodeLine{00318\ \ \ \textcolor{keyword}{typedef}\ phash\_map<int,\ void\ *,\ int\_hash>\ PTAMap;}
\DoxyCodeLine{00319\ \ \ PTAMap\ \_pta\_map;}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordtype}{int}\ \_pta\_id;}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//\ This\ is\ a\ queue\ of\ the\ currently-\/pending\ file\ data\ blocks\ that\ we\ have}}
\DoxyCodeLine{00323\ \ \ \textcolor{comment}{//\ recently\ encountered\ in\ the\ stream\ and\ still\ expect\ a\ subsequent\ object}}
\DoxyCodeLine{00324\ \ \ \textcolor{comment}{//\ to\ request.}}
\DoxyCodeLine{00325\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpdeque}{pdeque<SubfileInfo>}}\ FileDataRecords;}
\DoxyCodeLine{00326\ \ \ FileDataRecords\ \_file\_data\_records;}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \textcolor{comment}{//\ This\ is\ used\ internally\ to\ record\ all\ of\ the\ new\ types\ created\ on-\/the-\/fly}}
\DoxyCodeLine{00329\ \ \ \textcolor{comment}{//\ to\ satisfy\ bam\ requirements.\ \ We\ keep\ track\ of\ this\ just\ so\ we\ can}}
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ suppress\ warning\ messages\ from\ attempts\ to\ create\ objects\ of\ these\ types.}}
\DoxyCodeLine{00331\ \ \ \textcolor{keyword}{typedef}\ phash\_set<TypeHandle>\ NewTypes;}
\DoxyCodeLine{00332\ \ \ \textcolor{keyword}{static}\ NewTypes\ \_new\_types;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \textcolor{comment}{//\ This\ is\ used\ in\ support\ of\ set\_aux\_data()\ and\ get\_aux\_data().}}
\DoxyCodeLine{00335\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpmap}{pmap}}<std::string,\ PT(AuxData)>\ AuxDataNames;}
\DoxyCodeLine{00336\ \ \ \textcolor{keyword}{typedef}\ phash\_map<TypedWritable\ *,\ AuxDataNames,\ pointer\_hash>\ AuxDataTable;}
\DoxyCodeLine{00337\ \ \ AuxDataTable\ \_aux\_data;}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \textcolor{keywordtype}{int}\ \_file\_major,\ \_file\_minor;}
\DoxyCodeLine{00340\ \ \ BamEndian\ \_file\_endian;}
\DoxyCodeLine{00341\ \ \ \textcolor{keywordtype}{bool}\ \_file\_stdfloat\_double;}
\DoxyCodeLine{00342\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_cur\_major;}
\DoxyCodeLine{00343\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_cur\_minor;}
\DoxyCodeLine{00344\ \};}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classFactory}{BamReader::WritableFactory}}\ \mbox{\hyperlink{classFactory}{WritableFactory}};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{comment}{//\ Useful\ function\ for\ taking\ apart\ the\ Factory\ Params\ in\ the\ static\ functions}}
\DoxyCodeLine{00349\ \textcolor{comment}{//\ that\ need\ to\ be\ defined\ in\ each\ writable\ class\ that\ will\ be\ generated\ by\ a}}
\DoxyCodeLine{00350\ \textcolor{comment}{//\ factory.\ \ Sets\ the\ DatagramIterator\ and\ the\ BamReader\ pointers.}}
\DoxyCodeLine{00351\ INLINE\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00352\ parse\_params(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params,}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *\&manager);}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \textcolor{preprocessor}{\#include\ "{}bamReader.I"{}}}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ !\_\_BAM\_READER\_}}

\end{DoxyCode}
