\doxysection{p\+Stat\+Client\+Data.\+cxx}
\hypertarget{pStatClientData_8cxx_source}{}\label{pStatClientData_8cxx_source}\index{pandatool/src/pstatserver/pStatClientData.cxx@{pandatool/src/pstatserver/pStatClientData.cxx}}
\mbox{\hyperlink{pStatClientData_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatClientData_8h}{pStatClientData.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatFrameData_8h}{pStatFrameData.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatReader_8h}{pStatReader.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatCollectorDef_8h}{pStatCollectorDef.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ PStatClientData::\_null\_collector(-\/1,\ \textcolor{stringliteral}{"{}Unknown"{}});}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ PStatClientData::}
\DoxyCodeLine{00028\ PStatClientData(\mbox{\hyperlink{classPStatReader}{PStatReader}}\ *reader)\ :}
\DoxyCodeLine{00029\ \ \ \_is\_alive(true),}
\DoxyCodeLine{00030\ \ \ \_is\_dirty(false),}
\DoxyCodeLine{00031\ \ \ \_reader(reader)}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ PStatClientData::}
\DoxyCodeLine{00039\ \string~PStatClientData()\ \{}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{for}\ (Collector\ \&collector\ :\ \_collectors)\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keyword}{delete}\ collector.\_def;}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00048\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a2fdc16be630ff465e8e9a69e1ae0e5e0}{PStatClientData::}}}
\DoxyCodeLine{00049\ \mbox{\hyperlink{classPStatClientData_a2fdc16be630ff465e8e9a69e1ae0e5e0}{clear\_dirty}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00050\ \ \ \_is\_dirty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_ad5cd3be63341b509d48fdee720ee8d12}{PStatClientData::}}}
\DoxyCodeLine{00058\ \mbox{\hyperlink{classPStatClientData_ad5cd3be63341b509d48fdee720ee8d12}{is\_dirty}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \_is\_dirty;}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00066\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_a39031a484f328b738558bc1796cc8493}{PStatClientData::}}}
\DoxyCodeLine{00067\ \mbox{\hyperlink{classPStatClientData_a39031a484f328b738558bc1796cc8493}{is\_alive}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{return}\ \_is\_alive;}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a58cd4970de54883e64e3508f3783b9e3}{PStatClientData::}}}
\DoxyCodeLine{00075\ \mbox{\hyperlink{classPStatClientData_a58cd4970de54883e64e3508f3783b9e3}{close}}()\ \{}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ (\_is\_alive\ \&\&\ \_reader\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \_reader-\/>\mbox{\hyperlink{classPStatReader_af7ab61e4c8b084bbd36f0f2fc5a13c86}{close}}();}
\DoxyCodeLine{00078\ \ \ \ \ \_reader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00079\ \ \ \ \ \_is\_alive\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00087\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classPStatClientData_af1bd9567dc86b661d4689d853d18652a}{PStatClientData::}}}
\DoxyCodeLine{00088\ \mbox{\hyperlink{classPStatClientData_af1bd9567dc86b661d4689d853d18652a}{get\_latest\_time}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordtype}{double}\ time\ =\ 0.0;}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ Thread\ \&thread\ :\ \_threads)\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread.\_data\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !thread.\_data-\/>is\_empty())\ \{}
\DoxyCodeLine{00092\ \ \ \ \ \ \ time\ =\ std::max(time,\ thread.\_data-\/>get\_latest\_time());}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{return}\ time;}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00102\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_a947af0d045e34707dfbe9f17ed4c8aa4}{PStatClientData::}}}
\DoxyCodeLine{00103\ \mbox{\hyperlink{classPStatClientData_a947af0d045e34707dfbe9f17ed4c8aa4}{get\_num\_collectors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{return}\ \_collectors.size();}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00112\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{PStatClientData::}}}
\DoxyCodeLine{00113\ \mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{has\_collector}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{return}\ (index\ >=\ 0\ \&\&\ index\ <\ (\textcolor{keywordtype}{int})\_collectors.size()\ \&\&}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \_collectors[index].\_def\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00116\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_a4e9c17e266b3d4f9ff6ca8100eb9c85a}{PStatClientData::}}}
\DoxyCodeLine{00123\ \mbox{\hyperlink{classPStatClientData_a4e9c17e266b3d4f9ff6ca8100eb9c85a}{find\_collector}}(\textcolor{keyword}{const}\ std::string\ \&fullname)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00124\ \ \ \textcolor{comment}{//\ Take\ the\ last\ bit,\ we\ can\ compare\ it\ more\ cheaply,\ only\ check\ the\ full}}
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ name\ if\ the\ basename\ matches.}}
\DoxyCodeLine{00126\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *colon\ =\ strrchr(fullname.c\_str(),\ \textcolor{charliteral}{':'});}
\DoxyCodeLine{00127\ \ \ std::string\ name(colon\ !=\ \textcolor{keyword}{nullptr}\ ?\ colon\ +\ 1\ :\ fullname.c\_str());}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ \mbox{\hyperlink{classPStatClientData_a947af0d045e34707dfbe9f17ed4c8aa4}{get\_num\_collectors}}();\ ++index)\ \{}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ \_collectors[index].\_def;}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (def\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ def-\/>\_name\ ==\ name\ \&\&}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{get\_collector\_fullname}}(index)\ ==\ fullname)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ index;}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00138\ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00143\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&\mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{PStatClientData::}}}
\DoxyCodeLine{00144\ \mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{has\_collector}}(index))\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{return}\ \_null\_collector;}
\DoxyCodeLine{00147\ \ \ \}}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{return}\ *\_collectors[index].\_def;}
\DoxyCodeLine{00149\ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00154\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classPStatClientData_ae5c6475096900ee0f29eff74e6919b31}{PStatClientData::}}}
\DoxyCodeLine{00155\ \mbox{\hyperlink{classPStatClientData_ae5c6475096900ee0f29eff74e6919b31}{get\_collector\_name}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{has\_collector}}(index))\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ \_collectors[index].\_def;}
\DoxyCodeLine{00160\ \ \ \textcolor{keywordflow}{return}\ def-\/>\_name;}
\DoxyCodeLine{00161\ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00168\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{PStatClientData::}}}
\DoxyCodeLine{00169\ \mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{get\_collector\_fullname}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{has\_collector}}(index))\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{00172\ \ \ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ \_collectors[index].\_def;}
\DoxyCodeLine{00175\ \ \ \textcolor{keywordflow}{if}\ (def-\/>\_parent\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordflow}{return}\ def-\/>\_name;}
\DoxyCodeLine{00177\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{get\_collector\_fullname}}(def-\/>\_parent\_index)\ +\ \textcolor{stringliteral}{"{}:"{}}\ +\ def-\/>\_name;}
\DoxyCodeLine{00179\ \ \ \}}
\DoxyCodeLine{00180\ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00188\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_a7f9c85b3fcdbed1427a5ad3fca5346a7}{PStatClientData::}}}
\DoxyCodeLine{00189\ \mbox{\hyperlink{classPStatClientData_a7f9c85b3fcdbed1427a5ad3fca5346a7}{set\_collector\_has\_level}}(\textcolor{keywordtype}{int}\ index,\ \textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{bool}\ flag)\ \{}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{bool}\ any\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00191\ \ \ slot\_collector(index);}
\DoxyCodeLine{00192\ \ \ nassertr(index\ >=\ 0\ \&\&\ index\ <\ (\textcolor{keywordtype}{int})\_collectors.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{if}\ (\_collectors[index].\_is\_level.get\_bit(thread\_index)\ !=\ flag)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ any\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00196\ \ \ \ \ \_collectors[index].\_is\_level.set\_bit\_to(thread\_index,\ flag);}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\ Turning\ this\ on\ for\ a\ given\ collector\ also\ implicitly\ turns\ all\ of\ its}}
\DoxyCodeLine{00200\ \ \ \textcolor{comment}{//\ ancestors.}}
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{if}\ (flag)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ \_collectors[index].\_def;}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{if}\ (def\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ def-\/>\_parent\_index\ !=\ 0)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatClientData_a7f9c85b3fcdbed1427a5ad3fca5346a7}{set\_collector\_has\_level}}(def-\/>\_parent\_index,\ thread\_index,\ flag))\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ any\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ \ \ \ \ \}}
\DoxyCodeLine{00208\ \ \ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keywordflow}{if}\ (any\_changed)\ \{}
\DoxyCodeLine{00211\ \ \ \ \ \_is\_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00212\ \ \ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \textcolor{keywordflow}{return}\ any\_changed;}
\DoxyCodeLine{00215\ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00222\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_acb68b1772c25759dfffd96795a1da39d}{PStatClientData::}}}
\DoxyCodeLine{00223\ \mbox{\hyperlink{classPStatClientData_acb68b1772c25759dfffd96795a1da39d}{get\_collector\_has\_level}}(\textcolor{keywordtype}{int}\ index,\ \textcolor{keywordtype}{int}\ thread\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{return}\ (index\ >=\ 0\ \&\&\ index\ <\ (\textcolor{keywordtype}{int})\_collectors.size()\ \&\&}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \_collectors[index].\_is\_level.get\_bit(thread\_index));}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00232\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_a86cbac0fa6c4d9c66ff2d24f001c3148}{PStatClientData::}}}
\DoxyCodeLine{00233\ \mbox{\hyperlink{classPStatClientData_a86cbac0fa6c4d9c66ff2d24f001c3148}{get\_num\_toplevel\_collectors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordflow}{return}\ \_toplevel\_collectors.size();}
\DoxyCodeLine{00235\ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00242\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_abce44a655ded672baee4aa5b2463169f}{PStatClientData::}}}
\DoxyCodeLine{00243\ \mbox{\hyperlink{classPStatClientData_abce44a655ded672baee4aa5b2463169f}{get\_toplevel\_collector}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00244\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_toplevel\_collectors.size(),\ 0);}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{return}\ \_toplevel\_collectors[n];}
\DoxyCodeLine{00246\ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00251\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_a37f031ee8fbaaa8c139ada02d19a1926}{PStatClientData::}}}
\DoxyCodeLine{00252\ \mbox{\hyperlink{classPStatClientData_a37f031ee8fbaaa8c139ada02d19a1926}{get\_num\_threads}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{return}\ \_threads.size();}
\DoxyCodeLine{00254\ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00261\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_a191b7fe1a56515271c5829d870e48192}{PStatClientData::}}}
\DoxyCodeLine{00262\ \mbox{\hyperlink{classPStatClientData_a191b7fe1a56515271c5829d870e48192}{has\_thread}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{return}\ (index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})index\ <\ \_threads.size()\ \&\&}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ !\_threads[index].\_name.empty());}
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00271\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_afb0b0cf4fd2c24cb2b80da73460be87e}{PStatClientData::}}}
\DoxyCodeLine{00272\ \mbox{\hyperlink{classPStatClientData_afb0b0cf4fd2c24cb2b80da73460be87e}{find\_thread}}(\textcolor{keyword}{const}\ std::string\ \&name)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ index\ =\ 0;\ index\ <\ \mbox{\hyperlink{classPStatClientData_a37f031ee8fbaaa8c139ada02d19a1926}{get\_num\_threads}}();\ ++index)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_threads[index].\_name\ ==\ name)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ index;}
\DoxyCodeLine{00276\ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00280\ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00285\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classPStatClientData_a5b905293fa940d70742612a4ec5a87f6}{PStatClientData::}}}
\DoxyCodeLine{00286\ \mbox{\hyperlink{classPStatClientData_a5b905293fa940d70742612a4ec5a87f6}{get\_thread\_name}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPStatClientData_a191b7fe1a56515271c5829d870e48192}{has\_thread}}(index))\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{00289\ \ \ \}}
\DoxyCodeLine{00290\ \ \ \textcolor{keywordflow}{return}\ \_threads[index].\_name;}
\DoxyCodeLine{00291\ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00297\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatThreadData}{PStatThreadData}}\ *\mbox{\hyperlink{classPStatClientData_a46e69042db6f96f3c5eb00990c904dc8}{PStatClientData::}}}
\DoxyCodeLine{00298\ \mbox{\hyperlink{classPStatClientData_a46e69042db6f96f3c5eb00990c904dc8}{get\_thread\_data}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00299\ \ \ ((\mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *)\textcolor{keyword}{this})-\/>define\_thread(index);}
\DoxyCodeLine{00300\ \ \ nassertr(index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})index\ <\ \_threads.size(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{return}\ \_threads[index].\_data;}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00307\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatClientData_a89692757201f058cddf66a99473caf28}{PStatClientData::}}}
\DoxyCodeLine{00308\ \mbox{\hyperlink{classPStatClientData_a89692757201f058cddf66a99473caf28}{is\_thread\_alive}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{return}\ (index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})index\ <\ \_threads.size()\ \&\&\ \_threads[index].\_is\_alive);}
\DoxyCodeLine{00310\ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00319\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPStatClientData_a041c6be86b8fc43184536d7aa6e86c55}{PStatClientData::}}}
\DoxyCodeLine{00320\ \mbox{\hyperlink{classPStatClientData_a041c6be86b8fc43184536d7aa6e86c55}{get\_child\_distance}}(\textcolor{keywordtype}{int}\ parent,\ \textcolor{keywordtype}{int}\ child)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{if}\ (parent\ ==\ child)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00323\ \ \ \}}
\DoxyCodeLine{00324\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPStatClientData_aa9e2c591cab46b192ff3aa9409e1f681}{has\_collector}}(child)\ ||\ child\ ==\ 0)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00326\ \ \ \}}
\DoxyCodeLine{00327\ \ \ \textcolor{keywordtype}{int}\ dist\ =\ \mbox{\hyperlink{classPStatClientData_a041c6be86b8fc43184536d7aa6e86c55}{get\_child\_distance}}(parent,\ \mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(child).\_parent\_index);}
\DoxyCodeLine{00328\ \ \ \textcolor{keywordflow}{if}\ (dist\ ==\ -\/1)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00330\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{return}\ dist\ +\ 1;}
\DoxyCodeLine{00332\ \ \ \}}
\DoxyCodeLine{00333\ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00342\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_adc484a1e6297b337375838a4029888d5}{PStatClientData::}}}
\DoxyCodeLine{00343\ \mbox{\hyperlink{classPStatClientData_adc484a1e6297b337375838a4029888d5}{add\_collector}}(\mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def)\ \{}
\DoxyCodeLine{00344\ \ \ slot\_collector(def-\/>\_index);}
\DoxyCodeLine{00345\ \ \ nassertv(def-\/>\_index\ >=\ 0\ \&\&\ def-\/>\_index\ <\ (\textcolor{keywordtype}{int})\_collectors.size());}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \textcolor{keywordflow}{if}\ (\_collectors[def-\/>\_index].\_def\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{comment}{//\ Free\ the\ old\ definition,\ if\ any.}}
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keyword}{delete}\ \_collectors[def-\/>\_index].\_def;}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \_collectors[def-\/>\_index].\_def\ =\ def;}
\DoxyCodeLine{00353\ \ \ update\_toplevel\_collectors();}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{comment}{//\ If\ we\ already\ had\ the\ \_is\_level\ flag\ set,\ it\ should\ be\ immediately}}
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//\ applied\ to\ all\ ancestors.}}
\DoxyCodeLine{00357\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&is\_level\ =\ \_collectors[def-\/>\_index].\_is\_level;}
\DoxyCodeLine{00358\ \ \ \textcolor{keywordtype}{int}\ max\_threads\ =\ is\_level.get\_num\_bits();}
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ thread\_index\ =\ 0;\ thread\_index\ <\ max\_threads;\ ++thread\_index)\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_level.get\_bit(thread\_index))\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatClientData_a7f9c85b3fcdbed1427a5ad3fca5346a7}{set\_collector\_has\_level}}(def-\/>\_parent\_index,\ thread\_index,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00362\ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \_is\_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00366\ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00372\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a6cddba5729f0d3dee7e4ee7814f9ca94}{PStatClientData::}}}
\DoxyCodeLine{00373\ \mbox{\hyperlink{classPStatClientData_a6cddba5729f0d3dee7e4ee7814f9ca94}{define\_thread}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{bool}\ mark\_alive)\ \{}
\DoxyCodeLine{00374\ \ \ \textcolor{comment}{//\ A\ sanity\ check\ on\ the\ index\ number.}}
\DoxyCodeLine{00375\ \ \ nassertv(thread\_index\ <\ 1000);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ have\ enough\ slots\ allocated.}}
\DoxyCodeLine{00378\ \ \ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{int})\_threads.size()\ <=\ thread\_index)\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \_threads.push\_back(Thread());}
\DoxyCodeLine{00380\ \ \ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{if}\ (mark\_alive)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \_threads[thread\_index].\_is\_alive\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00384\ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{if}\ (!name.empty())\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \_threads[thread\_index].\_name\ =\ name;}
\DoxyCodeLine{00388\ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \textcolor{keywordflow}{if}\ (\_threads[thread\_index].\_data.is\_null())\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \_threads[thread\_index].\_data\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPStatThreadData}{PStatThreadData}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00392\ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \_is\_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00401\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a4c8bbebf249df21eacccdce352470f78}{PStatClientData::}}}
\DoxyCodeLine{00402\ \mbox{\hyperlink{classPStatClientData_a4c8bbebf249df21eacccdce352470f78}{expire\_thread}}(\textcolor{keywordtype}{int}\ thread\_index)\ \{}
\DoxyCodeLine{00403\ \ \ \textcolor{keywordflow}{if}\ (thread\_index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})thread\_index\ <\ \_threads.size())\ \{}
\DoxyCodeLine{00404\ \ \ \ \ \_threads[thread\_index].\_is\_alive\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00405\ \ \ \}}
\DoxyCodeLine{00406\ \}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00411\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a88cad2831d1328c50cb0c36ad440d328}{PStatClientData::}}}
\DoxyCodeLine{00412\ \mbox{\hyperlink{classPStatClientData_a88cad2831d1328c50cb0c36ad440d328}{remove\_thread}}(\textcolor{keywordtype}{int}\ thread\_index)\ \{}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{if}\ (thread\_index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})thread\_index\ <\ \_threads.size())\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \_threads[thread\_index].\_name.clear();}
\DoxyCodeLine{00415\ \ \ \ \ \_threads[thread\_index].\_data.clear();}
\DoxyCodeLine{00416\ \ \ \ \ \_threads[thread\_index].\_is\_alive\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00427\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a1db4e956c1d75ff608f1f6a0de2cba12}{PStatClientData::}}}
\DoxyCodeLine{00428\ \mbox{\hyperlink{classPStatClientData_a1db4e956c1d75ff608f1f6a0de2cba12}{record\_new\_frame}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number,}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ *frame\_data)\ \{}
\DoxyCodeLine{00430\ \ \ \mbox{\hyperlink{classPStatClientData_a6cddba5729f0d3dee7e4ee7814f9ca94}{define\_thread}}(thread\_index);}
\DoxyCodeLine{00431\ \ \ nassertv(thread\_index\ >=\ 0\ \&\&\ thread\_index\ <\ (\textcolor{keywordtype}{int})\_threads.size());}
\DoxyCodeLine{00432\ \ \ \_threads[thread\_index].\_data-\/>record\_new\_frame(frame\_number,\ frame\_data);}
\DoxyCodeLine{00433\ \ \ \_is\_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00434\ \}}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00440\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a42b5bd4a15022b0f493b414dfb621d20}{PStatClientData::}}}
\DoxyCodeLine{00441\ \mbox{\hyperlink{classPStatClientData_a42b5bd4a15022b0f493b414dfb621d20}{write\_json}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ pid)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00442\ \ \ out\ <<\ \textcolor{stringliteral}{"{}[\(\backslash\)n"{}};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ thread\_index\ =\ 0;\ thread\_index\ <\ \mbox{\hyperlink{classPStatClientData_a37f031ee8fbaaa8c139ada02d19a1926}{get\_num\_threads}}();\ ++thread\_index)\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keyword}{const}\ Thread\ \&thread\ =\ \_threads[thread\_index];}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}thread\_name\(\backslash\)"{},\(\backslash\)"{}ph\(\backslash\)"{}:\(\backslash\)"{}M\(\backslash\)"{},\(\backslash\)"{}pid\(\backslash\)"{}:"{}}\ <<\ pid}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}tid\(\backslash\)"{}:0,\(\backslash\)"{}args\(\backslash\)"{}:\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}Main\(\backslash\)"{}\}\}"{}};}
\DoxyCodeLine{00450\ \ \ \ \ \}}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!thread.\_name.empty())\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ out}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}thread\_name\(\backslash\)"{},\(\backslash\)"{}ph\(\backslash\)"{}:\(\backslash\)"{}M\(\backslash\)"{},\(\backslash\)"{}pid\(\backslash\)"{}:"{}}\ <<\ pid}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}tid\(\backslash\)"{}:"{}}\ <<\ thread\_index\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}args\(\backslash\)"{}:\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}"{}}}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ <<\ thread.\_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\}\}"{}};}
\DoxyCodeLine{00456\ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread.\_data\ ==\ \textcolor{keyword}{nullptr}\ ||\ thread.\_data-\/>is\_empty())\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00459\ \ \ \ \ \}}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keywordtype}{int}\ first\_frame\ =\ thread.\_data-\/>get\_oldest\_frame\_number();}
\DoxyCodeLine{00462\ \ \ \ \ \textcolor{keywordtype}{int}\ last\_frame\ =\ thread.\_data-\/>get\_latest\_frame\_number();}
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ frame\_number\ =\ first\_frame;\ frame\_number\ <=\ last\_frame;\ ++frame\_number)\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ \&frame\_data\ =\ thread.\_data-\/>get\_frame(frame\_number);}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_events\ =\ frame\_data.get\_num\_events();}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_events;\ ++i)\ \{}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ frame\_data.get\_time\_collector(i);}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ out}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)n\{\(\backslash\)"{}name\(\backslash\)"{}:\(\backslash\)"{}"{}}\ <<\ \mbox{\hyperlink{classPStatClientData_a108bc9bffd81beda32f1c783860d2366}{get\_collector\_fullname}}(collector\_index)}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\(\backslash\)"{}ts\(\backslash\)"{}:"{}}\ <<\ (uint64\_t)(frame\_data.get\_time(i)\ *\ 1000000)}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}ph\(\backslash\)"{}:\(\backslash\)"{}"{}}\ <<\ (frame\_data.is\_start(i)\ ?\ \textcolor{charliteral}{'B'}\ :\ \textcolor{charliteral}{'E'})\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}pid\(\backslash\)"{}:"{}}\ <<\ pid\ <<\ \textcolor{stringliteral}{"{},\(\backslash\)"{}tid\(\backslash\)"{}:"{}}\ <<\ thread\_index\ <<\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \}}
\DoxyCodeLine{00475\ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n]\(\backslash\)n"{}};}
\DoxyCodeLine{00478\ \ \ out.flush();}
\DoxyCodeLine{00479\ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00484\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a25d2cfdc136af4dff76ea68e06d8c9f2}{PStatClientData::}}}
\DoxyCodeLine{00485\ \mbox{\hyperlink{classPStatClientData_a25d2cfdc136af4dff76ea68e06d8c9f2}{write\_datagram}}(\mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ Collector\ \&collector\ :\ \_collectors)\ \{}
\DoxyCodeLine{00487\ \ \ \ \ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ collector.\_def;}
\DoxyCodeLine{00488\ \ \ \ \ \textcolor{keywordflow}{if}\ (def\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ def-\/>\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{00489\ \ \ \ \ \ \ def-\/>\mbox{\hyperlink{classPStatCollectorDef_ad575a07b9efdee643fd25797dd55de65}{write\_datagram}}(dg);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ collector.\_is\_level.write\_datagram(\textcolor{keyword}{nullptr},\ dg);}
\DoxyCodeLine{00491\ \ \ \ \ \}}
\DoxyCodeLine{00492\ \ \ \}}
\DoxyCodeLine{00493\ \ \ dg.add\_int16(-\/1);}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keywordtype}{int}\ thread\_index\ =\ 0;}
\DoxyCodeLine{00496\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ Thread\ \&thread\ :\ \_threads)\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread.\_data\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ dg.add\_int16(thread\_index);}
\DoxyCodeLine{00499\ \ \ \ \ \ \ dg.add\_string(thread.\_name);}
\DoxyCodeLine{00500\ \ \ \ \ \ \ thread.\_data-\/>write\_datagram(dg);}
\DoxyCodeLine{00501\ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ ++thread\_index;}
\DoxyCodeLine{00503\ \ \ \}}
\DoxyCodeLine{00504\ \ \ dg.add\_int16(-\/1);}
\DoxyCodeLine{00505\ \}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00510\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatClientData_a901859be1059a8ce96dbed1911d5a016}{PStatClientData::}}}
\DoxyCodeLine{00511\ \mbox{\hyperlink{classPStatClientData_a901859be1059a8ce96dbed1911d5a016}{read\_datagram}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan)\ \{}
\DoxyCodeLine{00512\ \ \ \textcolor{keywordflow}{while}\ (scan.peek\_int16()\ !=\ -\/1)\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}};}
\DoxyCodeLine{00514\ \ \ \ \ def-\/>\mbox{\hyperlink{classPStatCollectorDef_a0840466db17b0f2183833c2719352c67}{read\_datagram}}(scan);}
\DoxyCodeLine{00515\ \ \ \ \ \mbox{\hyperlink{classPStatClientData_adc484a1e6297b337375838a4029888d5}{add\_collector}}(def);}
\DoxyCodeLine{00516\ \ \ \ \ \_collectors[def-\/>\_index].\_is\_level.read\_datagram(scan,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00517\ \ \ \}}
\DoxyCodeLine{00518\ \ \ scan.skip\_bytes(2);}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \textcolor{keywordtype}{int}\ thread\_index;}
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{while}\ ((thread\_index\ =\ scan.get\_int16())\ !=\ -\/1)\ \{}
\DoxyCodeLine{00522\ \ \ \ \ std::string\ name\ =\ scan.\mbox{\hyperlink{classDatagramIterator_aa5b2810c1b772f83e744fed70bb313ea}{get\_string}}();}
\DoxyCodeLine{00523\ \ \ \ \ \mbox{\hyperlink{classPStatClientData_a6cddba5729f0d3dee7e4ee7814f9ca94}{define\_thread}}(thread\_index,\ name,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \ \ \_threads[thread\_index].\_data-\/>read\_datagram(scan,\ \textcolor{keyword}{this});}
\DoxyCodeLine{00526\ \ \ \}}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ update\_toplevel\_collectors();}
\DoxyCodeLine{00529\ \}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00535\ \textcolor{keywordtype}{void}\ PStatClientData::}
\DoxyCodeLine{00536\ slot\_collector(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00537\ \ \ \textcolor{comment}{//\ A\ sanity\ check\ on\ the\ index\ number.}}
\DoxyCodeLine{00538\ \ \ nassertv(collector\_index\ <\ 100000);}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{int})\_collectors.size()\ <=\ collector\_index)\ \{}
\DoxyCodeLine{00541\ \ \ \ \ Collector\ collector;}
\DoxyCodeLine{00542\ \ \ \ \ collector.\_def\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00543\ \ \ \ \ \_collectors.push\_back(collector);}
\DoxyCodeLine{00544\ \ \ \}}
\DoxyCodeLine{00545\ \}}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00550\ \textcolor{keywordtype}{void}\ PStatClientData::}
\DoxyCodeLine{00551\ update\_toplevel\_collectors()\ \{}
\DoxyCodeLine{00552\ \ \ \_toplevel\_collectors.clear();}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \textcolor{keywordflow}{for}\ (Collector\ \&collector\ :\ \_collectors)\ \{}
\DoxyCodeLine{00555\ \ \ \ \ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ *def\ =\ collector.\_def;}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{if}\ (def\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ def-\/>\_parent\_index\ ==\ 0)\ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \_toplevel\_collectors.push\_back(def-\/>\_index);}
\DoxyCodeLine{00558\ \ \ \ \ \}}
\DoxyCodeLine{00559\ \ \ \}}
\DoxyCodeLine{00560\ \}}

\end{DoxyCode}
