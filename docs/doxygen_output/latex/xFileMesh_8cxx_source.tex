\doxysection{x\+File\+Mesh.\+cxx}
\hypertarget{xFileMesh_8cxx_source}{}\label{xFileMesh_8cxx_source}\index{pandatool/src/xfileegg/xFileMesh.cxx@{pandatool/src/xfileegg/xFileMesh.cxx}}
\mbox{\hyperlink{xFileMesh_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileMesh_8h}{xFileMesh.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileToEggConverter_8h}{xFileToEggConverter.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileFace_8h}{xFileFace.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileVertex_8h}{xFileVertex.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileNormal_8h}{xFileNormal.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileMaterial_8h}{xFileMaterial.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileDataNode_8h}{xFileDataNode.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__xfile_8h}{config\_xfile.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggVertexPool_8h}{eggVertexPool.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggVertex_8h}{eggVertex.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggPolygon_8h}{eggPolygon.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggGroup_8h}{eggGroup.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggGroupNode_8h}{eggGroupNode.h}}"{}}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00030\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ XFileMesh::}
\DoxyCodeLine{00036\ XFileMesh(CoordinateSystem\ cs)\ :\ \_cs(cs)\ \{}
\DoxyCodeLine{00037\ \ \ \_has\_normals\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00038\ \ \ \_has\_colors\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00039\ \ \ \_has\_uvs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00040\ \ \ \_has\_materials\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00041\ \ \ \_egg\_parent\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00047\ XFileMesh::}
\DoxyCodeLine{00048\ \string~XFileMesh()\ \{}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{classXFileMesh_a1c39fb60a4b4132ede7a4ef919a6507c}{clear}}();}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00055\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileMesh_a1c39fb60a4b4132ede7a4ef919a6507c}{XFileMesh::}}}
\DoxyCodeLine{00056\ \mbox{\hyperlink{classXFileMesh_a1c39fb60a4b4132ede7a4ef919a6507c}{clear}}()\ \{}
\DoxyCodeLine{00057\ \ \ Vertices::iterator\ vi;}
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{delete}\ vertex;}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ \ \ Normals::iterator\ ni;}
\DoxyCodeLine{00063\ \ \ \textcolor{keywordflow}{for}\ (ni\ =\ \_normals.begin();\ ni\ !=\ \_normals.end();\ ++ni)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ \mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal\ =\ (*ni);}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keyword}{delete}\ normal;}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ \ \ Materials::iterator\ mi;}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{for}\ (mi\ =\ \_materials.begin();\ mi\ !=\ \_materials.end();\ ++mi)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material\ =\ (*mi);}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keyword}{delete}\ material;}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ \ \ Faces::iterator\ fi;}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ \_faces.begin();\ fi\ !=\ \_faces.end();\ ++fi)\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ (*fi);}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keyword}{delete}\ face;}
\DoxyCodeLine{00076\ \ \ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \_vertices.clear();}
\DoxyCodeLine{00079\ \ \ \_normals.clear();}
\DoxyCodeLine{00080\ \ \ \_materials.clear();}
\DoxyCodeLine{00081\ \ \ \_faces.clear();}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \_unique\_vertices.clear();}
\DoxyCodeLine{00084\ \ \ \_unique\_normals.clear();}
\DoxyCodeLine{00085\ \ \ \_unique\_materials.clear();}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \_has\_normals\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00088\ \ \ \_has\_colors\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00089\ \ \ \_has\_uvs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00090\ \ \ \_has\_materials\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00096\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileMesh_aaa6504d33b6c6cc867cd42525ef8a515}{XFileMesh::}}}
\DoxyCodeLine{00097\ \mbox{\hyperlink{classXFileMesh_aaa6504d33b6c6cc867cd42525ef8a515}{add\_polygon}}(\mbox{\hyperlink{classEggPolygon}{EggPolygon}}\ *egg\_poly)\ \{}
\DoxyCodeLine{00098\ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileFace}{XFileFace}};}
\DoxyCodeLine{00099\ \ \ face-\/>\mbox{\hyperlink{classXFileFace_a5fbe5d3821b1386b4c255cd19bf1e865}{set\_from\_egg}}(\textcolor{keyword}{this},\ egg\_poly);}
\DoxyCodeLine{00100\ \ \ \_faces.push\_back(face);}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00107\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_a42d19fbd826b5520081a1d975bcaae73}{XFileMesh::}}}
\DoxyCodeLine{00108\ \mbox{\hyperlink{classXFileMesh_a42d19fbd826b5520081a1d975bcaae73}{add\_vertex}}(\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *egg\_vertex,\ \mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *egg\_prim)\ \{}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_vertices.size();}
\DoxyCodeLine{00110\ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileVertex}{XFileVertex}};}
\DoxyCodeLine{00111\ \ \ vertex-\/>\mbox{\hyperlink{classXFileVertex_a32431032adaab715d03dd10bc952c233}{set\_from\_egg}}(egg\_vertex,\ egg\_prim);}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_color)\ \{}
\DoxyCodeLine{00113\ \ \ \ \ \_has\_colors\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00114\ \ \ \}}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_uv)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \_has\_uvs\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ std::pair<UniqueVertices::iterator,\ bool>\ result\ =}
\DoxyCodeLine{00120\ \ \ \ \ \_unique\_vertices.insert(UniqueVertices::value\_type(vertex,\ next\_index));}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordflow}{if}\ (result.second)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \textcolor{comment}{//\ Successfully\ added;\ this\ is\ a\ new\ vertex.}}
\DoxyCodeLine{00124\ \ \ \ \ \_vertices.push\_back(vertex);}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00126\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ Not\ successfully\ added;\ there\ is\ already\ a\ vertex\ with\ these}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ properties.\ \ Return\ that\ one\ instead.}}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keyword}{delete}\ vertex;}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{return}\ (*result.first).second;}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00139\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_a5172a89c62ce42535a4a9a36af060b7c}{XFileMesh::}}}
\DoxyCodeLine{00140\ \mbox{\hyperlink{classXFileMesh_a5172a89c62ce42535a4a9a36af060b7c}{add\_normal}}(\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *egg\_vertex,\ \mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *egg\_prim)\ \{}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_normals.size();}
\DoxyCodeLine{00142\ \ \ \mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileNormal}{XFileNormal}};}
\DoxyCodeLine{00143\ \ \ normal-\/>\mbox{\hyperlink{classXFileNormal_abda7e3cf0f15b3af06311136c2776288}{set\_from\_egg}}(egg\_vertex,\ egg\_prim);}
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (normal-\/>\_has\_normal)\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \_has\_normals\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00146\ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ std::pair<UniqueNormals::iterator,\ bool>\ result\ =}
\DoxyCodeLine{00149\ \ \ \ \ \_unique\_normals.insert(UniqueNormals::value\_type(normal,\ next\_index));}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{if}\ (result.second)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ Successfully\ added;\ this\ is\ a\ new\ normal.}}
\DoxyCodeLine{00153\ \ \ \ \ \_normals.push\_back(normal);}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00155\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//\ Not\ successfully\ added;\ there\ is\ already\ a\ normal\ with\ these}}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{comment}{//\ properties.\ \ Return\ that\ one\ instead.}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keyword}{delete}\ normal;}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{return}\ (*result.first).second;}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00167\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_aec4585a43544f795236449e006a48690}{XFileMesh::}}}
\DoxyCodeLine{00168\ \mbox{\hyperlink{classXFileMesh_aec4585a43544f795236449e006a48690}{add\_material}}(\mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *egg\_prim)\ \{}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_materials.size();}
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}};}
\DoxyCodeLine{00171\ \ \ material-\/>\mbox{\hyperlink{classXFileMaterial_a3b20b49eac3f6d0d26ab8172d8785562}{set\_from\_egg}}(egg\_prim);}
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (material-\/>\mbox{\hyperlink{classXFileMaterial_a27c476fc3362b2ca498c42338ecc8785}{has\_material}}())\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \_has\_materials\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ std::pair<UniqueMaterials::iterator,\ bool>\ result\ =}
\DoxyCodeLine{00177\ \ \ \ \ \_unique\_materials.insert(UniqueMaterials::value\_type(material,\ next\_index));}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{if}\ (result.second)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{comment}{//\ Successfully\ added;\ this\ is\ a\ new\ material.}}
\DoxyCodeLine{00181\ \ \ \ \ \_materials.push\_back(material);}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00183\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ Not\ successfully\ added;\ there\ is\ already\ a\ material\ with\ these}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{comment}{//\ properties.\ \ Return\ that\ one\ instead.}}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keyword}{delete}\ material;}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{return}\ (*result.first).second;}
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00197\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_a42d19fbd826b5520081a1d975bcaae73}{XFileMesh::}}}
\DoxyCodeLine{00198\ \mbox{\hyperlink{classXFileMesh_a42d19fbd826b5520081a1d975bcaae73}{add\_vertex}}(\mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex)\ \{}
\DoxyCodeLine{00199\ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_color)\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \_has\_colors\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00201\ \ \ \}}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_uv)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \_has\_uvs\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00204\ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_vertices.size();}
\DoxyCodeLine{00207\ \ \ \_unique\_vertices.insert(UniqueVertices::value\_type(vertex,\ next\_index));}
\DoxyCodeLine{00208\ \ \ \_vertices.push\_back(vertex);}
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00210\ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00217\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_a5172a89c62ce42535a4a9a36af060b7c}{XFileMesh::}}}
\DoxyCodeLine{00218\ \mbox{\hyperlink{classXFileMesh_a5172a89c62ce42535a4a9a36af060b7c}{add\_normal}}(\mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal)\ \{}
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{if}\ (normal-\/>\_has\_normal)\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \_has\_normals\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_normals.size();}
\DoxyCodeLine{00224\ \ \ \_unique\_normals.insert(UniqueNormals::value\_type(normal,\ next\_index));}
\DoxyCodeLine{00225\ \ \ \_normals.push\_back(normal);}
\DoxyCodeLine{00226\ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00227\ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00234\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_aec4585a43544f795236449e006a48690}{XFileMesh::}}}
\DoxyCodeLine{00235\ \mbox{\hyperlink{classXFileMesh_aec4585a43544f795236449e006a48690}{add\_material}}(\mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material)\ \{}
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{if}\ (material-\/>\mbox{\hyperlink{classXFileMaterial_a27c476fc3362b2ca498c42338ecc8785}{has\_material}}())\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \_has\_materials\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00238\ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordtype}{int}\ next\_index\ =\ \_materials.size();}
\DoxyCodeLine{00241\ \ \ \_unique\_materials.insert(UniqueMaterials::value\_type(material,\ next\_index));}
\DoxyCodeLine{00242\ \ \ \_materials.push\_back(material);}
\DoxyCodeLine{00243\ \ \ \textcolor{keywordflow}{return}\ next\_index;}
\DoxyCodeLine{00244\ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00250\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileMesh_abab940869978d94c4c0b03d55eb1d6ce}{XFileMesh::}}}
\DoxyCodeLine{00251\ \mbox{\hyperlink{classXFileMesh_abab940869978d94c4c0b03d55eb1d6ce}{set\_egg\_parent}}(\mbox{\hyperlink{classEggGroupNode}{EggGroupNode}}\ *egg\_parent)\ \{}
\DoxyCodeLine{00252\ \ \ \textcolor{comment}{//\ We\ actually\ put\ the\ mesh\ under\ its\ own\ group.}}
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{classEggGroup}{EggGroup}}\ *egg\_group\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggGroup}{EggGroup}}(get\_name());}
\DoxyCodeLine{00254\ \ \ egg\_parent-\/>\mbox{\hyperlink{classEggGroupNode_a5ddaeb0aa17a0740e0ce94586f862625}{add\_child}}(egg\_group);}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \_egg\_parent\ =\ egg\_group;}
\DoxyCodeLine{00257\ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00263\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_ab5389da74c521e05236443a40cc8d481}{XFileMesh::}}}
\DoxyCodeLine{00264\ \mbox{\hyperlink{classXFileMesh_ab5389da74c521e05236443a40cc8d481}{create\_polygons}}(\mbox{\hyperlink{classXFileToEggConverter}{XFileToEggConverter}}\ *converter)\ \{}
\DoxyCodeLine{00265\ \ \ nassertr(\_egg\_parent\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vpool\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}(get\_name());}
\DoxyCodeLine{00268\ \ \ \_egg\_parent-\/>\mbox{\hyperlink{classEggGroupNode_a5ddaeb0aa17a0740e0ce94586f862625}{add\_child}}(vpool);}
\DoxyCodeLine{00269\ \ \ Faces::const\_iterator\ fi;}
\DoxyCodeLine{00270\ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ \_faces.begin();\ fi\ !=\ \_faces.end();\ ++fi)\ \{}
\DoxyCodeLine{00271\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ (*fi);}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \mbox{\hyperlink{classEggPolygon}{EggPolygon}}\ *egg\_poly\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggPolygon}{EggPolygon}};}
\DoxyCodeLine{00274\ \ \ \ \ \_egg\_parent-\/>\mbox{\hyperlink{classEggGroupNode_a5ddaeb0aa17a0740e0ce94586f862625}{add\_child}}(egg\_poly);}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{comment}{//\ Set\ up\ the\ vertices\ for\ the\ polygon.}}
\DoxyCodeLine{00277\ \ \ \ \ XFileFace::Vertices::reverse\_iterator\ vi;}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ face-\/>\_vertices.rbegin();\ vi\ !=\ face-\/>\_vertices.rend();\ ++vi)\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ vertex\_index\ =\ (*vi).\_vertex\_index;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ normal\_index\ =\ (*vi).\_normal\_index;}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex\_index\ <\ 0\ ||\ vertex\_index\ >=\ (\textcolor{keywordtype}{int})\_vertices.size())\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Vertex\ index\ out\ of\ range\ in\ Mesh\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ \_vertices[vertex\_index];}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (normal\_index\ >=\ 0\ \&\&\ normal\_index\ <\ (\textcolor{keywordtype}{int})\_normals.size())\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ normal\ =\ \_normals[normal\_index];}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ a\ temporary\ EggVertex\ before\ adding\ it\ to\ the\ pool.}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ temp\_vtx;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ temp\_vtx.set\_external\_index(vertex\_index);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ temp\_vtx.set\_pos(vertex-\/>\_point);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_color)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ temp\_vtx.set\_color(vertex-\/>\_color);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\_has\_uv)\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ LTexCoordd\ uv\ =\ vertex-\/>\_uv;}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Windows\ draws\ the\ UV's\ upside-\/down.}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ uv[1]\ =\ 1.0\ -\/\ uv[1];}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ temp\_vtx.set\_uv(uv);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (normal\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ normal-\/>\_has\_normal)\ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ temp\_vtx.set\_normal(normal-\/>\_normal);}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ are\ given\ the\ vertex\ in\ local\ space;\ we\ need\ to\ transform\ it\ into}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \textcolor{comment}{//\ global\ space.\ \ If\ the\ vertex\ has\ been\ skinned,\ that\ means\ the\ global}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \textcolor{comment}{//\ space\ of\ all\ of\ its\ joints\ (modified\ by\ the\ matrix\_offset\ provided\ in}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ skinning\ data).}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ net\_weight\ =\ 0.0;}
\DoxyCodeLine{00316\ \ \ \ \ \ \ LMatrix4d\ weighted\_transform(0.0,\ 0.0,\ 0.0,\ 0.0,}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0,\ 0.0,\ 0.0,\ 0.0,}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0,\ 0.0,\ 0.0,\ 0.0,}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0,\ 0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{00320\ \ \ \ \ \ \ SkinWeights::const\_iterator\ swi;}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (swi\ =\ \_skin\_weights.begin();\ swi\ !=\ \_skin\_weights.end();\ ++swi)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ SkinWeightsData\ \&data\ =\ (*swi);}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ WeightMap::const\_iterator\ wmi\ =\ data.\_weight\_map.find(vertex\_index);}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wmi\ !=\ data.\_weight\_map.end())\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggGroup}{EggGroup}}\ *joint\ =\ converter-\/>\mbox{\hyperlink{classXFileToEggConverter_adb404271163ba5a110e45a21a05c46db}{find\_joint}}(data.\_joint\_name);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (joint\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ (*wmi).second;}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ LMatrix4d\ mat\ =\ data.\_matrix\_offset;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ mat\ *=\ joint-\/>get\_node\_to\_vertex();}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ weighted\_transform\ +=\ mat\ *\ weight;}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ net\_weight\ +=\ weight;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (net\_weight\ ==\ 0.0)\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vertex\ had\ no\ joint\ membership.\ \ Transform\ it\ into\ the}}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ appropriate\ (global)\ space\ based\ on\ its\ parent.}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ temp\_vtx.\mbox{\hyperlink{classEggVertex_a67cbffa9ee6d029b940f1381df434f8f}{transform}}(\_egg\_parent-\/>get\_node\_to\_vertex());}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vertex\ was\ skinned\ into\ one\ or\ more\ joints.\ \ Therefore,}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ it\ according\ to\ the\ blended\ matrix\_offset\ from\ the}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ skinning\ data.}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ weighted\_transform\ /=\ net\_weight;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ temp\_vtx.\mbox{\hyperlink{classEggVertex_a67cbffa9ee6d029b940f1381df434f8f}{transform}}(weighted\_transform);}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ get\ a\ real\ EggVertex\ matching\ our\ template.}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *egg\_vtx\ =\ vpool-\/>\mbox{\hyperlink{classEggVertexPool_ad97205a36cd20f80a025f18ee956a0cc}{create\_unique\_vertex}}(temp\_vtx);}
\DoxyCodeLine{00351\ \ \ \ \ \ \ egg\_poly-\/>\mbox{\hyperlink{classEggPrimitive_a77bb4e987b18a54bbabfc068a325506a}{add\_vertex}}(egg\_vtx);}
\DoxyCodeLine{00352\ \ \ \ \ \}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{comment}{//\ And\ apply\ the\ material\ for\ the\ polygon.}}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordtype}{int}\ material\_index\ =\ face-\/>\_material\_index;}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{if}\ (material\_index\ >=\ 0\ \&\&\ material\_index\ <\ (\textcolor{keywordtype}{int})\_materials.size())\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material\ =\ \_materials[material\_index];}
\DoxyCodeLine{00358\ \ \ \ \ \ \ material-\/>\mbox{\hyperlink{classXFileMaterial_a224a7f910c37d7e5780dc9eb41cbd504}{apply\_to\_egg}}(egg\_poly,\ converter);}
\DoxyCodeLine{00359\ \ \ \ \ \}}
\DoxyCodeLine{00360\ \ \ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00362\ \ \ \textcolor{comment}{//\ Now\ go\ through\ all\ of\ the\ vertices\ and\ skin\ them\ up.}}
\DoxyCodeLine{00363\ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{EggVertexPool::iterator}}\ vi;}
\DoxyCodeLine{00364\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ vpool-\/>\mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ vi\ !=\ vpool-\/>\mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++vi)\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *egg\_vtx\ =\ (*vi);}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordtype}{int}\ vertex\_index\ =\ egg\_vtx-\/>get\_external\_index();}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ SkinWeights::const\_iterator\ swi;}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keywordflow}{for}\ (swi\ =\ \_skin\_weights.begin();\ swi\ !=\ \_skin\_weights.end();\ ++swi)\ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \textcolor{keyword}{const}\ SkinWeightsData\ \&data\ =\ (*swi);}
\DoxyCodeLine{00371\ \ \ \ \ \ \ WeightMap::const\_iterator\ wmi\ =\ data.\_weight\_map.find(vertex\_index);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (wmi\ !=\ data.\_weight\_map.end())\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggGroup}{EggGroup}}\ *joint\ =\ converter-\/>\mbox{\hyperlink{classXFileToEggConverter_adb404271163ba5a110e45a21a05c46db}{find\_joint}}(data.\_joint\_name);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (joint\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ (*wmi).second;}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ joint-\/>ref\_vertex(egg\_vtx,\ weight);}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00379\ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_aee8ada10a0b555694e904fe77c04fc97}{has\_normals}}())\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{comment}{//\ If\ we\ don't\ have\ explicit\ normals,\ make\ some\ up,\ per\ the\ DX\ spec.}}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{comment}{//\ Since\ the\ DX\ spec\ doesn't\ mention\ anything\ about\ a\ crease\ angle,\ we}}
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{comment}{//\ should\ be\ as\ generous\ as\ possible.}}
\DoxyCodeLine{00386\ \ \ \ \ \_egg\_parent-\/>\mbox{\hyperlink{classEggGroupNode_ac43cece85cae9941ab62642376961cb1}{recompute\_vertex\_normals}}(180.0,\ \_cs);}
\DoxyCodeLine{00387\ \ \ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00390\ \}}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00396\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_aee8ada10a0b555694e904fe77c04fc97}{XFileMesh::}}}
\DoxyCodeLine{00397\ \mbox{\hyperlink{classXFileMesh_aee8ada10a0b555694e904fe77c04fc97}{has\_normals}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00398\ \ \ \textcolor{keywordflow}{return}\ \_has\_normals;}
\DoxyCodeLine{00399\ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00405\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_ac7e9b588bde1d238a3b10cb6159d0f15}{XFileMesh::}}}
\DoxyCodeLine{00406\ \mbox{\hyperlink{classXFileMesh_ac7e9b588bde1d238a3b10cb6159d0f15}{has\_colors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00407\ \ \ \textcolor{keywordflow}{return}\ \_has\_colors;}
\DoxyCodeLine{00408\ \}}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00414\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a3e635fba99a3c64cb7275f68619b5054}{XFileMesh::}}}
\DoxyCodeLine{00415\ \mbox{\hyperlink{classXFileMesh_a3e635fba99a3c64cb7275f68619b5054}{has\_uvs}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{return}\ \_has\_uvs;}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00423\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a4366ba5181147d5cb3061d3de3f73ce0}{XFileMesh::}}}
\DoxyCodeLine{00424\ \mbox{\hyperlink{classXFileMesh_a4366ba5181147d5cb3061d3de3f73ce0}{has\_materials}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00425\ \ \ \textcolor{keywordflow}{return}\ \_has\_materials;}
\DoxyCodeLine{00426\ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00431\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileMesh_a4dae322b9b84abfaa6f2fffe9804da35}{XFileMesh::}}}
\DoxyCodeLine{00432\ \mbox{\hyperlink{classXFileMesh_a4dae322b9b84abfaa6f2fffe9804da35}{get\_num\_materials}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{return}\ \_materials.size();}
\DoxyCodeLine{00434\ \}}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00439\ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *\mbox{\hyperlink{classXFileMesh_ae8cb11fd3ccec4403f4b090da236109d}{XFileMesh::}}}
\DoxyCodeLine{00440\ \mbox{\hyperlink{classXFileMesh_ae8cb11fd3ccec4403f4b090da236109d}{get\_material}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00441\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_materials.size(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00442\ \ \ \textcolor{keywordflow}{return}\ \_materials[n];}
\DoxyCodeLine{00443\ \}}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00448\ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *\mbox{\hyperlink{classXFileMesh_a46a3f74f23a30a80efa8dcd2e0baa12f}{XFileMesh::}}}
\DoxyCodeLine{00449\ \mbox{\hyperlink{classXFileMesh_a46a3f74f23a30a80efa8dcd2e0baa12f}{make\_x\_mesh}}(\mbox{\hyperlink{classXFileNode}{XFileNode}}\ *x\_parent,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&suffix)\ \{}
\DoxyCodeLine{00450\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *x\_mesh\ =\ x\_parent-\/>\mbox{\hyperlink{classXFileNode_ae2ee7f10e82e409163db74b1ba6751ee}{add\_Mesh}}(\textcolor{stringliteral}{"{}mesh"{}}\ +\ suffix);}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \textcolor{comment}{//\ First,\ fill\ in\ the\ table\ of\ vertices.}}
\DoxyCodeLine{00453\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_vertices\ =\ (*x\_mesh)[\textcolor{stringliteral}{"{}vertices"{}}];}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ Vertices::const\_iterator\ vi;}
\DoxyCodeLine{00456\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{00457\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{00458\ \ \ \ \ x\_vertices.\mbox{\hyperlink{classXFileDataObject_a8506ad4fe5361d015d5c43a860f17736}{add\_Vector}}(x\_mesh-\/>get\_x\_file(),\ vertex-\/>\_point);}
\DoxyCodeLine{00459\ \ \ \}}
\DoxyCodeLine{00460\ \ \ (*x\_mesh)[\textcolor{stringliteral}{"{}nVertices"{}}]\ =\ x\_vertices.size();}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \textcolor{comment}{//\ Then,\ create\ the\ list\ of\ faces\ that\ index\ into\ the\ above\ vertices.}}
\DoxyCodeLine{00463\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_faces\ =\ (*x\_mesh)[\textcolor{stringliteral}{"{}faces"{}}];}
\DoxyCodeLine{00464\ \ \ Faces::const\_iterator\ fi;}
\DoxyCodeLine{00465\ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ \_faces.begin();\ fi\ !=\ \_faces.end();\ ++fi)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ (*fi);}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_mesh\_face\ =\ x\_faces.\mbox{\hyperlink{classXFileDataObject_a53f2bb66bd0bf57105d6e2a7e2af9bea}{add\_MeshFace}}(x\_mesh-\/>get\_x\_file());}
\DoxyCodeLine{00469\ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_faceVertexIndices\ =\ x\_mesh\_face[\textcolor{stringliteral}{"{}faceVertexIndices"{}}];}
\DoxyCodeLine{00470\ \ \ \ \ XFileFace::Vertices::const\_iterator\ fvi;}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordflow}{for}\ (fvi\ =\ face-\/>\_vertices.begin();}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ fvi\ !=\ face-\/>\_vertices.end();}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ ++fvi)\ \{}
\DoxyCodeLine{00474\ \ \ \ \ \ \ x\_faceVertexIndices.\mbox{\hyperlink{classXFileDataObject_a15b9a32ba5ff0ada2a9fa5dfe13c90ed}{add\_int}}((*fvi).\_vertex\_index);}
\DoxyCodeLine{00475\ \ \ \ \ \}}
\DoxyCodeLine{00476\ \ \ \ \ x\_mesh\_face[\textcolor{stringliteral}{"{}nFaceVertexIndices"{}}]\ =\ x\_faceVertexIndices.size();}
\DoxyCodeLine{00477\ \ \ \}}
\DoxyCodeLine{00478\ \ \ (*x\_mesh)[\textcolor{stringliteral}{"{}nFaces"{}}]\ =\ x\_faces.size();}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \textcolor{comment}{//\ Now,\ add\ in\ any\ supplemental\ data.}}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classXFileMesh_aee8ada10a0b555694e904fe77c04fc97}{has\_normals}}())\ \{}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{comment}{//\ Tack\ on\ normals.}}
\DoxyCodeLine{00484\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_acc39f2dc0a74c129c7ad4746798330d0}{make\_x\_normals}}(x\_mesh,\ suffix);}
\DoxyCodeLine{00485\ \ \ \}}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classXFileMesh_ac7e9b588bde1d238a3b10cb6159d0f15}{has\_colors}}())\ \{}
\DoxyCodeLine{00487\ \ \ \ \ \textcolor{comment}{//\ Tack\ on\ colors.}}
\DoxyCodeLine{00488\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_aa590cc8f2396a892fb5042fb9b35afec}{make\_x\_colors}}(x\_mesh,\ suffix);}
\DoxyCodeLine{00489\ \ \ \}}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classXFileMesh_a3e635fba99a3c64cb7275f68619b5054}{has\_uvs}}())\ \{}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{comment}{//\ Tack\ on\ uvs.}}
\DoxyCodeLine{00492\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_ac3b68eb452b9a5d7152d5660bbfc0679}{make\_x\_uvs}}(x\_mesh,\ suffix);}
\DoxyCodeLine{00493\ \ \ \}}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classXFileMesh_a4366ba5181147d5cb3061d3de3f73ce0}{has\_materials}}())\ \{}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{comment}{//\ Tack\ on\ materials.}}
\DoxyCodeLine{00496\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_aa1913ec2fb382a42dac8997678b7f266}{make\_x\_material\_list}}(x\_mesh,\ suffix);}
\DoxyCodeLine{00497\ \ \ \}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \textcolor{keywordflow}{return}\ x\_mesh;}
\DoxyCodeLine{00500\ \}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00505\ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *\mbox{\hyperlink{classXFileMesh_acc39f2dc0a74c129c7ad4746798330d0}{XFileMesh::}}}
\DoxyCodeLine{00506\ \mbox{\hyperlink{classXFileMesh_acc39f2dc0a74c129c7ad4746798330d0}{make\_x\_normals}}(\mbox{\hyperlink{classXFileNode}{XFileNode}}\ *x\_mesh,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&suffix)\ \{}
\DoxyCodeLine{00507\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *x\_meshNormals\ =\ x\_mesh-\/>\mbox{\hyperlink{classXFileNode_a5ae06f642897cd5ea6c63dff517b7403}{add\_MeshNormals}}(\textcolor{stringliteral}{"{}norms"{}}\ +\ suffix);}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_normals\ =\ (*x\_meshNormals)[\textcolor{stringliteral}{"{}normals"{}}];}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ Normals::const\_iterator\ ni;}
\DoxyCodeLine{00512\ \ \ \textcolor{keywordflow}{for}\ (ni\ =\ \_normals.begin();\ ni\ !=\ \_normals.end();\ ++ni)\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal\ =\ (*ni);}
\DoxyCodeLine{00514\ \ \ \ \ x\_normals.\mbox{\hyperlink{classXFileDataObject_a8506ad4fe5361d015d5c43a860f17736}{add\_Vector}}(x\_mesh-\/>get\_x\_file(),\ normal-\/>\_normal);}
\DoxyCodeLine{00515\ \ \ \}}
\DoxyCodeLine{00516\ \ \ (*x\_meshNormals)[\textcolor{stringliteral}{"{}nNormals"{}}]\ =\ x\_normals.size();}
\DoxyCodeLine{00517\ }
\DoxyCodeLine{00518\ \ \ \textcolor{comment}{//\ Then,\ create\ the\ list\ of\ faces\ that\ index\ into\ the\ above\ normals.}}
\DoxyCodeLine{00519\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_faces\ =\ (*x\_meshNormals)[\textcolor{stringliteral}{"{}faceNormals"{}}];}
\DoxyCodeLine{00520\ \ \ Faces::const\_iterator\ fi;}
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ \_faces.begin();\ fi\ !=\ \_faces.end();\ ++fi)\ \{}
\DoxyCodeLine{00522\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ (*fi);}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_normals\_face\ =\ x\_faces.\mbox{\hyperlink{classXFileDataObject_a53f2bb66bd0bf57105d6e2a7e2af9bea}{add\_MeshFace}}(x\_mesh-\/>get\_x\_file());}
\DoxyCodeLine{00525\ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_faceVertexIndices\ =\ x\_normals\_face[\textcolor{stringliteral}{"{}faceVertexIndices"{}}];}
\DoxyCodeLine{00526\ \ \ \ \ XFileFace::Vertices::const\_iterator\ fvi;}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{keywordflow}{for}\ (fvi\ =\ face-\/>\_vertices.begin();}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ fvi\ !=\ face-\/>\_vertices.end();}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ ++fvi)\ \{}
\DoxyCodeLine{00530\ \ \ \ \ \ \ x\_faceVertexIndices.\mbox{\hyperlink{classXFileDataObject_a15b9a32ba5ff0ada2a9fa5dfe13c90ed}{add\_int}}((*fvi).\_normal\_index);}
\DoxyCodeLine{00531\ \ \ \ \ \}}
\DoxyCodeLine{00532\ \ \ \ \ x\_normals\_face[\textcolor{stringliteral}{"{}nFaceVertexIndices"{}}]\ =\ x\_faceVertexIndices.size();}
\DoxyCodeLine{00533\ \ \ \}}
\DoxyCodeLine{00534\ \ \ (*x\_meshNormals)[\textcolor{stringliteral}{"{}nFaceNormals"{}}]\ =\ x\_faces.size();}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00536\ \ \ \textcolor{keywordflow}{return}\ x\_meshNormals;}
\DoxyCodeLine{00537\ \}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00542\ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *\mbox{\hyperlink{classXFileMesh_aa590cc8f2396a892fb5042fb9b35afec}{XFileMesh::}}}
\DoxyCodeLine{00543\ \mbox{\hyperlink{classXFileMesh_aa590cc8f2396a892fb5042fb9b35afec}{make\_x\_colors}}(\mbox{\hyperlink{classXFileNode}{XFileNode}}\ *x\_mesh,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&suffix)\ \{}
\DoxyCodeLine{00544\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *x\_meshColors\ =\ x\_mesh-\/>\mbox{\hyperlink{classXFileNode_a47d6d2fc088684e62338c4ded1094437}{add\_MeshVertexColors}}(\textcolor{stringliteral}{"{}colors"{}}\ +\ suffix);}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_colors\ =\ (*x\_meshColors)[\textcolor{stringliteral}{"{}vertexColors"{}}];}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ Vertices::const\_iterator\ vi;}
\DoxyCodeLine{00549\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00550\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{00551\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{00552\ \ \ \ \ \textcolor{keyword}{const}\ LColor\ \&\mbox{\hyperlink{structcolor}{color}}\ =\ vertex-\/>\_color;}
\DoxyCodeLine{00553\ \ \ \ \ x\_colors.\mbox{\hyperlink{classXFileDataObject_abc15742bff2386e73c6e1856119edd8d}{add\_IndexedColor}}(x\_mesh-\/>get\_x\_file(),\ i,\ \mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{00554\ \ \ \ \ i++;}
\DoxyCodeLine{00555\ \ \ \}}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ (*x\_meshColors)[\textcolor{stringliteral}{"{}nVertexColors"{}}]\ =\ x\_colors.size();}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \textcolor{keywordflow}{return}\ x\_meshColors;}
\DoxyCodeLine{00560\ \}}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00565\ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *\mbox{\hyperlink{classXFileMesh_ac3b68eb452b9a5d7152d5660bbfc0679}{XFileMesh::}}}
\DoxyCodeLine{00566\ \mbox{\hyperlink{classXFileMesh_ac3b68eb452b9a5d7152d5660bbfc0679}{make\_x\_uvs}}(\mbox{\hyperlink{classXFileNode}{XFileNode}}\ *x\_mesh,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&suffix)\ \{}
\DoxyCodeLine{00567\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *x\_meshUvs\ =\ x\_mesh-\/>\mbox{\hyperlink{classXFileNode_a080c4d6236a2ac360e4b01634a006bd1}{add\_MeshTextureCoords}}(\textcolor{stringliteral}{"{}uvs"{}}\ +\ suffix);}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_uvs\ =\ (*x\_meshUvs)[\textcolor{stringliteral}{"{}textureCoords"{}}];}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ Vertices::const\_iterator\ vi;}
\DoxyCodeLine{00572\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{00573\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{00574\ \ \ \ \ x\_uvs.\mbox{\hyperlink{classXFileDataObject_afb9d20461f7c8db00b0207ed3e97d950}{add\_Coords2d}}(x\_mesh-\/>get\_x\_file(),\ vertex-\/>\_uv);}
\DoxyCodeLine{00575\ \ \ \}}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ (*x\_meshUvs)[\textcolor{stringliteral}{"{}nTextureCoords"{}}]\ =\ x\_uvs.size();}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \textcolor{keywordflow}{return}\ x\_meshUvs;}
\DoxyCodeLine{00580\ \}}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00585\ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *\mbox{\hyperlink{classXFileMesh_aa1913ec2fb382a42dac8997678b7f266}{XFileMesh::}}}
\DoxyCodeLine{00586\ \mbox{\hyperlink{classXFileMesh_aa1913ec2fb382a42dac8997678b7f266}{make\_x\_material\_list}}(\mbox{\hyperlink{classXFileNode}{XFileNode}}\ *x\_mesh,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&suffix)\ \{}
\DoxyCodeLine{00587\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *x\_meshMaterials\ =}
\DoxyCodeLine{00588\ \ \ \ \ x\_mesh-\/>\mbox{\hyperlink{classXFileNode_ab2f3cf85827900e568a85e5a8947014b}{add\_MeshMaterialList}}(\textcolor{stringliteral}{"{}materials"{}}\ +\ suffix);}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \ \ \textcolor{comment}{//\ First,\ build\ up\ the\ list\ of\ faces\ the\ reference\ the\ materials.}}
\DoxyCodeLine{00591\ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&x\_indexes\ =\ (*x\_meshMaterials)[\textcolor{stringliteral}{"{}faceIndexes"{}}];}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ Faces::const\_iterator\ fi;}
\DoxyCodeLine{00594\ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ \_faces.begin();\ fi\ !=\ \_faces.end();\ ++fi)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ (*fi);}
\DoxyCodeLine{00596\ \ \ \ \ x\_indexes.\mbox{\hyperlink{classXFileDataObject_a15b9a32ba5ff0ada2a9fa5dfe13c90ed}{add\_int}}(face-\/>\_material\_index);}
\DoxyCodeLine{00597\ \ \ \}}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \ \ (*x\_meshMaterials)[\textcolor{stringliteral}{"{}nFaceIndexes"{}}]\ =\ x\_indexes.size();}
\DoxyCodeLine{00600\ }
\DoxyCodeLine{00601\ \ \ \textcolor{comment}{//\ Now,\ build\ up\ the\ list\ of\ materials\ themselves.\ \ Each\ material\ is\ a\ child}}
\DoxyCodeLine{00602\ \ \ \textcolor{comment}{//\ of\ the\ MeshMaterialList\ node,\ rather\ than\ an\ element\ of\ an\ array.}}
\DoxyCodeLine{00603\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_materials.size();\ i++)\ \{}
\DoxyCodeLine{00604\ \ \ \ \ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material\ =\ \_materials[i];}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \ \ material-\/>\mbox{\hyperlink{classXFileMaterial_a12ffbaeb6cf3ceedcbf71a999766266a}{make\_x\_material}}(x\_meshMaterials,}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ suffix\ +\ \textcolor{stringliteral}{"{}\_"{}}\ +\ format\_string(i));}
\DoxyCodeLine{00608\ \ \ \}}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ (*x\_meshMaterials)[\textcolor{stringliteral}{"{}nMaterials"{}}]\ =\ (int)\_materials.size();}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{return}\ x\_meshMaterials;}
\DoxyCodeLine{00613\ \}}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00618\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a1ef96af351b7883d4c1e6f68e336d1de}{XFileMesh::}}}
\DoxyCodeLine{00619\ \mbox{\hyperlink{classXFileMesh_a1ef96af351b7883d4c1e6f68e336d1de}{fill\_mesh}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00620\ \ \ \mbox{\hyperlink{classXFileMesh_a1c39fb60a4b4132ede7a4ef919a6507c}{clear}}();}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&vertices\ =\ (*obj)[\textcolor{stringliteral}{"{}vertices"{}}];}
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ vertices.size();\ i++)\ \{}
\DoxyCodeLine{00626\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileVertex}{XFileVertex}};}
\DoxyCodeLine{00627\ \ \ \ \ vertex-\/>\_point\ =\ vertices[i].vec3();}
\DoxyCodeLine{00628\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_a42d19fbd826b5520081a1d975bcaae73}{add\_vertex}}(vertex);}
\DoxyCodeLine{00629\ \ \ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&faces\ =\ (*obj)[\textcolor{stringliteral}{"{}faces"{}}];}
\DoxyCodeLine{00632\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ faces.size();\ i++)\ \{}
\DoxyCodeLine{00633\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileFace}{XFileFace}};}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&faceIndices\ =\ faces[i][\textcolor{stringliteral}{"{}faceVertexIndices"{}}];}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ faceIndices.size();\ j++)\ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileFace_1_1Vertex}{XFileFace::Vertex}}\ vertex;}
\DoxyCodeLine{00639\ \ \ \ \ \ \ vertex.\_vertex\_index\ =\ faceIndices[j].i();}
\DoxyCodeLine{00640\ \ \ \ \ \ \ vertex.\_normal\_index\ =\ -\/1;}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \ \ \ \ face-\/>\_vertices.push\_back(vertex);}
\DoxyCodeLine{00643\ \ \ \ \ \}}
\DoxyCodeLine{00644\ \ \ \ \ \_faces.push\_back(face);}
\DoxyCodeLine{00645\ \ \ \}}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00647\ \ \ \textcolor{comment}{//\ Some\ properties\ are\ stored\ as\ children\ of\ the\ mesh.}}
\DoxyCodeLine{00648\ \ \ \textcolor{keywordtype}{int}\ num\_objects\ =\ obj-\/>get\_num\_objects();}
\DoxyCodeLine{00649\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_objects;\ i++)\ \{}
\DoxyCodeLine{00650\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a89c79b54626943c4e4921391225f9ed8}{fill\_mesh\_child}}(obj-\/>get\_object(i)))\ \{}
\DoxyCodeLine{00651\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00652\ \ \ \ \ \}}
\DoxyCodeLine{00653\ \ \ \}}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00656\ \}}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00661\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a89c79b54626943c4e4921391225f9ed8}{XFileMesh::}}}
\DoxyCodeLine{00662\ \mbox{\hyperlink{classXFileMesh_a89c79b54626943c4e4921391225f9ed8}{fill\_mesh\_child}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00663\ \ \ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}MeshNormals"{}}))\ \{}
\DoxyCodeLine{00664\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a93d5bf883ad4522a95458494f58ad301}{fill\_normals}}(obj))\ \{}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00666\ \ \ \ \ \}}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}MeshVertexColors"{}}))\ \{}
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a6a9f907ecbe6128f9091057875748ec0}{fill\_colors}}(obj))\ \{}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00671\ \ \ \ \ \}}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}MeshTextureCoords"{}}))\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a42d38f54ec920440b5fcbd2456db8d18}{fill\_uvs}}(obj))\ \{}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00676\ \ \ \ \ \}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}MeshMaterialList"{}}))\ \{}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a37d943c2705799a23497af39c1aa45b6}{fill\_material\_list}}(obj))\ \{}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00681\ \ \ \ \ \}}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}XSkinMeshHeader"{}}))\ \{}
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{comment}{//\ Quietly\ ignore\ a\ skin\ mesh\ header.}}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (obj-\/>is\_standard\_object(\textcolor{stringliteral}{"{}SkinWeights"{}}))\ \{}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classXFileMesh_a223f942c1082c7240f68f7131ee24f8a}{fill\_skin\_weights}}(obj))\ \{}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00689\ \ \ \ \ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{if}\ (xfile\_cat.is\_debug())\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ xfile\_cat.debug()}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Ignoring\ mesh\ data\ object\ of\ unknown\ type:\ "{}}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \ \ <<\ obj-\/>get\_template\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00696\ \ \ \ \ \}}
\DoxyCodeLine{00697\ \ \ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00700\ \}}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00705\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a93d5bf883ad4522a95458494f58ad301}{XFileMesh::}}}
\DoxyCodeLine{00706\ \mbox{\hyperlink{classXFileMesh_a93d5bf883ad4522a95458494f58ad301}{fill\_normals}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00707\ \ \ \textcolor{keywordtype}{int}\ i,\ j;}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&normals\ =\ (*obj)[\textcolor{stringliteral}{"{}normals"{}}];}
\DoxyCodeLine{00710\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ normals.size();\ i++)\ \{}
\DoxyCodeLine{00711\ \ \ \ \ \mbox{\hyperlink{classXFileNormal}{XFileNormal}}\ *normal\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileNormal}{XFileNormal}};}
\DoxyCodeLine{00712\ \ \ \ \ normal-\/>\_normal\ =\ normals[i].vec3();}
\DoxyCodeLine{00713\ \ \ \ \ normal-\/>\_has\_normal\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00714\ \ \ \ \ \mbox{\hyperlink{classXFileMesh_a5172a89c62ce42535a4a9a36af060b7c}{add\_normal}}(normal);}
\DoxyCodeLine{00715\ \ \ \}}
\DoxyCodeLine{00716\ }
\DoxyCodeLine{00717\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&faceNormals\ =\ (*obj)[\textcolor{stringliteral}{"{}faceNormals"{}}];}
\DoxyCodeLine{00718\ \ \ \textcolor{keywordflow}{if}\ (faceNormals.size()\ !=\ (\textcolor{keywordtype}{int})\_faces.size())\ \{}
\DoxyCodeLine{00719\ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00720\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Incorrect\ number\ of\ faces\ in\ MeshNormals\ within\ "{}}}
\DoxyCodeLine{00721\ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00722\ \ \ \}}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \textcolor{keywordtype}{int}\ num\_normals\ =\ min(faceNormals.size(),\ (\textcolor{keywordtype}{int})\_faces.size());}
\DoxyCodeLine{00725\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_normals;\ i++)\ \{}
\DoxyCodeLine{00726\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ \_faces[i];}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&faceIndices\ =\ faceNormals[i][\textcolor{stringliteral}{"{}faceVertexIndices"{}}];}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{if}\ (faceIndices.size()\ !=\ (\textcolor{keywordtype}{int})face-\/>\_vertices.size())\ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Incorrect\ number\ of\ vertices\ for\ face\ in\ MeshNormals\ within\ "{}}}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00734\ \ \ \ \ \}}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ min(faceIndices.size(),\ (\textcolor{keywordtype}{int})face-\/>\_vertices.size());}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{for}\ (j\ =\ 0;\ j\ <\ num\_vertices;\ j++)\ \{}
\DoxyCodeLine{00738\ \ \ \ \ \ \ face-\/>\_vertices[j].\_normal\_index\ =\ faceIndices[j].i();}
\DoxyCodeLine{00739\ \ \ \ \ \}}
\DoxyCodeLine{00740\ \ \ \}}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00743\ \}}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00749\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a6a9f907ecbe6128f9091057875748ec0}{XFileMesh::}}}
\DoxyCodeLine{00750\ \mbox{\hyperlink{classXFileMesh_a6a9f907ecbe6128f9091057875748ec0}{fill\_colors}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00751\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&vertexColors\ =\ (*obj)[\textcolor{stringliteral}{"{}vertexColors"{}}];}
\DoxyCodeLine{00752\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ vertexColors.size();\ i++)\ \{}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{keywordtype}{int}\ vertex\_index\ =\ vertexColors[i][\textcolor{stringliteral}{"{}index"{}}].i();}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex\_index\ <\ 0\ ||\ vertex\_index\ >=\ (\textcolor{keywordtype}{int})\_vertices.size())\ \{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Vertex\ index\ out\ of\ range\ in\ MeshVertexColors\ within\ "{}}}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00759\ \ \ \ \ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ \_vertices[vertex\_index];}
\DoxyCodeLine{00762\ \ \ \ \ vertex-\/>\_color\ =\ LCAST(PN\_stdfloat,\ vertexColors[i][\textcolor{stringliteral}{"{}indexColor"{}}].vec4());}
\DoxyCodeLine{00763\ \ \ \ \ vertex-\/>\_has\_color\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00764\ \ \ \}}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00766\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00767\ \}}
\DoxyCodeLine{00768\ }
\DoxyCodeLine{00773\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a42d38f54ec920440b5fcbd2456db8d18}{XFileMesh::}}}
\DoxyCodeLine{00774\ \mbox{\hyperlink{classXFileMesh_a42d38f54ec920440b5fcbd2456db8d18}{fill\_uvs}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00775\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&textureCoords\ =\ (*obj)[\textcolor{stringliteral}{"{}textureCoords"{}}];}
\DoxyCodeLine{00776\ \ \ \textcolor{keywordflow}{if}\ (textureCoords.size()\ !=\ (\textcolor{keywordtype}{int})\_vertices.size())\ \{}
\DoxyCodeLine{00777\ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00778\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Wrong\ number\ of\ vertices\ in\ MeshTextureCoords\ within\ "{}}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00780\ \ \ \}}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \textcolor{keywordtype}{int}\ num\_texcoords\ =\ min(textureCoords.size(),\ (\textcolor{keywordtype}{int})\_vertices.size());}
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_texcoords;\ i++)\ \{}
\DoxyCodeLine{00784\ \ \ \ \ \mbox{\hyperlink{classXFileVertex}{XFileVertex}}\ *vertex\ =\ \_vertices[i];}
\DoxyCodeLine{00785\ \ \ \ \ vertex-\/>\_uv\ =\ textureCoords[i].vec2();}
\DoxyCodeLine{00786\ \ \ \ \ vertex-\/>\_has\_uv\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00787\ \ \ \}}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00790\ \}}
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00795\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a223f942c1082c7240f68f7131ee24f8a}{XFileMesh::}}}
\DoxyCodeLine{00796\ \mbox{\hyperlink{classXFileMesh_a223f942c1082c7240f68f7131ee24f8a}{fill\_skin\_weights}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00797\ \ \ \textcolor{comment}{//\ Create\ a\ new\ SkinWeightsData\ record\ for\ the\ table.\ \ We'll\ need\ this\ data}}
\DoxyCodeLine{00798\ \ \ \textcolor{comment}{//\ later\ when\ we\ create\ the\ vertices.}}
\DoxyCodeLine{00799\ \ \ \_skin\_weights.push\_back(SkinWeightsData());}
\DoxyCodeLine{00800\ \ \ SkinWeightsData\ \&data\ =\ \_skin\_weights.back();}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ data.\_joint\_name\ =\ (*obj)[\textcolor{stringliteral}{"{}transformNodeName"{}}].s();}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&vertexIndices\ =\ (*obj)[\textcolor{stringliteral}{"{}vertexIndices"{}}];}
\DoxyCodeLine{00805\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&weights\ =\ (*obj)[\textcolor{stringliteral}{"{}weights"{}}];}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \textcolor{keywordflow}{if}\ (weights.size()\ !=\ vertexIndices.size())\ \{}
\DoxyCodeLine{00808\ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00809\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Inconsistent\ number\ of\ vertices\ in\ SkinWeights\ within\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00810\ \ \ \}}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \textcolor{comment}{//\ Unpack\ the\ weight\ for\ each\ vertex.}}
\DoxyCodeLine{00813\ \ \ \textcolor{keywordtype}{size\_t}\ num\_weights\ =\ min(weights.size(),\ vertexIndices.size());}
\DoxyCodeLine{00814\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_weights;\ i++)\ \{}
\DoxyCodeLine{00815\ \ \ \ \ \textcolor{keywordtype}{int}\ vindex\ =\ vertexIndices[i].i();}
\DoxyCodeLine{00816\ \ \ \ \ \textcolor{keywordtype}{double}\ weight\ =\ weights[i].d();}
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00818\ \ \ \ \ \textcolor{keywordflow}{if}\ (vindex\ <\ 0\ ||\ vindex\ >\ (\textcolor{keywordtype}{int})\_vertices.size())\ \{}
\DoxyCodeLine{00819\ \ \ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Illegal\ vertex\ index\ "{}}\ <<\ vindex\ <<\ \textcolor{stringliteral}{"{}\ in\ SkinWeights.\(\backslash\)n"{}};}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00822\ \ \ \ \ \}}
\DoxyCodeLine{00823\ \ \ \ \ data.\_weight\_map[vindex]\ =\ weight;}
\DoxyCodeLine{00824\ \ \ \}}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00826\ \ \ \textcolor{comment}{//\ Also\ retrieve\ the\ matrix\ offset.}}
\DoxyCodeLine{00827\ \ \ data.\_matrix\_offset\ =\ (*obj)[\textcolor{stringliteral}{"{}matrixOffset"{}}][\textcolor{stringliteral}{"{}matrix"{}}].mat4();}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00830\ \}}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00836\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileMesh_a37d943c2705799a23497af39c1aa45b6}{XFileMesh::}}}
\DoxyCodeLine{00837\ \mbox{\hyperlink{classXFileMesh_a37d943c2705799a23497af39c1aa45b6}{fill\_material\_list}}(\mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *obj)\ \{}
\DoxyCodeLine{00838\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ \&faceIndexes\ =\ (*obj)[\textcolor{stringliteral}{"{}faceIndexes"{}}];}
\DoxyCodeLine{00839\ \ \ \textcolor{keywordflow}{if}\ (faceIndexes.size()\ >\ (\textcolor{keywordtype}{int})\_faces.size())\ \{}
\DoxyCodeLine{00840\ \ \ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00841\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Too\ many\ faces\ in\ MeshMaterialList\ within\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00842\ \ \ \}}
\DoxyCodeLine{00843\ }
\DoxyCodeLine{00844\ \ \ \textcolor{keywordtype}{int}\ material\_index\ =\ -\/1;}
\DoxyCodeLine{00845\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{00846\ \ \ \textcolor{keywordflow}{while}\ (i\ <\ faceIndexes.size()\ \&\&\ i\ <\ (\textcolor{keywordtype}{int})\_faces.size())\ \{}
\DoxyCodeLine{00847\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ \_faces[i];}
\DoxyCodeLine{00848\ \ \ \ \ material\_index\ =\ faceIndexes[i].i();}
\DoxyCodeLine{00849\ \ \ \ \ face-\/>\_material\_index\ =\ material\_index;}
\DoxyCodeLine{00850\ \ \ \ \ i++;}
\DoxyCodeLine{00851\ \ \ \}}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \ \ \textcolor{comment}{//\ The\ rest\ of\ the\ faces\ get\ the\ same\ material\ index\ as\ the\ last\ one\ in\ the}}
\DoxyCodeLine{00854\ \ \ \textcolor{comment}{//\ list.}}
\DoxyCodeLine{00855\ \ \ \textcolor{keywordflow}{while}\ (i\ <\ (\textcolor{keywordtype}{int})\_faces.size())\ \{}
\DoxyCodeLine{00856\ \ \ \ \ \mbox{\hyperlink{classXFileFace}{XFileFace}}\ *face\ =\ \_faces[i];}
\DoxyCodeLine{00857\ \ \ \ \ face-\/>\_material\_index\ =\ material\_index;}
\DoxyCodeLine{00858\ \ \ \ \ i++;}
\DoxyCodeLine{00859\ \ \ \}}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \textcolor{comment}{//\ Now\ look\ for\ children\ of\ the\ MaterialList\ object.\ \ These\ should\ all\ be}}
\DoxyCodeLine{00862\ \ \ \textcolor{comment}{//\ Material\ objects.}}
\DoxyCodeLine{00863\ \ \ \textcolor{keywordtype}{int}\ num\_objects\ =\ obj-\/>get\_num\_objects();}
\DoxyCodeLine{00864\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_objects;\ i++)\ \{}
\DoxyCodeLine{00865\ \ \ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}\ *child\ =\ obj-\/>get\_object(i);}
\DoxyCodeLine{00866\ \ \ \ \ \textcolor{keywordflow}{if}\ (child-\/>\mbox{\hyperlink{classXFileDataNode_aed9ed6bcacc6eede0ea8829c1d1de4b5}{is\_standard\_object}}(\textcolor{stringliteral}{"{}Material"{}}))\ \{}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}}\ *material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classXFileMaterial}{XFileMaterial}};}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!material-\/>\mbox{\hyperlink{classXFileMaterial_a2708808c925cb2e892b1b5bc7ff1a386}{fill\_material}}(child))\ \{}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ \textcolor{keyword}{delete}\ material;}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileMesh_aec4585a43544f795236449e006a48690}{add\_material}}(material);}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (xfile\_cat.is\_debug())\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ xfile\_cat.debug()}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Ignoring\ material\ list\ object\ of\ unknown\ type:\ "{}}}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ \ \ <<\ child-\/>get\_template\_name()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00880\ \ \ \ \ \}}
\DoxyCodeLine{00881\ \ \ \}}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00883\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00884\ \}}

\end{DoxyCode}
