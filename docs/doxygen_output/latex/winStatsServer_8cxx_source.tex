\doxysection{win\+Stats\+Server.\+cxx}
\hypertarget{winStatsServer_8cxx_source}{}\label{winStatsServer_8cxx_source}\index{pandatool/src/win-\/stats/winStatsServer.cxx@{pandatool/src/win-\/stats/winStatsServer.cxx}}
\mbox{\hyperlink{winStatsServer_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsServer_8h}{winStatsServer.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsMenuId_8h}{winStatsMenuId.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsMonitor_8h}{winStatsMonitor.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}pandaVersion.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatGraph_8h}{pStatGraph.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pstatclient_8h}{config\_pstatclient.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <commctrl.h>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <commdlg.h>}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keywordtype}{bool}\ WinStatsServer::\_window\_class\_registered\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00025\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\textcolor{keyword}{const}\ WinStatsServer::\_window\_class\_name\ =\ \textcolor{stringliteral}{"{}server"{}};}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ WinStatsServer::}
\DoxyCodeLine{00031\ WinStatsServer()\ :\ \_port(pstats\_port)\ \{}
\DoxyCodeLine{00032\ \ \ set\_program\_brief(\textcolor{stringliteral}{"{}Windows\ PStats\ client"{}});}
\DoxyCodeLine{00033\ \ \ add\_option(\textcolor{stringliteral}{"{}p"{}},\ \textcolor{stringliteral}{"{}port"{}},\ 0,\ \textcolor{stringliteral}{"{}"{}},\ \&\mbox{\hyperlink{classProgramBase_a7ee663294fb0c41caed1d9045ccf750d}{ProgramBase::dispatch\_int}},\ \textcolor{keyword}{nullptr},\ \&\_port);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \_last\_session\ =\ \mbox{\hyperlink{classFilename_a73834ff912339f4d780d4fa235cb6826}{Filename::expand\_from}}(}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{stringliteral}{"{}\$USER\_APPDATA/Panda3D-\/"{}}\ PANDA\_ABI\_VERSION\_STR\ \textcolor{stringliteral}{"{}/last-\/session.pstats"{}});}
\DoxyCodeLine{00037\ \ \ \_last\_session.set\_binary();}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ Create\ the\ fonts\ used\ for\ rendering\ the\ UI.}}
\DoxyCodeLine{00040\ \ \ NONCLIENTMETRICS\ metrics\ =\ \{0\};}
\DoxyCodeLine{00041\ \ \ metrics.cbSize\ =\ \textcolor{keyword}{sizeof}(NONCLIENTMETRICS);}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordflow}{if}\ (SystemParametersInfo(SPI\_GETNONCLIENTMETRICS,\ 0,\ \&metrics,\ 0))\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \_font\ =\ CreateFontIndirect(\&metrics.lfMenuFont);}
\DoxyCodeLine{00044\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \_font\ =\ (HFONT)GetStockObject(ANSI\_VAR\_FONT);}
\DoxyCodeLine{00046\ \ \ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ create\_window();}
\DoxyCodeLine{00049\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00056\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_a7e7ecd4ab474adc1fc42af86dd870013}{WinStatsServer::}}}
\DoxyCodeLine{00057\ \mbox{\hyperlink{classWinStatsServer_a7e7ecd4ab474adc1fc42af86dd870013}{handle\_args}}(\mbox{\hyperlink{classpdeque}{ProgramBase::Args}}\ \&args)\ \{}
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{if}\ (args.empty())\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{new\_session}}();}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (args.size()\ ==\ 1)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(args[0]);}
\DoxyCodeLine{00064\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00065\ \ \ \ \ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}\ *monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{if}\ (!monitor-\/>\mbox{\hyperlink{classPStatMonitor_a0e003c0bf21c1d000fd41185a261412b}{read}}(fn))\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ monitor;}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ load\ session\ file:\ "{}}\ <<\ fn;}
\DoxyCodeLine{00071\ \ \ \ \ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00072\ \ \ \ \ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00075\ \ \ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{},\ "{}Save\ Session"{}\ and\ "{}Close\ Session"{}\ menu\ items.}}
\DoxyCodeLine{00078\ \ \ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00079\ \ \ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00080\ \ \ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00081\ \ \ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00082\ \ \ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00083\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00084\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00085\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00086\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \_monitor\ =\ monitor;}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00092\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}At\ most\ one\ filename\ may\ be\ specified\ on\ the\ command-\/line.\(\backslash\)n"{}};}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00100\ \mbox{\hyperlink{classPStatMonitor}{PStatMonitor}}\ *WinStatsServer::}
\DoxyCodeLine{00101\ make\_monitor(\textcolor{keyword}{const}\ \mbox{\hyperlink{classNetAddress}{NetAddress}}\ \&address)\ \{}
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{},\ "{}Save\ Session"{}\ and\ "{}Close\ Session"{}\ menu\ items.}}
\DoxyCodeLine{00103\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00104\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00105\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00106\ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00107\ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00108\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00109\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00110\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00111\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ strm;}
\DoxyCodeLine{00114\ \ \ strm\ <<\ \textcolor{stringliteral}{"{}PStats\ Server\ (connected\ to\ "{}}\ <<\ address\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00115\ \ \ std::string\ title\ =\ strm.str();}
\DoxyCodeLine{00116\ \ \ SetWindowTextA(\_window,\ title.c\_str());}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \_monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordflow}{return}\ \_monitor;}
\DoxyCodeLine{00120\ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00125\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsServer_aa4202def5e49505f8f6ea89c6480cd19}{WinStatsServer::}}}
\DoxyCodeLine{00126\ \mbox{\hyperlink{classWinStatsServer_aa4202def5e49505f8f6ea89c6480cd19}{lost\_connection}}(\mbox{\hyperlink{classPStatMonitor}{PStatMonitor}}\ *monitor)\ \{}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !\_monitor-\/>\_have\_data)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{comment}{//\ We\ didn't\ have\ any\ data\ yet.\ \ Just\ silently\ restart\ the\ session.}}
\DoxyCodeLine{00129\ \ \ \ \ \_monitor-\/>close();}
\DoxyCodeLine{00130\ \ \ \ \ \_monitor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00131\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{new\_session}}())\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00133\ \ \ \ \ \}}
\DoxyCodeLine{00134\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Store\ a\ backup\ now,\ in\ case\ PStats\ crashes\ or\ something.}}
\DoxyCodeLine{00136\ \ \ \ \ \_last\_session.\mbox{\hyperlink{classFilename_aa3072a14bec6fccd0e7befca5863a35c}{make\_dir}}();}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{if}\ (monitor-\/>\mbox{\hyperlink{classPStatMonitor_aace5334b65153a6e02b9853cad6f915e}{write}}(\_last\_session))\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Wrote\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00139\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ write\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00141\ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{classPStatServer_a770f50f78edc517a443275ace6acf82a}{stop\_listening}}();}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ SetWindowTextA(\_window,\ \textcolor{stringliteral}{"{}PStats\ Server\ (disconnected)"{}});}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00152\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{WinStatsServer::}}}
\DoxyCodeLine{00153\ \mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{new\_session}}()\ \{}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}())\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatServer_ad3f87babd63a32b193b96f90c3cad21e}{listen}}(\_port))\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ strm;}
\DoxyCodeLine{00161\ \ \ \ \ \ \ strm\ <<\ \textcolor{stringliteral}{"{}PStats\ Server\ (listening\ on\ port\ "{}}\ <<\ \_port\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00162\ \ \ \ \ \ \ std::string\ title\ =\ strm.str();}
\DoxyCodeLine{00163\ \ \ \ \ \ \ SetWindowTextA(\_window,\ title.c\_str());}
\DoxyCodeLine{00164\ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ strm;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ strm\ <<\ \textcolor{stringliteral}{"{}Waiting\ for\ client\ to\ connect\ on\ port\ "{}}\ <<\ \_port\ <<\ \textcolor{stringliteral}{"{}..."{}};}
\DoxyCodeLine{00168\ \ \ \ \ \ \ std::string\ title\ =\ strm.str();}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ part\ =\ -\/1;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ SendMessage(\_status\_bar,\ SB\_SETPARTS,\ 1,\ (LPARAM)\&part);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ SendMessage(\_status\_bar,\ WM\_SETTEXT,\ 0,\ (LPARAM)title.c\_str());}
\DoxyCodeLine{00172\ \ \ \ \ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{comment}{//\ Disable\ the\ "{}New\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00175\ \ \ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00176\ \ \ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00177\ \ \ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00178\ \ \ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00179\ \ \ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00180\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{//\ Disable\ the\ "{}Save\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00183\ \ \ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00184\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{comment}{//\ Enable\ the\ "{}Close\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00187\ \ \ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00188\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{comment}{//\ Disable\ the\ "{}Export\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00191\ \ \ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00192\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00195\ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ SetWindowTextA(\_window,\ \textcolor{stringliteral}{"{}PStats\ Server"{}});}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00200\ \ \ stream}
\DoxyCodeLine{00201\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ port\ "{}}\ <<\ \_port\ <<\ \textcolor{stringliteral}{"{}.\ \ Try\ specifying\ a\ different\ "{}}}
\DoxyCodeLine{00202\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}port\ number\ using\ pstats-\/port\ in\ your\ Config\ file\ or\ the\ -\/p\ option\ on\ "{}}}
\DoxyCodeLine{00203\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}the\ command-\/line."{}};}
\DoxyCodeLine{00204\ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00205\ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00208\ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00213\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_af5fbafb4d43d4931096f5c5eca8b4c0c}{WinStatsServer::}}}
\DoxyCodeLine{00214\ \mbox{\hyperlink{classWinStatsServer_af5fbafb4d43d4931096f5c5eca8b4c0c}{open\_session}}()\ \{}
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}())\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordtype}{char}\ buffer[4096];}
\DoxyCodeLine{00220\ \ \ buffer[0]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ OPENFILENAMEA\ ofn\ =\ \{}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keyword}{sizeof}(OPENFILENAMEA),}
\DoxyCodeLine{00224\ \ \ \ \ \_window,}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{stringliteral}{"{}PStats\ Session\ Files\ (*.pstats)\(\backslash\)0*.pstats\(\backslash\)0All\ Files\ (*.*)\(\backslash\)0*.*\(\backslash\)0"{}},}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00228\ \ \ \ \ 0,}
\DoxyCodeLine{00229\ \ \ \ \ 0,}
\DoxyCodeLine{00230\ \ \ \ \ buffer,}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keyword}{sizeof}(buffer),}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00233\ \ \ \ \ 0,}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{stringliteral}{"{}Open\ Session"{}},}
\DoxyCodeLine{00236\ \ \ \ \ OFN\_HIDEREADONLY\ |\ OFN\_FILEMUSTEXIST\ |\ OFN\_PATHMUSTEXIST,}
\DoxyCodeLine{00237\ \ \ \ \ 0,}
\DoxyCodeLine{00238\ \ \ \};}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordflow}{if}\ (GetOpenFileNameA(\&ofn))\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(buffer);}
\DoxyCodeLine{00242\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \ \ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}\ *monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keywordflow}{if}\ (!monitor-\/>\mbox{\hyperlink{classPStatMonitor_a0e003c0bf21c1d000fd41185a261412b}{read}}(fn))\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ monitor;}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ load\ session\ file:\ "{}}\ <<\ fn;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00251\ \ \ \ \ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00254\ \ \ \ \ \}}
\DoxyCodeLine{00255\ \ \ \ \ \_monitor\ =\ monitor;}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{},\ "{}Save\ Session"{}\ and\ "{}Close\ Session"{}\ menu\ items.}}
\DoxyCodeLine{00258\ \ \ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00259\ \ \ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00260\ \ \ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00261\ \ \ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00262\ \ \ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00263\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00264\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00265\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00266\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00269\ \ \ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00277\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_ab6b236fedfb3f8b2478a78da31715d47}{WinStatsServer::}}}
\DoxyCodeLine{00278\ \mbox{\hyperlink{classWinStatsServer_ab6b236fedfb3f8b2478a78da31715d47}{open\_last\_session}}()\ \{}
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}())\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn\ =\ \_last\_session;}
\DoxyCodeLine{00284\ \ \ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}\ *monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00285\ \ \ \textcolor{keywordflow}{if}\ (!monitor-\/>\mbox{\hyperlink{classPStatMonitor_a0e003c0bf21c1d000fd41185a261412b}{read}}(fn))\ \{}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{keyword}{delete}\ monitor;}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00289\ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ load\ session\ file:\ "{}}\ <<\ fn;}
\DoxyCodeLine{00290\ \ \ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00291\ \ \ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00294\ \ \ \}}
\DoxyCodeLine{00295\ \ \ \_monitor\ =\ monitor;}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{},\ "{}Save\ Session"{}\ and\ "{}Close\ Session"{}\ menu\ items.}}
\DoxyCodeLine{00298\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00299\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00300\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00301\ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00302\ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00303\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00304\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00305\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00306\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{comment}{//\ If\ the\ file\ contained\ no\ graphs,\ open\ the\ default\ graphs.}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{if}\ (monitor-\/>\_graphs.empty())\ \{}
\DoxyCodeLine{00310\ \ \ \ \ monitor-\/>\mbox{\hyperlink{classPStatMonitor_aa088e596e90d348e4624b7a9b687aa5c}{open\_default\_graphs}}();}
\DoxyCodeLine{00311\ \ \ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00314\ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00319\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{WinStatsServer::}}}
\DoxyCodeLine{00320\ \mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{save\_session}}()\ \{}
\DoxyCodeLine{00321\ \ \ nassertr\_always(\_monitor\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \textcolor{keywordtype}{char}\ buffer[4096];}
\DoxyCodeLine{00324\ \ \ buffer[0]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ OPENFILENAMEA\ ofn\ =\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keyword}{sizeof}(OPENFILENAMEA),}
\DoxyCodeLine{00328\ \ \ \ \ \_window,}
\DoxyCodeLine{00329\ \ \ \ \ 0,}
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{stringliteral}{"{}PStats\ Session\ Files\(\backslash\)0*.pstats\(\backslash\)0"{}},}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00332\ \ \ \ \ 0,}
\DoxyCodeLine{00333\ \ \ \ \ 0,}
\DoxyCodeLine{00334\ \ \ \ \ buffer,}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keyword}{sizeof}(buffer),}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00337\ \ \ \ \ 0,}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{stringliteral}{"{}Save\ Session"{}},}
\DoxyCodeLine{00340\ \ \ \ \ OFN\_OVERWRITEPROMPT,}
\DoxyCodeLine{00341\ \ \ \ \ 0,}
\DoxyCodeLine{00342\ \ \ \ \ 0,}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{stringliteral}{"{}pstats"{}},}
\DoxyCodeLine{00344\ \ \ \ \ 0,}
\DoxyCodeLine{00345\ \ \ \};}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \textcolor{keywordflow}{if}\ (GetSaveFileNameA(\&ofn))\ \{}
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(buffer);}
\DoxyCodeLine{00349\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_monitor-\/>write(fn))\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00353\ \ \ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ save\ session\ file:\ "{}}\ <<\ fn;}
\DoxyCodeLine{00354\ \ \ \ \ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00355\ \ \ \ \ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ \ \ \ \ \_monitor-\/>get\_client\_data()-\/>clear\_dirty();}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00361\ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00364\ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00369\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_a318ee5c728652a95993889a3a2c1639a}{WinStatsServer::}}}
\DoxyCodeLine{00370\ \mbox{\hyperlink{classWinStatsServer_a318ee5c728652a95993889a3a2c1639a}{export\_session}}()\ \{}
\DoxyCodeLine{00371\ \ \ nassertr\_always(\_monitor\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \textcolor{keywordtype}{char}\ buffer[4096];}
\DoxyCodeLine{00374\ \ \ buffer[0]\ =\ \textcolor{charliteral}{'\(\backslash\)0'};}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ OPENFILENAMEA\ ofn\ =\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keyword}{sizeof}(OPENFILENAMEA),}
\DoxyCodeLine{00378\ \ \ \ \ \_window,}
\DoxyCodeLine{00379\ \ \ \ \ 0,}
\DoxyCodeLine{00380\ \ \ \ \ \textcolor{stringliteral}{"{}JSON\ files\(\backslash\)0*.json\(\backslash\)0"{}},}
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00382\ \ \ \ \ 0,}
\DoxyCodeLine{00383\ \ \ \ \ 0,}
\DoxyCodeLine{00384\ \ \ \ \ buffer,}
\DoxyCodeLine{00385\ \ \ \ \ \textcolor{keyword}{sizeof}(buffer),}
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00387\ \ \ \ \ 0,}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{stringliteral}{"{}Export\ Session"{}},}
\DoxyCodeLine{00390\ \ \ \ \ OFN\_OVERWRITEPROMPT,}
\DoxyCodeLine{00391\ \ \ \ \ 0,}
\DoxyCodeLine{00392\ \ \ \ \ 0,}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{stringliteral}{"{}json"{}},}
\DoxyCodeLine{00394\ \ \ \ \ 0,}
\DoxyCodeLine{00395\ \ \ \};}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \textcolor{keywordflow}{if}\ (GetSaveFileNameA(\&ofn))\ \{}
\DoxyCodeLine{00398\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(buffer);}
\DoxyCodeLine{00399\ \ \ \ \ fn.set\_text();}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \ \ std::ofstream\ stream;}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fn.\mbox{\hyperlink{classFilename_ad37a9d52c837218b01076de184dc5f4d}{open\_write}}(stream))\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ file\ for\ export:\ "{}}\ <<\ fn;}
\DoxyCodeLine{00405\ \ \ \ \ \ \ std::string\ str\ =\ stream.str();}
\DoxyCodeLine{00406\ \ \ \ \ \ \ MessageBox(\_window,\ str.c\_str(),\ \textcolor{stringliteral}{"{}PStats\ Error"{}},}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MB\_OK\ |\ MB\_ICONEXCLAMATION);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00409\ \ \ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordtype}{int}\ pid\ =\ \_monitor-\/>get\_client\_pid();}
\DoxyCodeLine{00412\ \ \ \ \ \_monitor-\/>get\_client\_data()-\/>write\_json(stream,\ std::max(0,\ pid));}
\DoxyCodeLine{00413\ \ \ \ \ stream.close();}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00415\ \ \ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00418\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00423\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{WinStatsServer::}}}
\DoxyCodeLine{00424\ \mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}()\ \{}
\DoxyCodeLine{00425\ \ \ \textcolor{keywordtype}{bool}\ wrote\_last\_session\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =\ \_monitor-\/>get\_client\_data();}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{keywordflow}{if}\ (client\_data\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_ad5cd3be63341b509d48fdee720ee8d12}{is\_dirty}}())\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_monitor-\/>has\_read\_filename())\ \{}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \_last\_session.\mbox{\hyperlink{classFilename_aa3072a14bec6fccd0e7befca5863a35c}{make\_dir}}();}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor-\/>write(\_last\_session))\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Wrote\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ wrote\_last\_session\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ write\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ result\ =\ MessageBox(\_window,}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Would\ you\ like\ to\ save\ the\ currently\ open\ session?"{}},}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Unsaved\ Data"{}},\ MB\_YESNOCANCEL\ |\ MB\_ICONQUESTION);}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ IDCANCEL\ ||\ (result\ ==\ IDYES\ \&\&\ !\mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{save\_session}}()))\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \ \ \_monitor-\/>close();}
\DoxyCodeLine{00450\ \ \ \ \ \_monitor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00451\ \ \ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \mbox{\hyperlink{classPStatServer_a770f50f78edc517a443275ace6acf82a}{stop\_listening}}();}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ SetWindowTextA(\_window,\ \textcolor{stringliteral}{"{}PStats\ Server"{}});}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \textcolor{keywordtype}{int}\ part\ =\ -\/1;}
\DoxyCodeLine{00458\ \ \ SendMessage(\_status\_bar,\ SB\_SETPARTS,\ 1,\ (LPARAM)\&part);}
\DoxyCodeLine{00459\ \ \ SendMessage(\_status\_bar,\ WM\_SETTEXT,\ 0,\ (LPARAM)\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00462\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00463\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00464\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00465\ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00466\ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00467\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_new,\ FALSE,\ \&mii);}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{if}\ (wrote\_last\_session)\ \{}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{comment}{//\ And\ the\ "{}Open\ Last\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00471\ \ \ \ \ mii.fState\ =\ MFS\_ENABLED;}
\DoxyCodeLine{00472\ \ \ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_open\_last,\ FALSE,\ \&mii);}
\DoxyCodeLine{00473\ \ \ \}}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{//\ Disable\ the\ "{}Save\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00476\ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00477\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_save,\ FALSE,\ \&mii);}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \textcolor{comment}{//\ Disable\ the\ "{}Close\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00480\ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00481\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_close,\ FALSE,\ \&mii);}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \textcolor{comment}{//\ Disable\ the\ "{}Export\ Session"{}\ menu\ item.}}
\DoxyCodeLine{00484\ \ \ mii.fState\ =\ MFS\_DISABLED;}
\DoxyCodeLine{00485\ \ \ SetMenuItemInfoA(\_session\_menu,\ MI\_session\_export\_json,\ FALSE,\ \&mii);}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00488\ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00493\ HWND\ \mbox{\hyperlink{classWinStatsServer_ab1a1edc7e6ff8d9c2bfbbef3bacb22dc}{WinStatsServer::}}}
\DoxyCodeLine{00494\ \mbox{\hyperlink{classWinStatsServer_ab1a1edc7e6ff8d9c2bfbbef3bacb22dc}{get\_window}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00495\ \ \ \textcolor{keywordflow}{return}\ \_window;}
\DoxyCodeLine{00496\ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00501\ HMENU\ \mbox{\hyperlink{classWinStatsServer_a10ca1d49ddcc1a8d154aa5e0ebed4562}{WinStatsServer::}}}
\DoxyCodeLine{00502\ \mbox{\hyperlink{classWinStatsServer_a10ca1d49ddcc1a8d154aa5e0ebed4562}{get\_menu\_bar}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{return}\ \_menu\_bar;}
\DoxyCodeLine{00504\ \}}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00509\ HWND\ \mbox{\hyperlink{classWinStatsServer_a8929a18e67c371bf2c8cdb676ecfa169}{WinStatsServer::}}}
\DoxyCodeLine{00510\ \mbox{\hyperlink{classWinStatsServer_a8929a18e67c371bf2c8cdb676ecfa169}{get\_status\_bar}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{return}\ \_status\_bar;}
\DoxyCodeLine{00512\ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00517\ HFONT\ \mbox{\hyperlink{classWinStatsServer_aa890399d2da3e0ae246870ca76f4cb9e}{WinStatsServer::}}}
\DoxyCodeLine{00518\ \mbox{\hyperlink{classWinStatsServer_aa890399d2da3e0ae246870ca76f4cb9e}{get\_font}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{return}\ \_font;}
\DoxyCodeLine{00520\ \}}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00525\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classWinStatsServer_a24e79fddb659f2e70802a9788b5aeec5}{WinStatsServer::}}}
\DoxyCodeLine{00526\ \mbox{\hyperlink{classWinStatsServer_a24e79fddb659f2e70802a9788b5aeec5}{get\_pixel\_scale}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{return}\ \_pixel\_scale;}
\DoxyCodeLine{00528\ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00533\ POINT\ \mbox{\hyperlink{classWinStatsServer_a1f92e6832505808b8cb817e95b1f1436}{WinStatsServer::}}}
\DoxyCodeLine{00534\ \mbox{\hyperlink{classWinStatsServer_a1f92e6832505808b8cb817e95b1f1436}{get\_client\_origin}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00535\ \ \ \textcolor{keywordflow}{return}\ \_client\_origin;}
\DoxyCodeLine{00536\ \}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00541\ \textcolor{keywordtype}{int}\ WinStatsServer::}
\DoxyCodeLine{00542\ get\_time\_units()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00543\ \ \ \textcolor{keywordflow}{return}\ \_time\_units;}
\DoxyCodeLine{00544\ \}}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00552\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsServer_a0ba58fdad982a50b5e159eda5fcd85f1}{WinStatsServer::}}}
\DoxyCodeLine{00553\ \mbox{\hyperlink{classWinStatsServer_a0ba58fdad982a50b5e159eda5fcd85f1}{set\_time\_units}}(\textcolor{keywordtype}{int}\ unit\_mask)\ \{}
\DoxyCodeLine{00554\ \ \ \_time\_units\ =\ unit\_mask;}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00557\ \ \ \ \ \_monitor-\/>set\_time\_units(unit\_mask);}
\DoxyCodeLine{00558\ \ \ \}}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00560\ \ \ \textcolor{comment}{//\ Now\ change\ the\ checkmark\ on\ the\ pulldown\ menu.}}
\DoxyCodeLine{00561\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00562\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00563\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00564\ \ \ mii.fMask\ =\ MIIM\_STATE;}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ mii.fState\ =\ ((\_time\_units\ \&\ PStatGraph::GBU\_ms)\ !=\ 0)\ ?}
\DoxyCodeLine{00567\ \ \ \ \ MFS\_CHECKED\ :\ MFS\_UNCHECKED;}
\DoxyCodeLine{00568\ \ \ SetMenuItemInfo(\_options\_menu,\ MI\_time\_ms,\ FALSE,\ \&mii);}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ mii.fState\ =\ ((\_time\_units\ \&\ PStatGraph::GBU\_hz)\ !=\ 0)\ ?}
\DoxyCodeLine{00571\ \ \ \ \ MFS\_CHECKED\ :\ MFS\_UNCHECKED;}
\DoxyCodeLine{00572\ \ \ SetMenuItemInfo(\_options\_menu,\ MI\_time\_hz,\ FALSE,\ \&mii);}
\DoxyCodeLine{00573\ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00578\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00579\ create\_window()\ \{}
\DoxyCodeLine{00580\ \ \ HINSTANCE\ application\ =\ GetModuleHandle(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00581\ \ \ register\_window\_class(application);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \_menu\_bar\ =\ CreateMenu();}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \ \ setup\_session\_menu();}
\DoxyCodeLine{00586\ \ \ setup\_options\_menu();}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ DWORD\ window\_style\ =\ WS\_OVERLAPPEDWINDOW\ |\ WS\_CLIPCHILDREN\ |}
\DoxyCodeLine{00589\ \ \ \ \ WS\_CLIPSIBLINGS\ |\ WS\_VISIBLE;}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \_window\ =}
\DoxyCodeLine{00592\ \ \ \ \ CreateWindow(\_window\_class\_name,\ \textcolor{stringliteral}{"{}PStats\ Server"{}},\ window\_style,}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CW\_USEDEFAULT,\ CW\_USEDEFAULT,\ CW\_USEDEFAULT,\ CW\_USEDEFAULT,}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ \_menu\_bar,\ application,\ 0);}
\DoxyCodeLine{00595\ \ \ \textcolor{keywordflow}{if}\ (!\_window)\ \{}
\DoxyCodeLine{00596\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ create\ server\ window!\(\backslash\)n"{}};}
\DoxyCodeLine{00597\ \ \ \ \ exit(1);}
\DoxyCodeLine{00598\ \ \ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00600\ \ \ SetWindowLongPtr(\_window,\ 0,\ (LONG\_PTR)\textcolor{keyword}{this});}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ create\_status\_bar(application);}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \textcolor{comment}{//\ For\ some\ reason,\ SW\_SHOWNORMAL\ doesn't\ always\ work,\ but\ SW\_RESTORE\ seems}}
\DoxyCodeLine{00605\ \ \ \textcolor{comment}{//\ to.}}
\DoxyCodeLine{00606\ \ \ ShowWindow(\_window,\ SW\_RESTORE);}
\DoxyCodeLine{00607\ \ \ SetForegroundWindow(\_window);}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ HDC\ dc\ =\ GetDC(\_window);}
\DoxyCodeLine{00610\ \ \ \_pixel\_scale\ =\ 0;}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordflow}{if}\ (dc)\ \{}
\DoxyCodeLine{00612\ \ \ \ \ \_pixel\_scale\ =\ GetDeviceCaps(dc,\ LOGPIXELSX)\ /\ (96\ /\ 4);}
\DoxyCodeLine{00613\ \ \ \}}
\DoxyCodeLine{00614\ \ \ \textcolor{keywordflow}{if}\ (\_pixel\_scale\ <=\ 0)\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \_pixel\_scale\ =\ 4;}
\DoxyCodeLine{00616\ \ \ \}}
\DoxyCodeLine{00617\ \ \ ReleaseDC(\_window,\ dc);}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \_client\_origin.x\ =\ 0;}
\DoxyCodeLine{00620\ \ \ \_client\_origin.y\ =\ 0;}
\DoxyCodeLine{00621\ \ \ ClientToScreen(\_window,\ \&\_client\_origin);}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \textcolor{comment}{//\ Set\ up\ a\ timer\ to\ poll\ the\ pstats\ every\ so\ often.}}
\DoxyCodeLine{00624\ \ \ SetTimer(\_window,\ 1,\ 200,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00625\ \}}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00630\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00631\ setup\_session\_menu()\ \{}
\DoxyCodeLine{00632\ \ \ \_session\_menu\ =\ CreatePopupMenu();}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00635\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00636\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ mii.fMask\ =\ MIIM\_STRING\ |\ MIIM\_FTYPE\ |\ MIIM\_SUBMENU;}
\DoxyCodeLine{00639\ \ \ mii.fType\ =\ MFT\_STRING;}
\DoxyCodeLine{00640\ \ \ mii.hSubMenu\ =\ \_session\_menu;}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ mii.dwTypeData\ =\ \textcolor{stringliteral}{"{}\&Session"{}};}
\DoxyCodeLine{00643\ \ \ InsertMenuItem(\_menu\_bar,\ GetMenuItemCount(\_menu\_bar),\ TRUE,\ \&mii);}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING,\ MI\_session\_new,\ \textcolor{stringliteral}{"{}\&New\ Session\(\backslash\)tCtrl+N"{}});}
\DoxyCodeLine{00646\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING,\ MI\_session\_open,\ \textcolor{stringliteral}{"{}\&Open\ Session...\(\backslash\)tCtrl+O"{}});}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \textcolor{keywordflow}{if}\ (\_last\_session.\mbox{\hyperlink{classFilename_af8a2ef9ed26abbed32786e6d8025c2c7}{exists}}())\ \{}
\DoxyCodeLine{00649\ \ \ \ \ AppendMenu(\_session\_menu,\ MF\_STRING,\ MI\_session\_open\_last,\ \textcolor{stringliteral}{"{}Open\ \&Last\ Session"{}});}
\DoxyCodeLine{00650\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00651\ \ \ \ \ AppendMenu(\_session\_menu,\ MF\_STRING\ |\ MF\_DISABLED,\ MI\_session\_open\_last,\ \textcolor{stringliteral}{"{}Open\ \&Last\ Session"{}});}
\DoxyCodeLine{00652\ \ \ \}}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING\ |\ MF\_DISABLED,\ MI\_session\_save,\ \textcolor{stringliteral}{"{}\&Save\ Session...\(\backslash\)tCtrl+S"{}});}
\DoxyCodeLine{00655\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING\ |\ MF\_DISABLED,\ MI\_session\_close,\ \textcolor{stringliteral}{"{}\&Close\ Session\(\backslash\)tCtrl+W"{}});}
\DoxyCodeLine{00656\ }
\DoxyCodeLine{00657\ \ \ AppendMenu(\_session\_menu,\ MF\_SEPARATOR,\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00658\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING\ |\ MF\_DISABLED,\ MI\_session\_export\_json,\ \textcolor{stringliteral}{"{}\&Export\ as\ JSON..."{}});}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \ \ AppendMenu(\_session\_menu,\ MF\_SEPARATOR,\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00661\ \ \ AppendMenu(\_session\_menu,\ MF\_STRING,\ MI\_exit,\ \textcolor{stringliteral}{"{}E\&xit"{}});}
\DoxyCodeLine{00662\ \}}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00667\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00668\ setup\_options\_menu()\ \{}
\DoxyCodeLine{00669\ \ \ \_options\_menu\ =\ CreatePopupMenu();}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ MENUITEMINFO\ mii;}
\DoxyCodeLine{00672\ \ \ memset(\&mii,\ 0,\ \textcolor{keyword}{sizeof}(mii));}
\DoxyCodeLine{00673\ \ \ mii.cbSize\ =\ \textcolor{keyword}{sizeof}(mii);}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ mii.fMask\ =\ MIIM\_STRING\ |\ MIIM\_FTYPE\ |\ MIIM\_SUBMENU;}
\DoxyCodeLine{00676\ \ \ mii.fType\ =\ MFT\_STRING;}
\DoxyCodeLine{00677\ \ \ mii.hSubMenu\ =\ \_options\_menu;}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \textcolor{comment}{//\ One\ day,\ when\ there\ is\ more\ than\ one\ option\ here,\ we\ will\ actually}}
\DoxyCodeLine{00680\ \ \ \textcolor{comment}{//\ present\ this\ to\ the\ user\ as\ the\ "{}Options"{}\ menu.\ \ For\ now,\ the\ only\ option}}
\DoxyCodeLine{00681\ \ \ \textcolor{comment}{//\ we\ have\ is\ time\ units.\ \ mii.dwTypeData\ =\ "{}Options"{};}}
\DoxyCodeLine{00682\ \ \ mii.dwTypeData\ =\ \textcolor{stringliteral}{"{}Units"{}};}
\DoxyCodeLine{00683\ \ \ InsertMenuItem(\_menu\_bar,\ GetMenuItemCount(\_menu\_bar),\ TRUE,\ \&mii);}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ mii.fMask\ =\ MIIM\_STRING\ |\ MIIM\_FTYPE\ |\ MIIM\_ID\ |\ MIIM\_CHECKMARKS\ |\ MIIM\_STATE;}
\DoxyCodeLine{00686\ \ \ mii.fType\ =\ MFT\_STRING\ |\ MFT\_RADIOCHECK;}
\DoxyCodeLine{00687\ \ \ mii.hbmpChecked\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00688\ \ \ mii.hbmpUnchecked\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00689\ \ \ mii.fState\ =\ MFS\_UNCHECKED;}
\DoxyCodeLine{00690\ \ \ mii.wID\ =\ MI\_time\_ms;}
\DoxyCodeLine{00691\ \ \ mii.dwTypeData\ =\ \textcolor{stringliteral}{"{}ms"{}};}
\DoxyCodeLine{00692\ \ \ InsertMenuItem(\_options\_menu,\ GetMenuItemCount(\_options\_menu),\ TRUE,\ \&mii);}
\DoxyCodeLine{00693\ }
\DoxyCodeLine{00694\ \ \ mii.wID\ =\ MI\_time\_hz;}
\DoxyCodeLine{00695\ \ \ mii.dwTypeData\ =\ \textcolor{stringliteral}{"{}Hz"{}};}
\DoxyCodeLine{00696\ \ \ InsertMenuItem(\_options\_menu,\ GetMenuItemCount(\_options\_menu),\ TRUE,\ \&mii);}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ \mbox{\hyperlink{classWinStatsServer_a0ba58fdad982a50b5e159eda5fcd85f1}{set\_time\_units}}(PStatGraph::GBU\_ms);}
\DoxyCodeLine{00699\ \}}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00705\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00706\ create\_status\_bar(HINSTANCE\ application)\ \{}
\DoxyCodeLine{00707\ \ \ \_status\_bar\ =\ CreateWindow(STATUSCLASSNAME,\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SBARS\_SIZEGRIP\ |\ WS\_CHILD\ |\ WS\_VISIBLE,}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_window,\ (HMENU)0,\ application,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \ \ ShowWindow(\_status\_bar,\ SW\_SHOW);}
\DoxyCodeLine{00713\ \ \ UpdateWindow(\_status\_bar);}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ InvalidateRect(\_status\_bar,\ NULL,\ TRUE);}
\DoxyCodeLine{00716\ \}}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00722\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00723\ register\_window\_class(HINSTANCE\ application)\ \{}
\DoxyCodeLine{00724\ \ \ \textcolor{keywordflow}{if}\ (\_window\_class\_registered)\ \{}
\DoxyCodeLine{00725\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00726\ \ \ \}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ HMODULE\ imageres\ =\ LoadLibraryExA(\textcolor{stringliteral}{"{}imageres.dll"{}},\ 0,\ LOAD\_LIBRARY\_AS\_DATAFILE);}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ WNDCLASS\ wc;}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00732\ \ \ ZeroMemory(\&wc,\ \textcolor{keyword}{sizeof}(WNDCLASS));}
\DoxyCodeLine{00733\ \ \ wc.style\ =\ 0;}
\DoxyCodeLine{00734\ \ \ wc.lpfnWndProc\ =\ (WNDPROC)static\_window\_proc;}
\DoxyCodeLine{00735\ \ \ wc.hInstance\ =\ application;}
\DoxyCodeLine{00736\ \ \ wc.hIcon\ =\ LoadIcon(imageres,\ MAKEINTRESOURCE(150));}
\DoxyCodeLine{00737\ \ \ wc.hCursor\ =\ LoadCursor(\textcolor{keyword}{nullptr},\ IDC\_ARROW);}
\DoxyCodeLine{00738\ \ \ wc.hbrBackground\ =\ (HBRUSH)COLOR\_WINDOW;}
\DoxyCodeLine{00739\ \ \ wc.lpszMenuName\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00740\ \ \ wc.lpszClassName\ =\ \_window\_class\_name;}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \textcolor{comment}{//\ Reserve\ space\ to\ associate\ the\ this\ pointer\ with\ the\ window.}}
\DoxyCodeLine{00743\ \ \ wc.cbWndExtra\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classWinStatsServer}{WinStatsServer}}\ *);}
\DoxyCodeLine{00744\ }
\DoxyCodeLine{00745\ \ \ \textcolor{keywordflow}{if}\ (!RegisterClass(\&wc))\ \{}
\DoxyCodeLine{00746\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ register\ server\ window\ class!\(\backslash\)n"{}};}
\DoxyCodeLine{00747\ \ \ \ \ exit(1);}
\DoxyCodeLine{00748\ \ \ \}}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00750\ \ \ \_window\_class\_registered\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00751\ \}}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00756\ LONG\ WINAPI\ WinStatsServer::}
\DoxyCodeLine{00757\ static\_window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00758\ \ \ \mbox{\hyperlink{classWinStatsServer}{WinStatsServer}}\ *self\ =\ (\mbox{\hyperlink{classWinStatsServer}{WinStatsServer}}\ *)GetWindowLongPtr(hwnd,\ 0);}
\DoxyCodeLine{00759\ \ \ \textcolor{keywordflow}{if}\ (self\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ self-\/>\_window\ ==\ hwnd)\ \{}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordflow}{return}\ self-\/>window\_proc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00761\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{return}\ DefWindowProc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00763\ \ \ \}}
\DoxyCodeLine{00764\ \}}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00769\ LONG\ WinStatsServer::}
\DoxyCodeLine{00770\ window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00771\ \ \ \textcolor{keywordflow}{switch}\ (msg)\ \{}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{case}\ WM\_TIMER:}
\DoxyCodeLine{00773\ \ \ \ \ \mbox{\hyperlink{classPStatServer_a60f09e8f28c5f981e1e70e740244b16c}{poll}}();}
\DoxyCodeLine{00774\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \textcolor{keywordflow}{case}\ WM\_CLOSE:}
\DoxyCodeLine{00777\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}())\ \{}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00779\ \ \ \ \ \}}
\DoxyCodeLine{00780\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \textcolor{keywordflow}{case}\ WM\_DESTROY:}
\DoxyCodeLine{00783\ \ \ \ \ PostQuitMessage(0);}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \textcolor{keywordflow}{case}\ WM\_WINDOWPOSCHANGED:}
\DoxyCodeLine{00787\ \ \ \ \ \{}
\DoxyCodeLine{00788\ \ \ \ \ \ \ RECT\ client\_rect;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ GetClientRect(\_window,\ \&client\_rect);}
\DoxyCodeLine{00790\ \ \ \ \ \ \ MapWindowPoints(\_window,\ \textcolor{keyword}{nullptr},\ (POINT\ *)\&client\_rect,\ 2);}
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00792\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Remove\ the\ status\ bar\ from\ the\ client\ rectangle.}}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ RECT\ status\_bar\_rect;}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ GetWindowRect(\_status\_bar,\ \&status\_bar\_rect);}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ client\_rect.bottom\ -\/=\ (status\_bar\_rect.bottom\ -\/\ status\_bar\_rect.top);}
\DoxyCodeLine{00797\ }
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\_x\ =\ client\_rect.left\ -\/\ \_client\_origin.x;}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\_y\ =\ client\_rect.top\ -\/\ \_client\_origin.y;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \_client\_origin.x\ =\ client\_rect.left;}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \ \ \_client\_origin.y\ =\ client\_rect.top;}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ \_monitor-\/>handle\_window\_moved(client\_rect,\ delta\_x,\ delta\_y);}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \_client\_origin.x\ =\ client\_rect.left;}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \_client\_origin.y\ =\ client\_rect.top;}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00809\ \ \ \ \ \}}
\DoxyCodeLine{00810\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \textcolor{keywordflow}{case}\ WM\_SIZE:}
\DoxyCodeLine{00813\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_status\_bar)\ \{}
\DoxyCodeLine{00814\ \ \ \ \ \ \ SendMessage(\_status\_bar,\ WM\_SIZE,\ 0,\ 0);}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ \_monitor-\/>update\_status\_bar();}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00818\ \ \ \ \ \}}
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00820\ }
\DoxyCodeLine{00821\ \ \ \textcolor{keywordflow}{case}\ WM\_NOTIFY:}
\DoxyCodeLine{00822\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (((LPNMHDR)lparam)-\/>code\ ==\ NM\_DBLCLK)\ \{}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ NMMOUSE\ \&mouse\ =\ *(NMMOUSE\ *)lparam;}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ \_monitor-\/>handle\_status\_bar\_click(mouse.dwItemSpec);}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (((LPNMHDR)lparam)-\/>code\ ==\ NM\_RCLICK)\ \{}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ NMMOUSE\ \&mouse\ =\ *(NMMOUSE\ *)lparam;}
\DoxyCodeLine{00830\ \ \ \ \ \ \ \ \ \_monitor-\/>handle\_status\_bar\_popup(mouse.dwItemSpec);}
\DoxyCodeLine{00831\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00832\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00833\ \ \ \ \ \}}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00835\ }
\DoxyCodeLine{00836\ \ \ \textcolor{keywordflow}{case}\ WM\_KEYDOWN:}
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{keywordflow}{if}\ ((lparam\ \&\ 0x40000000)\ ==\ 0\ \&\&\ GetKeyState(VK\_CONTROL)\ <\ 0)\ \{}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (wparam)\ \{}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'N'}:}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{new\_session}}();}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00843\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'O'}:}
\DoxyCodeLine{00844\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_af5fbafb4d43d4931096f5c5eca8b4c0c}{open\_session}}();}
\DoxyCodeLine{00845\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'S'}:}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{save\_session}}();}
\DoxyCodeLine{00849\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00851\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'W'}:}
\DoxyCodeLine{00852\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}();}
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00854\ }
\DoxyCodeLine{00855\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00858\ \ \ \ \ \}}
\DoxyCodeLine{00859\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \textcolor{keywordflow}{case}\ WM\_APPCOMMAND:}
\DoxyCodeLine{00862\ \ \ \ \ \textcolor{keywordflow}{switch}\ (GET\_APPCOMMAND\_LPARAM(lparam))\ \{}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{case}\ APPCOMMAND\_OPEN:}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_af5fbafb4d43d4931096f5c5eca8b4c0c}{open\_session}}();}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00867\ \ \ \ \ \textcolor{keywordflow}{case}\ APPCOMMAND\_SAVE:}
\DoxyCodeLine{00868\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{save\_session}}();}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00870\ \ \ \ \ \}}
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ \textcolor{keywordflow}{case}\ WM\_COMMAND:}
\DoxyCodeLine{00874\ \ \ \ \ \textcolor{keywordflow}{if}\ (HIWORD(wparam)\ <=\ 1)\ \{}
\DoxyCodeLine{00875\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ menu\_id\ =\ LOWORD(wparam);}
\DoxyCodeLine{00876\ \ \ \ \ \ \ handle\_menu\_command(menu\_id);}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00878\ \ \ \ \ \}}
\DoxyCodeLine{00879\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00881\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00882\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00883\ \ \ \}}
\DoxyCodeLine{00884\ }
\DoxyCodeLine{00885\ \ \ \textcolor{keywordflow}{return}\ DefWindowProc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00886\ \}}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00891\ \textcolor{keywordtype}{void}\ WinStatsServer::}
\DoxyCodeLine{00892\ handle\_menu\_command(\textcolor{keywordtype}{int}\ menu\_id)\ \{}
\DoxyCodeLine{00893\ \ \ \textcolor{keywordflow}{switch}\ (menu\_id)\ \{}
\DoxyCodeLine{00894\ \ \ \textcolor{keywordflow}{case}\ MI\_none:}
\DoxyCodeLine{00895\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_new:}
\DoxyCodeLine{00898\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_ad2b0b12e8a8de0a459aadb07ed77ae62}{new\_session}}();}
\DoxyCodeLine{00899\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_open:}
\DoxyCodeLine{00902\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_af5fbafb4d43d4931096f5c5eca8b4c0c}{open\_session}}();}
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00904\ }
\DoxyCodeLine{00905\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_open\_last:}
\DoxyCodeLine{00906\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_ab6b236fedfb3f8b2478a78da31715d47}{open\_last\_session}}();}
\DoxyCodeLine{00907\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_save:}
\DoxyCodeLine{00910\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_aa14eb6d17bcd94bb20a48c4bc5ca2a08}{save\_session}}();}
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_close:}
\DoxyCodeLine{00914\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}();}
\DoxyCodeLine{00915\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00917\ \ \ \textcolor{keywordflow}{case}\ MI\_session\_export\_json:}
\DoxyCodeLine{00918\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_a318ee5c728652a95993889a3a2c1639a}{export\_session}}();}
\DoxyCodeLine{00919\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \textcolor{keywordflow}{case}\ MI\_exit:}
\DoxyCodeLine{00922\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classWinStatsServer_a402b24c430b45d57d192c1093f04a7e9}{close\_session}}())\ \{}
\DoxyCodeLine{00923\ \ \ \ \ \ \ exit(0);}
\DoxyCodeLine{00924\ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \textcolor{keywordflow}{case}\ MI\_time\_ms:}
\DoxyCodeLine{00928\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_a0ba58fdad982a50b5e159eda5fcd85f1}{set\_time\_units}}(PStatGraph::GBU\_ms);}
\DoxyCodeLine{00929\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00930\ }
\DoxyCodeLine{00931\ \ \ \textcolor{keywordflow}{case}\ MI\_time\_hz:}
\DoxyCodeLine{00932\ \ \ \ \ \mbox{\hyperlink{classWinStatsServer_a0ba58fdad982a50b5e159eda5fcd85f1}{set\_time\_units}}(PStatGraph::GBU\_hz);}
\DoxyCodeLine{00933\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00934\ }
\DoxyCodeLine{00935\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \_monitor-\/>handle\_menu\_command(menu\_id);}
\DoxyCodeLine{00938\ \ \ \ \ \}}
\DoxyCodeLine{00939\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00940\ \ \ \}}
\DoxyCodeLine{00941\ \}}

\end{DoxyCode}
