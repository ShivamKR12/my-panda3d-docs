\doxysection{p\+Stat\+Listener.\+cxx}
\hypertarget{pStatListener_8cxx_source}{}\label{pStatListener_8cxx_source}\index{pandatool/src/pstatserver/pStatListener.cxx@{pandatool/src/pstatserver/pStatListener.cxx}}
\mbox{\hyperlink{pStatListener_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatListener_8h}{pStatListener.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatServer_8h}{pStatServer.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatReader_8h}{pStatReader.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00021\ PStatListener::}
\DoxyCodeLine{00022\ PStatListener(\mbox{\hyperlink{classPStatServer}{PStatServer}}\ *manager)\ :}
\DoxyCodeLine{00023\ \ \ \mbox{\hyperlink{classConnectionListener}{ConnectionListener}}(manager,\ manager-\/>is\_thread\_safe()\ ?\ 1\ :\ 0),}
\DoxyCodeLine{00024\ \ \ \_manager(manager)}
\DoxyCodeLine{00025\ \{}
\DoxyCodeLine{00026\ \}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00032\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatListener_ac0bdc93bfce9c7ea2fed93f155a967eb}{PStatListener::}}}
\DoxyCodeLine{00033\ \mbox{\hyperlink{classPStatListener_ac0bdc93bfce9c7ea2fed93f155a967eb}{connection\_opened}}(\textcolor{keyword}{const}\ PT(\mbox{\hyperlink{classConnection}{Connection}})\ \&,}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classNetAddress}{NetAddress}}\ \&address,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PT(\mbox{\hyperlink{classConnection}{Connection}})\ \&new\_connection)\ \{}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classPStatMonitor}{PStatMonitor}}\ *monitor\ =\ \_manager-\/>make\_monitor(address);}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordflow}{if}\ (monitor\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00038\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Couldn't\ create\ monitor!\(\backslash\)n"{}};}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00040\ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Got\ new\ connection\ from\ "{}}\ <<\ address\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//\ Make\ sure\ this\ connection\ doesn't\ queue\ up\ TCP\ packets\ we\ write\ to\ it.}}
\DoxyCodeLine{00045\ \ \ new\_connection-\/>set\_collect\_tcp(\textcolor{keyword}{false});}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classPStatReader}{PStatReader}}\ *reader\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPStatReader}{PStatReader}}(\_manager,\ monitor);}
\DoxyCodeLine{00048\ \ \ \_manager-\/>\mbox{\hyperlink{classPStatServer_aaccda2895878613155168947e0a665eb}{add\_reader}}(new\_connection,\ reader);}
\DoxyCodeLine{00049\ \ \ reader-\/>\mbox{\hyperlink{classPStatReader_a89e01ca73d652ee46820089583ce85c5}{set\_tcp\_connection}}(new\_connection);}
\DoxyCodeLine{00050\ \}}

\end{DoxyCode}
