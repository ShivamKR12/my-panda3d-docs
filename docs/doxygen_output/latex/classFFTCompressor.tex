\doxysection{FFTCompressor Class Reference}
\hypertarget{classFFTCompressor}{}\label{classFFTCompressor}\index{FFTCompressor@{FFTCompressor}}


{\ttfamily \#include $<$fft\+Compressor.\+h$>$}

\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classFFTCompressor_a2c387817f720cd3c24d4b3da4f0efb8f}{FFTCompressor}} ()
\item 
void \mbox{\hyperlink{classFFTCompressor_a53b0db870b069e6bd5513963af476fe2}{set\+\_\+quality}} (int quality)
\item 
int \mbox{\hyperlink{classFFTCompressor_ac230e4f377b5de19957e3f71a1d17912}{get\+\_\+quality}} () const
\item 
void \mbox{\hyperlink{classFFTCompressor_a1ee5f3c053b9f9e3909bd9411ac471d9}{set\+\_\+use\+\_\+error\+\_\+threshold}} (bool use\+\_\+error\+\_\+threshold)
\item 
bool \mbox{\hyperlink{classFFTCompressor_a4fcfc32194b0a5aa3334b271596f28f1}{get\+\_\+use\+\_\+error\+\_\+threshold}} () const
\item 
void \mbox{\hyperlink{classFFTCompressor_a237e1c694f1765f3f33e30e76e62763c}{set\+\_\+transpose\+\_\+quats}} (bool flag)
\item 
bool \mbox{\hyperlink{classFFTCompressor_afb43202cf6584a4d164dbb954e1a5e1b}{get\+\_\+transpose\+\_\+quats}} () const
\item 
void \mbox{\hyperlink{classFFTCompressor_ae4cae5073d6e047daeb3a2ed61a32838}{write\+\_\+header}} (\mbox{\hyperlink{classDatagram}{Datagram}} \&datagram)
\item 
void \mbox{\hyperlink{classFFTCompressor_ae97e74c103db5941590843c2cc88bcab}{write\+\_\+reals}} (\mbox{\hyperlink{classDatagram}{Datagram}} \&datagram, const PN\+\_\+stdfloat \texorpdfstring{$\ast$}{*}array, int length)
\item 
void \mbox{\hyperlink{classFFTCompressor_aedf56c07b9bf59a1abeba6cb65b73dfe}{write\+\_\+hprs}} (\mbox{\hyperlink{classDatagram}{Datagram}} \&datagram, const LVec\+Base3 \texorpdfstring{$\ast$}{*}array, int length)
\item 
bool \mbox{\hyperlink{classFFTCompressor_a67f6b46d2ee1d06ad4549eabdcc2c439}{read\+\_\+header}} (\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&di, int bam\+\_\+minor\+\_\+version)
\item 
bool \mbox{\hyperlink{classFFTCompressor_a1be8ffd0b57154f9e36b163ebb85f2d0}{read\+\_\+reals}} (\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&di, vector\+\_\+stdfloat \&array)
\item 
bool \mbox{\hyperlink{classFFTCompressor_a2e5f1f242aa11d39af0a111739d8c3da}{read\+\_\+hprs}} (\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&di, \mbox{\hyperlink{classpvector}{pvector}}$<$ LVec\+Base3 $>$ \&array, bool new\+\_\+hpr)
\item 
bool \mbox{\hyperlink{classFFTCompressor_a76ca57b16aec0fd3fc670a47f34a74b8}{read\+\_\+hprs}} (\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&di, \mbox{\hyperlink{classpvector}{pvector}}$<$ LVec\+Base3 $>$ \&array)
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static bool \mbox{\hyperlink{classFFTCompressor_adaa64eb86e996609d2f7b3dcc9c47abe}{is\+\_\+compression\+\_\+available}} ()
\item 
static void \mbox{\hyperlink{classFFTCompressor_a14c0fe73ea0e578b85e1ecdb3f33f936}{free\+\_\+storage}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This class manages a lossy compression and decompression of a stream of floating-\/point numbers to a datagram, based a fourier transform algorithm (similar in principle to JPEG compression).

Actually, it doesn\textquotesingle{}t do any real compression on its own; it just outputs a stream of integers that should compress much tighter via gzip than the original stream of floats would have.

This class depends on the external FFTW library; without it, it will fall back on lossless output of the original data. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classFFTCompressor_a2c387817f720cd3c24d4b3da4f0efb8f}\label{classFFTCompressor_a2c387817f720cd3c24d4b3da4f0efb8f} 
\index{FFTCompressor@{FFTCompressor}!FFTCompressor@{FFTCompressor}}
\index{FFTCompressor@{FFTCompressor}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{FFTCompressor()}{FFTCompressor()}}
{\footnotesize\ttfamily FFTCompressor\+::\+FFTCompressor (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Constructs a new compressor object with default parameters. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classFFTCompressor_a14c0fe73ea0e578b85e1ecdb3f33f936}\label{classFFTCompressor_a14c0fe73ea0e578b85e1ecdb3f33f936} 
\index{FFTCompressor@{FFTCompressor}!free\_storage@{free\_storage}}
\index{free\_storage@{free\_storage}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{free\_storage()}{free\_storage()}}
{\footnotesize\ttfamily void FFTCompressor\+::free\+\_\+storage (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Frees memory that has been allocated during past runs of the \doxylink{classFFTCompressor}{FFTCompressor}. This is an optional call, but it may be made from time to time to empty the global cache that the compressor objects keep to facilitate fast compression/decompression. \Hypertarget{classFFTCompressor_ac230e4f377b5de19957e3f71a1d17912}\label{classFFTCompressor_ac230e4f377b5de19957e3f71a1d17912} 
\index{FFTCompressor@{FFTCompressor}!get\_quality@{get\_quality}}
\index{get\_quality@{get\_quality}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{get\_quality()}{get\_quality()}}
{\footnotesize\ttfamily int FFTCompressor\+::get\+\_\+quality (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Returns the quality number that was previously set via \doxylink{classFFTCompressor_a53b0db870b069e6bd5513963af476fe2}{set\+\_\+quality()}. \Hypertarget{classFFTCompressor_afb43202cf6584a4d164dbb954e1a5e1b}\label{classFFTCompressor_afb43202cf6584a4d164dbb954e1a5e1b} 
\index{FFTCompressor@{FFTCompressor}!get\_transpose\_quats@{get\_transpose\_quats}}
\index{get\_transpose\_quats@{get\_transpose\_quats}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{get\_transpose\_quats()}{get\_transpose\_quats()}}
{\footnotesize\ttfamily bool FFTCompressor\+::get\+\_\+transpose\+\_\+quats (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Returns the transpose\+\_\+quats flag. See \doxylink{classFFTCompressor_a237e1c694f1765f3f33e30e76e62763c}{set\+\_\+transpose\+\_\+quats()}. \Hypertarget{classFFTCompressor_a4fcfc32194b0a5aa3334b271596f28f1}\label{classFFTCompressor_a4fcfc32194b0a5aa3334b271596f28f1} 
\index{FFTCompressor@{FFTCompressor}!get\_use\_error\_threshold@{get\_use\_error\_threshold}}
\index{get\_use\_error\_threshold@{get\_use\_error\_threshold}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{get\_use\_error\_threshold()}{get\_use\_error\_threshold()}}
{\footnotesize\ttfamily bool FFTCompressor\+::get\+\_\+use\+\_\+error\+\_\+threshold (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}

Returns whether the error threshold measurement is enabled. See \doxylink{classFFTCompressor_a1ee5f3c053b9f9e3909bd9411ac471d9}{set\+\_\+use\+\_\+error\+\_\+threshold()}. \Hypertarget{classFFTCompressor_adaa64eb86e996609d2f7b3dcc9c47abe}\label{classFFTCompressor_adaa64eb86e996609d2f7b3dcc9c47abe} 
\index{FFTCompressor@{FFTCompressor}!is\_compression\_available@{is\_compression\_available}}
\index{is\_compression\_available@{is\_compression\_available}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{is\_compression\_available()}{is\_compression\_available()}}
{\footnotesize\ttfamily bool FFTCompressor\+::is\+\_\+compression\+\_\+available (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Returns true if the FFTW library is compiled in, so that this class is actually capable of doing useful compression/decompression work. Returns false otherwise, in which case any attempt to write a compressed stream will actually write an uncompressed stream, and any attempt to read a compressed stream will fail. \Hypertarget{classFFTCompressor_a67f6b46d2ee1d06ad4549eabdcc2c439}\label{classFFTCompressor_a67f6b46d2ee1d06ad4549eabdcc2c439} 
\index{FFTCompressor@{FFTCompressor}!read\_header@{read\_header}}
\index{read\_header@{read\_header}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{read\_header()}{read\_header()}}
{\footnotesize\ttfamily bool FFTCompressor\+::read\+\_\+header (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&}]{di,  }\item[{int}]{bam\+\_\+minor\+\_\+version }\end{DoxyParamCaption})}

Reads the compression header that was written previously. This fills in the compression parameters necessary to correctly decompress the following data.

Returns true if the header is read successfully, false otherwise. \Hypertarget{classFFTCompressor_a76ca57b16aec0fd3fc670a47f34a74b8}\label{classFFTCompressor_a76ca57b16aec0fd3fc670a47f34a74b8} 
\index{FFTCompressor@{FFTCompressor}!read\_hprs@{read\_hprs}}
\index{read\_hprs@{read\_hprs}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{read\_hprs()}{read\_hprs()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily bool FFTCompressor\+::read\+\_\+hprs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&}]{di,  }\item[{\mbox{\hyperlink{classpvector}{pvector}}$<$ LVec\+Base3 $>$ \&}]{array }\end{DoxyParamCaption})}

Reads an array of HPR angles. The result is pushed onto the end of the indicated vector, which is not cleared first; it is the user\textquotesingle{}s responsibility to ensure that the array is initially empty. \Hypertarget{classFFTCompressor_a2e5f1f242aa11d39af0a111739d8c3da}\label{classFFTCompressor_a2e5f1f242aa11d39af0a111739d8c3da} 
\index{FFTCompressor@{FFTCompressor}!read\_hprs@{read\_hprs}}
\index{read\_hprs@{read\_hprs}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{read\_hprs()}{read\_hprs()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily bool FFTCompressor\+::read\+\_\+hprs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&}]{di,  }\item[{\mbox{\hyperlink{classpvector}{pvector}}$<$ LVec\+Base3 $>$ \&}]{array,  }\item[{bool}]{new\+\_\+hpr }\end{DoxyParamCaption})}

Reads an array of HPR angles. The result is pushed onto the end of the indicated vector, which is not cleared first; it is the user\textquotesingle{}s responsibility to ensure that the array is initially empty.

new\+\_\+hpr is a temporary, transitional parameter. If it is set false, the hprs are decompressed according to the old, broken hpr calculation; if true, the hprs are decompressed according to the new, correct hpr calculation. \Hypertarget{classFFTCompressor_a1be8ffd0b57154f9e36b163ebb85f2d0}\label{classFFTCompressor_a1be8ffd0b57154f9e36b163ebb85f2d0} 
\index{FFTCompressor@{FFTCompressor}!read\_reals@{read\_reals}}
\index{read\_reals@{read\_reals}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{read\_reals()}{read\_reals()}}
{\footnotesize\ttfamily bool FFTCompressor\+::read\+\_\+reals (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagramIterator}{Datagram\+Iterator}} \&}]{di,  }\item[{vector\+\_\+stdfloat \&}]{array }\end{DoxyParamCaption})}

Reads an array of floating-\/point numbers. The result is pushed onto the end of the indicated vector, which is not cleared first; it is the user\textquotesingle{}s responsibility to ensure that the array is initially empty. Returns true if the data is read correctly, false if there is an error. \Hypertarget{classFFTCompressor_a53b0db870b069e6bd5513963af476fe2}\label{classFFTCompressor_a53b0db870b069e6bd5513963af476fe2} 
\index{FFTCompressor@{FFTCompressor}!set\_quality@{set\_quality}}
\index{set\_quality@{set\_quality}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{set\_quality()}{set\_quality()}}
{\footnotesize\ttfamily void FFTCompressor\+::set\+\_\+quality (\begin{DoxyParamCaption}\item[{int}]{quality }\end{DoxyParamCaption})}

Sets the quality factor for the compression. This is an integer in the range 0 -\/ 100 that roughly controls how aggressively the reals are compressed; lower numbers mean smaller output, and more data loss.

There are a few special cases. Quality -\/1 means to use whatever individual parameters are set in the user\textquotesingle{}s Configrc file, rather than the single quality dial. Quality 101 or higher means to generate lossless output (this is the default if libfftw is not available).

Quality 102 writes all four components of quaternions to the output file, rather than just three, quality 103 converts hpr to matrix (instead of quat) and writes a 9-\/component matrix, and quality 104 just writes out hpr directly. Quality levels 102 and greater are strictly for debugging purposes, and are only available if NDEBUG is not defined. \Hypertarget{classFFTCompressor_a237e1c694f1765f3f33e30e76e62763c}\label{classFFTCompressor_a237e1c694f1765f3f33e30e76e62763c} 
\index{FFTCompressor@{FFTCompressor}!set\_transpose\_quats@{set\_transpose\_quats}}
\index{set\_transpose\_quats@{set\_transpose\_quats}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{set\_transpose\_quats()}{set\_transpose\_quats()}}
{\footnotesize\ttfamily void FFTCompressor\+::set\+\_\+transpose\+\_\+quats (\begin{DoxyParamCaption}\item[{bool}]{flag }\end{DoxyParamCaption})}

Sets the transpose\+\_\+quats flag. This is provided mainly for backward compatibility with old bam files that were written out with the quaternions inadvertently transposed. \Hypertarget{classFFTCompressor_a1ee5f3c053b9f9e3909bd9411ac471d9}\label{classFFTCompressor_a1ee5f3c053b9f9e3909bd9411ac471d9} 
\index{FFTCompressor@{FFTCompressor}!set\_use\_error\_threshold@{set\_use\_error\_threshold}}
\index{set\_use\_error\_threshold@{set\_use\_error\_threshold}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{set\_use\_error\_threshold()}{set\_use\_error\_threshold()}}
{\footnotesize\ttfamily void FFTCompressor\+::set\+\_\+use\+\_\+error\+\_\+threshold (\begin{DoxyParamCaption}\item[{bool}]{use\+\_\+error\+\_\+threshold }\end{DoxyParamCaption})}

Enables or disables the use of the error threshold measurement to put a cap on the amount of damage done by lossy compression. When this is enabled, the potential results of the compression are analyzed before the data is written; if it is determined that the compression will damage a particular string of reals too much, that particular string of reals is written uncompressed. \Hypertarget{classFFTCompressor_ae4cae5073d6e047daeb3a2ed61a32838}\label{classFFTCompressor_ae4cae5073d6e047daeb3a2ed61a32838} 
\index{FFTCompressor@{FFTCompressor}!write\_header@{write\_header}}
\index{write\_header@{write\_header}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{write\_header()}{write\_header()}}
{\footnotesize\ttfamily void FFTCompressor\+::write\+\_\+header (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagram}{Datagram}} \&}]{datagram }\end{DoxyParamCaption})}

Writes the compression parameters to the indicated datagram. It is necessary to call this before writing anything else to the datagram, since these parameters will be necessary to correctly decompress the data later. \Hypertarget{classFFTCompressor_aedf56c07b9bf59a1abeba6cb65b73dfe}\label{classFFTCompressor_aedf56c07b9bf59a1abeba6cb65b73dfe} 
\index{FFTCompressor@{FFTCompressor}!write\_hprs@{write\_hprs}}
\index{write\_hprs@{write\_hprs}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{write\_hprs()}{write\_hprs()}}
{\footnotesize\ttfamily void FFTCompressor\+::write\+\_\+hprs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagram}{Datagram}} \&}]{datagram,  }\item[{const LVec\+Base3 \texorpdfstring{$\ast$}{*}}]{array,  }\item[{int}]{length }\end{DoxyParamCaption})}

Writes an array of HPR angles to the indicated datagram. \Hypertarget{classFFTCompressor_ae97e74c103db5941590843c2cc88bcab}\label{classFFTCompressor_ae97e74c103db5941590843c2cc88bcab} 
\index{FFTCompressor@{FFTCompressor}!write\_reals@{write\_reals}}
\index{write\_reals@{write\_reals}!FFTCompressor@{FFTCompressor}}
\doxysubsubsection{\texorpdfstring{write\_reals()}{write\_reals()}}
{\footnotesize\ttfamily void FFTCompressor\+::write\+\_\+reals (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classDatagram}{Datagram}} \&}]{datagram,  }\item[{const PN\+\_\+stdfloat \texorpdfstring{$\ast$}{*}}]{array,  }\item[{int}]{length }\end{DoxyParamCaption})}

Writes an array of floating-\/point numbers to the indicated datagram. 

The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
panda/src/mathutil/\mbox{\hyperlink{fftCompressor_8h}{fft\+Compressor.\+h}}\item 
panda/src/mathutil/\mbox{\hyperlink{fftCompressor_8cxx}{fft\+Compressor.\+cxx}}\end{DoxyCompactItemize}
