\doxysection{actor\+Node.\+cxx}
\hypertarget{actorNode_8cxx_source}{}\label{actorNode_8cxx_source}\index{panda/src/physics/actorNode.cxx@{panda/src/physics/actorNode.cxx}}
\mbox{\hyperlink{actorNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{actorNode_8h}{actorNode.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__physics_8h}{config\_physics.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{physicsObject_8h}{physicsObject.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{transformState_8h}{transformState.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ ActorNode::\_type\_handle;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00025\ ActorNode::}
\DoxyCodeLine{00026\ ActorNode(\textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00027\ \ \ \ \ \mbox{\hyperlink{classPhysicalNode}{PhysicalNode}}(name)\ \{}
\DoxyCodeLine{00028\ \ \ \_contact\_vector\ =\ LVector3::zero();}
\DoxyCodeLine{00029\ \ \ add\_physical(\textcolor{keyword}{new}\ \mbox{\hyperlink{classPhysical}{Physical}}(1,\ \textcolor{keyword}{true}));}
\DoxyCodeLine{00030\ \ \ \_mass\_center\ =\ get\_physical(0)-\/>get\_phys\_body();}
\DoxyCodeLine{00031\ \ \ \_mass\_center-\/>set\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\ \ \#ifndef\ NDEBUG}}
\DoxyCodeLine{00033\ \ \ \ \ \_mass\_center-\/>set\_name(name);}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\ \ \#endif}}
\DoxyCodeLine{00035\ \ \ \_ok\_to\_callback\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00036\ \ \ \_transform\_limit\ =\ 0.0;}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00042\ ActorNode::}
\DoxyCodeLine{00043\ ActorNode(\textcolor{keyword}{const}\ \mbox{\hyperlink{classActorNode}{ActorNode}}\ \&copy)\ :}
\DoxyCodeLine{00044\ \ \ \mbox{\hyperlink{classPhysicalNode}{PhysicalNode}}(copy)\ \{}
\DoxyCodeLine{00045\ \ \ \_contact\_vector\ =\ LVector3::zero();}
\DoxyCodeLine{00046\ \ \ \_ok\_to\_callback\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00047\ \ \ \_mass\_center\ =\ get\_physical(0)-\/>get\_phys\_body();}
\DoxyCodeLine{00048\ \ \ \_transform\_limit\ =\ copy.\_transform\_limit;}
\DoxyCodeLine{00049\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00054\ ActorNode::}
\DoxyCodeLine{00055\ \string~ActorNode()\ \{}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00062\ \textcolor{keywordtype}{void}\ ActorNode::}
\DoxyCodeLine{00063\ update\_transform()\ \{}
\DoxyCodeLine{00064\ \ \ LMatrix4\ lcs\ =\ \_mass\_center-\/>\mbox{\hyperlink{classPhysicsObject_a60c0a9a723c00b5f71e7853cfdb11027}{get\_lcs}}();}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ lock\ the\ callback\ so\ that\ this\ doesn't\ call\ transform\_changed.}}
\DoxyCodeLine{00067\ \ \ \_ok\_to\_callback\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classPandaNode_a47b2c6957f65738cd8fcbc66c0603638}{set\_transform}}(TransformState::make\_mat(lcs));}
\DoxyCodeLine{00069\ \ \ \_ok\_to\_callback\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{void}\ ActorNode::}
\DoxyCodeLine{00078\ test\_transform(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *ts)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ LPoint3\ pos(ts-\/>get\_pos());}
\DoxyCodeLine{00080\ \ \ nassertv(pos[0]\ <\ \_transform\_limit);}
\DoxyCodeLine{00081\ \ \ nassertv(pos[0]\ >\ -\/\_transform\_limit);}
\DoxyCodeLine{00082\ \ \ nassertv(pos[1]\ <\ \_transform\_limit);}
\DoxyCodeLine{00083\ \ \ nassertv(pos[1]\ >\ -\/\_transform\_limit);}
\DoxyCodeLine{00084\ \ \ nassertv(pos[2]\ <\ \_transform\_limit);}
\DoxyCodeLine{00085\ \ \ nassertv(pos[2]\ >\ -\/\_transform\_limit);}
\DoxyCodeLine{00086\ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{void}\ ActorNode::}
\DoxyCodeLine{00094\ transform\_changed()\ \{}
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{classPandaNode_a28a4ed8dab3b2bcd2a686712b9e391d6}{PandaNode::transform\_changed}}();}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{comment}{//\ this\ callback\ could\ be\ triggered\ by\ update\_transform,\ BAD.}}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{if}\ (!\_ok\_to\_callback)\ \{}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ get\ the\ transform}}
\DoxyCodeLine{00103\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ transform\ =\ get\_transform();}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{if}\ (\_transform\_limit\ >\ 0.0)\ \{}
\DoxyCodeLine{00106\ \ \ \ \ test\_transform(transform);}
\DoxyCodeLine{00107\ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \textcolor{comment}{//\ extract\ the\ orientation}}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{if}\ (\_mass\_center-\/>get\_oriented()\ ==\ \textcolor{keyword}{true})\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \_mass\_center-\/>set\_orientation(transform-\/>get\_quat());}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{comment}{//\ apply}}
\DoxyCodeLine{00115\ \ \ \_mass\_center-\/>set\_position(transform-\/>get\_pos());}
\DoxyCodeLine{00116\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ ActorNode::}
\DoxyCodeLine{00123\ write(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\ \ \#ifndef\ NDEBUG\ }\textcolor{comment}{//[}}
\DoxyCodeLine{00125\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}});\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}ActorNode:\(\backslash\)n"{}};}
\DoxyCodeLine{00126\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_ok\_to\_callback\ "{}}<<\_ok\_to\_callback<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00127\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_mass\_center\(\backslash\)n"{}};}
\DoxyCodeLine{00128\ \ \ \_mass\_center-\/>\mbox{\hyperlink{classPhysicsObject_a9b67be7b85c25974bead0d718677c97e}{write}}(out,\ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+4);}
\DoxyCodeLine{00129\ \ \ PhysicalNode::write(out,\ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\ \ \#endif\ }\textcolor{comment}{//]\ NDEBUG}}
\DoxyCodeLine{00131\ \}}

\end{DoxyCode}
