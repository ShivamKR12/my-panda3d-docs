\doxysection{mac\+Stats\+Server.\+mm}
\hypertarget{macStatsServer_8mm_source}{}\label{macStatsServer_8mm_source}\index{pandatool/src/mac-\/stats/macStatsServer.mm@{pandatool/src/mac-\/stats/macStatsServer.mm}}
\mbox{\hyperlink{macStatsServer_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsServer_8h}{macStatsServer.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsMonitor_8h}{macStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsAppDelegate_8h}{macStatsAppDelegate.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}pandaVersion.h"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatGraph_8h}{pStatGraph.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pstatclient_8h}{config\_pstatclient.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <unistd.h>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ MacStatsServer::}
\DoxyCodeLine{00027\ MacStatsServer()\ :\ \_port(pstats\_port)\ \{}
\DoxyCodeLine{00028\ \ \ set\_program\_brief(\textcolor{stringliteral}{"{}macOS\ PStats\ client"{}});}
\DoxyCodeLine{00029\ \ \ set\_program\_description}
\DoxyCodeLine{00030\ \ \ \ \ (\textcolor{stringliteral}{"{}This\ is\ a\ GUI-\/based\ PStats\ server\ that\ listens\ on\ a\ TCP\ port\ for\ a\ "{}}}
\DoxyCodeLine{00031\ \ \ \ \ \ \textcolor{stringliteral}{"{}connection\ from\ a\ PStatClient\ in\ a\ Panda3D\ application.\ \ It\ offers\ "{}}}
\DoxyCodeLine{00032\ \ \ \ \ \ \textcolor{stringliteral}{"{}various\ graphs\ for\ showing\ the\ timing\ information\ sent\ by\ the\ client."{}}}
\DoxyCodeLine{00033\ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)n"{}}}
\DoxyCodeLine{00034\ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ full\ documentation\ is\ available\ online:\(\backslash\)n\ \ "{}}}
\DoxyCodeLine{00035\ \#ifdef\ HAVE\_PYTHON}
\DoxyCodeLine{00036\ \ \ \ \ \ \textcolor{stringliteral}{"{}https://docs.panda3d.org/"{}}\ PANDA\_ABI\_VERSION\_STR\ \textcolor{stringliteral}{"{}/python/optimization/pstats"{}}}
\DoxyCodeLine{00037\ \#\textcolor{keywordflow}{else}}
\DoxyCodeLine{00038\ \ \ \ \ \ \textcolor{stringliteral}{"{}https://docs.panda3d.org/"{}}\ PANDA\_ABI\_VERSION\_STR\ \textcolor{stringliteral}{"{}/cpp/optimization/pstats"{}}}
\DoxyCodeLine{00039\ \#endif}
\DoxyCodeLine{00040\ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ add\_option}
\DoxyCodeLine{00043\ \ \ \ \ (\textcolor{stringliteral}{"{}p"{}},\ \textcolor{stringliteral}{"{}port"{}},\ 0,}
\DoxyCodeLine{00044\ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ TCP\ port\ to\ listen\ for\ connections\ on.\ \ By\ default,\ this\ "{}}}
\DoxyCodeLine{00045\ \ \ \ \ \ \textcolor{stringliteral}{"{}is\ taken\ from\ the\ pstats-\/port\ Config\ variable."{}},}
\DoxyCodeLine{00046\ \ \ \ \ \ \&\mbox{\hyperlink{classProgramBase_a7ee663294fb0c41caed1d9045ccf750d}{ProgramBase::dispatch\_int}},\ \textcolor{keyword}{nullptr},\ \&\_port);}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ add\_runline(\textcolor{stringliteral}{"{}[-\/p\ 5185]"{}});}
\DoxyCodeLine{00049\ \ \ add\_runline(\textcolor{stringliteral}{"{}session.pstats"{}});}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \_last\_session\ =\ \mbox{\hyperlink{classFilename_a73834ff912339f4d780d4fa235cb6826}{Filename::expand\_from}}(}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{stringliteral}{"{}\$HOME/Library/Caches/Panda3D-\/"{}}\ PANDA\_ABI\_VERSION\_STR\ \textcolor{stringliteral}{"{}/last-\/session.pstats"{}});}
\DoxyCodeLine{00053\ \ \ \_last\_session.set\_binary();}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ create\_app();}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00061\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsServer_af4686237f957eb479faa0065505bd44b}{MacStatsServer::}}}
\DoxyCodeLine{00062\ \mbox{\hyperlink{classMacStatsServer_af4686237f957eb479faa0065505bd44b}{run}}(\textcolor{keywordtype}{int}\ argc,\ \textcolor{keywordtype}{char}\ *argv[])\ \{}
\DoxyCodeLine{00063\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classProgramBase_a913a6fb59976859148d117c3f65b8a2d}{parse\_command\_line}}(argc,\ argv,\ isatty(STDERR\_FILENO))\ ==\ ProgramBase::EC\_failure)\ \{}
\DoxyCodeLine{00064\ \ \ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00065\ \ \ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00066\ \ \ \ \ alert.informativeText\ =\ \textcolor{stringliteral}{@"{}Failed\ to\ parse\ command-\/line\ options."{}};}
\DoxyCodeLine{00067\ \ \ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00068\ \ \ \ \ [alert\ runModal];}
\DoxyCodeLine{00069\ \ \ \ \ [alert\ release];}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ [\_app\ \mbox{\hyperlink{classMacStatsServer_af4686237f957eb479faa0065505bd44b}{run}}];}
\DoxyCodeLine{00074\ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00081\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_ad74b86e917338eeacd47a75a5a9f65cd}{MacStatsServer::}}}
\DoxyCodeLine{00082\ \mbox{\hyperlink{classMacStatsServer_ad74b86e917338eeacd47a75a5a9f65cd}{handle\_args}}(\mbox{\hyperlink{classpdeque}{ProgramBase::Args}}\ \&args)\ \{}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordflow}{if}\ (args.empty())\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//\ applicationDidFinishLaunching\ will\ call\ new\_session().}}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00086\ \ \ \}}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (args.size()\ ==\ 1)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ Handled\ by\ application:openFile:}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00092\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}At\ most\ one\ filename\ may\ be\ specified\ on\ the\ command-\/line.\(\backslash\)n"{}};}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00094\ \ \ \}}
\DoxyCodeLine{00095\ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00100\ \mbox{\hyperlink{classPStatMonitor}{PStatMonitor}}\ *MacStatsServer::}
\DoxyCodeLine{00101\ make\_monitor(\textcolor{keyword}{const}\ \mbox{\hyperlink{classNetAddress}{NetAddress}}\ \&address)\ \{}
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ Enable\ the\ "{}New\ Session"{},\ "{}Save\ Session"{}\ and\ "{}Close\ Session"{}\ menu\ items.}}
\DoxyCodeLine{00103\ \ \ \_new\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00104\ \ \ \_save\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00105\ \ \ \_close\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00106\ \ \ \_export\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ NSUserNotificationCenter\ *center\ =\ [NSUserNotificationCenter\ defaultUserNotificationCenter];}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}\ (\_listening\_notification\ !=\ nil)\ \{}
\DoxyCodeLine{00110\ \ \ \ \ [center\ removeDeliveredNotification:\_listening\_notification];}
\DoxyCodeLine{00111\ \ \ \ \ [\_listening\_notification\ release];}
\DoxyCodeLine{00112\ \ \ \ \ \_listening\_notification\ =\ nil;}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \_monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{return}\ \_monitor;}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsServer_a5efb7c53c3c8ffcb1dcb968b6e742303}{MacStatsServer::}}}
\DoxyCodeLine{00123\ \mbox{\hyperlink{classMacStatsServer_a5efb7c53c3c8ffcb1dcb968b6e742303}{lost\_connection}}(\mbox{\hyperlink{classPStatMonitor}{PStatMonitor}}\ *monitor)\ \{}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !\_monitor-\/>\_have\_data)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{comment}{//\ We\ didn't\ have\ any\ data\ yet.\ \ Just\ silently\ restart\ the\ session.}}
\DoxyCodeLine{00126\ \ \ \ \ \_monitor-\/>close();}
\DoxyCodeLine{00127\ \ \ \ \ \_monitor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMacStatsServer_a1b6f5bcaeaad68e724518b4dee7ab031}{new\_session}}())\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ Store\ a\ backup\ now,\ in\ case\ PStats\ crashes\ or\ something.}}
\DoxyCodeLine{00133\ \ \ \ \ \_last\_session.\mbox{\hyperlink{classFilename_aa3072a14bec6fccd0e7befca5863a35c}{make\_dir}}();}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{if}\ (monitor-\/>\mbox{\hyperlink{classPStatMonitor_aace5334b65153a6e02b9853cad6f915e}{write}}(\_last\_session))\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Wrote\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00136\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ write\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00138\ \ \ \ \ \}}
\DoxyCodeLine{00139\ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{classPStatServer_a770f50f78edc517a443275ace6acf82a}{stop\_listening}}();}
\DoxyCodeLine{00142\ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00147\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_a1b6f5bcaeaad68e724518b4dee7ab031}{MacStatsServer::}}}
\DoxyCodeLine{00148\ \mbox{\hyperlink{classMacStatsServer_a1b6f5bcaeaad68e724518b4dee7ab031}{new\_session}}()\ \{}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMacStatsServer_a5086f5fbcb6a7a4235715d2c0816a2c2}{close\_session}}())\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00151\ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatServer_ad3f87babd63a32b193b96f90c3cad21e}{listen}}(\_port))\ \{}
\DoxyCodeLine{00154\ \ \ \ \ NSUserNotification\ *notification\ =\ [[NSUserNotification\ alloc]\ init];}
\DoxyCodeLine{00155\ \ \ \ \ notification.title\ =\ \textcolor{stringliteral}{@"{}PStats\ Server"{}};}
\DoxyCodeLine{00156\ \ \ \ \ notification.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Waiting\ for\ client\ to\ connect\ on\ port\ \%d\(\backslash\)u2026"{}},\ \_port];}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ Quick\ way\ to\ do\ something\ else\ if\ the\ user\ prefers.}}
\DoxyCodeLine{00159\ \ \ \ \ notification.additionalActions\ =\ @[}
\DoxyCodeLine{00160\ \ \ \ \ \ \ [NSUserNotificationAction\ actionWithIdentifier:\textcolor{stringliteral}{@"{}open"{}}\ title:\textcolor{stringliteral}{@"{}Open\ Session\(\backslash\)u2026"{}}],}
\DoxyCodeLine{00161\ \ \ \ \ \ \ [NSUserNotificationAction\ actionWithIdentifier:\textcolor{stringliteral}{@"{}openLast"{}}\ title:\textcolor{stringliteral}{@"{}Open\ Last\ Session"{}}],}
\DoxyCodeLine{00162\ \ \ \ \ \ \ [NSUserNotificationAction\ actionWithIdentifier:\textcolor{stringliteral}{@"{}quit"{}}\ title:\textcolor{stringliteral}{@"{}Quit\ PStats"{}}]}
\DoxyCodeLine{00163\ \ \ \ \ ];}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ NSUserNotificationCenter\ *center\ =\ [NSUserNotificationCenter\ defaultUserNotificationCenter];}
\DoxyCodeLine{00166\ \ \ \ \ [center\ deliverNotification:notification];}
\DoxyCodeLine{00167\ \ \ \ \ \_listening\_notification\ =\ notification;}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \_new\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00170\ \ \ \ \ \_save\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00171\ \ \ \ \ \_close\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00172\ \ \ \ \ \_export\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00175\ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00178\ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00179\ \ \ alert.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Unable\ to\ open\ port\ \%d.\ \ Try\ specifying\ a\ different\ port\ number\ using\ pstats-\/port\ in\ your\ Config\ file\ or\ the\ -\/p\ option\ on\ the\ command-\/line."{}},\ \_port];}
\DoxyCodeLine{00180\ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00181\ \ \ [alert\ runModal];}
\DoxyCodeLine{00182\ \ \ [alert\ release];}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00185\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00190\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{MacStatsServer::}}}
\DoxyCodeLine{00191\ \mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{open\_session}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fn)\ \{}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMacStatsServer_a5086f5fbcb6a7a4235715d2c0816a2c2}{close\_session}}())\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00194\ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{if}\ (!monitor-\/>\mbox{\hyperlink{classPStatMonitor_a0e003c0bf21c1d000fd41185a261412b}{read}}(fn))\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keyword}{delete}\ monitor;}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \_save\_filename\ =\ fn;}
\DoxyCodeLine{00203\ \ \ \_new\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00204\ \ \ \_save\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00205\ \ \ \_close\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00206\ \ \ \_export\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \_monitor\ =\ monitor;}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{comment}{//\ If\ the\ file\ contained\ no\ graphs,\ open\ the\ default\ graphs.}}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (monitor-\/>\_graphs.empty())\ \{}
\DoxyCodeLine{00212\ \ \ \ \ monitor-\/>\mbox{\hyperlink{classPStatMonitor_aa088e596e90d348e4624b7a9b687aa5c}{open\_default\_graphs}}();}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00216\ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00221\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{MacStatsServer::}}}
\DoxyCodeLine{00222\ \mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{open\_session}}()\ \{}
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classMacStatsServer_a5086f5fbcb6a7a4235715d2c0816a2c2}{close\_session}}())\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00225\ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ NSOpenPanel\ *panel\ =\ [NSOpenPanel\ openPanel];}
\DoxyCodeLine{00228\ \ \ panel.title\ =\ \textcolor{stringliteral}{@"{}Open\ Session"{}};}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{if}\ ([panel\ runModal]\ ==\ NSModalResponseOK)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ NSString\ *path\ =\ [[panel.URLs\ firstObject]\ path];}
\DoxyCodeLine{00232\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn([path\ UTF8String]);}
\DoxyCodeLine{00233\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{open\_session}}(fn))\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00236\ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00239\ \ \ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00240\ \ \ \ \ alert.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Failed\ to\ load\ session\ file:\ \%s"{}},\ fn.c\_str()];}
\DoxyCodeLine{00241\ \ \ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00242\ \ \ \ \ [alert\ runModal];}
\DoxyCodeLine{00243\ \ \ \ \ [alert\ release];}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00247\ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00252\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_a36950b2e2e8a57f77e95d506763f9683}{MacStatsServer::}}}
\DoxyCodeLine{00253\ \mbox{\hyperlink{classMacStatsServer_a36950b2e2e8a57f77e95d506763f9683}{open\_last\_session}}()\ \{}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classMacStatsServer_aa331c2b85cbafcc69679c3cc4e030902}{open\_session}}(\_last\_session))\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00259\ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00260\ \ \ alert.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Failed\ to\ load\ session\ file:\ \%s"{}},\ \_last\_session.c\_str()];}
\DoxyCodeLine{00261\ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00262\ \ \ [alert\ runModal];}
\DoxyCodeLine{00263\ \ \ [alert\ release];}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00266\ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00271\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_adda6893db904fa1be0099f4a2d8f303e}{MacStatsServer::}}}
\DoxyCodeLine{00272\ \mbox{\hyperlink{classMacStatsServer_adda6893db904fa1be0099f4a2d8f303e}{save\_session}}()\ \{}
\DoxyCodeLine{00273\ \ \ nassertr\_always(\_monitor\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ NSSavePanel\ *panel\ =\ [NSSavePanel\ savePanel];}
\DoxyCodeLine{00276\ \ \ panel.title\ =\ \textcolor{stringliteral}{@"{}Save\ Session"{}};}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{keywordflow}{if}\ (\_save\_filename.empty())\ \{}
\DoxyCodeLine{00279\ \ \ \ \ panel.nameFieldStringValue\ =\ \textcolor{stringliteral}{@"{}session.pstats"{}};}
\DoxyCodeLine{00280\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00281\ \ \ \ \ std::string\ dirname\ =\ \_save\_filename.get\_dirname();}
\DoxyCodeLine{00282\ \ \ \ \ std::string\ basename\ =\ \_save\_filename.get\_basename();}
\DoxyCodeLine{00283\ \ \ \ \ panel.nameFieldStringValue\ =\ [NSString\ stringWithUTF8String:basename.c\_str()];}
\DoxyCodeLine{00284\ \ \ \ \ panel.directoryURL\ =\ [NSURL\ fileURLWithPath:[NSString\ stringWithUTF8String:dirname.c\_str()]];}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{if}\ ([panel\ runModal]\ ==\ NSModalResponseOK)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ NSString\ *path\ =\ [panel.URL\ path];}
\DoxyCodeLine{00289\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn([path\ UTF8String]);}
\DoxyCodeLine{00290\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_monitor-\/>write(fn))\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00294\ \ \ \ \ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00295\ \ \ \ \ \ \ alert.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Failed\ to\ save\ session\ file:\ \%s"{}},\ fn.c\_str()];}
\DoxyCodeLine{00296\ \ \ \ \ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00297\ \ \ \ \ \ \ [alert\ runModal];}
\DoxyCodeLine{00298\ \ \ \ \ \ \ [alert\ release];}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00301\ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \ \ \_save\_filename\ =\ fn;}
\DoxyCodeLine{00303\ \ \ \ \ \_monitor-\/>get\_client\_data()-\/>clear\_dirty();}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00305\ \ \ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00308\ \}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00313\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_a4f43ef4e982cf9fb36b5b8f6d96d5d2d}{MacStatsServer::}}}
\DoxyCodeLine{00314\ \mbox{\hyperlink{classMacStatsServer_a4f43ef4e982cf9fb36b5b8f6d96d5d2d}{export\_session}}()\ \{}
\DoxyCodeLine{00315\ \ \ nassertr\_always(\_monitor\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{true});}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ NSSavePanel\ *panel\ =\ [NSSavePanel\ savePanel];}
\DoxyCodeLine{00318\ \ \ panel.title\ =\ \textcolor{stringliteral}{@"{}Export\ Session"{}};}
\DoxyCodeLine{00319\ \ \ panel.nameFieldStringValue\ =\ \textcolor{stringliteral}{@"{}session.json"{}};}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{if}\ ([panel\ runModal]\ ==\ NSModalResponseOK)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ NSString\ *path\ =\ [panel.URL\ path];}
\DoxyCodeLine{00323\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ fn([path\ UTF8String]);}
\DoxyCodeLine{00324\ \ \ \ \ fn.set\_binary();}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \ \ std::ofstream\ stream;}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{if}\ (!fn.\mbox{\hyperlink{classFilename_ad37a9d52c837218b01076de184dc5f4d}{open\_write}}(stream))\ \{}
\DoxyCodeLine{00328\ \ \ \ \ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00329\ \ \ \ \ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}PStats\ Error"{}};}
\DoxyCodeLine{00330\ \ \ \ \ \ \ alert.informativeText\ =\ [NSString\ stringWithFormat:\textcolor{stringliteral}{@"{}Failed\ to\ open\ file\ for\ export:\ \%s"{}},\ fn.c\_str()];}
\DoxyCodeLine{00331\ \ \ \ \ \ \ alert.alertStyle\ =\ NSCriticalAlertStyle;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ [alert\ runModal];}
\DoxyCodeLine{00333\ \ \ \ \ \ \ [alert\ release];}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00336\ \ \ \ \ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordtype}{int}\ pid\ =\ \_monitor-\/>get\_client\_pid();}
\DoxyCodeLine{00339\ \ \ \ \ \_monitor-\/>get\_client\_data()-\/>write\_json(stream,\ std::max(0,\ pid));}
\DoxyCodeLine{00340\ \ \ \ \ stream.close();}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00342\ \ \ \}}
\DoxyCodeLine{00343\ }
\DoxyCodeLine{00344\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00345\ \}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00350\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsServer_a5086f5fbcb6a7a4235715d2c0816a2c2}{MacStatsServer::}}}
\DoxyCodeLine{00351\ \mbox{\hyperlink{classMacStatsServer_a5086f5fbcb6a7a4235715d2c0816a2c2}{close\_session}}()\ \{}
\DoxyCodeLine{00352\ \ \ \textcolor{keywordtype}{bool}\ wrote\_last\_session\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =\ \_monitor-\/>get\_client\_data();}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{if}\ (client\_data\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_ad5cd3be63341b509d48fdee720ee8d12}{is\_dirty}}())\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_monitor-\/>has\_read\_filename())\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \_last\_session.\mbox{\hyperlink{classFilename_aa3072a14bec6fccd0e7befca5863a35c}{make\_dir}}();}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_monitor-\/>write(\_last\_session))\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Wrote\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ wrote\_last\_session\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Failed\ to\ write\ to\ "{}}\ <<\ \_last\_session\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ alert\ goes\ on\ top.}}
\DoxyCodeLine{00369\ \ \ \ \ \ \ [\_app\ activateIgnoringOtherApps:YES];}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ NSAlert\ *alert\ =\ [[NSAlert\ alloc]\ init];}
\DoxyCodeLine{00372\ \ \ \ \ \ \ alert.messageText\ =\ \textcolor{stringliteral}{@"{}Unsaved\ Data"{}};}
\DoxyCodeLine{00373\ \ \ \ \ \ \ alert.informativeText\ =\ \textcolor{stringliteral}{@"{}Would\ you\ like\ to\ save\ the\ currently\ open\ session?"{}};}
\DoxyCodeLine{00374\ \ \ \ \ \ \ [alert\ addButtonWithTitle:\textcolor{stringliteral}{@"{}Save\(\backslash\)u2026"{}}];}
\DoxyCodeLine{00375\ \ \ \ \ \ \ [alert\ addButtonWithTitle:\textcolor{stringliteral}{@"{}Don't\ Save"{}}];}
\DoxyCodeLine{00376\ \ \ \ \ \ \ [alert\ addButtonWithTitle:\textcolor{stringliteral}{@"{}Cancel"{}}];}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ response\ =\ [alert\ runModal];}
\DoxyCodeLine{00378\ \ \ \ \ \ \ [alert\ release];}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((response\ !=\ 1000\ \&\&\ response\ !=\ 1001)\ ||}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ (response\ ==\ 1000\ \&\&\ !\mbox{\hyperlink{classMacStatsServer_adda6893db904fa1be0099f4a2d8f303e}{save\_session}}()))\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \_monitor-\/>close();}
\DoxyCodeLine{00387\ \ \ \ \ \_monitor\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00388\ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \_save\_filename\ =\ \mbox{\hyperlink{classFilename}{Filename}}();}
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{classPStatServer_a770f50f78edc517a443275ace6acf82a}{stop\_listening}}();}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \textcolor{keywordflow}{if}\ (\_listening\_notification\ !=\ nil)\ \{}
\DoxyCodeLine{00394\ \ \ \ \ NSUserNotificationCenter\ *center\ =\ [NSUserNotificationCenter\ defaultUserNotificationCenter];}
\DoxyCodeLine{00395\ \ \ \ \ [center\ removeDeliveredNotification:\_listening\_notification];}
\DoxyCodeLine{00396\ \ \ \ \ [\_listening\_notification\ release];}
\DoxyCodeLine{00397\ \ \ \ \ \_listening\_notification\ =\ nil;}
\DoxyCodeLine{00398\ \ \ \}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \_new\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{if}\ (wrote\_last\_session)\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \_open\_last\_session\_menu\_item.enabled\ =\ YES;}
\DoxyCodeLine{00403\ \ \ \}}
\DoxyCodeLine{00404\ \ \ \_save\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00405\ \ \ \_close\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00406\ \ \ \_export\_session\_menu\_item.enabled\ =\ NO;}
\DoxyCodeLine{00407\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00408\ \}}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00416\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsServer_aada3447590f4eb4405f3d164956e74bb}{MacStatsServer::}}}
\DoxyCodeLine{00417\ \mbox{\hyperlink{classMacStatsServer_aada3447590f4eb4405f3d164956e74bb}{set\_show\_status\_item}}(\textcolor{keywordtype}{bool}\ show)\ \{}
\DoxyCodeLine{00418\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00419\ \ \ \ \ \_monitor-\/>set\_show\_status\_item(show);}
\DoxyCodeLine{00420\ \ \ \}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \_show\_status\_item\_menu\_item.state\ =\ show\ ?\ NSOnState\ :\ NSOffState;}
\DoxyCodeLine{00423\ \}}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00428\ \textcolor{keywordtype}{void}\ MacStatsServer::}
\DoxyCodeLine{00429\ set\_appearance(NSString\ *name)\ \{}
\DoxyCodeLine{00430\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 10.14,\ *))\ \{}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordflow}{if}\ (name\ ==\ nil\ ||\ name.length\ ==\ 0)\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ [\_app\ setAppearance:nil];}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \_appearance\_system\_menu\_item.state\ =\ NSOnState;}
\DoxyCodeLine{00434\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ [\_app\ setAppearance:[NSAppearance\ appearanceNamed:name]];}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \_appearance\_system\_menu\_item.state\ =\ NSOffState;}
\DoxyCodeLine{00437\ \ \ \ \ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \_appearance\_aqua\_menu\_item.state\ =\ (name\ !=\ nil\ \&\&\ [name\ isEqual:\textcolor{stringliteral}{@"{}NSAppearanceNameAqua"{}}])\ ?\ NSOnState\ :\ NSOffState;}
\DoxyCodeLine{00440\ \ \ \ \ \_appearance\_dark\_aqua\_menu\_item.state\ =\ (name\ !=\ nil\ \&\&\ [name\ isEqual:\textcolor{stringliteral}{@"{}NSAppearanceNameDarkAqua"{}}])\ ?\ NSOnState\ :\ NSOffState;}
\DoxyCodeLine{00441\ \ \ \}}
\DoxyCodeLine{00442\ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00449\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsServer_ab3e53bd0ef89b27eb01f084c8d7d1ceb}{MacStatsServer::}}}
\DoxyCodeLine{00450\ \mbox{\hyperlink{classMacStatsServer_ab3e53bd0ef89b27eb01f084c8d7d1ceb}{set\_time\_units}}(\textcolor{keywordtype}{int}\ unit\_mask)\ \{}
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{if}\ (\_monitor\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \_monitor-\/>set\_time\_units(unit\_mask);}
\DoxyCodeLine{00453\ \ \ \}}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \_units\_ms\_menu\_item.state\ =\ (unit\_mask\ \&\ PStatGraph::GBU\_ms)\ ?\ NSOnState\ :\ NSOffState;}
\DoxyCodeLine{00456\ \ \ \_units\_hz\_menu\_item.state\ =\ (unit\_mask\ \&\ PStatGraph::GBU\_hz)\ ?\ NSOnState\ :\ NSOffState;}
\DoxyCodeLine{00457\ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00462\ \textcolor{keywordtype}{void}\ MacStatsServer::}
\DoxyCodeLine{00463\ create\_app()\ \{}
\DoxyCodeLine{00464\ \ \ \_app\ =\ [NSApplication\ sharedApplication];}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \mbox{\hyperlink{interfaceMacStatsAppDelegate}{MacStatsAppDelegate}}\ *delegate\ =\ [[\mbox{\hyperlink{interfaceMacStatsAppDelegate}{MacStatsAppDelegate}}\ alloc]\ initWithServer:\textcolor{keyword}{this}];}
\DoxyCodeLine{00467\ \ \ [\_app\ setDelegate:delegate];}
\DoxyCodeLine{00468\ \ \ [\_app\ setActivationPolicy:NSApplicationActivationPolicyRegular];}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \_main\_menu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ NSMenu\ *app\_menu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ NSMenu\ *settings\_menu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \{}
\DoxyCodeLine{00477\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00478\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleToggleSettingsBool:);}
\DoxyCodeLine{00479\ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}ShowStatusItem"{}};}
\DoxyCodeLine{00480\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Show\ in\ Status\ Bar"{}};}
\DoxyCodeLine{00481\ \ \ \ \ item.state\ =\ NSOnState;}
\DoxyCodeLine{00482\ \ \ \ \ [settings\_menu\ addItem:item];}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ \_show\_status\_item\_menu\_item\ =\ item;}
\DoxyCodeLine{00485\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00486\ \ \ \}}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ NSMenu\ *units\_menu;}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 14.0,\ *))\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{comment}{//\ On\ Sonnoma,\ use\ a\ section\ with\ header.}}
\DoxyCodeLine{00491\ \ \ \ \ [settings\_menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00492\ \ \ \ \ [settings\_menu\ addItem:[NSMenuItem\ sectionHeaderWithTitle:\textcolor{stringliteral}{@"{}Time\ Units"{}}]];}
\DoxyCodeLine{00493\ \ \ \ \ units\_menu\ =\ settings\_menu;}
\DoxyCodeLine{00494\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{comment}{//\ On\ older\ versions,\ create\ a\ sub-\/menu.}}
\DoxyCodeLine{00496\ \ \ \ \ units\_menu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00497\ \ \ \ \ units\_menu.autoenablesItems\ =\ NO;}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ NSMenuItem\ *units\_item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00500\ \ \ \ \ units\_item.title\ =\ \textcolor{stringliteral}{@"{}Time\ Units"{}};}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \ \ [settings\_menu\ addItem:units\_item];}
\DoxyCodeLine{00503\ \ \ \ \ [settings\_menu\ setSubmenu:units\_menu\ forItem:units\_item];}
\DoxyCodeLine{00504\ \ \ \ \ [units\_item\ release];}
\DoxyCodeLine{00505\ \ \ \ \ [units\_menu\ release];}
\DoxyCodeLine{00506\ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \{}
\DoxyCodeLine{00509\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00510\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSettingsInteger:);}
\DoxyCodeLine{00511\ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}TimeUnits"{}};}
\DoxyCodeLine{00512\ \ \ \ \ item.tag\ =\ PStatGraph::GBU\_ms;}
\DoxyCodeLine{00513\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}ms"{}};}
\DoxyCodeLine{00514\ \ \ \ \ item.state\ =\ NSOnState;}
\DoxyCodeLine{00515\ \ \ \ \ [units\_menu\ addItem:item];}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \_units\_ms\_menu\_item\ =\ item;}
\DoxyCodeLine{00518\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00519\ \ \ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \{}
\DoxyCodeLine{00522\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00523\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSettingsInteger:);}
\DoxyCodeLine{00524\ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}TimeUnits"{}};}
\DoxyCodeLine{00525\ \ \ \ \ item.tag\ =\ PStatGraph::GBU\_hz;}
\DoxyCodeLine{00526\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Hz"{}};}
\DoxyCodeLine{00527\ \ \ \ \ item.state\ =\ NSOffState;}
\DoxyCodeLine{00528\ \ \ \ \ [units\_menu\ addItem:item];}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \_units\_hz\_menu\_item\ =\ item;}
\DoxyCodeLine{00531\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00532\ \ \ \}}
\DoxyCodeLine{00533\ }
\DoxyCodeLine{00534\ \ \ \textcolor{comment}{//\ Dark\ mode\ available\ from\ Mojave.}}
\DoxyCodeLine{00535\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 10.14,\ *))\ \{}
\DoxyCodeLine{00536\ \ \ \ \ NSMenu\ *appearance\_menu;}
\DoxyCodeLine{00537\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 14.0,\ *))\ \{}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \textcolor{comment}{//\ On\ Sonnoma,\ use\ a\ section\ with\ header.}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ [settings\_menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00540\ \ \ \ \ \ \ [settings\_menu\ addItem:[NSMenuItem\ sectionHeaderWithTitle:\textcolor{stringliteral}{@"{}Appearance"{}}]];}
\DoxyCodeLine{00541\ \ \ \ \ \ \ appearance\_menu\ =\ settings\_menu;}
\DoxyCodeLine{00542\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \textcolor{comment}{//\ On\ older\ versions,\ create\ a\ sub-\/menu.}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ appearance\_menu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00545\ \ \ \ \ \ \ appearance\_menu.autoenablesItems\ =\ NO;}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \ \ \ \ NSMenuItem\ *appearance\_item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00548\ \ \ \ \ \ \ appearance\_item.title\ =\ \textcolor{stringliteral}{@"{}Appearance"{}};}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \ \ [settings\_menu\ addItem:appearance\_item];}
\DoxyCodeLine{00551\ \ \ \ \ \ \ [settings\_menu\ setSubmenu:appearance\_menu\ forItem:appearance\_item];}
\DoxyCodeLine{00552\ \ \ \ \ \ \ [appearance\_item\ release];}
\DoxyCodeLine{00553\ \ \ \ \ \ \ [appearance\_menu\ release];}
\DoxyCodeLine{00554\ \ \ \ \ \}}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \ \ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00558\ \ \ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSettingsAppearance:);}
\DoxyCodeLine{00559\ \ \ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}"{}};}
\DoxyCodeLine{00560\ \ \ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}System"{}};}
\DoxyCodeLine{00561\ \ \ \ \ \ \ item.state\ =\ NSOnState;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ [appearance\_menu\ addItem:item];}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \_appearance\_system\_menu\_item\ =\ item;}
\DoxyCodeLine{00564\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00565\ \ \ \ \ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \ \ \{}
\DoxyCodeLine{00568\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00569\ \ \ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSettingsAppearance:);}
\DoxyCodeLine{00570\ \ \ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}NSAppearanceNameAqua"{}};}
\DoxyCodeLine{00571\ \ \ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Aqua"{}};}
\DoxyCodeLine{00572\ \ \ \ \ \ \ item.state\ =\ NSOffState;}
\DoxyCodeLine{00573\ \ \ \ \ \ \ [appearance\_menu\ addItem:item];}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \_appearance\_aqua\_menu\_item\ =\ item;}
\DoxyCodeLine{00575\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00576\ \ \ \ \ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ \{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00580\ \ \ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSettingsAppearance:);}
\DoxyCodeLine{00581\ \ \ \ \ \ \ item.representedObject\ =\ \textcolor{stringliteral}{@"{}NSAppearanceNameDarkAqua"{}};}
\DoxyCodeLine{00582\ \ \ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Dark\ Aqua"{}};}
\DoxyCodeLine{00583\ \ \ \ \ \ \ item.state\ =\ NSOffState;}
\DoxyCodeLine{00584\ \ \ \ \ \ \ [appearance\_menu\ addItem:item];}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \_appearance\_dark\_aqua\_menu\_item\ =\ item;}
\DoxyCodeLine{00586\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00587\ \ \ \ \ \}}
\DoxyCodeLine{00588\ \ \ \}}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00590\ \ \ NSMenuItem\ *settings\_item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00591\ \ \ settings\_item.title\ =\ \textcolor{stringliteral}{@"{}Settings"{}};}
\DoxyCodeLine{00592\ \ \ [app\_menu\ addItem:settings\_item];}
\DoxyCodeLine{00593\ \ \ [app\_menu\ setSubmenu:settings\_menu\ forItem:settings\_item];}
\DoxyCodeLine{00594\ \ \ [settings\_item\ release];}
\DoxyCodeLine{00595\ \ \ [settings\_menu\ release];}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ [app\_menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \ \ \{}
\DoxyCodeLine{00600\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00601\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(hide:);}
\DoxyCodeLine{00602\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}h"{}};}
\DoxyCodeLine{00603\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Hide\ PStats"{}};}
\DoxyCodeLine{00604\ \ \ \ \ [app\_menu\ addItem:item];}
\DoxyCodeLine{00605\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00606\ \ \ \}}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \{}
\DoxyCodeLine{00609\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00610\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(hideOtherApplications:);}
\DoxyCodeLine{00611\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}h"{}};}
\DoxyCodeLine{00612\ \ \ \ \ item.keyEquivalentModifierMask\ |=\ NSAlternateKeyMask;}
\DoxyCodeLine{00613\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Hide\ Others"{}};}
\DoxyCodeLine{00614\ \ \ \ \ [app\_menu\ addItem:item];}
\DoxyCodeLine{00615\ \ \ \}}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \{}
\DoxyCodeLine{00618\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00619\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(unhideAllApplications:);}
\DoxyCodeLine{00620\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Show\ All"{}};}
\DoxyCodeLine{00621\ \ \ \ \ [app\_menu\ addItem:item];}
\DoxyCodeLine{00622\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ [app\_menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \{}
\DoxyCodeLine{00628\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00629\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(terminate:);}
\DoxyCodeLine{00630\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}q"{}};}
\DoxyCodeLine{00631\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Quit\ PStats"{}};}
\DoxyCodeLine{00632\ \ \ \ \ [app\_menu\ addItem:item];}
\DoxyCodeLine{00633\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00634\ \ \ \}}
\DoxyCodeLine{00635\ }
\DoxyCodeLine{00636\ \ \ NSMenuItem\ *app\_menu\_item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00637\ \ \ [\_main\_menu\ addItem:app\_menu\_item];}
\DoxyCodeLine{00638\ \ \ [\_main\_menu\ setSubmenu:app\_menu\ forItem:app\_menu\_item];}
\DoxyCodeLine{00639\ \ \ [app\_menu\_item\ release];}
\DoxyCodeLine{00640\ \ \ [app\_menu\ release];}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ setup\_session\_menu();}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ [\_app\ setMainMenu:\_main\_menu];}
\DoxyCodeLine{00645\ \ \ [\_main\_menu\ release];}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00647\ \ \ \textcolor{comment}{//[\_app\ activateIgnoringOtherApps:YES];}}
\DoxyCodeLine{00648\ \ \ \textcolor{comment}{//[\_app\ finishLaunching];}}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \mbox{\hyperlink{classMacStatsServer_ab3e53bd0ef89b27eb01f084c8d7d1ceb}{set\_time\_units}}(PStatGraph::GBU\_ms);}
\DoxyCodeLine{00651\ \}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00656\ \textcolor{keywordtype}{void}\ MacStatsServer::}
\DoxyCodeLine{00657\ setup\_session\_menu()\ \{}
\DoxyCodeLine{00658\ \ \ NSMenu\ *submenu\ =\ [[NSMenu\ alloc]\ init];}
\DoxyCodeLine{00659\ \ \ submenu.title\ =\ \textcolor{stringliteral}{@"{}Session"{}};}
\DoxyCodeLine{00660\ \ \ submenu.autoenablesItems\ =\ NO;}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \{}
\DoxyCodeLine{00663\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00664\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleNewSession:);}
\DoxyCodeLine{00665\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}n"{}};}
\DoxyCodeLine{00666\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}New\ Session"{}};}
\DoxyCodeLine{00667\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \ \ \_new\_session\_menu\_item\ =\ item;}
\DoxyCodeLine{00670\ \ \ \}}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \{}
\DoxyCodeLine{00673\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00674\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleOpenSession:);}
\DoxyCodeLine{00675\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}o"{}};}
\DoxyCodeLine{00676\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Open\ Session\(\backslash\)u2026"{}};}
\DoxyCodeLine{00677\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00678\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00679\ \ \ \}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \{}
\DoxyCodeLine{00682\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00683\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleOpenLastSession:);}
\DoxyCodeLine{00684\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Open\ Last\ Session"{}};}
\DoxyCodeLine{00685\ \ \ \ \ item.enabled\ =\ \_last\_session.\mbox{\hyperlink{classFilename_af8a2ef9ed26abbed32786e6d8025c2c7}{exists}}();}
\DoxyCodeLine{00686\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \_open\_last\_session\_menu\_item\ =\ item;}
\DoxyCodeLine{00689\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00690\ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \{}
\DoxyCodeLine{00693\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00694\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleSaveSession:);}
\DoxyCodeLine{00695\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}s"{}};}
\DoxyCodeLine{00696\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Save\ Session\(\backslash\)u2026"{}};}
\DoxyCodeLine{00697\ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00698\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ \ \ \_save\_session\_menu\_item\ =\ item;}
\DoxyCodeLine{00701\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00702\ \ \ \}}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \{}
\DoxyCodeLine{00705\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00706\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleCloseSession:);}
\DoxyCodeLine{00707\ \ \ \ \ item.keyEquivalent\ =\ \textcolor{stringliteral}{@"{}w"{}};}
\DoxyCodeLine{00708\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Close\ Session"{}};}
\DoxyCodeLine{00709\ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00710\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00711\ }
\DoxyCodeLine{00712\ \ \ \ \ \_close\_session\_menu\_item\ =\ item;}
\DoxyCodeLine{00713\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00714\ \ \ \}}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ [submenu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \{}
\DoxyCodeLine{00719\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00720\ \ \ \ \ item.action\ =\ \textcolor{keyword}{@selector}(handleExportSession:);}
\DoxyCodeLine{00721\ \ \ \ \ item.title\ =\ \textcolor{stringliteral}{@"{}Export\ as\ JSON\(\backslash\)u2026"{}};}
\DoxyCodeLine{00722\ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00723\ \ \ \ \ [submenu\ addItem:item];}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \ \ \ \ \_export\_session\_menu\_item\ =\ item;}
\DoxyCodeLine{00726\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00727\ \ \ \}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ init];}
\DoxyCodeLine{00730\ \ \ [\_main\_menu\ addItem:item];}
\DoxyCodeLine{00731\ \ \ [\_main\_menu\ setSubmenu:submenu\ forItem:item];}
\DoxyCodeLine{00732\ \}}

\end{DoxyCode}
