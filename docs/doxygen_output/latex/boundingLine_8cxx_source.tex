\doxysection{bounding\+Line.\+cxx}
\hypertarget{boundingLine_8cxx_source}{}\label{boundingLine_8cxx_source}\index{panda/src/mathutil/boundingLine.cxx@{panda/src/mathutil/boundingLine.cxx}}
\mbox{\hyperlink{boundingLine_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{boundingLine_8h}{boundingLine.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{boundingSphere_8h}{boundingSphere.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{boundingBox_8h}{boundingBox.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__mathutil_8h}{config\_mathutil.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{math_8h}{math.h}}>}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BoundingLine::\_type\_handle;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ \mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ *BoundingLine::}
\DoxyCodeLine{00027\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00028\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingLine}{BoundingLine}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00029\ \}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00034\ LPoint3\ BoundingLine::}
\DoxyCodeLine{00035\ get\_approx\_center()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00036\ \ \ nassertr(!is\_empty(),\ LPoint3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{00037\ \ \ nassertr(!is\_infinite(),\ LPoint3(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordflow}{return}\ (get\_point\_a()\ +\ get\_point\_b())\ /\ 2.0;}
\DoxyCodeLine{00039\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00044\ \textcolor{keywordtype}{void}\ BoundingLine::}
\DoxyCodeLine{00045\ xform(\textcolor{keyword}{const}\ LMatrix4\ \&mat)\ \{}
\DoxyCodeLine{00046\ \ \ nassertv(!mat.is\_nan());}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{if}\ (!is\_empty()\ \&\&\ !is\_infinite())\ \{}
\DoxyCodeLine{00049\ \ \ \ \ \_origin\ =\ \_origin\ *\ mat;}
\DoxyCodeLine{00050\ \ \ \ \ \_vector\ =\ \_vector\ *\ mat;}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_vector.normalize())\ \{}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ just\ scaled\ the\ line\ down\ to\ nothing,\ it\ becomes\ an\ empty}}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{comment}{//\ volume.}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \_flags\ |=\ F\_empty;}
\DoxyCodeLine{00055\ \ \ \ \ \}}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00062\ \textcolor{keywordtype}{void}\ BoundingLine::}
\DoxyCodeLine{00063\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{if}\ (is\_empty())\ \{}
\DoxyCodeLine{00065\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}bline,\ empty"{}};}
\DoxyCodeLine{00066\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_infinite())\ \{}
\DoxyCodeLine{00067\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}bline,\ infinite"{}};}
\DoxyCodeLine{00068\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00069\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}bline,\ ("{}}\ <<\ \_origin\ <<\ \textcolor{stringliteral}{"{})\ -\/\ ("{}}\ <<\ \_origin\ +\ \_vector\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00077\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingLine}{BoundingLine}}\ *\mbox{\hyperlink{classBoundingLine_ae358bc2de25c2b01d778e882182a7494}{BoundingLine::}}}
\DoxyCodeLine{00078\ \mbox{\hyperlink{classBoundingLine_ae358bc2de25c2b01d778e882182a7494}{as\_bounding\_line}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{bool}\ BoundingLine::}
\DoxyCodeLine{00086\ extend\_other(\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{return}\ other-\/>\mbox{\hyperlink{classBoundingVolume_acfe4f2ebdb2226a8a99ff4500b73af00}{extend\_by\_line}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{bool}\ BoundingLine::}
\DoxyCodeLine{00094\ around\_other(\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ *other,}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ **first,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ **last)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{return}\ other-\/>\mbox{\hyperlink{classBoundingVolume_a1871c628663c940484bb9cc096469a31}{around\_lines}}(first,\ last);}
\DoxyCodeLine{00098\ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00103\ \textcolor{keywordtype}{int}\ BoundingLine::}
\DoxyCodeLine{00104\ contains\_other(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingVolume}{BoundingVolume}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{return}\ other-\/>\mbox{\hyperlink{classBoundingVolume_a001972bfda9762e29e06b946dc9b83ad}{contains\_line}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00111\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBoundingLine_a600e57282523f72139fd0cbf9ca8814a}{BoundingLine::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classBoundingLine_a600e57282523f72139fd0cbf9ca8814a}{extend\_by\_line}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingLine}{BoundingLine}}\ *line)\ \{}
\DoxyCodeLine{00113\ \ \ nassertr(!line-\/>is\_empty()\ \&\&\ !line-\/>is\_infinite(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00114\ \ \ nassertr(!is\_infinite(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{if}\ (is\_empty())\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \_origin\ =\ line-\/>\_origin;}
\DoxyCodeLine{00118\ \ \ \ \ \_vector\ =\ line-\/>\_vector;}
\DoxyCodeLine{00119\ \ \ \ \ \_flags\ =\ 0;}
\DoxyCodeLine{00120\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \_flags\ =\ F\_infinite;}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00124\ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00129\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBoundingLine_a9d29c2227a6793acaa792e8f47962d10}{BoundingLine::}}}
\DoxyCodeLine{00130\ \mbox{\hyperlink{classBoundingLine_a9d29c2227a6793acaa792e8f47962d10}{contains\_sphere}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingSphere}{BoundingSphere}}\ *sphere)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00131\ \ \ nassertr(!is\_empty()\ \&\&\ !is\_infinite(),\ 0);}
\DoxyCodeLine{00132\ \ \ nassertr(!sphere-\/>is\_empty()\ \&\&\ !sphere-\/>is\_infinite(),\ 0);}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ PN\_stdfloat\ r\ =\ sphere-\/>get\_radius();}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \textcolor{keywordflow}{if}\ (r\ *\ r\ >=\ sqr\_dist\_to\_line(sphere-\/>get\_center()))\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{return}\ IF\_possible\ |\ IF\_some;}
\DoxyCodeLine{00138\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordflow}{return}\ IF\_no\_intersection;}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00146\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBoundingLine_a236870e9c750f9f3cc72c3dcb89f5f03}{BoundingLine::}}}
\DoxyCodeLine{00147\ \mbox{\hyperlink{classBoundingLine_a236870e9c750f9f3cc72c3dcb89f5f03}{contains\_box}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBoundingBox}{BoundingBox}}\ *box)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00148\ \ \ nassertr(!is\_empty()\ \&\&\ !is\_infinite(),\ 0);}
\DoxyCodeLine{00149\ \ \ nassertr(!box-\/>is\_empty()\ \&\&\ !box-\/>is\_infinite(),\ 0);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ LPoint3\ center\ =\ (box-\/>get\_minq()\ +\ box-\/>get\_maxq())\ *\ 0.5f;}
\DoxyCodeLine{00152\ \ \ PN\_stdfloat\ r2\ =\ (box-\/>get\_maxq()\ -\/\ box-\/>get\_minq()).length\_squared()\ *\ 0.25f;}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}\ (r2\ >=\ sqr\_dist\_to\_line(center))\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{return}\ IF\_possible;}
\DoxyCodeLine{00156\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{return}\ IF\_no\_intersection;}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00164\ PN\_stdfloat\ BoundingLine::}
\DoxyCodeLine{00165\ sqr\_dist\_to\_line(\textcolor{keyword}{const}\ LPoint3\ \&point)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00166\ \ \ nassertr(!point.is\_nan(),\ 0.0f);}
\DoxyCodeLine{00167\ \ \ nassertr(!is\_empty()\ \&\&\ !is\_infinite(),\ 0.0f);}
\DoxyCodeLine{00168\ \ \ nassertr(!\_vector.almost\_equal(LVector3(0.0f,\ 0.0f,\ 0.0f)),\ 0.0f);}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{comment}{//\ The\ formula\ for\ the\ distance\ from\ a\ point\ to\ the\ line\ based\ on\ the}}
\DoxyCodeLine{00171\ \ \ \textcolor{comment}{//\ quadratic\ equation.}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ PN\_stdfloat\ A\ =\ dot(\_vector,\ \_vector);}
\DoxyCodeLine{00174\ \ \ nassertr(A\ !=\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00175\ \ \ LVector3\ fc\ =\ \_origin\ -\/\ point;}
\DoxyCodeLine{00176\ \ \ PN\_stdfloat\ B\ =\ 2.0\ *\ dot(\_vector,\ fc);}
\DoxyCodeLine{00177\ \ \ PN\_stdfloat\ fc\_d2\ =\ dot(fc,\ fc);}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ PN\_stdfloat\ r2\ =\ fc\_d2\ -\/\ B*B\ /\ 4.0*A;}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ nassertr(!cnan(r2),\ 0.0f);}
\DoxyCodeLine{00182\ \ \ \textcolor{keywordflow}{return}\ r2;}
\DoxyCodeLine{00183\ \}}

\end{DoxyCode}
