\doxysection{bullet\+Rigid\+Body\+Node.\+cxx}
\hypertarget{bulletRigidBodyNode_8cxx_source}{}\label{bulletRigidBodyNode_8cxx_source}\index{panda/src/bullet/bulletRigidBodyNode.cxx@{panda/src/bullet/bulletRigidBodyNode.cxx}}
\mbox{\hyperlink{bulletRigidBodyNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletRigidBodyNode_8h}{bulletRigidBodyNode.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__bullet_8h}{config\_bullet.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletShape_8h}{bulletShape.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletWorld_8h}{bulletWorld.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BulletRigidBodyNode::\_type\_handle;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00027\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name)\ :\ \mbox{\hyperlink{classBulletBodyNode}{BulletBodyNode}}(name)\ \{}
\DoxyCodeLine{00028\ \ \ \textcolor{comment}{//\ Mass\ properties}}
\DoxyCodeLine{00029\ \ \ btScalar\ mass(0.0);}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ inertia(0,\ 0,\ 0);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ construction\ info}}
\DoxyCodeLine{00033\ \ \ btRigidBody::btRigidBodyConstructionInfo\ ci(mass,\ \&\_motion,\ \_shape,\ inertia);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ Additional\ damping}}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{if}\ (bullet\_additional\_damping)\ \{}
\DoxyCodeLine{00037\ \ \ \ \ ci.m\_additionalDamping\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00038\ \ \ \ \ ci.m\_additionalDampingFactor\ =\ bullet\_additional\_damping\_linear\_factor;}
\DoxyCodeLine{00039\ \ \ \ \ ci.m\_additionalLinearDampingThresholdSqr\ =\ bullet\_additional\_damping\_linear\_threshold;}
\DoxyCodeLine{00040\ \ \ \ \ ci.m\_additionalAngularDampingFactor\ =\ bullet\_additional\_damping\_angular\_factor;}
\DoxyCodeLine{00041\ \ \ \ \ ci.m\_additionalAngularDampingThresholdSqr\ =\ bullet\_additional\_damping\_angular\_threshold;}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//\ Rigid\ body}}
\DoxyCodeLine{00045\ \ \ \_rigid\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classbtRigidBody}{btRigidBody}}(ci);}
\DoxyCodeLine{00046\ \ \ \_rigid-\/>setUserPointer(\textcolor{keyword}{this});}
\DoxyCodeLine{00047\ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00053\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00054\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBulletRigidBodyNode}{BulletRigidBodyNode}}\ \&copy)\ :}
\DoxyCodeLine{00055\ \ \ \mbox{\hyperlink{classBulletBodyNode}{BulletBodyNode}}(copy)}
\DoxyCodeLine{00056\ \{}
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \_motion\ =\ copy.\_motion;}
\DoxyCodeLine{00060\ \ \ \_rigid\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classbtRigidBody}{btRigidBody}}(*copy.\_rigid);}
\DoxyCodeLine{00061\ \ \ \_rigid-\/>setUserPointer(\textcolor{keyword}{this});}
\DoxyCodeLine{00062\ \ \ \_rigid-\/>setCollisionShape(\_shape);}
\DoxyCodeLine{00063\ \ \ \_rigid-\/>setMotionState(\&\_motion);}
\DoxyCodeLine{00064\ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00071\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classBulletRigidBodyNode_a246c79e054abc2e03b5a0445aa8687a9}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00072\ \mbox{\hyperlink{classBulletRigidBodyNode_a246c79e054abc2e03b5a0445aa8687a9}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00080\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00081\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ BulletBodyNode::do\_output(out);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ mass="{}}\ <<\ do\_get\_mass();}
\DoxyCodeLine{00087\ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00092\ btCollisionObject\ *BulletRigidBodyNode::}
\DoxyCodeLine{00093\ get\_object()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{return}\ \_rigid;}
\DoxyCodeLine{00096\ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00103\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00104\ do\_shape\_changed()\ \{}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ do\_set\_mass(do\_get\_mass());}
\DoxyCodeLine{00107\ \ \ do\_transform\_changed();}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00117\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00118\ do\_set\_mass(PN\_stdfloat\ mass)\ \{}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ btScalar\ bt\_mass\ =\ mass;}
\DoxyCodeLine{00121\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ bt\_inertia(0.0,\ 0.0,\ 0.0);}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{if}\ (bt\_mass\ >\ 0.0\ \&\&\ !\_shapes.empty())\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \_rigid-\/>getCollisionShape()-\/>calculateLocalInertia(bt\_mass,\ bt\_inertia);}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \_rigid-\/>setMassProps(bt\_mass,\ bt\_inertia);}
\DoxyCodeLine{00128\ \ \ \_rigid-\/>updateInertiaTensor();}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00137\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00138\ set\_mass(PN\_stdfloat\ mass)\ \{}
\DoxyCodeLine{00139\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ do\_set\_mass(mass);}
\DoxyCodeLine{00142\ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00149\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00150\ do\_get\_mass()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ btScalar\ inv\_mass\ =\ \_rigid-\/>getInvMass();}
\DoxyCodeLine{00153\ \ \ btScalar\ mass\ =\ (inv\_mass\ ==\ btScalar(0.0))\ ?\ btScalar(0.0)\ :\ btScalar(1.0)\ /\ inv\_mass;}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{return}\ mass;}
\DoxyCodeLine{00156\ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00162\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00163\ get\_mass()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{return}\ do\_get\_mass();}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00173\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00174\ get\_inv\_mass()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keywordflow}{return}\ (PN\_stdfloat)\_rigid-\/>getInvMass();}
\DoxyCodeLine{00178\ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00190\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00191\ set\_inertia(\textcolor{keyword}{const}\ LVecBase3\ \&inertia)\ \{}
\DoxyCodeLine{00192\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ inv\_inertia(}
\DoxyCodeLine{00195\ \ \ \ \ inertia.get\_x()\ ==\ 0.0\ ?\ btScalar(0.0)\ :\ btScalar(1.0\ /\ inertia.get\_x()),}
\DoxyCodeLine{00196\ \ \ \ \ inertia.get\_y()\ ==\ 0.0\ ?\ btScalar(0.0)\ :\ btScalar(1.0\ /\ inertia.get\_y()),}
\DoxyCodeLine{00197\ \ \ \ \ inertia.get\_z()\ ==\ 0.0\ ?\ btScalar(0.0)\ :\ btScalar(1.0\ /\ inertia.get\_z())}
\DoxyCodeLine{00198\ \ \ \ \ );}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \_rigid-\/>setInvInertiaDiagLocal(inv\_inertia);}
\DoxyCodeLine{00201\ \ \ \_rigid-\/>updateInertiaTensor();}
\DoxyCodeLine{00202\ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00209\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00210\ get\_inertia()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00211\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ inv\_inertia\ =\ \_rigid-\/>getInvInertiaDiagLocal();}
\DoxyCodeLine{00214\ \ \ LVector3\ inertia(}
\DoxyCodeLine{00215\ \ \ \ \ inv\_inertia.x()\ ==\ btScalar(0.0)\ ?\ 0.0\ :\ 1.0\ /\ inv\_inertia.x(),}
\DoxyCodeLine{00216\ \ \ \ \ inv\_inertia.y()\ ==\ btScalar(0.0)\ ?\ 0.0\ :\ 1.0\ /\ inv\_inertia.y(),}
\DoxyCodeLine{00217\ \ \ \ \ inv\_inertia.z()\ ==\ btScalar(0.0)\ ?\ 0.0\ :\ 1.0\ /\ inv\_inertia.z()}
\DoxyCodeLine{00218\ \ \ \ \ );}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{return}\ inertia;}
\DoxyCodeLine{00221\ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00226\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00227\ get\_inv\_inertia\_diag\_local()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00228\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getInvInertiaDiagLocal());}
\DoxyCodeLine{00231\ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00236\ LMatrix3\ BulletRigidBodyNode::}
\DoxyCodeLine{00237\ get\_inv\_inertia\_tensor\_world()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00238\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordflow}{return}\ btMatrix3x3\_to\_LMatrix3(\_rigid-\/>getInvInertiaTensorWorld());}
\DoxyCodeLine{00241\ \}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00246\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00247\ apply\_force(\textcolor{keyword}{const}\ LVector3\ \&force,\ \textcolor{keyword}{const}\ LPoint3\ \&pos)\ \{}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ nassertv\_always(!force.is\_nan());}
\DoxyCodeLine{00251\ \ \ nassertv\_always(!pos.is\_nan());}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \_rigid-\/>applyForce(LVecBase3\_to\_btVector3(force),}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LVecBase3\_to\_btVector3(pos));}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00260\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00261\ apply\_central\_force(\textcolor{keyword}{const}\ LVector3\ \&force)\ \{}
\DoxyCodeLine{00262\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ nassertv\_always(!force.is\_nan());}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \_rigid-\/>applyCentralForce(LVecBase3\_to\_btVector3(force));}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00272\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00273\ apply\_torque(\textcolor{keyword}{const}\ LVector3\ \&torque)\ \{}
\DoxyCodeLine{00274\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ nassertv\_always(!torque.is\_nan());}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \_rigid-\/>applyTorque(LVecBase3\_to\_btVector3(torque));}
\DoxyCodeLine{00279\ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00284\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00285\ apply\_torque\_impulse(\textcolor{keyword}{const}\ LVector3\ \&torque)\ \{}
\DoxyCodeLine{00286\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \ \ nassertv\_always(!torque.is\_nan());}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \_rigid-\/>applyTorqueImpulse(LVecBase3\_to\_btVector3(torque));}
\DoxyCodeLine{00291\ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00296\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00297\ apply\_impulse(\textcolor{keyword}{const}\ LVector3\ \&impulse,\ \textcolor{keyword}{const}\ LPoint3\ \&pos)\ \{}
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ nassertv\_always(!impulse.is\_nan());}
\DoxyCodeLine{00301\ \ \ nassertv\_always(!pos.is\_nan());}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \_rigid-\/>applyImpulse(LVecBase3\_to\_btVector3(impulse),}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LVecBase3\_to\_btVector3(pos));}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00310\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00311\ apply\_central\_impulse(\textcolor{keyword}{const}\ LVector3\ \&impulse)\ \{}
\DoxyCodeLine{00312\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ nassertv\_always(!impulse.is\_nan());}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \_rigid-\/>applyCentralImpulse(LVecBase3\_to\_btVector3(impulse));}
\DoxyCodeLine{00317\ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00322\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00323\ do\_transform\_changed()\ \{}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{if}\ (\_motion.sync\_disabled())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ np\ =\ NodePath::any\_path((\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *)\textcolor{keyword}{this});}
\DoxyCodeLine{00328\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ ts\ =\ np.get\_net\_transform();}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ For\ kinematic\ bodies\ Bullet\ will\ query\ the\ transform\ via}}
\DoxyCodeLine{00331\ \ \ \textcolor{comment}{//\ Motionstate::getWorldTransform.\ \ Therefor\ we\ need\ to\ store\ the\ new}}
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ transform\ within\ the\ motion\ state.\ \ For\ dynamic\ bodies\ we\ need\ to\ store}}
\DoxyCodeLine{00333\ \ \ \textcolor{comment}{//\ the\ net\ scale\ within\ the\ motion\ state,\ since\ Bullet\ might\ update\ the}}
\DoxyCodeLine{00334\ \ \ \textcolor{comment}{//\ transform\ via\ MotionState::setWorldTransform.}}
\DoxyCodeLine{00335\ \ \ \_motion.set\_net\_transform(ts);}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//\ For\ dynamic\ or\ static\ bodies\ we\ directly\ apply\ the\ new\ transform.}}
\DoxyCodeLine{00338\ \ \ \textcolor{keywordflow}{if}\ (!(get\_object()-\/>isKinematicObject()))\ \{}
\DoxyCodeLine{00339\ \ \ \ \ btTransform\ trans\ =\ TransformState\_to\_btTrans(ts);}
\DoxyCodeLine{00340\ \ \ \ \ \_rigid-\/>setCenterOfMassTransform(trans);}
\DoxyCodeLine{00341\ \ \ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \textcolor{comment}{//\ Rescale\ all\ shapes,\ but\ only\ if\ the\ new\ transform\ state\ has\ a\ scale,\ and}}
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//\ this\ scale\ differes\ from\ the\ current\ scale.}}
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{if}\ (ts-\/>has\_scale())\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ new\_scale\ =\ LVecBase3\_to\_btVector3(ts-\/>get\_scale());}
\DoxyCodeLine{00347\ \ \ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ current\_scale\ =\ \_shape-\/>getLocalScaling();}
\DoxyCodeLine{00348\ \ \ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ current\_scale\_inv(1.0/current\_scale.x(),\ 1.0/current\_scale.y(),\ 1.0/current\_scale.z());}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_scale\ !=\ current\_scale)\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \_shape-\/>setLocalScaling(current\_scale\_inv);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \_shape-\/>setLocalScaling(new\_scale);}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//\ Activate\ the\ body\ if\ it\ has\ been\ sleeping}}
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{if}\ (!\_rigid-\/>isActive())\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \_rigid-\/>activate(\textcolor{keyword}{true});}
\DoxyCodeLine{00359\ \ \ \}}
\DoxyCodeLine{00360\ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00365\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_a31b1fdba1319dbdc4c441ae8f1efff1e}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00366\ \mbox{\hyperlink{classBulletRigidBodyNode_a31b1fdba1319dbdc4c441ae8f1efff1e}{parents\_changed}}()\ \{}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{if}\ (\_motion.sync\_disabled())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \textcolor{keywordflow}{if}\ (get\_num\_parents()\ >\ 0)\ \{}
\DoxyCodeLine{00371\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00372\ \ \ \ \ do\_transform\_changed();}
\DoxyCodeLine{00373\ \ \ \}}
\DoxyCodeLine{00374\ \}}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00379\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_a16376d9532cc4e20c924804f9b15b4ff}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00380\ \mbox{\hyperlink{classBulletRigidBodyNode_a16376d9532cc4e20c924804f9b15b4ff}{transform\_changed}}()\ \{}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{if}\ (\_motion.sync\_disabled())\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ do\_transform\_changed();}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00392\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_ae673eaff2eaceae8e4af3323b0c79ad3}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00393\ \mbox{\hyperlink{classBulletRigidBodyNode_ae673eaff2eaceae8e4af3323b0c79ad3}{do\_sync\_p2b}}()\ \{}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{if}\ (get\_object()-\/>isKinematicObject())\ \{}
\DoxyCodeLine{00396\ \ \ \ \ do\_transform\_changed();}
\DoxyCodeLine{00397\ \ \ \}}
\DoxyCodeLine{00398\ \}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00403\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_a5d3ff72f9895283819e8d56ddba1deec}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00404\ \mbox{\hyperlink{classBulletRigidBodyNode_a5d3ff72f9895283819e8d56ddba1deec}{do\_sync\_b2p}}()\ \{}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \_motion.sync\_b2p((\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *)\textcolor{keyword}{this});}
\DoxyCodeLine{00407\ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00412\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00413\ get\_linear\_velocity()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00414\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getLinearVelocity());}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00422\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00423\ get\_angular\_velocity()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getAngularVelocity());}
\DoxyCodeLine{00427\ \}}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00432\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00433\ set\_linear\_velocity(\textcolor{keyword}{const}\ LVector3\ \&velocity)\ \{}
\DoxyCodeLine{00434\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ nassertv\_always(!velocity.is\_nan());}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \_rigid-\/>setLinearVelocity(LVecBase3\_to\_btVector3(velocity));}
\DoxyCodeLine{00439\ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00444\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00445\ set\_angular\_velocity(\textcolor{keyword}{const}\ LVector3\ \&velocity)\ \{}
\DoxyCodeLine{00446\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ nassertv\_always(!velocity.is\_nan());}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \_rigid-\/>setAngularVelocity(LVecBase3\_to\_btVector3(velocity));}
\DoxyCodeLine{00451\ \}}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00456\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00457\ set\_linear\_damping(PN\_stdfloat\ value)\ \{}
\DoxyCodeLine{00458\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \_rigid-\/>setDamping(value,\ \_rigid-\/>getAngularDamping());}
\DoxyCodeLine{00461\ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00466\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00467\ set\_angular\_damping(PN\_stdfloat\ value)\ \{}
\DoxyCodeLine{00468\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \_rigid-\/>setDamping(\_rigid-\/>getLinearDamping(),\ value);}
\DoxyCodeLine{00471\ \}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00476\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00477\ get\_linear\_damping()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00478\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \textcolor{keywordflow}{return}\ (PN\_stdfloat)\_rigid-\/>getLinearDamping();}
\DoxyCodeLine{00481\ \}}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00486\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00487\ get\_angular\_damping()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00488\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{return}\ (PN\_stdfloat)\_rigid-\/>getAngularDamping();}
\DoxyCodeLine{00491\ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00496\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00497\ clear\_forces()\ \{}
\DoxyCodeLine{00498\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \_rigid-\/>clearForces();}
\DoxyCodeLine{00501\ \}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00506\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00507\ get\_linear\_sleep\_threshold()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00508\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \textcolor{keywordflow}{return}\ \_rigid-\/>getLinearSleepingThreshold();}
\DoxyCodeLine{00511\ \}}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00516\ PN\_stdfloat\ BulletRigidBodyNode::}
\DoxyCodeLine{00517\ get\_angular\_sleep\_threshold()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00518\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \textcolor{keywordflow}{return}\ \_rigid-\/>getAngularSleepingThreshold();}
\DoxyCodeLine{00521\ \}}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00526\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00527\ set\_linear\_sleep\_threshold(PN\_stdfloat\ threshold)\ \{}
\DoxyCodeLine{00528\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \_rigid-\/>setSleepingThresholds(threshold,\ \_rigid-\/>getAngularSleepingThreshold());}
\DoxyCodeLine{00531\ \}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00536\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00537\ set\_angular\_sleep\_threshold(PN\_stdfloat\ threshold)\ \{}
\DoxyCodeLine{00538\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00540\ \ \ \_rigid-\/>setSleepingThresholds(\_rigid-\/>getLinearSleepingThreshold(),\ threshold);}
\DoxyCodeLine{00541\ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00546\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00547\ set\_gravity(\textcolor{keyword}{const}\ LVector3\ \&gravity)\ \{}
\DoxyCodeLine{00548\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ nassertv\_always(!gravity.is\_nan());}
\DoxyCodeLine{00551\ }
\DoxyCodeLine{00552\ \ \ \_rigid-\/>setGravity(LVecBase3\_to\_btVector3(gravity));}
\DoxyCodeLine{00553\ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00558\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00559\ get\_gravity()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00560\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getGravity());}
\DoxyCodeLine{00563\ \}}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00568\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00569\ get\_linear\_factor()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00570\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getLinearFactor());}
\DoxyCodeLine{00573\ \}}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00578\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00579\ get\_angular\_factor()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00580\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getAngularFactor());}
\DoxyCodeLine{00583\ \}}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00588\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00589\ set\_linear\_factor(\textcolor{keyword}{const}\ LVector3\ \&factor)\ \{}
\DoxyCodeLine{00590\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \_rigid-\/>setLinearFactor(LVecBase3\_to\_btVector3(factor));}
\DoxyCodeLine{00593\ \}}
\DoxyCodeLine{00594\ }
\DoxyCodeLine{00598\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::}
\DoxyCodeLine{00599\ set\_angular\_factor(\textcolor{keyword}{const}\ LVector3\ \&factor)\ \{}
\DoxyCodeLine{00600\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \_rigid-\/>setAngularFactor(LVecBase3\_to\_btVector3(factor));}
\DoxyCodeLine{00603\ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00608\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00609\ get\_total\_force()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00610\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getTotalForce());}
\DoxyCodeLine{00613\ \}}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00618\ LVector3\ BulletRigidBodyNode::}
\DoxyCodeLine{00619\ get\_total\_torque()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00620\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_rigid-\/>getTotalTorque());}
\DoxyCodeLine{00623\ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00628\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00629\ MotionState()\ \{}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ \_trans.setIdentity();}
\DoxyCodeLine{00632\ \ \ \_disabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00633\ \ \ \_dirty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00634\ \ \ \_was\_dirty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00635\ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00640\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00641\ getWorldTransform(btTransform\ \&trans)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ trans\ =\ \_trans;}
\DoxyCodeLine{00644\ \}}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00649\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00650\ setWorldTransform(\textcolor{keyword}{const}\ btTransform\ \&trans)\ \{}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \_trans\ =\ trans;}
\DoxyCodeLine{00653\ \ \ \_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00654\ \ \ \_was\_dirty\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00655\ \}}
\DoxyCodeLine{00656\ }
\DoxyCodeLine{00660\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00661\ sync\_b2p(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *node)\ \{}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \textcolor{keywordflow}{if}\ (!\_dirty)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ np\ =\ NodePath::any\_path(node);}
\DoxyCodeLine{00666\ \ \ LPoint3\ p\ =\ btVector3\_to\_LPoint3(\_trans.getOrigin());}
\DoxyCodeLine{00667\ \ \ LQuaternion\ q\ =\ btQuat\_to\_LQuaternion(\_trans.getRotation());}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \_disabled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00670\ \ \ np.set\_pos\_quat(\mbox{\hyperlink{classNodePath}{NodePath}}(),\ p,\ q);}
\DoxyCodeLine{00671\ \ \ \_disabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00672\ \ \ \_dirty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00673\ \}}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00683\ \textcolor{keywordtype}{void}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00684\ set\_net\_transform(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *ts)\ \{}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ nassertv(ts);}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \_trans\ =\ TransformState\_to\_btTrans(ts);}
\DoxyCodeLine{00689\ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00694\ \textcolor{keywordtype}{bool}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00695\ sync\_disabled()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \textcolor{keywordflow}{return}\ \_disabled;}
\DoxyCodeLine{00698\ \}}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00703\ \textcolor{keywordtype}{bool}\ BulletRigidBodyNode::MotionState::}
\DoxyCodeLine{00704\ pick\_dirty\_flag()\ \{}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \textcolor{keywordtype}{bool}\ rc\ =\ \_was\_dirty;}
\DoxyCodeLine{00707\ \ \ \_was\_dirty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00708\ \ \ \textcolor{keywordflow}{return}\ rc;}
\DoxyCodeLine{00709\ \}}
\DoxyCodeLine{00710\ }
\DoxyCodeLine{00715\ \textcolor{keywordtype}{bool}\ BulletRigidBodyNode::}
\DoxyCodeLine{00716\ pick\_dirty\_flag()\ \{}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \textcolor{keywordflow}{return}\ \_motion.pick\_dirty\_flag();}
\DoxyCodeLine{00719\ \}}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00724\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_a43cb80036928aa89b81db287f630c766}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00725\ \mbox{\hyperlink{classBulletRigidBodyNode_a43cb80036928aa89b81db287f630c766}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00726\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classBulletRigidBodyNode_a543300996ffec7ac68efe21e2bf91f7a}{make\_from\_bam}});}
\DoxyCodeLine{00727\ \}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00733\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_a38a380a784da32b7efd000ffd5e129b1}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00734\ \mbox{\hyperlink{classBulletRigidBodyNode_a38a380a784da32b7efd000ffd5e129b1}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00735\ \ \ \mbox{\hyperlink{classBulletBodyNode_a9ea95bf5b2df7ea2b75b1ca30fbbb095}{BulletBodyNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ dg.add\_stdfloat(get\_mass());}
\DoxyCodeLine{00738\ \ \ dg.add\_stdfloat(get\_linear\_damping());}
\DoxyCodeLine{00739\ \ \ dg.add\_stdfloat(get\_angular\_damping());}
\DoxyCodeLine{00740\ \ \ dg.add\_stdfloat(get\_linear\_sleep\_threshold());}
\DoxyCodeLine{00741\ \ \ dg.add\_stdfloat(get\_angular\_sleep\_threshold());}
\DoxyCodeLine{00742\ \ \ get\_gravity().write\_datagram(dg);}
\DoxyCodeLine{00743\ \ \ get\_linear\_factor().write\_datagram(dg);}
\DoxyCodeLine{00744\ \ \ get\_angular\_factor().write\_datagram(dg);}
\DoxyCodeLine{00745\ \ \ \textcolor{comment}{//\ dynamic\ state\ (?)}}
\DoxyCodeLine{00746\ \ \ get\_linear\_velocity().write\_datagram(dg);}
\DoxyCodeLine{00747\ \ \ get\_angular\_velocity().write\_datagram(dg);}
\DoxyCodeLine{00748\ \}}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00755\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classBulletRigidBodyNode_a543300996ffec7ac68efe21e2bf91f7a}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00756\ \mbox{\hyperlink{classBulletRigidBodyNode_a543300996ffec7ac68efe21e2bf91f7a}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00757\ \ \ \mbox{\hyperlink{classBulletRigidBodyNode}{BulletRigidBodyNode}}\ *param\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBulletRigidBodyNode_a133a65d5d34b6460a6a79dfa6500fffc}{BulletRigidBodyNode}};}
\DoxyCodeLine{00758\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00759\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00762\ \ \ param-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \textcolor{keywordflow}{return}\ param;}
\DoxyCodeLine{00765\ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00771\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletRigidBodyNode_ad6615c7a73aa8bf89b3ce5e12943c6b6}{BulletRigidBodyNode::}}}
\DoxyCodeLine{00772\ \mbox{\hyperlink{classBulletRigidBodyNode_ad6615c7a73aa8bf89b3ce5e12943c6b6}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00773\ \ \ \mbox{\hyperlink{classBulletBodyNode_a500c8677658e23352f552e833a133e08}{BulletBodyNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ set\_mass(scan.get\_stdfloat());}
\DoxyCodeLine{00776\ \ \ set\_linear\_damping(scan.get\_stdfloat());}
\DoxyCodeLine{00777\ \ \ set\_angular\_damping(scan.get\_stdfloat());}
\DoxyCodeLine{00778\ \ \ set\_linear\_sleep\_threshold(scan.get\_stdfloat());}
\DoxyCodeLine{00779\ \ \ set\_angular\_sleep\_threshold(scan.get\_stdfloat());}
\DoxyCodeLine{00780\ }
\DoxyCodeLine{00781\ \ \ LVector3\ gravity,\ linear\_factor,\ angular\_factor;}
\DoxyCodeLine{00782\ \ \ gravity.read\_datagram(scan);}
\DoxyCodeLine{00783\ \ \ linear\_factor.read\_datagram(scan);}
\DoxyCodeLine{00784\ \ \ angular\_factor.read\_datagram(scan);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ set\_gravity(gravity);}
\DoxyCodeLine{00787\ \ \ set\_linear\_factor(linear\_factor);}
\DoxyCodeLine{00788\ \ \ set\_angular\_factor(angular\_factor);}
\DoxyCodeLine{00789\ \}}

\end{DoxyCode}
