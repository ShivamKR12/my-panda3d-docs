\doxysection{pnmimage\+\_\+base.\+h}
\hypertarget{pnmimage__base_8h_source}{}\label{pnmimage__base_8h_source}\index{panda/src/pnmimage/pnmimage\_base.h@{panda/src/pnmimage/pnmimage\_base.h}}
\mbox{\hyperlink{pnmimage__base_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ PNMIMAGE\_BASE\_H}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ PNMIMAGE\_BASE\_H}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{//\ This\ header\ file\ make\ a\ few\ typedefs\ and\ other\ definitions\ essential\ to}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ everything\ in\ the\ PNMImage\ package.}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnotify_8h}{pnotify.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{//\ Since\ we\ no\ longer\ include\ pnm.h\ directly,\ we\ have\ to\ provide\ our\ own}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ definitions\ for\ xel\ and\ xelval.}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{comment}{//\ For\ now,\ we\ have\ PGM\_BIGGRAYS\ defined,\ which\ gives\ us\ 16-\/bit\ channels.}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ Undefine\ this\ if\ you\ have\ memory\ problems\ and\ need\ to\ use\ 8-\/bit\ channels}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ instead.}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#define\ PGM\_BIGGRAYS}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#ifdef\ PGM\_BIGGRAYS}}
\DoxyCodeLine{00032\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ gray;}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#define\ PGM\_MAXMAXVAL\ 65535}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ PGM\_BIGGRAYS}}
\DoxyCodeLine{00035\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ gray;}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ PGM\_MAXMAXVAL\ 255}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PGM\_BIGGRAYS}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ PNM\_MAXMAXVAL\ PGM\_MAXMAXVAL}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structpixel}{pixel}}\ \{}
\DoxyCodeLine{00042\ PUBLISHED:}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{structpixel}{pixel}}()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00044\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{structpixel}{pixel}}(gray\ fill)\ :\ r(fill),\ g(fill),\ b(fill)\ \{\ \}}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{structpixel}{pixel}}(gray\ r,\ gray\ g,\ gray\ b)\ :\ r(r),\ g(g),\ b(b)\ \{\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ gray\ operator\ [](\textcolor{keywordtype}{int}\ i)\textcolor{keyword}{\ const\ }\{\ nassertr(i\ >=\ 0\ \&\&\ i\ <\ 3,\ 0);\ \textcolor{keywordflow}{return}\ *(\&r\ +\ i);\ \}}
\DoxyCodeLine{00048\ \ \ gray\ \&operator\ [](\textcolor{keywordtype}{int}\ i)\ \{\ nassertr(i\ >=\ 0\ \&\&\ i\ <\ 3,\ r);\ \textcolor{keywordflow}{return}\ *(\&r\ +\ i);\ \}}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ operator\ +\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00050\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpixel}{pixel}}(r\ +\ other.r,\ g\ +\ other.g,\ b\ +\ other.b);\ \}}
\DoxyCodeLine{00051\ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ operator\ -\/\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00052\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpixel}{pixel}}(r\ -\/\ other.r,\ g\ -\/\ other.g,\ b\ -\/\ other.b);\ \}}
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ operator\ *\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mult)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00054\ \textcolor{keyword}{\ \ \ \ }\{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structpixel}{pixel}}(r\ *\ mult,\ g\ *\ mult,\ b\ *\ mult);\ \}}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{void}\ operator\ +=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)}
\DoxyCodeLine{00056\ \ \ \ \ \{\ r\ +=\ other.r;\ g\ +=\ other.g;\ b\ +=\ other.b;\ \}}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordtype}{void}\ operator\ -\/=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)}
\DoxyCodeLine{00058\ \ \ \ \ \{\ r\ -\/=\ other.r;\ g\ -\/=\ other.g;\ b\ -\/=\ other.b;\ \}}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordtype}{void}\ operator\ *=\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ mult)}
\DoxyCodeLine{00060\ \ \ \ \ \{\ r\ *=\ mult;\ g\ *=\ mult;\ b\ *=\ mult;\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keywordtype}{bool}\ operator\ ==\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{return}\ r\ ==\ other.r\ \&\&\ g\ ==\ other.g\ \&\&\ r\ ==\ other.r;}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ \ \ \textcolor{keywordtype}{bool}\ operator\ !=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{return}\ r\ !=\ other.r\ ||\ g\ !=\ other.g\ ||\ r\ !=\ other.r;}
\DoxyCodeLine{00067\ \ \ \}}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordtype}{bool}\ operator\ <\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{structpixel}{pixel}}\ \&other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{if}\ (r\ !=\ other.r)\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ r\ <\ other.r;}
\DoxyCodeLine{00071\ \ \ \ \ \}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordflow}{if}\ (g\ !=\ other.g)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ g\ <\ other.g;}
\DoxyCodeLine{00074\ \ \ \ \ \}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{keywordflow}{return}\ b\ <\ other.b;}
\DoxyCodeLine{00076\ \ \ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#ifdef\ HAVE\_PYTHON}}
\DoxyCodeLine{00079\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ size()\ \{\ \textcolor{keywordflow}{return}\ 3;\ \}}
\DoxyCodeLine{00080\ \ \ \textcolor{keywordtype}{void}\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00081\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}pixel(r="{}}\ <<\ r\ <<\ \textcolor{stringliteral}{"{},\ g="{}}\ <<\ g\ <<\ \textcolor{stringliteral}{"{},\ b="{}}\ <<\ b\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ gray\ r,\ g,\ b;}
\DoxyCodeLine{00086\ \};}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{keyword}{typedef}\ gray\ pixval;}
\DoxyCodeLine{00089\ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{structpixel}{pixel}}\ \mbox{\hyperlink{structpixel}{xel}};}
\DoxyCodeLine{00090\ \textcolor{keyword}{typedef}\ gray\ xelval;}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{comment}{//\ These\ macros\ are\ borrowed\ from\ ppm.h.}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \textcolor{preprocessor}{\#define\ PPM\_GETR(p)\ ((p).r)}}
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#define\ PPM\_GETG(p)\ ((p).g)}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#define\ PPM\_GETB(p)\ ((p).b)}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#define\ PPM\_PUTR(p,red)\ ((p).r\ =\ (red))}}
\DoxyCodeLine{00099\ \textcolor{preprocessor}{\#define\ PPM\_PUTG(p,grn)\ ((p).g\ =\ (grn))}}
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#define\ PPM\_PUTB(p,blu)\ ((p).b\ =\ (blu))}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#define\ PPM\_ASSIGN(p,red,grn,blu)\ \{\ (p).r\ =\ (red);\ (p).g\ =\ (grn);\ (p).b\ =\ (blu);\ \}}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\#define\ PPM\_EQUAL(p,q)\ (\ (p).r\ ==\ (q).r\ \&\&\ (p).g\ ==\ (q).g\ \&\&\ (p).b\ ==\ (q).b\ )}}
\DoxyCodeLine{00104\ \textcolor{preprocessor}{\#define\ PNM\_ASSIGN1(x,v)\ PPM\_ASSIGN(x,0,0,v)}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#define\ PPM\_DEPTH(newp,p,oldmaxval,newmaxval)\ \(\backslash\)}}
\DoxyCodeLine{00107\ \textcolor{preprocessor}{\ \ \ \ PPM\_ASSIGN(\ (newp),\ \(\backslash\)}}
\DoxyCodeLine{00108\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (\ (int)\ PPM\_GETR(p)\ *\ (newmaxval)\ +\ (oldmaxval)\ /\ 2\ )\ /\ (oldmaxval),\ \(\backslash\)}}
\DoxyCodeLine{00109\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (\ (int)\ PPM\_GETG(p)\ *\ (newmaxval)\ +\ (oldmaxval)\ /\ 2\ )\ /\ (oldmaxval),\ \(\backslash\)}}
\DoxyCodeLine{00110\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (\ (int)\ PPM\_GETB(p)\ *\ (newmaxval)\ +\ (oldmaxval)\ /\ 2\ )\ /\ (oldmaxval)\ )}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{comment}{//\ pnm\ defines\ these\ functions,\ and\ it's\ easier\ to\ emulate\ them\ than\ to}}
\DoxyCodeLine{00114\ \textcolor{comment}{//\ rewrite\ the\ code\ that\ calls\ them.}}
\DoxyCodeLine{00115\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{pnmimage__base_8h_ad71c7b5f56bb0f75710d581932f278a5}{pm\_message}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *format,\ ...);}
\DoxyCodeLine{00116\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{pnmimage__base_8h_a71ce0bfd6eaa4b22ed1259aa219af12d}{pm\_error}}\ [[noreturn]]\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *format,\ ...);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{pnmimage__base_8h_a08253c1e372100b05e1c9e63c8d156be}{pm\_maxvaltobits}}(\textcolor{keywordtype}{int}\ maxval);}
\DoxyCodeLine{00119\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{pnmimage__base_8h_a6ca224c8f946c91652ca9f212a187977}{pm\_bitstomaxval}}(\textcolor{keywordtype}{int}\ bits);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{char}\ *\mbox{\hyperlink{pnmimage__base_8h_a819be46aefa5085ec9be947f1f284a4a}{pm\_allocrow}}(\textcolor{keywordtype}{int}\ cols,\ \textcolor{keywordtype}{int}\ size);}
\DoxyCodeLine{00122\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{pnmimage__base_8h_a4bc6aab76387d64302def432f6e7a698}{pm\_freerow}}(\textcolor{keywordtype}{char}\ *itrow);}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_readbigshort(std::istream\ *in,\ \textcolor{keywordtype}{short}\ *sP);}
\DoxyCodeLine{00125\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_writebigshort(std::ostream\ *out,\ \textcolor{keywordtype}{short}\ s);}
\DoxyCodeLine{00126\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_readbiglong(std::istream\ *in,\ \textcolor{keywordtype}{long}\ *lP);}
\DoxyCodeLine{00127\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_writebiglong(std::ostream\ *out,\ \textcolor{keywordtype}{long}\ l);}
\DoxyCodeLine{00128\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_readlittleshort(std::istream\ *in,\ \textcolor{keywordtype}{short}\ *sP);}
\DoxyCodeLine{00129\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_writelittleshort(std::ostream\ *out,\ \textcolor{keywordtype}{short}\ s);}
\DoxyCodeLine{00130\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_readlittlelong(std::istream\ *in,\ \textcolor{keywordtype}{long}\ *lP);}
\DoxyCodeLine{00131\ EXPCL\_PANDA\_PNMIMAGE\ \textcolor{keywordtype}{int}\ pm\_writelittlelong(std::ostream\ *out,\ \textcolor{keywordtype}{long}\ l);}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \textcolor{comment}{//\ These\ ratios\ are\ used\ to\ compute\ the\ brightness\ of\ a\ colored\ pixel;\ they}}
\DoxyCodeLine{00135\ \textcolor{comment}{//\ define\ the\ relative\ contributions\ of\ each\ of\ the\ components.}}
\DoxyCodeLine{00136\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ lumin\_red\ =\ 0.299f;}
\DoxyCodeLine{00137\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ lumin\_grn\ =\ 0.587f;}
\DoxyCodeLine{00138\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ lumin\_blu\ =\ 0.114f;}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
