\doxysection{win\+Detect\+Dx.\+h}
\hypertarget{winDetectDx_8h_source}{}\label{winDetectDx_8h_source}\index{panda/src/windisplay/winDetectDx.h@{panda/src/windisplay/winDetectDx.h}}
\mbox{\hyperlink{winDetectDx_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <time.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{displayInformation_8h}{displayInformation.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\{}
\DoxyCodeLine{00018\ \ \ D3DFORMAT\ d3d\_format;}
\DoxyCodeLine{00019\ \ \ \textcolor{keywordtype}{int}\ bits\_per\_pixel;}
\DoxyCodeLine{00020\ \ \ \textcolor{keywordtype}{int}\ fullscreen\_only;}
\DoxyCodeLine{00021\ \}}
\DoxyCodeLine{00022\ \mbox{\hyperlink{structDISPLAY__FORMAT}{DISPLAY\_FORMAT}};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structDISPLAY__FORMAT}{DISPLAY\_FORMAT}}\ display\_format\_array\ [\ ]\ =\ \{}
\DoxyCodeLine{00025\ \ \ D3DFMT\_X8R8G8B8,\ \ \ \ 32,\ FALSE,}
\DoxyCodeLine{00026\ \ \ D3DFMT\_R5G6B5,\ \ \ \ \ \ 16,\ FALSE,}
\DoxyCodeLine{00027\ \ \ D3DFMT\_X1R5G5B5,\ \ \ \ 16,\ FALSE,}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ D3DFMT\_A2R10G10B10,\ 32,\ TRUE,}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{comment}{//\ terminator}}
\DoxyCodeLine{00032\ \ \ D3DFMT\_UNKNOWN,\ \ \ \ \ \ 0,\ FALSE,}
\DoxyCodeLine{00033\ \};}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ d3d\_format\_to\_bits\_per\_pixel\ (D3DFORMAT\ d3d\_format)\ \{}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordtype}{int}\ format\_index;}
\DoxyCodeLine{00037\ \ \ \textcolor{keywordtype}{int}\ bits\_per\_pixel;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ format\_index\ =\ 0;}
\DoxyCodeLine{00040\ \ \ bits\_per\_pixel\ =\ 0;}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordflow}{while}\ (display\_format\_array\ [format\_index].d3d\_format\ !=\ D3DFMT\_UNKNOWN)\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_format\ ==\ display\_format\_array\ [format\_index].d3d\_format)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \ \ bits\_per\_pixel\ =\ display\_format\_array\ [format\_index].bits\_per\_pixel;}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00045\ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ format\_index++;}
\DoxyCodeLine{00048\ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{return}\ bits\_per\_pixel;}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \textcolor{keyword}{static}\ DWORD\ \_GetLastError\ (\textcolor{keywordtype}{char}\ *message\_prefix)\ \{}
\DoxyCodeLine{00054\ \ \ LPVOID\ ptr;}
\DoxyCodeLine{00055\ \ \ DWORD\ error;}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ ptr\ =\ 0;}
\DoxyCodeLine{00058\ \ \ error\ =\ GetLastError\ (\ );}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{if}\ (FormatMessage\ (}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ FORMAT\_MESSAGE\_ALLOCATE\_BUFFER\ |FORMAT\_MESSAGE\_FROM\_SYSTEM,}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},\ error,\ MAKELANGID(\ LANG\_ENGLISH,\ SUBLANG\_ENGLISH\_US\ ),}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ (LPTSTR)\&ptr,0,\ \textcolor{keyword}{nullptr}))\ \{}
\DoxyCodeLine{00063\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}ERROR:\ "{}}<<\ message\_prefix\ <<\ \textcolor{stringliteral}{"{}\ result\ =\ "{}}\ <<\ (\textcolor{keywordtype}{char}*)\ ptr\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00064\ \ \ \ \ LocalFree(\ ptr\ );}
\DoxyCodeLine{00065\ \ \ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{keywordflow}{return}\ error;}
\DoxyCodeLine{00068\ \}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{keyword}{static}\ LRESULT\ CALLBACK\ window\_procedure\ (HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{return}\ DefWindowProc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00072\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \textcolor{keyword}{static}\ DWORD\ print\_GetLastError\ (\textcolor{keywordtype}{char}\ *message\_prefix)}
\DoxyCodeLine{00075\ \{}
\DoxyCodeLine{00076\ \ \ LPVOID\ ptr;}
\DoxyCodeLine{00077\ \ \ DWORD\ error;}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ ptr\ =\ 0;}
\DoxyCodeLine{00080\ \ \ error\ =\ GetLastError\ (\ );}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{if}\ (FormatMessage(\ FORMAT\_MESSAGE\_ALLOCATE\_BUFFER\ |}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FORMAT\_MESSAGE\_FROM\_SYSTEM,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ error,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MAKELANGID(\ LANG\_ENGLISH,\ SUBLANG\_ENGLISH\_US\ ),}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (LPTSTR)\&ptr,}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ \textcolor{keyword}{nullptr}))}
\DoxyCodeLine{00088\ \ \ \{}
\DoxyCodeLine{00089\ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}ERROR:\ "{}}<<\ message\_prefix\ <<\ \textcolor{stringliteral}{"{}\ result\ =\ "{}}\ <<\ (\textcolor{keywordtype}{char}*)\ ptr\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00090\ \ \ \ \ LocalFree(\ ptr\ );}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{return}\ error;}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{int}\ get\_display\_information\ (\mbox{\hyperlink{classDisplaySearchParameters}{DisplaySearchParameters}}\ \&display\_search\_parameters,\ \mbox{\hyperlink{classDisplayInformation}{DisplayInformation}}\ *display\_information)\ \{}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{int}\ debug\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{int}\ success;}
\DoxyCodeLine{00101\ \ \ DisplayInformation::DetectionState\ state;}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{int}\ get\_device\_caps\_state;}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ GraphicsStateGuardian::ShaderModel\ shader\_model;}
\DoxyCodeLine{00105\ \ \ UINT\ minimum\_width;}
\DoxyCodeLine{00106\ \ \ UINT\ maximum\_width;}
\DoxyCodeLine{00107\ \ \ UINT\ minimum\_height;}
\DoxyCodeLine{00108\ \ \ UINT\ maximum\_height;}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{int}\ minimum\_bits\_per\_pixel;}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordtype}{int}\ maximum\_bits\_per\_pixel;}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ UINT\ texture\_memory;}
\DoxyCodeLine{00113\ \ \ UINT\ video\_memory;}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{keywordtype}{int}\ window\_width;}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{int}\ window\_height;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{int}\ window\_bits\_per\_pixel;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordtype}{int}\ total\_display\_modes;}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordtype}{int}\ current\_display\_mode\_index;}
\DoxyCodeLine{00120\ \ \ \mbox{\hyperlink{structDisplayMode}{DisplayMode}}\ *display\_mode\_array;}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ uint64\_t\ physical\_memory;}
\DoxyCodeLine{00123\ \ \ uint64\_t\ available\_physical\_memory;}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{keywordtype}{int}\ vendor\_id;}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{int}\ device\_id;}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{int}\ product;}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{int}\ version;}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordtype}{int}\ sub\_version;}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordtype}{int}\ build;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordtype}{int}\ month;}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordtype}{int}\ day;}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{int}\ year;}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ success\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00138\ \ \ window\_width\ =\ 0;}
\DoxyCodeLine{00139\ \ \ window\_height\ =\ 0;}
\DoxyCodeLine{00140\ \ \ window\_bits\_per\_pixel\ =\ 0;}
\DoxyCodeLine{00141\ \ \ total\_display\_modes\ =\ 0;}
\DoxyCodeLine{00142\ \ \ current\_display\_mode\_index\ =\ -\/1;}
\DoxyCodeLine{00143\ \ \ display\_mode\_array\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ minimum\_width\ =\ display\_search\_parameters.\_minimum\_width;}
\DoxyCodeLine{00146\ \ \ minimum\_height\ =\ display\_search\_parameters.\_minimum\_height;}
\DoxyCodeLine{00147\ \ \ maximum\_width\ =\ display\_search\_parameters.\_maximum\_width;}
\DoxyCodeLine{00148\ \ \ maximum\_height\ =\ display\_search\_parameters.\_maximum\_height;}
\DoxyCodeLine{00149\ \ \ minimum\_bits\_per\_pixel\ =\ display\_search\_parameters.\_minimum\_bits\_per\_pixel;}
\DoxyCodeLine{00150\ \ \ maximum\_bits\_per\_pixel\ =\ display\_search\_parameters.\_maximum\_bits\_per\_pixel;}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_00;}
\DoxyCodeLine{00153\ \ \ video\_memory\ =\ 0;}
\DoxyCodeLine{00154\ \ \ texture\_memory\ =\ 0;}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ state\ =\ DisplayInformation::DS\_unknown;}
\DoxyCodeLine{00157\ \ \ get\_device\_caps\_state\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ physical\_memory\ =\ 0;}
\DoxyCodeLine{00160\ \ \ available\_physical\_memory\ =\ 0;}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ vendor\_id\ =\ 0;}
\DoxyCodeLine{00163\ \ \ device\_id\ =\ 0;}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ product\ =\ 0;}
\DoxyCodeLine{00166\ \ \ version\ =\ 0;}
\DoxyCodeLine{00167\ \ \ sub\_version\ =\ 0;}
\DoxyCodeLine{00168\ \ \ build\ =\ 0;}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ month\ =\ 0;}
\DoxyCodeLine{00171\ \ \ day\ =\ 0;}
\DoxyCodeLine{00172\ \ \ year\ =\ 0;}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ HMODULE\ d3d\_dll;}
\DoxyCodeLine{00175\ \ \ DIRECT\_3D\_CREATE\ Direct3DCreate;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ d3d\_dll\ =\ LoadLibrary\ (d3d\_dll\_name);}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{if}\ (d3d\_dll)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ Direct3DCreate\ =\ (DIRECT\_3D\_CREATE)\ GetProcAddress\ (d3d\_dll,\ direct\_3d\_create\_function\_name);}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (Direct3DCreate)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ DIRECT\_3D\ direct\_3d;}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ direct\_3d\ =\ Direct3DCreate\ (D3D\_SDK\_VERSION);}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ DWORD\ flags;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ UINT\ adapter;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ D3DDEVTYPE\ device\_type;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ D3DDISPLAYMODE\ current\_d3d\_display\_mode;}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ D3DADAPTER\_IDENTIFIER\ d3d\_adapter\_identifier;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ D3DCAPS\ d3d\_caps;}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ adapter\ =\ D3DADAPTER\_DEFAULT;}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ device\_type\ =\ D3DDEVTYPE\_HAL;}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ windowed\ mode\ max\ res\ and\ format}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ get\_adapter\_display\_mode\_state\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ -\/>\ GetAdapterDisplayMode\ (adapter,\ \&current\_d3d\_display\_mode)\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}current\ mode\ \ w\ =\ \%d\ h\ =\ \%d\ r\ =\ \%d\ f\ =\ \%d\ \(\backslash\)n"{}},}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_d3d\_display\_mode.Width,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_d3d\_display\_mode.Height,}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_d3d\_display\_mode.RefreshRate,}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_d3d\_display\_mode.Format);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ window\_width\ =\ current\_d3d\_display\_mode.Width;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ window\_height\ =\ current\_d3d\_display\_mode.Height;}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ window\_bits\_per\_pixel\ =\ d3d\_format\_to\_bits\_per\_pixel\ (current\_d3d\_display\_mode.Format);}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ get\_adapter\_display\_mode\_state\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ get\_adapter\_display\_mode\_state\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ flags\ =\ 0;}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ -\/>\ GetAdapterIdentifier\ (adapter,\ flags,\ \&d3d\_adapter\_identifier)\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ print\ adapter\ info}}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.Driver;}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.Description;}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.DeviceName;}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.DriverVersion;}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.VendorId;}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.DeviceId;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.SubSysId;}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.Revision;}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.DeviceIdentifier;}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ d3d\_adapter\_identifier.WHQLLevel;}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}Driver:\ \%s\(\backslash\)n"{}},\ d3d\_adapter\_identifier.Driver);}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}Description:\ \%s\(\backslash\)n"{}},\ d3d\_adapter\_identifier.Description);}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ system\_directory\ [MAX\_PATH];}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ dll\_file\_path\ [MAX\_PATH];}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ find\ the\ dll\ in\ the\ system\ directory\ if\ possible\ and\ get\ the\ date}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ the\ file}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetSystemDirectory\ (system\_directory,\ MAX\_PATH)\ >\ 0)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}system\_directory\ =\ \%s\ \(\backslash\)n"{}},\ system\_directory);}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ sprintf\ (dll\_file\_path,\ \textcolor{stringliteral}{"{}\%s\(\backslash\)\(\backslash\)\%s"{}},\ system\_directory,\ d3d\_adapter\_identifier.Driver);}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ intptr\_t\ find;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }\_finddata\_t\ find\_data;}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ find\ =\ \_findfirst\ (dll\_file\_path,\ \&find\_data);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (find\ !=\ -\/1)\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{struct\ }tm\ *dll\_time;}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dll\_time\ =\ localtime(\&find\_data.time\_write);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ month\ =\ dll\_time\ -\/>\ tm\_mon\ +\ 1;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ day\ =\ dll\_time\ -\/>\ tm\_mday;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ year\ =\ dll\_time\ -\/>\ tm\_year\ +\ 1900;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}Driver\ Date:\ \%d/\%d/\%d\(\backslash\)n"{}},\ \ month,\ day,\ year);}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_findclose\ (find);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ HMODULE\ driver\_dll;}}
\DoxyCodeLine{00269\ \textcolor{comment}{}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ driver\_dll\ =\ LoadLibrary\ (d3d\_adapter\_identifier.Driver);}}
\DoxyCodeLine{00271\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ if\ (driver\_dll)}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00273\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ DWORD\ length;}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ TCHAR\ file\_path\ [MAX\_PATH];}}
\DoxyCodeLine{00275\ \textcolor{comment}{}}
\DoxyCodeLine{00276\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ length\ =\ GetModuleFileName(driver\_dll,\ file\_path,\ MAX\_PATH);}}
\DoxyCodeLine{00277\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if\ (length\ >\ 0)}}
\DoxyCodeLine{00278\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00279\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ ("{}DLL\ file\ path\ =\ \%s\ \(\backslash\)n"{},\ file\_path);}}
\DoxyCodeLine{00280\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00281\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ else}}
\DoxyCodeLine{00282\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ ("{}ERROR:\ could\ not\ get\ GetModuleFileName\ for\ \%s\ \(\backslash\)n"{},\ d3d\_adapter\_identifier.Driver);}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00285\ \textcolor{comment}{}}
\DoxyCodeLine{00286\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ FreeLibrary\ (driver\_dll);}}
\DoxyCodeLine{00287\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ else}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00290\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ print\_GetLastError\ ("{}"{});}}
\DoxyCodeLine{00291\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ printf\ ("{}ERROR:\ could\ not\ load\ =\ \%s\ \(\backslash\)n"{},\ d3d\_adapter\_identifier.Driver);}}
\DoxyCodeLine{00292\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00293\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ */}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}VendorId\ =\ 0x\%x\(\backslash\)n"{}},\ d3d\_adapter\_identifier.VendorId);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}DeviceId\ =\ 0x\%x\(\backslash\)n"{}},\ d3d\_adapter\_identifier.DeviceId);}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ vendor\_id\ =\ d3d\_adapter\_identifier.VendorId;}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ device\_id\ =\ d3d\_adapter\_identifier.DeviceId;}
\DoxyCodeLine{00302\ }
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ product\ =\ HIWORD(d3d\_adapter\_identifier.DriverVersion.HighPart);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ version\ =\ LOWORD(d3d\_adapter\_identifier.DriverVersion.HighPart);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ sub\_version\ =\ HIWORD(d3d\_adapter\_identifier.DriverVersion.LowPart);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ build\ =\ LOWORD(d3d\_adapter\_identifier.DriverVersion.LowPart);}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}DRIVER\ VERSION:\ \%d.\%d.\%d.\%d\ \(\backslash\)n"{}},\ product,\ version,\ sub\_version,\ build);}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ -\/>\ GetDeviceCaps\ (adapter,\ device\_type,\ \&d3d\_caps)\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ vertex\_shader\_version\_major;}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ vertex\_shader\_version\_minor;}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pixel\_shader\_version\_major;}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pixel\_shader\_version\_minor;}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ vertex\_shader\_version\_major\ =\ D3DSHADER\_VERSION\_MAJOR\ (d3d\_caps.VertexShaderVersion);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ vertex\_shader\_version\_minor\ =\ D3DSHADER\_VERSION\_MINOR\ (d3d\_caps.VertexShaderVersion);}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ pixel\_shader\_version\_major\ =\ D3DSHADER\_VERSION\_MAJOR\ (d3d\_caps.PixelShaderVersion);}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ pixel\_shader\_version\_minor\ =\ D3DSHADER\_VERSION\_MINOR\ (d3d\_caps.PixelShaderVersion);}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (pixel\_shader\_version\_major)}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_00;}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_11;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ minimim\ specification\ for\ pixel\ shader\ 2.0\ is\ 96\ instruction}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ slots}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_20;}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_caps.PS20Caps.NumInstructionSlots\ >=\ 512)\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_2X;}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_30;}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ shader\_model\ =\ GraphicsStateGuardian::SM\_40;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}shader\_model\ =\ \%d\ \(\backslash\)n"{}},\ shader\_model);}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ get\_device\_caps\_state\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ get\_device\_caps\_state\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ count\ display\ modes}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ format\_index;}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ maximum\_display\_modes;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ UINT\ display\_mode\_count;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ D3DFORMAT\ d3d\_format;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ format\_index\ =\ 0;}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ maximum\_display\_modes\ =\ 0;}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (display\_format\_array\ [format\_index].d3d\_format\ !=\ D3DFMT\_UNKNOWN)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ d3d\_format\ =\ display\_format\_array\ [format\_index].d3d\_format;}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ display\_mode\_count\ =\ direct\_3d\ -\/>\ GetAdapterModeCount\ (adapter,\ d3d\_format);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_mode\_count\ >\ 0)\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ UINT\ mode\_index;}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ D3DDISPLAYMODE\ d3d\_display\_mode;}
\DoxyCodeLine{00375\ }
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (mode\_index\ =\ 0;\ mode\_index\ <\ display\_mode\_count;\ mode\_index++)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ -\/>\ EnumAdapterModes\ (adapter,\ d3d\_format,\ mode\_index,\ \&d3d\_display\_mode)\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_display\_mode.Width\ >=\ minimum\_width\ \&\&\ d3d\_display\_mode.Height\ >=\ minimum\_height\ \&\&}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Width\ <=\ maximum\_width\ \&\&\ d3d\_display\_mode.Height\ <=\ maximum\_height)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_format\_array\ [format\_index].bits\_per\_pixel\ >=\ minimum\_bits\_per\_pixel\ \&\&}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_format\_array\ [format\_index].bits\_per\_pixel\ <=\ maximum\_bits\_per\_pixel)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_format\ ==\ d3d\_display\_mode.Format)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ maximum\_display\_modes++;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ format\_index++;}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}maximum\_display\_modes\ \%d\ \(\backslash\)n"{}},\ maximum\_display\_modes);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ display\_mode\_array\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{structDisplayMode}{DisplayMode}}\ [maximum\_display\_modes];}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ format\_index\ =\ 0;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (display\_format\_array\ [format\_index].d3d\_format\ !=\ D3DFMT\_UNKNOWN)\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ d3d\_format\ =\ display\_format\_array\ [format\_index].d3d\_format;}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ display\_mode\_count\ =\ direct\_3d\ -\/>\ GetAdapterModeCount\ (adapter,\ d3d\_format);}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_mode\_count\ >\ 0)\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ UINT\ mode\_index;}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ D3DDISPLAYMODE\ d3d\_display\_mode;}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (mode\_index\ =\ 0;\ mode\_index\ <\ display\_mode\_count;\ mode\_index++)\ \{}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (direct\_3d\ -\/>\ EnumAdapterModes\ (adapter,\ d3d\_format,\ mode\_index,\ \&d3d\_display\_mode)\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_display\_mode.Width\ >=\ minimum\_width\ \&\&\ d3d\_display\_mode.Height\ >=\ minimum\_height\ \&\&}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Width\ <=\ maximum\_width\ \&\&\ d3d\_display\_mode.Height\ <=\ maximum\_height)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_format\_array\ [format\_index].bits\_per\_pixel\ >=\ minimum\_bits\_per\_pixel\ \&\&}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_format\_array\ [format\_index].bits\_per\_pixel\ <=\ maximum\_bits\_per\_pixel)\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}w\ =\ \%d\ h\ =\ \%d\ r\ =\ \%d\ f\ =\ \%d\ \(\backslash\)n"{}},}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Width,}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Height,}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.RefreshRate,}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Format);}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_format\ ==\ d3d\_display\_mode.Format)\ \{}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structDisplayMode}{DisplayMode}}\ *display\_mode;}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ =\ \&display\_mode\_array\ [total\_display\_modes];}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ -\/>\ width\ =\ d3d\_display\_mode.Width;}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ -\/>\ height\ =\ d3d\_display\_mode.Height;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ -\/>\ bits\_per\_pixel\ =\ display\_format\_array\ [format\_index].bits\_per\_pixel;}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ -\/>\ refresh\_rate\ =\ d3d\_display\_mode.RefreshRate;}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ display\_mode\ -\/>\ fullscreen\_only\ =\ display\_format\_array\ [format\_index].fullscreen\_only;}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_adapter\_display\_mode\_state\ \&\&}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Width\ ==\ current\_d3d\_display\_mode.Width\ \&\&}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Height\ ==\ current\_d3d\_display\_mode.Height\ \&\&}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.RefreshRate\ ==\ current\_d3d\_display\_mode.RefreshRate\ \&\&}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ d3d\_display\_mode.Format\ ==\ current\_d3d\_display\_mode.Format)\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_display\_mode\_index\ =\ total\_display\_modes;}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ total\_display\_modes++;}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ format\_index++;}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ UINT\ width;}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ UINT\ height;}
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ width\ =\ 640;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ height\ =\ 480;}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ make\ a\ window}}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ WNDCLASSEX\ window\_class\ =}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}\ (WNDCLASSEX),\ CS\_CLASSDC,\ window\_procedure,\ 0L,\ 0L,}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ GetModuleHandle(\textcolor{keyword}{nullptr}),\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr},}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}class\_name"{}},\ \textcolor{keyword}{nullptr}}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ RegisterClassEx\ (\&window\_class);}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ HWND\ window\_handle;}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ window\_handle\ =\ CreateWindow\ (\textcolor{stringliteral}{"{}class\_name"{}},\ \textcolor{stringliteral}{"{}window\_name"{}},\ WS\_DISABLED,\ 0,\ 0,\ width,\ height,\ (HWND)\ \textcolor{keyword}{nullptr},\ (HMENU)\ \textcolor{keyword}{nullptr},\ window\_class.hInstance,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (window\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ ShowWindow\ (window\_handle,\ SW\_HIDE);}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ DIRECT\_3D\_DEVICE\ direct\_3d\_device;}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \ \ D3DPRESENT\_PARAMETERS\ present\_parameters;}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ DWORD\ behavior\_flags;}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ direct\_3d\_device\ =\ 0;}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ memset\ (\&present\_parameters,\ 0,\ \textcolor{keyword}{sizeof}\ (D3DPRESENT\_PARAMETERS));}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ present\_parameters.BackBufferWidth\ =\ width;}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ present\_parameters.BackBufferHeight\ =\ height;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ present\_parameters.BackBufferFormat\ =\ D3DFMT\_X8R8G8B8;}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ present\_parameters.BackBufferCount\ =\ 1;}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \ \ present\_parameters.SwapEffect\ =\ D3DSWAPEFFECT\_FLIP;}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \ \ present\_parameters.hDeviceWindow\ =\ window\_handle;}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ present\_parameters.Windowed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ present\_parameters.EnableAutoDepthStencil\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ present\_parameters.AutoDepthStencilFormat\ =\ D3DFMT\_D24S8;}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ present\_parameters.FullScreen\_RefreshRateInHz;}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ present\_parameters.PresentationInterval\ =\ D3DPRESENT\_INTERVAL\_IMMEDIATE;}
\DoxyCodeLine{00493\ }
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d3d\_caps.DevCaps\ \&\ D3DDEVCAPS\_HWTRANSFORMANDLIGHT)\ \{}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ behavior\_flags\ =\ D3DCREATE\_HARDWARE\_VERTEXPROCESSING;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ behavior\_flags\ =\ D3DCREATE\_SOFTWARE\_VERTEXPROCESSING;}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ important\ to\ prevent\ DirectX\ from\ forcing\ the\ FPU\ into}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ single-\/precision\ mode.}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ behavior\_flags\ |=\ D3DCREATE\_FPU\_PRESERVE;}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ HRESULT\ result;}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ result\ =\ direct\_3d\ -\/>\ CreateDevice\ (adapter,\ device\_type,\ window\_handle,\ behavior\_flags,\ \&present\_parameters,\ \&direct\_3d\_device);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ allocate\ 512x512\ 32-\/bit\ textures\ (1MB\ size)\ until\ we\ run\ out\ or}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ hit\ the\ limit}}
\DoxyCodeLine{00511\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \#define\ MAXIMUM\_TEXTURES\ (2048\ -\/\ 1)}}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ total\_textures;}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ HRESULT\ texture\_result;}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ IDirect3DTexture9\ *texture\_array\ [MAXIMUM\_TEXTURES];}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ total\_textures\ =\ 0;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (total\_textures\ <\ MAXIMUM\_TEXTURES)\ \{}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ texture\_result\ =\ direct\_3d\_device\ -\/>\ CreateTexture\ (}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 512,}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 512,}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 1,}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ D3DUSAGE\_RENDERTARGET,}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ D3DFMT\_A8R8G8B8,}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ D3DPOOL\_DEFAULT,}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&texture\_array\ [total\_textures],}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\_result\ ==\ D3D\_OK)\ \{}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ total\_textures++;}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (texture\_result\ ==\ D3DERR\_OUTOFVIDEOMEMORY)\ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}D3DERR\_OUTOFVIDEOMEMORY\ \(\backslash\)n"{}});}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ free\ all\ allocated\ textures}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index;}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (index\ =\ 0;\ index\ <\ total\_textures;\ index++)\ \{}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ texture\_array\ [index]\ -\/>\ Release\ (\ );}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ \ \ video\_memory\ =\ (total\_textures\ *\ 1024\ *\ 1024);}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}video\_memory\ =\ \%d\ \(\backslash\)n"{}},\ video\_memory);}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ \ \ texture\_memory\ =\ direct\_3d\_device\ -\/>\ GetAvailableTextureMem\ (\ );}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}texture\_memory\ =\ \%d\ \(\backslash\)n"{}},\ texture\_memory);}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ direct\_3d\_device\ -\/>\ Release\ (\ );}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ \ state\ =\ DisplayInformation::DS\_success;}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}CreateDevice\ failed.\(\backslash\)n"{}});}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ state\ =\ DisplayInformation::DS\_create\_device\_error;}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ DestroyWindow\ (window\_handle);}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \_GetLastError\ (\textcolor{stringliteral}{"{}CreateWindow"{}});}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ state\ =\ DisplayInformation::DS\_create\_window\_error;}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ direct\_3d\ -\/>\ Release\ (\ );}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ state\ =\ DisplayInformation::DS\_direct\_3d\_create\_error;}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00588\ \ \ \ \ \ \ state\ =\ DisplayInformation::DS\_direct\_3d\_create\_error;}
\DoxyCodeLine{00589\ \ \ \ \ \}}
\DoxyCodeLine{00590\ }
\DoxyCodeLine{00591\ \ \ \ \ FreeLibrary\ (d3d\_dll);}
\DoxyCodeLine{00592\ \ \ \}}
\DoxyCodeLine{00593\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00594\ \ \ \ \ state\ =\ DisplayInformation::DS\_direct\_3d\_create\_error;}
\DoxyCodeLine{00595\ \ \ \}}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{00598\ \ \ \ \ display\_information\ -\/>\ \_state\ =\ state;}
\DoxyCodeLine{00599\ \ \ \ \ display\_information\ -\/>\ \_current\_display\_mode\_index\ =\ current\_display\_mode\_index;}
\DoxyCodeLine{00600\ \ \ \ \ display\_information\ -\/>\ \_get\_device\_caps\_state\ =\ get\_device\_caps\_state;}
\DoxyCodeLine{00601\ \ \ \ \ display\_information\ -\/>\ \_maximum\_window\_width\ =\ window\_width;}
\DoxyCodeLine{00602\ \ \ \ \ display\_information\ -\/>\ \_maximum\_window\_height\ =\ window\_height;}
\DoxyCodeLine{00603\ \ \ \ \ display\_information\ -\/>\ \_window\_bits\_per\_pixel\ =\ window\_bits\_per\_pixel;}
\DoxyCodeLine{00604\ \ \ \ \ display\_information\ -\/>\ \_total\_display\_modes\ =\ total\_display\_modes;}
\DoxyCodeLine{00605\ \ \ \ \ display\_information\ -\/>\ \_display\_mode\_array\ =\ display\_mode\_array;}
\DoxyCodeLine{00606\ \ \ \ \ display\_information\ -\/>\ \_shader\_model\ =\ shader\_model;}
\DoxyCodeLine{00607\ \ \ \ \ display\_information\ -\/>\ \_video\_memory\ =\ video\_memory;}
\DoxyCodeLine{00608\ \ \ \ \ display\_information\ -\/>\ \_texture\_memory\ =\ texture\_memory;}
\DoxyCodeLine{00609\ \ \ \ \ display\_information\ -\/>\ \_vendor\_id\ =\ vendor\_id;}
\DoxyCodeLine{00610\ \ \ \ \ display\_information\ -\/>\ \_device\_id\ =\ device\_id;}
\DoxyCodeLine{00611\ \ \ \ \ display\_information\ -\/>\ \_driver\_product\ =\ product;}
\DoxyCodeLine{00612\ \ \ \ \ display\_information\ -\/>\ \_driver\_version\ =\ version;}
\DoxyCodeLine{00613\ \ \ \ \ display\_information\ -\/>\ \_driver\_sub\_version\ =\ sub\_version;}
\DoxyCodeLine{00614\ \ \ \ \ display\_information\ -\/>\ \_driver\_build\ =\ build;}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ display\_information\ -\/>\ \_driver\_date\_month\ =\ month;}
\DoxyCodeLine{00617\ \ \ \ \ display\_information\ -\/>\ \_driver\_date\_day\ =\ day;}
\DoxyCodeLine{00618\ \ \ \ \ display\_information\ -\/>\ \_driver\_date\_year\ =\ year;}
\DoxyCodeLine{00619\ \ \ \}}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \textcolor{comment}{//\ memory}}
\DoxyCodeLine{00622\ \ \ MEMORYSTATUSEX\ memory\_status;}
\DoxyCodeLine{00623\ \ \ memory\_status.dwLength\ =\ \textcolor{keyword}{sizeof}(MEMORYSTATUSEX);}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{if}\ (GlobalMemoryStatusEx(\&memory\_status))\ \{}
\DoxyCodeLine{00626\ \ \ \ \ physical\_memory\ =\ memory\_status.ullTotalPhys;}
\DoxyCodeLine{00627\ \ \ \ \ available\_physical\_memory\ =\ memory\_status.ullAvailPhys;}
\DoxyCodeLine{00628\ \ \ \}\ \textcolor{keywordflow}{else}\ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ MEMORYSTATUS\ memory\_status;}
\DoxyCodeLine{00630\ \ \ \ \ memory\_status.dwLength\ =\ \textcolor{keyword}{sizeof}(MEMORYSTATUS);}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ GlobalMemoryStatus(\&memory\_status);}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ \ \ physical\_memory\ =\ memory\_status.dwTotalPhys;}
\DoxyCodeLine{00635\ \ \ \ \ available\_physical\_memory\ =\ memory\_status.dwAvailPhys;}
\DoxyCodeLine{00636\ \ \ \}}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00638\ \ \ \textcolor{keywordflow}{if}\ (debug)\ \{}
\DoxyCodeLine{00639\ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}physical\_memory\ \%I64d\ \(\backslash\)n"{}},\ physical\_memory);}
\DoxyCodeLine{00640\ \ \ \ \ printf\ (\textcolor{stringliteral}{"{}available\_physical\_memory\ \%I64d\ \(\backslash\)n"{}},\ available\_physical\_memory);}
\DoxyCodeLine{00641\ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ display\_information\ -\/>\ \_physical\_memory\ =\ physical\_memory;}
\DoxyCodeLine{00644\ \ \ display\_information\ -\/>\ \_available\_physical\_memory\ =\ available\_physical\_memory;}
\DoxyCodeLine{00645\ }
\DoxyCodeLine{00646\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00647\ \}}

\end{DoxyCode}
