\doxysection{multifile.\+h}
\hypertarget{multifile_8h_source}{}\label{multifile_8h_source}\index{panda/src/express/multifile.h@{panda/src/express/multifile.h}}
\mbox{\hyperlink{multifile_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ MULTIFILE\_H}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ MULTIFILE\_H}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__express_8h}{config\_express.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{streamWrapper_8h}{streamWrapper.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{subStream_8h}{subStream.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{filename_8h}{filename.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{ordered__vector_8h}{ordered\_vector.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indirectLess_8h}{indirectLess.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{referenceCount_8h}{referenceCount.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pvector_8h}{pvector.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vector__uchar_8h}{vector\_uchar.h}}"{}}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#ifdef\ HAVE\_OPENSSL}}
\DoxyCodeLine{00030\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }x509\_st\ X509;}
\DoxyCodeLine{00031\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }evp\_pkey\_st\ EVP\_PKEY;}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HAVE\_OPENSSL}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{class\ }EXPCL\_PANDA\_EXPRESS\ \mbox{\hyperlink{classMultifile}{Multifile}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ \{}
\DoxyCodeLine{00038\ PUBLISHED:}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}();}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classMultifile}{Multifile}}\ \&copy)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classMultifile}{\string~Multifile}}();}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}\ \&operator\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classMultifile}{Multifile}}\ \&copy)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ PUBLISHED:}
\DoxyCodeLine{00046\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_read(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&multifile\_name,\ \textcolor{keyword}{const}\ std::streampos\ \&offset\ =\ 0);}
\DoxyCodeLine{00047\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_read(\mbox{\hyperlink{classIStreamWrapper}{IStreamWrapper}}\ *multifile\_stream,\ \textcolor{keywordtype}{bool}\ owns\_pointer\ =\ \textcolor{keyword}{false},\ \textcolor{keyword}{const}\ std::streampos\ \&offset\ =\ 0);}
\DoxyCodeLine{00048\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_write(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&multifile\_name);}
\DoxyCodeLine{00049\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_write(std::ostream\ *multifile\_stream,\ \textcolor{keywordtype}{bool}\ owns\_pointer\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00050\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_read\_write(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&multifile\_name);}
\DoxyCodeLine{00051\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ open\_read\_write(std::iostream\ *multifile\_stream,\ \textcolor{keywordtype}{bool}\ owns\_pointer\ =\ \textcolor{keyword}{false});}
\DoxyCodeLine{00052\ \ \ BLOCKING\ \textcolor{keywordtype}{void}\ close();}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ INLINE\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&get\_multifile\_name()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00055\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_multifile\_name(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&multifile\_name);}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_read\_valid()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00058\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_write\_valid()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00059\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ needs\_repack()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ INLINE\ time\_t\ get\_timestamp()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00062\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_timestamp(time\_t\ timestamp);}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_record\_timestamp(\textcolor{keywordtype}{bool}\ record\_timestamp);}
\DoxyCodeLine{00065\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ get\_record\_timestamp()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \textcolor{keywordtype}{void}\ set\_scale\_factor(\textcolor{keywordtype}{size\_t}\ scale\_factor);}
\DoxyCodeLine{00068\ \ \ INLINE\ \textcolor{keywordtype}{size\_t}\ get\_scale\_factor()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_encryption\_flag(\textcolor{keywordtype}{bool}\ flag);}
\DoxyCodeLine{00071\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ get\_encryption\_flag()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_encryption\_algorithm(\textcolor{keyword}{const}\ std::string\ \&encryption\_algorithm);}
\DoxyCodeLine{00074\ \ \ INLINE\ \textcolor{keyword}{const}\ std::string\ \&get\_encryption\_algorithm()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00075\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_encryption\_key\_length(\textcolor{keywordtype}{int}\ encryption\_key\_length);}
\DoxyCodeLine{00076\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_encryption\_key\_length()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00077\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_encryption\_iteration\_count(\textcolor{keywordtype}{int}\ encryption\_iteration\_count);}
\DoxyCodeLine{00078\ \ \ INLINE\ \textcolor{keywordtype}{int}\ get\_encryption\_iteration\_count()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ std::string\ add\_subfile(\textcolor{keyword}{const}\ std::string\ \&subfile\_name,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename,}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ compression\_level);}
\DoxyCodeLine{00082\ \ \ std::string\ add\_subfile(\textcolor{keyword}{const}\ std::string\ \&subfile\_name,\ std::istream\ *subfile\_data,}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ compression\_level);}
\DoxyCodeLine{00084\ \ \ std::string\ update\_subfile(\textcolor{keyword}{const}\ std::string\ \&subfile\_name,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename,}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ compression\_level);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ PY\_EXTENSION(INLINE\ PyObject\ *set\_encryption\_password(PyObject\ *encryption\_password)\ \textcolor{keyword}{const});}
\DoxyCodeLine{00088\ \ \ PY\_EXTENSION(INLINE\ PyObject\ *get\_encryption\_password()\ \textcolor{keyword}{const});}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#ifdef\ HAVE\_OPENSSL}}
\DoxyCodeLine{00091\ \ \ \textcolor{keywordtype}{bool}\ add\_signature(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&certificate,}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&chain,}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&pkey,}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&password\ =\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{bool}\ add\_signature(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&composite,}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&password\ =\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{int}\ get\_num\_signatures()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00099\ \ \ std::string\ get\_signature\_subject\_name(\textcolor{keywordtype}{int}\ n)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00100\ \ \ std::string\ get\_signature\_friendly\_name(\textcolor{keywordtype}{int}\ n)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00101\ \ \ std::string\ get\_signature\_public\_key(\textcolor{keywordtype}{int}\ n)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{void}\ print\_signature\_certificate(\textcolor{keywordtype}{int}\ n,\ std::ostream\ \&out)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{void}\ write\_signature\_certificate(\textcolor{keywordtype}{int}\ n,\ std::ostream\ \&out)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{int}\ validate\_signature\_certificate(\textcolor{keywordtype}{int}\ n)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_OPENSSL}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ flush();}
\DoxyCodeLine{00109\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ repack();}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordtype}{int}\ get\_num\_subfiles()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{int}\ find\_subfile(\textcolor{keyword}{const}\ std::string\ \&subfile\_name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordtype}{bool}\ has\_directory(\textcolor{keyword}{const}\ std::string\ \&subfile\_name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{bool}\ scan\_directory(vector\_string\ \&contents,}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&subfile\_name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{void}\ remove\_subfile(\textcolor{keywordtype}{int}\ index);}
\DoxyCodeLine{00117\ \ \ INLINE\ \textcolor{keywordtype}{bool}\ remove\_subfile(\textcolor{keyword}{const}\ std::string\ \&subfile\_name);}
\DoxyCodeLine{00118\ \ \ \textcolor{keyword}{const}\ std::string\ \&get\_subfile\_name(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00119\ \ \ MAKE\_SEQ(get\_subfile\_names,\ get\_num\_subfiles,\ get\_subfile\_name);}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{size\_t}\ get\_subfile\_length(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00121\ \ \ time\_t\ get\_subfile\_timestamp(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{bool}\ is\_subfile\_compressed(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{bool}\ is\_subfile\_encrypted(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{bool}\ is\_subfile\_text(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ std::streampos\ get\_index\_end()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00127\ \ \ std::streampos\ get\_subfile\_internal\_start(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{size\_t}\ get\_subfile\_internal\_length(\textcolor{keywordtype}{int}\ index)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ BLOCKING\ INLINE\ vector\_uchar\ read\_subfile(\textcolor{keywordtype}{int}\ index);}
\DoxyCodeLine{00131\ \ \ BLOCKING\ std::istream\ *open\_read\_subfile(\textcolor{keywordtype}{int}\ index);}
\DoxyCodeLine{00132\ \ \ BLOCKING\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ close\_read\_subfile(std::istream\ *stream);}
\DoxyCodeLine{00133\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ extract\_subfile(\textcolor{keywordtype}{int}\ index,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename);}
\DoxyCodeLine{00134\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ extract\_subfile\_to(\textcolor{keywordtype}{int}\ index,\ std::ostream\ \&out);}
\DoxyCodeLine{00135\ \ \ BLOCKING\ \textcolor{keywordtype}{bool}\ compare\_subfile(\textcolor{keywordtype}{int}\ index,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{void}\ output(std::ostream\ \&out)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordtype}{void}\ ls(std::ostream\ \&out\ =\ std::cout)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ \textcolor{keyword}{static}\ INLINE\ std::string\ get\_magic\_number();}
\DoxyCodeLine{00141\ \ \ MAKE\_PROPERTY(magic\_number,\ get\_magic\_number);}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{keywordtype}{void}\ set\_header\_prefix(\textcolor{keyword}{const}\ std::string\ \&header\_prefix);}
\DoxyCodeLine{00144\ \ \ INLINE\ \textcolor{keyword}{const}\ std::string\ \&get\_header\_prefix()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00147\ \ \ INLINE\ \textcolor{keywordtype}{void}\ set\_encryption\_password(\textcolor{keyword}{const}\ std::string\ \&encryption\_password);}
\DoxyCodeLine{00148\ \ \ INLINE\ \textcolor{keyword}{const}\ std::string\ \&get\_encryption\_password()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \textcolor{preprocessor}{\#ifdef\ HAVE\_OPENSSL}}
\DoxyCodeLine{00151\ \ \ \textcolor{keyword}{class\ }CertRecord\ \{}
\DoxyCodeLine{00152\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00153\ \ \ \ \ INLINE\ CertRecord(X509\ *cert);}
\DoxyCodeLine{00154\ \ \ \ \ INLINE\ CertRecord(\textcolor{keyword}{const}\ CertRecord\ \&copy);}
\DoxyCodeLine{00155\ \ \ \ \ INLINE\ \string~CertRecord();}
\DoxyCodeLine{00156\ \ \ \ \ INLINE\ \textcolor{keywordtype}{void}\ operator\ =\ (\textcolor{keyword}{const}\ CertRecord\ \&other);}
\DoxyCodeLine{00157\ \ \ \ \ X509\ *\_cert;}
\DoxyCodeLine{00158\ \ \ \};}
\DoxyCodeLine{00159\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpvector}{pvector<CertRecord>}}\ CertChain;}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \textcolor{keywordtype}{bool}\ add\_signature(\textcolor{keyword}{const}\ CertChain\ \&chain,\ EVP\_PKEY\ *pkey);}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \textcolor{keyword}{const}\ CertChain\ \&get\_signature(\textcolor{keywordtype}{int}\ n)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_OPENSSL}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \textcolor{keywordtype}{bool}\ read\_subfile(\textcolor{keywordtype}{int}\ index,\ std::string\ \&result);}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordtype}{bool}\ read\_subfile(\textcolor{keywordtype}{int}\ index,\ vector\_uchar\ \&result);}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00170\ \ \ \textcolor{keyword}{enum}\ SubfileFlags\ \{}
\DoxyCodeLine{00171\ \ \ \ \ SF\_deleted\ \ \ \ \ \ \ \ =\ 0x0001,}
\DoxyCodeLine{00172\ \ \ \ \ SF\_index\_invalid\ \ =\ 0x0002,}
\DoxyCodeLine{00173\ \ \ \ \ SF\_data\_invalid\ \ \ =\ 0x0004,}
\DoxyCodeLine{00174\ \ \ \ \ SF\_compressed\ \ \ \ \ =\ 0x0008,}
\DoxyCodeLine{00175\ \ \ \ \ SF\_encrypted\ \ \ \ \ \ =\ 0x0010,}
\DoxyCodeLine{00176\ \ \ \ \ SF\_signature\ \ \ \ \ \ =\ 0x0020,}
\DoxyCodeLine{00177\ \ \ \ \ SF\_text\ \ \ \ \ \ \ \ \ \ \ =\ 0x0040,}
\DoxyCodeLine{00178\ \ \ \};}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{keyword}{class\ }Subfile\ \{}
\DoxyCodeLine{00181\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00182\ \ \ \ \ INLINE\ Subfile();}
\DoxyCodeLine{00183\ \ \ \ \ INLINE\ \textcolor{keywordtype}{bool}\ operator\ <\ (\textcolor{keyword}{const}\ Subfile\ \&other)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00184\ \ \ \ \ std::streampos\ read\_index(std::istream\ \&read,\ std::streampos\ fpos,}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}\ *multfile);}
\DoxyCodeLine{00186\ \ \ \ \ std::streampos\ write\_index(std::ostream\ \&write,\ std::streampos\ fpos,}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}\ *multifile);}
\DoxyCodeLine{00188\ \ \ \ \ std::streampos\ write\_data(std::ostream\ \&write,\ std::istream\ *read,\ std::streampos\ fpos,}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMultifile}{Multifile}}\ *multifile);}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordtype}{void}\ rewrite\_index\_data\_start(std::ostream\ \&write,\ \mbox{\hyperlink{classMultifile}{Multifile}}\ *multifile);}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordtype}{void}\ rewrite\_index\_flags(std::ostream\ \&write);}
\DoxyCodeLine{00192\ \ \ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_deleted()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00193\ \ \ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_index\_invalid()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00194\ \ \ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_data\_invalid()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00195\ \ \ \ \ INLINE\ \textcolor{keywordtype}{bool}\ is\_cert\_special()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00196\ \ \ \ \ INLINE\ std::streampos\ get\_last\_byte\_pos()\ \textcolor{keyword}{const};}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \ \ std::string\ \_name;}
\DoxyCodeLine{00199\ \ \ \ \ std::streampos\ \_index\_start;}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_index\_length;}
\DoxyCodeLine{00201\ \ \ \ \ std::streampos\ \_data\_start;}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_data\_length;}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \_uncompressed\_length;}
\DoxyCodeLine{00204\ \ \ \ \ time\_t\ \_timestamp;}
\DoxyCodeLine{00205\ \ \ \ \ std::istream\ *\_source;}
\DoxyCodeLine{00206\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ \_source\_filename;}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordtype}{int}\ \_flags;}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordtype}{int}\ \_compression\_level;\ \ \textcolor{comment}{//\ Not\ preserved\ on\ disk.}}
\DoxyCodeLine{00209\ \textcolor{preprocessor}{\#ifdef\ HAVE\_OPENSSL}}
\DoxyCodeLine{00210\ \ \ \ \ EVP\_PKEY\ *\_pkey;\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Not\ preserved\ on\ disk.}}
\DoxyCodeLine{00211\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HAVE\_OPENSSL}}
\DoxyCodeLine{00212\ \ \ \};}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ INLINE\ std::streampos\ word\_to\_streampos(\textcolor{keywordtype}{size\_t}\ word)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00215\ \ \ INLINE\ \textcolor{keywordtype}{size\_t}\ streampos\_to\_word(std::streampos\ fpos)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00216\ \ \ INLINE\ std::streampos\ normalize\_streampos(std::streampos\ fpos)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00217\ \ \ std::streampos\ pad\_to\_streampos(std::streampos\ fpos);}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordtype}{void}\ add\_new\_subfile(Subfile\ *subfile,\ \textcolor{keywordtype}{int}\ compression\_level);}
\DoxyCodeLine{00220\ \ \ std::istream\ *open\_read\_subfile(Subfile\ *subfile);}
\DoxyCodeLine{00221\ \ \ std::string\ standardize\_subfile\_name(\textcolor{keyword}{const}\ std::string\ \&subfile\_name)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordtype}{void}\ clear\_subfiles();}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{bool}\ read\_index();}
\DoxyCodeLine{00225\ \ \ \textcolor{keywordtype}{bool}\ write\_header();}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \textcolor{keywordtype}{void}\ check\_signatures();}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{keyword}{static}\ INLINE\ \textcolor{keywordtype}{char}\ tohex(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ nibble);}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classov__set}{ov\_set<Subfile\ *,\ IndirectLess<Subfile>}}\ >\ \mbox{\hyperlink{classov__set}{Subfiles}};}
\DoxyCodeLine{00232\ \ \ \mbox{\hyperlink{classov__set}{Subfiles}}\ \_subfiles;}
\DoxyCodeLine{00233\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpvector}{pvector<Subfile\ *>}}\ \mbox{\hyperlink{classpvector}{PendingSubfiles}};}
\DoxyCodeLine{00234\ \ \ \mbox{\hyperlink{classpvector}{PendingSubfiles}}\ \_new\_subfiles;}
\DoxyCodeLine{00235\ \ \ \mbox{\hyperlink{classpvector}{PendingSubfiles}}\ \_removed\_subfiles;}
\DoxyCodeLine{00236\ \ \ \mbox{\hyperlink{classpvector}{PendingSubfiles}}\ \_cert\_special;}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \textcolor{preprocessor}{\#ifdef\ HAVE\_OPENSSL}}
\DoxyCodeLine{00239\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpvector}{pvector<CertChain>}}\ Certificates;}
\DoxyCodeLine{00240\ \ \ Certificates\ \_signatures;}
\DoxyCodeLine{00241\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HAVE\_OPENSSL}}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ std::streampos\ \_offset;}
\DoxyCodeLine{00244\ \ \ \mbox{\hyperlink{classIStreamWrapper}{IStreamWrapper}}\ *\_read;}
\DoxyCodeLine{00245\ \ \ std::ostream\ *\_write;}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordtype}{bool}\ \_owns\_stream;}
\DoxyCodeLine{00247\ \ \ std::streampos\ \_next\_index;}
\DoxyCodeLine{00248\ \ \ std::streampos\ \_last\_index;}
\DoxyCodeLine{00249\ \ \ std::streampos\ \_last\_data\_byte;}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \textcolor{keywordtype}{bool}\ \_needs\_repack;}
\DoxyCodeLine{00252\ \ \ time\_t\ \_timestamp;}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordtype}{bool}\ \_timestamp\_dirty;}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordtype}{bool}\ \_record\_timestamp;}
\DoxyCodeLine{00255\ \ \ \textcolor{keywordtype}{size\_t}\ \_scale\_factor;}
\DoxyCodeLine{00256\ \ \ \textcolor{keywordtype}{size\_t}\ \_new\_scale\_factor;}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \textcolor{keywordtype}{bool}\ \_encryption\_flag;}
\DoxyCodeLine{00259\ \ \ std::string\ \_encryption\_password;}
\DoxyCodeLine{00260\ \ \ std::string\ \_encryption\_algorithm;}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordtype}{int}\ \_encryption\_key\_length;}
\DoxyCodeLine{00262\ \ \ \textcolor{keywordtype}{int}\ \_encryption\_iteration\_count;}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ pifstream\ \_read\_file;}
\DoxyCodeLine{00265\ \ \ \mbox{\hyperlink{classIStreamWrapper}{IStreamWrapper}}\ \_read\_filew;}
\DoxyCodeLine{00266\ \ \ pofstream\ \_write\_file;}
\DoxyCodeLine{00267\ \ \ pfstream\ \_read\_write\_file;}
\DoxyCodeLine{00268\ \ \ \mbox{\hyperlink{classStreamWrapper}{StreamWrapper}}\ \_read\_write\_filew;}
\DoxyCodeLine{00269\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ \_multifile\_name;}
\DoxyCodeLine{00270\ \ \ std::string\ \_header\_prefix;}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \textcolor{keywordtype}{int}\ \_file\_major\_ver;}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordtype}{int}\ \_file\_minor\_ver;}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ \_header[];}
\DoxyCodeLine{00276\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_header\_size;}
\DoxyCodeLine{00277\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_current\_major\_ver;}
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \_current\_minor\_ver;}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ \_encrypt\_header[];}
\DoxyCodeLine{00281\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ \_encrypt\_header\_size;}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }Subfile;}
\DoxyCodeLine{00284\ \};}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \textcolor{preprocessor}{\#include\ "{}multifile.I"{}}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00288\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ !MULTIFILE\_H}}

\end{DoxyCode}
