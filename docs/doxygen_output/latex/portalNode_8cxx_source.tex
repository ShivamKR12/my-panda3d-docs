\doxysection{portal\+Node.\+cxx}
\hypertarget{portalNode_8cxx_source}{}\label{portalNode_8cxx_source}\index{panda/src/pgraph/portalNode.cxx@{panda/src/pgraph/portalNode.cxx}}
\mbox{\hyperlink{portalNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{portalNode_8h}{portalNode.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomNode_8h}{geomNode.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverserData_8h}{cullTraverserData.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverser_8h}{cullTraverser.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{renderState_8h}{renderState.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{portalClipper_8h}{portalClipper.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{transformState_8h}{transformState.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{clipPlaneAttrib_8h}{clipPlaneAttrib.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{colorScaleAttrib_8h}{colorScaleAttrib.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{transparencyAttrib_8h}{transparencyAttrib.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{boundingSphere_8h}{boundingSphere.h}}"{}}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{plane_8h}{plane.h}}"{}}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{using\ }std::endl;}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ PortalNode::\_type\_handle;}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00043\ PortalNode::}
\DoxyCodeLine{00044\ PortalNode(\textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(name),}
\DoxyCodeLine{00046\ \ \ \_from\_portal\_mask(\mbox{\hyperlink{classBitMask}{PortalMask}}::all\_on()),}
\DoxyCodeLine{00047\ \ \ \_into\_portal\_mask(\mbox{\hyperlink{classBitMask}{PortalMask}}::all\_on()),}
\DoxyCodeLine{00048\ \ \ \_flags(0)}
\DoxyCodeLine{00049\ \{}
\DoxyCodeLine{00050\ \ \ set\_cull\_callback();}
\DoxyCodeLine{00051\ \ \ set\_renderable();}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \_visible\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \_open\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00055\ \ \ \_clip\_plane\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \_max\_depth\ =\ 10;}
\DoxyCodeLine{00057\ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00063\ PortalNode::}
\DoxyCodeLine{00064\ PortalNode(\textcolor{keyword}{const}\ std::string\ \&name,\ LPoint3\ pos,\ PN\_stdfloat\ scale)\ :}
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(name),}
\DoxyCodeLine{00066\ \ \ \_from\_portal\_mask(\mbox{\hyperlink{classBitMask}{PortalMask}}::all\_on()),}
\DoxyCodeLine{00067\ \ \ \_into\_portal\_mask(\mbox{\hyperlink{classBitMask}{PortalMask}}::all\_on()),}
\DoxyCodeLine{00068\ \ \ \_flags(0)}
\DoxyCodeLine{00069\ \{}
\DoxyCodeLine{00070\ \ \ set\_cull\_callback();}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ add\_vertex(LPoint3(pos[0]-\/1.0*scale,\ pos[1],\ pos[2]-\/1.0*scale));}
\DoxyCodeLine{00073\ \ \ add\_vertex(LPoint3(pos[0]+1.0*scale,\ pos[1],\ pos[2]-\/1.0*scale));}
\DoxyCodeLine{00074\ \ \ add\_vertex(LPoint3(pos[0]+1.0*scale,\ pos[1],\ pos[2]+1.0*scale));}
\DoxyCodeLine{00075\ \ \ add\_vertex(LPoint3(pos[0]-\/1.0*scale,\ pos[1],\ pos[2]+1.0*scale));}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \_visible\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00078\ \ \ \_open\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00079\ \ \ \_clip\_plane\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \_max\_depth\ =\ 10;}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00086\ PortalNode::}
\DoxyCodeLine{00087\ PortalNode(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPortalNode}{PortalNode}}\ \&copy)\ :}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(copy),}
\DoxyCodeLine{00089\ \ \ \_from\_portal\_mask(copy.\_from\_portal\_mask),}
\DoxyCodeLine{00090\ \ \ \_into\_portal\_mask(copy.\_into\_portal\_mask),}
\DoxyCodeLine{00091\ \ \ \_flags(copy.\_flags),}
\DoxyCodeLine{00092\ \ \ \_vertices(copy.\_vertices),}
\DoxyCodeLine{00093\ \ \ \_cell\_in(copy.\_cell\_in),}
\DoxyCodeLine{00094\ \ \ \_cell\_out(copy.\_cell\_out),}
\DoxyCodeLine{00095\ \ \ \_clip\_plane(copy.\_clip\_plane),}
\DoxyCodeLine{00096\ \ \ \_visible(copy.\_visible),}
\DoxyCodeLine{00097\ \ \ \_open(copy.\_open),}
\DoxyCodeLine{00098\ \ \ \_max\_depth(copy.\_max\_depth)}
\DoxyCodeLine{00099\ \{}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00105\ PortalNode::}
\DoxyCodeLine{00106\ \string~PortalNode()\ \{}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00114\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classPortalNode_a10e35c0b1b8395865bcc36086b101351}{PortalNode::}}}
\DoxyCodeLine{00115\ \mbox{\hyperlink{classPortalNode_a10e35c0b1b8395865bcc36086b101351}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPortalNode}{PortalNode}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00123\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPortalNode_a2e28e0250d25c254c9553e1f8fc61244}{PortalNode::}}}
\DoxyCodeLine{00124\ \mbox{\hyperlink{classPortalNode_a2e28e0250d25c254c9553e1f8fc61244}{preserve\_name}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00126\ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00131\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_a50cd3789ee3e588ab0170308e05ea651}{PortalNode::}}}
\DoxyCodeLine{00132\ \mbox{\hyperlink{classPortalNode_a50cd3789ee3e588ab0170308e05ea651}{enable\_clipping\_planes}}()\ \{}
\DoxyCodeLine{00133\ \ \ \_top\_plane\_node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPlaneNode}{PlaneNode}}(\textcolor{stringliteral}{"{}top"{}});}
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ top\_plane\_np\ =\ \mbox{\hyperlink{classNodePath}{NodePath}}(\textcolor{keyword}{this}).attach\_new\_node(\_top\_plane\_node);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \_bottom\_plane\_node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPlaneNode}{PlaneNode}}(\textcolor{stringliteral}{"{}bottom"{}});}
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ bottom\_plane\_np\ =\ \mbox{\hyperlink{classNodePath}{NodePath}}(\textcolor{keyword}{this}).attach\_new\_node(\_bottom\_plane\_node);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \_left\_plane\_node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPlaneNode}{PlaneNode}}(\textcolor{stringliteral}{"{}left"{}});}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ left\_plane\_np\ =\ \mbox{\hyperlink{classNodePath}{NodePath}}(\textcolor{keyword}{this}).attach\_new\_node(\_left\_plane\_node);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \_right\_plane\_node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPlaneNode}{PlaneNode}}(\textcolor{stringliteral}{"{}right"{}});}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ right\_plane\_np\ =\ \mbox{\hyperlink{classNodePath}{NodePath}}(\textcolor{keyword}{this}).attach\_new\_node(\_right\_plane\_node);}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ plane\_attrib\ =\ ClipPlaneAttrib::make();}
\DoxyCodeLine{00146\ \ \ plane\_attrib\ =\ DCAST(\mbox{\hyperlink{classClipPlaneAttrib}{ClipPlaneAttrib}},\ plane\_attrib)-\/>add\_on\_plane(\mbox{\hyperlink{classNodePath}{NodePath}}(top\_plane\_np));}
\DoxyCodeLine{00147\ \ \ plane\_attrib\ =\ DCAST(\mbox{\hyperlink{classClipPlaneAttrib}{ClipPlaneAttrib}},\ plane\_attrib)-\/>add\_on\_plane(\mbox{\hyperlink{classNodePath}{NodePath}}(bottom\_plane\_np));}
\DoxyCodeLine{00148\ \ \ plane\_attrib\ =\ DCAST(\mbox{\hyperlink{classClipPlaneAttrib}{ClipPlaneAttrib}},\ plane\_attrib)-\/>add\_on\_plane(\mbox{\hyperlink{classNodePath}{NodePath}}(left\_plane\_np));}
\DoxyCodeLine{00149\ \ \ plane\_attrib\ =\ DCAST(\mbox{\hyperlink{classClipPlaneAttrib}{ClipPlaneAttrib}},\ plane\_attrib)-\/>add\_on\_plane(\mbox{\hyperlink{classNodePath}{NodePath}}(right\_plane\_np));}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \_clip\_state\ =\ RenderState::make(plane\_attrib);}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_a1ca0d2da11102c662f26091711a1c8d0}{PortalNode::}}}
\DoxyCodeLine{00159\ \mbox{\hyperlink{classPortalNode_a1ca0d2da11102c662f26091711a1c8d0}{xform}}(\textcolor{keyword}{const}\ LMatrix4\ \&mat)\ \{}
\DoxyCodeLine{00160\ \ \ nassertv(!mat.is\_nan());}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00174\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classPortalNode_a67d0464d56b573d6af5a40d1db0933c4}{PortalNode::}}}
\DoxyCodeLine{00175\ \mbox{\hyperlink{classPortalNode_a67d0464d56b573d6af5a40d1db0933c4}{combine\_with}}(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *other)\ \{}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{if}\ (is\_exact\_type(get\_class\_type())\ \&\&}
\DoxyCodeLine{00177\ \ \ \ \ \ \ other-\/>is\_exact\_type(get\_class\_type()))\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ Two\ PortalNodes\ can\ combine,\ but\ only\ if\ they\ have\ the\ same\ name,}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//\ because\ the\ name\ is\ often\ meaningful.}}
\DoxyCodeLine{00180\ \ \ \ \ \mbox{\hyperlink{classPortalNode}{PortalNode}}\ *cother\ =\ DCAST(\mbox{\hyperlink{classPortalNode}{PortalNode}},\ other);}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_name()\ ==\ cother-\/>get\_name())\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00183\ \ \ \ \ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{comment}{//\ Two\ PortalNodes\ with\ different\ names\ can't\ combine.}}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00187\ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{return}\ PandaNode::combine\_with(other);}
\DoxyCodeLine{00190\ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00201\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPortalNode_a4638ea01b4930640d33c9b36ba046136}{PortalNode::}}}
\DoxyCodeLine{00202\ \mbox{\hyperlink{classPortalNode_a4638ea01b4930640d33c9b36ba046136}{cull\_callback}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00203\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ trav-\/>get\_current\_thread();}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \mbox{\hyperlink{classPortalClipper}{PortalClipper}}\ *portal\_viewer\ =\ trav-\/>get\_portal\_clipper();}
\DoxyCodeLine{00206\ \ \ set\_visible(\textcolor{keyword}{false});}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{if}\ (is\_open()\ \&\&\ !\_cell\_out.is\_empty()\ \&\&\ portal\_viewer\ \&\&\ data.\_portal\_depth\ <=\ \_max\_depth)\ \{}
\DoxyCodeLine{00208\ \ \ \ \ portal\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}checking\ portal\ node\ \ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ endl;}
\DoxyCodeLine{00209\ \ \ \ \ portal\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}portal\_depth\ is\ "{}}\ <<\ data.\_portal\_depth\ <<\ endl;}
\DoxyCodeLine{00210\ \ \ \ \ PT(\mbox{\hyperlink{classGeometricBoundingVolume}{GeometricBoundingVolume}})\ vf\ =\ trav-\/>get\_view\_frustum();}
\DoxyCodeLine{00211\ \ \ \ \ PT(\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}})\ reduced\_frustum;}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ remember\ old\ viewport\ and\ frustum,\ so\ we\ can\ restore\ them\ for\ the}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{comment}{//\ siblings.\ \ (it\ gets\ changed\ by\ the\ prepare\_portal\ call)}}
\DoxyCodeLine{00215\ \ \ \ \ LPoint2\ old\_reduced\_viewport\_min,\ old\_reduced\_viewport\_max;}
\DoxyCodeLine{00216\ \ \ \ \ portal\_viewer-\/>get\_reduced\_viewport(old\_reduced\_viewport\_min,\ old\_reduced\_viewport\_max);}
\DoxyCodeLine{00217\ \ \ \ \ PT(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}})\ old\_bh\ =\ portal\_viewer-\/>get\_reduced\_frustum();}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{if}\ (portal\_viewer-\/>\mbox{\hyperlink{classPortalClipper_ad27297877c09641b373efbde86bc8ed5}{prepare\_portal}}(data.get\_node\_path()))\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((reduced\_frustum\ =\ portal\_viewer-\/>get\_reduced\_frustum()))\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remember\ current\ clip\ state,\ we\ might\ change\ it}}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ old\_clip\_state\ =\ portal\_viewer-\/>get\_clip\_state();}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ set\_visible(\textcolor{keyword}{true});}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ frustum\ is\ in\ camera\ space}}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ vf\ =\ DCAST(\mbox{\hyperlink{classGeometricBoundingVolume}{GeometricBoundingVolume}},\ reduced\_frustum);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ a\ copy\ of\ this\ reduced\ frustum,\ we'll\ transform\ it\ from}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ camera\ space\ to\ the\ cell\_out\ space}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}})\ new\_bh\ =\ DCAST(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}},\ vf-\/>make\_copy());}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ net\ trasform\ of\ the\ \_cell\_out\ as\ seen\ from\ the\ camera.}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ cell\_transform\ =\ \_cell\_out.get\_net\_transform();}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ frustum\_transform\ =\ cell\_transform\ -\/>invert\_compose(portal\_viewer-\/>\_scene\_setup-\/>get\_cull\_center().get\_net\_transform());}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ to\ \_cell\_out\ space}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ new\_bh-\/>xform(frustum\_transform-\/>get\_mat());}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ next\_state\ =\ data.\_state;}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ set\ clipping\ planes,\ if\ desired..}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_clip\_plane)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ create\ a\ copy\ of\ this\ reduced\ frustum,\ we'll\ transform\ it\ from}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ camera\ space\ to\ this\ portal\ node's\ space\ (because\ the\ clip\ planes}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ are\ attached\ to\ this\ node)}}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}})\ temp\_bh\ =\ DCAST(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}},\ vf-\/>make\_copy());}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ temp\_frustum\_transform\ =\ data.get\_node\_path().get\_net\_transform()-\/>invert\_compose(portal\_viewer-\/>\_scene\_setup-\/>get\_cull\_center().get\_net\_transform());}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}clipping\ plane\ frustum\ transform\ "{}}\ <<\ *temp\_frustum\_transform\ <<\ endl;}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}frustum\ before\ transform\ "{}}\ <<\ *temp\_bh\ <<\ endl;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ transform\ to\ portalNode\ space}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ temp\_bh-\/>xform(temp\_frustum\_transform-\/>get\_mat());}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}frustum\ after\ transform\ "{}}\ <<\ *temp\_bh\ <<\ endl;}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \_left\_plane\_node-\/>set\_plane(-\/temp\_bh-\/>get\_plane(4));\ \textcolor{comment}{//\ left\ plane\ of\ bh}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \_right\_plane\_node-\/>set\_plane(-\/temp\_bh-\/>get\_plane(2));\textcolor{comment}{//\ right\ plane\ of\ bh}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \_top\_plane\_node-\/>set\_plane(-\/temp\_bh-\/>get\_plane(3));\ \textcolor{comment}{//\ top\ plane\ of\ bh}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \_bottom\_plane\_node-\/>set\_plane(-\/temp\_bh-\/>get\_plane(1));\textcolor{comment}{//\ bottom\ plane\ of\ bh}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}left\ plane\ "{}}\ <<\ *\_left\_plane\_node\ <<\ endl;}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}right\ plane\ "{}}\ <<\ *\_right\_plane\_node\ <<\ endl;}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}top\ plane\ "{}}\ <<\ *\_top\_plane\_node\ <<\ endl;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}bottom\ plane\ "{}}\ <<\ *\_bottom\_plane\_node\ <<\ endl;}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remember\ the\ clip\ state\ we\ just\ generated}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ portal\_viewer-\/>set\_clip\_state(\_clip\_state);}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (old\_clip\_state)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}parent\ clip\ state\ "{}}\ <<\ *old\_clip\_state\ <<\ endl;}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}parent\ clip\ state\ None"{}}\ <<\ endl;}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}own\ clip\ state\ "{}}\ <<\ *\_clip\_state\ <<\ endl;}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}next\ state\ "{}}\ <<\ *next\_state\ <<\ endl;}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ undo\ parent\ clip\ state\ and\ compose\ our\ new\ clip\ state\ ito\ the\ new}}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ state}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (old\_clip\_state\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\_state\ =\ old\_clip\_state-\/>invert\_compose(next\_state);}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}next\ state\ after\ removing\ parent\ state\ "{}}\ <<\ *next\_state\ <<\ endl;}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ next\_state\ =\ next\_state-\/>compose(\_clip\_state);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}next\ state\ after\ composition\ "{}}\ <<\ *next\_state\ <<\ endl;}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ next\_data(\_cell\_out,}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cell\_transform,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\_state,\ new\_bh,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ current\_thread);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ next\_data.\_portal\_depth\ =\ data.\_portal\_depth\ +\ 1;}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ portal\_viewer-\/>set\_reduced\_frustum(new\_bh);}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}cull\_callback:\ before\ traversing\ "{}}\ <<\ \_cell\_out.get\_name()\ <<\ endl;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ trav-\/>traverse\_below(next\_data);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ portal\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}cull\_callback:\ after\ traversing\ "{}}\ <<\ \_cell\_out.get\_name()\ <<\ endl;}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ restore\ clip\ state}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ portal\_viewer-\/>set\_clip\_state(old\_clip\_state);}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00301\ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ reset\ portal\ viewer\ frustum\ for\ the\ siblings;}}
\DoxyCodeLine{00303\ \ \ \ \ portal\_viewer-\/>set\_reduced\_frustum(old\_bh);}
\DoxyCodeLine{00304\ \ \ \ \ \textcolor{comment}{//\ reset\ portal\ viewer\ viewport\ for\ the\ siblings;}}
\DoxyCodeLine{00305\ \ \ \ \ portal\_viewer-\/>set\_reduced\_viewport(old\_reduced\_viewport\_min,\ old\_reduced\_viewport\_max);}
\DoxyCodeLine{00306\ \ \ \}}
\DoxyCodeLine{00307\ \ \ \textcolor{comment}{//\ Now\ carry\ on\ to\ render\ our\ child\ nodes.}}
\DoxyCodeLine{00308\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00309\ \}}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00316\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_accaa3a0311645d67228f21b628fcc7d1}{PortalNode::}}}
\DoxyCodeLine{00317\ \mbox{\hyperlink{classPortalNode_accaa3a0311645d67228f21b628fcc7d1}{output}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00318\ \ \ PandaNode::output(out);}
\DoxyCodeLine{00319\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00324\ \textcolor{comment}{/*}}
\DoxyCodeLine{00325\ \textcolor{comment}{void\ PortalNode::}}
\DoxyCodeLine{00326\ \textcolor{comment}{draw()\ const\ \{}}
\DoxyCodeLine{00327\ \textcolor{comment}{\ \ move\_to(get\_vertex(0));}}
\DoxyCodeLine{00328\ \textcolor{comment}{\ \ draw\_to(get\_vertex(1));}}
\DoxyCodeLine{00329\ \textcolor{comment}{\ \ draw\_to(get\_vertex(2));}}
\DoxyCodeLine{00330\ \textcolor{comment}{\ \ draw\_to(get\_vertex(3));}}
\DoxyCodeLine{00331\ \textcolor{comment}{\}}}
\DoxyCodeLine{00332\ \textcolor{comment}{*/}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00339\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_ad6bc0924a0237c2ad2181541ae6a0f45}{PortalNode::}}}
\DoxyCodeLine{00340\ \mbox{\hyperlink{classPortalNode_ad6bc0924a0237c2ad2181541ae6a0f45}{compute\_internal\_bounds}}(CPT(\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}})\ \&internal\_bounds,}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \&internal\_vertices,}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ pipeline\_stage,}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//\ First,\ get\ ourselves\ a\ fresh,\ empty\ bounding\ volume.}}
\DoxyCodeLine{00345\ \ \ PT(\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}})\ bound\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingSphere}{BoundingSphere}};}
\DoxyCodeLine{00346\ \ \ \mbox{\hyperlink{classGeometricBoundingVolume}{GeometricBoundingVolume}}\ *gbv\ =\ DCAST(\mbox{\hyperlink{classGeometricBoundingVolume}{GeometricBoundingVolume}},\ bound);}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \textcolor{comment}{//\ Now\ actually\ compute\ the\ bounding\ volume\ by\ putting\ it\ around\ all\ of\ our}}
\DoxyCodeLine{00349\ \ \ \textcolor{comment}{//\ vertices.}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \textcolor{keyword}{const}\ LPoint3\ *vertices\_begin\ =\ \&\_vertices[0];}
\DoxyCodeLine{00352\ \ \ \textcolor{keyword}{const}\ LPoint3\ *vertices\_end\ =\ vertices\_begin\ +\ \_vertices.size();}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \textcolor{comment}{//\ Now\ actually\ compute\ the\ bounding\ volume\ by\ putting\ it\ around\ all}}
\DoxyCodeLine{00355\ \ \ gbv-\/>around(vertices\_begin,\ vertices\_end);}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ internal\_bounds\ =\ bound;}
\DoxyCodeLine{00358\ \ \ internal\_vertices\ =\ 0;}
\DoxyCodeLine{00359\ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00366\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ PortalNode::}
\DoxyCodeLine{00367\ get\_last\_pos\_state()\ \{}
\DoxyCodeLine{00368\ \ \ \textcolor{comment}{//\ Once\ someone\ asks\ for\ this\ pointer,\ we\ hold\ its\ reference\ count\ and\ never}}
\DoxyCodeLine{00369\ \ \ \textcolor{comment}{//\ free\ it.}}
\DoxyCodeLine{00370\ \ \ \textcolor{keyword}{static}\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ state\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00371\ \ \ \textcolor{keywordflow}{if}\ (state\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00372\ \ \ \ \ state\ =\ RenderState::make}
\DoxyCodeLine{00373\ \ \ \ \ \ \ (ColorScaleAttrib::make(LVecBase4(1.0f,\ 1.0f,\ 1.0f,\ 0.5f)),}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ TransparencyAttrib::make(TransparencyAttrib::M\_alpha));}
\DoxyCodeLine{00375\ \ \ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{return}\ state;}
\DoxyCodeLine{00378\ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00384\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_a2810f0882ab6b37ef38206c82b2199ab}{PortalNode::}}}
\DoxyCodeLine{00385\ \mbox{\hyperlink{classPortalNode_a2810f0882ab6b37ef38206c82b2199ab}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00386\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classPortalNode_a1e743c7796ee590b4af91931a02524d3}{make\_from\_bam}});}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00393\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_aa1d34d927ae08b3dbb2e56cb152f8b44}{PortalNode::}}}
\DoxyCodeLine{00394\ \mbox{\hyperlink{classPortalNode_aa1d34d927ae08b3dbb2e56cb152f8b44}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00395\ \ \ \mbox{\hyperlink{classPandaNode_ae9b3055297ade9bbf4a3b4dfc77e4506}{PandaNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ dg.add\_uint16(\_vertices.size());}
\DoxyCodeLine{00398\ \ \ \textcolor{keywordflow}{for}\ (Vertices::const\_iterator\ vi\ =\ \_vertices.begin();}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ vi\ !=\ \_vertices.end();}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ ++vi)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ (*vi).write\_datagram(dg);}
\DoxyCodeLine{00402\ \ \ \}}
\DoxyCodeLine{00403\ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00409\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPortalNode_a013194d88eee0062edb9736644d552d7}{PortalNode::}}}
\DoxyCodeLine{00410\ \mbox{\hyperlink{classPortalNode_a013194d88eee0062edb9736644d552d7}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordtype}{int}\ pi\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{PandaNode::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{return}\ pi;}
\DoxyCodeLine{00414\ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00421\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classPortalNode_a1e743c7796ee590b4af91931a02524d3}{PortalNode::}}}
\DoxyCodeLine{00422\ \mbox{\hyperlink{classPortalNode_a1e743c7796ee590b4af91931a02524d3}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{classPortalNode}{PortalNode}}\ *node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPortalNode}{PortalNode}}(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00424\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00425\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00428\ \ \ node-\/>\mbox{\hyperlink{classPortalNode_ab940b743b3871c2a1a26bd8671d3864a}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{keywordflow}{return}\ node;}
\DoxyCodeLine{00431\ \}}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00437\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPortalNode_ab940b743b3871c2a1a26bd8671d3864a}{PortalNode::}}}
\DoxyCodeLine{00438\ \mbox{\hyperlink{classPortalNode_ab940b743b3871c2a1a26bd8671d3864a}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00439\ \ \ \mbox{\hyperlink{classPandaNode_a924d7f721627231f4504db71809ad2c2}{PandaNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{keywordtype}{int}\ num\_vertices\ =\ scan.get\_uint16();}
\DoxyCodeLine{00442\ \ \ \_vertices.reserve(num\_vertices);}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_vertices;\ i++)\ \{}
\DoxyCodeLine{00444\ \ \ \ \ LPoint3\ vertex;}
\DoxyCodeLine{00445\ \ \ \ \ vertex.read\_datagram(scan);}
\DoxyCodeLine{00446\ \ \ \ \ \_vertices.push\_back(vertex);}
\DoxyCodeLine{00447\ \ \ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00450\ \textcolor{comment}{\ \ \_from\_portal\_mask.set\_word(scan.get\_uint32());}}
\DoxyCodeLine{00451\ \textcolor{comment}{\ \ \_into\_portal\_mask.set\_word(scan.get\_uint32());}}
\DoxyCodeLine{00452\ \textcolor{comment}{\ \ \_flags\ =\ scan.get\_uint8();}}
\DoxyCodeLine{00453\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00454\ \}}

\end{DoxyCode}
