\doxysection{frame\+Buffer\+Properties\+\_\+ext.\+cxx}
\hypertarget{frameBufferProperties__ext_8cxx_source}{}\label{frameBufferProperties__ext_8cxx_source}\index{panda/src/display/frameBufferProperties\_ext.cxx@{panda/src/display/frameBufferProperties\_ext.cxx}}
\mbox{\hyperlink{frameBufferProperties__ext_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{frameBufferProperties__ext_8h}{frameBufferProperties\_ext.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifdef\ HAVE\_PYTHON}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00021\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<FrameBufferProperties>::}}}
\DoxyCodeLine{00022\ \mbox{\hyperlink{classExtension}{\_\_getstate\_\_}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00023\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *props[FrameBufferProperties::FBP\_COUNT]\ =\ \{\textcolor{stringliteral}{"{}depth\_bits"{}},\ \textcolor{stringliteral}{"{}color\_bits"{}},\ \textcolor{stringliteral}{"{}red\_bits"{}},\ \textcolor{stringliteral}{"{}green\_bits"{}},\ \textcolor{stringliteral}{"{}blue\_bits"{}},\ \textcolor{stringliteral}{"{}alpha\_bits"{}},\ \textcolor{stringliteral}{"{}stencil\_bits"{}},\ \textcolor{stringliteral}{"{}accum\_bits"{}},\ \textcolor{stringliteral}{"{}aux\_rgba"{}},\ \textcolor{stringliteral}{"{}aux\_hrgba"{}},\ \textcolor{stringliteral}{"{}aux\_float"{}},\ \textcolor{stringliteral}{"{}multisamples"{}},\ \textcolor{stringliteral}{"{}coverage\_samples"{}},\ \textcolor{stringliteral}{"{}back\_buffers"{}}\};}
\DoxyCodeLine{00024\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *flags[]\ =\ \{\textcolor{stringliteral}{"{}indexed\_color"{}},\ \textcolor{stringliteral}{"{}rgb\_color"{}},\ \textcolor{stringliteral}{"{}stereo"{}},\ \textcolor{stringliteral}{"{}force\_hardware"{}},\ \textcolor{stringliteral}{"{}force\_software"{}},\ \textcolor{stringliteral}{"{}srgb\_color"{}},\ \textcolor{stringliteral}{"{}float\_color"{}},\ \textcolor{stringliteral}{"{}float\_depth"{}},\ \textcolor{keyword}{nullptr}\};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ PyObject\ *state\ =\ PyDict\_New();}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ FrameBufferProperties::FBP\_COUNT;\ ++i)\ \{}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>\_specified\ \&\ (1\ <<\ i))\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \ \ PyObject\ *value\ =\ PyLong\_FromLong(\_this-\/>\_property[i]);}
\DoxyCodeLine{00031\ \ \ \ \ \ \ PyDict\_SetItemString(state,\ props[i],\ value);}
\DoxyCodeLine{00032\ \ \ \ \ \ \ Py\_DECREF(value);}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ flags[i]\ !=\ \textcolor{keyword}{nullptr};\ ++i)\ \{}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>\_flags\_specified\ \&\ (1\ <<\ i))\ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ PyObject\ *value\ =\ (\_this-\/>\_flags\ \&\ (1\ <<\ i))\ ?\ Py\_True\ :\ Py\_False;}
\DoxyCodeLine{00039\ \ \ \ \ \ \ PyDict\_SetItemString(state,\ flags[i],\ value);}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ \ \ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{return}\ state;}
\DoxyCodeLine{00044\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00049\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<FrameBufferProperties>::}}}
\DoxyCodeLine{00050\ \mbox{\hyperlink{classExtension}{\_\_setstate\_\_}}(PyObject\ *self,\ PyObject\ *props)\ \{}
\DoxyCodeLine{00051\ \ \ PyTypeObject\ *type\ =\ Py\_TYPE(self);}
\DoxyCodeLine{00052\ \ \ PyObject\ *key,\ *value;}
\DoxyCodeLine{00053\ \ \ Py\_ssize\_t\ pos\ =\ 0;}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ Py\_BEGIN\_CRITICAL\_SECTION(props);}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordflow}{while}\ (PyDict\_Next(props,\ \&pos,\ \&key,\ \&value))\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ Look\ for\ a\ writable\ property\ on\ the\ type\ by\ this\ name.}}
\DoxyCodeLine{00058\ \ \ \ \ PyObject\ *descr\ =\ \_PyType\_Lookup(type,\ key);}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordflow}{if}\ (descr\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ Py\_TYPE(descr)-\/>tp\_descr\_set\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Py\_TYPE(descr)-\/>tp\_descr\_set(descr,\ self,\ value)\ <\ 0)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ PyObject\ *key\_repr\ =\ PyObject\_Repr(key);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ PyErr\_Format(PyExc\_TypeError,}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\%.100s\ is\ an\ invalid\ framebuffer\ property"{}},}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PyUnicode\_AsUTF8(key\_repr)}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00070\ \ \ \ \ \ \ Py\_DECREF(key\_repr);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ \ \ Py\_END\_CRITICAL\_SECTION();}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_PYTHON}}

\end{DoxyCode}
