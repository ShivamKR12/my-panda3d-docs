\doxysection{egg\+Vertex\+Pool.\+cxx}
\hypertarget{eggVertexPool_8cxx_source}{}\label{eggVertexPool_8cxx_source}\index{panda/src/egg/eggVertexPool.cxx@{panda/src/egg/eggVertexPool.cxx}}
\mbox{\hyperlink{eggVertexPool_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggVertexPool_8h}{eggVertexPool.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggPrimitive_8h}{eggPrimitive.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggUtilities_8h}{eggUtilities.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <iterator>}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <iterator>}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ EggVertexPool::\_type\_handle;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ \mbox{\hyperlink{classEggVertexPool_a378f7a52bc25335017f0667c54a6b01d}{EggVertexPool::}}}
\DoxyCodeLine{00031\ \mbox{\hyperlink{classEggVertexPool_a378f7a52bc25335017f0667c54a6b01d}{EggVertexPool}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ :\ \mbox{\hyperlink{classEggNode}{EggNode}}(name)\ \{}
\DoxyCodeLine{00032\ \ \ \_highest\_index\ =\ -\/1;}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00040\ \mbox{\hyperlink{classEggVertexPool_a378f7a52bc25335017f0667c54a6b01d}{EggVertexPool::}}}
\DoxyCodeLine{00041\ \mbox{\hyperlink{classEggVertexPool_a378f7a52bc25335017f0667c54a6b01d}{EggVertexPool}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ \&copy)\ :\ \mbox{\hyperlink{classEggNode}{EggNode}}(copy)\ \{}
\DoxyCodeLine{00042\ \ \ iterator\ i;}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ copy.\mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ i\ !=\ copy.\mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++i)\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \mbox{\hyperlink{classEggVertexPool_ace396bc3d8610f4ae7bc8cc70d2da1ef}{add\_vertex}}(\textcolor{keyword}{new}\ \mbox{\hyperlink{classEggVertex}{EggVertex}}(*(*i)),\ (*i)-\/>get\_index());}
\DoxyCodeLine{00045\ \ \ \}}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00052\ EggVertexPool::}
\DoxyCodeLine{00053\ \string~EggVertexPool()\ \{}
\DoxyCodeLine{00054\ \ \ \textcolor{comment}{//\ Remove\ all\ vertices\ from\ the\ pool\ when\ it\ destructs.}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ Sanity\ check.}}
\DoxyCodeLine{00057\ \ \ nassertv(\_index\_vertices.size()\ ==\ \_unique\_vertices.size());}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ IndexVertices::iterator\ ivi;}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ (*ivi).first;}
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{//\ Sanity\ checks\ on\ our\ internal\ data\ structures.}}
\DoxyCodeLine{00065\ \ \ \ \ nassertv(vertex-\/>\_pool\ ==\ \textcolor{keyword}{this});}
\DoxyCodeLine{00066\ \ \ \ \ nassertv(vertex-\/>get\_index()\ ==\ index);}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ vertex-\/>\_pool\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00069\ \ \ \ \ vertex-\/>\_index\ =\ -\/1;}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \_index\_vertices.clear();}
\DoxyCodeLine{00073\ \ \ \_unique\_vertices.clear();}
\DoxyCodeLine{00074\ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00080\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_ade1f8ddc5a9b973bd1d9e772d42a1ea8}{EggVertexPool::}}}
\DoxyCodeLine{00081\ \mbox{\hyperlink{classEggVertexPool_ade1f8ddc5a9b973bd1d9e772d42a1ea8}{has\_forward\_vertices}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00082\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00087\ \ \ \ \ \}}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00097\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a28f4afdf1150d68865e47beae4624e41}{EggVertexPool::}}}
\DoxyCodeLine{00098\ \mbox{\hyperlink{classEggVertexPool_a28f4afdf1150d68865e47beae4624e41}{has\_defined\_vertices}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00099\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{if}\ (!vertex-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00114\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{EggVertexPool::}}}
\DoxyCodeLine{00115\ \mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(\textcolor{keywordtype}{int}\ index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00116\ \ \ IndexVertices::const\_iterator\ ivi\ =\ \_index\_vertices.find(index);}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{if}\ (ivi\ ==\ \_index\_vertices.end())\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00120\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordflow}{return}\ vertex;}
\DoxyCodeLine{00126\ \ \ \}}
\DoxyCodeLine{00127\ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00136\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *\mbox{\hyperlink{classEggVertexPool_af67da331e8362af8689dde2a19507832}{EggVertexPool::}}}
\DoxyCodeLine{00137\ \mbox{\hyperlink{classEggVertexPool_af67da331e8362af8689dde2a19507832}{get\_forward\_vertex}}(\textcolor{keywordtype}{int}\ index)\ \{}
\DoxyCodeLine{00138\ \ \ nassertr(index\ >=\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ IndexVertices::const\_iterator\ ivi\ =\ \_index\_vertices.find(index);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{if}\ (ivi\ ==\ \_index\_vertices.end())\ \{}
\DoxyCodeLine{00143\ \ \ \ \ PT(\mbox{\hyperlink{classEggVertex}{EggVertex}})\ forward\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggVertex}{EggVertex}};}
\DoxyCodeLine{00144\ \ \ \ \ forward-\/>\_forward\_reference\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEggVertexPool_ace396bc3d8610f4ae7bc8cc70d2da1ef}{add\_vertex}}(forward,\ index);}
\DoxyCodeLine{00146\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{return}\ (*ivi).second;}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00155\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classEggVertexPool_a1b77cf60a2d686fe93cc4e8a65846bc2}{EggVertexPool::}}}
\DoxyCodeLine{00156\ \mbox{\hyperlink{classEggVertexPool_a1b77cf60a2d686fe93cc4e8a65846bc2}{get\_highest\_index}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00157\ \ \ \textcolor{keywordflow}{return}\ \_highest\_index;}
\DoxyCodeLine{00158\ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00166\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_aca40e0be580ba4d781a8dcfd46495371}{EggVertexPool::}}}
\DoxyCodeLine{00167\ \mbox{\hyperlink{classEggVertexPool_aca40e0be580ba4d781a8dcfd46495371}{set\_highest\_index}}(\textcolor{keywordtype}{int}\ highest\_index)\ \{}
\DoxyCodeLine{00168\ \ \ \_highest\_index\ =\ highest\_index;}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00174\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classEggVertexPool_aa9d5247166abf652099ef7e5aa777c92}{EggVertexPool::}}}
\DoxyCodeLine{00175\ \mbox{\hyperlink{classEggVertexPool_aa9d5247166abf652099ef7e5aa777c92}{get\_num\_dimensions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordtype}{int}\ num\_dimensions\ =\ 0;}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00181\ \ \ \ \ num\_dimensions\ =\ std::max(num\_dimensions,\ vertex-\/>get\_num\_dimensions());}
\DoxyCodeLine{00182\ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{return}\ num\_dimensions;}
\DoxyCodeLine{00185\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00191\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a16e83d8b9807ccfffb0b5b15cd37dbfe}{EggVertexPool::}}}
\DoxyCodeLine{00192\ \mbox{\hyperlink{classEggVertexPool_a16e83d8b9807ccfffb0b5b15cd37dbfe}{has\_normals}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00193\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>has\_normal())\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00202\ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00208\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a073a67c56b282024ab3b65b42ec936d4}{EggVertexPool::}}}
\DoxyCodeLine{00209\ \mbox{\hyperlink{classEggVertexPool_a073a67c56b282024ab3b65b42ec936d4}{has\_colors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00210\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00212\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>has\_color())\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00215\ \ \ \ \ \}}
\DoxyCodeLine{00216\ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00225\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a6ed5aae806a5c01ede6017ccc96dca28}{EggVertexPool::}}}
\DoxyCodeLine{00226\ \mbox{\hyperlink{classEggVertexPool_a6ed5aae806a5c01ede6017ccc96dca28}{has\_nonwhite\_colors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00227\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>has\_color()\ \&\&}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ (vertex-\/>get\_color()\ !=\ LColor(1.0,\ 1.0,\ 1.0,\ 1.0)\ ||}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ !vertex-\/>\_drgbas.empty()))\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ \ \ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00238\ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00247\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a85e9950531ecacb567362807744f2f23}{EggVertexPool::}}}
\DoxyCodeLine{00248\ \mbox{\hyperlink{classEggVertexPool_a85e9950531ecacb567362807744f2f23}{check\_overall\_color}}(\textcolor{keywordtype}{bool}\ \&has\_overall\_color,\ LColor\ \&overall\_color)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggVertexPool_ae6356b7624f32d07c3ea163f08ad4953}{empty}}())\ \{}
\DoxyCodeLine{00250\ \ \ \ \ has\_overall\_color\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00251\ \ \ \ \ overall\_color.set(1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00253\ \ \ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00256\ \ \ ivi\ =\ \_index\_vertices.begin();}
\DoxyCodeLine{00257\ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00258\ \ \ overall\_color\ =\ vertex-\/>get\_color();}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ ++ivi;}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordflow}{while}\ (ivi\ !=\ \_index\_vertices.end())\ \{}
\DoxyCodeLine{00262\ \ \ \ \ vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{if}\ (!vertex-\/>get\_color().almost\_equal(overall\_color))\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ has\_overall\_color\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ \ \ \ \ ++ivi;}
\DoxyCodeLine{00268\ \ \ \}}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ has\_overall\_color\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00271\ \}}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00277\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a75df6c88559b37b023b280a6c50e65a3}{EggVertexPool::}}}
\DoxyCodeLine{00278\ \mbox{\hyperlink{classEggVertexPool_a75df6c88559b37b023b280a6c50e65a3}{has\_uvs}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00279\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00281\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>has\_uv())\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00284\ \ \ \ \ \}}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00288\ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00294\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_a3ed22cb987d06a0142fdabd397a13b3b}{EggVertexPool::}}}
\DoxyCodeLine{00295\ \mbox{\hyperlink{classEggVertexPool_a3ed22cb987d06a0142fdabd397a13b3b}{has\_aux}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00296\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>has\_aux())\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00301\ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00314\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a940826a9a79701be236f018ba05208bd}{EggVertexPool::}}}
\DoxyCodeLine{00315\ \mbox{\hyperlink{classEggVertexPool_a940826a9a79701be236f018ba05208bd}{get\_uv\_names}}(vector\_string\ \&uv\_names,\ vector\_string\ \&uvw\_names,}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ vector\_string\ \&tbn\_names)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00317\ \ \ \mbox{\hyperlink{classpset}{pset<string>}}\ uv\_names\_set,\ uvw\_names\_set,\ tbn\_names\_set;}
\DoxyCodeLine{00318\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00320\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00321\ \ \ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{EggVertex::const\_uv\_iterator}}\ uvi;}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordflow}{for}\ (uvi\ =\ vertex-\/>uv\_begin();\ uvi\ !=\ vertex-\/>uv\_end();\ ++uvi)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertexUV}{EggVertexUV}}\ *uv\_obj\ =\ (*uvi);}
\DoxyCodeLine{00324\ \ \ \ \ \ \ uv\_names\_set.insert(uv\_obj-\/>get\_name());}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uv\_obj-\/>has\_w())\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ uvw\_names\_set.insert(uv\_obj-\/>get\_name());}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uv\_obj-\/>has\_tangent()\ \&\&\ uv\_obj-\/>has\_binormal())\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ tbn\_names\_set.insert(uv\_obj-\/>get\_name());}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \mbox{\hyperlink{classpset}{pset<string>::const\_iterator}}\ si;}
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ uv\_names\_set.begin();\ si\ !=\ uv\_names\_set.end();\ ++si)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ uv\_names.push\_back(*si);}
\DoxyCodeLine{00337\ \ \ \}}
\DoxyCodeLine{00338\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ uvw\_names\_set.begin();\ si\ !=\ uvw\_names\_set.end();\ ++si)\ \{}
\DoxyCodeLine{00339\ \ \ \ \ uvw\_names.push\_back(*si);}
\DoxyCodeLine{00340\ \ \ \}}
\DoxyCodeLine{00341\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ tbn\_names\_set.begin();\ si\ !=\ tbn\_names\_set.end();\ ++si)\ \{}
\DoxyCodeLine{00342\ \ \ \ \ tbn\_names.push\_back(*si);}
\DoxyCodeLine{00343\ \ \ \}}
\DoxyCodeLine{00344\ \}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00350\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a8aab7a3e136e0a42d24871abc0d6e328}{EggVertexPool::}}}
\DoxyCodeLine{00351\ \mbox{\hyperlink{classEggVertexPool_a8aab7a3e136e0a42d24871abc0d6e328}{get\_aux\_names}}(vector\_string\ \&aux\_names)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00352\ \ \ \mbox{\hyperlink{classpset}{pset<string>}}\ aux\_names\_set;}
\DoxyCodeLine{00353\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00356\ \ \ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{EggVertex::const\_aux\_iterator}}\ uvi;}
\DoxyCodeLine{00357\ \ \ \ \ \textcolor{keywordflow}{for}\ (uvi\ =\ vertex-\/>aux\_begin();\ uvi\ !=\ vertex-\/>aux\_end();\ ++uvi)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertexAux}{EggVertexAux}}\ *aux\_obj\ =\ (*uvi);}
\DoxyCodeLine{00359\ \ \ \ \ \ \ aux\_names\_set.insert(aux\_obj-\/>get\_name());}
\DoxyCodeLine{00360\ \ \ \ \ \}}
\DoxyCodeLine{00361\ \ \ \}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \mbox{\hyperlink{classpset}{pset<string>::const\_iterator}}\ si;}
\DoxyCodeLine{00364\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ aux\_names\_set.begin();\ si\ !=\ aux\_names\_set.end();\ ++si)\ \{}
\DoxyCodeLine{00365\ \ \ \ \ aux\_names.push\_back(*si);}
\DoxyCodeLine{00366\ \ \ \}}
\DoxyCodeLine{00367\ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00373\ \mbox{\hyperlink{classsecond__of__pair__iterator}{EggVertexPool::iterator}}\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{EggVertexPool::}}}
\DoxyCodeLine{00374\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00375\ \ \ nassertr(\_index\_vertices.size()\ ==\ \_unique\_vertices.size(),}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}(\_index\_vertices.begin()));}
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}(\_index\_vertices.begin());}
\DoxyCodeLine{00378\ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00384\ \mbox{\hyperlink{classsecond__of__pair__iterator}{EggVertexPool::iterator}}\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{EggVertexPool::}}}
\DoxyCodeLine{00385\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}(\_index\_vertices.end());}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00392\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggVertexPool_ae6356b7624f32d07c3ea163f08ad4953}{EggVertexPool::}}}
\DoxyCodeLine{00393\ \mbox{\hyperlink{classEggVertexPool_ae6356b7624f32d07c3ea163f08ad4953}{empty}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00394\ \ \ \textcolor{keywordflow}{return}\ \_index\_vertices.empty();}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00400\ EggVertexPool::size\_type\ EggVertexPool::}
\DoxyCodeLine{00401\ size()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00402\ \ \ nassertr(\_index\_vertices.size()\ ==\ \_unique\_vertices.size(),\ 0);}
\DoxyCodeLine{00403\ \ \ \textcolor{keywordflow}{return}\ \_index\_vertices.size();}
\DoxyCodeLine{00404\ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00420\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *\mbox{\hyperlink{classEggVertexPool_ace396bc3d8610f4ae7bc8cc70d2da1ef}{EggVertexPool::}}}
\DoxyCodeLine{00421\ \mbox{\hyperlink{classEggVertexPool_ace396bc3d8610f4ae7bc8cc70d2da1ef}{add\_vertex}}(\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex,\ \textcolor{keywordtype}{int}\ index)\ \{}
\DoxyCodeLine{00422\ \ \ \textcolor{comment}{//\ Save\ a\ pointer\ to\ the\ vertex.}}
\DoxyCodeLine{00423\ \ \ PT(\mbox{\hyperlink{classEggVertex}{EggVertex}})\ vertex\_keep\ =\ vertex;}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//\ Don't\ try\ to\ add\ a\ vertex\ while\ it\ still\ belongs\ to\ another\ pool.}}
\DoxyCodeLine{00426\ \ \ nassertr(vertex-\/>\_pool\ ==\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{if}\ (index\ ==\ -\/1)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ index\ =\ \mbox{\hyperlink{classEggVertexPool_a1b77cf60a2d686fe93cc4e8a65846bc2}{get\_highest\_index}}()\ +\ 1;}
\DoxyCodeLine{00430\ \ \ \}}
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ Always\ supply\ an\ index\ number\ >=\ 0.}}
\DoxyCodeLine{00432\ \ \ nassertr(index\ >=\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \textcolor{comment}{//\ Check\ for\ a\ forward\ reference.}}
\DoxyCodeLine{00435\ \ \ IndexVertices::const\_iterator\ ivi\ =\ \_index\_vertices.find(index);}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{if}\ (ivi\ !=\ \_index\_vertices.end())\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *orig\_vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{if}\ (orig\_vertex-\/>is\_forward\_reference()\ \&\&}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ !vertex-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ (*orig\_vertex)\ =\ (*vertex);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ orig\_vertex-\/>\_forward\_reference\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \_highest\_index\ =\ std::max(\_highest\_index,\ index);}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ orig\_vertex;}
\DoxyCodeLine{00445\ \ \ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{comment}{//\ Oops,\ you\ duplicated\ a\ vertex\ index.}}
\DoxyCodeLine{00448\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}duplicate\ vertex\ index"{}});}
\DoxyCodeLine{00449\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00450\ \ \ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ \ \ \_unique\_vertices.insert(vertex);}
\DoxyCodeLine{00453\ \ \ \_index\_vertices[index]\ =\ vertex;}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ \textcolor{keywordflow}{if}\ (!vertex-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00456\ \ \ \ \ \_highest\_index\ =\ std::max(\_highest\_index,\ index);}
\DoxyCodeLine{00457\ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ vertex-\/>\_pool\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{00460\ \ \ vertex-\/>\_index\ =\ index;}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \textcolor{keywordflow}{return}\ vertex;}
\DoxyCodeLine{00463\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00471\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *\mbox{\hyperlink{classEggVertexPool_ad97205a36cd20f80a025f18ee956a0cc}{EggVertexPool::}}}
\DoxyCodeLine{00472\ \mbox{\hyperlink{classEggVertexPool_ad97205a36cd20f80a025f18ee956a0cc}{create\_unique\_vertex}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ \&copy)\ \{}
\DoxyCodeLine{00473\ \ \ UniqueVertices::iterator\ uvi;}
\DoxyCodeLine{00474\ \ \ uvi\ =\ \_unique\_vertices.find((\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *)\&copy);}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{if}\ (uvi\ !=\ \_unique\_vertices.end())\ \{}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{comment}{//\ There\ was\ already\ such\ a\ vertex.\ \ Return\ it.}}
\DoxyCodeLine{00478\ \ \ \ \ \textcolor{keywordflow}{return}\ (*uvi);}
\DoxyCodeLine{00479\ \ \ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \textcolor{comment}{//\ Create\ a\ new\ vertex.}}
\DoxyCodeLine{00482\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEggVertexPool_ace396bc3d8610f4ae7bc8cc70d2da1ef}{add\_vertex}}(\textcolor{keyword}{new}\ \mbox{\hyperlink{classEggVertex}{EggVertex}}(copy));}
\DoxyCodeLine{00483\ \}}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00490\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *\mbox{\hyperlink{classEggVertexPool_a28f1d8f792416af604d29aa394189422}{EggVertexPool::}}}
\DoxyCodeLine{00491\ \mbox{\hyperlink{classEggVertexPool_a28f1d8f792416af604d29aa394189422}{find\_matching\_vertex}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ \&copy)\ \{}
\DoxyCodeLine{00492\ \ \ UniqueVertices::iterator\ uvi;}
\DoxyCodeLine{00493\ \ \ uvi\ =\ \_unique\_vertices.find((\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *)\&copy);}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keywordflow}{if}\ (uvi\ !=\ \_unique\_vertices.end())\ \{}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{comment}{//\ There\ was\ already\ such\ a\ vertex.\ \ Return\ it.}}
\DoxyCodeLine{00497\ \ \ \ \ \textcolor{keywordflow}{return}\ (*uvi);}
\DoxyCodeLine{00498\ \ \ \}}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00500\ \ \ \textcolor{comment}{//\ No\ matching\ vertex.}}
\DoxyCodeLine{00501\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00502\ \}}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00509\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a0d5176a3c1425ba5af9646c0116ade34}{EggVertexPool::}}}
\DoxyCodeLine{00510\ \mbox{\hyperlink{classEggVertexPool_a0d5176a3c1425ba5af9646c0116ade34}{remove\_vertex}}(\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex)\ \{}
\DoxyCodeLine{00511\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ vertex\ is\ already\ a\ member\ of\ this\ pool.}}
\DoxyCodeLine{00512\ \ \ nassertv(vertex-\/>\_pool\ ==\ \textcolor{keyword}{this});}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \textcolor{comment}{//\ Sanity\ check.\ \ Is\ the\ vertex\ actually\ in\ the\ pool?}}
\DoxyCodeLine{00515\ \ \ nassertv(\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(vertex-\/>\_index)\ ==\ vertex);}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \textcolor{comment}{//\ Removing\ the\ vertex\ from\ the\ indexed\ list\ is\ simple.}}
\DoxyCodeLine{00518\ \ \ \_index\_vertices.erase(vertex-\/>\_index);}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_index\ ==\ vertex-\/>\_index)\ \{}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{comment}{//\ Find\ the\ new\ highest\ vertex\ index.}}
\DoxyCodeLine{00522\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_index\_vertices.empty())\ \{}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \_highest\_index\ =\ -\/1;}
\DoxyCodeLine{00524\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00525\ \ \ \ \ \ \ IndexVertices::reverse\_iterator\ ivi\ =\ \_index\_vertices.rbegin();}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (ivi\ !=\ \_index\_vertices.rend()\ \&\&}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ \ (*ivi).second-\/>is\_forward\_reference())\ \{}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ ++ivi;}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ivi\ !=\ \_index\_vertices.rend())\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \_highest\_index\ =\ (*ivi).first;}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \_highest\_index\ =\ -\/1;}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00535\ \ \ \ \ \}}
\DoxyCodeLine{00536\ \ \ \}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \textcolor{comment}{//\ Removing\ the\ vertex\ from\ the\ unique\ list\ is\ a\ bit\ trickier-\/-\/there\ might}}
\DoxyCodeLine{00539\ \ \ \textcolor{comment}{//\ be\ several\ other\ vertices\ that\ are\ considered\ identical\ to\ this\ one,\ and}}
\DoxyCodeLine{00540\ \ \ \textcolor{comment}{//\ so\ we\ have\ to\ walk\ through\ all\ the\ identical\ vertices\ until\ we\ find\ the}}
\DoxyCodeLine{00541\ \ \ \textcolor{comment}{//\ right\ one.}}
\DoxyCodeLine{00542\ \ \ UniqueVertices::iterator\ uvi;}
\DoxyCodeLine{00543\ \ \ uvi\ =\ \_unique\_vertices.find(vertex);}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00545\ \ \ \textcolor{comment}{//\ Sanity\ check.\ \ Is\ the\ vertex\ actually\ in\ the\ pool?}}
\DoxyCodeLine{00546\ \ \ nassertv(uvi\ !=\ \_unique\_vertices.end());}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \textcolor{keywordflow}{while}\ ((*uvi)\ !=\ vertex)\ \{}
\DoxyCodeLine{00549\ \ \ \ \ ++uvi;}
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{comment}{//\ Sanity\ check.\ \ Is\ the\ vertex\ actually\ in\ the\ pool?}}
\DoxyCodeLine{00551\ \ \ \ \ nassertv(uvi\ !=\ \_unique\_vertices.end());}
\DoxyCodeLine{00552\ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \_unique\_vertices.erase(uvi);}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ vertex-\/>\_pool\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00557\ \}}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00565\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classEggVertexPool_a19fd9bc618ffaac2e41fc23ce73b6be1}{EggVertexPool::}}}
\DoxyCodeLine{00566\ \mbox{\hyperlink{classEggVertexPool_a19fd9bc618ffaac2e41fc23ce73b6be1}{remove\_unused\_vertices}}()\ \{}
\DoxyCodeLine{00567\ \ \ \textcolor{keywordtype}{int}\ num\_removed\ =\ 0;}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \mbox{\hyperlink{classpmultiset}{UniqueVertices}}\ new\_unique\_vertices;}
\DoxyCodeLine{00570\ \ \ \mbox{\hyperlink{classpmap}{IndexVertices}}\ new\_index\_vertices;}
\DoxyCodeLine{00571\ }
\DoxyCodeLine{00572\ \ \ IndexVertices::const\_iterator\ ivi;}
\DoxyCodeLine{00573\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00574\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\mbox{\hyperlink{classEggVertex_ac8b028e7415a83d3d82987f65a27a21b}{pref\_size}}()\ ==\ 0)\ \{}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ vertex\ is\ not\ used.\ \ Don't\ add\ it\ to\ the\ new\ lists.}}
\DoxyCodeLine{00577\ \ \ \ \ \ \ vertex-\/>\mbox{\hyperlink{classEggVertex_a3080b9a649778ada0fbb9487663215e5}{clear\_grefs}}();}
\DoxyCodeLine{00578\ \ \ \ \ \ \ vertex-\/>\_pool\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00579\ \ \ \ \ \ \ num\_removed++;}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ vertex\ *is*\ used\ somewhere.\ \ Is\ it\ identical\ to\ an\ existing}}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \textcolor{comment}{//\ vertex?}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ UniqueVertices::iterator\ uvi;}
\DoxyCodeLine{00585\ \ \ \ \ \ \ uvi\ =\ new\_unique\_vertices.find(vertex);}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uvi\ !=\ new\_unique\_vertices.end())\ \{}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yes,\ there's\ already\ another\ vertex\ just\ like\ this\ one.\ \ Redirect}}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ the\ primitives\ currently\ referencing\ this\ vertex\ to\ reference}}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ other\ one\ instead.}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *orig\_vertex\ =\ (*uvi);}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpmultiset}{EggVertex::PrimitiveRef}}\ pref\ =\ vertex-\/>\_pref;}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ EggVertex::PrimitiveRef::iterator\ pi;}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (pi\ =\ pref.begin();\ pi\ !=\ pref.end();\ ++pi)\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *prim\ =\ (*pi);}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ EggPrimitive::iterator\ pvi\ =\ prim-\/>\mbox{\hyperlink{classEggPrimitive_acac1cb2e8abefe9f41b0226ad87d4c49}{find}}(vertex);}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ nassertr(pvi\ !=\ prim-\/>end(),\ 0);}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ prim-\/>replace(pvi,\ orig\_vertex);}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ vertex-\/>test\_pref\_integrity();}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ orig\_vertex-\/>test\_pref\_integrity();}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ nassertr(vertex-\/>\mbox{\hyperlink{classEggVertex_ac8b028e7415a83d3d82987f65a27a21b}{pref\_size}}()\ ==\ 0,\ 0);}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ vertex-\/>\mbox{\hyperlink{classEggVertex_a3080b9a649778ada0fbb9487663215e5}{clear\_grefs}}();}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ vertex-\/>\_pool\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ num\_removed++;}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ a\ unique\ vertex.\ \ Renumber\ it\ and\ add\ it\ to\ the\ new\ lists.}}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ vertex-\/>\_index\ =\ new\_index\_vertices.size();}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ new\_index\_vertices.insert(IndexVertices::value\_type(vertex-\/>\_index,\ vertex));}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ new\_unique\_vertices.insert(vertex);}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00613\ \ \ \ \ \}}
\DoxyCodeLine{00614\ \ \ \}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \textcolor{comment}{//\ All\ done.\ \ Lose\ the\ old\ lists.}}
\DoxyCodeLine{00617\ \ \ \_unique\_vertices.swap(new\_unique\_vertices);}
\DoxyCodeLine{00618\ \ \ \_index\_vertices.swap(new\_index\_vertices);}
\DoxyCodeLine{00619\ \ \ \_highest\_index\ =\ (int)\_index\_vertices.size()\ -\/\ 1;}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ nassertr(\_index\_vertices.size()\ ==\ \_unique\_vertices.size(),\ num\_removed);}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00623\ \ \ \textcolor{keywordflow}{return}\ num\_removed;}
\DoxyCodeLine{00624\ \}}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00630\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a4d67a3bf1b9b3111402c67b14f15bc2a}{EggVertexPool::}}}
\DoxyCodeLine{00631\ \mbox{\hyperlink{classEggVertexPool_a4d67a3bf1b9b3111402c67b14f15bc2a}{add\_unused\_vertices\_to\_prim}}(\mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *prim)\ \{}
\DoxyCodeLine{00632\ \ \ IndexVertices::iterator\ ivi;}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordflow}{for}\ (ivi\ =\ \_index\_vertices.begin();\ ivi\ !=\ \_index\_vertices.end();\ ++ivi)\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ (*ivi).second;}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{keywordflow}{if}\ (vertex-\/>\mbox{\hyperlink{classEggVertex_ac8b028e7415a83d3d82987f65a27a21b}{pref\_size}}()\ ==\ 0)\ \{}
\DoxyCodeLine{00636\ \ \ \ \ \ \ prim-\/>\mbox{\hyperlink{classEggPrimitive_a77bb4e987b18a54bbabfc068a325506a}{add\_vertex}}(vertex);}
\DoxyCodeLine{00637\ \ \ \ \ \}}
\DoxyCodeLine{00638\ \ \ \}}
\DoxyCodeLine{00639\ \}}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \textcolor{comment}{//\ A\ function\ object\ for\ split\_vertex(),\ used\ in\ transform(),\ below.}}
\DoxyCodeLine{00642\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classIsLocalVertexSplitter}{IsLocalVertexSplitter}}\ \{}
\DoxyCodeLine{00643\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00644\ \ \ \textcolor{keywordtype}{int}\ operator\ ()\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *prim)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00645\ \ \ \ \ \textcolor{keywordflow}{return}\ (prim-\/>is\_local\_coord()\ ?\ 1\ :\ 0);}
\DoxyCodeLine{00646\ \ \ \}}
\DoxyCodeLine{00647\ \};}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00657\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_aee3fb4be9da81668dd3bb3375c6602c1}{EggVertexPool::}}}
\DoxyCodeLine{00658\ \mbox{\hyperlink{classEggVertexPool_aee3fb4be9da81668dd3bb3375c6602c1}{transform}}(\textcolor{keyword}{const}\ LMatrix4d\ \&mat)\ \{}
\DoxyCodeLine{00659\ \ \ LVector3d\ translation\ =\ mat.get\_row3(3);}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ \textcolor{keywordflow}{if}\ (translation\ ==\ LVector3d(0.0,\ 0.0,\ 0.0))\ \{}
\DoxyCodeLine{00662\ \ \ \ \ \textcolor{comment}{//\ If\ the\ matrix\ does\ not\ have\ a\ translation\ component,\ we\ can\ treat\ the}}
\DoxyCodeLine{00663\ \ \ \ \ \textcolor{comment}{//\ local\ and\ global\ vertices\ the\ same.\ \ This\ makes\ things\ much\ easier.}}
\DoxyCodeLine{00664\ \ \ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}\ i;}
\DoxyCodeLine{00665\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ i\ !=\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++i)\ \{}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vert\ =\ *i;}
\DoxyCodeLine{00667\ \ \ \ \ \ \ vert-\/>\mbox{\hyperlink{classEggVertex_a67cbffa9ee6d029b940f1381df434f8f}{transform}}(mat);}
\DoxyCodeLine{00668\ \ \ \ \ \}}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{comment}{//\ The\ matrix\ does\ have\ a\ translation\ component.\ \ That\ means\ we\ have\ to}}
\DoxyCodeLine{00672\ \ \ \ \ \textcolor{comment}{//\ treat\ the\ global\ and\ local\ vertices\ differently.\ \ Yucky.}}
\DoxyCodeLine{00673\ }
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{comment}{//\ First,\ transform\ the\ global\ vertices.\ \ Get\ a\ copy\ of\ the\ list\ of}}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{comment}{//\ vertices\ in\ this\ pool.\ \ We\ must\ have\ a\ copy\ because\ we\ might\ be}}
\DoxyCodeLine{00676\ \ \ \ \ \textcolor{comment}{//\ modifying\ the\ list\ as\ we\ traverse\ it.}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpvector}{pvector<EggVertex\ *>}}\ Verts;}
\DoxyCodeLine{00679\ \ \ \ \ Verts\ verts;}
\DoxyCodeLine{00680\ \ \ \ \ verts.reserve(size());}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{comment}{//\ Work\ around\ MSVC\ 2017\ compiler\ bug,\ see\ GitHub\ issue\ \#379}}
\DoxyCodeLine{00683\ \textcolor{preprocessor}{\#ifdef\ \_MSC\_VER}}
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ IndexVertices::value\_type\ \&v\ :\ \_index\_vertices)\ \{}
\DoxyCodeLine{00685\ \ \ \ \ \ \ verts.push\_back(v.second);}
\DoxyCodeLine{00686\ \ \ \ \ \}}
\DoxyCodeLine{00687\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00688\ \ \ \ \ std::copy(\mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}(),\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}(),\ std::back\_inserter(verts));}
\DoxyCodeLine{00689\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \ \ Verts::const\_iterator\ vi;}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ verts.begin();\ vi\ !=\ verts.end();\ ++vi)\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vert\ =\ *vi;}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_local\_coord\ =\ vert-\/>\mbox{\hyperlink{classEggVertex_acda313ae1fcc875f547cf116c8739551}{get\_num\_local\_coord}}();}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ num\_global\_coord\ =\ vert-\/>\mbox{\hyperlink{classEggVertex_af6b66bfd0f99d4b8464866415d4bc7a2}{get\_num\_global\_coord}}();}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_global\_coord\ !=\ 0)\ \{}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ vertex\ will\ be\ transformed.}}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_local\_coord\ !=\ 0)\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ also\ needs\ to\ be\ split!\ \ Yuck.}}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{eggUtilities_8h_a11218ea5521855c2f0021ec19a039940}{split\_vertex}}(vert,\ \mbox{\hyperlink{classIsLocalVertexSplitter}{IsLocalVertexSplitter}}());}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ vert-\/>\mbox{\hyperlink{classEggVertex_a67cbffa9ee6d029b940f1381df434f8f}{transform}}(mat);}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00706\ \ \ \ \ \}}
\DoxyCodeLine{00707\ }
\DoxyCodeLine{00708\ \ \ \ \ \textcolor{comment}{//\ Now\ transform\ the\ local\ vertices.\ \ We\ can\ walk\ through\ the\ list}}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{comment}{//\ directly\ now,\ because\ we\ won't\ be\ modifying\ the\ list\ this\ time.}}
\DoxyCodeLine{00710\ \ \ \ \ LMatrix4d\ local\_mat\ =\ mat;}
\DoxyCodeLine{00711\ \ \ \ \ local\_mat.set\_row(3,\ LVector3d(0.0,\ 0.0,\ 0.0));}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}\ i;}
\DoxyCodeLine{00714\ \ \ \ \ \textcolor{keywordflow}{for}\ (i\ =\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ i\ !=\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++i)\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vert\ =\ *i;}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (vert-\/>\mbox{\hyperlink{classEggVertex_acda313ae1fcc875f547cf116c8739551}{get\_num\_local\_coord}}()\ !=\ 0)\ \{}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ This\ should\ be\ guaranteed\ by\ the\ vertex-\/splitting\ logic\ above.}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ nassertv(vert-\/>\mbox{\hyperlink{classEggVertex_af6b66bfd0f99d4b8464866415d4bc7a2}{get\_num\_global\_coord}}()\ ==\ 0);}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ vert-\/>\mbox{\hyperlink{classEggVertex_a67cbffa9ee6d029b940f1381df434f8f}{transform}}(local\_mat);}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00722\ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \}}
\DoxyCodeLine{00724\ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \textcolor{comment}{//\ A\ function\ object\ for\ sort\_by\_external\_index(),\ below.}}
\DoxyCodeLine{00728\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classSortByExternalIndex}{SortByExternalIndex}}\ \{}
\DoxyCodeLine{00729\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00730\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (\mbox{\hyperlink{classEggVertex}{EggVertex}}\ *a,\ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *b)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{keywordtype}{int}\ ai\ =\ a-\/>get\_external\_index();}
\DoxyCodeLine{00732\ \ \ \ \ \textcolor{keywordtype}{int}\ bi\ =\ b-\/>get\_external\_index();}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{keywordflow}{if}\ (ai\ !=\ bi)\ \{}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ai\ <\ bi;}
\DoxyCodeLine{00735\ \ \ \ \ \}}
\DoxyCodeLine{00736\ \ \ \ \ \textcolor{keywordflow}{return}\ a-\/>get\_index()\ <\ b-\/>get\_index();}
\DoxyCodeLine{00737\ \ \ \}}
\DoxyCodeLine{00738\ \};}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00745\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_a3cdb48bfbf4e52feb071bf119f4307e2}{EggVertexPool::}}}
\DoxyCodeLine{00746\ \mbox{\hyperlink{classEggVertexPool_a3cdb48bfbf4e52feb071bf119f4307e2}{sort\_by\_external\_index}}()\ \{}
\DoxyCodeLine{00747\ \ \ \textcolor{comment}{//\ Copy\ the\ vertices\ into\ a\ vector\ for\ sorting.}}
\DoxyCodeLine{00748\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpvector}{pvector<EggVertex\ *>}}\ SortedVertices;}
\DoxyCodeLine{00749\ \ \ SortedVertices\ sorted\_vertices;}
\DoxyCodeLine{00750\ \ \ sorted\_vertices.reserve(size());}
\DoxyCodeLine{00751\ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}\ i;}
\DoxyCodeLine{00752\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ i\ !=\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++i)\ \{}
\DoxyCodeLine{00753\ \ \ \ \ sorted\_vertices.push\_back(*i);}
\DoxyCodeLine{00754\ \ \ \}}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ std::sort(sorted\_vertices.begin(),\ sorted\_vertices.end(),\ \mbox{\hyperlink{classSortByExternalIndex}{SortByExternalIndex}}());}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{comment}{//\ Now\ reassign\ the\ indices,\ and\ copy\ them\ into\ a\ new\ index\ map.}}
\DoxyCodeLine{00759\ \ \ \mbox{\hyperlink{classpmap}{IndexVertices}}\ new\_index\_vertices;}
\DoxyCodeLine{00760\ \ \ \textcolor{keywordtype}{int}\ vi;}
\DoxyCodeLine{00761\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ 0;\ vi\ <\ (int)sorted\_vertices.size();\ ++vi)\ \{}
\DoxyCodeLine{00762\ \ \ \ \ \mbox{\hyperlink{classEggVertex}{EggVertex}}\ *vertex\ =\ sorted\_vertices[vi];}
\DoxyCodeLine{00763\ \ \ \ \ vertex-\/>\_index\ =\ vi;}
\DoxyCodeLine{00764\ \ \ \ \ new\_index\_vertices[vi]\ =\ vertex;}
\DoxyCodeLine{00765\ \ \ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \textcolor{comment}{//\ Finally,\ assign\ the\ new\ index\ map.}}
\DoxyCodeLine{00768\ \ \ \_index\_vertices.swap(new\_index\_vertices);}
\DoxyCodeLine{00769\ \}}
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00774\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_afefa0cc8eb3fd977e28475f7d9bf5048}{EggVertexPool::}}}
\DoxyCodeLine{00775\ \mbox{\hyperlink{classEggVertexPool_afefa0cc8eb3fd977e28475f7d9bf5048}{write}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00776\ \ \ \mbox{\hyperlink{classEggNamedObject_a3bff8c19c95cf7a74710555c987d6172}{write\_header}}(out,\ indent\_level,\ \textcolor{stringliteral}{"{}<VertexPool>"{}});}
\DoxyCodeLine{00777\ }
\DoxyCodeLine{00778\ \ \ \mbox{\hyperlink{classsecond__of__pair__iterator}{iterator}}\ i;}
\DoxyCodeLine{00779\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ \mbox{\hyperlink{classEggVertexPool_ab453b04185e440a165aaab166d9f71fc}{begin}}();\ i\ !=\ \mbox{\hyperlink{classEggVertexPool_a8495c71e0ceda2996b46b420317af502}{end}}();\ ++i)\ \{}
\DoxyCodeLine{00780\ \ \ \ \ (*i)-\/>write(out,\ indent\_level+2);}
\DoxyCodeLine{00781\ \ \ \}}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00784\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00785\ \}}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00797\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_ae7e609cb61327d7dab3c1cd3c5267cd2}{EggVertexPool::}}}
\DoxyCodeLine{00798\ \mbox{\hyperlink{classEggVertexPool_ae7e609cb61327d7dab3c1cd3c5267cd2}{r\_transform}}(\textcolor{keyword}{const}\ LMatrix4d\ \&mat,\ \textcolor{keyword}{const}\ LMatrix4d\ \&,\ CoordinateSystem)\ \{}
\DoxyCodeLine{00799\ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00807\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggVertexPool_afc9bb798e9523f25a8fc3350d47cbfa6}{EggVertexPool::}}}
\DoxyCodeLine{00808\ \mbox{\hyperlink{classEggVertexPool_afc9bb798e9523f25a8fc3350d47cbfa6}{r\_transform\_vertices}}(\textcolor{keyword}{const}\ LMatrix4d\ \&mat)\ \{}
\DoxyCodeLine{00809\ \ \ transform(mat);}
\DoxyCodeLine{00810\ \}}

\end{DoxyCode}
