\doxysection{mouse\+And\+Keyboard.\+cxx}
\hypertarget{mouseAndKeyboard_8cxx_source}{}\label{mouseAndKeyboard_8cxx_source}\index{panda/src/display/mouseAndKeyboard.cxx@{panda/src/display/mouseAndKeyboard.cxx}}
\mbox{\hyperlink{mouseAndKeyboard_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mouseAndKeyboard_8h}{mouseAndKeyboard.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pointerData_8h}{pointerData.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{buttonHandle_8h}{buttonHandle.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{buttonEvent_8h}{buttonEvent.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dataNodeTransmit_8h}{dataNodeTransmit.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsWindow_8h}{graphicsWindow.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ MouseAndKeyboard::\_type\_handle;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ MouseAndKeyboard::}
\DoxyCodeLine{00027\ MouseAndKeyboard(\mbox{\hyperlink{classGraphicsWindow}{GraphicsWindow}}\ *window,\ \textcolor{keywordtype}{int}\ device,\ \textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classDataNode}{DataNode}}(name),}
\DoxyCodeLine{00029\ \ \ \_window(window),}
\DoxyCodeLine{00030\ \ \ \_device(window-\/>get\_input\_device(device))}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \_pixel\_xy\_output\ =\ define\_output(\textcolor{stringliteral}{"{}pixel\_xy"{}},\ EventStoreVec2::get\_class\_type());}
\DoxyCodeLine{00033\ \ \ \_pixel\_size\_output\ =\ define\_output(\textcolor{stringliteral}{"{}pixel\_size"{}},\ EventStoreVec2::get\_class\_type());}
\DoxyCodeLine{00034\ \ \ \_xy\_output\ =\ define\_output(\textcolor{stringliteral}{"{}xy"{}},\ EventStoreVec2::get\_class\_type());}
\DoxyCodeLine{00035\ \ \ \_button\_events\_output\ =\ define\_output(\textcolor{stringliteral}{"{}button\_events"{}},\ ButtonEventList::get\_class\_type());}
\DoxyCodeLine{00036\ \ \ \_pointer\_events\_output\ =\ define\_output(\textcolor{stringliteral}{"{}pointer\_events"{}},\ PointerEventList::get\_class\_type());}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \_pixel\_xy\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classParamValue}{EventStoreVec2}}(LPoint2(0.0f,\ 0.0f));}
\DoxyCodeLine{00039\ \ \ \_pixel\_size\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classParamValue}{EventStoreVec2}}(LPoint2(0.0f,\ 0.0f));}
\DoxyCodeLine{00040\ \ \ \_xy\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classParamValue}{EventStoreVec2}}(LPoint2(0.0f,\ 0.0f));}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \_device-\/>enable\_pointer\_events();}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00049\ \textcolor{keywordtype}{void}\ MouseAndKeyboard::}
\DoxyCodeLine{00050\ set\_source(\mbox{\hyperlink{classGraphicsWindow}{GraphicsWindow}}\ *window,\ \textcolor{keywordtype}{int}\ device)\ \{}
\DoxyCodeLine{00051\ \ \ \_window\ =\ window;}
\DoxyCodeLine{00052\ \ \ \_device\ =\ window-\/>\mbox{\hyperlink{classGraphicsWindow_a2d56c2fa54651a23bc83b23c41680fe2}{get\_input\_device}}(device);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{comment}{//\_device-\/>enable\_pointer\_events();}}
\DoxyCodeLine{00055\ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00065\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMouseAndKeyboard_a9254e026b92945757e063d61677df56d}{MouseAndKeyboard::}}}
\DoxyCodeLine{00066\ \mbox{\hyperlink{classMouseAndKeyboard_a9254e026b92945757e063d61677df56d}{do\_transmit\_data}}(\mbox{\hyperlink{classDataGraphTraverser}{DataGraphTraverser}}\ *,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDataNodeTransmit}{DataNodeTransmit}}\ \&,}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classDataNodeTransmit}{DataNodeTransmit}}\ \&output)\ \{}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{classGraphicsWindowInputDevice}{GraphicsWindowInputDevice}}\ *device\ =\ (\mbox{\hyperlink{classGraphicsWindowInputDevice}{GraphicsWindowInputDevice}}\ *)\_device.p();}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{if}\ (device-\/>\mbox{\hyperlink{classInputDevice_afd6b3ade8b4a9593cf7b05ab7419430c}{has\_button\_event}}())\ \{}
\DoxyCodeLine{00072\ \ \ \ \ PT(\mbox{\hyperlink{classButtonEventList}{ButtonEventList}})\ bel\ =\ device-\/>get\_button\_events();}
\DoxyCodeLine{00073\ \ \ \ \ output.set\_data(\_button\_events\_output,\ \mbox{\hyperlink{classEventParameter}{EventParameter}}(bel));}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{if}\ (device-\/>\mbox{\hyperlink{classInputDevice_ab4382d3dd96d173390b6749879bbbd11}{has\_pointer\_event}}())\ \{}
\DoxyCodeLine{00076\ \ \ \ \ PT(\mbox{\hyperlink{classPointerEventList}{PointerEventList}})\ pel\ =\ device-\/>get\_pointer\_events();}
\DoxyCodeLine{00077\ \ \ \ \ output.set\_data(\_pointer\_events\_output,\ \mbox{\hyperlink{classEventParameter}{EventParameter}}(pel));}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \textcolor{comment}{//\ Get\ the\ window\ size.}}
\DoxyCodeLine{00081\ \ \ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ properties\ =\ \_window-\/>get\_properties();}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{if}\ (properties.has\_size())\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordtype}{int}\ w\ =\ properties.get\_x\_size();}
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{keywordtype}{int}\ h\ =\ properties.get\_y\_size();}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \ \ \_pixel\_size-\/>set\_value(LPoint2(w,\ h));}
\DoxyCodeLine{00087\ \ \ \ \ output.set\_data(\_pixel\_size\_output,\ \mbox{\hyperlink{classEventParameter}{EventParameter}}(\_pixel\_size));}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{if}\ (device-\/>has\_pointer())\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerData}{PointerData}}\ mdata\ =\ device-\/>get\_pointer();}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mdata.\_in\_window)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ mouse\ motion\ in\ pixels.}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \_pixel\_xy-\/>set\_value(LPoint2(mdata.\_xpos,\ mdata.\_ypos));}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ output.set\_data(\_pixel\_xy\_output,\ \mbox{\hyperlink{classEventParameter}{EventParameter}}(\_pixel\_xy));}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Normalize\ pixel\ motion\ to\ range\ [-\/1,1].}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ PN\_stdfloat\ xf\ =\ (PN\_stdfloat)(2\ *\ mdata.\_xpos)\ /\ (PN\_stdfloat)w\ -\/\ 1.0f;}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ PN\_stdfloat\ yf\ =\ 1.0f\ -\/\ (PN\_stdfloat)(2\ *\ mdata.\_ypos)\ /\ (PN\_stdfloat)h;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \_xy-\/>set\_value(LPoint2(xf,\ yf));}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ output.set\_data(\_xy\_output,\ \mbox{\hyperlink{classEventParameter}{EventParameter}}(\_xy));}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00104\ \ \ \ \ \}}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ \}}

\end{DoxyCode}
