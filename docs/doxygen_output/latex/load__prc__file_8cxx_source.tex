\doxysection{load\+\_\+prc\+\_\+file.\+cxx}
\hypertarget{load__prc__file_8cxx_source}{}\label{load__prc__file_8cxx_source}\index{panda/src/putil/load\_prc\_file.cxx@{panda/src/putil/load\_prc\_file.cxx}}
\mbox{\hyperlink{load__prc__file_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{load__prc__file_8h}{load\_prc\_file.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configPageManager_8h}{configPageManager.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableManager_8h}{configVariableManager.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__express_8h}{config\_express.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__putil_8h}{config\_putil.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hashVal_8h}{hashVal.h}}"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00035\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *}
\DoxyCodeLine{00036\ \mbox{\hyperlink{load__prc__file_8cxx_a9a422f93b9587486c961c23756180d9e}{load\_prc\_file}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename)\ \{}
\DoxyCodeLine{00037\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ path\ =\ filename;}
\DoxyCodeLine{00038\ \ \ path.set\_text();}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classConfigPageManager}{ConfigPageManager}}\ *cp\_mgr\ =\ ConfigPageManager::get\_global\_ptr();}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00043\ \ \ vfs-\/>resolve\_filename(path,\ cp\_mgr-\/>get\_search\_path())\ ||}
\DoxyCodeLine{00044\ \ \ \ \ vfs-\/>resolve\_filename(path,\ get\_model\_path());}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ std::istream\ *file\ =\ vfs-\/>open\_read\_file(path,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00048\ \ \ \ \ util\_cat.error()}
\DoxyCodeLine{00049\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ "{}}\ <<\ path\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ util\_cat.info()}
\DoxyCodeLine{00054\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ "{}}\ <<\ path\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ cp\_mgr-\/>\mbox{\hyperlink{classConfigPageManager_a6c50ed2c431e6be5a4cfc10d88f15d1a}{make\_explicit\_page}}(path);}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordtype}{bool}\ read\_ok\ =\ page-\/>\mbox{\hyperlink{classConfigPage_ad3eab34c400243c656886c3be3f95b60}{read\_prc}}(*file);}
\DoxyCodeLine{00058\ \ \ vfs-\/>close\_read\_file(file);}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{if}\ (read\_ok)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordflow}{return}\ page;}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00064\ \ \ \ \ util\_cat.info()}
\DoxyCodeLine{00065\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ read\ "{}}\ <<\ path\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00066\ \ \ \ \ cp\_mgr-\/>\mbox{\hyperlink{classConfigPageManager_a119f38a41f22d8ddbbc27710f71ba084}{delete\_explicit\_page}}(page);}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00080\ EXPCL\_PANDA\_PUTIL\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *}
\DoxyCodeLine{00081\ \mbox{\hyperlink{load__prc__file_8cxx_ae71d773fc774a407ac372119984a449c}{load\_prc\_file\_data}}(\textcolor{keyword}{const}\ std::string\ \&name,\ \textcolor{keyword}{const}\ std::string\ \&data)\ \{}
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{classstd_1_1istringstream}{std::istringstream}}\ strm(data);}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \mbox{\hyperlink{classConfigPageManager}{ConfigPageManager}}\ *cp\_mgr\ =\ ConfigPageManager::get\_global\_ptr();}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ cp\_mgr-\/>\mbox{\hyperlink{classConfigPageManager_a6c50ed2c431e6be5a4cfc10d88f15d1a}{make\_explicit\_page}}(name);}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{bool}\ read\_ok\ =\ page-\/>\mbox{\hyperlink{classConfigPage_ad3eab34c400243c656886c3be3f95b60}{read\_prc}}(strm);}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{if}\ (read\_ok)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ page-\/>set\_trust\_level(1);\ \ \textcolor{comment}{//\ temp\ hack}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{return}\ page;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00094\ \ \ \ \ util\_cat.info()}
\DoxyCodeLine{00095\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ read\ explicit\ prc\ data\ "{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00096\ \ \ \ \ cp\_mgr-\/>\mbox{\hyperlink{classConfigPageManager_a119f38a41f22d8ddbbc27710f71ba084}{delete\_explicit\_page}}(page);}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00109\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00110\ \mbox{\hyperlink{load__prc__file_8cxx_ab2f32b7b99b278f54ebdeb4dc757bfae}{unload\_prc\_file}}(\mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page)\ \{}
\DoxyCodeLine{00111\ \ \ \mbox{\hyperlink{classConfigPageManager}{ConfigPageManager}}\ *cp\_mgr\ =\ ConfigPageManager::get\_global\_ptr();}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{return}\ cp\_mgr-\/>\mbox{\hyperlink{classConfigPageManager_a119f38a41f22d8ddbbc27710f71ba084}{delete\_explicit\_page}}(page);}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00119\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00120\ \mbox{\hyperlink{load__prc__file_8cxx_aabb7a51266009b31c51af73313d47d9f}{hash\_prc\_variables}}(\mbox{\hyperlink{classHashVal}{HashVal}}\ \&hash)\ \{}
\DoxyCodeLine{00121\ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ strm;}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{classConfigVariableManager}{ConfigVariableManager}}\ *cv\_mgr\ =\ ConfigVariableManager::get\_global\_ptr();}
\DoxyCodeLine{00123\ \ \ cv\_mgr-\/>\mbox{\hyperlink{classConfigVariableManager_ac9ecc75169a78345d8728f068c9a4587}{write\_prc\_variables}}(strm);}
\DoxyCodeLine{00124\ \ \ hash.hash\_string(strm.str());}
\DoxyCodeLine{00125\ \}}

\end{DoxyCode}
