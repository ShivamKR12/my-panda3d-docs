\doxysection{texture\+Placement.\+cxx}
\hypertarget{texturePlacement_8cxx_source}{}\label{texturePlacement_8cxx_source}\index{pandatool/src/palettizer/texturePlacement.cxx@{pandatool/src/palettizer/texturePlacement.cxx}}
\mbox{\hyperlink{texturePlacement_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{texturePlacement_8h}{texturePlacement.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textureReference_8h}{textureReference.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textureImage_8h}{textureImage.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{paletteGroup_8h}{paletteGroup.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{paletteImage_8h}{paletteImage.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{palettizer_8h}{palettizer.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggFile_8h}{eggFile.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{destTextureImage_8h}{destTextureImage.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmImage_8h}{pnmImage.h}}"{}}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{using\ }std::max;}
\DoxyCodeLine{00031\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ TexturePlacement::\_type\_handle;}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ TexturePlacement::}
\DoxyCodeLine{00039\ TexturePlacement()\ \{}
\DoxyCodeLine{00040\ \ \ \_texture\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00041\ \ \ \_group\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00042\ \ \ \_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00043\ \ \ \_dest\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00044\ \ \ \_has\_uvs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00045\ \ \ \_size\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00046\ \ \ \_is\_filled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00047\ \ \ \_omit\_reason\ =\ OR\_none;}
\DoxyCodeLine{00048\ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00053\ TexturePlacement::}
\DoxyCodeLine{00054\ TexturePlacement(\mbox{\hyperlink{classTextureImage}{TextureImage}}\ *texture,\ \mbox{\hyperlink{classPaletteGroup}{PaletteGroup}}\ *group)\ :}
\DoxyCodeLine{00055\ \ \ \_texture(texture),}
\DoxyCodeLine{00056\ \ \ \_group(group)}
\DoxyCodeLine{00057\ \{}
\DoxyCodeLine{00058\ \ \ \_omit\_reason\ =\ OR\_working;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{if}\ (!texture-\/>is\_size\_known())\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{comment}{//\ If\ we\ were\ never\ able\ to\ figure\ out\ what\ size\ the\ texture\ actually\ is,}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ then\ we\ can't\ place\ the\ texture\ on\ a\ palette.}}
\DoxyCodeLine{00063\ \ \ \ \ \_omit\_reason\ =\ OR\_unknown;}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00067\ \ \ \_dest\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00068\ \ \ \_has\_uvs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00069\ \ \ \_size\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00070\ \ \ \_is\_filled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00076\ TexturePlacement::}
\DoxyCodeLine{00077\ \string~TexturePlacement()\ \{}
\DoxyCodeLine{00078\ \ \ \textcolor{comment}{//\ Make\ sure\ we\ tell\ all\ our\ egg\ references\ they're\ not\ using\ us\ any\ more.}}
\DoxyCodeLine{00079\ \ \ References::iterator\ ri;}
\DoxyCodeLine{00080\ \ \ References\ copy\_references\ =\ \_references;}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ copy\_references.begin();\ ri\ !=\ copy\_references.end();\ ++ri)\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference\ =\ (*ri);}
\DoxyCodeLine{00083\ \ \ \ \ nassertv(reference-\/>get\_placement()\ ==\ \textcolor{keyword}{this});}
\DoxyCodeLine{00084\ \ \ \ \ reference-\/>clear\_placement();}
\DoxyCodeLine{00085\ \ \ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \textcolor{comment}{//\ And\ also\ our\ group,\ etc.}}
\DoxyCodeLine{00088\ \ \ \_group-\/>\mbox{\hyperlink{classPaletteGroup_a27373e5c52699f8982bafea1b04c8b8e}{unplace}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00094\ \textcolor{keyword}{const}\ std::string\ \&\mbox{\hyperlink{classTexturePlacement_a5b05c5c5de0bcffacff68abed9e5e368}{TexturePlacement::}}}
\DoxyCodeLine{00095\ \mbox{\hyperlink{classTexturePlacement_a5b05c5c5de0bcffacff68abed9e5e368}{get\_name}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{return}\ \_texture-\/>get\_name();}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00102\ \mbox{\hyperlink{classTextureImage}{TextureImage}}\ *\mbox{\hyperlink{classTexturePlacement_ac41838d62b321927f6d0134d0fe2677b}{TexturePlacement::}}}
\DoxyCodeLine{00103\ \mbox{\hyperlink{classTexturePlacement_ac41838d62b321927f6d0134d0fe2677b}{get\_texture}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{return}\ \_texture;}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00110\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTextureProperties}{TextureProperties}}\ \&\mbox{\hyperlink{classTexturePlacement_a98eaed41efb0c965d42132383a6b9494}{TexturePlacement::}}}
\DoxyCodeLine{00111\ \mbox{\hyperlink{classTexturePlacement_a98eaed41efb0c965d42132383a6b9494}{get\_properties}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{return}\ \_texture-\/>\mbox{\hyperlink{classImageFile_a68510fd0274d1e4d944fefcc8f06dd24}{get\_properties}}();}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00118\ \mbox{\hyperlink{classPaletteGroup}{PaletteGroup}}\ *\mbox{\hyperlink{classTexturePlacement_a1decbbaa8abd60a3c1bf14d4c46ffd88}{TexturePlacement::}}}
\DoxyCodeLine{00119\ \mbox{\hyperlink{classTexturePlacement_a1decbbaa8abd60a3c1bf14d4c46ffd88}{get\_group}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{return}\ \_group;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a32ebbca786b52eaa30e44cb86bfa7be6}{TexturePlacement::}}}
\DoxyCodeLine{00128\ \mbox{\hyperlink{classTexturePlacement_a32ebbca786b52eaa30e44cb86bfa7be6}{add\_egg}}(\mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference)\ \{}
\DoxyCodeLine{00129\ \ \ reference-\/>mark\_egg\_stale();}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ Turns\ out\ that\ turning\ these\ off\ is\ a\ bad\ idea,\ because\ it\ may\ make\ us}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ forget\ the\ size\ information\ halfway\ through\ processing.}}
\DoxyCodeLine{00133\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00134\ \textcolor{comment}{\ \ \_has\_uvs\ =\ false;}}
\DoxyCodeLine{00135\ \textcolor{comment}{\ \ \_size\_known\ =\ false;}}
\DoxyCodeLine{00136\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00137\ \ \ \_references.insert(reference);}
\DoxyCodeLine{00138\ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00144\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a1f3ddab48a8973bd2f793fdea3838410}{TexturePlacement::}}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{classTexturePlacement_a1f3ddab48a8973bd2f793fdea3838410}{remove\_egg}}(\mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference)\ \{}
\DoxyCodeLine{00146\ \ \ reference-\/>mark\_egg\_stale();}
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00148\ \textcolor{comment}{\ \ \ \ \_has\_uvs\ =\ false;}}
\DoxyCodeLine{00149\ \textcolor{comment}{\ \ \ \ \_size\_known\ =\ false;}}
\DoxyCodeLine{00150\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00151\ \ \ \_references.erase(reference);}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{TexturePlacement::}}}
\DoxyCodeLine{00159\ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{mark\_eggs\_stale}}()\ \{}
\DoxyCodeLine{00160\ \ \ References::iterator\ ri;}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ \_references.begin();\ ri\ !=\ \_references.end();\ ++ri)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference\ =\ (*ri);}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ reference-\/>\mbox{\hyperlink{classTextureReference_afb62ff9fc4666fa31bcbcab6256779f0}{mark\_egg\_stale}}();}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00172\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a723c75c20ad8d7e923bdb8e7dab8e980}{TexturePlacement::}}}
\DoxyCodeLine{00173\ \mbox{\hyperlink{classTexturePlacement_a723c75c20ad8d7e923bdb8e7dab8e980}{set\_dest}}(\mbox{\hyperlink{classDestTextureImage}{DestTextureImage}}\ *dest)\ \{}
\DoxyCodeLine{00174\ \ \ \_dest\ =\ dest;}
\DoxyCodeLine{00175\ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00181\ \mbox{\hyperlink{classDestTextureImage}{DestTextureImage}}\ *\mbox{\hyperlink{classTexturePlacement_a183ed28e7d2c82c880e2d88549b68d2a}{TexturePlacement::}}}
\DoxyCodeLine{00182\ \mbox{\hyperlink{classTexturePlacement_a183ed28e7d2c82c880e2d88549b68d2a}{get\_dest}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordflow}{return}\ \_dest;}
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00195\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexturePlacement_ac4619af9181d4bb5f1c59619f29de2bd}{TexturePlacement::}}}
\DoxyCodeLine{00196\ \mbox{\hyperlink{classTexturePlacement_ac4619af9181d4bb5f1c59619f29de2bd}{determine\_size}}()\ \{}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{if}\ (!\_texture-\/>\mbox{\hyperlink{classImageFile_a8cb520e04d22bfa018507b7b7cce0778}{is\_size\_known}}())\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ Too\ bad.}}
\DoxyCodeLine{00199\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00200\ \ \ \ \ \_omit\_reason\ =\ OR\_unknown;}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{comment}{//\ This\ seems\ to\ be\ unnecessary\ (because\ of\ omit\_solitary()\ and}}
\DoxyCodeLine{00205\ \ \ \textcolor{comment}{//\ not\_solitary()),\ and\ in\ fact\ bitches\ the\ logic\ in\ omit\_solitary()\ and}}
\DoxyCodeLine{00206\ \ \ \textcolor{comment}{//\ not\_solitary()\ so\ that\ we\ call\ mark\_egg\_stale()\ unnecessarily.}}
\DoxyCodeLine{00207\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00208\ \textcolor{comment}{\ \ if\ (\_omit\_reason\ ==\ OR\_solitary)\ \{}}
\DoxyCodeLine{00209\ \textcolor{comment}{\ \ \ \ //\ If\ the\ texture\ was\ previously\ 'omitted'\ for\ being\ solitary,\ we\ give\ it}}
\DoxyCodeLine{00210\ \textcolor{comment}{\ \ \ \ //\ a\ second\ chance\ now.}}
\DoxyCodeLine{00211\ \textcolor{comment}{\ \ \ \ \_omit\_reason\ =\ OR\_none;}}
\DoxyCodeLine{00212\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00213\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//\ Determine\ the\ actual\ minmax\ of\ the\ UV's\ in\ use,\ as\ well\ as\ whether\ we}}
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ should\ wrap\ or\ clamp.}}
\DoxyCodeLine{00217\ \ \ \_has\_uvs\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00218\ \ \ \_position.\_wrap\_u\ =\ EggTexture::WM\_clamp;}
\DoxyCodeLine{00219\ \ \ \_position.\_wrap\_v\ =\ EggTexture::WM\_clamp;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ LTexCoordd\ max\_uv,\ min\_uv;}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ References::iterator\ ri;}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ \_references.begin();\ ri\ !=\ \_references.end();\ ++ri)\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference\ =\ (*ri);}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{if}\ (reference-\/>has\_uvs())\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{keyword}{const}\ LTexCoordd\ \&n\ =\ reference-\/>\mbox{\hyperlink{classTextureReference_aaa512617d028aed0a6fe411dae294bd1}{get\_min\_uv}}();}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{keyword}{const}\ LTexCoordd\ \&x\ =\ reference-\/>get\_max\_uv();}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_has\_uvs)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ min\_uv.set(min(min\_uv[0],\ n[0]),\ min(min\_uv[1],\ n[1]));}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ max\_uv.set(max(max\_uv[0],\ x[0]),\ max(max\_uv[1],\ x[1]));}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ min\_uv\ =\ n;}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ max\_uv\ =\ x;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \_has\_uvs\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00238\ \ \ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \textcolor{comment}{//\ If\ any\ reference\ repeats\ the\ texture,\ the\ texture\ repeats\ in\ the}}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{comment}{//\ palette.}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{if}\ (reference-\/>get\_wrap\_u()\ ==\ EggTexture::WM\_repeat)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \_position.\_wrap\_u\ =\ EggTexture::WM\_repeat;}
\DoxyCodeLine{00244\ \ \ \ \ \}}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{keywordflow}{if}\ (reference-\/>get\_wrap\_v()\ ==\ EggTexture::WM\_repeat)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \_position.\_wrap\_v\ =\ EggTexture::WM\_repeat;}
\DoxyCodeLine{00247\ \ \ \ \ \}}
\DoxyCodeLine{00248\ \ \ \}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \textcolor{comment}{//\ However,\ if\ the\ user\ specified\ an\ explicit\ wrap\ mode,\ allow\ it\ to\ apply.}}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{if}\ (\_texture-\/>\mbox{\hyperlink{classTextureImage_af8a12ede4d236a28e5ad1c6e4afcfaa3}{get\_txa\_wrap\_u}}()\ !=\ EggTexture::WM\_unspecified)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \_position.\_wrap\_u\ =\ \_texture-\/>\mbox{\hyperlink{classTextureImage_af8a12ede4d236a28e5ad1c6e4afcfaa3}{get\_txa\_wrap\_u}}();}
\DoxyCodeLine{00253\ \ \ \}}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordflow}{if}\ (\_texture-\/>\mbox{\hyperlink{classTextureImage_a45fed3011ddab1a860e634b04dc74904}{get\_txa\_wrap\_v}}()\ !=\ EggTexture::WM\_unspecified)\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \_position.\_wrap\_v\ =\ \_texture-\/>\mbox{\hyperlink{classTextureImage_a45fed3011ddab1a860e634b04dc74904}{get\_txa\_wrap\_v}}();}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_uvs)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00260\ \ \ \ \ \_omit\_reason\ =\ OR\_unused;}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00262\ \ \ \}}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ LTexCoordd\ rounded\_min\_uv\ =\ min\_uv;}
\DoxyCodeLine{00265\ \ \ LTexCoordd\ rounded\_max\_uv\ =\ max\_uv;}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \textcolor{comment}{//\ cout\ <<\ get\_name()\ <<\ endl;}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{comment}{//\ If\ so\ requested,\ round\ the\ minmax\ out\ to\ the\ next\ \_round\_unit.\ \ This\ cuts}}
\DoxyCodeLine{00270\ \ \ \textcolor{comment}{//\ down\ on\ unnecessary\ resizing\ of\ textures\ within\ the\ palettes\ as\ the\ egg}}
\DoxyCodeLine{00271\ \ \ \textcolor{comment}{//\ references\ change\ in\ trivial\ amounts.\ \ cout\ <<\ "{}rounded\_min\_uv:\ "{}\ <<}}
\DoxyCodeLine{00272\ \ \ \textcolor{comment}{//\ rounded\_min\_uv\ <<\ endl;\ cout\ <<\ "{}rounded\_max\_uv:\ "{}\ <<\ rounded\_max\_uv\ <<}}
\DoxyCodeLine{00273\ \ \ \textcolor{comment}{//\ endl;}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{if}\ (pal-\/>\_round\_uvs)\ \{}
\DoxyCodeLine{00276\ \ \ \ \ rounded\_max\_uv[0]\ =}
\DoxyCodeLine{00277\ \ \ \ \ \ \ ceil((rounded\_max\_uv[0]\ -\/\ pal-\/>\_round\_fuzz)\ /\ pal-\/>\_round\_unit)\ *}
\DoxyCodeLine{00278\ \ \ \ \ \ \ pal-\/>\_round\_unit;}
\DoxyCodeLine{00279\ \ \ \ \ rounded\_max\_uv[1]\ =}
\DoxyCodeLine{00280\ \ \ \ \ \ \ ceil((rounded\_max\_uv[1]\ -\/\ pal-\/>\_round\_fuzz)\ /\ pal-\/>\_round\_unit)\ *}
\DoxyCodeLine{00281\ \ \ \ \ \ \ pal-\/>\_round\_unit;}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ rounded\_min\_uv[0]\ =}
\DoxyCodeLine{00284\ \ \ \ \ \ \ floor((rounded\_min\_uv[0]\ +\ pal-\/>\_round\_fuzz)\ /\ pal-\/>\_round\_unit)\ *}
\DoxyCodeLine{00285\ \ \ \ \ \ \ pal-\/>\_round\_unit;}
\DoxyCodeLine{00286\ \ \ \ \ rounded\_min\_uv[1]\ =}
\DoxyCodeLine{00287\ \ \ \ \ \ \ floor((rounded\_min\_uv[1]\ +\ pal-\/>\_round\_fuzz)\ /\ pal-\/>\_round\_unit)\ *}
\DoxyCodeLine{00288\ \ \ \ \ \ \ pal-\/>\_round\_unit;}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{comment}{//\ cout\ <<\ "{}after\ rounded\_min\_uv:\ "{}\ <<\ rounded\_min\_uv\ <<\ endl;\ cout\ <<}}
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{comment}{//\ "{}after\ rounded\_max\_uv:\ "{}\ <<\ rounded\_max\_uv\ <<\ endl;}}
\DoxyCodeLine{00292\ \ \ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \textcolor{comment}{//\ Now\ determine\ the\ size\ in\ pixels\ we\ require\ based\ on\ the\ UV's\ that}}
\DoxyCodeLine{00295\ \ \ \textcolor{comment}{//\ actually\ reference\ this\ texture.}}
\DoxyCodeLine{00296\ \ \ compute\_size\_from\_uvs(rounded\_min\_uv,\ rounded\_max\_uv);}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \textcolor{comment}{//\ Now,\ can\ it\ be\ placed?}}
\DoxyCodeLine{00299\ \ \ \textcolor{keywordflow}{if}\ (\_texture-\/>\mbox{\hyperlink{classTextureImage_aa559c2c0152ddb2309efd1105cd7281d}{get\_omit}}())\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \textcolor{comment}{//\ Not\ if\ the\ user\ says\ it\ can't.}}
\DoxyCodeLine{00301\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00302\ \ \ \ \ \_omit\_reason\ =\ OR\_omitted;}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexturePlacement_a6880ddd1e5daf13a50ccc49520fc7878}{get\_uv\_area}}()\ >\ \_texture-\/>\mbox{\hyperlink{classTextureImage_ae8b8fceed4522757069a5430aa021bac}{get\_coverage\_threshold}}())\ \{}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ repeats\ too\ many\ times,\ we\ can't\ place\ it.}}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00307\ \ \ \ \ \_omit\_reason\ =\ OR\_coverage;}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((\_position.\_x\_size\ >\ pal-\/>\_pal\_x\_size\ ||}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_y\_size\ >\ pal-\/>\_pal\_y\_size)\ ||}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ (\_position.\_x\_size\ ==\ pal-\/>\_pal\_x\_size\ \&\&}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_y\_size\ ==\ pal-\/>\_pal\_y\_size))\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ exceeds\ the\ size\ of\ an\ empty\ palette\ image\ in\ either}}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{//\ dimension,\ or\ if\ it\ exactly\ equals\ the\ size\ of\ an\ empty\ palette\ image}}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{//\ in\ both\ dimensions,\ we\ can't\ place\ it\ because\ it's\ too\ big.}}
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00317\ \ \ \ \ \_omit\_reason\ =\ OR\_size;}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (pal-\/>\_omit\_everything\ \&\&\ (\_group-\/>\mbox{\hyperlink{classPaletteGroup_a0b3753ebefbb27c5b86a5a9a31289ff1}{is\_none\_texture\_swap}}()))\ \{}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ omitting\ everything,\ omit\ everything.}}
\DoxyCodeLine{00321\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00322\ \ \ \ \ \_omit\_reason\ =\ OR\_default\_omit;}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_omit\_reason\ ==\ OR\_omitted\ ||}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_omit\_reason\ ==\ OR\_default\_omit\ ||}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_omit\_reason\ ==\ OR\_size\ ||}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_omit\_reason\ ==\ OR\_coverage\ ||}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_omit\_reason\ ==\ OR\_unknown)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{comment}{//\ On\ the\ other\ hand,\ if\ the\ texture\ was\ previously\ omitted\ explicitly,\ or}}
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{comment}{//\ because\ of\ its\ size\ or\ coverage,\ now\ it\ seems\ to\ fit.}}
\DoxyCodeLine{00331\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00332\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{mark\_eggs\_stale}}();}
\DoxyCodeLine{00333\ \ \ \ \ \_omit\_reason\ =\ OR\_working;}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}())\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{comment}{//\ It\ *can*\ be\ placed.\ \ If\ it\ was\ already\ placed\ previously,\ can\ we\ leave}}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{comment}{//\ it\ where\ it\ is?}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_position.\_x\_size\ !=\ \_placed.\_x\_size\ ||}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \_position.\_y\_size\ !=\ \_placed.\_y\_size\ ||}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \_position.\_min\_uv[0]\ <\ \_placed.\_min\_uv[0]\ ||}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \_position.\_min\_uv[1]\ <\ \_placed.\_min\_uv[1]\ ||}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \_position.\_max\_uv[0]\ >\ \_placed.\_max\_uv[0]\ ||}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \_position.\_max\_uv[1]\ >\ \_placed.\_max\_uv[1])\ \{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ texture\ was\ previously\ placed\ but\ is\ now\ the\ wrong\ size,\ or\ if}}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ area\ we\ need\ to\ cover\ is\ different,\ we\ need\ to\ re-\/place\ it.}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \ \ \textcolor{comment}{//\ However,\ we\ make\ a\ special\ exception:\ if\ it\ would\ have\ fit\ without}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{comment}{//\ rounding\ up\ the\ UV's,\ then\ screw\ rounding\ it\ up\ and\ just\ leave\ it}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \textcolor{comment}{//\ alone.}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_position.\_x\_size\ >\ \_placed.\_x\_size\ ||}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \_position.\_y\_size\ >\ \_placed.\_y\_size)\ \&\&}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ pal-\/>\_round\_uvs)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ compute\_size\_from\_uvs(min\_uv,\ max\_uv);}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_position.\_x\_size\ <=\ \_placed.\_x\_size\ \&\&}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_y\_size\ <=\ \_placed.\_y\_size\ \&\&}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_min\_uv[0]\ >=\ \_placed.\_min\_uv[0]\ \&\&}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_min\_uv[1]\ >=\ \_placed.\_min\_uv[1]\ \&\&}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_max\_uv[0]\ <=\ \_placed.\_max\_uv[0]\ \&\&}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \_position.\_max\_uv[1]\ <=\ \_placed.\_max\_uv[1])\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ No\ problem!\ \ It\ fits\ here,\ so\ leave\ well\ enough\ alone.}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ That's\ not\ good\ enough\ either,\ so\ go\ back\ to\ rounding.}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ compute\_size\_from\_uvs(rounded\_min\_uv,\ rounded\_max\_uv);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}();}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00370\ \ \ \ \ \}}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_position.\_wrap\_u\ !=\ \_placed.\_wrap\_u\ ||}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \_position.\_wrap\_v\ !=\ \_placed.\_wrap\_v)\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ wrap\ mode\ properties\ have\ changed\ slightly.\ \ We\ may\ or\ may\ not}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{comment}{//\ need\ to\ re-\/place\ it,\ but\ we\ will\ need\ to\ update\ it.}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \_is\_filled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \_placed.\_wrap\_u\ =\ \_position.\_wrap\_u;}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \_placed.\_wrap\_v\ =\ \_position.\_wrap\_v;}
\DoxyCodeLine{00379\ \ \ \ \ \}}
\DoxyCodeLine{00380\ \ \ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00383\ \}}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00391\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexturePlacement_a4ff12c2eb86a680a9049c289ba013bd3}{TexturePlacement::}}}
\DoxyCodeLine{00392\ \mbox{\hyperlink{classTexturePlacement_a4ff12c2eb86a680a9049c289ba013bd3}{is\_size\_known}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00393\ \ \ \textcolor{keywordflow}{return}\ \_size\_known;}
\DoxyCodeLine{00394\ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00400\ \mbox{\hyperlink{omitReason_8h_a30e2a7bcaf0d7900f654db1083fbfaa9}{OmitReason}}\ \mbox{\hyperlink{classTexturePlacement_a164b7566d6604255e12a14e4aefd9249}{TexturePlacement::}}}
\DoxyCodeLine{00401\ \mbox{\hyperlink{classTexturePlacement_a164b7566d6604255e12a14e4aefd9249}{get\_omit\_reason}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{return}\ \_omit\_reason;}
\DoxyCodeLine{00403\ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00410\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_a596fbe7391fc8c98e8494b93623d8b72}{TexturePlacement::}}}
\DoxyCodeLine{00411\ \mbox{\hyperlink{classTexturePlacement_a596fbe7391fc8c98e8494b93623d8b72}{get\_x\_size}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00412\ \ \ nassertr(\_size\_known,\ 0);}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{return}\ \_position.\_x\_size;}
\DoxyCodeLine{00414\ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00421\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_af28888da54605e3a1b53ba246e186059}{TexturePlacement::}}}
\DoxyCodeLine{00422\ \mbox{\hyperlink{classTexturePlacement_af28888da54605e3a1b53ba246e186059}{get\_y\_size}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00423\ \ \ nassertr(\_size\_known,\ 0);}
\DoxyCodeLine{00424\ \ \ \textcolor{keywordflow}{return}\ \_position.\_y\_size;}
\DoxyCodeLine{00425\ \}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00432\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classTexturePlacement_a6880ddd1e5daf13a50ccc49520fc7878}{TexturePlacement::}}}
\DoxyCodeLine{00433\ \mbox{\hyperlink{classTexturePlacement_a6880ddd1e5daf13a50ccc49520fc7878}{get\_uv\_area}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_uvs)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0;}
\DoxyCodeLine{00436\ \ \ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ LTexCoordd\ range\ =\ \_position.\_max\_uv\ -\/\ \_position.\_min\_uv;}
\DoxyCodeLine{00439\ \ \ \textcolor{keywordflow}{return}\ range[0]\ *\ range[1];}
\DoxyCodeLine{00440\ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00447\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{TexturePlacement::}}}
\DoxyCodeLine{00448\ \mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{return}\ \_image\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00450\ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00455\ \mbox{\hyperlink{classPaletteImage}{PaletteImage}}\ *\mbox{\hyperlink{classTexturePlacement_a7150a4fabedf33edb84bf1bb4e9a76fd}{TexturePlacement::}}}
\DoxyCodeLine{00456\ \mbox{\hyperlink{classTexturePlacement_a7150a4fabedf33edb84bf1bb4e9a76fd}{get\_image}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00457\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{return}\ \_image;}
\DoxyCodeLine{00459\ \}}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00464\ \mbox{\hyperlink{classPalettePage}{PalettePage}}\ *\mbox{\hyperlink{classTexturePlacement_aed3cd3cce89cbed85d15f1cea752bbad}{TexturePlacement::}}}
\DoxyCodeLine{00465\ \mbox{\hyperlink{classTexturePlacement_aed3cd3cce89cbed85d15f1cea752bbad}{get\_page}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00466\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00467\ \ \ \textcolor{keywordflow}{return}\ \_image-\/>\mbox{\hyperlink{classPaletteImage_a01ec0e848fcfc4361445f9321db24e21}{get\_page}}();}
\DoxyCodeLine{00468\ \}}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00474\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_aaadd8def245d012b5ee682d9decb280f}{TexturePlacement::}}}
\DoxyCodeLine{00475\ \mbox{\hyperlink{classTexturePlacement_aaadd8def245d012b5ee682d9decb280f}{get\_placed\_x}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00476\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ 0);}
\DoxyCodeLine{00477\ \ \ \textcolor{keywordflow}{return}\ \_placed.\_x;}
\DoxyCodeLine{00478\ \}}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00484\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_aaee64b89c9d2c96799da8614a8058948}{TexturePlacement::}}}
\DoxyCodeLine{00485\ \mbox{\hyperlink{classTexturePlacement_aaee64b89c9d2c96799da8614a8058948}{get\_placed\_y}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00486\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ 0);}
\DoxyCodeLine{00487\ \ \ \textcolor{keywordflow}{return}\ \_placed.\_y;}
\DoxyCodeLine{00488\ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00494\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_a226661021082992d71bb21745f3764b1}{TexturePlacement::}}}
\DoxyCodeLine{00495\ \mbox{\hyperlink{classTexturePlacement_a226661021082992d71bb21745f3764b1}{get\_placed\_x\_size}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00496\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ 0);}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{return}\ \_placed.\_x\_size;}
\DoxyCodeLine{00498\ \}}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00504\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_af054d3170ab5fb8518c5c22592d08481}{TexturePlacement::}}}
\DoxyCodeLine{00505\ \mbox{\hyperlink{classTexturePlacement_af054d3170ab5fb8518c5c22592d08481}{get\_placed\_y\_size}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00506\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ 0);}
\DoxyCodeLine{00507\ \ \ \textcolor{keywordflow}{return}\ \_placed.\_y\_size;}
\DoxyCodeLine{00508\ \}}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00514\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classTexturePlacement_a112615572c9691124091e18546b7fc14}{TexturePlacement::}}}
\DoxyCodeLine{00515\ \mbox{\hyperlink{classTexturePlacement_a112615572c9691124091e18546b7fc14}{get\_placed\_uv\_area}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00516\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ 0);}
\DoxyCodeLine{00517\ \ \ LTexCoordd\ range\ =\ \_placed.\_max\_uv\ -\/\ \_placed.\_min\_uv;}
\DoxyCodeLine{00518\ \ \ \textcolor{keywordflow}{return}\ range[0]\ *\ range[1];}
\DoxyCodeLine{00519\ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00526\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a08775205397c24165b2c6c69550b9a6a}{TexturePlacement::}}}
\DoxyCodeLine{00527\ \mbox{\hyperlink{classTexturePlacement_a08775205397c24165b2c6c69550b9a6a}{place\_at}}(\mbox{\hyperlink{classPaletteImage}{PaletteImage}}\ *image,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{00528\ \ \ nassertv(!\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00529\ \ \ nassertv(\_size\_known);}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \_image\ =\ image;}
\DoxyCodeLine{00532\ \ \ \_is\_filled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00533\ \ \ \_position.\_x\ =\ x;}
\DoxyCodeLine{00534\ \ \ \_position.\_y\ =\ y;}
\DoxyCodeLine{00535\ \ \ \_placed\ =\ \_position;}
\DoxyCodeLine{00536\ \ \ \_omit\_reason\ =\ OR\_none;}
\DoxyCodeLine{00537\ \}}
\DoxyCodeLine{00538\ }
\DoxyCodeLine{00544\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{TexturePlacement::}}}
\DoxyCodeLine{00545\ \mbox{\hyperlink{classTexturePlacement_ae4d9b7eef5c0b3458b030d685b90c9e0}{force\_replace}}()\ \{}
\DoxyCodeLine{00546\ \ \ \textcolor{keywordflow}{if}\ (\_image\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00547\ \ \ \ \ \_image-\/>\mbox{\hyperlink{classPaletteImage_a107c5eae7771191c7237712db291098d}{unplace}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00548\ \ \ \ \ \_image\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00549\ \ \ \}}
\DoxyCodeLine{00550\ \ \ \textcolor{keywordflow}{if}\ (\_omit\_reason\ ==\ OR\_none)\ \{}
\DoxyCodeLine{00551\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{mark\_eggs\_stale}}();}
\DoxyCodeLine{00552\ \ \ \}}
\DoxyCodeLine{00553\ \ \ \_omit\_reason\ =\ OR\_working;}
\DoxyCodeLine{00554\ \}}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00562\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_ad25c186c28a31aff6a68eb9577a128c7}{TexturePlacement::}}}
\DoxyCodeLine{00563\ \mbox{\hyperlink{classTexturePlacement_ad25c186c28a31aff6a68eb9577a128c7}{omit\_solitary}}()\ \{}
\DoxyCodeLine{00564\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordflow}{if}\ (\_omit\_reason\ !=\ OR\_solitary)\ \{}
\DoxyCodeLine{00566\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{mark\_eggs\_stale}}();}
\DoxyCodeLine{00567\ \ \ \ \ \_omit\_reason\ =\ OR\_solitary;}
\DoxyCodeLine{00568\ \ \ \}}
\DoxyCodeLine{00569\ \}}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00575\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_ad48b527e643bdde33c344f1a59671b37}{TexturePlacement::}}}
\DoxyCodeLine{00576\ \mbox{\hyperlink{classTexturePlacement_ad48b527e643bdde33c344f1a59671b37}{not\_solitary}}()\ \{}
\DoxyCodeLine{00577\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00578\ \ \ \textcolor{keywordflow}{if}\ (\_omit\_reason\ !=\ OR\_none)\ \{}
\DoxyCodeLine{00579\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a4020c6df82e9f5fbfc5a6cf20c6b9af0}{mark\_eggs\_stale}}();}
\DoxyCodeLine{00580\ \ \ \ \ \_omit\_reason\ =\ OR\_none;}
\DoxyCodeLine{00581\ \ \ \}}
\DoxyCodeLine{00582\ \}}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00589\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexturePlacement_a4f26aa2d38310c1d91c9853915b621f5}{TexturePlacement::}}}
\DoxyCodeLine{00590\ \mbox{\hyperlink{classTexturePlacement_a4f26aa2d38310c1d91c9853915b621f5}{intersects}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{00591\ \ \ nassertr(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \textcolor{keywordtype}{int}\ hright\ =\ x\ +\ x\_size;}
\DoxyCodeLine{00594\ \ \ \textcolor{keywordtype}{int}\ hbot\ =\ y\ +\ y\_size;}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \textcolor{keywordtype}{int}\ mright\ =\ \_placed.\_x\ +\ \_placed.\_x\_size;}
\DoxyCodeLine{00597\ \ \ \textcolor{keywordtype}{int}\ mbot\ =\ \_placed.\_y\ +\ \_placed.\_y\_size;}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{return}\ !(x\ >=\ mright\ ||\ hright\ <=\ \_placed.\_x\ ||}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \ y\ >=\ mbot\ ||\ hbot\ <=\ \_placed.\_y);}
\DoxyCodeLine{00601\ \}}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00607\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_aad73f28e7278bb09eb3a3166a6a4453f}{TexturePlacement::}}}
\DoxyCodeLine{00608\ \mbox{\hyperlink{classTexturePlacement_aad73f28e7278bb09eb3a3166a6a4453f}{compute\_tex\_matrix}}(LMatrix3d\ \&transform)\ \{}
\DoxyCodeLine{00609\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00610\ }
\DoxyCodeLine{00611\ \ \ LMatrix3d\ source\_uvs\ =\ LMatrix3d::ident\_mat();}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \ \ LTexCoordd\ range\ =\ \_placed.\_max\_uv\ -\/\ \_placed.\_min\_uv;}
\DoxyCodeLine{00614\ \ \ \textcolor{keywordflow}{if}\ (range[0]\ !=\ 0.0\ \&\&\ range[1]\ !=\ 0.0)\ \{}
\DoxyCodeLine{00615\ \ \ \ \ source\_uvs\ =}
\DoxyCodeLine{00616\ \ \ \ \ \ \ LMatrix3d::translate\_mat(-\/\_placed.\_min\_uv)\ *}
\DoxyCodeLine{00617\ \ \ \ \ \ \ LMatrix3d::scale\_mat(1.0\ /\ range[0],\ 1.0\ /\ range[1]);}
\DoxyCodeLine{00618\ \ \ \}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \textcolor{keywordtype}{int}\ top\ =\ \_placed.\_y\ +\ \_placed.\_margin;}
\DoxyCodeLine{00621\ \ \ \textcolor{keywordtype}{int}\ left\ =\ \_placed.\_x\ +\ \_placed.\_margin;}
\DoxyCodeLine{00622\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ \_placed.\_x\_size\ -\/\ \_placed.\_margin\ *\ 2;}
\DoxyCodeLine{00623\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ \_placed.\_y\_size\ -\/\ \_placed.\_margin\ *\ 2;}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ top\ +\ y\_size;}
\DoxyCodeLine{00626\ \ \ \textcolor{keywordtype}{int}\ pal\_x\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_a46db3bdd06728c9e0eb072de9c443971}{get\_x\_size}}();}
\DoxyCodeLine{00627\ \ \ \textcolor{keywordtype}{int}\ pal\_y\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_aa148095591a031e70c277afc701285de}{get\_y\_size}}();}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ LVecBase2d\ t((\textcolor{keywordtype}{double})left\ /\ (\textcolor{keywordtype}{double})pal\_x\_size,}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})(pal\_y\_size\ -\/\ bottom)\ /\ (\textcolor{keywordtype}{double})pal\_y\_size);}
\DoxyCodeLine{00631\ \ \ LVecBase2d\ s((\textcolor{keywordtype}{double})x\_size\ /\ (\textcolor{keywordtype}{double})pal\_x\_size,}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{double})y\_size\ /\ (\textcolor{keywordtype}{double})pal\_y\_size);}
\DoxyCodeLine{00633\ }
\DoxyCodeLine{00634\ \ \ LMatrix3d\ dest\_uvs}
\DoxyCodeLine{00635\ \ \ \ \ (s[0],\ \ 0.0,\ \ 0.0,}
\DoxyCodeLine{00636\ \ \ \ \ \ 0.0,\ s[1],\ \ 0.0,}
\DoxyCodeLine{00637\ \ \ \ \ \ t[0],\ t[1],\ \ 1.0);}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ transform\ =\ source\_uvs\ *\ dest\_uvs;}
\DoxyCodeLine{00640\ \}}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00645\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a07233b87b243fb5b7de296c321552323}{TexturePlacement::}}}
\DoxyCodeLine{00646\ \mbox{\hyperlink{classTexturePlacement_a07233b87b243fb5b7de296c321552323}{write\_placed}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\ \{}
\DoxyCodeLine{00647\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00648\ \ \ \ \ <<\ \mbox{\hyperlink{classTexturePlacement_ac41838d62b321927f6d0134d0fe2677b}{get\_texture}}()-\/>get\_name();}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}())\ \{}
\DoxyCodeLine{00651\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ at\ "{}}}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ <<\ \mbox{\hyperlink{classTexturePlacement_aaadd8def245d012b5ee682d9decb280f}{get\_placed\_x}}()\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \mbox{\hyperlink{classTexturePlacement_aaee64b89c9d2c96799da8614a8058948}{get\_placed\_y}}()\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ <<\ \mbox{\hyperlink{classTexturePlacement_aaadd8def245d012b5ee682d9decb280f}{get\_placed\_x}}()\ +\ \mbox{\hyperlink{classTexturePlacement_a226661021082992d71bb21745f3764b1}{get\_placed\_x\_size}}()\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ <<\ \mbox{\hyperlink{classTexturePlacement_aaee64b89c9d2c96799da8614a8058948}{get\_placed\_y}}()\ +\ \mbox{\hyperlink{classTexturePlacement_af054d3170ab5fb8518c5c22592d08481}{get\_placed\_y\_size}}()\ <<\ \textcolor{stringliteral}{"{}\ (coverage\ "{}}}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ <<\ \mbox{\hyperlink{classTexturePlacement_a112615572c9691124091e18546b7fc14}{get\_placed\_uv\_area}}()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00656\ }
\DoxyCodeLine{00657\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_placed.\_wrap\_u\ !=\ EggTexture::WM\_unspecified\ ||}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \_placed.\_wrap\_v\ !=\ EggTexture::WM\_unspecified)\ \{}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_placed.\_wrap\_u\ !=\ \_placed.\_wrap\_v)\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ ("{}}\ <<\ \_placed.\_wrap\_u\ <<\ \textcolor{stringliteral}{"{},\ "{}}\ <<\ \_placed.\_wrap\_v\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \_placed.\_wrap\_u;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00664\ \ \ \ \ \}}
\DoxyCodeLine{00665\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00666\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00667\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ not\ yet\ placed.\(\backslash\)n"{}};}
\DoxyCodeLine{00668\ \ \ \}}
\DoxyCodeLine{00669\ \};}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00675\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classTexturePlacement_a13a2e35b5c866a6d2ceeb45690bc3c18}{TexturePlacement::}}}
\DoxyCodeLine{00676\ \mbox{\hyperlink{classTexturePlacement_a13a2e35b5c866a6d2ceeb45690bc3c18}{is\_filled}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00677\ \ \ \textcolor{keywordflow}{return}\ \_is\_filled;}
\DoxyCodeLine{00678\ \}}
\DoxyCodeLine{00679\ }
\DoxyCodeLine{00684\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_aa52aedbe95a1d108d144566a3e4e3097}{TexturePlacement::}}}
\DoxyCodeLine{00685\ \mbox{\hyperlink{classTexturePlacement_aa52aedbe95a1d108d144566a3e4e3097}{mark\_unfilled}}()\ \{}
\DoxyCodeLine{00686\ \ \ \_is\_filled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00687\ \}}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00693\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_ac6411569eda256f150d97e7f9bce2439}{TexturePlacement::}}}
\DoxyCodeLine{00694\ \mbox{\hyperlink{classTexturePlacement_ac6411569eda256f150d97e7f9bce2439}{fill\_image}}(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&image)\ \{}
\DoxyCodeLine{00695\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00696\ }
\DoxyCodeLine{00697\ \ \ \_is\_filled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{comment}{//\ We\ determine\ the\ pixels\ to\ place\ the\ source\ image\ at\ by\ transforming\ the}}
\DoxyCodeLine{00700\ \ \ \textcolor{comment}{//\ unit\ texture\ box:\ the\ upper-\/left\ and\ lower-\/right\ corners.\ \ These\ corners,}}
\DoxyCodeLine{00701\ \ \ \textcolor{comment}{//\ in\ the\ final\ texture\ coordinate\ space,\ represent\ where\ on\ the\ palette}}
\DoxyCodeLine{00702\ \ \ \textcolor{comment}{//\ image\ the\ original\ texture\ should\ be\ located.}}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ LMatrix3d\ transform;}
\DoxyCodeLine{00705\ \ \ \mbox{\hyperlink{classTexturePlacement_aad73f28e7278bb09eb3a3166a6a4453f}{compute\_tex\_matrix}}(transform);}
\DoxyCodeLine{00706\ \ \ LTexCoordd\ ul\ =\ LTexCoordd(0.0,\ 1.0)\ *\ transform;}
\DoxyCodeLine{00707\ \ \ LTexCoordd\ lr\ =\ LTexCoordd(1.0,\ 0.0)\ *\ transform;}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \textcolor{comment}{//\ Now\ we\ convert\ those\ texture\ coordinates\ back\ to\ pixel\ units.}}
\DoxyCodeLine{00710\ \ \ \textcolor{keywordtype}{int}\ pal\_x\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_a46db3bdd06728c9e0eb072de9c443971}{get\_x\_size}}();}
\DoxyCodeLine{00711\ \ \ \textcolor{keywordtype}{int}\ pal\_y\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_aa148095591a031e70c277afc701285de}{get\_y\_size}}();}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \textcolor{keywordtype}{int}\ top\ =\ (int)floor((1.0\ -\/\ ul[1])\ *\ pal\_y\_size\ +\ 0.5);}
\DoxyCodeLine{00714\ \ \ \textcolor{keywordtype}{int}\ left\ =\ (int)floor(ul[0]\ *\ pal\_x\_size\ +\ 0.5);}
\DoxyCodeLine{00715\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ (int)floor((1.0\ -\/\ lr[1])\ *\ pal\_y\_size\ +\ 0.5);}
\DoxyCodeLine{00716\ \ \ \textcolor{keywordtype}{int}\ right\ =\ (int)floor(lr[0]\ *\ pal\_x\_size\ +\ 0.5);}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \textcolor{comment}{//\ And\ now\ we\ can\ determine\ the\ size\ to\ scale\ the\ image\ to\ based\ on\ that.}}
\DoxyCodeLine{00719\ \ \ \textcolor{comment}{//\ This\ may\ not\ be\ the\ same\ as\ texture-\/>size()\ because\ of\ margins.}}
\DoxyCodeLine{00720\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ right\ -\/\ left;}
\DoxyCodeLine{00721\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ bottom\ -\/\ top;}
\DoxyCodeLine{00722\ \ \ nassertv(x\_size\ >=\ 0\ \&\&\ y\_size\ >=\ 0);}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \textcolor{comment}{//\ Now\ we\ get\ a\ PNMImage\ that\ represents\ the\ source\ texture\ at\ that\ size.}}
\DoxyCodeLine{00725\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&source\_full\ =\ \_texture-\/>\mbox{\hyperlink{classTextureImage_af4041f7f938c22100c277a513a423992}{read\_source\_image}}();}
\DoxyCodeLine{00726\ \ \ \textcolor{keywordflow}{if}\ (!source\_full.is\_valid())\ \{}
\DoxyCodeLine{00727\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a8f35ad354fa989c5230bbf386dda82a3}{flag\_error\_image}}(image);}
\DoxyCodeLine{00728\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00729\ \ \ \}}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ source(x\_size,\ y\_size,\ source\_full.get\_num\_channels(),}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_full.get\_maxval());}
\DoxyCodeLine{00733\ \ \ source.quick\_filter\_from(source\_full);}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \ \ \textcolor{keywordtype}{bool}\ alpha\ =\ image.has\_alpha();}
\DoxyCodeLine{00736\ \ \ \textcolor{keywordtype}{bool}\ source\_alpha\ =\ source.has\_alpha();}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ \textcolor{comment}{//\ Now\ copy\ the\ pixels.\ \ We\ do\ this\ by\ walking\ through\ the\ rectangular}}
\DoxyCodeLine{00739\ \ \ \textcolor{comment}{//\ region\ on\ the\ palette\ image\ that\ we\ have\ reserved\ for\ this\ texture;\ for}}
\DoxyCodeLine{00740\ \ \ \textcolor{comment}{//\ each\ pixel\ in\ this\ region,\ we\ determine\ its\ appropriate\ color\ based\ on}}
\DoxyCodeLine{00741\ \ \ \textcolor{comment}{//\ its\ relation\ to\ the\ actual\ texture\ image\ location\ (determined\ above),\ and}}
\DoxyCodeLine{00742\ \ \ \textcolor{comment}{//\ on\ whether\ the\ texture\ wraps\ or\ clamps.}}
\DoxyCodeLine{00743\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ \_placed.\_y;\ y\ <\ \_placed.\_y\ +\ \_placed.\_y\_size;\ y++)\ \{}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordtype}{int}\ sy\ =\ y\ -\/\ top;}
\DoxyCodeLine{00745\ }
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_placed.\_wrap\_v)\ \{}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_clamp:}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \textcolor{comment}{//\ Clamp\ at\ [0,\ y\_size).}}
\DoxyCodeLine{00749\ \ \ \ \ \ \ sy\ =\ max(min(sy,\ y\_size\ -\/\ 1),\ 0);}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_mirror:}
\DoxyCodeLine{00753\ \ \ \ \ \ \ sy\ =\ (sy\ <\ 0)\ ?\ (y\_size\ *\ 2)\ -\/\ 1\ -\/\ ((-\/sy\ -\/\ 1)\ \%\ (y\_size\ *\ 2))\ :\ sy\ \%\ (y\_size\ *\ 2);}
\DoxyCodeLine{00754\ \ \ \ \ \ \ sy\ =\ (sy\ <\ y\_size)\ ?\ sy\ :\ 2\ *\ y\_size\ -\/\ sy\ -\/\ 1;}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_mirror\_once:}
\DoxyCodeLine{00758\ \ \ \ \ \ \ sy\ =\ (sy\ <\ y\_size)\ ?\ sy\ :\ 2\ *\ y\_size\ -\/\ sy\ -\/\ 1;}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \textcolor{comment}{//\ Fall\ through}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_border\_color:}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sy\ <\ 0\ ||\ sy\ >=\ y\_size)\ \{}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \textcolor{comment}{//\ Wrap:\ sign-\/independent\ modulo.}}
\DoxyCodeLine{00769\ \ \ \ \ \ \ sy\ =\ (sy\ <\ 0)\ ?\ y\_size\ -\/\ 1\ -\/\ ((-\/sy\ -\/\ 1)\ \%\ y\_size)\ :\ sy\ \%\ y\_size;}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00771\ \ \ \ \ \}}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ \_placed.\_x;\ x\ <\ \_placed.\_x\ +\ \_placed.\_x\_size;\ x++)\ \{}
\DoxyCodeLine{00774\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sx\ =\ x\ -\/\ left;}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_placed.\_wrap\_u)\ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_clamp:}
\DoxyCodeLine{00778\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clamp\ at\ [0,\ x\_size).}}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ sx\ =\ max(min(sx,\ x\_size\ -\/\ 1),\ 0);}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_mirror:}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ sx\ =\ (sx\ <\ 0)\ ?\ (x\_size\ *\ 2)\ -\/\ 1\ -\/\ ((-\/sx\ -\/\ 1)\ \%\ (x\_size\ *\ 2))\ :\ sx\ \%\ (x\_size\ *\ 2);}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ sx\ =\ (sx\ <\ x\_size)\ ?\ sx\ :\ 2\ *\ x\_size\ -\/\ sx\ -\/\ 1;}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_mirror\_once:}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ sx\ =\ (sx\ >=\ 0)\ ?\ sx\ :\ \string~sx;}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Fall\ through}}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ EggTexture::WM\_border\_color:}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sx\ <\ 0\ ||\ sx\ >=\ x\_size)\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wrap:\ sign-\/independent\ modulo.}}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ sx\ =\ (sx\ <\ 0)\ ?\ x\_size\ -\/\ 1\ -\/\ ((-\/sx\ -\/\ 1)\ \%\ x\_size)\ :\ sx\ \%\ x\_size;}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00802\ }
\DoxyCodeLine{00803\ \ \ \ \ \ \ image.set\_xel(x,\ y,\ source.get\_xel(sx,\ sy));}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (source\_alpha)\ \{}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ source.get\_alpha(sx,\ sy));}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ 1.0);}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00811\ \ \ \ \ \}}
\DoxyCodeLine{00812\ \ \ \}}
\DoxyCodeLine{00813\ }
\DoxyCodeLine{00814\ \ \ \_texture-\/>\mbox{\hyperlink{classTextureImage_aae9f4fc9b1f166d84b7791d076494029}{release\_source\_image}}();}
\DoxyCodeLine{00815\ \}}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ }
\DoxyCodeLine{00822\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a8ddbc545899e8329e4c47223084303f9}{TexturePlacement::}}}
\DoxyCodeLine{00823\ \mbox{\hyperlink{classTexturePlacement_a8ddbc545899e8329e4c47223084303f9}{fill\_swapped\_image}}(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&image,\ \textcolor{keywordtype}{int}\ index)\ \{}
\DoxyCodeLine{00824\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00826\ \ \ \_is\_filled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \textcolor{comment}{//\ We\ determine\ the\ pixels\ to\ place\ the\ source\ image\ at\ by\ transforming\ the}}
\DoxyCodeLine{00829\ \ \ \textcolor{comment}{//\ unit\ texture\ box:\ the\ upper-\/left\ and\ lower-\/right\ corners.\ \ These\ corners,}}
\DoxyCodeLine{00830\ \ \ \textcolor{comment}{//\ in\ the\ final\ texture\ coordinate\ space,\ represent\ where\ on\ the\ palette}}
\DoxyCodeLine{00831\ \ \ \textcolor{comment}{//\ image\ the\ original\ texture\ should\ be\ located.}}
\DoxyCodeLine{00832\ }
\DoxyCodeLine{00833\ \ \ LMatrix3d\ transform;}
\DoxyCodeLine{00834\ \ \ \mbox{\hyperlink{classTexturePlacement_aad73f28e7278bb09eb3a3166a6a4453f}{compute\_tex\_matrix}}(transform);}
\DoxyCodeLine{00835\ \ \ LTexCoordd\ ul\ =\ LTexCoordd(0.0,\ 1.0)\ *\ transform;}
\DoxyCodeLine{00836\ \ \ LTexCoordd\ lr\ =\ LTexCoordd(1.0,\ 0.0)\ *\ transform;}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \ \ \textcolor{comment}{//\ Now\ we\ convert\ those\ texture\ coordinates\ back\ to\ pixel\ units.}}
\DoxyCodeLine{00839\ \ \ \textcolor{keywordtype}{int}\ pal\_x\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_a46db3bdd06728c9e0eb072de9c443971}{get\_x\_size}}();}
\DoxyCodeLine{00840\ \ \ \textcolor{keywordtype}{int}\ pal\_y\_size\ =\ \_image-\/>\mbox{\hyperlink{classImageFile_aa148095591a031e70c277afc701285de}{get\_y\_size}}();}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \textcolor{keywordtype}{int}\ top\ =\ (int)floor((1.0\ -\/\ ul[1])\ *\ pal\_y\_size\ +\ 0.5);}
\DoxyCodeLine{00843\ \ \ \textcolor{keywordtype}{int}\ left\ =\ (int)floor(ul[0]\ *\ pal\_x\_size\ +\ 0.5);}
\DoxyCodeLine{00844\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ (int)floor((1.0\ -\/\ lr[1])\ *\ pal\_y\_size\ +\ 0.5);}
\DoxyCodeLine{00845\ \ \ \textcolor{keywordtype}{int}\ right\ =\ (int)floor(lr[0]\ *\ pal\_x\_size\ +\ 0.5);}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \textcolor{comment}{//\ And\ now\ we\ can\ determine\ the\ size\ to\ scale\ the\ image\ to\ based\ on\ that.}}
\DoxyCodeLine{00848\ \ \ \textcolor{comment}{//\ This\ may\ not\ be\ the\ same\ as\ texture-\/>size()\ because\ of\ margins.}}
\DoxyCodeLine{00849\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ right\ -\/\ left;}
\DoxyCodeLine{00850\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ bottom\ -\/\ top;}
\DoxyCodeLine{00851\ \ \ nassertv(x\_size\ >=\ 0\ \&\&\ y\_size\ >=\ 0);}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \ \ \textcolor{comment}{//\ Now\ we\ get\ a\ PNMImage\ that\ represents\ the\ swapped\ texture\ at\ that\ size.}}
\DoxyCodeLine{00854\ \ \ TextureSwaps::iterator\ tsi;}
\DoxyCodeLine{00855\ \ \ tsi\ =\ \_textureSwaps.begin()\ +\ index;}
\DoxyCodeLine{00856\ \ \ \mbox{\hyperlink{classTextureImage}{TextureImage}}\ *swapTexture\ =\ (*tsi);}
\DoxyCodeLine{00857\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&source\_full\ =\ swapTexture-\/>\mbox{\hyperlink{classTextureImage_af4041f7f938c22100c277a513a423992}{read\_source\_image}}();}
\DoxyCodeLine{00858\ \ \ \textcolor{keywordflow}{if}\ (!source\_full.is\_valid())\ \{}
\DoxyCodeLine{00859\ \ \ \ \ \mbox{\hyperlink{classTexturePlacement_a8f35ad354fa989c5230bbf386dda82a3}{flag\_error\_image}}(image);}
\DoxyCodeLine{00860\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00861\ \ \ \}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ source(x\_size,\ y\_size,\ source\_full.get\_num\_channels(),}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ source\_full.get\_maxval());}
\DoxyCodeLine{00865\ \ \ source.quick\_filter\_from(source\_full);}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00867\ \ \ \textcolor{keywordtype}{bool}\ alpha\ =\ image.has\_alpha();}
\DoxyCodeLine{00868\ \ \ \textcolor{keywordtype}{bool}\ source\_alpha\ =\ source.has\_alpha();}
\DoxyCodeLine{00869\ }
\DoxyCodeLine{00870\ \ \ \textcolor{comment}{//\ Now\ copy\ the\ pixels.\ \ We\ do\ this\ by\ walking\ through\ the\ rectangular}}
\DoxyCodeLine{00871\ \ \ \textcolor{comment}{//\ region\ on\ the\ palette\ image\ that\ we\ have\ reserved\ for\ this\ texture;\ for}}
\DoxyCodeLine{00872\ \ \ \textcolor{comment}{//\ each\ pixel\ in\ this\ region,\ we\ determine\ its\ appropriate\ color\ based\ on}}
\DoxyCodeLine{00873\ \ \ \textcolor{comment}{//\ its\ relation\ to\ the\ actual\ texture\ image\ location\ (determined\ above),\ and}}
\DoxyCodeLine{00874\ \ \ \textcolor{comment}{//\ on\ whether\ the\ texture\ wraps\ or\ clamps.}}
\DoxyCodeLine{00875\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ \_placed.\_y;\ y\ <\ \_placed.\_y\ +\ \_placed.\_y\_size;\ y++)\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \textcolor{keywordtype}{int}\ sy\ =\ y\ -\/\ top;}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_placed.\_wrap\_v\ ==\ EggTexture::WM\_clamp)\ \{}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \textcolor{comment}{//\ Clamp\ at\ [0,\ y\_size).}}
\DoxyCodeLine{00880\ \ \ \ \ \ \ sy\ =\ max(min(sy,\ y\_size\ -\/\ 1),\ 0);}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00882\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \textcolor{comment}{//\ Wrap:\ sign-\/independent\ modulo.}}
\DoxyCodeLine{00884\ \ \ \ \ \ \ sy\ =\ (sy\ <\ 0)\ ?\ y\_size\ -\/\ 1\ -\/\ ((-\/sy\ -\/\ 1)\ \%\ y\_size)\ :\ sy\ \%\ y\_size;}
\DoxyCodeLine{00885\ \ \ \ \ \}}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ \_placed.\_x;\ x\ <\ \_placed.\_x\ +\ \_placed.\_x\_size;\ x++)\ \{}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sx\ =\ x\ -\/\ left;}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00890\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_placed.\_wrap\_u\ ==\ EggTexture::WM\_clamp)\ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Clamp\ at\ [0,\ x\_size).}}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ sx\ =\ max(min(sx,\ x\_size\ -\/\ 1),\ 0);}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wrap:\ sign-\/independent\ modulo.}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ sx\ =\ (sx\ <\ 0)\ ?\ x\_size\ -\/\ 1\ -\/\ ((-\/sx\ -\/\ 1)\ \%\ x\_size)\ :\ sx\ \%\ x\_size;}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \ \ \ \ \ \ image.set\_xel(x,\ y,\ source.get\_xel(sx,\ sy));}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (alpha)\ \{}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (source\_alpha)\ \{}
\DoxyCodeLine{00902\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ source.get\_alpha(sx,\ sy));}
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ \ image.set\_alpha(x,\ y,\ 1.0);}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00907\ \ \ \ \ \}}
\DoxyCodeLine{00908\ \ \ \}}
\DoxyCodeLine{00909\ }
\DoxyCodeLine{00910\ \ \ swapTexture-\/>\mbox{\hyperlink{classTextureImage_aae9f4fc9b1f166d84b7791d076494029}{release\_source\_image}}();}
\DoxyCodeLine{00911\ \}}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00917\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a8f35ad354fa989c5230bbf386dda82a3}{TexturePlacement::}}}
\DoxyCodeLine{00918\ \mbox{\hyperlink{classTexturePlacement_a8f35ad354fa989c5230bbf386dda82a3}{flag\_error\_image}}(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&image)\ \{}
\DoxyCodeLine{00919\ \ \ nassertv(\mbox{\hyperlink{classTexturePlacement_ac3abdcb1d5941926a942b33f1a80a261}{is\_placed}}());}
\DoxyCodeLine{00920\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ \_placed.\_y;\ y\ <\ \_placed.\_y\ +\ \_placed.\_y\_size;\ y++)\ \{}
\DoxyCodeLine{00921\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ \_placed.\_x;\ x\ <\ \_placed.\_x\ +\ \_placed.\_x\_size;\ x++)\ \{}
\DoxyCodeLine{00922\ \ \ \ \ \ \ image.set\_xel\_val(x,\ y,\ 1,\ 0,\ 0);}
\DoxyCodeLine{00923\ \ \ \ \ \}}
\DoxyCodeLine{00924\ \ \ \}}
\DoxyCodeLine{00925\ \ \ \textcolor{keywordflow}{if}\ (image.has\_alpha())\ \{}
\DoxyCodeLine{00926\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ \_placed.\_y;\ y\ <\ \_placed.\_y\ +\ \_placed.\_y\_size;\ y++)\ \{}
\DoxyCodeLine{00927\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ \_placed.\_x;\ x\ <\ \_placed.\_x\ +\ \_placed.\_x\_size;\ x++)\ \{}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ image.set\_alpha\_val(x,\ y,\ 1);}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00930\ \ \ \ \ \}}
\DoxyCodeLine{00931\ \ \ \}}
\DoxyCodeLine{00932\ \}}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00939\ \textcolor{keywordtype}{void}\ TexturePlacement::}
\DoxyCodeLine{00940\ compute\_size\_from\_uvs(\textcolor{keyword}{const}\ LTexCoordd\ \&min\_uv,\ \textcolor{keyword}{const}\ LTexCoordd\ \&max\_uv)\ \{}
\DoxyCodeLine{00941\ \ \ \_position.\_min\_uv\ =\ min\_uv;}
\DoxyCodeLine{00942\ \ \ \_position.\_max\_uv\ =\ max\_uv;}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ LTexCoordd\ range\ =\ \_position.\_max\_uv\ -\/\ \_position.\_min\_uv;}
\DoxyCodeLine{00945\ \ \ \textcolor{comment}{//\ cout\ <<\ "{}range:\ "{}\ <<\ range\ <<\ endl;}}
\DoxyCodeLine{00946\ }
\DoxyCodeLine{00947\ \ \ \textcolor{comment}{//\ cout\ <<\ "{}\_x\_size\ texture:\ "{}\ <<\ \_texture-\/>get\_x\_size()\ <<\ endl;\ cout\ <<}}
\DoxyCodeLine{00948\ \ \ \textcolor{comment}{//\ "{}\_y\_size\ texture:\ "{}\ <<\ \_texture-\/>get\_y\_size()\ <<\ endl;}}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00950\ \ \ \_position.\_x\_size\ =\ (int)floor(\_texture-\/>\mbox{\hyperlink{classImageFile_a46db3bdd06728c9e0eb072de9c443971}{get\_x\_size}}()\ *\ range[0]\ +\ 0.5);}
\DoxyCodeLine{00951\ \ \ \_position.\_y\_size\ =\ (int)floor(\_texture-\/>\mbox{\hyperlink{classImageFile_aa148095591a031e70c277afc701285de}{get\_y\_size}}()\ *\ range[1]\ +\ 0.5);}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00953\ \ \ \textcolor{comment}{//\ cout\ <<\ "{}\_x\_size:\ "{}\ <<\ \_position.\_x\_size\ <<\ endl;\ cout\ <<\ "{}\_y\_size:\ "{}\ <<}}
\DoxyCodeLine{00954\ \ \ \textcolor{comment}{//\ \_position.\_y\_size\ <<\ endl;}}
\DoxyCodeLine{00955\ }
\DoxyCodeLine{00956\ \ \ \textcolor{comment}{//\ We\ arbitrarily\ require\ at\ least\ four\ pixels\ in\ each\ dimension.\ \ Fewer}}
\DoxyCodeLine{00957\ \ \ \textcolor{comment}{//\ than\ this\ may\ be\ asking\ for\ trouble.}}
\DoxyCodeLine{00958\ \ \ \_position.\_x\_size\ =\ max(\_position.\_x\_size,\ 4);}
\DoxyCodeLine{00959\ \ \ \_position.\_y\_size\ =\ max(\_position.\_y\_size,\ 4);}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{classTexturePlacement_a1decbbaa8abd60a3c1bf14d4c46ffd88}{get\_group}}()-\/>has\_margin\_override())\ \{}
\DoxyCodeLine{00962\ \ \ \ \ \_position.\_margin\ =\ \mbox{\hyperlink{classTexturePlacement_a1decbbaa8abd60a3c1bf14d4c46ffd88}{get\_group}}()-\/>\mbox{\hyperlink{classPaletteGroup_a5facbd5ce79b6598b8721c77ae74493f}{get\_margin\_override}}();}
\DoxyCodeLine{00963\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00964\ \ \ \ \ \_position.\_margin\ =\ \_texture-\/>\mbox{\hyperlink{classTextureImage_a7b998fe13b2de5d19e80c415a2259af6}{get\_margin}}();}
\DoxyCodeLine{00965\ \ \ \}}
\DoxyCodeLine{00966\ \ \ \textcolor{comment}{//\ cout\ <<\ "{}margin:\ "{}\ <<\ \_position.\_margin\ <<\ endl;}}
\DoxyCodeLine{00967\ }
\DoxyCodeLine{00968\ \ \ \textcolor{comment}{//\ Normally,\ we\ have\ interior\ margins,\ but\ if\ the\ image\ size\ is\ too\ small-\/-\/}}
\DoxyCodeLine{00969\ \ \ \textcolor{comment}{//\ i.e.\ \ the\ margin\ size\ is\ too\ great\ a\ percentage\ of\ the\ image\ size-\/-\/we'll}}
\DoxyCodeLine{00970\ \ \ \textcolor{comment}{//\ make\ them\ exterior\ margins\ so\ as\ not\ to\ overly\ degrade\ the\ quality\ of\ the}}
\DoxyCodeLine{00971\ \ \ \textcolor{comment}{//\ image.}}
\DoxyCodeLine{00972\ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{double})\_position.\_margin\ /\ (\textcolor{keywordtype}{double})\_position.\_x\_size\ >\ 0.10)\ \{}
\DoxyCodeLine{00973\ \ \ \ \ \_position.\_x\_size\ +=\ \_position.\_margin\ *\ 2;}
\DoxyCodeLine{00974\ \ \ \}}
\DoxyCodeLine{00975\ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{double})\_position.\_margin\ /\ (\textcolor{keywordtype}{double})\_position.\_y\_size\ >\ 0.10)\ \{}
\DoxyCodeLine{00976\ \ \ \ \ \_position.\_y\_size\ +=\ \_position.\_margin\ *\ 2;}
\DoxyCodeLine{00977\ \ \ \}}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \ \ \_size\_known\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00980\ \}}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00982\ }
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00987\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a6f95c2df4212278c84538d4ad7c45f3e}{TexturePlacement::}}}
\DoxyCodeLine{00988\ \mbox{\hyperlink{classTexturePlacement_a6f95c2df4212278c84538d4ad7c45f3e}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00989\ \ \ BamReader::get\_factory()-\/>}
\DoxyCodeLine{00990\ \ \ \ \ register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classTexturePlacement_a8f0999e3f6b26914d56c9558deaf50e2}{make\_from\_bam}});}
\DoxyCodeLine{00991\ \}}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00997\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a716a9d3d5edb424779e4e5815e9d329b}{TexturePlacement::}}}
\DoxyCodeLine{00998\ \mbox{\hyperlink{classTexturePlacement_a716a9d3d5edb424779e4e5815e9d329b}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *writer,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram)\ \{}
\DoxyCodeLine{00999\ \ \ TypedWritable::write\_datagram(writer,\ datagram);}
\DoxyCodeLine{01000\ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ \_texture);}
\DoxyCodeLine{01001\ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ \_group);}
\DoxyCodeLine{01002\ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ \_image);}
\DoxyCodeLine{01003\ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ \_dest);}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01005\ \ \ datagram.add\_bool(\_has\_uvs);}
\DoxyCodeLine{01006\ \ \ datagram.add\_bool(\_size\_known);}
\DoxyCodeLine{01007\ \ \ \_position.\mbox{\hyperlink{classTexturePosition_a69d42b6188f9799a6c3c6ff188bcbaba}{write\_datagram}}(writer,\ datagram);}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01009\ \ \ datagram.add\_bool(\_is\_filled);}
\DoxyCodeLine{01010\ \ \ \_placed.\mbox{\hyperlink{classTexturePosition_a69d42b6188f9799a6c3c6ff188bcbaba}{write\_datagram}}(writer,\ datagram);}
\DoxyCodeLine{01011\ \ \ datagram.add\_int32((\textcolor{keywordtype}{int})\_omit\_reason);}
\DoxyCodeLine{01012\ }
\DoxyCodeLine{01013\ \ \ datagram.add\_int32(\_references.size());}
\DoxyCodeLine{01014\ \ \ References::const\_iterator\ ri;}
\DoxyCodeLine{01015\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ \_references.begin();\ ri\ !=\ \_references.end();\ ++ri)\ \{}
\DoxyCodeLine{01016\ \ \ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ (*ri));}
\DoxyCodeLine{01017\ \ \ \}}
\DoxyCodeLine{01018\ }
\DoxyCodeLine{01019\ \ \ datagram.add\_int32(\_textureSwaps.size());}
\DoxyCodeLine{01020\ \ \ TextureSwaps::const\_iterator\ tsi;}
\DoxyCodeLine{01021\ \ \ \textcolor{keywordflow}{for}\ (tsi\ =\ \_textureSwaps.begin();\ tsi\ !=\ \_textureSwaps.end();\ ++tsi)\ \{}
\DoxyCodeLine{01022\ \ \ \ \ writer-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(datagram,\ (*tsi));}
\DoxyCodeLine{01023\ \ \ \}}
\DoxyCodeLine{01024\ }
\DoxyCodeLine{01025\ \}}
\DoxyCodeLine{01026\ }
\DoxyCodeLine{01033\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTexturePlacement_a8c1ecaabfa63b267af791f179c2e11f1}{TexturePlacement::}}}
\DoxyCodeLine{01034\ \mbox{\hyperlink{classTexturePlacement_a8c1ecaabfa63b267af791f179c2e11f1}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{01035\ \ \ \textcolor{keywordtype}{int}\ index\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{TypedWritable::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{01036\ }
\DoxyCodeLine{01037\ \ \ \textcolor{keywordflow}{if}\ (p\_list[index]\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01038\ \ \ \ \ DCAST\_INTO\_R(\_texture,\ p\_list[index],\ index);}
\DoxyCodeLine{01039\ \ \ \}}
\DoxyCodeLine{01040\ \ \ index++;}
\DoxyCodeLine{01041\ }
\DoxyCodeLine{01042\ \ \ \textcolor{keywordflow}{if}\ (p\_list[index]\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01043\ \ \ \ \ DCAST\_INTO\_R(\_group,\ p\_list[index],\ index);}
\DoxyCodeLine{01044\ \ \ \}}
\DoxyCodeLine{01045\ \ \ index++;}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \textcolor{keywordflow}{if}\ (p\_list[index]\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01048\ \ \ \ \ DCAST\_INTO\_R(\_image,\ p\_list[index],\ index);}
\DoxyCodeLine{01049\ \ \ \}}
\DoxyCodeLine{01050\ \ \ index++;}
\DoxyCodeLine{01051\ }
\DoxyCodeLine{01052\ \ \ \textcolor{keywordflow}{if}\ (p\_list[index]\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01053\ \ \ \ \ DCAST\_INTO\_R(\_dest,\ p\_list[index],\ index);}
\DoxyCodeLine{01054\ \ \ \}}
\DoxyCodeLine{01055\ \ \ index++;}
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{01058\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \_num\_references;\ i++)\ \{}
\DoxyCodeLine{01059\ \ \ \ \ \mbox{\hyperlink{classTextureReference}{TextureReference}}\ *reference;}
\DoxyCodeLine{01060\ \ \ \ \ DCAST\_INTO\_R(reference,\ p\_list[index],\ index);}
\DoxyCodeLine{01061\ \ \ \ \ \_references.insert(reference);}
\DoxyCodeLine{01062\ \ \ \ \ index++;}
\DoxyCodeLine{01063\ \ \ \}}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \_num\_textureSwaps;\ i++)\ \{}
\DoxyCodeLine{01066\ \ \ \ \ \mbox{\hyperlink{classTextureImage}{TextureImage}}\ *swapTexture;}
\DoxyCodeLine{01067\ \ \ \ \ DCAST\_INTO\_R(swapTexture,\ p\_list[index],\ index);}
\DoxyCodeLine{01068\ \ \ \ \ \_textureSwaps.push\_back(swapTexture);}
\DoxyCodeLine{01069\ \ \ \ \ index++;}
\DoxyCodeLine{01070\ \ \ \}}
\DoxyCodeLine{01071\ }
\DoxyCodeLine{01072\ \ \ \textcolor{keywordflow}{return}\ index;}
\DoxyCodeLine{01073\ \}}
\DoxyCodeLine{01074\ }
\DoxyCodeLine{01080\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classTexturePlacement_a8f0999e3f6b26914d56c9558deaf50e2}{TexturePlacement::}}}
\DoxyCodeLine{01081\ \mbox{\hyperlink{classTexturePlacement_a8f0999e3f6b26914d56c9558deaf50e2}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{01082\ \ \ \mbox{\hyperlink{classTexturePlacement}{TexturePlacement}}\ *me\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexturePlacement}{TexturePlacement}};}
\DoxyCodeLine{01083\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{01084\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{01087\ \ \ me-\/>\mbox{\hyperlink{classTexturePlacement_a23846574a6aa8ff8a5190261cccb5d76}{fillin}}(scan,\ manager);}
\DoxyCodeLine{01088\ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{01089\ \}}
\DoxyCodeLine{01090\ }
\DoxyCodeLine{01095\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTexturePlacement_a23846574a6aa8ff8a5190261cccb5d76}{TexturePlacement::}}}
\DoxyCodeLine{01096\ \mbox{\hyperlink{classTexturePlacement_a23846574a6aa8ff8a5190261cccb5d76}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{01097\ \ \ \mbox{\hyperlink{classTypedWritable_a3ad6cc1cd23bc3783d83edb3302bb43c}{TypedWritable::fillin}}(scan,\ manager);}
\DoxyCodeLine{01098\ }
\DoxyCodeLine{01099\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);\ \ \textcolor{comment}{//\ \_texture}}
\DoxyCodeLine{01100\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);\ \ \textcolor{comment}{//\ \_group}}
\DoxyCodeLine{01101\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);\ \ \textcolor{comment}{//\ \_image}}
\DoxyCodeLine{01102\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);\ \ \textcolor{comment}{//\ \_dest}}
\DoxyCodeLine{01103\ }
\DoxyCodeLine{01104\ \ \ \_has\_uvs\ =\ scan.get\_bool();}
\DoxyCodeLine{01105\ \ \ \_size\_known\ =\ scan.get\_bool();}
\DoxyCodeLine{01106\ \ \ \_position.\mbox{\hyperlink{classTexturePosition_ac56d608b0a76a96997a936fa91b60b52}{fillin}}(scan,\ manager);}
\DoxyCodeLine{01107\ }
\DoxyCodeLine{01108\ \ \ \_is\_filled\ =\ scan.get\_bool();}
\DoxyCodeLine{01109\ \ \ \_placed.\mbox{\hyperlink{classTexturePosition_ac56d608b0a76a96997a936fa91b60b52}{fillin}}(scan,\ manager);}
\DoxyCodeLine{01110\ \ \ \_omit\_reason\ =\ (\mbox{\hyperlink{omitReason_8h_a30e2a7bcaf0d7900f654db1083fbfaa9}{OmitReason}})scan.get\_int32();}
\DoxyCodeLine{01111\ }
\DoxyCodeLine{01112\ \ \ \_num\_references\ =\ scan.get\_int32();}
\DoxyCodeLine{01113\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_a10ea3ed8500e58d80ff4c58e4f1771cb}{read\_pointers}}(scan,\ \_num\_references);}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01115\ \ \ \textcolor{keywordflow}{if}\ (Palettizer::\_read\_pi\_version\ >=\ 20)\ \{}
\DoxyCodeLine{01116\ \ \ \ \ \_num\_textureSwaps\ =\ scan.get\_int32();}
\DoxyCodeLine{01117\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01118\ \ \ \ \ \_num\_textureSwaps\ =\ 0;}
\DoxyCodeLine{01119\ \ \ \}}
\DoxyCodeLine{01120\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_a10ea3ed8500e58d80ff4c58e4f1771cb}{read\_pointers}}(scan,\ \_num\_textureSwaps);}
\DoxyCodeLine{01121\ \}}
\DoxyCodeLine{01122\ }
\DoxyCodeLine{01123\ }
\DoxyCodeLine{01128\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classSortPlacementBySize_a2a5a593db9ad35ff38b99a87e7f49cdc}{SortPlacementBySize::}}}
\DoxyCodeLine{01129\ \mbox{\hyperlink{classSortPlacementBySize_a2a5a593db9ad35ff38b99a87e7f49cdc}{operator\ ()}}(\mbox{\hyperlink{classTexturePlacement}{TexturePlacement}}\ *a,\ \mbox{\hyperlink{classTexturePlacement}{TexturePlacement}}\ *b)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01130\ \ \ \textcolor{keywordflow}{if}\ (a-\/>get\_y\_size()\ <\ b-\/>get\_y\_size())\ \{}
\DoxyCodeLine{01131\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (b-\/>get\_y\_size()\ <\ a-\/>get\_y\_size())\ \{}
\DoxyCodeLine{01134\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (a-\/>get\_x\_size()\ <\ b-\/>get\_x\_size())\ \{}
\DoxyCodeLine{01137\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01138\ }
\DoxyCodeLine{01139\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (b-\/>get\_x\_size()\ <\ a-\/>get\_x\_size())\ \{}
\DoxyCodeLine{01140\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01141\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (a-\/>get\_name()\ <\ b-\/>get\_name())\ \{}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{comment}{//\ use\ this\ fall\ through\ case\ to\ let\ alphabetically\ smaller\ textures\ show}}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{comment}{//\ up\ first}}
\DoxyCodeLine{01144\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01145\ \ \ \}}
\DoxyCodeLine{01146\ }
\DoxyCodeLine{01147\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01148\ \}}

\end{DoxyCode}
