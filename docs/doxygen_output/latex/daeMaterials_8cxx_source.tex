\doxysection{dae\+Materials.\+cxx}
\hypertarget{daeMaterials_8cxx_source}{}\label{daeMaterials_8cxx_source}\index{pandatool/src/daeegg/daeMaterials.cxx@{pandatool/src/daeegg/daeMaterials.cxx}}
\mbox{\hyperlink{daeMaterials_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{daeMaterials_8h}{daeMaterials.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__daeegg_8h}{config\_daeegg.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fcollada__utils_8h}{fcollada\_utils.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDocument.h>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDMaterial.h>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDEffect.h>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDTexture.h>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDEffectParameterSampler.h>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <FCDocument/FCDImage.h>}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{filename_8h}{filename.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{keyword}{using\ }std::endl;}
\DoxyCodeLine{00029\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ DaeMaterials::\_type\_handle;}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{//\ luminance\ function,\ based\ on\ the\ ISOCIE\ color\ standards\ see\ ITU-\/R}}
\DoxyCodeLine{00034\ \textcolor{comment}{//\ Recommendation\ BT.709-\/4}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#define\ luminance(c)\ ((c[0]\ *\ 0.212671\ +\ c[1]\ *\ 0.715160\ +\ c[2]\ *\ 0.072169))}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00040\ DaeMaterials::}
\DoxyCodeLine{00041\ DaeMaterials(\textcolor{keyword}{const}\ FCDGeometryInstance*\ geometry\_instance)\ \{}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ mi\ =\ 0;\ mi\ <\ geometry\_instance-\/>GetMaterialInstanceCount();\ ++mi)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{classDaeMaterials_a340f2006a9fde64e6c84949c0ddae5d0}{add\_material\_instance}}(geometry\_instance-\/>GetMaterialInstance(mi));}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classDaeMaterials_a340f2006a9fde64e6c84949c0ddae5d0}{DaeMaterials::add\_material\_instance}}(\textcolor{keyword}{const}\ FCDMaterialInstance*\ instance)\ \{}
\DoxyCodeLine{00051\ \ \ nassertv(instance\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00052\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic\ (FROM\_FSTRING(instance-\/>GetSemantic()));}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{if}\ (\_materials.count(semantic)\ >\ 0)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Ignoring\ duplicate\ material\ with\ semantic\ "{}}\ <<\ semantic\ <<\ endl;}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ \ \ \_materials[semantic]\ =\ \textcolor{keyword}{new}\ DaeMaterial();}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ Load\ in\ the\ uvsets}}
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ vib\ =\ 0;\ vib\ <\ instance-\/>GetVertexInputBindingCount();\ ++vib)\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keyword}{const}\ FCDMaterialInstanceBindVertexInput*\ mivib\ =\ instance-\/>GetVertexInputBinding(vib);}
\DoxyCodeLine{00062\ \ \ \ \ assert(mivib\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00063\ \ \ \ \ PT(DaeVertexInputBinding)\ bvi\ =\ \textcolor{keyword}{new}\ DaeVertexInputBinding();}
\DoxyCodeLine{00064\ \ \ \ \ bvi-\/>\_input\_set\ =\ mivib-\/>inputSet;}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#if\ FCOLLADA\_VERSION\ >=\ 0x00030005}}
\DoxyCodeLine{00066\ \ \ \ \ bvi-\/>\_input\_semantic\ =\ mivib-\/>GetInputSemantic();}
\DoxyCodeLine{00067\ \ \ \ \ bvi-\/>\_semantic\ =\ *mivib-\/>semantic;}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00069\ \ \ \ \ bvi-\/>\_input\_semantic\ =\ mivib-\/>inputSemantic;}
\DoxyCodeLine{00070\ \ \ \ \ bvi-\/>\_semantic\ =\ FROM\_FSTRING(mivib-\/>semantic);}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00072\ \ \ \ \ \_materials[semantic]-\/>\_uvsets.push\_back(bvi);}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \textcolor{comment}{//\ Handle\ the\ material\ stuff}}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_spam())\ \{}
\DoxyCodeLine{00077\ \ \ \ \ daeegg\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}Trying\ to\ process\ material\ with\ semantic\ "{}}\ <<\ semantic\ <<\ endl;}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ \ \ \mbox{\hyperlink{classPointerTo}{PT\_EggMaterial}}\ egg\_material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggMaterial}{EggMaterial}}(semantic);}
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{classpvector}{pvector<PT\_EggTexture>}}\ egg\_textures;}
\DoxyCodeLine{00081\ \ \ \textcolor{keyword}{const}\ FCDEffect*\ effect\ =\ instance-\/>GetMaterial()-\/>GetEffect();}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{if}\ (effect\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_debug())\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ daeegg\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}Ignoring\ material\ (semantic:\ "{}}\ <<\ semantic\ <<\ \textcolor{stringliteral}{"{})\ without\ assigned\ effect"{}}\ <<\ endl;}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ Grab\ the\ common\ profile\ effect}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keyword}{const}\ FCDEffectStandard*\ effect\_common\ =\ (FCDEffectStandard\ *)effect-\/>FindProfile(FUDaeProfileType::COMMON);}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{if}\ (effect\_common\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ daeegg\_cat.info()\ <<\ \textcolor{stringliteral}{"{}Ignoring\ effect\ referenced\ by\ material\ with\ semantic\ "{}}\ <<\ semantic}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ because\ it\ has\ no\ common\ profile"{}}\ <<\ endl;}
\DoxyCodeLine{00092\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_spam())\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ daeegg\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}Processing\ effect,\ material\ semantic\ is\ "{}}\ <<\ semantic\ <<\ endl;}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{comment}{//\ Set\ the\ material\ parameters}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ egg\_material-\/>set\_amb(TO\_COLOR(effect\_common-\/>GetAmbientColor()));}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ already\ process\ transparency\ using\ blend\ modes\ LVecBase4\ diffuse\ =}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \textcolor{comment}{//\ TO\_COLOR(effect\_common-\/>GetDiffuseColor());}}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \textcolor{comment}{//\ diffuse.set\_w(diffuse.get\_w()\ *\ (1.0f\ -\/}}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{comment}{//\ effect\_common-\/>GetOpacity()));\ egg\_material-\/>set\_diff(diffuse);}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ egg\_material-\/>set\_diff(TO\_COLOR(effect\_common-\/>GetDiffuseColor()));}
\DoxyCodeLine{00103\ \ \ \ \ \ \ egg\_material-\/>set\_emit(TO\_COLOR(effect\_common-\/>GetEmissionColor())\ *\ effect\_common-\/>GetEmissionFactor());}
\DoxyCodeLine{00104\ \ \ \ \ \ \ egg\_material-\/>set\_shininess(effect\_common-\/>GetShininess());}
\DoxyCodeLine{00105\ \ \ \ \ \ \ egg\_material-\/>set\_spec(TO\_COLOR(effect\_common-\/>GetSpecularColor()));}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ try\ to\ load\ in\ the\ textures}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::DIFFUSE,\ EggTexture::ET\_modulate);}
\DoxyCodeLine{00108\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::BUMP,\ EggTexture::ET\_normal);}
\DoxyCodeLine{00109\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::SPECULAR,\ EggTexture::ET\_modulate\_gloss);}
\DoxyCodeLine{00110\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::SPECULAR\_LEVEL,\ EggTexture::ET\_gloss);}
\DoxyCodeLine{00111\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::TRANSPARENT,\ EggTexture::ET\_unspecified,\ EggTexture::F\_alpha);}
\DoxyCodeLine{00112\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::EMISSION,\ EggTexture::ET\_add);}
\DoxyCodeLine{00113\ \textcolor{preprocessor}{\#if\ FCOLLADA\_VERSION\ <\ 0x00030005}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ process\_texture\_bucket(semantic,\ effect\_common,\ FUDaeTextureChannel::OPACITY,\ EggTexture::ET\_unspecified,\ EggTexture::F\_alpha);}
\DoxyCodeLine{00115\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{comment}{//\ Now,\ calculate\ the\ color\ blend\ stuff.}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \_materials[semantic]-\/>\_blend\ =\ convert\_blend(effect\_common-\/>GetTransparencyMode(),}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ TO\_COLOR(effect\_common-\/>GetTranslucencyColor()),}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ effect\_common-\/>GetTranslucencyFactor());}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ Find\ an\ <extra>\ tag\ to\ support\ some\ extra\ stuff\ from\ extensions}}
\DoxyCodeLine{00122\ \ \ \ \ process\_extra(semantic,\ effect-\/>GetExtra());}
\DoxyCodeLine{00123\ \ \ \}}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_spam())\ \{}
\DoxyCodeLine{00125\ \ \ \ \ daeegg\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}Found\ "{}}\ <<\ egg\_textures.size()\ <<\ \textcolor{stringliteral}{"{}\ textures\ in\ material"{}}\ <<\ endl;}
\DoxyCodeLine{00126\ \ \ \}}
\DoxyCodeLine{00127\ \ \ \_materials[semantic]-\/>\_egg\_material\ =\ egg\_material;}
\DoxyCodeLine{00128\ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00134\ \textcolor{keywordtype}{void}\ DaeMaterials::}
\DoxyCodeLine{00135\ process\_texture\_bucket(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic,\ \textcolor{keyword}{const}\ FCDEffectStandard*\ effect\_common,\ FUDaeTextureChannel::Channel\ bucket,\ EggTexture::EnvType\ envtype,\ EggTexture::Format\ format)\ \{}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ tx\ =\ 0;\ tx\ <\ effect\_common-\/>GetTextureCount(bucket);\ ++tx)\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keyword}{const}\ FCDImage*\ image\ =\ effect\_common-\/>GetTexture(bucket,\ tx)-\/>GetImage();}
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (image\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Texture\ references\ a\ nonexisting\ image!"{}}\ <<\ endl;}
\DoxyCodeLine{00140\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keyword}{const}\ FCDEffectParameterSampler*\ sampler\ =\ effect\_common-\/>GetTexture(bucket,\ tx)-\/>GetSampler();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{comment}{//\ FCollada\ only\ supplies\ absolute\ paths.\ \ We\ need\ to\ grab\ the\ document}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \textcolor{comment}{//\ location\ ourselves\ and\ make\ the\ image\ path\ absolute.}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ texpath;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (image-\/>GetDocument())\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ docpath\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(FROM\_FSTRING(image-\/>GetDocument()-\/>GetFileUrl()));}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ docpath.\mbox{\hyperlink{classFilename_aae0841e487db8763ec578db102d87bc6}{make\_canonical}}();}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ texpath\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(FROM\_FSTRING(image-\/>GetFilename()));}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ texpath.\mbox{\hyperlink{classFilename_aae0841e487db8763ec578db102d87bc6}{make\_canonical}}();}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ texpath.\mbox{\hyperlink{classFilename_ad4b5858950028cbfdba4e703f97e94c7}{make\_relative\_to}}(docpath.get\_dirname(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_debug())\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ daeegg\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}Found\ texture\ with\ path\ "{}}\ <<\ texpath\ <<\ endl;}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Never\ mind.}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ texpath\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(FROM\_FSTRING(image-\/>GetFilename()));}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \mbox{\hyperlink{classPointerTo}{PT\_EggTexture}}\ egg\_texture\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggTexture}{EggTexture}}(FROM\_FSTRING(image-\/>GetDaeId()),\ texpath.\mbox{\hyperlink{classFilename_ab497e6552fa7591e21bdb9ff16c19cde}{to\_os\_generic}}());}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ a\ set\ of\ UV\ coordinates}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{keyword}{const}\ FCDEffectParameterInt*\ uvset\ =\ effect\_common-\/>GetTexture(bucket,\ tx)-\/>GetSet();}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uvset\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_debug())\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ daeegg\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}Texture\ has\ uv\ name\ '"{}}\ <<\ FROM\_FSTRING(uvset-\/>GetSemantic())\ <<\ \textcolor{stringliteral}{"{}'\(\backslash\)n"{}};}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ uvset\_semantic\ (FROM\_FSTRING(uvset-\/>GetSemantic()));}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ set\ the\ UV\ name\ if\ this\ UV\ set\ actually\ exists.}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_materials[semantic]-\/>\_uvsets.size();\ ++i)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_materials[semantic]-\/>\_uvsets[i]-\/>\_semantic\ ==\ uvset\_semantic)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_uv\_name(uvset\_semantic);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ sampler\ stuff}}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sampler\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_texture\_type(\mbox{\hyperlink{classDaeMaterials_a2605be8d6853ba5d1bd1afaa8914356a}{convert\_texture\_type}}(sampler-\/>GetSamplerType()));}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_wrap\_u(\mbox{\hyperlink{classDaeMaterials_a437a2b9a0a77309f5af758965ed5ead5}{convert\_wrap\_mode}}(sampler-\/>GetWrapS()));}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sampler-\/>GetSamplerType()\ !=\ FCDEffectParameterSampler::SAMPLER1D)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_wrap\_v(\mbox{\hyperlink{classDaeMaterials_a437a2b9a0a77309f5af758965ed5ead5}{convert\_wrap\_mode}}(sampler-\/>GetWrapT()));}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sampler-\/>GetSamplerType()\ ==\ FCDEffectParameterSampler::SAMPLER3D)\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_wrap\_w(\mbox{\hyperlink{classDaeMaterials_a437a2b9a0a77309f5af758965ed5ead5}{convert\_wrap\_mode}}(sampler-\/>GetWrapP()));}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_minfilter(\mbox{\hyperlink{classDaeMaterials_aa9aeeb00426c96b61b7813472d84163b}{convert\_filter\_type}}(sampler-\/>GetMinFilter()));}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_magfilter(\mbox{\hyperlink{classDaeMaterials_aa9aeeb00426c96b61b7813472d84163b}{convert\_filter\_type}}(sampler-\/>GetMagFilter()));}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (envtype\ !=\ EggTexture::ET\_unspecified)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_env\_type(envtype);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (format\ !=\ EggTexture::F\_unspecified)\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ egg\_texture-\/>set\_format(format);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \_materials[semantic]-\/>\_egg\_textures.push\_back(egg\_texture);}
\DoxyCodeLine{00195\ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \}}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{void}\ DaeMaterials::}
\DoxyCodeLine{00204\ process\_extra(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic,\ \textcolor{keyword}{const}\ FCDExtra*\ extra)\ \{}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{if}\ (extra\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00206\ \ \ \textcolor{keyword}{const}\ FCDEType*\ etype\ =\ extra-\/>GetDefaultType();}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{if}\ (etype\ ==\ \textcolor{keyword}{nullptr})\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ et\ =\ 0;\ et\ <\ etype-\/>GetTechniqueCount();\ ++et)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keyword}{const}\ FCDENode*\ enode\ =\ ((\textcolor{keyword}{const}\ FCDENode*)(etype-\/>GetTechnique(et)))-\/>FindChildNode(\textcolor{stringliteral}{"{}double\_sided"{}});}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordflow}{if}\ (enode\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ content\ =\ \mbox{\hyperlink{string__utils_8cxx_a3101bc0142a49d9d11ad3f8cac766a2d}{trim}}(enode-\/>GetContent());}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (content\ ==\ \textcolor{stringliteral}{"{}1"{}}\ ||\ content\ ==\ \textcolor{stringliteral}{"{}true"{}})\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \_materials[semantic]-\/>\_double\_sided\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (content\ ==\ \textcolor{stringliteral}{"{}0"{}}\ ||\ content\ ==\ \textcolor{stringliteral}{"{}false"{}})\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \_materials[semantic]-\/>\_double\_sided\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Expected\ <double\_sided>\ tag\ to\ be\ either\ 1\ or\ 0,\ found\ '"{}}\ <<\ content\ <<\ \textcolor{stringliteral}{"{}'\ instead"{}}\ <<\ endl;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \}}
\DoxyCodeLine{00221\ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00226\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classDaeMaterials_aa49b35f1ae5e13bfb873b7d55448f7e3}{DaeMaterials::}}}
\DoxyCodeLine{00227\ \mbox{\hyperlink{classDaeMaterials_aa49b35f1ae5e13bfb873b7d55448f7e3}{apply\_to\_primitive}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic,\ \textcolor{keyword}{const}\ PT(\mbox{\hyperlink{classEggPrimitive}{EggPrimitive}})\ to)\ \{}
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{if}\ (\_materials.count(semantic)\ >\ 0)\ \{}
\DoxyCodeLine{00229\ \ \ \ \ to-\/>set\_material(\_materials[semantic]-\/>\_egg\_material);}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classpvector}{pvector<PT\_EggTexture>::iterator}}\ it\ =\ \_materials[semantic]-\/>\_egg\_textures.begin();\ it\ !=\ \_materials[semantic]-\/>\_egg\_textures.end();\ ++it)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_spam())\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ daeegg\_cat.spam()\ <<\ \textcolor{stringliteral}{"{}Applying\ texture\ "{}}\ <<\ (*it)-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{}\ from\ material\ with\ semantic\ "{}}\ <<\ semantic\ <<\ endl;}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ to-\/>add\_texture(*it);}
\DoxyCodeLine{00235\ \ \ \ \ \}}
\DoxyCodeLine{00236\ \ \ \ \ to-\/>set\_bface\_flag(\_materials[semantic]-\/>\_double\_sided);}
\DoxyCodeLine{00237\ \ \ \}}
\DoxyCodeLine{00238\ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00243\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classDaeMaterials_a9deddbe8b8790153e1581ba9ace41a80}{DaeMaterials::}}}
\DoxyCodeLine{00244\ \mbox{\hyperlink{classDaeMaterials_a9deddbe8b8790153e1581ba9ace41a80}{apply\_to\_group}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic,\ \textcolor{keyword}{const}\ PT(\mbox{\hyperlink{classEggGroup}{EggGroup}})\ to,\ \textcolor{keywordtype}{bool}\ invert\_transparency)\ \{}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{if}\ (\_materials.count(semantic)\ >\ 0)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ PT(DaeBlendSettings)\ blend\ =\ \_materials[semantic]-\/>\_blend;}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{if}\ (blend\ \&\&\ blend-\/>\_enabled)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ to-\/>set\_blend\_mode(EggGroup::BM\_add);}
\DoxyCodeLine{00249\ \ \ \ \ \ \ to-\/>set\_blend\_color(blend-\/>\_color);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (invert\_transparency)\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ to-\/>set\_blend\_operand\_a(blend-\/>\_operand\_b);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ to-\/>set\_blend\_operand\_b(blend-\/>\_operand\_a);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ to-\/>set\_blend\_operand\_a(blend-\/>\_operand\_a);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ to-\/>set\_blend\_operand\_b(blend-\/>\_operand\_b);}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blend\ \&\&\ invert\_transparency)\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \ \ to-\/>set\_blend\_mode(EggGroup::BM\_add);}
\DoxyCodeLine{00259\ \ \ \ \ \ \ to-\/>set\_blend\_color(blend-\/>\_color);}
\DoxyCodeLine{00260\ \ \ \ \ \ \ to-\/>set\_blend\_operand\_a(blend-\/>\_operand\_b);}
\DoxyCodeLine{00261\ \ \ \ \ \ \ to-\/>set\_blend\_operand\_b(blend-\/>\_operand\_a);}
\DoxyCodeLine{00262\ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00270\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \mbox{\hyperlink{classDaeMaterials_a70bde162cd7c5953b0f1a6b87a6bfeea}{DaeMaterials::}}}
\DoxyCodeLine{00271\ \mbox{\hyperlink{classDaeMaterials_a70bde162cd7c5953b0f1a6b87a6bfeea}{get\_uvset\_name}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ semantic,\ FUDaeGeometryInput::Semantic\ input\_semantic,\ int32\ input\_set)\ \{}
\DoxyCodeLine{00272\ \ \ \textcolor{keywordflow}{if}\ (\_materials.count(semantic)\ >\ 0)\ \{}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keywordflow}{if}\ (input\_set\ ==\ -\/1\ \&\&\ \_materials[semantic]-\/>\_uvsets.size()\ ==\ 1)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_materials[semantic]-\/>\_uvsets[0]-\/>\_semantic;}
\DoxyCodeLine{00275\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_materials[semantic]-\/>\_uvsets.size();\ ++i)\ \{}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_materials[semantic]-\/>\_uvsets[i]-\/>\_input\_set\ ==\ input\_set\ \&\&}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \_materials[semantic]-\/>\_uvsets[i]-\/>\_input\_semantic\ ==\ input\_semantic)\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_materials[semantic]-\/>\_uvsets[i]-\/>\_semantic;}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ can't\ find\ it,\ let's\ look\ again,\ but\ don't\ care\ for\ the}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{comment}{//\ input\_semantic\ this\ time.\ \ The\ reason\ for\ this\ is\ that\ some\ tools}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \textcolor{comment}{//\ export\ textangents\ and\ texbinormals\ bound\ to\ a\ uvset\ with\ input}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{comment}{//\ semantic\ TEXCOORD.}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_materials[semantic]-\/>\_uvsets.size();\ ++i)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_materials[semantic]-\/>\_uvsets[i]-\/>\_input\_set\ ==\ input\_set)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_debug())\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ daeegg\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}Using\ uv\ set\ with\ non-\/matching\ input\ semantic\ "{}}\ <<\ \_materials[semantic]-\/>\_uvsets[i]-\/>\_semantic\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_materials[semantic]-\/>\_uvsets[i]-\/>\_semantic;}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (daeegg\_cat.is\_debug())\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ daeegg\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}No\ uv\ set\ binding\ found\ for\ input\ set\ "{}}\ <<\ input\_set\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00297\ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \}}
\DoxyCodeLine{00299\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00300\ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00306\ EggTexture::TextureType\ \mbox{\hyperlink{classDaeMaterials_a2605be8d6853ba5d1bd1afaa8914356a}{DaeMaterials::}}}
\DoxyCodeLine{00307\ \mbox{\hyperlink{classDaeMaterials_a2605be8d6853ba5d1bd1afaa8914356a}{convert\_texture\_type}}(\textcolor{keyword}{const}\ FCDEffectParameterSampler::SamplerType\ orig\_type)\ \{}
\DoxyCodeLine{00308\ \ \ \textcolor{keywordflow}{switch}\ (orig\_type)\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{keywordflow}{case}\ FCDEffectParameterSampler::SAMPLER1D:}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::TT\_1d\_texture;}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{case}\ FCDEffectParameterSampler::SAMPLER2D:}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::TT\_2d\_texture;}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordflow}{case}\ FCDEffectParameterSampler::SAMPLER3D:}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::TT\_3d\_texture;}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keywordflow}{case}\ FCDEffectParameterSampler::SAMPLERCUBE:}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::TT\_cube\_map;}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00318\ \ \ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Invalid\ sampler\ type\ found"{}}\ <<\ endl;}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{return}\ EggTexture::TT\_unspecified;}
\DoxyCodeLine{00321\ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00326\ EggTexture::WrapMode\ \mbox{\hyperlink{classDaeMaterials_a437a2b9a0a77309f5af758965ed5ead5}{DaeMaterials::}}}
\DoxyCodeLine{00327\ \mbox{\hyperlink{classDaeMaterials_a437a2b9a0a77309f5af758965ed5ead5}{convert\_wrap\_mode}}(\textcolor{keyword}{const}\ FUDaeTextureWrapMode::WrapMode\ orig\_mode)\ \{}
\DoxyCodeLine{00328\ \ \ \textcolor{keywordflow}{switch}\ (orig\_mode)\ \{}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::NONE:}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{comment}{//\ FIXME:\ this\ shouldnt\ be\ unspecified}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_unspecified;}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::WRAP:}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_repeat;}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::MIRROR:}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_mirror;}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::CLAMP:}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_clamp;}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::BORDER:}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_border\_color;}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureWrapMode::UNKNOWN:}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_unspecified;}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00343\ \ \ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Invalid\ wrap\ mode\ found:\ "{}}\ <<\ FUDaeTextureWrapMode::ToString(orig\_mode)\ <<\ endl;}
\DoxyCodeLine{00344\ \ \ \}}
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{return}\ EggTexture::WM\_unspecified;}
\DoxyCodeLine{00346\ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00352\ EggTexture::FilterType\ \mbox{\hyperlink{classDaeMaterials_aa9aeeb00426c96b61b7813472d84163b}{DaeMaterials::}}}
\DoxyCodeLine{00353\ \mbox{\hyperlink{classDaeMaterials_aa9aeeb00426c96b61b7813472d84163b}{convert\_filter\_type}}(\textcolor{keyword}{const}\ FUDaeTextureFilterFunction::FilterFunction\ orig\_type)\ \{}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{switch}\ (orig\_type)\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::NONE:}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \textcolor{comment}{//\ FIXME:\ this\ shouldnt\ be\ unspecified}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_unspecified;}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::NEAREST:}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_nearest;}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::LINEAR:}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_linear;}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::NEAREST\_MIPMAP\_NEAREST:}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_nearest\_mipmap\_nearest;}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::LINEAR\_MIPMAP\_NEAREST:}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_linear\_mipmap\_nearest;}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::NEAREST\_MIPMAP\_LINEAR:}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_nearest\_mipmap\_linear;}
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::LINEAR\_MIPMAP\_LINEAR:}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_linear\_mipmap\_linear;}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keywordflow}{case}\ FUDaeTextureFilterFunction::UNKNOWN:}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_unspecified;}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00373\ \ \ \ \ \ \ daeegg\_cat.warning()\ <<\ \textcolor{stringliteral}{"{}Unknown\ filter\ type\ found:\ "{}}\ <<\ FUDaeTextureFilterFunction::ToString(orig\_type)\ <<\ endl;}
\DoxyCodeLine{00374\ \ \ \}}
\DoxyCodeLine{00375\ \ \ \textcolor{keywordflow}{return}\ EggTexture::FT\_unspecified;}
\DoxyCodeLine{00376\ \}}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00381\ PT(DaeMaterials::DaeBlendSettings)\ DaeMaterials::}
\DoxyCodeLine{00382\ convert\_blend(FCDEffectStandard::TransparencyMode\ mode,\ \textcolor{keyword}{const}\ LColor\ \&transparent,\ \textcolor{keywordtype}{double}\ transparency)\ \{}
\DoxyCodeLine{00383\ \ \ \textcolor{comment}{//\ Create\ the\ DaeBlendSettings\ and\ fill\ it\ with\ some\ defaults.}}
\DoxyCodeLine{00384\ \ \ PT(DaeBlendSettings)\ blend\ =\ \textcolor{keyword}{new}\ DaeBlendSettings();}
\DoxyCodeLine{00385\ \ \ blend-\/>\_enabled\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00386\ \ \ blend-\/>\_color\ =\ LColor::zero();}
\DoxyCodeLine{00387\ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_unspecified;}
\DoxyCodeLine{00388\ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_unspecified;}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \textcolor{comment}{//\ First\ fill\ in\ the\ color\ value.}}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ FCDEffectStandard::A\_ONE)\ \{\textcolor{comment}{//\ ||\ mode\ ==\ FCDEffectStandard::A\_ZERO)\ \{}}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordtype}{double}\ value\ =\ transparent[3]\ *\ transparency;}
\DoxyCodeLine{00393\ \ \ \ \ blend-\/>\_color\ =\ LColor(value,\ value,\ value,\ value);}
\DoxyCodeLine{00394\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (mode\ ==\ FCDEffectStandard::RGB\_ZERO)\ \{\textcolor{comment}{//||\ mode\ ==\ FCDEffectStandard::RGB\_ONE)\ \{}}
\DoxyCodeLine{00395\ \ \ \ \ blend-\/>\_color\ =\ transparent\ *\ transparency;}
\DoxyCodeLine{00396\ \ \ \ \ blend-\/>\_color[3]\ =\ luminance(blend-\/>\_color);}
\DoxyCodeLine{00397\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00398\ \ \ \ \ daeegg\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unknown\ opaque\ type\ found!"{}}\ <<\ endl;}
\DoxyCodeLine{00399\ \ \ \ \ blend-\/>\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{return}\ blend;}
\DoxyCodeLine{00401\ \ \ \}}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \textcolor{comment}{//\ Now\ figure\ out\ the\ operands.}}
\DoxyCodeLine{00404\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ FCDEffectStandard::RGB\_ZERO)\ \{\textcolor{comment}{//\ ||\ mode\ ==\ FCDEffectStandard::A\_ZERO)\ \{}}
\DoxyCodeLine{00405\ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_one\_minus\_constant\_color;}
\DoxyCodeLine{00406\ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_constant\_color;}
\DoxyCodeLine{00407\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (mode\ ==\ FCDEffectStandard::A\_ONE)\ \{\textcolor{comment}{//\ ||\ mode\ ==\ FCDEffectStandard::RGB\_ONE)\ \{}}
\DoxyCodeLine{00408\ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_constant\_color;}
\DoxyCodeLine{00409\ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_one\_minus\_constant\_color;}
\DoxyCodeLine{00410\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00411\ \ \ \ \ daeegg\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unknown\ opaque\ type\ found!"{}}\ <<\ endl;}
\DoxyCodeLine{00412\ \ \ \ \ blend-\/>\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordflow}{return}\ blend;}
\DoxyCodeLine{00414\ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \textcolor{comment}{//\ See\ if\ we\ can\ optimize\ out\ the\ color.}}
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_operand\_a\ ==\ EggGroup::BO\_constant\_color)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor::zero())\ \{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_zero;}
\DoxyCodeLine{00420\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor(1,\ 1,\ 1,\ 1))\ \{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_one;}
\DoxyCodeLine{00422\ \ \ \ \ \}}
\DoxyCodeLine{00423\ \ \ \}}
\DoxyCodeLine{00424\ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_operand\_b\ ==\ EggGroup::BO\_constant\_color)\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor::zero())\ \{}
\DoxyCodeLine{00426\ \ \ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_zero;}
\DoxyCodeLine{00427\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor(1,\ 1,\ 1,\ 1))\ \{}
\DoxyCodeLine{00428\ \ \ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_one;}
\DoxyCodeLine{00429\ \ \ \ \ \}}
\DoxyCodeLine{00430\ \ \ \}}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_operand\_a\ ==\ EggGroup::BO\_one\_minus\_constant\_color)\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor::zero())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_one;}
\DoxyCodeLine{00434\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor(1,\ 1,\ 1,\ 1))\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ blend-\/>\_operand\_a\ =\ EggGroup::BO\_zero;}
\DoxyCodeLine{00436\ \ \ \ \ \}}
\DoxyCodeLine{00437\ \ \ \}}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_operand\_b\ ==\ EggGroup::BO\_one\_minus\_constant\_color)\ \{}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor::zero())\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_one;}
\DoxyCodeLine{00441\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blend-\/>\_color\ ==\ LColor(1,\ 1,\ 1,\ 1))\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ blend-\/>\_operand\_b\ =\ EggGroup::BO\_zero;}
\DoxyCodeLine{00443\ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \}}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \textcolor{comment}{//\ See\ if\ we\ can\ entirely\ disable\ the\ blend.}}
\DoxyCodeLine{00447\ \ \ \textcolor{keywordflow}{if}\ (blend-\/>\_operand\_a\ ==\ EggGroup::BO\_one\ \&\&\ blend-\/>\_operand\_b\ ==\ EggGroup::BO\_zero)\ \{}
\DoxyCodeLine{00448\ \ \ \ \ blend-\/>\_enabled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00449\ \ \ \}}
\DoxyCodeLine{00450\ \ \ \textcolor{keywordflow}{return}\ blend;}
\DoxyCodeLine{00451\ \}}

\end{DoxyCode}
