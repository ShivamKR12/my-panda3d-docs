\doxysection{bullet\+Character\+Controller\+Node.\+cxx}
\hypertarget{bulletCharacterControllerNode_8cxx_source}{}\label{bulletCharacterControllerNode_8cxx_source}\index{panda/src/bullet/bulletCharacterControllerNode.cxx@{panda/src/bullet/bulletCharacterControllerNode.cxx}}
\mbox{\hyperlink{bulletCharacterControllerNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletCharacterControllerNode_8h}{bulletCharacterControllerNode.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__bullet_8h}{config\_bullet.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletWorld_8h}{bulletWorld.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#if\ BT\_BULLET\_VERSION\ >=\ 285}}
\DoxyCodeLine{00021\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ up\_vectors[3]\ =\ \{\mbox{\hyperlink{structbtVector3}{btVector3}}(1.0f,\ 0.0f,\ 0.0f),\ \mbox{\hyperlink{structbtVector3}{btVector3}}(0.0f,\ 1.0f,\ 0.0f),\ \mbox{\hyperlink{structbtVector3}{btVector3}}(0.0f,\ 0.0f,\ 1.0f)\};}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BulletCharacterControllerNode::\_type\_handle;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00029\ BulletCharacterControllerNode::}
\DoxyCodeLine{00030\ BulletCharacterControllerNode(\mbox{\hyperlink{classBulletShape}{BulletShape}}\ *shape,\ PN\_stdfloat\ step\_height,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name)\ :\ \mbox{\hyperlink{classBulletBaseCharacterControllerNode}{BulletBaseCharacterControllerNode}}(name)\ \{}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//\ Synchronised\ transform}}
\DoxyCodeLine{00033\ \ \ \_sync\ =\ TransformState::make\_identity();}
\DoxyCodeLine{00034\ \ \ \_sync\_disable\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ Initial\ transform}}
\DoxyCodeLine{00037\ \ \ btTransform\ trans\ =\ btTransform::getIdentity();}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ Get\ convex\ shape\ (for\ ghost\ object)}}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{if}\ (!shape-\/>is\_convex())\ \{}
\DoxyCodeLine{00041\ \ \ \ \ bullet\_cat.error()\ <<\ \textcolor{stringliteral}{"{}a\ convex\ shape\ is\ required!"{}}\ <<\ std::endl;}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ btConvexShape\ *convex\ =\ (btConvexShape\ *)(shape-\/>ptr());}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \textcolor{comment}{//\ Ghost\ object}}
\DoxyCodeLine{00048\ \ \ \_ghost\ =\ \textcolor{keyword}{new}\ btPairCachingGhostObject();}
\DoxyCodeLine{00049\ \ \ \_ghost-\/>setUserPointer(\textcolor{keyword}{this});}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \_ghost-\/>setWorldTransform(trans);}
\DoxyCodeLine{00052\ \ \ \_ghost-\/>setInterpolationWorldTransform(trans);}
\DoxyCodeLine{00053\ \ \ \_ghost-\/>setCollisionShape(convex);}
\DoxyCodeLine{00054\ \ \ \_ghost-\/>setCollisionFlags(btCollisionObject::CF\_CHARACTER\_OBJECT);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ Up\ axis}}
\DoxyCodeLine{00057\ \ \ \_up\ =\ get\_default\_up\_axis();}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ Initialise\ movement}}
\DoxyCodeLine{00060\ \ \ \_linear\_movement\_is\_local\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00061\ \ \ \_linear\_movement.set(0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00062\ \ \ \_angular\_movement\ =\ 0.0f;}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ Character\ controller}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#if\ BT\_BULLET\_VERSION\ >=\ 285}}
\DoxyCodeLine{00066\ \ \ \_character\ =\ \textcolor{keyword}{new}\ btKinematicCharacterController(\_ghost,\ convex,\ step\_height,\ up\_vectors[\_up]);}
\DoxyCodeLine{00067\ \ \ \_character-\/>setGravity(up\_vectors[\_up]\ *\ -\/(btScalar)9.81f);}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00069\ \ \ \_character\ =\ \textcolor{keyword}{new}\ btKinematicCharacterController(\_ghost,\ convex,\ step\_height,\ \_up);}
\DoxyCodeLine{00070\ \ \ \_character-\/>setGravity((btScalar)9.81f);}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{comment}{//\ Retain\ a\ pointer\ to\ the\ shape}}
\DoxyCodeLine{00074\ \ \ \_shape\ =\ shape;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{comment}{//\ Default\ collide\ mask\ TODO\ set\_into\_collide\_mask(CollideMask::all\_on());}}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00082\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00083\ set\_linear\_movement(\textcolor{keyword}{const}\ LVector3\ \&movement,\ \textcolor{keywordtype}{bool}\ is\_local)\ \{}
\DoxyCodeLine{00084\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ nassertv(!movement.is\_nan());}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \_linear\_movement\ =\ movement;}
\DoxyCodeLine{00089\ \ \ \_linear\_movement\_is\_local\ =\ is\_local;}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00096\ set\_angular\_movement(PN\_stdfloat\ omega)\ \{}
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \_angular\_movement\ =\ omega;}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00105\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletCharacterControllerNode_a8b7d7fd7f55d0a254729bd854593cd11}{BulletCharacterControllerNode::}}}
\DoxyCodeLine{00106\ \mbox{\hyperlink{classBulletCharacterControllerNode_a8b7d7fd7f55d0a254729bd854593cd11}{do\_sync\_p2b}}(PN\_stdfloat\ dt,\ \textcolor{keywordtype}{int}\ num\_substeps)\ \{}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ \ \ \textcolor{comment}{//\ Synchronise\ global\ transform}}
\DoxyCodeLine{00109\ \ \ do\_transform\_changed();}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{comment}{//\ Angular\ rotation}}
\DoxyCodeLine{00112\ \ \ btScalar\ angle\ =\ dt\ *\ deg\_2\_rad(\_angular\_movement);}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ btMatrix3x3\ m\ =\ \_ghost-\/>getWorldTransform().getBasis();}
\DoxyCodeLine{00115\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ up\ =\ m[\_up];}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ m\ *=\ btMatrix3x3(btQuaternion(up,\ angle));}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \_ghost-\/>getWorldTransform().setBasis(m);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{comment}{//\ Linear\ movement}}
\DoxyCodeLine{00122\ \ \ LVector3\ vp\ =\ \_linear\_movement\ /\ (btScalar)num\_substeps;}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ v;}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{if}\ (\_linear\_movement\_is\_local)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ btTransform\ \mbox{\hyperlink{classPandaNode_a84965804b720a9d5c7eef0f80ae75aff}{xform}}\ =\ \_ghost-\/>getWorldTransform();}
\DoxyCodeLine{00127\ \ \ \ \ \mbox{\hyperlink{classPandaNode_a84965804b720a9d5c7eef0f80ae75aff}{xform}}.setOrigin(\mbox{\hyperlink{structbtVector3}{btVector3}}(0.0f,\ 0.0f,\ 0.0f));}
\DoxyCodeLine{00128\ \ \ \ \ v\ =\ \mbox{\hyperlink{classPandaNode_a84965804b720a9d5c7eef0f80ae75aff}{xform}}(LVecBase3\_to\_btVector3(vp));}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00131\ \ \ \ \ v\ =\ LVecBase3\_to\_btVector3(vp);}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ \_character-\/>setVelocityForTimeInterval(v,\ dt);}}
\DoxyCodeLine{00135\ \ \ \_character-\/>setWalkDirection(v\ *\ dt);}
\DoxyCodeLine{00136\ \ \ \_angular\_movement\ =\ 0.0f;}
\DoxyCodeLine{00137\ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00142\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletCharacterControllerNode_a95ca22b5da6fe323d41f74e760469e34}{BulletCharacterControllerNode::}}}
\DoxyCodeLine{00143\ \mbox{\hyperlink{classBulletCharacterControllerNode_a95ca22b5da6fe323d41f74e760469e34}{do\_sync\_b2p}}()\ \{}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ np\ =\ NodePath::any\_path((\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *)\textcolor{keyword}{this});}
\DoxyCodeLine{00146\ \ \ LVecBase3\ scale\ =\ np.get\_net\_transform()-\/>get\_scale();}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ btTransform\ trans\ =\ \_ghost-\/>getWorldTransform();}
\DoxyCodeLine{00149\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ ts\ =\ btTrans\_to\_TransformState(trans,\ scale);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ LMatrix4\ m\_sync\ =\ \_sync-\/>get\_mat();}
\DoxyCodeLine{00152\ \ \ LMatrix4\ m\_ts\ =\ ts-\/>get\_mat();}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}\ (!m\_sync.almost\_equal(m\_ts))\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \_sync\ =\ ts;}
\DoxyCodeLine{00156\ \ \ \ \ \_sync\_disable\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00157\ \ \ \ \ np.set\_transform(\mbox{\hyperlink{classNodePath}{NodePath}}(),\ ts);}
\DoxyCodeLine{00158\ \ \ \ \ \_sync\_disable\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00159\ \ \ \}}
\DoxyCodeLine{00160\ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00165\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00166\ do\_transform\_changed()\ \{}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{keywordflow}{if}\ (\_sync\_disable)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ np\ =\ NodePath::any\_path((\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *)\textcolor{keyword}{this});}
\DoxyCodeLine{00171\ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ ts\ =\ np.get\_net\_transform();}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ LMatrix4\ m\_sync\ =\ \_sync-\/>get\_mat();}
\DoxyCodeLine{00174\ \ \ LMatrix4\ m\_ts\ =\ ts-\/>get\_mat();}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{if}\ (!m\_sync.almost\_equal(m\_ts))\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \_sync\ =\ ts;}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{comment}{//\ Get\ translation,\ heading\ and\ scale}}
\DoxyCodeLine{00180\ \ \ \ \ LPoint3\ pos\ =\ ts-\/>get\_pos();}
\DoxyCodeLine{00181\ \ \ \ \ PN\_stdfloat\ heading\ =\ ts-\/>get\_hpr().get\_x();}
\DoxyCodeLine{00182\ \ \ \ \ LVecBase3\ scale\ =\ ts-\/>get\_scale();}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ Set\ translation}}
\DoxyCodeLine{00185\ \ \ \ \ \_character-\/>warp(LVecBase3\_to\_btVector3(pos));}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{comment}{//\ Set\ Heading}}
\DoxyCodeLine{00188\ \ \ \ \ btMatrix3x3\ m\ =\ \_ghost-\/>getWorldTransform().getBasis();}
\DoxyCodeLine{00189\ \ \ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ up\ =\ m[\_up];}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ m\ =\ btMatrix3x3(btQuaternion(up,\ deg\_2\_rad(heading)));}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \_ghost-\/>getWorldTransform().setBasis(m);}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{//\ Set\ scale}}
\DoxyCodeLine{00196\ \ \ \ \ \_shape-\/>do\_set\_local\_scale(scale);}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletCharacterControllerNode_a8eae75e26e1b2a28410ae758db94c1ca}{BulletCharacterControllerNode::}}}
\DoxyCodeLine{00204\ \mbox{\hyperlink{classBulletCharacterControllerNode_a8eae75e26e1b2a28410ae758db94c1ca}{transform\_changed}}()\ \{}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \textcolor{keywordflow}{if}\ (\_sync\_disable)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ do\_transform\_changed();}
\DoxyCodeLine{00211\ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00216\ \mbox{\hyperlink{classBulletShape}{BulletShape}}\ *BulletCharacterControllerNode::}
\DoxyCodeLine{00217\ get\_shape()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{return}\ \_shape;}
\DoxyCodeLine{00220\ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00225\ \textcolor{keywordtype}{bool}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00226\ is\_on\_ground()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00227\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{return}\ \_character-\/>onGround();}
\DoxyCodeLine{00230\ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00235\ \textcolor{keywordtype}{bool}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00236\ can\_jump()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00237\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{return}\ \_character-\/>canJump();}
\DoxyCodeLine{00240\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00245\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00246\ do\_jump()\ \{}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \_character-\/>jump();}
\DoxyCodeLine{00250\ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00255\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00256\ set\_fall\_speed(PN\_stdfloat\ fall\_speed)\ \{}
\DoxyCodeLine{00257\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \_character-\/>setFallSpeed((btScalar)fall\_speed);}
\DoxyCodeLine{00260\ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00265\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00266\ set\_jump\_speed(PN\_stdfloat\ jump\_speed)\ \{}
\DoxyCodeLine{00267\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \_character-\/>setJumpSpeed((btScalar)jump\_speed);}
\DoxyCodeLine{00270\ \}}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00275\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00276\ set\_max\_jump\_height(PN\_stdfloat\ max\_jump\_height)\ \{}
\DoxyCodeLine{00277\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \_character-\/>setMaxJumpHeight((btScalar)max\_jump\_height);}
\DoxyCodeLine{00280\ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00285\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00286\ set\_max\_slope(PN\_stdfloat\ max\_slope)\ \{}
\DoxyCodeLine{00287\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \_character-\/>setMaxSlope((btScalar)max\_slope);}
\DoxyCodeLine{00290\ \}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00295\ PN\_stdfloat\ BulletCharacterControllerNode::}
\DoxyCodeLine{00296\ get\_max\_slope()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00297\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \textcolor{keywordflow}{return}\ (PN\_stdfloat)\_character-\/>getMaxSlope();}
\DoxyCodeLine{00300\ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00305\ PN\_stdfloat\ BulletCharacterControllerNode::}
\DoxyCodeLine{00306\ get\_gravity()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00307\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \textcolor{preprocessor}{\#if\ BT\_BULLET\_VERSION\ >=\ 285}}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{return}\ -\/(PN\_stdfloat)\_character-\/>getGravity()[\_up];}
\DoxyCodeLine{00311\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00312\ \ \ \textcolor{keywordflow}{return}\ (PN\_stdfloat)\_character-\/>getGravity();}
\DoxyCodeLine{00313\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00314\ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00319\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00320\ set\_gravity(PN\_stdfloat\ gravity)\ \{}
\DoxyCodeLine{00321\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#if\ BT\_BULLET\_VERSION\ >=\ 285}}
\DoxyCodeLine{00324\ \ \ \_character-\/>setGravity(up\_vectors[\_up]\ *\ -\/(btScalar)gravity);}
\DoxyCodeLine{00325\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00326\ \ \ \_character-\/>setGravity((btScalar)gravity);}
\DoxyCodeLine{00327\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00328\ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00333\ \textcolor{keywordtype}{void}\ BulletCharacterControllerNode::}
\DoxyCodeLine{00334\ set\_use\_ghost\_sweep\_test(\textcolor{keywordtype}{bool}\ value)\ \{}
\DoxyCodeLine{00335\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \textcolor{keywordflow}{return}\ \_character-\/>setUseGhostSweepTest(value);}
\DoxyCodeLine{00338\ \}}

\end{DoxyCode}
