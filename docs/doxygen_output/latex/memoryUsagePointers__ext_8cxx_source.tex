\doxysection{memory\+Usage\+Pointers\+\_\+ext.\+cxx}
\hypertarget{memoryUsagePointers__ext_8cxx_source}{}\label{memoryUsagePointers__ext_8cxx_source}\index{panda/src/express/memoryUsagePointers\_ext.cxx@{panda/src/express/memoryUsagePointers\_ext.cxx}}
\mbox{\hyperlink{memoryUsagePointers__ext_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{memoryUsagePointers__ext_8h}{memoryUsagePointers\_ext.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#if\ defined(HAVE\_PYTHON)\ \&\&\ defined(DO\_MEMORY\_USAGE)}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#ifndef\ CPPPARSER}}
\DoxyCodeLine{00019\ \textcolor{keyword}{extern}\ Dtool\_PyTypedObject\ Dtool\_TypedObject;}
\DoxyCodeLine{00020\ \textcolor{keyword}{extern}\ Dtool\_PyTypedObject\ Dtool\_TypedReferenceCount;}
\DoxyCodeLine{00021\ \textcolor{keyword}{extern}\ Dtool\_PyTypedObject\ Dtool\_ReferenceCount;}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ CPPPARSER}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00033\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<MemoryUsagePointers>::}}}
\DoxyCodeLine{00034\ \mbox{\hyperlink{classExtension}{get\_python\_pointer}}(\textcolor{keywordtype}{size\_t}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *typed\_ptr\ =\ \_this-\/>get\_typed\_pointer(n);}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classReferenceCount}{ReferenceCount}}\ *ref\_ptr\ =\ \_this-\/>get\_pointer(n);}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{keywordtype}{bool}\ memory\_rules\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00039\ \ \ \textcolor{keywordflow}{if}\ (ref\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00040\ \ \ \ \ memory\_rules\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00041\ \ \ \ \ ref\_ptr-\/>ref();}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{if}\ (typed\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{keywordflow}{return}\ DTool\_CreatePyInstanceTyped(typed\_ptr,\ Dtool\_TypedObject,}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memory\_rules,\ \textcolor{keyword}{false},}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ typed\_ptr-\/>get\_type\_index());}
\DoxyCodeLine{00048\ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{if}\ (ref\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordflow}{return}\ Py\_BuildValue(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00052\ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ type\ =\ \_this-\/>get\_type(n);}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{if}\ (type\ !=\ TypeHandle::none())\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ Trust\ that\ there\ is\ a\ downcast\ path\ to\ the\ actual\ type.}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keywordflow}{return}\ DTool\_CreatePyInstanceTyped(ref\_ptr,\ Dtool\_ReferenceCount,}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memory\_rules,\ \textcolor{keyword}{false},}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ type.get\_index());}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{comment}{//\ If\ worse\ comes\ to\ worst,\ just\ return\ a\ ReferenceCount\ wrapper.}}
\DoxyCodeLine{00063\ \ \ \textcolor{keywordflow}{return}\ DTool\_CreatePyInstance(ref\_ptr,\ Dtool\_ReferenceCount,}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ memory\_rules,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_PYTHON\ \&\&\ DO\_MEMORY\_USAGE}}

\end{DoxyCode}
