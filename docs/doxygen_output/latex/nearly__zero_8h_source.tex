\doxysection{nearly\+\_\+zero.\+h}
\hypertarget{nearly__zero_8h_source}{}\label{nearly__zero_8h_source}\index{dtool/src/dtoolbase/nearly\_zero.h@{dtool/src/dtoolbase/nearly\_zero.h}}
\mbox{\hyperlink{nearly__zero_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ NEARLY\_ZERO\_H}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ NEARLY\_ZERO\_H}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dtoolbase_8h}{dtoolbase.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{comment}{//\ The\ following\ two\ functions\ are\ defined\ just\ to\ make\ the\ NEARLY\_ZERO()}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ macro\ work.\ \ They\ each\ return\ a\ suitable\ nearly-\/zero\ value\ for\ their}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ corresponding\ numeric\ type.}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{//\ Note\ that\ declaring\ these\ small\ numeric\ values\ first\ as\ a\ static\ const}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ identifier,\ and\ then\ returning\ the\ value\ of\ that\ identifier,\ seems\ to\ lead}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ to\ compilation\ errors\ (at\ least\ in\ VC7)\ in\ which\ sometimes}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ IS\_THRESHOLD\_COMPEQ(a,\ a,\ get\_nearly\_zero\_value(a))\ !=\ 0.}}
\DoxyCodeLine{00027\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{double}}
\DoxyCodeLine{00028\ get\_nearly\_zero\_value(\textcolor{keywordtype}{double})\ \{}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordflow}{return}\ 1.0e-\/12;}
\DoxyCodeLine{00030\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{float}}
\DoxyCodeLine{00033\ get\_nearly\_zero\_value(\textcolor{keywordtype}{float})\ \{}
\DoxyCodeLine{00034\ \ \ \textcolor{keywordflow}{return}\ 1.0e-\/6f;}
\DoxyCodeLine{00035\ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00038\ get\_nearly\_zero\_value(\textcolor{keywordtype}{int})\ \{}
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ This\ is\ a\ bit\ silly,\ but\ we\ should\ nevertheless\ define\ it\ in\ case\ it\ is}}
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ called\ for\ an\ integer\ type.}}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{comment}{//\ IS\_THRESHOLD\_ZERO(value,\ threshold)\ returns\ true\ if\ the\ value\ is\ within}}
\DoxyCodeLine{00046\ \textcolor{comment}{//\ threshold\ of\ zero.}}
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#define\ IS\_THRESHOLD\_ZERO(value,\ threshold)\ \(\backslash\)}}
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\ \ ((value)\ <\ (threshold)\ \&\&\ (value)\ >\ -\/(threshold))}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{comment}{//\ IS\_THRESHOLD\_EQUAL(value1,\ value2,\ threshold)\ returns\ true\ if\ the\ two}}
\DoxyCodeLine{00051\ \textcolor{comment}{//\ values\ are\ within\ threshold\ of\ each\ other.}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ IS\_THRESHOLD\_EQUAL(value1,\ value2,\ threshold)\ \(\backslash\)}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\ \ (IS\_THRESHOLD\_ZERO((value1)\ -\/\ (value2),\ threshold))}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{comment}{//\ IS\_THRESHOLD\_COMPEQ(value1,\ value2,\ threshold)\ returns\ true\ if\ the\ two}}
\DoxyCodeLine{00056\ \textcolor{comment}{//\ values\ are\ equal\ within\ threshold\ tolerance.\ \ Unlike\ IS\_THRESHOLD\_EQUAL,}}
\DoxyCodeLine{00057\ \textcolor{comment}{//\ the\ transitive\ principle\ is\ guaranteed:\ IS\_THRESHOLD\_COMPEQ(a,\ b,\ t)\ \&\&}}
\DoxyCodeLine{00058\ \textcolor{comment}{//\ IS\_THRESHOLD\_COMPEQ(b,\ c,\ t)\ implies\ IS\_THRESHOLD\_COMPEQ(a,\ c,\ t).}}
\DoxyCodeLine{00059\ \textcolor{preprocessor}{\#define\ IS\_THRESHOLD\_COMPEQ(value1,\ value2,\ threshold)\ \(\backslash\)}}
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\ \ (cfloor(value1\ /\ threshold\ +\ 0.5f)\ ==\ cfloor(value2\ /\ threshold\ +\ 0.5f))}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{//\ NEARLY\_ZERO(float)\ returns\ a\ number\ that\ is\ considered\ to\ be\ so\ close\ to}}
\DoxyCodeLine{00063\ \textcolor{comment}{//\ zero\ as\ not\ to\ matter\ for\ a\ float.\ \ NEARLY\_ZERO(double)\ returns\ a\ similar,}}
\DoxyCodeLine{00064\ \textcolor{comment}{//\ smaller\ number\ for\ a\ double.}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ NEARLY\_ZERO(FLOATTYPE)\ (get\_nearly\_zero\_value((FLOATTYPE)0))}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{comment}{//\ IS\_NEARLY\_ZERO(value)\ returns\ true\ if\ the\ value\ is\ very\ close\ to\ zero.}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#define\ IS\_NEARLY\_ZERO(value)\ \(\backslash\)}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\ \ (IS\_THRESHOLD\_ZERO(value,\ get\_nearly\_zero\_value(value)))}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \textcolor{comment}{//\ IS\_NEARLY\_EQUAL(value1,\ value2)\ returns\ true\ if\ the\ two\ values\ are\ very}}
\DoxyCodeLine{00072\ \textcolor{comment}{//\ close\ to\ each\ other.}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#define\ IS\_NEARLY\_EQUAL(value1,\ value2)\ \(\backslash\)}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\ \ \ (IS\_THRESHOLD\_EQUAL(value1,\ value2,\ get\_nearly\_zero\_value(value1)))}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{comment}{//\ MAYBE\_ZERO(value)\ returns\ 0\ if\ the\ value\ is\ nearly\ zero,\ and\ the\ value}}
\DoxyCodeLine{00078\ \textcolor{comment}{//\ itself\ otherwise.}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#define\ MAYBE\_ZERO(value)\ \(\backslash\)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ (IS\_NEARLY\_ZERO(value)\ ?\ 0\ :\ (value))}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
