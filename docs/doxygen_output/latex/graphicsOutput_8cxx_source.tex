\doxysection{graphics\+Output.\+cxx}
\hypertarget{graphicsOutput_8cxx_source}{}\label{graphicsOutput_8cxx_source}\index{panda/src/display/graphicsOutput.cxx@{panda/src/display/graphicsOutput.cxx}}
\mbox{\hyperlink{graphicsOutput_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsOutput_8h}{graphicsOutput.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsPipe_8h}{graphicsPipe.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsEngine_8h}{graphicsEngine.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsWindow_8h}{graphicsWindow.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__display_8h}{config\_display.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lightMutexHolder_8h}{lightMutexHolder.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{renderBuffer_8h}{renderBuffer.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indirectLess_8h}{indirectLess.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatTimer_8h}{pStatTimer.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableBool_8h}{configVariableBool.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{camera_8h}{camera.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{displayRegion_8h}{displayRegion.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lens_8h}{lens.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{perspectiveLens_8h}{perspectiveLens.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pointerTo_8h}{pointerTo.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{compassEffect_8h}{compassEffect.h}}"{}}}
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geom_8h}{geom.h}}"{}}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomNode_8h}{geomNode.h}}"{}}}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTristrips_8h}{geomTristrips.h}}"{}}}
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexWriter_8h}{geomVertexWriter.h}}"{}}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{throw__event_8h}{throw\_event.h}}"{}}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__gobj_8h}{config\_gobj.h}}"{}}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ GraphicsOutput::\_type\_handle;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ GraphicsOutput::\_make\_current\_pcollector(\textcolor{stringliteral}{"{}Draw:Make\ current"{}});}
\DoxyCodeLine{00042\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ GraphicsOutput::\_copy\_texture\_pcollector(\textcolor{stringliteral}{"{}Draw:Copy\ texture"{}});}
\DoxyCodeLine{00043\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ GraphicsOutput::\_cull\_pcollector(\textcolor{stringliteral}{"{}Cull"{}});}
\DoxyCodeLine{00044\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ GraphicsOutput::\_draw\_pcollector(\textcolor{stringliteral}{"{}Draw"{}});}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}\ \{}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name,\ \textcolor{keyword}{const}\ LPoint3\ \&\mbox{\hyperlink{look__at__src_8cxx_a4e167e03dc5f1fd42ee705272d9a47a9}{look\_at}},\ \textcolor{keyword}{const}\ LVector3\ \&up)\ :}
\DoxyCodeLine{00048\ \ \ \ \ \_name(name),\ \_look\_at(\mbox{\hyperlink{look__at__src_8cxx_a4e167e03dc5f1fd42ee705272d9a47a9}{look\_at}}),\ \_up(up)\ \{\ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\_name;}
\DoxyCodeLine{00051\ \ \ LPoint3\ \_look\_at;}
\DoxyCodeLine{00052\ \ \ LVector3\ \_up;}
\DoxyCodeLine{00053\ \};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{keyword}{static}\ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}\ cube\_faces[6]\ =\ \{}
\DoxyCodeLine{00056\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}positive\_x"{}},\ LPoint3(1,\ 0,\ 0),\ LVector3(0,\ -\/1,\ 0)),}
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}negative\_x"{}},\ LPoint3(-\/1,\ 0,\ 0),\ LVector3(0,\ -\/1,\ 0)),}
\DoxyCodeLine{00058\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}positive\_y"{}},\ LPoint3(0,\ 1,\ 0),\ LVector3(0,\ 0,\ 1)),}
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}negative\_y"{}},\ LPoint3(0,\ -\/1,\ 0),\ LVector3(0,\ 0,\ -\/1)),}
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}positive\_z"{}},\ LPoint3(0,\ 0,\ 1),\ LVector3(0,\ -\/1,\ 0)),}
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{structCubeFaceDef}{CubeFaceDef}}(\textcolor{stringliteral}{"{}negative\_z"{}},\ LPoint3(0,\ 0,\ -\/1),\ LVector3(0,\ -\/1,\ 0))}
\DoxyCodeLine{00062\ \};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00068\ \mbox{\hyperlink{classGraphicsOutput_a774a61d9bb480a5a8787f9060afd80bc}{GraphicsOutput::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classGraphicsOutput_a774a61d9bb480a5a8787f9060afd80bc}{GraphicsOutput}}(\mbox{\hyperlink{classGraphicsEngine}{GraphicsEngine}}\ *engine,\ \mbox{\hyperlink{classGraphicsPipe}{GraphicsPipe}}\ *pipe,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ \&fb\_prop,}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ \&win\_prop,}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ flags,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}}\ *gsg,}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *host,}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ default\_stereo\_flags)\ :}
\DoxyCodeLine{00077\ \ \ \_lock(\textcolor{stringliteral}{"{}GraphicsOutput"{}}),}
\DoxyCodeLine{00078\ \ \ \_size(0,\ 0),}
\DoxyCodeLine{00079\ \ \ \_cull\_window\_pcollector(\_cull\_pcollector,\ name),}
\DoxyCodeLine{00080\ \ \ \_draw\_window\_pcollector(\_draw\_pcollector,\ name),}
\DoxyCodeLine{00081\ \ \ \_clear\_window\_pcollector(\_draw\_window\_pcollector,\ \textcolor{stringliteral}{"{}Clear"{}})}
\DoxyCodeLine{00082\ \{}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#ifdef\ DO\_MEMORY\_USAGE}}
\DoxyCodeLine{00084\ \ \ MemoryUsage::update\_type(\textcolor{keyword}{this},\ \textcolor{keyword}{this});}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00086\ \ \ \_engine\ =\ engine;}
\DoxyCodeLine{00087\ \ \ \_pipe\ =\ pipe;}
\DoxyCodeLine{00088\ \ \ \_gsg\ =\ gsg;}
\DoxyCodeLine{00089\ \ \ \_host\ =\ host;}
\DoxyCodeLine{00090\ \ \ \_fb\_properties\ =\ fb\_prop;}
\DoxyCodeLine{00091\ \ \ \_name\ =\ name;}
\DoxyCodeLine{00092\ \ \ \_creation\_flags\ =\ flags;}
\DoxyCodeLine{00093\ \ \ \_has\_size\ =\ win\_prop.has\_size();}
\DoxyCodeLine{00094\ \ \ \_is\_nonzero\_size\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{if}\ (\_has\_size)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \_size\ =\ win\_prop.get\_size();}
\DoxyCodeLine{00097\ \ \ \ \ \_is\_nonzero\_size\ =\ (\_size[0]\ >\ 0\ \&\&\ \_size[1]\ >\ 0);}
\DoxyCodeLine{00098\ \ \ \}}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{if}\ (\_creation\_flags\ \&\ GraphicsPipe::BF\_size\_track\_host)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ tracking\ the\ host\ size,\ we\ assume\ we'll\ be\ nonzero\ eventually.}}
\DoxyCodeLine{00101\ \ \ \ \ \_is\_nonzero\_size\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00102\ \ \ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00105\ \ \ \_flip\_ready\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00106\ \ \ \_target\_tex\_page\ =\ -\/1;}
\DoxyCodeLine{00107\ \ \ \_prev\_page\_dr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00108\ \ \ \_sort\ =\ 0;}
\DoxyCodeLine{00109\ \ \ \_child\_sort\ =\ 0;}
\DoxyCodeLine{00110\ \ \ \_got\_child\_sort\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00111\ \ \ \_internal\_sort\_index\ =\ 0;}
\DoxyCodeLine{00112\ \ \ \_inverted\ =\ window\_inverted;}
\DoxyCodeLine{00113\ \ \ \_swap\_eyes\ =\ swap\_eyes;}
\DoxyCodeLine{00114\ \ \ \_red\_blue\_stereo\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00115\ \ \ \_left\_eye\_color\_mask\ =\ 0x0f;}
\DoxyCodeLine{00116\ \ \ \_right\_eye\_color\_mask\ =\ 0x0f;}
\DoxyCodeLine{00117\ \ \ \_side\_by\_side\_stereo\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00118\ \ \ \_sbs\_left\_dimensions.set(0.0f,\ 1.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00119\ \ \ \_sbs\_right\_dimensions.set(0.0f,\ 1.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00120\ \ \ \_delete\_flag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordflow}{if}\ (\_fb\_properties.is\_single\_buffered())\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \_draw\_buffer\_type\ =\ RenderBuffer::T\_front;}
\DoxyCodeLine{00124\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \_draw\_buffer\_type\ =\ RenderBuffer::T\_back;}
\DoxyCodeLine{00126\ \ \ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{if}\ (default\_stereo\_flags)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{comment}{//\ Check\ the\ config\ variables\ to\ see\ if\ we\ should\ make\ this\ a\ "{}stereo"{}}}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{comment}{//\ buffer\ or\ window.}}
\DoxyCodeLine{00131\ \ \ \ \ \_red\_blue\_stereo\ =\ red\_blue\_stereo\ \&\&\ !fb\_prop.is\_stereo();}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_red\_blue\_stereo)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \_left\_eye\_color\_mask\ =\ parse\_color\_mask(red\_blue\_stereo\_colors.get\_word(0));}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \_right\_eye\_color\_mask\ =\ parse\_color\_mask(red\_blue\_stereo\_colors.get\_word(1));}
\DoxyCodeLine{00135\ \ \ \ \ \}}
\DoxyCodeLine{00136\ \ \ \ \ \_side\_by\_side\_stereo\ =\ side\_by\_side\_stereo\ \&\&\ !fb\_prop.is\_stereo();}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_side\_by\_side\_stereo)\ \{}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \_sbs\_left\_dimensions.set(sbs\_left\_dimensions[0],\ sbs\_left\_dimensions[1],}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sbs\_left\_dimensions[2],\ sbs\_left\_dimensions[3]);}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \_sbs\_right\_dimensions.set(sbs\_right\_dimensions[0],\ sbs\_right\_dimensions[1],}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sbs\_right\_dimensions[2],\ sbs\_right\_dimensions[3]);}
\DoxyCodeLine{00142\ \ \ \ \ \}}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{comment}{//\ We\ start\ out\ with\ one\ DisplayRegion\ that\ covers\ the\ whole\ window,\ which}}
\DoxyCodeLine{00146\ \ \ \textcolor{comment}{//\ we\ may\ use\ internally\ for\ full-\/window\ operations\ like\ clear()\ and}}
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ get\_screenshot().}}
\DoxyCodeLine{00148\ \ \ \_overlay\_display\_region\ =\ make\_mono\_display\_region(0.0f,\ 1.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00149\ \ \ \_overlay\_display\_region-\/>set\_active(\textcolor{keyword}{false});}
\DoxyCodeLine{00150\ \ \ \_overlay\_display\_region-\/>set\_scissor\_enabled(\textcolor{keyword}{false});}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \textcolor{comment}{//\ Make\ sure\ the\ "{}active"{}\ flag\ is\ set\ true\ for\ pipeline\ stage\ 0.}}
\DoxyCodeLine{00153\ \ \ \{}
\DoxyCodeLine{00154\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00155\ \ \ \ \ cdata-\/>\_active\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \textcolor{comment}{//\ By\ default,\ each\ new\ GraphicsOutput\ is\ set\ up\ to\ clear\ color\ and\ depth.}}
\DoxyCodeLine{00159\ \ \ set\_clear\_color\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00160\ \ \ set\_clear\_depth\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00161\ \ \ set\_clear\_stencil\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00162\ \ \ set\_clear\_color(background\_color.get\_value());}
\DoxyCodeLine{00163\ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00168\ GraphicsOutput::}
\DoxyCodeLine{00169\ \string~GraphicsOutput()\ \{}
\DoxyCodeLine{00170\ \ \ \textcolor{comment}{//\ The\ window\ should\ be\ closed\ by\ the\ time\ we\ destruct.}}
\DoxyCodeLine{00171\ \ \ nassertv(!is\_valid());}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{comment}{//\ We\ shouldn't\ have\ a\ GraphicsPipe\ pointer\ anymore.}}
\DoxyCodeLine{00174\ \ \ nassertv(\_pipe\ ==\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{comment}{//\ We\ don't\ have\ to\ destruct\ our\ child\ display\ regions\ explicitly,\ since}}
\DoxyCodeLine{00177\ \ \ \textcolor{comment}{//\ they\ are\ all\ reference-\/counted\ and\ will\ go\ away\ when\ their\ pointers\ do.}}
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//\ However,\ we\ do\ need\ to\ zero\ out\ their\ pointers\ to\ us.}}
\DoxyCodeLine{00179\ \ \ TotalDisplayRegions::iterator\ dri;}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{for}\ (dri\ =\ \_total\_display\_regions.begin();}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ dri\ !=\ \_total\_display\_regions.end();}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ ++dri)\ \{}
\DoxyCodeLine{00183\ \ \ \ \ (*dri)-\/>\_window\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00184\ \ \ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \_total\_display\_regions.clear();}
\DoxyCodeLine{00187\ \ \ \_overlay\_display\_region\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00188\ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00194\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a0907c5c1e84c6c6ade3fee1212aa0a23}{GraphicsOutput::}}}
\DoxyCodeLine{00195\ \mbox{\hyperlink{classGraphicsOutput_a0907c5c1e84c6c6ade3fee1212aa0a23}{clear\_render\_textures}}()\ \{}
\DoxyCodeLine{00196\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00197\ \ \ cdata-\/>\_textures.clear();}
\DoxyCodeLine{00198\ \ \ ++(cdata-\/>\_textures\_seq);}
\DoxyCodeLine{00199\ \ \ throw\_event(\textcolor{stringliteral}{"{}render-\/texture-\/targets-\/changed"{}});}
\DoxyCodeLine{00200\ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00236\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a26b55bc17d92be5bb9e50b84f03a953e}{GraphicsOutput::}}}
\DoxyCodeLine{00237\ \mbox{\hyperlink{classGraphicsOutput_a26b55bc17d92be5bb9e50b84f03a953e}{add\_render\_texture}}(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ RenderTextureMode\ mode,}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RenderTexturePlane\ plane)\ \{}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ RTM\_none)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00242\ \ \ \}}
\DoxyCodeLine{00243\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \textcolor{comment}{//\ Create\ texture\ if\ necessary.}}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{if}\ (tex\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00247\ \ \ \ \ tex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture}{Texture}}(get\_name());}
\DoxyCodeLine{00248\ \ \ \ \ tex-\/>set\_wrap\_u(SamplerState::WM\_clamp);}
\DoxyCodeLine{00249\ \ \ \ \ tex-\/>set\_wrap\_v(SamplerState::WM\_clamp);}
\DoxyCodeLine{00250\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00251\ \ \ \ \ tex-\/>clear\_ram\_image();}
\DoxyCodeLine{00252\ \ \ \}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \textcolor{comment}{//\ Set\ it\ to\ have\ no\ compression\ by\ default.\ \ You\ can\ restore\ compression}}
\DoxyCodeLine{00255\ \ \ \textcolor{comment}{//\ later\ if\ you\ really,\ really\ want\ it;\ but\ this\ freaks\ out\ some\ drivers,}}
\DoxyCodeLine{00256\ \ \ \textcolor{comment}{//\ and\ presumably\ it's\ a\ mistake\ if\ you\ have\ compression\ enabled\ for\ a}}
\DoxyCodeLine{00257\ \ \ \textcolor{comment}{//\ rendered\ texture.}}
\DoxyCodeLine{00258\ \ \ tex-\/>set\_compression(Texture::CM\_off);}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \textcolor{comment}{//\ Choose\ a\ default\ bitplane.}}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_COUNT)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{switch}\ (tex-\/>get\_format())\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_stencil:}
\DoxyCodeLine{00264\ \ \ \ \ \ \ plane\ =\ RTP\_depth\_stencil;}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component:}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component16:}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component24:}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{case}\ Texture::F\_depth\_component32:}
\DoxyCodeLine{00271\ \ \ \ \ \ \ plane\ =\ RTP\_depth;}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00275\ \ \ \ \ \ \ plane\ =\ RTP\_color;}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00277\ \ \ \ \ \}}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{comment}{//\ Set\ the\ texture's\ format\ to\ match\ the\ bitplane.\ \ (And\ validate\ the}}
\DoxyCodeLine{00281\ \ \ \textcolor{comment}{//\ bitplane,\ while\ we're\ at\ it).}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_depth)\ \{}
\DoxyCodeLine{00284\ \ \ \ \ \_fb\_properties.setup\_depth\_texture(tex);}
\DoxyCodeLine{00285\ \ \ \ \ tex-\/>set\_match\_framebuffer\_format(\textcolor{keyword}{true});}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_depth\_stencil)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ tex-\/>set\_format(Texture::F\_depth\_stencil);}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_fb\_properties.get\_float\_depth())\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ tex-\/>set\_component\_type(Texture::T\_float);}
\DoxyCodeLine{00291\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ tex-\/>set\_component\_type(Texture::T\_unsigned\_int\_24\_8);}
\DoxyCodeLine{00293\ \ \ \ \ \}}
\DoxyCodeLine{00294\ \ \ \ \ tex-\/>set\_match\_framebuffer\_format(\textcolor{keyword}{true});}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_color\ ||}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_rgba\_0\ ||}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_rgba\_1\ ||}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_rgba\_2\ ||}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_rgba\_3)\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \_fb\_properties.setup\_color\_texture(tex);}
\DoxyCodeLine{00302\ \ \ \ \ tex-\/>set\_match\_framebuffer\_format(\textcolor{keyword}{true});}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_aux\_hrgba\_0\ ||}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_hrgba\_1\ ||}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_hrgba\_2\ ||}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_hrgba\_3)\ \{}
\DoxyCodeLine{00308\ \ \ \ \ tex-\/>set\_format(Texture::F\_rgba16);}
\DoxyCodeLine{00309\ \ \ \ \ tex-\/>set\_match\_framebuffer\_format(\textcolor{keyword}{true});}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_aux\_float\_0\ ||}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_float\_1\ ||}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_float\_2\ ||}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ plane\ ==\ RTP\_aux\_float\_3)\ \{}
\DoxyCodeLine{00315\ \ \ \ \ tex-\/>set\_format(Texture::F\_rgba32);}
\DoxyCodeLine{00316\ \ \ \ \ tex-\/>set\_component\_type(Texture::T\_float);}
\DoxyCodeLine{00317\ \ \ \ \ tex-\/>set\_match\_framebuffer\_format(\textcolor{keyword}{true});}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00320\ \ \ \ \ display\_cat.error()\ <<}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}add\_render\_texture:\ invalid\ bitplane\ specified.\(\backslash\)n"{}};}
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00323\ \ \ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{comment}{//\ Go\ ahead\ and\ tell\ the\ texture\ our\ anticipated\ size,\ even\ if\ it\ might\ be}}
\DoxyCodeLine{00326\ \ \ \textcolor{comment}{//\ inaccurate\ (particularly\ if\ this\ is\ a\ GraphicsWindow,\ which\ has\ system-\/}}
\DoxyCodeLine{00327\ \ \ \textcolor{comment}{//\ imposed\ restrictions\ on\ size).}}
\DoxyCodeLine{00328\ \ \ tex-\/>\mbox{\hyperlink{classTexture_ada1263a8e1050b11ea5bfe007cb34a83}{set\_size\_padded}}(get\_x\_size(),\ get\_y\_size(),\ tex-\/>get\_z\_size());}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordflow}{if}\ (\_fb\_properties.is\_stereo()\ \&\&\ plane\ ==\ RTP\_color)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_num\_views()\ <\ 2)\ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ tex-\/>set\_num\_views(2);}
\DoxyCodeLine{00333\ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \}}
\DoxyCodeLine{00335\ }
\DoxyCodeLine{00336\ \ \ \textcolor{keywordflow}{if}\ (!support\_render\_texture\ ||\ !\mbox{\hyperlink{classGraphicsOutput_a7d4f7e4d59b118a2eee0e9e3f8cd41b5}{get\_supports\_render\_texture}}())\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{comment}{//\ Binding\ is\ not\ supported\ or\ it\ is\ disabled,\ so\ just\ fall\ back\ to\ copy}}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{comment}{//\ instead.}}
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ RTM\_bind\_or\_copy)\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ mode\ =\ RTM\_copy\_texture;}
\DoxyCodeLine{00341\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (mode\ ==\ RTM\_bind\_layered)\ \{}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ can't\ fallback\ to\ copy,\ because\ that\ doesn't\ work\ for\ layered}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \textcolor{comment}{//\ textures.\ \ The\ best\ thing\ we\ can\ do\ is\ raise\ an\ error\ message.}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ display\_cat.error()\ <<}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}add\_render\_texture:\ RTM\_bind\_layered\ was\ requested\ but\ "{}}}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}render-\/to-\/texture\ is\ not\ supported\ or\ has\ been\ disabled!\(\backslash\)n"{}};}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ \ \ \}}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ RTM\_bind\_layered\ \&\&\ \_gsg\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ !\_gsg-\/>get\_supports\_geometry\_shaders())\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{comment}{//\ Layered\ FBOs\ require\ a\ geometry\ shader\ to\ write\ to\ any\ but\ the\ first}}
\DoxyCodeLine{00352\ \ \ \ \ \textcolor{comment}{//\ layer.}}
\DoxyCodeLine{00353\ \ \ \ \ display\_cat.warning()\ <<}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}add\_render\_texture:\ RTM\_bind\_layered\ was\ requested\ but\ "{}}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}geometry\ shaders\ are\ not\ supported!\(\backslash\)n"{}};}
\DoxyCodeLine{00356\ \ \ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ RTM\_bind\_or\_copy\ ||\ mode\ ==\ RTM\_bind\_layered)\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ still\ planning\ on\ binding,\ indicate\ it\ in\ texture\ properly.}}
\DoxyCodeLine{00360\ \ \ \ \ tex-\/>set\_render\_to\_texture(\textcolor{keyword}{true});}
\DoxyCodeLine{00361\ \ \ \}}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((plane\ ==\ RTP\_depth\ ||\ plane\ ==\ RTP\_depth\_stencil)\ \&\&\ \_fb\_properties.get\_depth\_bits()\ ==\ 0)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ not\ providing\ the\ depth\ buffer,\ we\ need\ something\ to\ copy\ from.}}
\DoxyCodeLine{00364\ \ \ \ \ display\_cat.error()}
\DoxyCodeLine{00365\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}add\_render\_texture:\ can't\ copy\ depth\ from\ framebuffer\ without\ depth\ bits!\(\backslash\)n"{}};}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00370\ \ \ \mbox{\hyperlink{classGraphicsOutput_1_1RenderTexture}{RenderTexture}}\ result;}
\DoxyCodeLine{00371\ \ \ result.\_texture\ =\ tex;}
\DoxyCodeLine{00372\ \ \ result.\_plane\ =\ plane;}
\DoxyCodeLine{00373\ \ \ result.\_rtm\_mode\ =\ mode;}
\DoxyCodeLine{00374\ \ \ cdata-\/>\_textures.push\_back(result);}
\DoxyCodeLine{00375\ \ \ ++(cdata-\/>\_textures\_seq);}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ throw\_event(\textcolor{stringliteral}{"{}render-\/texture-\/targets-\/changed"{}});}
\DoxyCodeLine{00378\ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00387\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a64b4b44e98a9122121db51631f8d9553}{GraphicsOutput::}}}
\DoxyCodeLine{00388\ \mbox{\hyperlink{classGraphicsOutput_a64b4b44e98a9122121db51631f8d9553}{setup\_render\_texture}}(\mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ \textcolor{keywordtype}{bool}\ allow\_bind,\ \textcolor{keywordtype}{bool}\ to\_ram)\ \{}
\DoxyCodeLine{00389\ \ \ display\_cat.warning()\ <<}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{stringliteral}{"{}Using\ deprecated\ setup\_render\_texture\ interface.\(\backslash\)n"{}};}
\DoxyCodeLine{00391\ \ \ \mbox{\hyperlink{classGraphicsOutput_a0907c5c1e84c6c6ade3fee1212aa0a23}{clear\_render\_textures}}();}
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{if}\ (to\_ram)\ \{}
\DoxyCodeLine{00393\ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput_a26b55bc17d92be5bb9e50b84f03a953e}{add\_render\_texture}}(tex,\ RTM\_copy\_ram);}
\DoxyCodeLine{00394\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (allow\_bind)\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput_a26b55bc17d92be5bb9e50b84f03a953e}{add\_render\_texture}}(tex,\ RTM\_bind\_or\_copy);}
\DoxyCodeLine{00396\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00397\ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput_a26b55bc17d92be5bb9e50b84f03a953e}{add\_render\_texture}}(tex,\ RTM\_copy\_texture);}
\DoxyCodeLine{00398\ \ \ \}}
\DoxyCodeLine{00399\ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00405\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_ae3f8e9f3bd704f49324cda6a5260497e}{GraphicsOutput::}}}
\DoxyCodeLine{00406\ \mbox{\hyperlink{classGraphicsOutput_ae3f8e9f3bd704f49324cda6a5260497e}{set\_active}}(\textcolor{keywordtype}{bool}\ active)\ \{}
\DoxyCodeLine{00407\ \ \ \mbox{\hyperlink{classCycleDataLockedReader}{CDLockedReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00408\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_active\ !=\ active)\ \{}
\DoxyCodeLine{00409\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdataw(((\mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *)\textcolor{keyword}{this})-\/>\_cycler,\ cdata,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00410\ \ \ \ \ cdataw-\/>\_active\ =\ active;}
\DoxyCodeLine{00411\ \ \ \}}
\DoxyCodeLine{00412\ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00417\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_a95095b8c8c7b7b8ecf7c84062c0e3520}{GraphicsOutput::}}}
\DoxyCodeLine{00418\ \mbox{\hyperlink{classGraphicsOutput_a95095b8c8c7b7b8ecf7c84062c0e3520}{is\_active}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00419\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00421\ \ \ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ \ \ \mbox{\hyperlink{classCycleDataLockedReader}{CDLockedReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00424\ \ \ \textcolor{keywordflow}{if}\ (!cdata-\/>\_active)\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00426\ \ \ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_one\_shot\_frame\ !=\ -\/1)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{comment}{//\ If\ one\_shot\ is\ in\ effect,\ then\ we\ are\ active\ only\ for\ the\ one\ indicated}}
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{comment}{//\ frame.}}
\DoxyCodeLine{00431\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_one\_shot\_frame\ !=\ ClockObject::get\_global\_clock()-\/>get\_frame\_count())\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00433\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00435\ \ \ \ \ \}}
\DoxyCodeLine{00436\ \ \ \}}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \textcolor{comment}{//\ If\ the\ window\ has\ a\ clear\ value\ set,\ it\ is\ active.}}
\DoxyCodeLine{00439\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classDrawableRegion_a7cf04a992ac977ba7d706c81871ed1b5}{is\_any\_clear\_active}}())\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00441\ \ \ \}}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \textcolor{comment}{//\ If\ we\ triggered\ a\ copy\ operation,\ it\ is\ also\ active.}}
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{if}\ (\_trigger\_copy)\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00446\ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \textcolor{comment}{//\ The\ window\ is\ active\ if\ at\ least\ one\ display\ region\ is\ active.}}
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_active\_display\_regions\_stale)\ \{}
\DoxyCodeLine{00450\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdataw(((\mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *)\textcolor{keyword}{this})-\/>\_cycler,\ cdata,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00451\ \ \ \ \ ((\mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *)\textcolor{keyword}{this})-\/>do\_determine\_display\_regions(cdataw);}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordflow}{return}\ !cdataw-\/>\_active\_display\_regions.empty();}
\DoxyCodeLine{00453\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordflow}{return}\ !cdata-\/>\_active\_display\_regions.empty();}
\DoxyCodeLine{00455\ \ \ \}}
\DoxyCodeLine{00456\ \}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00473\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a72f5e01ddf059e29808531fe39d42b54}{GraphicsOutput::}}}
\DoxyCodeLine{00474\ \mbox{\hyperlink{classGraphicsOutput_a72f5e01ddf059e29808531fe39d42b54}{set\_one\_shot}}(\textcolor{keywordtype}{bool}\ one\_shot)\ \{}
\DoxyCodeLine{00475\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{if}\ (one\_shot)\ \{}
\DoxyCodeLine{00477\ \ \ \ \ cdata-\/>\_one\_shot\_frame\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_count();}
\DoxyCodeLine{00478\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00479\ \ \ \ \ cdata-\/>\_one\_shot\_frame\ =\ -\/1;}
\DoxyCodeLine{00480\ \ \ \}}
\DoxyCodeLine{00481\ \}}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00487\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_aa55159c977acb081e6b3bedda7b77515}{GraphicsOutput::}}}
\DoxyCodeLine{00488\ \mbox{\hyperlink{classGraphicsOutput_aa55159c977acb081e6b3bedda7b77515}{get\_one\_shot}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00489\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{return}\ (cdata-\/>\_one\_shot\_frame\ ==\ ClockObject::get\_global\_clock()-\/>get\_frame\_count());}
\DoxyCodeLine{00491\ \}}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00504\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_adda32e9b6b5bf52b6be126cac77813ec}{GraphicsOutput::}}}
\DoxyCodeLine{00505\ \mbox{\hyperlink{classGraphicsOutput_adda32e9b6b5bf52b6be126cac77813ec}{set\_inverted}}(\textcolor{keywordtype}{bool}\ inverted)\ \{}
\DoxyCodeLine{00506\ \ \ \textcolor{keywordflow}{if}\ (\_inverted\ !=\ inverted)\ \{}
\DoxyCodeLine{00507\ \ \ \ \ \_inverted\ =\ inverted;}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_y\_size()\ !=\ 0)\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{comment}{//\ All\ of\ our\ DisplayRegions\ need\ to\ recompute\ their\ pixel\ positions}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \textcolor{comment}{//\ now.}}
\DoxyCodeLine{00512\ \ \ \ \ \ \ TotalDisplayRegions::iterator\ dri;}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (dri\ =\ \_total\_display\_regions.begin();}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ dri\ !=\ \_total\_display\_regions.end();}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ ++dri)\ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ (*dri)-\/>compute\_pixels(get\_x\_size(),\ get\_y\_size());}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00518\ \ \ \ \ \}}
\DoxyCodeLine{00519\ \ \ \}}
\DoxyCodeLine{00520\ \}}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00533\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a2feac57e0fe2d763f0cfb884e3455802}{GraphicsOutput::}}}
\DoxyCodeLine{00534\ \mbox{\hyperlink{classGraphicsOutput_a2feac57e0fe2d763f0cfb884e3455802}{set\_side\_by\_side\_stereo}}(\textcolor{keywordtype}{bool}\ side\_by\_side\_stereo)\ \{}
\DoxyCodeLine{00535\ \ \ LVecBase4\ left,\ right;}
\DoxyCodeLine{00536\ \ \ left.set(sbs\_left\_dimensions[0],\ sbs\_left\_dimensions[1],}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \ \ \ sbs\_left\_dimensions[2],\ sbs\_left\_dimensions[3]);}
\DoxyCodeLine{00538\ \ \ right.set(sbs\_right\_dimensions[0],\ sbs\_right\_dimensions[1],}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ sbs\_right\_dimensions[2],\ sbs\_right\_dimensions[3]);}
\DoxyCodeLine{00540\ \ \ \mbox{\hyperlink{classGraphicsOutput_a2feac57e0fe2d763f0cfb884e3455802}{set\_side\_by\_side\_stereo}}(side\_by\_side\_stereo,\ left,\ right);}
\DoxyCodeLine{00541\ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00554\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a2feac57e0fe2d763f0cfb884e3455802}{GraphicsOutput::}}}
\DoxyCodeLine{00555\ \mbox{\hyperlink{classGraphicsOutput_a2feac57e0fe2d763f0cfb884e3455802}{set\_side\_by\_side\_stereo}}(\textcolor{keywordtype}{bool}\ side\_by\_side\_stereo,}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LVecBase4\ \&sbs\_left\_dimensions,}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LVecBase4\ \&sbs\_right\_dimensions)\ \{}
\DoxyCodeLine{00558\ \ \ \_side\_by\_side\_stereo\ =\ side\_by\_side\_stereo;}
\DoxyCodeLine{00559\ \ \ \textcolor{keywordflow}{if}\ (\_side\_by\_side\_stereo)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \_sbs\_left\_dimensions\ =\ sbs\_left\_dimensions;}
\DoxyCodeLine{00561\ \ \ \ \ \_sbs\_right\_dimensions\ =\ sbs\_right\_dimensions;}
\DoxyCodeLine{00562\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00563\ \ \ \ \ \_sbs\_left\_dimensions.set(0.0f,\ 1.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00564\ \ \ \ \ \_sbs\_right\_dimensions.set(0.0f,\ 1.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00565\ \ \ \}}
\DoxyCodeLine{00566\ \}}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00573\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_a5b7fd5e7eba6d10faa8f44271ab381e7}{GraphicsOutput::}}}
\DoxyCodeLine{00574\ \mbox{\hyperlink{classGraphicsOutput_a5b7fd5e7eba6d10faa8f44271ab381e7}{get\_delete\_flag}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00575\ \ \ \textcolor{comment}{//\ We\ only\ delete\ the\ window\ or\ buffer\ automatically\ when\ it\ is\ no\ longer}}
\DoxyCodeLine{00576\ \ \ \textcolor{comment}{//\ associated\ with\ a\ texture.}}
\DoxyCodeLine{00577\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ (int)\_hold\_textures.size();\ i++)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_hold\_textures[i].is\_valid\_pointer())\ \{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00580\ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \}}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{return}\ \_delete\_flag;}
\DoxyCodeLine{00584\ \}}
\DoxyCodeLine{00585\ }
\DoxyCodeLine{00590\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a52e9fc9fe5755f8645999e09c5735e8c}{GraphicsOutput::}}}
\DoxyCodeLine{00591\ \mbox{\hyperlink{classGraphicsOutput_a52e9fc9fe5755f8645999e09c5735e8c}{set\_sort}}(\textcolor{keywordtype}{int}\ sort)\ \{}
\DoxyCodeLine{00592\ \ \ \textcolor{keywordflow}{if}\ (\_sort\ !=\ sort)\ \{}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_gsg\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \_gsg-\/>get\_engine()\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \_gsg-\/>get\_engine()-\/>set\_window\_sort(\textcolor{keyword}{this},\ sort);}
\DoxyCodeLine{00596\ \ \ \ \ \}}
\DoxyCodeLine{00597\ \ \ \}}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00609\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *GraphicsOutput::}
\DoxyCodeLine{00610\ make\_display\_region(\textcolor{keyword}{const}\ LVecBase4\ \&dimensions)\ \{}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordflow}{if}\ (is\_stereo()\ \&\&\ default\_stereo\_camera)\ \{}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{keywordflow}{return}\ make\_stereo\_display\_region(dimensions);}
\DoxyCodeLine{00613\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00614\ \ \ \ \ \textcolor{keywordflow}{return}\ make\_mono\_display\_region(dimensions);}
\DoxyCodeLine{00615\ \ \ \}}
\DoxyCodeLine{00616\ \}}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00628\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *GraphicsOutput::}
\DoxyCodeLine{00629\ make\_mono\_display\_region(\textcolor{keyword}{const}\ LVecBase4\ \&dimensions)\ \{}
\DoxyCodeLine{00630\ \ \ \textcolor{keywordflow}{if}\ (\_side\_by\_side\_stereo)\ \{}
\DoxyCodeLine{00631\ \ \ \ \ \mbox{\hyperlink{classStereoDisplayRegion}{StereoDisplayRegion}}\ *dr\ =\ make\_stereo\_display\_region(dimensions);}
\DoxyCodeLine{00632\ \ \ \ \ dr-\/>get\_left\_eye()-\/>\mbox{\hyperlink{classDisplayRegion_a9b697c1c79a6dcdda29394d633a35c0f}{set\_stereo\_channel}}(Lens::SC\_mono);}
\DoxyCodeLine{00633\ \ \ \ \ dr-\/>get\_right\_eye()-\/>\mbox{\hyperlink{classDisplayRegion_a9b697c1c79a6dcdda29394d633a35c0f}{set\_stereo\_channel}}(Lens::SC\_mono);}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordflow}{return}\ dr;}
\DoxyCodeLine{00635\ \ \ \}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}(\textcolor{keyword}{this},\ dimensions);}
\DoxyCodeLine{00638\ \}}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00646\ \mbox{\hyperlink{classStereoDisplayRegion}{StereoDisplayRegion}}\ *GraphicsOutput::}
\DoxyCodeLine{00647\ make\_stereo\_display\_region(\textcolor{keyword}{const}\ LVecBase4\ \&dimensions)\ \{}
\DoxyCodeLine{00648\ \ \ PT(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}})\ left,\ right;}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{if}\ (\_side\_by\_side\_stereo)\ \{}
\DoxyCodeLine{00651\ \ \ \ \ \textcolor{comment}{//\ On\ a\ side-\/by-\/side\ stereo\ window,\ each\ eye\ gets\ the\ corresponding}}
\DoxyCodeLine{00652\ \ \ \ \ \textcolor{comment}{//\ dimensions\ of\ its\ own\ sub-\/region.}}
\DoxyCodeLine{00653\ \ \ \ \ PN\_stdfloat\ left\_l\ =\ \_sbs\_left\_dimensions[0];}
\DoxyCodeLine{00654\ \ \ \ \ PN\_stdfloat\ left\_b\ =\ \_sbs\_left\_dimensions[2];}
\DoxyCodeLine{00655\ \ \ \ \ PN\_stdfloat\ left\_w\ =\ \_sbs\_left\_dimensions[1]\ -\/\ \_sbs\_left\_dimensions[0];}
\DoxyCodeLine{00656\ \ \ \ \ PN\_stdfloat\ left\_h\ =\ \_sbs\_left\_dimensions[3]\ -\/\ \_sbs\_left\_dimensions[2];}
\DoxyCodeLine{00657\ \ \ \ \ LVecBase4\ left\_dimensions(dimensions[0]\ *\ left\_w\ +\ left\_l,}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[1]\ *\ left\_w\ +\ left\_l,}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[2]\ *\ left\_h\ +\ left\_b,}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[3]\ *\ left\_h\ +\ left\_b);}
\DoxyCodeLine{00661\ \ \ \ \ left\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}(\textcolor{keyword}{this},\ left\_dimensions);}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \ \ PN\_stdfloat\ right\_l\ =\ \_sbs\_right\_dimensions[0];}
\DoxyCodeLine{00664\ \ \ \ \ PN\_stdfloat\ right\_b\ =\ \_sbs\_right\_dimensions[2];}
\DoxyCodeLine{00665\ \ \ \ \ PN\_stdfloat\ right\_w\ =\ \_sbs\_right\_dimensions[1]\ -\/\ \_sbs\_right\_dimensions[0];}
\DoxyCodeLine{00666\ \ \ \ \ PN\_stdfloat\ right\_h\ =\ \_sbs\_right\_dimensions[3]\ -\/\ \_sbs\_right\_dimensions[2];}
\DoxyCodeLine{00667\ \ \ \ \ LVecBase4\ right\_dimensions(dimensions[0]\ *\ right\_w\ +\ right\_l,}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[1]\ *\ right\_w\ +\ right\_l,}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[2]\ *\ right\_h\ +\ right\_b,}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dimensions[3]\ *\ right\_h\ +\ right\_b);}
\DoxyCodeLine{00671\ \ \ \ \ right\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}(\textcolor{keyword}{this},\ right\_dimensions);}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_swap\_eyes)\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *t\ =\ left;}
\DoxyCodeLine{00675\ \ \ \ \ \ \ left\ =\ right;}
\DoxyCodeLine{00676\ \ \ \ \ \ \ right\ =\ t;}
\DoxyCodeLine{00677\ \ \ \ \ \}}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{comment}{//\ Not\ a\ side-\/by-\/side\ stereo\ window;\ thus,\ both\ the\ left\ and\ right\ eyes}}
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{comment}{//\ are\ the\ same\ region:\ the\ region\ specified.}}
\DoxyCodeLine{00682\ \ \ \ \ left\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}(\textcolor{keyword}{this},\ dimensions);}
\DoxyCodeLine{00683\ \ \ \ \ right\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}(\textcolor{keyword}{this},\ dimensions);}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{comment}{//\ In\ this\ case,\ we\ assume\ that\ the\ two\ eyes\ will\ share\ the\ same\ depth}}
\DoxyCodeLine{00686\ \ \ \ \ \textcolor{comment}{//\ buffer,\ which\ means\ the\ right\ eye\ should\ clear\ the\ depth\ buffer\ by}}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{comment}{//\ default.}}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_clear\_depth\_active())\ \{}
\DoxyCodeLine{00689\ \ \ \ \ \ \ right-\/>set\_clear\_depth\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00690\ \ \ \ \ \}}
\DoxyCodeLine{00691\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_clear\_stencil\_active())\ \{}
\DoxyCodeLine{00692\ \ \ \ \ \ \ right-\/>set\_clear\_stencil\_active(\textcolor{keyword}{true});}
\DoxyCodeLine{00693\ \ \ \ \ \}}
\DoxyCodeLine{00694\ \ \ \}}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \ \ PT(\mbox{\hyperlink{classStereoDisplayRegion}{StereoDisplayRegion}})\ stereo\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classStereoDisplayRegion}{StereoDisplayRegion}}(\textcolor{keyword}{this},\ dimensions,}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ left,\ right);}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{keywordflow}{return}\ stereo;}
\DoxyCodeLine{00700\ \}}
\DoxyCodeLine{00701\ }
\DoxyCodeLine{00709\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_aacbc81f98401559130c7f8ea7e8531c4}{GraphicsOutput::}}}
\DoxyCodeLine{00710\ \mbox{\hyperlink{classGraphicsOutput_aacbc81f98401559130c7f8ea7e8531c4}{remove\_display\_region}}(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region)\ \{}
\DoxyCodeLine{00711\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ nassertr(display\_region\ !=\ \_overlay\_display\_region,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \textcolor{keywordflow}{if}\ (display\_region-\/>\mbox{\hyperlink{classDisplayRegion_ab5ec04c0765e71a669b52a3b01d2629a}{is\_stereo}}())\ \{}
\DoxyCodeLine{00716\ \ \ \ \ \mbox{\hyperlink{classStereoDisplayRegion}{StereoDisplayRegion}}\ *sdr;}
\DoxyCodeLine{00717\ \ \ \ \ DCAST\_INTO\_R(sdr,\ display\_region,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00718\ \ \ \ \ do\_remove\_display\_region(sdr-\/>get\_left\_eye());}
\DoxyCodeLine{00719\ \ \ \ \ do\_remove\_display\_region(sdr-\/>get\_right\_eye());}
\DoxyCodeLine{00720\ \ \ \}}
\DoxyCodeLine{00721\ }
\DoxyCodeLine{00722\ \ \ \textcolor{keywordflow}{return}\ do\_remove\_display\_region(display\_region);}
\DoxyCodeLine{00723\ \}}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00729\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a4373fe214b3205c3f4bf77e25eb8490f}{GraphicsOutput::}}}
\DoxyCodeLine{00730\ \mbox{\hyperlink{classGraphicsOutput_a4373fe214b3205c3f4bf77e25eb8490f}{remove\_all\_display\_regions}}()\ \{}
\DoxyCodeLine{00731\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00733\ \ \ TotalDisplayRegions::iterator\ dri;}
\DoxyCodeLine{00734\ \ \ \textcolor{keywordflow}{for}\ (dri\ =\ \_total\_display\_regions.begin();}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ dri\ !=\ \_total\_display\_regions.end();}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ ++dri)\ \{}
\DoxyCodeLine{00737\ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region\ =\ (*dri);}
\DoxyCodeLine{00738\ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_region\ !=\ \_overlay\_display\_region)\ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \textcolor{comment}{//\ Let's\ aggressively\ clean\ up\ the\ display\ region\ too.}}
\DoxyCodeLine{00740\ \ \ \ \ \ \ display\_region-\/>\mbox{\hyperlink{classDisplayRegion_a6a87ed49c740f181a823639665a10a97}{cleanup}}();}
\DoxyCodeLine{00741\ \ \ \ \ \ \ display\_region-\/>\_window\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00742\ \ \ \ \ \}}
\DoxyCodeLine{00743\ \ \ \}}
\DoxyCodeLine{00744\ \ \ \_total\_display\_regions.clear();}
\DoxyCodeLine{00745\ \ \ \_total\_display\_regions.push\_back(\_overlay\_display\_region);}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ OPEN\_ITERATE\_ALL\_STAGES(\_cycler)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ \mbox{\hyperlink{classCycleDataStageWriter}{CDStageWriter}}\ cdata(\_cycler,\ pipeline\_stage);}
\DoxyCodeLine{00749\ \ \ \ \ cdata-\/>\_active\_display\_regions\_stale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00750\ \ \ \}}
\DoxyCodeLine{00751\ \ \ CLOSE\_ITERATE\_ALL\_STAGES(\_cycler);}
\DoxyCodeLine{00752\ \}}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00767\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_acb561728a118abc21f26ab7c431533c0}{GraphicsOutput::}}}
\DoxyCodeLine{00768\ \mbox{\hyperlink{classGraphicsOutput_acb561728a118abc21f26ab7c431533c0}{set\_overlay\_display\_region}}(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region)\ \{}
\DoxyCodeLine{00769\ \ \ nassertv(display\_region-\/>get\_window()\ ==\ \textcolor{keyword}{this});}
\DoxyCodeLine{00770\ \ \ \_overlay\_display\_region\ =\ display\_region;}
\DoxyCodeLine{00771\ \}}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00777\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classGraphicsOutput_aa8a59964fa6d9f9eef3725c5410b446a}{GraphicsOutput::}}}
\DoxyCodeLine{00778\ \mbox{\hyperlink{classGraphicsOutput_aa8a59964fa6d9f9eef3725c5410b446a}{get\_num\_display\_regions}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00779\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00780\ \ \ \textcolor{keywordflow}{return}\ \_total\_display\_regions.size();}
\DoxyCodeLine{00781\ \}}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00789\ PT(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}})\ GraphicsOutput::}
\DoxyCodeLine{00790\ get\_display\_region(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00791\ \ \ determine\_display\_regions();}
\DoxyCodeLine{00792\ \ \ PT(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}})\ result;}
\DoxyCodeLine{00793\ \ \ \{}
\DoxyCodeLine{00794\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{00795\ \ \ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_total\_display\_regions.size())\ \{}
\DoxyCodeLine{00796\ \ \ \ \ \ \ result\ =\ \_total\_display\_regions[n];}
\DoxyCodeLine{00797\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00798\ \ \ \ \ \ \ result\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00799\ \ \ \ \ \}}
\DoxyCodeLine{00800\ \ \ \}}
\DoxyCodeLine{00801\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00802\ \}}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00808\ \textcolor{keywordtype}{int}\ GraphicsOutput::}
\DoxyCodeLine{00809\ get\_num\_active\_display\_regions()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00810\ \ \ determine\_display\_regions();}
\DoxyCodeLine{00811\ \ \ CDReader\ cdata(\_cycler);}
\DoxyCodeLine{00812\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_active\_display\_regions.size();}
\DoxyCodeLine{00813\ \}}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00821\ PT(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}})\ GraphicsOutput::}
\DoxyCodeLine{00822\ get\_active\_display\_region(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00823\ \ \ determine\_display\_regions();}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ CDReader\ cdata(\_cycler);}
\DoxyCodeLine{00826\ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})cdata-\/>\_active\_display\_regions.size())\ \{}
\DoxyCodeLine{00827\ \ \ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_active\_display\_regions[n];}
\DoxyCodeLine{00828\ \ \ \}}
\DoxyCodeLine{00829\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00830\ \}}
\DoxyCodeLine{00831\ }
\DoxyCodeLine{00859\ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *GraphicsOutput::}
\DoxyCodeLine{00860\ make\_texture\_buffer(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex,\ \textcolor{keywordtype}{bool}\ to\_ram,\ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ *fbp)\ \{}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00863\ \ \ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ props;}
\DoxyCodeLine{00864\ \ \ props.set\_rgb\_color(1);}
\DoxyCodeLine{00865\ \ \ props.set\_color\_bits(1);}
\DoxyCodeLine{00866\ \ \ props.set\_alpha\_bits(1);}
\DoxyCodeLine{00867\ \ \ props.set\_depth\_bits(1);}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \textcolor{keywordflow}{if}\ (fbp\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00870\ \ \ \ \ fbp\ =\ \&props;}
\DoxyCodeLine{00871\ \ \ \}}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ \textcolor{keywordtype}{int}\ flags\ =\ GraphicsPipe::BF\_refuse\_window;}
\DoxyCodeLine{00874\ \ \ \textcolor{keywordflow}{if}\ (textures\_power\_2\ !=\ ATS\_none)\ \{}
\DoxyCodeLine{00875\ \ \ \ \ flags\ |=\ GraphicsPipe::BF\_size\_power\_2;}
\DoxyCodeLine{00876\ \ \ \}}
\DoxyCodeLine{00877\ \ \ \textcolor{keywordflow}{if}\ (tex\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{00878\ \ \ \ \ \ \ tex-\/>get\_texture\_type()\ ==\ Texture::TT\_cube\_map)\ \{}
\DoxyCodeLine{00879\ \ \ \ \ flags\ |=\ GraphicsPipe::BF\_size\_square;}
\DoxyCodeLine{00880\ \ \ \}}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00882\ \ \ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *buffer\ =\ get\_gsg()-\/>\mbox{\hyperlink{classGraphicsStateGuardian_a2b3e8a71b60c6a512f7f200655290150}{get\_engine}}()-\/>}
\DoxyCodeLine{00883\ \ \ \ \ make\_output(get\_gsg()-\/>get\_pipe(),}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name,\ get\_child\_sort(),}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *fbp,\ \mbox{\hyperlink{classWindowProperties_a19ea6ad41750bd4e983f64ee9e507d02}{WindowProperties::size}}(x\_size,\ y\_size),}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags,\ get\_gsg(),\ \mbox{\hyperlink{classGraphicsOutput_a9f426f4eafec2f5fc6d207a0828bab5d}{get\_host}}());}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \textcolor{keywordflow}{if}\ (buffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \textcolor{keywordflow}{if}\ (buffer-\/>get\_gsg()\ ==\ \textcolor{keyword}{nullptr}\ ||}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \ \ buffer-\/>get\_gsg()-\/>get\_prepared\_objects()\ !=\ get\_gsg()-\/>get\_prepared\_objects())\ \{}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ newly-\/created\ buffer\ doesn't\ share\ texture\ objects\ with\ the}}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \textcolor{comment}{//\ current\ GSG,\ then\ we\ will\ have\ to\ force\ the\ texture\ copy\ to\ go}}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \textcolor{comment}{//\ through\ RAM.}}
\DoxyCodeLine{00894\ \ \ \ \ \ \ to\_ram\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00895\ \ \ \ \ \}}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ buffer-\/>add\_render\_texture(tex,\ to\_ram\ ?\ RTM\_copy\_ram\ :\ RTM\_bind\_or\_copy);}
\DoxyCodeLine{00898\ \ \ \ \ \textcolor{keywordflow}{return}\ buffer;}
\DoxyCodeLine{00899\ \ \ \}}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00902\ \}}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00919\ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *\mbox{\hyperlink{classGraphicsOutput_ad36556ad17458f84400f63ae38112b93}{GraphicsOutput::}}}
\DoxyCodeLine{00920\ \mbox{\hyperlink{classGraphicsOutput_ad36556ad17458f84400f63ae38112b93}{make\_cube\_map}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ size,\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&camera\_rig,}
\DoxyCodeLine{00921\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classBitMask}{DrawMask}}\ camera\_mask,\ \textcolor{keywordtype}{bool}\ to\_ram,\ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ *fbp)\ \{}
\DoxyCodeLine{00922\ \ \ \textcolor{keywordflow}{if}\ (!to\_ram)\ \{}
\DoxyCodeLine{00923\ \ \ \ \ \textcolor{comment}{//\ Check\ the\ limits\ imposed\ by\ the\ GSG.\ \ (However,\ if\ we're\ rendering\ the}}
\DoxyCodeLine{00924\ \ \ \ \ \textcolor{comment}{//\ texture\ to\ RAM\ only,\ these\ limits\ may\ be\ irrelevant.)}}
\DoxyCodeLine{00925\ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}}\ *gsg\ =\ get\_gsg();}
\DoxyCodeLine{00926\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_dimension\ =\ gsg-\/>get\_max\_cube\_map\_dimension();}
\DoxyCodeLine{00927\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_dimension\ ==\ 0\ ||\ !gsg-\/>get\_supports\_cube\_map())\ \{}
\DoxyCodeLine{00928\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ GSG\ doesn't\ support\ cube\ mapping;\ too\ bad\ for\ you.}}
\DoxyCodeLine{00929\ \ \ \ \ \ \ display\_cat.warning()}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Cannot\ make\ dynamic\ cube\ map;\ GSG\ does\ not\ support\ cube\ maps.\(\backslash\)n"{}};}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00932\ \ \ \ \ \}}
\DoxyCodeLine{00933\ \ \ \ \ \textcolor{keywordflow}{if}\ (max\_dimension\ >\ 0)\ \{}
\DoxyCodeLine{00934\ \ \ \ \ \ \ size\ =\ std::min(max\_dimension,\ size);}
\DoxyCodeLine{00935\ \ \ \ \ \}}
\DoxyCodeLine{00936\ \ \ \}}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \textcolor{comment}{//\ Usually,\ we\ want\ the\ whole\ camera\_rig\ to\ keep\ itself\ unrotated\ with}}
\DoxyCodeLine{00939\ \ \ \textcolor{comment}{//\ respect\ to\ the\ world\ coordinate\ space,\ so\ the\ user\ can\ apply}}
\DoxyCodeLine{00940\ \ \ \textcolor{comment}{//\ TexGenAttrib::M\_world\_cube\_map\ to\ the\ objects\ on\ which\ the\ cube\ map}}
\DoxyCodeLine{00941\ \ \ \textcolor{comment}{//\ texture\ is\ applied.\ \ If\ for\ some\ reason\ the\ user\ doesn't\ want\ this}}
\DoxyCodeLine{00942\ \ \ \textcolor{comment}{//\ behavior,\ he\ can\ take\ this\ effect\ off\ again.}}
\DoxyCodeLine{00943\ \ \ camera\_rig.node()-\/>\mbox{\hyperlink{classPandaNode_aa342abc462d06e1e11edc873927dbcd2}{set\_effect}}(CompassEffect::make(\mbox{\hyperlink{classNodePath}{NodePath}}()));}
\DoxyCodeLine{00944\ }
\DoxyCodeLine{00945\ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ tex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture}{Texture}}(name);}
\DoxyCodeLine{00946\ \ \ tex-\/>setup\_cube\_map();}
\DoxyCodeLine{00947\ \ \ tex-\/>set\_wrap\_u(SamplerState::WM\_clamp);}
\DoxyCodeLine{00948\ \ \ tex-\/>set\_wrap\_v(SamplerState::WM\_clamp);}
\DoxyCodeLine{00949\ \ \ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *buffer;}
\DoxyCodeLine{00950\ }
\DoxyCodeLine{00951\ \ \ buffer\ =\ make\_texture\_buffer(name,\ size,\ size,\ tex,\ to\_ram,\ fbp);}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00953\ \ \ \textcolor{comment}{//\ We\ don't\ need\ to\ clear\ the\ overall\ buffer;\ instead,\ we'll\ clear\ each}}
\DoxyCodeLine{00954\ \ \ \textcolor{comment}{//\ display\ region.}}
\DoxyCodeLine{00955\ \ \ buffer-\/>set\_clear\_color\_active(\textcolor{keyword}{false});}
\DoxyCodeLine{00956\ \ \ buffer-\/>set\_clear\_depth\_active(\textcolor{keyword}{false});}
\DoxyCodeLine{00957\ \ \ buffer-\/>set\_clear\_stencil\_active(\textcolor{keyword}{false});}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00959\ \ \ PT(\mbox{\hyperlink{classLens}{Lens}})\ lens\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPerspectiveLens}{PerspectiveLens}}(90,\ 90);}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00961\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 6;\ i++)\ \{}
\DoxyCodeLine{00962\ \ \ \ \ PT(\mbox{\hyperlink{classCamera}{Camera}})\ camera\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classCamera}{Camera}}(cube\_faces[i].\_name);}
\DoxyCodeLine{00963\ \ \ \ \ camera-\/>set\_lens(lens);}
\DoxyCodeLine{00964\ \ \ \ \ camera-\/>set\_camera\_mask(camera\_mask);}
\DoxyCodeLine{00965\ \ \ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ camera\_np\ =\ camera\_rig.attach\_new\_node(camera);}
\DoxyCodeLine{00966\ \ \ \ \ camera\_np.look\_at(cube\_faces[i].\_look\_at,\ cube\_faces[i].\_up);}
\DoxyCodeLine{00967\ }
\DoxyCodeLine{00968\ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr;}
\DoxyCodeLine{00969\ \ \ \ \ dr\ =\ buffer-\/>make\_display\_region();}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \ \ dr-\/>\mbox{\hyperlink{classDisplayRegion_a505f39a6135a6911a5addcee0d3c27d7}{set\_target\_tex\_page}}(i);}
\DoxyCodeLine{00972\ \ \ \ \ dr-\/>copy\_clear\_settings(*\textcolor{keyword}{this});}
\DoxyCodeLine{00973\ \ \ \ \ dr-\/>\mbox{\hyperlink{classDisplayRegion_ab6da947e00ed8c02c353bcabebcaa928}{set\_camera}}(camera\_np);}
\DoxyCodeLine{00974\ \ \ \}}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ \ \ \textcolor{keywordflow}{return}\ buffer;}
\DoxyCodeLine{00977\ \}}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00988\ PT(\mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}})\ GraphicsOutput::}
\DoxyCodeLine{00989\ save\_async\_screenshot(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&filename,\ \textcolor{keyword}{const}\ std::string\ \&image\_comment)\ \{}
\DoxyCodeLine{00990\ \ \ PT(\mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}})\ request\ =\ get\_async\_screenshot();}
\DoxyCodeLine{00991\ \ \ request-\/>add\_output\_file(filename,\ image\_comment);}
\DoxyCodeLine{00992\ \ \ \textcolor{keywordflow}{return}\ request;}
\DoxyCodeLine{00993\ \}}
\DoxyCodeLine{00994\ }
\DoxyCodeLine{01005\ PT(\mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}})\ GraphicsOutput::}
\DoxyCodeLine{01006\ get\_async\_screenshot()\ \{}
\DoxyCodeLine{01007\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{01008\ \ \ CDWriter\ cdata(\_cycler,\ current\_thread);}
\DoxyCodeLine{01009\ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_screenshot\_request\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01010\ \ \ \ \ PT(\mbox{\hyperlink{classTexture}{Texture}})\ texture\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture}{Texture}}(\textcolor{stringliteral}{"{}screenshot\ of\ "{}}\ +\ get\_name());}
\DoxyCodeLine{01011\ \ \ \ \ cdata-\/>\_screenshot\_request\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}}(texture);}
\DoxyCodeLine{01012\ \ \ \}}
\DoxyCodeLine{01013\ \ \ \textcolor{keywordflow}{return}\ cdata-\/>\_screenshot\_request;}
\DoxyCodeLine{01014\ \}}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01027\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \mbox{\hyperlink{classGraphicsOutput_a7816596975e45ba518e12024718c2a4d}{GraphicsOutput::}}}
\DoxyCodeLine{01028\ \mbox{\hyperlink{classGraphicsOutput_a7816596975e45ba518e12024718c2a4d}{get\_texture\_card}}()\ \{}
\DoxyCodeLine{01029\ \ \ \textcolor{keywordflow}{if}\ (\_texture\_card\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01030\ \ \ \ \ PT(\mbox{\hyperlink{classGeomVertexData}{GeomVertexData}})\ vdata\ =\ create\_texture\_card\_vdata(get\_x\_size(),\ get\_y\_size());}
\DoxyCodeLine{01031\ \ \ \ \ PT(\mbox{\hyperlink{classGeomTristrips}{GeomTristrips}})\ strip\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTristrips}{GeomTristrips}}(Geom::UH\_static);}
\DoxyCodeLine{01032\ \ \ \ \ strip-\/>set\_shade\_model(Geom::SM\_uniform);}
\DoxyCodeLine{01033\ \ \ \ \ strip-\/>add\_next\_vertices(4);}
\DoxyCodeLine{01034\ \ \ \ \ strip-\/>close\_primitive();}
\DoxyCodeLine{01035\ \ \ \ \ PT(\mbox{\hyperlink{classGeom}{Geom}})\ geom\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeom}{Geom}}(vdata);}
\DoxyCodeLine{01036\ \ \ \ \ geom-\/>add\_primitive(strip);}
\DoxyCodeLine{01037\ \ \ \ \ \_texture\_card\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomNode}{GeomNode}}(\textcolor{stringliteral}{"{}texture\ card"{}});}
\DoxyCodeLine{01038\ \ \ \ \ \_texture\_card-\/>add\_geom(geom);}
\DoxyCodeLine{01039\ \ \ \}}
\DoxyCodeLine{01040\ }
\DoxyCodeLine{01041\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ path(\textcolor{stringliteral}{"{}texture\ card"{}});}
\DoxyCodeLine{01042\ \ \ path.node()-\/>add\_child(\_texture\_card);}
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01044\ \ \ \textcolor{comment}{//\ The\ texture\ card,\ by\ default,\ is\ textured\ with\ the\ first\ render-\/to-\/}}
\DoxyCodeLine{01045\ \ \ \textcolor{comment}{//\ texture\ output\ texture.\ \ Depth\ and\ stencil\ textures\ are\ ignored.\ \ The}}
\DoxyCodeLine{01046\ \ \ \textcolor{comment}{//\ user\ can\ freely\ alter\ the\ card's\ texture\ attrib.}}
\DoxyCodeLine{01047\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01048\ \ \ RenderTextures::const\_iterator\ ri;}
\DoxyCodeLine{01049\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdata-\/>\_textures.begin();\ ri\ !=\ cdata-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01050\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ (*ri).\_texture;}
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{keywordflow}{if}\ ((texture-\/>get\_format()\ !=\ Texture::F\_depth\_stencil))\ \{}
\DoxyCodeLine{01052\ \ \ \ \ \ \ path.set\_texture(texture,\ 0);}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01054\ \ \ \ \ \}}
\DoxyCodeLine{01055\ \ \ \}}
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \ \ \textcolor{keywordflow}{return}\ path;}
\DoxyCodeLine{01058\ \}}
\DoxyCodeLine{01059\ }
\DoxyCodeLine{01064\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_a5313295e013319e536b642e44ed7972b}{GraphicsOutput::}}}
\DoxyCodeLine{01065\ \mbox{\hyperlink{classGraphicsOutput_a5313295e013319e536b642e44ed7972b}{share\_depth\_buffer}}(\mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *graphics\_output)\ \{}
\DoxyCodeLine{01066\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01067\ \}}
\DoxyCodeLine{01068\ }
\DoxyCodeLine{01072\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a741cdd58f8e458c1ba5bb7967bc599b7}{GraphicsOutput::}}}
\DoxyCodeLine{01073\ \mbox{\hyperlink{classGraphicsOutput_a741cdd58f8e458c1ba5bb7967bc599b7}{unshare\_depth\_buffer}}()\ \{}
\DoxyCodeLine{01074\ \}}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01081\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_a7d4f7e4d59b118a2eee0e9e3f8cd41b5}{GraphicsOutput::}}}
\DoxyCodeLine{01082\ \mbox{\hyperlink{classGraphicsOutput_a7d4f7e4d59b118a2eee0e9e3f8cd41b5}{get\_supports\_render\_texture}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01083\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01084\ \}}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01090\ \textcolor{keywordtype}{bool}\ GraphicsOutput::}
\DoxyCodeLine{01091\ flip\_ready()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01092\ \ \ \textcolor{keywordflow}{return}\ \_flip\_ready;}
\DoxyCodeLine{01093\ \}}
\DoxyCodeLine{01094\ }
\DoxyCodeLine{01100\ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *\mbox{\hyperlink{classGraphicsOutput_a9f426f4eafec2f5fc6d207a0828bab5d}{GraphicsOutput::}}}
\DoxyCodeLine{01101\ \mbox{\hyperlink{classGraphicsOutput_a9f426f4eafec2f5fc6d207a0828bab5d}{get\_host}}()\ \{}
\DoxyCodeLine{01102\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{01103\ \}}
\DoxyCodeLine{01104\ }
\DoxyCodeLine{01110\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_ae397e7f8a1d0b5f00100c66ecf10f905}{GraphicsOutput::}}}
\DoxyCodeLine{01111\ \mbox{\hyperlink{classGraphicsOutput_ae397e7f8a1d0b5f00100c66ecf10f905}{request\_open}}()\ \{}
\DoxyCodeLine{01112\ \}}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01120\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_ab0de4fbfde41ea0a0408cda33cc82bc1}{GraphicsOutput::}}}
\DoxyCodeLine{01121\ \mbox{\hyperlink{classGraphicsOutput_ab0de4fbfde41ea0a0408cda33cc82bc1}{request\_close}}()\ \{}
\DoxyCodeLine{01122\ \}}
\DoxyCodeLine{01123\ }
\DoxyCodeLine{01128\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_af4b173e26f7a4b7dd06ad0afa0c1e932}{GraphicsOutput::}}}
\DoxyCodeLine{01129\ \mbox{\hyperlink{classGraphicsOutput_af4b173e26f7a4b7dd06ad0afa0c1e932}{set\_close\_now}}()\ \{}
\DoxyCodeLine{01130\ \}}
\DoxyCodeLine{01131\ }
\DoxyCodeLine{01136\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a9eb942071e2b60dd0c8e66a49d67685c}{GraphicsOutput::}}}
\DoxyCodeLine{01137\ \mbox{\hyperlink{classGraphicsOutput_a9eb942071e2b60dd0c8e66a49d67685c}{reset\_window}}(\textcolor{keywordtype}{bool}\ swapchain)\ \{}
\DoxyCodeLine{01138\ \ \ display\_cat.info()}
\DoxyCodeLine{01139\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Resetting\ "{}}\ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01140\ \}}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01146\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a3df842abab4180feb42e929f712e234b}{GraphicsOutput::}}}
\DoxyCodeLine{01147\ \mbox{\hyperlink{classGraphicsOutput_a3df842abab4180feb42e929f712e234b}{clear\_pipe}}()\ \{}
\DoxyCodeLine{01148\ \ \ \_pipe\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01149\ \}}
\DoxyCodeLine{01150\ }
\DoxyCodeLine{01157\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a9f455a23a8892292bde821580495187e}{GraphicsOutput::}}}
\DoxyCodeLine{01158\ \mbox{\hyperlink{classGraphicsOutput_a9f455a23a8892292bde821580495187e}{set\_size\_and\_recalc}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{01159\ \ \ \_size.set(x,\ y);}
\DoxyCodeLine{01160\ \ \ \_has\_size\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01161\ }
\DoxyCodeLine{01162\ \ \ \_is\_nonzero\_size\ =\ (x\ >\ 0\ \&\&\ y\ >\ 0);}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ \ \ \textcolor{keywordtype}{int}\ fb\_x\_size\ =\ get\_fb\_x\_size();}
\DoxyCodeLine{01165\ \ \ \textcolor{keywordtype}{int}\ fb\_y\_size\ =\ get\_fb\_y\_size();}
\DoxyCodeLine{01166\ }
\DoxyCodeLine{01167\ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr\ :\ \_total\_display\_regions)\ \{}
\DoxyCodeLine{01168\ \ \ \ \ dr-\/>compute\_pixels\_all\_stages(fb\_x\_size,\ fb\_y\_size);}
\DoxyCodeLine{01169\ \ \ \}}
\DoxyCodeLine{01170\ }
\DoxyCodeLine{01171\ \ \ \textcolor{keywordflow}{if}\ (\_texture\_card\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ \_texture\_card-\/>get\_num\_geoms()\ >\ 0)\ \{}
\DoxyCodeLine{01172\ \ \ \ \ \_texture\_card-\/>modify\_geom(0)-\/>set\_vertex\_data(create\_texture\_card\_vdata(x,\ y));}
\DoxyCodeLine{01173\ \ \ \}}
\DoxyCodeLine{01174\ \}}
\DoxyCodeLine{01175\ }
\DoxyCodeLine{01183\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_aead3c39332275a61c14928bf3b63ba5c}{GraphicsOutput::}}}
\DoxyCodeLine{01184\ \mbox{\hyperlink{classGraphicsOutput_aead3c39332275a61c14928bf3b63ba5c}{clear}}(\mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{01185\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classDrawableRegion_a7cf04a992ac977ba7d706c81871ed1b5}{is\_any\_clear\_active}}())\ \{}
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_cat.is\_spam())\ \{}
\DoxyCodeLine{01187\ \ \ \ \ \ \ display\_cat.spam()}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}clear():\ "{}}\ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ (\textcolor{keywordtype}{void}\ *)\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01190\ \ \ \ \ \}}
\DoxyCodeLine{01191\ }
\DoxyCodeLine{01192\ \ \ \ \ nassertv(\_gsg\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \ \ \ \ \mbox{\hyperlink{classDisplayRegionPipelineReader}{DisplayRegionPipelineReader}}\ dr\_reader(\_overlay\_display\_region,\ current\_thread);}
\DoxyCodeLine{01195\ \ \ \ \ \_gsg-\/>prepare\_display\_region(\&dr\_reader);}
\DoxyCodeLine{01196\ \ \ \ \ \_gsg-\/>clear(\textcolor{keyword}{this});}
\DoxyCodeLine{01197\ \ \ \}}
\DoxyCodeLine{01198\ \}}
\DoxyCodeLine{01199\ }
\DoxyCodeLine{01206\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_a82bbfa980adaaa4abcdaa8c567182db1}{GraphicsOutput::}}}
\DoxyCodeLine{01207\ \mbox{\hyperlink{classGraphicsOutput_a82bbfa980adaaa4abcdaa8c567182db1}{begin\_frame}}(FrameMode\ mode,\ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{01208\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01209\ \}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01216\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a51bf142d4d882476b8a089581474dd0f}{GraphicsOutput::}}}
\DoxyCodeLine{01217\ \mbox{\hyperlink{classGraphicsOutput_a51bf142d4d882476b8a089581474dd0f}{end\_frame}}(FrameMode\ mode,\ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{01218\ \}}
\DoxyCodeLine{01219\ }
\DoxyCodeLine{01225\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a5ebecf1b66237530202157017494c026}{GraphicsOutput::}}}
\DoxyCodeLine{01226\ \mbox{\hyperlink{classGraphicsOutput_a5ebecf1b66237530202157017494c026}{change\_scenes}}(\mbox{\hyperlink{classDisplayRegionPipelineReader}{DisplayRegionPipelineReader}}\ *new\_dr)\ \{}
\DoxyCodeLine{01227\ \ \ \textcolor{keywordtype}{int}\ new\_target\_tex\_page\ =\ new\_dr-\/>get\_target\_tex\_page();}
\DoxyCodeLine{01228\ }
\DoxyCodeLine{01229\ \ \ \textcolor{keywordflow}{if}\ (new\_target\_tex\_page\ !=\ -\/1\ \&\&\ new\_target\_tex\_page\ !=\ \_target\_tex\_page)\ \{}
\DoxyCodeLine{01230\ }
\DoxyCodeLine{01231\ \ \ \ \ \textcolor{keywordflow}{if}\ (new\_target\_tex\_page\ ==\ -\/1)\ \{}
\DoxyCodeLine{01232\ \ \ \ \ \ \ new\_target\_tex\_page\ =\ 0;}
\DoxyCodeLine{01233\ \ \ \ \ \}}
\DoxyCodeLine{01234\ \ \ \ \ \textcolor{keywordtype}{int}\ old\_target\_tex\_page\ =\ \_target\_tex\_page;}
\DoxyCodeLine{01235\ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *old\_page\_dr\ =\ \_prev\_page\_dr;}
\DoxyCodeLine{01236\ \ \ \ \ \_target\_tex\_page\ =\ new\_target\_tex\_page;}
\DoxyCodeLine{01237\ \ \ \ \ \_prev\_page\_dr\ =\ new\_dr-\/>get\_object();}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01240\ \ \ \ \ RenderTextures::const\_iterator\ ri;}
\DoxyCodeLine{01241\ \ \ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdata-\/>\_textures.begin();\ ri\ !=\ cdata-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01242\ \ \ \ \ \ \ RenderTextureMode\ rtm\_mode\ =\ (*ri).\_rtm\_mode;}
\DoxyCodeLine{01243\ \ \ \ \ \ \ RenderTexturePlane\ plane\ =\ (*ri).\_plane;}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ (*ri).\_texture;}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rtm\_mode\ !=\ RTM\_none)\ \{}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rtm\_mode\ ==\ RTM\_bind\_or\_copy\ ||\ rtm\_mode\ ==\ RTM\_bind\_layered)\ \{}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ render-\/to-\/texture\ mode,\ switch\ the\ rendering\ backend\ to\ the}}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ new\ page,\ so\ that\ the\ subsequent\ frame\ will\ be\ rendered\ to\ the}}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ correct\ page.}}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput_ad17ff4a7d5b06a77ccb95423315411a5}{select\_target\_tex\_page}}(\_target\_tex\_page);}
\DoxyCodeLine{01251\ }
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (old\_target\_tex\_page\ !=\ -\/1)\ \{}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ copy-\/to-\/texture\ mode,\ copy\ the\ just-\/rendered\ framebuffer\ to}}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ old\ texture\ page.}}
\DoxyCodeLine{01255\ }
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ \ \ nassertv(old\_page\_dr\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_cat.is\_debug())\ \{}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \ \ \ \ display\_cat.debug()}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Copying\ texture\ for\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ at\ scene\ change.\(\backslash\)n"{}};}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \ \ \ \ display\_cat.debug()}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}target\_tex\_page\ =\ "{}}\ <<\ old\_target\_tex\_page\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ buffer\ =\ \_gsg-\/>get\_render\_buffer(get\_draw\_buffer\_type(),}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_fb\_properties());}
\DoxyCodeLine{01265\ }
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_color\ \&\&\ \_fb\_properties.is\_stereo())\ \{}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We've\ got\ two\ texture\ views\ to\ copy.}}
\DoxyCodeLine{01268\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ left(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_right);}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ right(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_left);}
\DoxyCodeLine{01270\ }
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rtm\_mode\ ==\ RTM\_copy\_ram)\ \{}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ old\_target\_tex\_page,}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ left);}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 1,\ old\_target\_tex\_page,}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ right);}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 0,\ old\_target\_tex\_page,}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ left);}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 1,\ old\_target\_tex\_page,}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ right);}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rtm\_mode\ ==\ RTM\_copy\_ram)\ \{}
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ old\_target\_tex\_page,}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ buffer);}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 0,\ old\_target\_tex\_page,}
\DoxyCodeLine{01288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_page\_dr,\ buffer);}
\DoxyCodeLine{01289\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01293\ \ \ \ \ \}}
\DoxyCodeLine{01294\ \ \ \}}
\DoxyCodeLine{01295\ \}}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01303\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_ad17ff4a7d5b06a77ccb95423315411a5}{GraphicsOutput::}}}
\DoxyCodeLine{01304\ \mbox{\hyperlink{classGraphicsOutput_ad17ff4a7d5b06a77ccb95423315411a5}{select\_target\_tex\_page}}(\textcolor{keywordtype}{int})\ \{}
\DoxyCodeLine{01305\ \}}
\DoxyCodeLine{01306\ }
\DoxyCodeLine{01318\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a2406222f6dd4df14b3e2c4c5ac8c1001}{GraphicsOutput::}}}
\DoxyCodeLine{01319\ \mbox{\hyperlink{classGraphicsOutput_a2406222f6dd4df14b3e2c4c5ac8c1001}{begin\_flip}}()\ \{}
\DoxyCodeLine{01320\ \}}
\DoxyCodeLine{01321\ }
\DoxyCodeLine{01331\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a0319f5e31d729371b20b8ecd6b74c2a8}{GraphicsOutput::}}}
\DoxyCodeLine{01332\ \mbox{\hyperlink{classGraphicsOutput_a0319f5e31d729371b20b8ecd6b74c2a8}{ready\_flip}}()\ \{}
\DoxyCodeLine{01333\ \}}
\DoxyCodeLine{01334\ }
\DoxyCodeLine{01342\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a593a9030f0b90ee588b1006df9aee604}{GraphicsOutput::}}}
\DoxyCodeLine{01343\ \mbox{\hyperlink{classGraphicsOutput_a593a9030f0b90ee588b1006df9aee604}{end\_flip}}()\ \{}
\DoxyCodeLine{01344\ \ \ \_flip\_ready\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01345\ \}}
\DoxyCodeLine{01346\ }
\DoxyCodeLine{01353\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a03a5e96eff401a8f96cf38676f07a1bd}{GraphicsOutput::}}}
\DoxyCodeLine{01354\ \mbox{\hyperlink{classGraphicsOutput_a03a5e96eff401a8f96cf38676f07a1bd}{process\_events}}()\ \{}
\DoxyCodeLine{01355\ \}}
\DoxyCodeLine{01356\ }
\DoxyCodeLine{01360\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a8c735602f0df5480e872e530e197f99d}{GraphicsOutput::}}}
\DoxyCodeLine{01361\ \mbox{\hyperlink{classGraphicsOutput_a8c735602f0df5480e872e530e197f99d}{pixel\_factor\_changed}}()\ \{}
\DoxyCodeLine{01362\ \ \ \textcolor{keywordflow}{if}\ (\_has\_size)\ \{}
\DoxyCodeLine{01363\ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput_a9f455a23a8892292bde821580495187e}{set\_size\_and\_recalc}}(get\_x\_size(),\ get\_y\_size());}
\DoxyCodeLine{01364\ \ \ \}}
\DoxyCodeLine{01365\ \}}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01371\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a68b6803a3669c2200c8cca5cdbe7cb3c}{GraphicsOutput::}}}
\DoxyCodeLine{01372\ \mbox{\hyperlink{classGraphicsOutput_a68b6803a3669c2200c8cca5cdbe7cb3c}{prepare\_for\_deletion}}()\ \{}
\DoxyCodeLine{01373\ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01374\ \ \ cdata-\/>\_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01375\ }
\DoxyCodeLine{01376\ \ \ \textcolor{comment}{//\ If\ we\ were\ rendering\ directly\ to\ texture,\ we\ can't\ delete\ the\ buffer}}
\DoxyCodeLine{01377\ \ \ \textcolor{comment}{//\ until\ all\ the\ textures\ are\ gone\ too.}}
\DoxyCodeLine{01378\ \ \ RenderTextures::iterator\ ri;}
\DoxyCodeLine{01379\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdata-\/>\_textures.begin();\ ri\ !=\ cdata-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01380\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ri).\_rtm\_mode\ ==\ RTM\_bind\_or\_copy\ ||\ (*ri).\_rtm\_mode\ ==\ RTM\_bind\_layered)\ \{}
\DoxyCodeLine{01381\ \ \ \ \ \ \ \_hold\_textures.push\_back((*ri).\_texture);}
\DoxyCodeLine{01382\ \ \ \ \ \}}
\DoxyCodeLine{01383\ \ \ \}}
\DoxyCodeLine{01384\ \ \ cdata-\/>\_textures.clear();}
\DoxyCodeLine{01385\ }
\DoxyCodeLine{01386\ \ \ \_delete\_flag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \ \ \textcolor{comment}{//\ We\ have\ to\ be\ sure\ to\ remove\ all\ of\ the\ display\ regions\ immediately,\ so}}
\DoxyCodeLine{01389\ \ \ \textcolor{comment}{//\ that\ circular\ reference\ counts\ can\ be\ cleared\ up\ (each\ display\ region}}
\DoxyCodeLine{01390\ \ \ \textcolor{comment}{//\ keeps\ a\ pointer\ to\ a\ CullResult,\ which\ can\ hold\ all\ sorts\ of\ pointers).}}
\DoxyCodeLine{01391\ \ \ \mbox{\hyperlink{classGraphicsOutput_a4373fe214b3205c3f4bf77e25eb8490f}{remove\_all\_display\_regions}}();}
\DoxyCodeLine{01392\ \}}
\DoxyCodeLine{01393\ }
\DoxyCodeLine{01400\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_a607a62cfe237e3e5927f98f850ddcccb}{GraphicsOutput::}}}
\DoxyCodeLine{01401\ \mbox{\hyperlink{classGraphicsOutput_a607a62cfe237e3e5927f98f850ddcccb}{promote\_to\_copy\_texture}}()\ \{}
\DoxyCodeLine{01402\ \ \ \mbox{\hyperlink{classCycleDataLockedReader}{CDLockedReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01403\ \ \ RenderTextures::const\_iterator\ ri;}
\DoxyCodeLine{01404\ }
\DoxyCodeLine{01405\ \ \ \textcolor{keywordtype}{bool}\ any\_bind\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01406\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdata-\/>\_textures.begin();\ ri\ !=\ cdata-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01407\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ri).\_rtm\_mode\ ==\ RTM\_bind\_or\_copy)\ \{}
\DoxyCodeLine{01408\ \ \ \ \ \ \ any\_bind\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01409\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01410\ \ \ \ \ \}}
\DoxyCodeLine{01411\ \ \ \}}
\DoxyCodeLine{01412\ \ \ \textcolor{keywordflow}{if}\ (any\_bind)\ \{}
\DoxyCodeLine{01413\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdataw(((\mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *)\textcolor{keyword}{this})-\/>\_cycler,\ cdata,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01414\ \ \ \ \ RenderTextures::iterator\ ri;}
\DoxyCodeLine{01415\ \ \ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdataw-\/>\_textures.begin();\ ri\ !=\ cdataw-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01416\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ri).\_rtm\_mode\ ==\ RTM\_bind\_or\_copy)\ \{}
\DoxyCodeLine{01417\ \ \ \ \ \ \ \ \ (*ri).\_rtm\_mode\ =\ RTM\_copy\_texture;}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01419\ \ \ \ \ \}}
\DoxyCodeLine{01420\ \ \ \}}
\DoxyCodeLine{01421\ \}}
\DoxyCodeLine{01422\ }
\DoxyCodeLine{01430\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGraphicsOutput_ab529b939d7812f480d2c56752456acf5}{GraphicsOutput::}}}
\DoxyCodeLine{01431\ \mbox{\hyperlink{classGraphicsOutput_ab529b939d7812f480d2c56752456acf5}{copy\_to\_textures}}()\ \{}
\DoxyCodeLine{01432\ \ \ \textcolor{keywordtype}{bool}\ okflag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01433\ }
\DoxyCodeLine{01434\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{01435\ \ \ RenderTextures::const\_iterator\ ri;}
\DoxyCodeLine{01436\ \ \ \textcolor{keywordflow}{for}\ (ri\ =\ cdata-\/>\_textures.begin();\ ri\ !=\ cdata-\/>\_textures.end();\ ++ri)\ \{}
\DoxyCodeLine{01437\ \ \ \ \ RenderTextureMode\ rtm\_mode\ =\ (*ri).\_rtm\_mode;}
\DoxyCodeLine{01438\ \ \ \ \ \textcolor{keywordflow}{if}\ ((rtm\_mode\ ==\ RTM\_none)\ ||\ (rtm\_mode\ ==\ RTM\_bind\_or\_copy))\ \{}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01440\ \ \ \ \ \}}
\DoxyCodeLine{01441\ }
\DoxyCodeLine{01442\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ (*ri).\_texture;}
\DoxyCodeLine{01443\ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_copy\_texture\_pcollector);}
\DoxyCodeLine{01444\ }
\DoxyCodeLine{01445\ \ \ \ \ \textcolor{keywordflow}{if}\ ((rtm\_mode\ ==\ RTM\_copy\_texture)||}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ (rtm\_mode\ ==\ RTM\_copy\_ram)||}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ ((rtm\_mode\ ==\ RTM\_triggered\_copy\_texture)\&\&(\_trigger\_copy))||}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ ((rtm\_mode\ ==\ RTM\_triggered\_copy\_ram)\&\&(\_trigger\_copy)))\ \{}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_cat.is\_debug())\ \{}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ display\_cat.debug()}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Copying\ texture\ for\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ at\ frame\ end.\(\backslash\)n"{}};}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ display\_cat.debug()}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}target\_tex\_page\ =\ "{}}\ <<\ \_target\_tex\_page\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01455\ \ \ \ \ \ \ RenderTexturePlane\ plane\ =\ (*ri).\_plane;}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ buffer(\_gsg,\ \mbox{\hyperlink{classDrawableRegion_a56dc4a58eab41fbf0918aa67f7779461}{DrawableRegion::get\_renderbuffer\_type}}(plane));}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_color)\ \{}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ buffer\ =\ \_gsg-\/>get\_render\_buffer(get\_draw\_buffer\_type(),}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_fb\_properties());}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01461\ }
\DoxyCodeLine{01462\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ copied\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr\ =\ \_overlay\_display\_region;}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_prev\_page\_dr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ dr\ =\ \_prev\_page\_dr;}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01467\ }
\DoxyCodeLine{01468\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (plane\ ==\ RTP\_color\ \&\&\ \_fb\_properties.is\_stereo())\ \{}
\DoxyCodeLine{01469\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We've\ got\ two\ texture\ views\ to\ copy.}}
\DoxyCodeLine{01470\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ left(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_right);}
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ right(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_left);}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rtm\_mode\ ==\ RTM\_copy\_ram)||(rtm\_mode\ ==\ RTM\_triggered\_copy\_ram))\ \{}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ left);}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 1,\ \_target\_tex\_page,}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ right)\ \&\&\ copied;}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01479\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ left);}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 1,\ \_target\_tex\_page,}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ right)\ \&\&\ copied;}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((rtm\_mode\ ==\ RTM\_copy\_ram)||(rtm\_mode\ ==\ RTM\_triggered\_copy\_ram))\ \{}
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ buffer);}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \ \ copied\ =\ \_gsg-\/>framebuffer\_copy\_to\_texture(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ buffer);}
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!copied)\ \{}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ okflag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01496\ \ \ \ \ \}}
\DoxyCodeLine{01497\ \ \ \}}
\DoxyCodeLine{01498\ \ \ \textcolor{keywordflow}{if}\ (\_trigger\_copy\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01499\ \ \ \ \ \_trigger\_copy-\/>set\_result(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{01500\ \ \ \ \ \_trigger\_copy\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01501\ \ \ \}}
\DoxyCodeLine{01502\ }
\DoxyCodeLine{01503\ \ \ \textcolor{keywordflow}{return}\ okflag;}
\DoxyCodeLine{01504\ \}}
\DoxyCodeLine{01505\ }
\DoxyCodeLine{01509\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGraphicsOutput_ab5cedbe18daea18e79c0167dac2d0bd1}{GraphicsOutput::}}}
\DoxyCodeLine{01510\ \mbox{\hyperlink{classGraphicsOutput_ab5cedbe18daea18e79c0167dac2d0bd1}{copy\_async\_screenshot}}()\ \{}
\DoxyCodeLine{01511\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{01512\ \ \ PT(\mbox{\hyperlink{classScreenshotRequest}{ScreenshotRequest}})\ request;}
\DoxyCodeLine{01513\ \ \ \{}
\DoxyCodeLine{01514\ \ \ \ \ \mbox{\hyperlink{classCycleDataWriter}{CDWriter}}\ cdata(\_cycler,\ current\_thread);}
\DoxyCodeLine{01515\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_screenshot\_request\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01517\ \ \ \ \ \}}
\DoxyCodeLine{01518\ \ \ \ \ request\ =\ std::move(cdata-\/>\_screenshot\_request);}
\DoxyCodeLine{01519\ \ \ \ \ cdata-\/>\_screenshot\_request.clear();}
\DoxyCodeLine{01520\ \ \ \}}
\DoxyCodeLine{01521\ }
\DoxyCodeLine{01522\ \ \ \textcolor{comment}{//\ Make\ sure\ it\ is\ cleared\ from\ upstream\ stages\ as\ well.}}
\DoxyCodeLine{01523\ \ \ OPEN\_ITERATE\_UPSTREAM\_ONLY(\_cycler,\ current\_thread)\ \{}
\DoxyCodeLine{01524\ \ \ \ \ \mbox{\hyperlink{classCycleDataStageWriter}{CDStageWriter}}\ cdata(\_cycler,\ pipeline\_stage,\ current\_thread);}
\DoxyCodeLine{01525\ \ \ \ \ \textcolor{keywordflow}{if}\ (cdata-\/>\_screenshot\_request\ ==\ request)\ \{}
\DoxyCodeLine{01526\ \ \ \ \ \ \ cdata-\/>\_screenshot\_request.clear();}
\DoxyCodeLine{01527\ \ \ \ \ \}}
\DoxyCodeLine{01528\ \ \ \}}
\DoxyCodeLine{01529\ \ \ CLOSE\_ITERATE\_UPSTREAM\_ONLY(\_cycler);}
\DoxyCodeLine{01530\ }
\DoxyCodeLine{01531\ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_copy\_texture\_pcollector);}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ buffer\ =\ \_gsg-\/>get\_render\_buffer(get\_draw\_buffer\_type(),}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_fb\_properties());}
\DoxyCodeLine{01535\ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *dr\ =\ \_overlay\_display\_region;}
\DoxyCodeLine{01536\ }
\DoxyCodeLine{01537\ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *texture\ =\ request-\/>get\_result();}
\DoxyCodeLine{01538\ }
\DoxyCodeLine{01539\ \ \ \textcolor{keywordflow}{if}\ (\_fb\_properties.is\_stereo())\ \{}
\DoxyCodeLine{01540\ \ \ \ \ \textcolor{comment}{//\ We've\ got\ two\ texture\ views\ to\ copy.}}
\DoxyCodeLine{01541\ \ \ \ \ texture-\/>set\_num\_views(2);}
\DoxyCodeLine{01542\ }
\DoxyCodeLine{01543\ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ left(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_right);}
\DoxyCodeLine{01544\ \ \ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ right(\_gsg,\ buffer.\_buffer\_type\ \&\ \string~RenderBuffer::T\_left);}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ left,\ request);}
\DoxyCodeLine{01548\ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 1,\ \_target\_tex\_page,}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ right,\ request);}
\DoxyCodeLine{01550\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01551\ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(texture,\ 0,\ \_target\_tex\_page,}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dr,\ buffer,\ request);}
\DoxyCodeLine{01553\ \ \ \}}
\DoxyCodeLine{01554\ \}}
\DoxyCodeLine{01555\ }
\DoxyCodeLine{01559\ PT(\mbox{\hyperlink{classGeomVertexData}{GeomVertexData}})\ GraphicsOutput::}
\DoxyCodeLine{01560\ create\_texture\_card\_vdata(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{01561\ \ \ PN\_stdfloat\ xhi\ =\ 1.0;}
\DoxyCodeLine{01562\ \ \ PN\_stdfloat\ yhi\ =\ 1.0;}
\DoxyCodeLine{01563\ }
\DoxyCodeLine{01564\ \ \ \textcolor{keywordflow}{if}\ (Texture::get\_textures\_power\_2()\ !=\ ATS\_none)\ \{}
\DoxyCodeLine{01565\ \ \ \ \ \textcolor{keywordtype}{int}\ xru\ =\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{Texture::up\_to\_power\_2}}(x);}
\DoxyCodeLine{01566\ \ \ \ \ \textcolor{keywordtype}{int}\ yru\ =\ \mbox{\hyperlink{classTexture_a9277f24691a5281de91579f1d7751391}{Texture::up\_to\_power\_2}}(y);}
\DoxyCodeLine{01567\ \ \ \ \ xhi\ =\ (x\ *\ 1.0f)\ /\ xru;}
\DoxyCodeLine{01568\ \ \ \ \ yhi\ =\ (y\ *\ 1.0f)\ /\ yru;}
\DoxyCodeLine{01569\ \ \ \}}
\DoxyCodeLine{01570\ }
\DoxyCodeLine{01571\ \ \ CPT(\mbox{\hyperlink{classGeomVertexFormat}{GeomVertexFormat}})\ format\ =\ GeomVertexFormat::get\_v3n3t2();}
\DoxyCodeLine{01572\ }
\DoxyCodeLine{01573\ \ \ PT(\mbox{\hyperlink{classGeomVertexData}{GeomVertexData}})\ vdata\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomVertexData}{GeomVertexData}}}
\DoxyCodeLine{01574\ \ \ \ \ (\textcolor{stringliteral}{"{}card"{}},\ format,\ Geom::UH\_static);}
\DoxyCodeLine{01575\ }
\DoxyCodeLine{01576\ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ vertex(vdata,\ InternalName::get\_vertex());}
\DoxyCodeLine{01577\ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ texcoord(vdata,\ InternalName::get\_texcoord());}
\DoxyCodeLine{01578\ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ normal(vdata,\ InternalName::get\_normal());}
\DoxyCodeLine{01579\ }
\DoxyCodeLine{01580\ \ \ vertex.add\_data3(LVertex::rfu(-\/1.0f,\ 0.0f,\ \ 1.0f));}
\DoxyCodeLine{01581\ \ \ vertex.add\_data3(LVertex::rfu(-\/1.0f,\ 0.0f,\ -\/1.0f));}
\DoxyCodeLine{01582\ \ \ vertex.add\_data3(LVertex::rfu(\ 1.0f,\ 0.0f,\ \ 1.0f));}
\DoxyCodeLine{01583\ \ \ vertex.add\_data3(LVertex::rfu(\ 1.0f,\ 0.0f,\ -\/1.0f));}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ texcoord.add\_data2(\ 0.0f,\ \ yhi);}
\DoxyCodeLine{01586\ \ \ texcoord.add\_data2(\ 0.0f,\ 0.0f);}
\DoxyCodeLine{01587\ \ \ texcoord.add\_data2(\ \ xhi,\ \ yhi);}
\DoxyCodeLine{01588\ \ \ texcoord.add\_data2(\ \ xhi,\ 0.0f);}
\DoxyCodeLine{01589\ }
\DoxyCodeLine{01590\ \ \ normal.add\_data3(LVector3::back());}
\DoxyCodeLine{01591\ \ \ normal.add\_data3(LVector3::back());}
\DoxyCodeLine{01592\ \ \ normal.add\_data3(LVector3::back());}
\DoxyCodeLine{01593\ \ \ normal.add\_data3(LVector3::back());}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ \textcolor{keywordflow}{return}\ vdata;}
\DoxyCodeLine{01596\ \}}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01602\ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *GraphicsOutput::}
\DoxyCodeLine{01603\ add\_display\_region(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region)\ \{}
\DoxyCodeLine{01604\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(\_lock);}
\DoxyCodeLine{01605\ \ \ CDWriter\ cdata(\_cycler,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01606\ \ \ cdata-\/>\_active\_display\_regions\_stale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01607\ }
\DoxyCodeLine{01608\ \ \ \_total\_display\_regions.push\_back(display\_region);}
\DoxyCodeLine{01609\ }
\DoxyCodeLine{01610\ \ \ \textcolor{keywordflow}{return}\ display\_region;}
\DoxyCodeLine{01611\ \}}
\DoxyCodeLine{01612\ }
\DoxyCodeLine{01617\ \textcolor{keywordtype}{bool}\ GraphicsOutput::}
\DoxyCodeLine{01618\ do\_remove\_display\_region(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region)\ \{}
\DoxyCodeLine{01619\ \ \ nassertr(display\_region\ !=\ \_overlay\_display\_region,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01620\ }
\DoxyCodeLine{01621\ \ \ PT(\mbox{\hyperlink{classDisplayRegion}{DisplayRegion}})\ drp\ =\ display\_region;}
\DoxyCodeLine{01622\ \ \ TotalDisplayRegions::iterator\ dri\ =}
\DoxyCodeLine{01623\ \ \ \ \ find(\_total\_display\_regions.begin(),\ \_total\_display\_regions.end(),\ drp);}
\DoxyCodeLine{01624\ \ \ \textcolor{keywordflow}{if}\ (dri\ !=\ \_total\_display\_regions.end())\ \{}
\DoxyCodeLine{01625\ \ \ \ \ \textcolor{comment}{//\ Let's\ aggressively\ clean\ up\ the\ display\ region\ too.}}
\DoxyCodeLine{01626\ \ \ \ \ display\_region-\/>\mbox{\hyperlink{classDisplayRegion_a6a87ed49c740f181a823639665a10a97}{cleanup}}();}
\DoxyCodeLine{01627\ \ \ \ \ display\_region-\/>\_window\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01628\ \ \ \ \ \_total\_display\_regions.erase(dri);}
\DoxyCodeLine{01629\ }
\DoxyCodeLine{01630\ \ \ \ \ OPEN\_ITERATE\_ALL\_STAGES(\_cycler)\ \{}
\DoxyCodeLine{01631\ \ \ \ \ \ \ CDStageWriter\ cdata(\_cycler,\ pipeline\_stage);}
\DoxyCodeLine{01632\ \ \ \ \ \ \ cdata-\/>\_active\_display\_regions\_stale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01633\ \ \ \ \ \}}
\DoxyCodeLine{01634\ \ \ \ \ CLOSE\_ITERATE\_ALL\_STAGES(\_cycler);}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01636\ \ \ \}}
\DoxyCodeLine{01637\ }
\DoxyCodeLine{01638\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01639\ \}}
\DoxyCodeLine{01640\ }
\DoxyCodeLine{01644\ \textcolor{keywordtype}{void}\ GraphicsOutput::}
\DoxyCodeLine{01645\ do\_determine\_display\_regions(\mbox{\hyperlink{classGraphicsOutput_1_1CData}{GraphicsOutput::CData}}\ *cdata)\ \{}
\DoxyCodeLine{01646\ \ \ cdata-\/>\_active\_display\_regions\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01647\ }
\DoxyCodeLine{01648\ \ \ cdata-\/>\_active\_display\_regions.clear();}
\DoxyCodeLine{01649\ \ \ cdata-\/>\_active\_display\_regions.reserve(\_total\_display\_regions.size());}
\DoxyCodeLine{01650\ }
\DoxyCodeLine{01651\ \ \ \textcolor{keywordtype}{int}\ index\ =\ 0;}
\DoxyCodeLine{01652\ \ \ TotalDisplayRegions::const\_iterator\ dri;}
\DoxyCodeLine{01653\ \ \ \textcolor{keywordflow}{for}\ (dri\ =\ \_total\_display\_regions.begin();}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ dri\ !=\ \_total\_display\_regions.end();}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ ++dri)\ \{}
\DoxyCodeLine{01656\ \ \ \ \ \mbox{\hyperlink{classDisplayRegion}{DisplayRegion}}\ *display\_region\ =\ (*dri);}
\DoxyCodeLine{01657\ \ \ \ \ \textcolor{keywordflow}{if}\ (display\_region-\/>is\_active())\ \{}
\DoxyCodeLine{01658\ \ \ \ \ \ \ cdata-\/>\_active\_display\_regions.push\_back(display\_region);}
\DoxyCodeLine{01659\ \ \ \ \ \ \ display\_region-\/>set\_active\_index(index);}
\DoxyCodeLine{01660\ \ \ \ \ \ \ ++index;}
\DoxyCodeLine{01661\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01662\ \ \ \ \ \ \ display\_region-\/>set\_active\_index(-\/1);}
\DoxyCodeLine{01663\ \ \ \ \ \}}
\DoxyCodeLine{01664\ \ \ \}}
\DoxyCodeLine{01665\ }
\DoxyCodeLine{01666\ \ \ std::stable\_sort(cdata-\/>\_active\_display\_regions.begin(),}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cdata-\/>\_active\_display\_regions.end(),}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classIndirectLess}{IndirectLess<DisplayRegion>}}());}
\DoxyCodeLine{01669\ \}}
\DoxyCodeLine{01670\ }
\DoxyCodeLine{01677\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ GraphicsOutput::}
\DoxyCodeLine{01678\ parse\_color\_mask(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&word)\ \{}
\DoxyCodeLine{01679\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ result\ =\ 0;}
\DoxyCodeLine{01680\ \ \ vector\_string\ components;}
\DoxyCodeLine{01681\ \ \ \mbox{\hyperlink{string__utils_8cxx_afcc82a47a52a95f3b9f10cbd16a8f575}{tokenize}}(word,\ components,\ \textcolor{stringliteral}{"{}|"{}});}
\DoxyCodeLine{01682\ }
\DoxyCodeLine{01683\ \ \ vector\_string::const\_iterator\ ci;}
\DoxyCodeLine{01684\ \ \ \textcolor{keywordflow}{for}\ (ci\ =\ components.begin();\ ci\ !=\ components.end();\ ++ci)\ \{}
\DoxyCodeLine{01685\ \ \ \ \ \textcolor{keywordtype}{string}\ w\ =\ \mbox{\hyperlink{string__utils_8cxx_a8436b3aed06d4a4e245ab303cdf9637e}{downcase}}(*ci);}
\DoxyCodeLine{01686\ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}red"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}r"{}})\ \{}
\DoxyCodeLine{01687\ \ \ \ \ \ \ result\ |=\ 0x001;}
\DoxyCodeLine{01688\ }
\DoxyCodeLine{01689\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}green"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}g"{}})\ \{}
\DoxyCodeLine{01690\ \ \ \ \ \ \ result\ |=\ 0x002;}
\DoxyCodeLine{01691\ }
\DoxyCodeLine{01692\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}blue"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}b"{}})\ \{}
\DoxyCodeLine{01693\ \ \ \ \ \ \ result\ |=\ 0x004;}
\DoxyCodeLine{01694\ }
\DoxyCodeLine{01695\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}yellow"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}y"{}})\ \{}
\DoxyCodeLine{01696\ \ \ \ \ \ \ result\ |=\ 0x003;}
\DoxyCodeLine{01697\ }
\DoxyCodeLine{01698\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}magenta"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}m"{}})\ \{}
\DoxyCodeLine{01699\ \ \ \ \ \ \ result\ |=\ 0x005;}
\DoxyCodeLine{01700\ }
\DoxyCodeLine{01701\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}cyan"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}c"{}})\ \{}
\DoxyCodeLine{01702\ \ \ \ \ \ \ result\ |=\ 0x006;}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}alpha"{}}\ ||\ w\ ==\ \textcolor{stringliteral}{"{}a"{}})\ \{}
\DoxyCodeLine{01705\ \ \ \ \ \ \ result\ |=\ 0x008;}
\DoxyCodeLine{01706\ }
\DoxyCodeLine{01707\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (w\ ==\ \textcolor{stringliteral}{"{}off"{}})\ \{}
\DoxyCodeLine{01708\ }
\DoxyCodeLine{01709\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01710\ \ \ \ \ \ \ display\_cat.warning()}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ color\ in\ red-\/blue-\/stereo-\/colors:\ "{}}\ <<\ (*ci)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01712\ \ \ \ \ \}}
\DoxyCodeLine{01713\ \ \ \}}
\DoxyCodeLine{01714\ }
\DoxyCodeLine{01715\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01716\ \}}
\DoxyCodeLine{01717\ }
\DoxyCodeLine{01721\ GraphicsOutput::CData::}
\DoxyCodeLine{01722\ CData()\ \{}
\DoxyCodeLine{01723\ \ \ \textcolor{comment}{//\ The\ default\ is\ *not*\ active,\ so\ the\ entire\ pipeline\ stage\ is\ initially}}
\DoxyCodeLine{01724\ \ \ \textcolor{comment}{//\ populated\ with\ inactive\ outputs.\ \ Pipeline\ stage\ 0\ is\ set\ to\ active\ in}}
\DoxyCodeLine{01725\ \ \ \textcolor{comment}{//\ the\ constructor.}}
\DoxyCodeLine{01726\ \ \ \_active\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01727\ \ \ \_one\_shot\_frame\ =\ -\/1;}
\DoxyCodeLine{01728\ \ \ \_active\_display\_regions\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01729\ \}}
\DoxyCodeLine{01730\ }
\DoxyCodeLine{01734\ GraphicsOutput::CData::}
\DoxyCodeLine{01735\ CData(\textcolor{keyword}{const}\ \mbox{\hyperlink{classGraphicsOutput_1_1CData}{GraphicsOutput::CData}}\ \&copy)\ :}
\DoxyCodeLine{01736\ \ \ \_textures(copy.\_textures),}
\DoxyCodeLine{01737\ \ \ \_textures\_seq(copy.\_textures\_seq),}
\DoxyCodeLine{01738\ \ \ \_active(copy.\_active),}
\DoxyCodeLine{01739\ \ \ \_one\_shot\_frame(copy.\_one\_shot\_frame),}
\DoxyCodeLine{01740\ \ \ \_active\_display\_regions(copy.\_active\_display\_regions),}
\DoxyCodeLine{01741\ \ \ \_active\_display\_regions\_stale(copy.\_active\_display\_regions\_stale),}
\DoxyCodeLine{01742\ \ \ \_screenshot\_request(copy.\_screenshot\_request)}
\DoxyCodeLine{01743\ \{}
\DoxyCodeLine{01744\ \}}
\DoxyCodeLine{01745\ }
\DoxyCodeLine{01749\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *GraphicsOutput::CData::}
\DoxyCodeLine{01750\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01751\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{01752\ \}}
\DoxyCodeLine{01753\ }
\DoxyCodeLine{01757\ std::ostream\ \&}
\DoxyCodeLine{01758\ operator\ <<\ (std::ostream\ \&out,\ GraphicsOutput::FrameMode\ fm)\ \{}
\DoxyCodeLine{01759\ \ \ \textcolor{keywordflow}{switch}\ (fm)\ \{}
\DoxyCodeLine{01760\ \ \ \textcolor{keywordflow}{case}\ GraphicsOutput::FM\_render:}
\DoxyCodeLine{01761\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}render"{}};}
\DoxyCodeLine{01762\ \ \ \textcolor{keywordflow}{case}\ GraphicsOutput::FM\_parasite:}
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}parasite"{}};}
\DoxyCodeLine{01764\ \ \ \textcolor{keywordflow}{case}\ GraphicsOutput::FM\_refresh:}
\DoxyCodeLine{01765\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}refresh"{}};}
\DoxyCodeLine{01766\ \ \ \}}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}(**invalid\ GraphicsOutput::FrameMode("{}}\ <<\ (int)fm\ <<\ \textcolor{stringliteral}{"{})**)"{}};}
\DoxyCodeLine{01769\ \}}

\end{DoxyCode}
