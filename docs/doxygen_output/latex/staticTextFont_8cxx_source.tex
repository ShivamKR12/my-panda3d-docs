\doxysection{static\+Text\+Font.\+cxx}
\hypertarget{staticTextFont_8cxx_source}{}\label{staticTextFont_8cxx_source}\index{panda/src/text/staticTextFont.cxx@{panda/src/text/staticTextFont.cxx}}
\mbox{\hyperlink{staticTextFont_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{staticTextFont_8h}{staticTextFont.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__text_8h}{config\_text.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geom_8h}{geom.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomNode_8h}{geomNode.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexReader_8h}{geomVertexReader.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomPoints_8h}{geomPoints.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{renderState_8h}{renderState.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{comment}{//\ Temporary}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textureCollection_8h}{textureCollection.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nodePath_8h}{nodePath.h}}"{}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ StaticTextFont::\_type\_handle;}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00038\ StaticTextFont::}
\DoxyCodeLine{00039\ StaticTextFont(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *font\_def,\ CoordinateSystem\ cs)\ \{}
\DoxyCodeLine{00040\ \ \ nassertv(font\_def\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00041\ \ \ \_font\ =\ font\_def;}
\DoxyCodeLine{00042\ \ \ \_cs\ =\ cs;}
\DoxyCodeLine{00043\ \ \ \_glyphs.clear();}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{if}\ (\_cs\ ==\ CS\_default)\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \_cs\ =\ get\_default\_coordinate\_system();}
\DoxyCodeLine{00047\ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ np(font\_def);}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{if}\ (\_cs\ !=\ CS\_zup\_right)\ \{}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ convert\ the\ entire\ font\ to\ CS\_zup\_right\ before\ we\ can\ use}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ it,\ because\ the\ text\ subsystem\ assumes\ the\ glyphs\ are\ stored\ in}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ CS\_zup\_right.}}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ temp\_root(\textcolor{stringliteral}{"{}root"{}});}
\DoxyCodeLine{00055\ \ \ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ temp\_child\ =\ temp\_root.attach\_new\_node(\textcolor{stringliteral}{"{}child"{}});}
\DoxyCodeLine{00056\ \ \ \ \ np\ =\ np.copy\_to(temp\_child);}
\DoxyCodeLine{00057\ \ \ \ \ LMatrix4\ mat\ =\ LMatrix4::convert\_mat(\_cs,\ CS\_zup\_right);}
\DoxyCodeLine{00058\ \ \ \ \ temp\_child.set\_mat(mat);}
\DoxyCodeLine{00059\ \ \ \ \ temp\_root.clear\_model\_nodes();}
\DoxyCodeLine{00060\ \ \ \ \ temp\_root.flatten\_light();}
\DoxyCodeLine{00061\ \ \ \ \ np\ =\ temp\_root.get\_child(0).get\_child(0);}
\DoxyCodeLine{00062\ \ \ \ \ \_font\ =\ np.node();}
\DoxyCodeLine{00063\ \ \ \ \ \_cs\ =\ CS\_zup\_right;}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//\ If\ there\ is\ no\ explicit\ quality\ level\ or\ filter\ settings\ on\ the\ textures}}
\DoxyCodeLine{00067\ \ \ \textcolor{comment}{//\ in\ the\ static\ font,\ set\ the\ appropriate\ defaults\ for\ text.}}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classTextureCollection}{TextureCollection}}\ tc\ =\ np.find\_all\_textures();}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordtype}{int}\ num\_textures\ =\ tc.get\_num\_textures();}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_textures;\ ++i)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{classTexture}{Texture}}\ *tex\ =\ tc.get\_texture(i);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{//\ Don't\ compress\ font\ textures.\ \ Though\ there's\ a\ relatively\ high\ bang-\/}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ for-\/the-\/buck\ in\ compressing\ them,\ there's\ an\ increased\ risk\ that\ broken}}
\DoxyCodeLine{00075\ \ \ \ \ \textcolor{comment}{//\ graphics\ drivers\ will\ fail\ to\ render\ the\ text\ properly,\ causing}}
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{//\ troubles\ for\ a\ user\ who\ then\ won't\ be\ able\ to\ navigate\ the\ options}}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{comment}{//\ menus\ to\ disable\ texture\ compression.}}
\DoxyCodeLine{00078\ \ \ \ \ tex-\/>set\_compression(Texture::CM\_off);}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_quality\_level()\ ==\ Texture::QL\_default)\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ tex-\/>set\_quality\_level(text\_quality\_level);}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_minfilter()\ ==\ SamplerState::FT\_default)\ \{}
\DoxyCodeLine{00084\ \ \ \ \ \ \ tex-\/>set\_minfilter(text\_minfilter);}
\DoxyCodeLine{00085\ \ \ \ \ \}}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{if}\ (tex-\/>get\_magfilter()\ ==\ SamplerState::FT\_default)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ tex-\/>set\_magfilter(text\_magfilter);}
\DoxyCodeLine{00088\ \ \ \ \ \}}
\DoxyCodeLine{00089\ \ \ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ find\_characters(\_font,\ RenderState::make\_empty());}
\DoxyCodeLine{00092\ \ \ \_is\_valid\ =\ !\_glyphs.empty();}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \textcolor{comment}{//\ Check\ for\ an\ explicit\ space\ width.}}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordtype}{int}\ character\ =\ 32;}
\DoxyCodeLine{00096\ \ \ Glyphs::iterator\ gi\ =\ \_glyphs.find(character);}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{if}\ (gi\ !=\ \_glyphs.end())\ \{}
\DoxyCodeLine{00098\ \ \ \ \ \mbox{\hyperlink{classTextGlyph}{TextGlyph}}\ *glyph\ =\ (*gi).second;}
\DoxyCodeLine{00099\ \ \ \ \ \_space\_advance\ =\ glyph-\/>get\_advance();}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ set\_name(font\_def-\/>get\_name());}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00108\ PT(\mbox{\hyperlink{classTextFont}{TextFont}})\ StaticTextFont::}
\DoxyCodeLine{00109\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classStaticTextFont}{StaticTextFont}}(\_font);}
\DoxyCodeLine{00111\ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00116\ \textcolor{keywordtype}{void}\ StaticTextFont::}
\DoxyCodeLine{00117\ write(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00119\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}StaticTextFont\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{};\ "{}}}
\DoxyCodeLine{00120\ \ \ \ \ <<\ \_glyphs.size()\ <<\ \textcolor{stringliteral}{"{}\ characters\ available\ in\ font:\(\backslash\)n"{}};}
\DoxyCodeLine{00121\ \ \ Glyphs::const\_iterator\ gi;}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \textcolor{comment}{//\ Figure\ out\ which\ symbols\ we\ have.\ \ We\ collect\ lowercase\ letters,}}
\DoxyCodeLine{00124\ \ \ \textcolor{comment}{//\ uppercase\ letters,\ and\ digits\ together\ for\ the\ user's\ convenience.}}
\DoxyCodeLine{00125\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_letters\ =\ 26;}
\DoxyCodeLine{00126\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_digits\ =\ 10;}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordtype}{bool}\ lowercase[num\_letters];}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordtype}{bool}\ uppercase[num\_letters];}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{bool}\ digits[num\_digits];}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ memset(lowercase,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{bool})\ *\ num\_letters);}
\DoxyCodeLine{00132\ \ \ memset(uppercase,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{bool})\ *\ num\_letters);}
\DoxyCodeLine{00133\ \ \ memset(digits,\ 0,\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{bool})\ *\ num\_digits);}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{int}\ count\_lowercase\ =\ 0;}
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{int}\ count\_uppercase\ =\ 0;}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordtype}{int}\ count\_digits\ =\ 0;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_glyphs.begin();\ gi\ !=\ \_glyphs.end();\ ++gi)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordtype}{int}\ ch\ =\ (*gi).first;}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ <\ 128)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (islower(ch))\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ count\_lowercase++;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ lowercase[ch\ -\/\ \textcolor{charliteral}{'a'}]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isupper(ch))\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ count\_uppercase++;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ uppercase[ch\ -\/\ \textcolor{charliteral}{'A'}]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (isdigit(ch))\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ count\_digits++;}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ digits[ch\ -\/\ \textcolor{charliteral}{'0'}]\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00154\ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \textcolor{keywordflow}{if}\ (count\_lowercase\ ==\ num\_letters)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00159\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ lowercase\ letters\(\backslash\)n"{}};}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00161\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (count\_lowercase\ >\ 0)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00163\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Some\ lowercase\ letters:\ "{}};}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_letters;\ i++)\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (lowercase[i])\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ out\ <<\ (char)(i\ +\ \textcolor{charliteral}{'a'});}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ \ \ \ \ \}}
\DoxyCodeLine{00169\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00170\ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (count\_uppercase\ ==\ num\_letters)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00174\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ uppercase\ letters\(\backslash\)n"{}};}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (count\_uppercase\ >\ 0)\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00178\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Some\ uppercase\ letters:\ "{}};}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_letters;\ i++)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (uppercase[i])\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ out\ <<\ (char)(i\ +\ \textcolor{charliteral}{'A'});}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00185\ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{keywordflow}{if}\ (count\_digits\ ==\ num\_digits)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00189\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}All\ digits\(\backslash\)n"{}};}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (count\_digits\ >\ 0)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00193\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Some\ digits:\ "{}};}
\DoxyCodeLine{00194\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_digits;\ i++)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (digits[i])\ \{}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ out\ <<\ (char)(i\ +\ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_glyphs.begin();\ gi\ !=\ \_glyphs.end();\ ++gi)\ \{}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{int}\ ch\ =\ (*gi).first;}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ >=\ 128\ ||\ !isalnum(ch))\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ <<\ ch;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ <\ isprint(ch))\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ =\ '"{}}\ <<\ (char)ch\ <<\ \textcolor{stringliteral}{"{}'\(\backslash\)n"{}};}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00210\ \ \ \ \ \}}
\DoxyCodeLine{00211\ \ \ \}}
\DoxyCodeLine{00212\ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00221\ \textcolor{keywordtype}{bool}\ StaticTextFont::}
\DoxyCodeLine{00222\ get\_glyph(\textcolor{keywordtype}{int}\ character,\ CPT(\mbox{\hyperlink{classTextGlyph}{TextGlyph}})\ \&glyph)\ \{}
\DoxyCodeLine{00223\ \ \ Glyphs::const\_iterator\ gi\ =\ \_glyphs.find(character);}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{if}\ (gi\ ==\ \_glyphs.end())\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{comment}{//\ No\ definition\ for\ this\ character.}}
\DoxyCodeLine{00226\ \ \ \ \ glyph\ =\ \mbox{\hyperlink{classTextFont_a2342fe9fe7bd4059939ddf8a8896e206}{get\_invalid\_glyph}}();}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00228\ \ \ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ glyph\ =\ (*gi).second;}
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00232\ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00239\ \textcolor{keywordtype}{void}\ StaticTextFont::}
\DoxyCodeLine{00240\ find\_character\_gsets(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *root,\ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ \&ch,\ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ \&dot,}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *\&state,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *net\_state)\ \{}
\DoxyCodeLine{00242\ \ \ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ next\_net\_state\ =\ net\_state-\/>compose(root-\/>get\_state());}
\DoxyCodeLine{00243\ }
\DoxyCodeLine{00244\ \ \ \textcolor{keywordflow}{if}\ (root-\/>\mbox{\hyperlink{classPandaNode_a1799fcdc4d1d62fbbbb63d4dedc1bdcf}{is\_geom\_node}}())\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \mbox{\hyperlink{classGeomNode}{GeomNode}}\ *geode\ =\ DCAST(\mbox{\hyperlink{classGeomNode}{GeomNode}},\ root);}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ geode-\/>get\_num\_geoms();\ i++)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeom}{Geom}}\ *geom\ =\ geode-\/>get\_geom(i);}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ found\_points\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ j\ =\ 0;\ j\ <\ geom-\/>get\_num\_primitives()\ \&\&\ !found\_points;\ ++j)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}}\ *primitive\ =\ geom-\/>get\_primitive(j);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primitive-\/>is\_of\_type(GeomPoints::get\_class\_type()))\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ dot\ =\ geom;}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ found\_points\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!found\_points)\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it\ doesn't\ have\ any\ points,\ it\ must\ be\ the\ regular\ letter.}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ ch\ =\ geom;}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ state\ =\ next\_net\_state-\/>compose(geode-\/>get\_geom\_state(i));}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00263\ \ \ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00266\ \ \ \ \ PandaNode::Children\ cr\ =\ root-\/>get\_children();}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_children\ =\ cr.get\_num\_children();}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_children;\ i++)\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ find\_character\_gsets(cr.get\_child(i),\ ch,\ dot,\ state,}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ next\_net\_state);}
\DoxyCodeLine{00271\ \ \ \ \ \}}
\DoxyCodeLine{00272\ \ \ \}}
\DoxyCodeLine{00273\ \}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00280\ \textcolor{keywordtype}{void}\ StaticTextFont::}
\DoxyCodeLine{00281\ find\_characters(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *root,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *net\_state)\ \{}
\DoxyCodeLine{00282\ \ \ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ next\_net\_state\ =\ net\_state-\/>compose(root-\/>get\_state());}
\DoxyCodeLine{00283\ \ \ std::string\ name\ =\ root-\/>get\_name();}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \textcolor{keywordtype}{bool}\ all\_digits\ =\ !name.empty();}
\DoxyCodeLine{00286\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *p\ =\ name.c\_str();}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{while}\ (all\_digits\ \&\&\ *p\ !=\ \textcolor{charliteral}{'\(\backslash\)0'})\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{comment}{//\ VC++\ complains\ if\ we\ treat\ an\ int\ as\ a\ bool,\ so\ we\ have\ to\ do\ this\ !=\ 0}}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{comment}{//\ comparison\ on\ the\ int\ isdigit()\ function\ to\ shut\ it\ up.}}
\DoxyCodeLine{00290\ \ \ \ \ all\_digits\ =\ (isdigit(*p)\ !=\ 0);}
\DoxyCodeLine{00291\ \ \ \ \ p++;}
\DoxyCodeLine{00292\ \ \ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \textcolor{keywordflow}{if}\ (all\_digits)\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \textcolor{keywordtype}{int}\ character\ =\ atoi(name.c\_str());}
\DoxyCodeLine{00296\ \ \ \ \ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ ch;}
\DoxyCodeLine{00297\ \ \ \ \ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ dot;}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *state\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00299\ \ \ \ \ find\_character\_gsets(root,\ ch,\ dot,\ state,\ next\_net\_state);}
\DoxyCodeLine{00300\ \ \ \ \ PN\_stdfloat\ width\ =\ 0.0;}
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordflow}{if}\ (dot\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ first\ vertex\ from\ the\ "{}dot"{}\ geoset.\ \ This\ will\ be\ the\ origin}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \textcolor{comment}{//\ of\ the\ next\ character.}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ reader(dot-\/>get\_vertex\_data(),\ InternalName::get\_vertex());}
\DoxyCodeLine{00305\ \ \ \ \ \ \ width\ =\ reader.get\_data1f();}
\DoxyCodeLine{00306\ \ \ \ \ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \ \ \_glyphs[character]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTextGlyph}{TextGlyph}}(character,\ ch,\ state,\ width);}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (name\ ==\ \textcolor{stringliteral}{"{}ds"{}})\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{comment}{//\ The\ group\ "{}ds"{}\ is\ a\ special\ node\ that\ indicates\ the\ font's\ design\ size,}}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{comment}{//\ or\ line\ height.}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ ch;}
\DoxyCodeLine{00315\ \ \ \ \ CPT(\mbox{\hyperlink{classGeom}{Geom}})\ dot;}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderState}{RenderState}}\ *state\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00317\ \ \ \ \ find\_character\_gsets(root,\ ch,\ dot,\ state,\ next\_net\_state);}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keywordflow}{if}\ (dot\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ first\ vertex\ from\ the\ "{}dot"{}\ geoset.\ \ This\ will\ be\ the\ design}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \textcolor{comment}{//\ size\ indicator.}}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexReader}{GeomVertexReader}}\ reader(dot-\/>get\_vertex\_data(),\ InternalName::get\_vertex());}
\DoxyCodeLine{00322\ \ \ \ \ \ \ LVecBase3\ data\ =\ reader.get\_data3();}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \_line\_height\ =\ data[2];}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \_total\_poly\_margin\ =\ data[0];}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \_space\_advance\ =\ 0.25f\ *\ \_line\_height;}
\DoxyCodeLine{00326\ \ \ \ \ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00329\ \ \ \ \ PandaNode::Children\ cr\ =\ root-\/>get\_children();}
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_children\ =\ cr.get\_num\_children();}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_children;\ i++)\ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ find\_characters(cr.get\_child(i),\ next\_net\_state);}
\DoxyCodeLine{00333\ \ \ \ \ \}}
\DoxyCodeLine{00334\ \ \ \}}
\DoxyCodeLine{00335\ \}}

\end{DoxyCode}
