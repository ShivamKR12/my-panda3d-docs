\doxysection{bit\+Array.\+cxx}
\hypertarget{bitArray_8cxx_source}{}\label{bitArray_8cxx_source}\index{panda/src/putil/bitArray.cxx@{panda/src/putil/bitArray.cxx}}
\mbox{\hyperlink{bitArray_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bitArray_8h}{bitArray.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sparseArray_8h}{sparseArray.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{using\ }std::max;}
\DoxyCodeLine{00020\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00021\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BitArray::\_type\_handle;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ BitArray::}
\DoxyCodeLine{00029\ BitArray(\textcolor{keyword}{const}\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ \&from)\ \{}
\DoxyCodeLine{00030\ \ \ \_highest\_bits\ =\ 0;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \textcolor{keywordtype}{int}\ num\_subranges\ =\ from.get\_num\_subranges();}
\DoxyCodeLine{00033\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_subranges;\ ++i)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{int}\ begin\ =\ from.get\_subrange\_begin(i);}
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{keywordtype}{int}\ end\ =\ from.get\_subrange\_end(i);}
\DoxyCodeLine{00036\ \ \ \ \ \mbox{\hyperlink{classBitArray_a7c5b25d67999f4d2b1e4e090b05cb265}{set\_range}}(begin,\ end\ -\/\ begin);}
\DoxyCodeLine{00037\ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keywordflow}{if}\ (from.is\_inverse())\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classBitArray_a4c8096e8a6a55b5c73e4f367a937f6fd}{invert\_in\_place}}();}
\DoxyCodeLine{00041\ \ \ \}}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00047\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBitArray_ac4e559ae54607b485f6a4123aacd8fa2}{BitArray::}}}
\DoxyCodeLine{00048\ \mbox{\hyperlink{classBitArray_ac4e559ae54607b485f6a4123aacd8fa2}{is\_zero}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00049\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ If\ all\ the\ infinite\ highest\ bits\ are\ set,\ certainly\ the\ bitmask\ is}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//\ nonzero.}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00053\ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{comment}{//\ Start\ from\ the\ high\ end,\ since\ that's\ more\ likely\ to\ be\ nonzero.}}
\DoxyCodeLine{00056\ \ \ Array::reverse\_iterator\ ai;}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.rbegin();\ ai\ !=\ \_array.rend();\ ++ai)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ai).is\_zero())\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00060\ \ \ \ \ \}}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBitArray_af6fe93a0878e026e95d902ca5decdc3c}{BitArray::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classBitArray_af6fe93a0878e026e95d902ca5decdc3c}{is\_all\_on}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ If\ all\ the\ infinite\ highest\ bits\ are\ not\ set,\ certainly\ the\ bitmask\ is}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//\ not\ all\ on.}}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ Array::reverse\_iterator\ ai;}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.rbegin();\ ai\ !=\ \_array.rend();\ ++ai)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ai).is\_all\_on())\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \ \ \}}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00083\ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00088\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBitArray_a2e28ae0a9a6a8e45a133056a5ad516ae}{BitArray::}}}
\DoxyCodeLine{00089\ \mbox{\hyperlink{classBitArray_a2e28ae0a9a6a8e45a133056a5ad516ae}{has\_any\_of}}(\textcolor{keywordtype}{int}\ low\_bit,\ \textcolor{keywordtype}{int}\ size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{size\_t})(low\_bit\ +\ size)\ >\ get\_num\_bits())\ \{}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ This\ range\ touches\ the\ highest\ bits.}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00094\ \ \ \ \ \}}
\DoxyCodeLine{00095\ \ \ \}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keywordtype}{int}\ w\ =\ low\_bit\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordtype}{int}\ b\ =\ low\_bit\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words())\ \{}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{comment}{//\ This\ range\ is\ entirely\ among\ the\ highest\ bits.}}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_highest\_bits\ !=\ 0);}
\DoxyCodeLine{00103\ \ \ \}}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{if}\ (b\ +\ size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{comment}{//\ The\ whole\ thing\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_word\_internal(w).has\_any\_of(b,\ size);}
\DoxyCodeLine{00107\ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{int}\ num\_high\_bits\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{if}\ (\_array[w].\mbox{\hyperlink{classBitArray_a2e28ae0a9a6a8e45a133056a5ad516ae}{has\_any\_of}}(b,\ num\_high\_bits))\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ \ \ size\ -\/=\ num\_high\_bits;}
\DoxyCodeLine{00114\ \ \ ++w;}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{while}\ (size\ >\ 0)\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{size\_t})w\ >=\ get\_num\_words())\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we're\ up\ to\ the\ highest\ bits.}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\_highest\_bits\ !=\ 0);}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ remainder\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_array[w].has\_any\_of(0,\ size);}
\DoxyCodeLine{00125\ \ \ \ \ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ Keep\ going.}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_array[w].\mbox{\hyperlink{classBitArray_ac4e559ae54607b485f6a4123aacd8fa2}{is\_zero}}())\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00130\ \ \ \ \ \}}
\DoxyCodeLine{00131\ \ \ \ \ size\ -\/=\ num\_bits\_per\_word;}
\DoxyCodeLine{00132\ \ \ \ \ ++w;}
\DoxyCodeLine{00133\ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00141\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBitArray_a598084f054aee6e12673d6f19e55114a}{BitArray::}}}
\DoxyCodeLine{00142\ \mbox{\hyperlink{classBitArray_a598084f054aee6e12673d6f19e55114a}{has\_all\_of}}(\textcolor{keywordtype}{int}\ low\_bit,\ \textcolor{keywordtype}{int}\ size)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00143\ \ \ \textcolor{keywordflow}{if}\ ((\textcolor{keywordtype}{size\_t})(low\_bit\ +\ size)\ >\ get\_num\_bits())\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ This\ range\ touches\ the\ highest\ bits.}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00147\ \ \ \ \ \}}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{keywordtype}{int}\ w\ =\ low\_bit\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordtype}{int}\ b\ =\ low\_bit\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words())\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{//\ This\ range\ is\ entirely\ among\ the\ highest\ bits.}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_highest\_bits\ !=\ 0);}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ \ \ \textcolor{keywordflow}{if}\ (b\ +\ size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ The\ whole\ thing\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_word\_internal(w).has\_all\_of(b,\ size);}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \textcolor{keywordtype}{int}\ num\_high\_bits\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordflow}{if}\ (!\_array[w].\mbox{\hyperlink{classBitArray_a598084f054aee6e12673d6f19e55114a}{has\_all\_of}}(b,\ num\_high\_bits))\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00165\ \ \ \}}
\DoxyCodeLine{00166\ \ \ size\ -\/=\ num\_high\_bits;}
\DoxyCodeLine{00167\ \ \ ++w;}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{keywordflow}{while}\ (size\ >\ 0)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ remainder\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_array[w].has\_all\_of(0,\ size);}
\DoxyCodeLine{00173\ \ \ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{comment}{//\ Keep\ going.}}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_array[w].\mbox{\hyperlink{classBitArray_af6fe93a0878e026e95d902ca5decdc3c}{is\_all\_on}}())\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00178\ \ \ \ \ \}}
\DoxyCodeLine{00179\ \ \ \ \ size\ -\/=\ num\_bits\_per\_word;}
\DoxyCodeLine{00180\ \ \ \ \ ++w;}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words())\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we're\ up\ to\ the\ highest\ bits.}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\_highest\_bits\ !=\ 0);}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00189\ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00194\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a7c5b25d67999f4d2b1e4e090b05cb265}{BitArray::}}}
\DoxyCodeLine{00195\ \mbox{\hyperlink{classBitArray_a7c5b25d67999f4d2b1e4e090b05cb265}{set\_range}}(\textcolor{keywordtype}{int}\ low\_bit,\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordtype}{int}\ w\ =\ low\_bit\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordtype}{int}\ b\ =\ low\_bit\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words()\ \&\&\ \_highest\_bits)\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ All\ the\ highest\ bits\ are\ already\ on.}}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ \ \ \textcolor{keywordflow}{if}\ (b\ +\ size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ The\ whole\ thing\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00205\ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00206\ \ \ \ \ \_array[w].set\_range(b,\ size);}
\DoxyCodeLine{00207\ \ \ \ \ normalize();}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00209\ \ \ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00212\ \ \ \textcolor{keywordtype}{int}\ num\_high\_bits\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00213\ \ \ \_array[w].set\_range(b,\ num\_high\_bits);}
\DoxyCodeLine{00214\ \ \ size\ -\/=\ num\_high\_bits;}
\DoxyCodeLine{00215\ \ \ ++w;}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{keywordflow}{while}\ (size\ >\ 0)\ \{}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ remainder\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \_array[w].set\_range(0,\ size);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ normalize();}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00224\ \ \ \ \ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ Keep\ going.}}
\DoxyCodeLine{00227\ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00228\ \ \ \ \ \_array[w]\ =\ MaskType::all\_on();}
\DoxyCodeLine{00229\ \ \ \ \ size\ -\/=\ num\_bits\_per\_word;}
\DoxyCodeLine{00230\ \ \ \ \ ++w;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words()\ \&\&\ \_highest\_bits)\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{comment}{//\ All\ the\ highest\ bits\ are\ already\ on.}}
\DoxyCodeLine{00234\ \ \ \ \ \ \ normalize();}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00236\ \ \ \ \ \}}
\DoxyCodeLine{00237\ \ \ \}}
\DoxyCodeLine{00238\ \ \ normalize();}
\DoxyCodeLine{00239\ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00244\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_aefade816438f553e9f89d56d835a9e9a}{BitArray::}}}
\DoxyCodeLine{00245\ \mbox{\hyperlink{classBitArray_aefade816438f553e9f89d56d835a9e9a}{clear\_range}}(\textcolor{keywordtype}{int}\ low\_bit,\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordtype}{int}\ w\ =\ low\_bit\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordtype}{int}\ b\ =\ low\_bit\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words()\ \&\&\ !\_highest\_bits)\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{comment}{//\ All\ the\ highest\ bits\ are\ already\ off.}}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00252\ \ \ \}}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{if}\ (b\ +\ size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{comment}{//\ The\ whole\ thing\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00255\ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00256\ \ \ \ \ \_array[w].clear\_range(b,\ size);}
\DoxyCodeLine{00257\ \ \ \ \ normalize();}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00262\ \ \ \textcolor{keywordtype}{int}\ num\_high\_bits\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00263\ \ \ \_array[w].clear\_range(b,\ num\_high\_bits);}
\DoxyCodeLine{00264\ \ \ size\ -\/=\ num\_high\_bits;}
\DoxyCodeLine{00265\ \ \ ++w;}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \textcolor{keywordflow}{while}\ (size\ >\ 0)\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{if}\ (size\ <=\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ remainder\ fits\ within\ one\ word\ of\ the\ array.}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \_array[w].clear\_range(0,\ size);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ normalize();}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00274\ \ \ \ \ \}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{comment}{//\ Keep\ going.}}
\DoxyCodeLine{00277\ \ \ \ \ ensure\_has\_word(w);}
\DoxyCodeLine{00278\ \ \ \ \ \_array[w]\ =\ MaskType::all\_off();}
\DoxyCodeLine{00279\ \ \ \ \ size\ -\/=\ num\_bits\_per\_word;}
\DoxyCodeLine{00280\ \ \ \ \ ++w;}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00282\ \ \ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})get\_num\_words()\ \&\&\ !\_highest\_bits)\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{comment}{//\ All\ the\ highest\ bits\ are\ already\ off.}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ normalize();}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00286\ \ \ \ \ \}}
\DoxyCodeLine{00287\ \ \ \}}
\DoxyCodeLine{00288\ \ \ normalize();}
\DoxyCodeLine{00289\ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00295\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a1fbe0ff4b9f947b546a98acc0f86d80e}{BitArray::}}}
\DoxyCodeLine{00296\ \mbox{\hyperlink{classBitArray_a1fbe0ff4b9f947b546a98acc0f86d80e}{get\_num\_on\_bits}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00299\ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{int}\ result\ =\ 0;}
\DoxyCodeLine{00302\ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin();\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00304\ \ \ \ \ result\ +=\ (*ai).get\_num\_on\_bits();}
\DoxyCodeLine{00305\ \ \ \}}
\DoxyCodeLine{00306\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00307\ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00313\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_ac2ed3e00d5f05be3f0930a4d833e71d4}{BitArray::}}}
\DoxyCodeLine{00314\ \mbox{\hyperlink{classBitArray_ac2ed3e00d5f05be3f0930a4d833e71d4}{get\_num\_off\_bits}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00315\ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00317\ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keywordtype}{int}\ result\ =\ 0;}
\DoxyCodeLine{00320\ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin();\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ result\ +=\ (*ai).get\_num\_off\_bits();}
\DoxyCodeLine{00323\ \ \ \}}
\DoxyCodeLine{00324\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00325\ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00331\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a580f4bc1c93747a8a9f1ad44bf5d7259}{BitArray::}}}
\DoxyCodeLine{00332\ \mbox{\hyperlink{classBitArray_a580f4bc1c93747a8a9f1ad44bf5d7259}{get\_lowest\_on\_bit}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ get\_num\_words();}
\DoxyCodeLine{00334\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ w\ =\ 0;\ w\ <\ num\_words;\ ++w)\ \{}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ \_array[w].get\_lowest\_on\_bit();}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{if}\ (b\ !=\ -\/1)\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\ *\ num\_bits\_per\_word\ +\ b;}
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordflow}{return}\ num\_words\ *\ num\_bits\_per\_word;}
\DoxyCodeLine{00342\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00344\ \ \ \}}
\DoxyCodeLine{00345\ \}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00351\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a5b978eacd5cf71f9d04de38bb50c3486}{BitArray::}}}
\DoxyCodeLine{00352\ \mbox{\hyperlink{classBitArray_a5b978eacd5cf71f9d04de38bb50c3486}{get\_lowest\_off\_bit}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ get\_num\_words();}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ w\ =\ 0;\ w\ <\ num\_words;\ ++w)\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ \_array[w].get\_lowest\_off\_bit();}
\DoxyCodeLine{00356\ \ \ \ \ \textcolor{keywordflow}{if}\ (b\ !=\ -\/1)\ \{}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\ *\ num\_bits\_per\_word\ +\ b;}
\DoxyCodeLine{00358\ \ \ \ \ \}}
\DoxyCodeLine{00359\ \ \ \}}
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{return}\ num\_words\ *\ num\_bits\_per\_word;}
\DoxyCodeLine{00362\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00371\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_adfe516369338e3bec5c899adaab7e717}{BitArray::}}}
\DoxyCodeLine{00372\ \mbox{\hyperlink{classBitArray_adfe516369338e3bec5c899adaab7e717}{get\_highest\_on\_bit}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00373\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00375\ \ \ \}}
\DoxyCodeLine{00376\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ get\_num\_words();}
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ w\ =\ num\_words\ -\/\ 1;\ w\ >=\ 0;\ -\/-\/w)\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ \_array[w].get\_highest\_on\_bit();}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{if}\ (b\ !=\ -\/1)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\ *\ num\_bits\_per\_word\ +\ b;}
\DoxyCodeLine{00381\ \ \ \ \ \}}
\DoxyCodeLine{00382\ \ \ \}}
\DoxyCodeLine{00383\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00384\ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00390\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a3fb878261b3ae3129bd1f1b347ff4298}{BitArray::}}}
\DoxyCodeLine{00391\ \mbox{\hyperlink{classBitArray_a3fb878261b3ae3129bd1f1b347ff4298}{get\_highest\_off\_bit}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00394\ \ \ \}}
\DoxyCodeLine{00395\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ get\_num\_words();}
\DoxyCodeLine{00396\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ w\ =\ num\_words\ -\/\ 1;\ w\ >=\ 0;\ -\/-\/w)\ \{}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ \_array[w].get\_highest\_off\_bit();}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{if}\ (b\ !=\ -\/1)\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ w\ *\ num\_bits\_per\_word\ +\ b;}
\DoxyCodeLine{00400\ \ \ \ \ \}}
\DoxyCodeLine{00401\ \ \ \}}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00403\ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00412\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a208061e6f6e4b86cd344a3355337f8fc}{BitArray::}}}
\DoxyCodeLine{00413\ \mbox{\hyperlink{classBitArray_a208061e6f6e4b86cd344a3355337f8fc}{get\_next\_higher\_different\_bit}}(\textcolor{keywordtype}{int}\ low\_bit)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00414\ \ \ \textcolor{keywordtype}{int}\ w\ =\ low\_bit\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00415\ \ \ \textcolor{keywordtype}{int}\ b\ =\ low\_bit\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00416\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ get\_num\_words();}
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ num\_words)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{keywordflow}{return}\ low\_bit;}
\DoxyCodeLine{00419\ \ \ \}}
\DoxyCodeLine{00420\ \ \ \textcolor{keywordtype}{int}\ b2\ =\ \_array[w].get\_next\_higher\_different\_bit(b);}
\DoxyCodeLine{00421\ \ \ \textcolor{keywordflow}{if}\ (b2\ !=\ b\ \&\&\ b2\ <\ num\_bits\_per\_word)\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{comment}{//\ The\ next\ higher\ bit\ is\ within\ the\ same\ word.}}
\DoxyCodeLine{00423\ \ \ \ \ \textcolor{keywordflow}{return}\ w\ *\ num\_bits\_per\_word\ +\ b2;}
\DoxyCodeLine{00424\ \ \ \}}
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//\ Look\ for\ the\ next\ word\ with\ anything\ interesting.}}
\DoxyCodeLine{00426\ \ \ MaskType\ skip\_next\ =\ (\_array[w].get\_bit(b))\ ?\ MaskType::all\_on()\ :\ MaskType::all\_off();}
\DoxyCodeLine{00427\ \ \ \textcolor{keywordtype}{int}\ w2\ =\ w;}
\DoxyCodeLine{00428\ \ \ ++w2;}
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{while}\ (w2\ <\ num\_words\ \&\&\ \_array[w2]\ ==\ skip\_next)\ \{}
\DoxyCodeLine{00430\ \ \ \ \ ++w2;}
\DoxyCodeLine{00431\ \ \ \}}
\DoxyCodeLine{00432\ \ \ \textcolor{keywordflow}{if}\ (w2\ >=\ num\_words)\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{comment}{//\ All\ bits\ higher\ are\ the\ same\ value.}}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordtype}{int}\ is\_on\ =\ \_array[w].get\_bit(b);}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{keywordflow}{return}\ is\_on\ ?\ (num\_words\ *\ num\_bits\_per\_word)\ :\ low\_bit;}
\DoxyCodeLine{00436\ \ \ \}}
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{if}\ (\_array[w2].get\_bit(0)\ !=\ \_array[w].get\_bit(b))\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{comment}{//\ The\ first\ bit\ of\ word\ w2\ is\ different.}}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{return}\ w2\ *\ num\_bits\_per\_word;}
\DoxyCodeLine{00440\ \ \ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ b2\ =\ \_array[w2].get\_next\_higher\_different\_bit(0);}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{return}\ w2\ *\ num\_bits\_per\_word\ +\ b2;}
\DoxyCodeLine{00444\ \}}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00450\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a4c8096e8a6a55b5c73e4f367a937f6fd}{BitArray::}}}
\DoxyCodeLine{00451\ \mbox{\hyperlink{classBitArray_a4c8096e8a6a55b5c73e4f367a937f6fd}{invert\_in\_place}}()\ \{}
\DoxyCodeLine{00452\ \ \ \_highest\_bits\ =\ !\_highest\_bits;}
\DoxyCodeLine{00453\ \ \ copy\_on\_write();}
\DoxyCodeLine{00454\ \ \ Array::iterator\ ai;}
\DoxyCodeLine{00455\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin();\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00456\ \ \ \ \ (*ai)\ =\ \string~(*ai);}
\DoxyCodeLine{00457\ \ \ \}}
\DoxyCodeLine{00458\ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00466\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBitArray_a994da92d3a41891ed957d8f84a1ff3fe}{BitArray::}}}
\DoxyCodeLine{00467\ \mbox{\hyperlink{classBitArray_a994da92d3a41891ed957d8f84a1ff3fe}{has\_bits\_in\_common}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00468\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits\ \&\&\ other.\_highest\_bits)\ \{}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{comment}{//\ Yup,\ in\ fact\ we\ have\ an\ infinite\ number\ of\ bits\ in\ common.}}
\DoxyCodeLine{00470\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00471\ \ \ \}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \textcolor{keywordtype}{size\_t}\ num\_common\_words\ =\ min(\_array.size(),\ other.\_array.size());}
\DoxyCodeLine{00474\ }
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ are\ on\ top\ of\ either\ array.}}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{if}\ (other.\_array.size()\ <\ \_array.size()\ \&\&\ other.\_highest\_bits)\ \{}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{comment}{//\ The\ other\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ the}}
\DoxyCodeLine{00478\ \ \ \ \ \textcolor{comment}{//\ other\ array\ are\ all\ ones.\ \ We\ have\ bits\ in\ common\ if\ any\ of\ our\ top\ n}}
\DoxyCodeLine{00479\ \ \ \ \ \textcolor{comment}{//\ words\ are\ nonzero.}}
\DoxyCodeLine{00480\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin()\ +\ other.\_array.size();}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ ai\ !=\ \_array.end();}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ai).is\_zero())\ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00487\ \ \ \ \ \}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00489\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_array.size()\ <\ other.\_array.size()\ \&\&\ \_highest\_bits)\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{comment}{//\ This\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ this\ array}}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{comment}{//\ are\ all\ ones.\ \ We\ have\ bits\ in\ common\ if\ any\ of\ the\ the\ other's\ top\ n}}
\DoxyCodeLine{00492\ \ \ \ \ \textcolor{comment}{//\ words\ are\ nonzero.}}
\DoxyCodeLine{00493\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other.\_array.begin()\ +\ \_array.size();}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ ai\ !=\ other.\_array.end();}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ai).is\_zero())\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00500\ \ \ \ \ \}}
\DoxyCodeLine{00501\ \ \ \}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00503\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ both\ arrays\ have\ in\ common.}}
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_common\_words;\ ++i)\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(\_array[i]\ \&\ other.\_array[i]).is\_zero())\ \{}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00507\ \ \ \ \ \}}
\DoxyCodeLine{00508\ \ \ \}}
\DoxyCodeLine{00509\ }
\DoxyCodeLine{00510\ \ \ \textcolor{comment}{//\ Nope,\ nothing.}}
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00512\ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00519\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a7aa257db45436eeb86ce97ba3ec226b5}{BitArray::}}}
\DoxyCodeLine{00520\ \mbox{\hyperlink{classBitArray_a7aa257db45436eeb86ce97ba3ec226b5}{output}}(ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00521\ \ \ \mbox{\hyperlink{classBitArray_a1599bad8a658649015cfe1335199ad04}{output\_hex}}(out);}
\DoxyCodeLine{00522\ \}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00527\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_ac4410cc731045b0005ca007d52ee91ad}{BitArray::}}}
\DoxyCodeLine{00528\ \mbox{\hyperlink{classBitArray_ac4410cc731045b0005ca007d52ee91ad}{output\_binary}}(ostream\ \&out,\ \textcolor{keywordtype}{int}\ spaces\_every)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00529\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00530\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}...1\ "{}};}
\DoxyCodeLine{00531\ \ \ \}}
\DoxyCodeLine{00532\ \ \ \textcolor{keywordtype}{int}\ num\_bits\ =\ max((\textcolor{keywordtype}{int})get\_num\_bits(),\ spaces\_every);}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ num\_bits\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{00534\ \ \ \ \ \textcolor{keywordflow}{if}\ (spaces\_every\ !=\ 0\ \&\&\ ((i\ \%\ spaces\_every)\ ==\ spaces\_every\ -\/\ 1))\ \{}
\DoxyCodeLine{00535\ \ \ \ \ \ \ out\ <<\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{00536\ \ \ \ \ \}}
\DoxyCodeLine{00537\ \ \ \ \ out\ <<\ (get\_bit(i)\ ?\ \textcolor{charliteral}{'1'}\ :\ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00538\ \ \ \}}
\DoxyCodeLine{00539\ \}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00545\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a1599bad8a658649015cfe1335199ad04}{BitArray::}}}
\DoxyCodeLine{00546\ \mbox{\hyperlink{classBitArray_a1599bad8a658649015cfe1335199ad04}{output\_hex}}(ostream\ \&out,\ \textcolor{keywordtype}{int}\ spaces\_every)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00547\ \ \ \textcolor{keywordtype}{int}\ num\_bits\ =\ get\_num\_bits();}
\DoxyCodeLine{00548\ \ \ \textcolor{keywordtype}{int}\ num\_digits\ =\ max((num\_bits\ +\ 3)\ /\ 4,\ spaces\_every);}
\DoxyCodeLine{00549\ }
\DoxyCodeLine{00550\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00551\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}...f\ "{}};}
\DoxyCodeLine{00552\ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ num\_digits\ -\/\ 1;\ i\ >=\ 0;\ i-\/-\/)\ \{}
\DoxyCodeLine{00555\ \ \ \ \ WordType\ digit\ =\ extract(i\ *\ 4,\ 4);}
\DoxyCodeLine{00556\ \ \ \ \ \textcolor{keywordflow}{if}\ (spaces\_every\ !=\ 0\ \&\&\ ((i\ \%\ spaces\_every)\ ==\ spaces\_every\ -\/\ 1))\ \{}
\DoxyCodeLine{00557\ \ \ \ \ \ \ out\ <<\ \textcolor{charliteral}{'\ '};}
\DoxyCodeLine{00558\ \ \ \ \ \}}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{if}\ (digit\ >\ 9)\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \ \ out\ <<\ (char)(digit\ -\/\ 10\ +\ \textcolor{charliteral}{'a'});}
\DoxyCodeLine{00561\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00562\ \ \ \ \ \ \ out\ <<\ (char)(digit\ +\ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00563\ \ \ \ \ \}}
\DoxyCodeLine{00564\ \ \ \}}
\DoxyCodeLine{00565\ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00571\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_adf7f6a269c19c540a0c8a88ad9899558}{BitArray::}}}
\DoxyCodeLine{00572\ \mbox{\hyperlink{classBitArray_adf7f6a269c19c540a0c8a88ad9899558}{write}}(ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00573\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00574\ \}}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00581\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classBitArray_a2fff089f35dc27d78295bfae96f5ec32}{BitArray::}}}
\DoxyCodeLine{00582\ \mbox{\hyperlink{classBitArray_a2fff089f35dc27d78295bfae96f5ec32}{compare\_to}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00583\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits\ !=\ other.\_highest\_bits)\ \{}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keywordflow}{return}\ \_highest\_bits\ ?\ 1\ :\ -\/1;}
\DoxyCodeLine{00585\ \ \ \}}
\DoxyCodeLine{00586\ }
\DoxyCodeLine{00587\ \ \ \textcolor{keywordtype}{int}\ num\_words\ =\ max(get\_num\_words(),\ other.get\_num\_words());}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \textcolor{comment}{//\ Compare\ from\ highest-\/order\ to\ lowest-\/order\ word.}}
\DoxyCodeLine{00590\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ num\_words\ -\/\ 1;\ i\ >=\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{keywordtype}{int}\ compare\ =\ get\_word\_internal(i).compare\_to(other.get\_word\_internal(i));}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keywordflow}{if}\ (compare\ !=\ 0)\ \{}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ compare;}
\DoxyCodeLine{00594\ \ \ \ \ \}}
\DoxyCodeLine{00595\ \ \ \}}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00603\ \textcolor{keywordtype}{void}\ BitArray::}
\DoxyCodeLine{00604\ operator\ \&=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&other)\ \{}
\DoxyCodeLine{00605\ \ \ \textcolor{keywordtype}{size\_t}\ num\_common\_words\ =\ min(\_array.size(),\ other.\_array.size());}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ copy\_on\_write();}
\DoxyCodeLine{00608\ }
\DoxyCodeLine{00609\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ are\ on\ top\ of\ either\ array.}}
\DoxyCodeLine{00610\ \ \ \textcolor{keywordflow}{if}\ (other.\_array.size()\ <\ \_array.size()\ \&\&\ !other.\_highest\_bits)\ \{}
\DoxyCodeLine{00611\ \ \ \ \ \textcolor{comment}{//\ The\ other\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ the}}
\DoxyCodeLine{00612\ \ \ \ \ \textcolor{comment}{//\ other\ array\ are\ all\ zeroes.\ \ "{}mask\ off"{}\ the\ top\ n\ words\ of\ this\ array.}}
\DoxyCodeLine{00613\ \ \ \ \ \_array.erase(\_array.begin()\ +\ other.\_array.size(),\ \_array.end());}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_array.size()\ <\ other.\_array.size()\ \&\&\ \_highest\_bits)\ \{}
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{comment}{//\ This\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ this\ array}}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{comment}{//\ are\ all\ ones.\ \ "{}mask\ on"{}\ the\ top\ n\ words\ of\ the\ other\ array.}}
\DoxyCodeLine{00618\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00619\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other.\_array.begin()\ +\ \_array.size();}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ ai\ !=\ other.\_array.end();}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \_array.push\_back(*ai);}
\DoxyCodeLine{00623\ \ \ \ \ \}}
\DoxyCodeLine{00624\ \ \ \}}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ both\ arrays\ have\ in\ common.}}
\DoxyCodeLine{00627\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_common\_words;\ ++i)\ \{}
\DoxyCodeLine{00628\ \ \ \ \ \_array[i]\ \&=\ other.\_array[i];}
\DoxyCodeLine{00629\ \ \ \}}
\DoxyCodeLine{00630\ }
\DoxyCodeLine{00631\ \ \ \_highest\_bits\ \&=\ other.\_highest\_bits;}
\DoxyCodeLine{00632\ \ \ normalize();}
\DoxyCodeLine{00633\ \}}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00638\ \textcolor{keywordtype}{void}\ BitArray::}
\DoxyCodeLine{00639\ operator\ |=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&other)\ \{}
\DoxyCodeLine{00640\ \ \ \textcolor{keywordtype}{size\_t}\ num\_common\_words\ =\ min(\_array.size(),\ other.\_array.size());}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ copy\_on\_write();}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ are\ on\ top\ of\ either\ array.}}
\DoxyCodeLine{00645\ \ \ \textcolor{keywordflow}{if}\ (other.\_array.size()\ <\ \_array.size()\ \&\&\ other.\_highest\_bits)\ \{}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{comment}{//\ The\ other\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ the}}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{comment}{//\ other\ array\ are\ all\ ones.\ \ The\ top\ n\ words\ of\ this\ array\ become\ ones}}
\DoxyCodeLine{00648\ \ \ \ \ \textcolor{comment}{//\ too\ (which\ means\ we\ can\ drop\ them\ out).}}
\DoxyCodeLine{00649\ \ \ \ \ \_array.erase(\_array.begin()\ +\ other.\_array.size(),\ \_array.end());}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_array.size()\ <\ other.\_array.size()\ \&\&\ !\_highest\_bits)\ \{}
\DoxyCodeLine{00652\ \ \ \ \ \textcolor{comment}{//\ This\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ this\ array}}
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{comment}{//\ are\ all\ zeros.\ \ Copy\ in\ the\ top\ n\ words\ of\ the\ other\ array.}}
\DoxyCodeLine{00654\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other.\_array.begin()\ +\ \_array.size();}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ ai\ !=\ other.\_array.end();}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \_array.push\_back(*ai);}
\DoxyCodeLine{00659\ \ \ \ \ \}}
\DoxyCodeLine{00660\ \ \ \}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ both\ arrays\ have\ in\ common.}}
\DoxyCodeLine{00663\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_common\_words;\ ++i)\ \{}
\DoxyCodeLine{00664\ \ \ \ \ \_array[i]\ |=\ other.\_array[i];}
\DoxyCodeLine{00665\ \ \ \}}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \_highest\_bits\ |=\ other.\_highest\_bits;}
\DoxyCodeLine{00668\ \ \ normalize();}
\DoxyCodeLine{00669\ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00674\ \textcolor{keywordtype}{void}\ BitArray::}
\DoxyCodeLine{00675\ operator\ \string^=\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classBitArray}{BitArray}}\ \&other)\ \{}
\DoxyCodeLine{00676\ \ \ \textcolor{keywordtype}{size\_t}\ num\_common\_words\ =\ min(\_array.size(),\ other.\_array.size());}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ copy\_on\_write();}
\DoxyCodeLine{00679\ }
\DoxyCodeLine{00680\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ are\ on\ top\ of\ either\ array.}}
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{if}\ (other.\_array.size()\ <\ \_array.size()\ \&\&\ other.\_highest\_bits)\ \{}
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{comment}{//\ The\ other\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ the}}
\DoxyCodeLine{00683\ \ \ \ \ \textcolor{comment}{//\ other\ array\ are\ all\ ones.\ \ The\ top\ n\ words\ of\ this\ array\ get\ inverted.}}
\DoxyCodeLine{00684\ \ \ \ \ Array::iterator\ ai;}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin()\ +\ other.\_array.size();}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ \ ai\ !=\ \_array.end();}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00688\ \ \ \ \ \ \ (*ai).invert\_in\_place();}
\DoxyCodeLine{00689\ \ \ \ \ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_array.size()\ <\ other.\_array.size())\ \{}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_highest\_bits)\ \{}
\DoxyCodeLine{00693\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ this\ array}}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \textcolor{comment}{//\ are\ all\ zeros.\ \ Copy\ in\ the\ top\ n\ words\ of\ the\ other\ array.}}
\DoxyCodeLine{00695\ \ \ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other.\_array.begin()\ +\ \_array.size();}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ ai\ !=\ other.\_array.end();}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ \_array.push\_back(*ai);}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00701\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ array\ has\ fewer\ actual\ words,\ and\ the\ top\ n\ words\ of\ this\ array}}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \textcolor{comment}{//\ are\ all\ ones.\ \ Copy\ in\ the\ top\ n\ words\ of\ the\ other\ array,\ inverted.}}
\DoxyCodeLine{00704\ \ \ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other.\_array.begin()\ +\ \_array.size();}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ ai\ !=\ other.\_array.end();}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ ++ai)\ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \_array.push\_back(\string~(*ai));}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00710\ \ \ \ \ \}}
\DoxyCodeLine{00711\ \ \ \}}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \textcolor{comment}{//\ Consider\ the\ words\ that\ both\ arrays\ have\ in\ common.}}
\DoxyCodeLine{00714\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_common\_words;\ ++i)\ \{}
\DoxyCodeLine{00715\ \ \ \ \ \_array[i]\ \string^=\ other.\_array[i];}
\DoxyCodeLine{00716\ \ \ \}}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00718\ \ \ \_highest\_bits\ \string^=\ other.\_highest\_bits;}
\DoxyCodeLine{00719\ \ \ normalize();}
\DoxyCodeLine{00720\ \}}
\DoxyCodeLine{00721\ }
\DoxyCodeLine{00726\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_ae99c2501cf5cf9266dca9376e4a3e622}{BitArray::}}}
\DoxyCodeLine{00727\ \mbox{\hyperlink{classBitArray_ae99c2501cf5cf9266dca9376e4a3e622}{operator\ <<=\ }}(\textcolor{keywordtype}{int}\ shift)\ \{}
\DoxyCodeLine{00728\ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ 0\ ||\ \_array.empty())\ \{}
\DoxyCodeLine{00729\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00730\ \ \ \}}
\DoxyCodeLine{00731\ \ \ \textcolor{keywordflow}{if}\ (shift\ <\ 0)\ \{}
\DoxyCodeLine{00732\ \ \ \ \ \mbox{\hyperlink{classBitArray_a6f7732dd13982d13322e35ca86d5a042}{operator\ >>=\ }}(-\/shift);}
\DoxyCodeLine{00733\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00734\ \ \ \}}
\DoxyCodeLine{00735\ }
\DoxyCodeLine{00736\ \ \ \textcolor{keywordtype}{int}\ w\ =\ shift\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00737\ \ \ \textcolor{keywordtype}{int}\ b\ =\ shift\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \ \ \textcolor{keywordflow}{if}\ (b\ ==\ 0)\ \{}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{comment}{//\ Easy\ case-\/-\/word-\/at-\/a-\/time.}}
\DoxyCodeLine{00741\ \ \ \ \ Array\ new\_array;}
\DoxyCodeLine{00742\ \ \ \ \ new\_array.reserve(\_array.size()\ +\ w);}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ w;\ ++i)\ \{}
\DoxyCodeLine{00744\ \ \ \ \ \ \ new\_array.push\_back(MaskType::all\_off());}
\DoxyCodeLine{00745\ \ \ \ \ \}}
\DoxyCodeLine{00746\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin();\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ new\_array.push\_back(*ai);}
\DoxyCodeLine{00749\ \ \ \ \ \}}
\DoxyCodeLine{00750\ \ \ \ \ \_array\ =\ new\_array;}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00753\ \ \ \ \ \textcolor{comment}{//\ Harder\ case-\/-\/we\ have\ to\ shuffle\ bits\ between\ words.}}
\DoxyCodeLine{00754\ \ \ \ \ Array\ new\_array;}
\DoxyCodeLine{00755\ \ \ \ \ new\_array.reserve(\_array.size()\ +\ w\ +\ 1);}
\DoxyCodeLine{00756\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ w;\ ++i)\ \{}
\DoxyCodeLine{00757\ \ \ \ \ \ \ new\_array.push\_back(MaskType::all\_off());}
\DoxyCodeLine{00758\ \ \ \ \ \}}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordtype}{int}\ downshift\_count\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00761\ \ \ \ \ MaskType\ lower\_mask\ =\ MaskType::lower\_on(downshift\_count);}
\DoxyCodeLine{00762\ \ \ \ \ MaskType\ upper\_mask\ =\ \string~lower\_mask;}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \ \ Array::const\_iterator\ ai\ =\ \_array.begin();}
\DoxyCodeLine{00765\ \ \ \ \ nassertv(ai\ !=\ \_array.end());}
\DoxyCodeLine{00766\ \ \ \ \ MaskType\ next\_bits\ =\ ((*ai)\ \&\ upper\_mask)\ >>\ downshift\_count;}
\DoxyCodeLine{00767\ \ \ \ \ new\_array.push\_back(((*ai)\ \&\ lower\_mask)\ <<\ b);}
\DoxyCodeLine{00768\ \ \ \ \ ++ai;}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{keywordflow}{while}\ (ai\ !=\ \_array.end())\ \{}
\DoxyCodeLine{00770\ \ \ \ \ \ \ new\_array.push\_back((((*ai)\ \&\ lower\_mask)\ <<\ b)\ |\ next\_bits);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ next\_bits\ =\ ((*ai)\ \&\ upper\_mask)\ >>\ downshift\_count;}
\DoxyCodeLine{00772\ \ \ \ \ \ \ ++ai;}
\DoxyCodeLine{00773\ \ \ \ \ \}}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{comment}{//\ Finally,\ the\ top\ n\ bits.}}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ next\_bits\ |=\ \string~MaskType::lower\_on(b);}
\DoxyCodeLine{00778\ \ \ \ \ \}}
\DoxyCodeLine{00779\ \ \ \ \ new\_array.push\_back(next\_bits);}
\DoxyCodeLine{00780\ \ \ \ \ \_array\ =\ new\_array;}
\DoxyCodeLine{00781\ \ \ \}}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ normalize();}
\DoxyCodeLine{00784\ \}}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00791\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a6f7732dd13982d13322e35ca86d5a042}{BitArray::}}}
\DoxyCodeLine{00792\ \mbox{\hyperlink{classBitArray_a6f7732dd13982d13322e35ca86d5a042}{operator\ >>=\ }}(\textcolor{keywordtype}{int}\ shift)\ \{}
\DoxyCodeLine{00793\ \ \ \textcolor{keywordflow}{if}\ (shift\ ==\ 0\ ||\ \_array.empty())\ \{}
\DoxyCodeLine{00794\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00795\ \ \ \}}
\DoxyCodeLine{00796\ \ \ \textcolor{keywordflow}{if}\ (shift\ <\ 0)\ \{}
\DoxyCodeLine{00797\ \ \ \ \ \mbox{\hyperlink{classBitArray_ae99c2501cf5cf9266dca9376e4a3e622}{operator\ <<=\ }}(-\/shift);}
\DoxyCodeLine{00798\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00799\ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \textcolor{keywordtype}{int}\ w\ =\ shift\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordtype}{int}\ b\ =\ shift\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \ \ \textcolor{keywordflow}{if}\ (w\ >=\ (\textcolor{keywordtype}{int})\_array.size())\ \{}
\DoxyCodeLine{00805\ \ \ \ \ \textcolor{comment}{//\ Trivial\ case-\/-\/shift\ to\ nothing.}}
\DoxyCodeLine{00806\ \ \ \ \ \_array.clear();}
\DoxyCodeLine{00807\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00808\ \ \ \}}
\DoxyCodeLine{00809\ }
\DoxyCodeLine{00810\ \ \ \textcolor{keywordflow}{if}\ (b\ ==\ 0)\ \{}
\DoxyCodeLine{00811\ \ \ \ \ \textcolor{comment}{//\ Easy\ case-\/-\/word-\/at-\/a-\/time.}}
\DoxyCodeLine{00812\ \ \ \ \ Array\ new\_array;}
\DoxyCodeLine{00813\ \ \ \ \ new\_array.reserve(\_array.size()\ -\/\ w);}
\DoxyCodeLine{00814\ \ \ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00815\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin()\ +\ w;\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00816\ \ \ \ \ \ \ new\_array.push\_back(*ai);}
\DoxyCodeLine{00817\ \ \ \ \ \}}
\DoxyCodeLine{00818\ \ \ \ \ \_array\ =\ new\_array;}
\DoxyCodeLine{00819\ }
\DoxyCodeLine{00820\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{comment}{//\ Harder\ case-\/-\/we\ have\ to\ shuffle\ bits\ between\ words.}}
\DoxyCodeLine{00822\ \ \ \ \ Array\ new\_array;}
\DoxyCodeLine{00823\ \ \ \ \ new\_array.reserve(\_array.size()\ -\/\ w);}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00825\ \ \ \ \ \textcolor{keywordtype}{int}\ upshift\_count\ =\ num\_bits\_per\_word\ -\/\ b;}
\DoxyCodeLine{00826\ \ \ \ \ MaskType\ lower\_mask\ =\ MaskType::lower\_on(b);}
\DoxyCodeLine{00827\ \ \ \ \ MaskType\ upper\_mask\ =\ \string~lower\_mask;}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00829\ \ \ \ \ Array::const\_iterator\ ai\ =\ \_array.begin()\ +\ w;}
\DoxyCodeLine{00830\ \ \ \ \ nassertv(ai\ <\ \_array.end());}
\DoxyCodeLine{00831\ \ \ \ \ MaskType\ next\_bits\ =\ ((*ai)\ \&\ upper\_mask)\ >>\ b;}
\DoxyCodeLine{00832\ }
\DoxyCodeLine{00833\ \ \ \ \ ++ai;}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{keywordflow}{while}\ (ai\ !=\ \_array.end())\ \{}
\DoxyCodeLine{00835\ \ \ \ \ \ \ new\_array.push\_back((((*ai)\ \&\ lower\_mask)\ <<\ upshift\_count)\ |\ next\_bits);}
\DoxyCodeLine{00836\ \ \ \ \ \ \ next\_bits\ =\ ((*ai)\ \&\ upper\_mask)\ >>\ b;}
\DoxyCodeLine{00837\ \ \ \ \ \ \ ++ai;}
\DoxyCodeLine{00838\ \ \ \ \ \}}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \ \ \ \ \textcolor{comment}{//\ Finally,\ the\ top\ n\ bits.}}
\DoxyCodeLine{00841\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00842\ \ \ \ \ \ \ next\_bits\ |=\ \string~MaskType::lower\_on(upshift\_count);}
\DoxyCodeLine{00843\ \ \ \ \ \}}
\DoxyCodeLine{00844\ \ \ \ \ new\_array.push\_back(next\_bits);}
\DoxyCodeLine{00845\ \ \ \ \ \_array\ =\ new\_array;}
\DoxyCodeLine{00846\ \ \ \}}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00848\ \ \ normalize();}
\DoxyCodeLine{00849\ \}}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00854\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a41fc1755a2c3549d970bf6965c37c812}{BitArray::}}}
\DoxyCodeLine{00855\ \mbox{\hyperlink{classBitArray_a41fc1755a2c3549d970bf6965c37c812}{generate\_hash}}(\mbox{\hyperlink{classChecksumHashGenerator}{ChecksumHashGenerator}}\ \&hashgen)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00856\ \ \ hashgen.add\_int(\_highest\_bits);}
\DoxyCodeLine{00857\ \ \ Array::const\_iterator\ ai;}
\DoxyCodeLine{00858\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_array.begin();\ ai\ !=\ \_array.end();\ ++ai)\ \{}
\DoxyCodeLine{00859\ \ \ \ \ hashgen.add\_int((*ai).get\_word());}
\DoxyCodeLine{00860\ \ \ \}}
\DoxyCodeLine{00861\ \}}
\DoxyCodeLine{00862\ }
\DoxyCodeLine{00866\ \textcolor{keywordtype}{void}\ BitArray::}
\DoxyCodeLine{00867\ ensure\_has\_word(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{00868\ \ \ copy\_on\_write();}
\DoxyCodeLine{00869\ }
\DoxyCodeLine{00870\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{size\_t})n\ >=\ \_array.size())\ \{}
\DoxyCodeLine{00872\ \ \ \ \ \ \ \_array.push\_back(MaskType::all\_on());}
\DoxyCodeLine{00873\ \ \ \ \ \}}
\DoxyCodeLine{00874\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{keywordflow}{while}\ ((\textcolor{keywordtype}{size\_t})n\ >=\ \_array.size())\ \{}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \_array.push\_back(MaskType::all\_off());}
\DoxyCodeLine{00877\ \ \ \ \ \}}
\DoxyCodeLine{00878\ \ \ \}}
\DoxyCodeLine{00879\ \}}
\DoxyCodeLine{00880\ }
\DoxyCodeLine{00885\ \textcolor{keywordtype}{void}\ BitArray::}
\DoxyCodeLine{00886\ normalize()\ \{}
\DoxyCodeLine{00887\ \ \ \textcolor{keywordflow}{if}\ (\_highest\_bits)\ \{}
\DoxyCodeLine{00888\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_array.empty()\ \&\&\ \_array.back()\ ==\ MaskType::all\_on())\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \ \ copy\_on\_write();}
\DoxyCodeLine{00890\ \ \ \ \ \ \ \_array.pop\_back();}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!\_array.empty()\ \&\&\ \_array.back()\ ==\ MaskType::all\_on())\ \{}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ \_array.pop\_back();}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00894\ \ \ \ \ \}}
\DoxyCodeLine{00895\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_array.empty()\ \&\&\ \_array.back().is\_zero())\ \{}
\DoxyCodeLine{00897\ \ \ \ \ \ \ copy\_on\_write();}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \_array.pop\_back();}
\DoxyCodeLine{00899\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!\_array.empty()\ \&\&\ \_array.back().is\_zero())\ \{}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \_array.pop\_back();}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00902\ \ \ \ \ \}}
\DoxyCodeLine{00903\ \ \ \}}
\DoxyCodeLine{00904\ \}}
\DoxyCodeLine{00905\ }
\DoxyCodeLine{00910\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_abc9ce4c1f8fbba35710087a4e430a43c}{BitArray::}}}
\DoxyCodeLine{00911\ \mbox{\hyperlink{classBitArray_abc9ce4c1f8fbba35710087a4e430a43c}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00912\ \ \ dg.add\_uint32(\_array.size()\ *\ (num\_bits\_per\_word\ >>\ 5));}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \ \ \textcolor{keywordflow}{for}\ (MaskType\ \&item\ :\ \_array)\ \{}
\DoxyCodeLine{00915\ \ \ \ \ WordType\ word\ =\ item.get\_word();}
\DoxyCodeLine{00916\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_bits\_per\_word;\ i\ +=\ 32)\ \{}
\DoxyCodeLine{00917\ \ \ \ \ \ \ dg.add\_uint32(word);}
\DoxyCodeLine{00918\ \ \ \ \ \ \ word\ >>=\ 32;}
\DoxyCodeLine{00919\ \ \ \ \ \}}
\DoxyCodeLine{00920\ \ \ \}}
\DoxyCodeLine{00921\ \ \ dg.add\_uint8(\_highest\_bits);}
\DoxyCodeLine{00922\ \}}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00927\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBitArray_a61b9fda12c5dca222d1c568e9ccb3cef}{BitArray::}}}
\DoxyCodeLine{00928\ \mbox{\hyperlink{classBitArray_a61b9fda12c5dca222d1c568e9ccb3cef}{read\_datagram}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00929\ \ \ \textcolor{keywordtype}{size\_t}\ num\_words32\ =\ scan.get\_uint32();}
\DoxyCodeLine{00930\ \ \ \textcolor{keywordtype}{size\_t}\ num\_bits\ =\ num\_words32\ <<\ 5;}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ \ \ \_array\ =\ Array::empty\_array((num\_bits\ +\ num\_bits\_per\_word\ -\/\ 1)\ /\ num\_bits\_per\_word);}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00934\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_bits;\ i\ +=\ 32)\ \{}
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordtype}{int}\ w\ =\ i\ /\ num\_bits\_per\_word;}
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keywordtype}{int}\ b\ =\ i\ \%\ num\_bits\_per\_word;}
\DoxyCodeLine{00937\ }
\DoxyCodeLine{00938\ \ \ \ \ \_array[w].store(scan.get\_uint32(),\ b,\ 32);}
\DoxyCodeLine{00939\ \ \ \}}
\DoxyCodeLine{00940\ \ \ \_highest\_bits\ =\ scan.get\_uint8();}
\DoxyCodeLine{00941\ \}}

\end{DoxyCode}
