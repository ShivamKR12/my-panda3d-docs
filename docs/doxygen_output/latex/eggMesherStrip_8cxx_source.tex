\doxysection{egg\+Mesher\+Strip.\+cxx}
\hypertarget{eggMesherStrip_8cxx_source}{}\label{eggMesherStrip_8cxx_source}\index{panda/src/egg/eggMesherStrip.cxx@{panda/src/egg/eggMesherStrip.cxx}}
\mbox{\hyperlink{eggMesherStrip_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggMesherStrip_8h}{eggMesherStrip.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggMesherEdge_8h}{eggMesherEdge.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggPrimitive_8h}{eggPrimitive.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggTriangleFan_8h}{eggTriangleFan.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggTriangleStrip_8h}{eggTriangleStrip.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggPolygon_8h}{eggPolygon.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__egg_8h}{config\_egg.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ EggMesherStrip::}
\DoxyCodeLine{00027\ EggMesherStrip(PrimType\ prim\_type,\ MesherOrigin\ origin)\ \{}
\DoxyCodeLine{00028\ \ \ \_origin\ =\ origin;}
\DoxyCodeLine{00029\ \ \ \_type\ =\ prim\_type;}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \_index\ =\ -\/1;}
\DoxyCodeLine{00032\ \ \ \_row\_id\ =\ 0;}
\DoxyCodeLine{00033\ \ \ \_status\ =\ MS\_alive;}
\DoxyCodeLine{00034\ \ \ \_planar\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00035\ \ \ \_flat\_shaded\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00041\ EggMesherStrip::}
\DoxyCodeLine{00042\ EggMesherStrip(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggPrimitive}{EggPrimitive}}\ *prim,\ \textcolor{keywordtype}{int}\ index,}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool,}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ flat\_shaded)\ \{}
\DoxyCodeLine{00045\ \ \ \_index\ =\ index;}
\DoxyCodeLine{00046\ \ \ \_row\_id\ =\ 0;}
\DoxyCodeLine{00047\ \ \ \_status\ =\ MS\_alive;}
\DoxyCodeLine{00048\ \ \ \_origin\ =\ MO\_unknown;}
\DoxyCodeLine{00049\ \ \ \_flat\_shaded\ =\ flat\_shaded;}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \_type\ =\ PT\_poly;\ \textcolor{comment}{//prim.get\_type();}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{comment}{//\ We\ care\ only\ about\ the\ prim's\ attributes\ in\ the\ \_prims\ array.\ \ The}}
\DoxyCodeLine{00054\ \ \ \textcolor{comment}{//\ vertices\ get\ re-\/added\ later\ by\ EggMesher::add\_prim().}}
\DoxyCodeLine{00055\ \ \ \_prims.push\_back(prim);}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ PT\_poly)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{switch}\ (prim-\/>size())\ \{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \_type\ =\ PT\_tri;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \_type\ =\ PT\_quad;}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ \ \ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ PT\_quad)\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ A\ quad\ has\ two\ internal\ triangles;\ we\ therefore\ push\ the\ prim}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ attributes\ twice.}}
\DoxyCodeLine{00072\ \ \ \ \ \_prims.push\_back(prim);}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \_planar\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}\ (prim-\/>is\_of\_type(EggPolygon::get\_class\_type()))\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{comment}{//\ Although\ for\ the\ most\ part\ we\ ignore\ the\ actual\ value\ of\ the\ vertices,}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ we\ will\ ask\ the\ polygon\ for\ its\ plane\ equation\ (i.e.\ \ its\ normal).}}
\DoxyCodeLine{00080\ \ \ \ \ LNormald\ normal;}
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{if}\ (DCAST(\mbox{\hyperlink{classEggPolygon}{EggPolygon}},\ prim)-\/>calculate\_normal(normal))\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \_plane\_normal\ =\ normal;}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \_planar\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00084\ \ \ \ \ \ \ LPoint3d\ p1\ =\ prim-\/>get\_vertex(0)-\/>get\_pos3();}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \_plane\_offset\ =\ -\/dot(\_plane\_normal,\ p1);}
\DoxyCodeLine{00086\ \ \ \ \ \}}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00095\ PT(\mbox{\hyperlink{classEggPrimitive}{EggPrimitive}})\ EggMesherStrip::}
\DoxyCodeLine{00096\ make\_prim(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00097\ \ \ PT(\mbox{\hyperlink{classEggPrimitive}{EggPrimitive}})\ prim;}
\DoxyCodeLine{00098\ \ \ PrimType\ dest\_type;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{00101\ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{00104\ \ \ \ \ dest\_type\ =\ PT\_tristrip;}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{case}\ PT\_trifan:}
\DoxyCodeLine{00108\ \ \ \ \ dest\_type\ =\ PT\_trifan;}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00112\ \ \ \ \ dest\_type\ =\ \_type;}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{if}\ (dest\_type\ !=\ PT\_tristrip\ \&\&\ dest\_type\ !=\ PT\_trifan)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ The\ easy\ case:\ a\ simple\ primitive,\ i.e.\ \ a\ polygon.}}
\DoxyCodeLine{00117\ \ \ \ \ prim\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggPolygon}{EggPolygon}};}
\DoxyCodeLine{00118\ \ \ \ \ prim-\/>copy\_attributes(*\_prims.front());}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ Verts::iterator\ vi;}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_verts.begin();\ vi\ !=\ \_verts.end();\ ++vi)\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ prim-\/>\mbox{\hyperlink{classEggPrimitive_a77bb4e987b18a54bbabfc068a325506a}{add\_vertex}}(vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(*vi));}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{comment}{//\ The\ harder\ case:\ a\ tristrip\ of\ some\ kind.}}
\DoxyCodeLine{00127\ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_affa33d62cbb644539d3fc00fdee34fd2}{convert\_to\_type}}(dest\_type);}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ (dest\_type\ ==\ PT\_trifan)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ prim\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggTriangleFan}{EggTriangleFan}};}
\DoxyCodeLine{00130\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ prim\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classEggTriangleStrip}{EggTriangleStrip}};}
\DoxyCodeLine{00132\ \ \ \ \ \}}
\DoxyCodeLine{00133\ \ \ \ \ prim-\/>copy\_attributes(*\_prims.front());}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{comment}{//\ Now\ store\ all\ the\ vertices.\ \ Each\ individual\ triangle's\ attributes,\ if}}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ any,\ get\ applied\ to\ the\ third\ vertex\ of\ each\ triangle.}}
\DoxyCodeLine{00137\ \ \ \ \ Verts::iterator\ vi;}
\DoxyCodeLine{00138\ \ \ \ \ Prims::iterator\ pi;}
\DoxyCodeLine{00139\ \ \ \ \ pi\ =\ \_prims.begin();}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_verts.begin();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ vi\ !=\ \_verts.end()\ \&\&\ pi\ !=\ \_prims.end();}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ ++vi)\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ PT(\mbox{\hyperlink{classEggVertex}{EggVertex}})\ vertex\ =\ vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(*vi);}
\DoxyCodeLine{00145\ \ \ \ \ \ \ prim-\/>\mbox{\hyperlink{classEggPrimitive_a77bb4e987b18a54bbabfc068a325506a}{add\_vertex}}(vertex);}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ >=\ 3)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Beginning\ with\ the\ third\ vertex,\ we\ increment\ pi.\ \ Thus,\ the\ first}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ two\ vertices\ stand\ alone,\ then\ each\ vertex\ beginning\ with\ the\ third}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ completes\ a\ triangle.}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggAttributes}{EggAttributes}}\ *attrib\ =\ (*pi);}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ ++pi;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ DCAST(\mbox{\hyperlink{classEggCompositePrimitive}{EggCompositePrimitive}},\ prim)-\/>set\_component(count\ -\/\ 3,\ attrib);}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00156\ \ \ \ \ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{comment}{//\ If\ either\ of\ these\ fail,\ there\ weren't\ num\_prims\ +\ 2\ vertices\ in\ the}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ tristrip!}}
\DoxyCodeLine{00160\ \ \ \ \ nassertr(vi\ ==\ \_verts.end(),\ prim);}
\DoxyCodeLine{00161\ \ \ \ \ nassertr(pi\ ==\ \_prims.end(),\ prim);}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \textcolor{keywordflow}{return}\ prim;}
\DoxyCodeLine{00165\ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00172\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_aa1d285702203a36bc33eac4fc9ee0901}{EggMesherStrip::}}}
\DoxyCodeLine{00173\ \mbox{\hyperlink{classEggMesherStrip_aa1d285702203a36bc33eac4fc9ee0901}{measure\_sheet}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge,\ \textcolor{keywordtype}{int}\ new\_row,\ \textcolor{keywordtype}{int}\ \&num\_prims,}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \&num\_rows,\ \textcolor{keywordtype}{int}\ first\_row\_id,\ \textcolor{keywordtype}{int}\ this\_row\_id,}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ this\_row\_distance)\ \{}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{if}\ (new\_row)\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ If\ we\ would\ create\ a\ new\ row\ by\ stepping\ here,\ we\ won't\ stay\ if\ there}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ was\ any\ other\ row\ already\ defined\ here.}}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_row\_id\ >=\ first\_row\_id)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00181\ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{comment}{//\ On\ the\ other\ hand,\ if\ this\ is\ a\ continuation\ of\ the\ current\ row,\ we'll}}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{//\ stay\ if\ the\ other\ row\ had\ to\ travel\ farther\ to\ get\ here.}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_row\_id\ >=\ first\_row\_id\ \&\&\ \_row\_distance\ <=\ this\_row\_distance)\ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00187\ \ \ \ \ \}}
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ num\_prims\ +=\ \_prims.size();}
\DoxyCodeLine{00191\ \ \ \textcolor{keywordflow}{if}\ (new\_row)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ ++num\_rows;}
\DoxyCodeLine{00193\ \ \ \ \ this\_row\_id\ =\ first\_row\_id\ +\ num\_rows\ -\/\ 1;}
\DoxyCodeLine{00194\ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ \ \ \_row\_id\ =\ this\_row\_id;}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ Edges::iterator\ ei;}
\DoxyCodeLine{00199\ \ \ EggMesherEdge::Strips::iterator\ si;}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ PT\_quad)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{comment}{//\ If\ this\ is\ a\ quad,\ it\ has\ four\ neighbors:\ two\ in\ the\ direction\ we\ are}}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{comment}{//\ testing,\ and\ two\ in\ an\ orthagonal\ direction.}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{comment}{//\ We\ use\ these\ vertices\ to\ differentiate\ the\ edges\ that\ run\ in\ our}}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{comment}{//\ primary\ direction\ from\ those\ in\ the\ secondary\ direction.\ \ For\ each}}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{comment}{//\ edge,\ we\ count\ the\ number\ of\ vertices\ that\ the\ edge\ shares\ with\ our}}
\DoxyCodeLine{00211\ \ \ \ \ \textcolor{comment}{//\ starting\ edge.\ \ There\ are\ then\ three\ cases:}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ (a)\ The\ edge\ shares\ two\ vertices.\ \ It\ is\ the\ direction\ we\ came\ from;}}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{comment}{//\ forget\ it.}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ (b)\ The\ edge\ shares\ one\ vertex.\ \ It\ is\ at\ right\ angles\ to\ our\ starting}}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{comment}{//\ edge.\ \ This\ is\ the\ primary\ direction\ if\ new\_row\ is\ true,\ and\ the}}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{comment}{//\ secondary\ direction\ if\ new\_row\ is\ false.}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{comment}{//\ (c)\ The\ edge\ shares\ no\ vertices.\ \ It\ is\ directly\ opposite\ our\ starting}}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{comment}{//\ edge.\ \ This\ is\ the\ primary\ direction\ if\ new\_row\ is\ false,\ and\ the}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{comment}{//\ secondary\ direction\ if\ new\_row\ is\ true.}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ silly\ little\ for\ loop\ that\ executes\ the\ following\ code\ twice:}}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{comment}{//\ once\ with\ secondary\ ==\ 0,\ and\ once\ with\ secondary\ ==\ 1.\ This\ is\ because}}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{comment}{//\ we\ want\ to\ find\ all\ the\ primary\ edges\ first,\ and\ then\ all\ the\ secondary}}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{comment}{//\ edges.}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ secondary\ =\ 0;\ secondary\ <=\ 1;\ secondary++)\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \textcolor{comment}{//\ How\ many\ common\ vertices\ are\ we\ looking\ for\ this\ pass\ (see\ above)?}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ want\_count;}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (secondary)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ want\_count\ =\ new\_row\ ?\ 0\ :\ 1;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ want\_count\ =\ new\_row\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ common\_verts\ =}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ ((*ei)-\/>\_vi\_a\ ==\ vi\_a\ ||\ (*ei)-\/>\_vi\_a\ ==\ vi\_b)\ +}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ ((*ei)-\/>\_vi\_b\ ==\ vi\_a\ ||\ (*ei)-\/>\_vi\_b\ ==\ vi\_b);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (common\_verts\ ==\ want\_count)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Here's\ the\ edge.\ \ Look\ at\ all\ its\ connections.\ \ Hopefully,\ there}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ will\ only\ be\ one\ besides\ ourselves,\ but\ there\ may\ be\ more.\ \ Pick}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ best.}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classplist}{EggMesherEdge::Strips}}\ \&strips\ =\ (*ei)-\/>\_strips;}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (si\ =\ strips.begin();\ si\ !=\ strips.end();\ ++si)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*si)-\/>\_row\_id\ <\ first\_row\_id)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ ==\ \textcolor{keyword}{nullptr}\ ||\ \mbox{\hyperlink{classEggMesherStrip_a7b847ced86b69527a8a3a77345498226}{pick\_sheet\_mate}}(**si,\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}))\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ *si;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}!=\textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>\mbox{\hyperlink{classEggMesherStrip_aa1d285702203a36bc33eac4fc9ee0901}{measure\_sheet}}(*ei,\ secondary,\ num\_prims,\ num\_rows,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ first\_row\_id,\ this\_row\_id,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ this\_row\_distance\ +\ secondary);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ \ \ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ this\ is\ not\ a\ quad.\ \ It's\ certainly\ not\ a\ triangle,\ because}}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{comment}{//\ we've\ built\ all\ the\ single\ triangles\ already.}}
\DoxyCodeLine{00271\ \ \ \ \ nassertv(\_type\ !=\ PT\_tri);}
\DoxyCodeLine{00272\ }
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{comment}{//\ Therefore,\ it\ must\ be\ a\ tristrip\ or\ quadstrip.}}
\DoxyCodeLine{00274\ \ \ \ \ nassertv(\_type\ ==\ PT\_tristrip\ ||\ \_type\ ==\ PT\_quadstrip);}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \ \ \textcolor{comment}{//\ Since\ it's\ a\ strip,\ it\ only\ has\ two\ neighbors:\ the\ one\ we\ came\ from,}}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{comment}{//\ and\ the\ other\ one.\ \ Find\ the\ other\ one.}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ei)-\/>matches(*edge))\ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Here's\ the\ edge.\ \ Same\ drill\ as\ above.}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classplist}{EggMesherEdge::Strips}}\ \&strips\ =\ (*ei)-\/>\_strips;}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (si\ =\ strips.begin();\ si\ !=\ strips.end();\ ++si)\ \{}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*si)-\/>\_row\_id\ <\ first\_row\_id)\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ ==\ \textcolor{keyword}{nullptr}\ ||\ \mbox{\hyperlink{classEggMesherStrip_a7b847ced86b69527a8a3a77345498226}{pick\_sheet\_mate}}(**si,\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}))\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ *si;}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>\mbox{\hyperlink{classEggMesherStrip_aa1d285702203a36bc33eac4fc9ee0901}{measure\_sheet}}(*ei,\ \textcolor{keyword}{false},\ num\_prims,\ num\_rows,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ first\_row\_id,\ this\_row\_id,\ this\_row\_distance);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00297\ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \}}
\DoxyCodeLine{00299\ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00305\ \textcolor{keywordtype}{void}\ EggMesherStrip::}
\DoxyCodeLine{00306\ cut\_sheet(\textcolor{keywordtype}{int}\ first\_row\_id,\ \textcolor{keywordtype}{int}\ do\_mate,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00307\ \ \ Edges::iterator\ ei;}
\DoxyCodeLine{00308\ \ \ EggMesherEdge::Strips::iterator\ si;}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \textcolor{comment}{//\ First,\ start\ the\ process\ going\ on\ any\ neighbors\ that\ belong\ to\ a\ later}}
\DoxyCodeLine{00311\ \ \ \textcolor{comment}{//\ row.\ \ (We\ must\ do\ these\ first,\ because\ we'll\ change\ our\ neighbor\ list}}
\DoxyCodeLine{00312\ \ \ \textcolor{comment}{//\ when\ we\ start\ to\ mate.)}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \textcolor{comment}{//\ We\ need\ to\ build\ a\ temporary\ list\ of\ neighbors\ first,\ because\ calling}}
\DoxyCodeLine{00315\ \ \ \textcolor{comment}{//\ cut\_sheet()\ recursively\ will\ start\ things\ mating,\ and\ could\ damage\ our}}
\DoxyCodeLine{00316\ \ \ \textcolor{comment}{//\ edge\ list.}}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classplist}{plist<EggMesherStrip\ *>}}\ StripPtrs;}
\DoxyCodeLine{00319\ \ \ StripPtrs\ strip\_ptrs;}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \mbox{\hyperlink{classplist}{EggMesherEdge::Strips}}\ \&strips\ =\ (*ei)-\/>\_strips;}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{for}\ (si\ =\ strips.begin();\ si\ !=\ strips.end();\ ++si)\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*si)-\/>\_row\_id\ >\ \_row\_id)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ different\ row\ in\ the\ sheet!}}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ strip\_ptrs.push\_back(*si);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ \textcolor{comment}{//\ Now\ walk\ the\ temporary\ list\ and\ do\ some\ damage.\ \ We\ pass\ do\_mate\ =\ true}}
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ to\ each\ of\ these\ neighbors,\ because\ as\ far\ as\ we\ know,\ they're\ the\ first}}
\DoxyCodeLine{00333\ \ \ \textcolor{comment}{//\ nodes\ of\ a\ particular\ row.}}
\DoxyCodeLine{00334\ \ \ StripPtrs::iterator\ spi;}
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{for}\ (spi\ =\ strip\_ptrs.begin();\ spi\ !=\ strip\_ptrs.end();\ ++spi)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*spi)-\/>\_status\ ==\ MS\_alive)\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ (*spi)-\/>cut\_sheet(first\_row\_id,\ \textcolor{keyword}{true},\ vertex\_pool);}
\DoxyCodeLine{00338\ \ \ \ \ \}}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \textcolor{keywordflow}{if}\ (do\_mate\ \&\&\ \_status\ ==\ MS\_alive)\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{comment}{//\ Now\ mate\ like\ a\ bunny\ until\ we\ don't\ have\ any\ more\ eligible\ mates.}}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordtype}{int}\ not\_any;}
\DoxyCodeLine{00345\ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ not\_any\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \ \ ei\ =\ \_edges.begin();}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (not\_any\ \&\&\ ei\ !=\ \_edges.end())\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classplist}{EggMesherEdge::Strips}}\ \&strips\ =\ (*ei)-\/>\_strips;}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ si\ =\ strips.begin();}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (not\_any\ \&\&\ si\ !=\ strips.end())\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*si\ !=\ \textcolor{keyword}{this}\ \&\&\ (*si)-\/>\_row\_id\ ==\ \_row\_id)\ \{}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Here's\ one!}}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ not\_any\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ *si;}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ also\ recurse\ on\ these\ guys\ so\ they\ can\ spread\ the\ word\ to}}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ their\ own\ neighbors.\ \ This\ time\ we\ don't\ need\ to\ build\ a}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ temporary\ list,\ because\ we'll\ be\ restarting\ from\ the\ beginning}}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ our\ edge\ list\ after\ we\ do\ this.\ \ We\ also\ pass\ do\_mate\ =}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ false\ to\ these\ guys\ because\ we're\ the\ ones\ doing\ the\ mating}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ here.}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>cut\_sheet(first\_row\_id,\ \textcolor{keyword}{false},\ vertex\_pool);}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_status\ ==\ MS\_alive\ \&\&\ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>\_status\ ==\ MS\_alive)\ \{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ mate.\ \ This\ will\ either\ succeed\ or\ fail.\ \ It\ ought\ to}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ succeed,\ but\ if\ it\ doesn't,\ no\ harm\ done;\ it\ will\ simply}}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ remove\ the\ common\ edge\ and\ return.\ \ We'll\ go\ around\ again\ and}}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ not\ encounter\ this\ neighbor\ next\ time.}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a7f7ea604ff532ff49e441da3623b07cf}{mate\_pieces}}(*ei,\ *\textcolor{keyword}{this},\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}},\ vertex\_pool);}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (not\_any)\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ ++si;}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (not\_any)\ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ ++ei;}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00382\ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (!not\_any);}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{comment}{//\ All\ done.\ \ Mark\ this\ one\ as\ down\ for\ the\ count.}}
\DoxyCodeLine{00385\ \ \ \ \ \_row\_id\ =\ -\/first\_row\_id;}
\DoxyCodeLine{00386\ \ \ \}}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00397\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{EggMesherStrip::}}}
\DoxyCodeLine{00398\ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00399\ \ \ \textcolor{comment}{//\ We\ must\ walk\ through\ the\ list\ of\ our\ neighbors\ and\ choose\ our\ best\ mate.}}
\DoxyCodeLine{00400\ \ \ nassertr(\_status\ ==\ MS\_alive,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}};}
\DoxyCodeLine{00403\ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *common\_edge;}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classEggMesherStrip_a10dec534d3fd041de52bc008161a6e02}{find\_ideal\_mate}}(\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}},\ common\_edge,\ vertex\_pool))\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{comment}{//\ We\ have\ no\ more\ eligible\ neighbors.\ \ Call\ us\ done.}}
\DoxyCodeLine{00407\ \ \ \ \ \_status\ =\ MS\_done;}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00410\ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ nassertr(!\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>\_prims.empty(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00413\ \ \ nassertr(!\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}-\/>\_verts.empty(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \mbox{\hyperlink{classEggMesherStrip_a7f7ea604ff532ff49e441da3623b07cf}{mate\_pieces}}(common\_edge,\ *\textcolor{keyword}{this},\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}},\ vertex\_pool);}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \textcolor{comment}{//\ Whether\ the\ mate\ failed\ or\ not,\ the\ strip\ still\ (probably)\ has\ other}}
\DoxyCodeLine{00418\ \ \ \textcolor{comment}{//\ neighbors\ to\ consider.\ \ Return\ true\ regardless.}}
\DoxyCodeLine{00419\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00420\ \}}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00426\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a10dec534d3fd041de52bc008161a6e02}{EggMesherStrip::}}}
\DoxyCodeLine{00427\ \mbox{\hyperlink{classEggMesherStrip_a10dec534d3fd041de52bc008161a6e02}{find\_ideal\_mate}}(\mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ *\&mate,\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *\&common\_edge,}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00429\ \ \ Edges::iterator\ ei;}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00432\ \ \ common\_edge\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \mbox{\hyperlink{classplist}{EggMesherEdge::Strips}}\ \&strips\ =\ (*ei)-\/>\_strips;}
\DoxyCodeLine{00436\ \ \ \ \ EggMesherEdge::Strips::iterator\ si;}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordflow}{for}\ (si\ =\ strips.begin();\ si\ !=\ strips.end();\ ++si)\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (*si\ !=\ \textcolor{keyword}{this})\ \{}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}==\textcolor{keyword}{nullptr}\ ||\ \mbox{\hyperlink{classEggMesherStrip_a77083a7d9c7cd67323039ffc0617c312}{pick\_mate}}(**si,\ *\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}},\ **ei,\ *common\_edge,}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ vertex\_pool))\ \{}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}\ =\ *si;}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ common\_edge\ =\ *ei;}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ \ \ \ \ \}}
\DoxyCodeLine{00446\ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classEggMesherStrip_a4032c4b30e62338edae91d7d70717a1e}{mate}}!=\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00449\ \}}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ }
\DoxyCodeLine{00458\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a7f7ea604ff532ff49e441da3623b07cf}{EggMesherStrip::}}}
\DoxyCodeLine{00459\ \mbox{\hyperlink{classEggMesherStrip_a7f7ea604ff532ff49e441da3623b07cf}{mate\_pieces}}(\mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *common\_edge,\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&front,}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&back,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00461\ \ \ nassertr(front.\_status\ ==\ MS\_alive,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00462\ \ \ nassertr(back.\_status\ ==\ MS\_alive,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00463\ \ \ nassertr(\&front\ !=\ \&back,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00466\ \ \ \textcolor{comment}{//\ remove\_sides\ tracks\ whether\ we\ want\ to\ remove\ all\ but\ the\ leading\ edges}}
\DoxyCodeLine{00467\ \ \ \textcolor{comment}{//\ of\ the\ newly\ joined\ piece\ if\ we\ succeed.}}
\DoxyCodeLine{00468\ \ \ \textcolor{keywordtype}{bool}\ remove\_sides\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \textcolor{keywordtype}{bool}\ is\_coplanar\ =\ front.is\_coplanar\_with(back,\ egg\_coplanar\_threshold);}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{if}\ (front.\_type\ ==\ PT\_tri\ \&\&\ back.\_type\ ==\ PT\_tri)\ \{}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_coplanar\ \&\&\ egg\_retesselate\_coplanar\ \&\&}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ front.\_prims.front()\ ==\ back.\_prims.front()\ \&\&}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip_acc343f8e5bb056b0af2bb194826a2cb0}{convex\_quad}}(common\_edge,\ front,\ back,\ vertex\_pool))\ \{}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ joining\ two\ equivalent\ coplanar\ triangles,\ call\ it\ a\ quad.}}
\DoxyCodeLine{00479\ \ \ \ \ \ \ front.\_type\ =\ PT\_quad;}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ add\ one\ additional\ vertex\ for\ the\ new\ triangle,\ the\ one\ vertex\ we}}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \textcolor{comment}{//\ didn't\ already\ share.}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_vert\ =\ back.\mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{find\_uncommon\_vertex}}(common\_edge);}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ just\ need\ to\ find\ the\ right\ place\ to\ insert\ it.\ \ It\ belongs\ in}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \textcolor{comment}{//\ the\ middle\ of\ the\ common\ edge,\ i.e.\ \ after\ the\ first\ vertex\ that\ is}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \textcolor{comment}{//\ on\ the\ common\ edge\ and\ before\ the\ second\ vertex.}}
\DoxyCodeLine{00488\ \ \ \ \ \ \ Verts::iterator\ a\ =\ front.\_verts.begin();}
\DoxyCodeLine{00489\ \ \ \ \ \ \ Verts::iterator\ b\ =\ a;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ ++b;}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (common\_edge-\/>contains\_vertex(*a))\ \{}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (common\_edge-\/>contains\_vertex(*b))\ \{}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ goes\ between\ a\ and\ b.}}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ front.\_verts.insert(b,\ new\_vert);}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ goes\ at\ the\ end.}}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ front.\_verts.push\_back(new\_vert);}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ goes\ between\ b\ and\ c.}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ ++b;}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ front.\_verts.insert(b,\ new\_vert);}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \ \ front.\_prims.splice(front.\_prims.end(),\ back.\_prims);}
\DoxyCodeLine{00507\ \ \ \ \ \ \ back.\_verts.clear();}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ leave\ all\ four\ surrounding\ edges\ for\ now,\ since\ the\ quad\ might}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{comment}{//\ still\ be\ joined\ up\ in\ any\ direction.}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ remove\_sides\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00513\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ connect\ the\ two\ tris\ into\ a\ tristrip.}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ front.\_type\ =\ PT\_tristrip;}
\DoxyCodeLine{00516\ }
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_vert\ =\ back.\mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{find\_uncommon\_vertex}}(common\_edge);}
\DoxyCodeLine{00518\ \ \ \ \ \ \ front.\mbox{\hyperlink{classEggMesherStrip_af00da3c164183d7ff2365d58b66e25a9}{rotate\_to\_back}}(common\_edge);}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \ \ front.\_verts.push\_back(new\_vert);}
\DoxyCodeLine{00521\ \ \ \ \ \ \ front.\_prims.splice(front.\_prims.end(),\ back.\_prims);}
\DoxyCodeLine{00522\ \ \ \ \ \ \ back.\_verts.clear();}
\DoxyCodeLine{00523\ \ \ \ \ \}}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((front.\_type\ ==\ PT\_quad\ ||\ front.\_type\ ==\ PT\_quadstrip)\ \&\&}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \ (back.\_type\ ==\ PT\_quad\ ||\ back.\_type\ ==\ PT\_quadstrip))\ \{}
\DoxyCodeLine{00527\ \ \ \ \ \textcolor{comment}{//\ Joining\ two\ quads,\ two\ quadstrips,\ or\ a\ quad\ and\ a\ quadstrip.\ \ This}}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{comment}{//\ makes\ another\ quadstrip.}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \textcolor{comment}{//\ We\ expect\ this\ to\ succeed\ every\ time\ with\ quadstrips.}}
\DoxyCodeLine{00531\ \ \ \ \ success\ =\ \mbox{\hyperlink{classEggMesherStrip_a5d83a0fa6044d9c8ea4f243b1696ed39}{mate\_strips}}(common\_edge,\ front,\ back,\ PT\_quadstrip);}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \textcolor{comment}{//\ Although\ it\ might\ fail\ in\ rare\ circumstances\ (specifically,\ if\ the}}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \textcolor{comment}{//\ two\ strips\ we\ attempted\ to\ join\ were\ backfacing\ to\ each\ other).\ \ If}}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \textcolor{comment}{//\ so,\ remove\ the\ adjoining\ edge\ so\ these\ two\ don't\ get\ tried\ again.}}
\DoxyCodeLine{00537\ \ \ \ \ \ \ common\_edge-\/>\mbox{\hyperlink{classEggMesherEdge_a297d18cbc1b3b0e9e6e3d528994b6d15}{remove}}(\&front);}
\DoxyCodeLine{00538\ \ \ \ \ \ \ common\_edge-\/>\mbox{\hyperlink{classEggMesherEdge_a297d18cbc1b3b0e9e6e3d528994b6d15}{remove}}(\&back);}
\DoxyCodeLine{00539\ \ \ \ \ \}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \textcolor{comment}{//\ Otherwise.\ \ This\ might\ be\ two\ tristrips,\ a\ quad\ and\ a\ tristrip,\ a}}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{comment}{//\ triangle\ and\ a\ quad,\ a\ triangle\ and\ a\ tristrip,\ a\ triangle\ and\ a}}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{comment}{//\ quadstrip,\ or\ a\ tristrip\ and\ a\ quadstrip.\ \ In\ any\ case,\ we'll\ end\ up}}
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{comment}{//\ with\ a\ tristrip.}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{comment}{//\ This\ might\ fail\ if\ the\ tristrips\ don't\ match\ polarity.}}
\DoxyCodeLine{00549\ \ \ \ \ success\ =\ \mbox{\hyperlink{classEggMesherStrip_a5d83a0fa6044d9c8ea4f243b1696ed39}{mate\_strips}}(common\_edge,\ front,\ back,\ PT\_tristrip);}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordflow}{if}\ (!success)\ \{}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ it\ does\ fail,\ we'll\ try\ reversing\ the\ connection.\ \ This\ makes}}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \textcolor{comment}{//\ sense\ if\ we\ are\ joining\ a\ tri\ or\ tristrip\ to\ a\ quad\ or\ quadstrip,}}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \textcolor{comment}{//\ which\ might\ fail\ in\ one\ direction\ but\ succeed\ in\ the\ other.}}
\DoxyCodeLine{00555\ \ \ \ \ \ \ success\ =\ \mbox{\hyperlink{classEggMesherStrip_a5d83a0fa6044d9c8ea4f243b1696ed39}{mate\_strips}}(common\_edge,\ back,\ front,\ PT\_tristrip);}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yay!\ \ Now\ return\ all\ the\ stuff\ to\ front.}}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ front.\_verts.splice(front.\_verts.end(),\ back.\_verts);}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ front.\_prims.splice(front.\_prims.end(),\ back.\_prims);}
\DoxyCodeLine{00561\ }
\DoxyCodeLine{00562\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ miserable\ failure.\ \ Never\ try\ to\ join\ these\ two\ again.}}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ common\_edge-\/>\mbox{\hyperlink{classEggMesherEdge_a297d18cbc1b3b0e9e6e3d528994b6d15}{remove}}(\&front);}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ common\_edge-\/>\mbox{\hyperlink{classEggMesherEdge_a297d18cbc1b3b0e9e6e3d528994b6d15}{remove}}(\&back);}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \}}
\DoxyCodeLine{00568\ \ \ \}}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \textcolor{keywordflow}{if}\ (success)\ \{}
\DoxyCodeLine{00571\ \ \ \ \ front.\mbox{\hyperlink{classEggMesherStrip_a6227f2d300cdacd98f3866af92e0503e}{combine\_edges}}(back,\ remove\_sides);}
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{keywordflow}{if}\ (!remove\_sides)\ \{}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ didn't\ want\ to\ remove\ the\ side\ edges,\ at\ least\ remove\ the\ join}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \textcolor{comment}{//\ edge,\ which\ is\ now\ internal.}}
\DoxyCodeLine{00575\ \ \ \ \ \ \ common\_edge-\/>\mbox{\hyperlink{classEggMesherEdge_a297d18cbc1b3b0e9e6e3d528994b6d15}{remove}}(\&front);}
\DoxyCodeLine{00576\ \ \ \ \ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \ \ nassertr(back.\_prims.empty(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00579\ \ \ \ \ nassertr(back.\_verts.empty(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{comment}{//\ Strip\ back\ is\ no\ more.}}
\DoxyCodeLine{00582\ \ \ \ \ back.\_status\ =\ MS\_dead;}
\DoxyCodeLine{00583\ }
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{comment}{//\ The\ result\ is\ planar\ if\ and\ only\ if\ we\ joined\ two\ coplanar\ pieces.}}
\DoxyCodeLine{00585\ \ \ \ \ front.\_planar\ =\ is\_coplanar;}
\DoxyCodeLine{00586\ \ \ \ \ front.\_origin\ =\ MO\_mate;}
\DoxyCodeLine{00587\ \ \ \}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00590\ \}}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00601\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a5d83a0fa6044d9c8ea4f243b1696ed39}{EggMesherStrip::}}}
\DoxyCodeLine{00602\ \mbox{\hyperlink{classEggMesherStrip_a5d83a0fa6044d9c8ea4f243b1696ed39}{mate\_strips}}(\mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *common\_edge,\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&front,}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&back,\ EggMesherStrip::PrimType\ type)\ \{}
\DoxyCodeLine{00604\ \ \ \textcolor{comment}{//\ We\ don't\ allow\ making\ odd-\/length\ strips\ at\ all.\ \ Odd-\/length\ strips\ can't}}
\DoxyCodeLine{00605\ \ \ \textcolor{comment}{//\ be\ rotated\ if\ they're\ flat-\/shaded,\ and\ they\ can't\ be\ joined\ end-\/to-\/end}}
\DoxyCodeLine{00606\ \ \ \textcolor{comment}{//\ using\ degenerate\ triangles.\ \ So\ forget\ 'em.}}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \textcolor{comment}{//\ This\ might\ not\ be\ the\ right\ place\ to\ impose\ this\ rule,\ because\ it\ tends}}
\DoxyCodeLine{00609\ \ \ \textcolor{comment}{//\ to\ end\ up\ with\ lots\ of\ independent\ triangles\ in\ certain\ kinds\ of\ meshes,}}
\DoxyCodeLine{00610\ \ \ \textcolor{comment}{//\ but\ it's\ the\ easiest\ place\ to\ impose\ it.}}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordflow}{if}\ ((front.\_type\ !=\ PT\_tri\ \&\&\ back.\_type\ ==\ PT\_tri)\ ||}
\DoxyCodeLine{00612\ \ \ \ \ \ \ (front.\_type\ ==\ PT\_tri\ \&\&\ back.\_type\ !=\ PT\_tri)\ ||}
\DoxyCodeLine{00613\ \ \ \ \ \ \ (front.\_type\ ==\ PT\_tristrip\ \&\&\ back.\_type\ ==\ PT\_tristrip\ \&\&}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ ((front.\_verts.size()\ +\ back.\_verts.size())\ \&\ 1)\ !=\ 0))\ \{}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00616\ \ \ \}}
\DoxyCodeLine{00617\ }
\DoxyCodeLine{00618\ \ \ \textcolor{comment}{//\ If\ we\ start\ with\ a\ quad\ or\ tri,\ rotate\ the\ vertices\ around\ so\ we\ start}}
\DoxyCodeLine{00619\ \ \ \textcolor{comment}{//\ with\ the\ common\ edge.}}
\DoxyCodeLine{00620\ \ \ \textcolor{keywordflow}{if}\ (front.\_type\ ==\ PT\_tri\ ||\ front.\_type\ ==\ PT\_quad)\ \{}
\DoxyCodeLine{00621\ \ \ \ \ front.\mbox{\hyperlink{classEggMesherStrip_af00da3c164183d7ff2365d58b66e25a9}{rotate\_to\_back}}(common\_edge);}
\DoxyCodeLine{00622\ \ \ \}}
\DoxyCodeLine{00623\ \ \ \textcolor{keywordflow}{if}\ (back.\_type\ ==\ PT\_tri\ ||\ back.\_type\ ==\ PT\_quad)\ \{}
\DoxyCodeLine{00624\ \ \ \ \ back.\mbox{\hyperlink{classEggMesherStrip_ac5fccb3398db88a6f2065ed7effb0b7c}{rotate\_to\_front}}(common\_edge);}
\DoxyCodeLine{00625\ \ \ \}}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \textcolor{keywordtype}{bool}\ reverse\_front\ =\ common\_edge-\/>matches(front.get\_head\_edge());}
\DoxyCodeLine{00628\ \ \ \textcolor{keywordtype}{bool}\ reverse\_back\ =\ !common\_edge-\/>matches(back.get\_head\_edge());}
\DoxyCodeLine{00629\ }
\DoxyCodeLine{00630\ \ \ \textcolor{keywordtype}{bool}\ invert\_front\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00631\ \ \ \textcolor{keywordtype}{bool}\ invert\_back\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00633\ \ \ \textcolor{keywordflow}{if}\ (reverse\_front\ \&\&\ front.\mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{is\_odd}}())\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ going\ to\ reverse\ the\ front\ strip,\ we\ have\ to\ be\ careful.\ \ This}}
\DoxyCodeLine{00635\ \ \ \ \ \textcolor{comment}{//\ will\ also\ reverse\ the\ facing\ direction\ if\ it\ has\ an\ odd\ number\ of}}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{comment}{//\ prims.}}
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{if}\ (!front.\mbox{\hyperlink{classEggMesherStrip_a8ea944d1c5504f8c15ad68e391e4d1a1}{can\_invert}}())\ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00639\ \ \ \ \ \}}
\DoxyCodeLine{00640\ \ \ \ \ invert\_front\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00641\ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classEggMesherStrip_a454f4f9a31623e76abcd6d64908b7908}{must\_invert}}(front,\ back,\ reverse\_back,\ type))\ \{}
\DoxyCodeLine{00644\ \ \ \ \ \textcolor{keywordflow}{if}\ (!back.\mbox{\hyperlink{classEggMesherStrip_a8ea944d1c5504f8c15ad68e391e4d1a1}{can\_invert}}())\ \{}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00646\ \ \ \ \ \}}
\DoxyCodeLine{00647\ \ \ \ \ invert\_back\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00648\ \ \ \ \ back.\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}}();}
\DoxyCodeLine{00649\ \ \ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \ \ \textcolor{keywordflow}{if}\ (invert\_front)\ \{}
\DoxyCodeLine{00652\ \ \ \ \ front.\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}}();}
\DoxyCodeLine{00653\ \ \ \}}
\DoxyCodeLine{00654\ }
\DoxyCodeLine{00655\ \ \ \textcolor{keywordflow}{if}\ (reverse\_front)\ \{}
\DoxyCodeLine{00656\ \ \ \ \ reverse(front.\_verts.begin(),\ front.\_verts.end());}
\DoxyCodeLine{00657\ \ \ \ \ reverse(front.\_prims.begin(),\ front.\_prims.end());}
\DoxyCodeLine{00658\ \ \ \}}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \ \ \textcolor{keywordflow}{if}\ (reverse\_back)\ \{}
\DoxyCodeLine{00661\ \ \ \ \ reverse(back.\_verts.begin(),\ back.\_verts.end());}
\DoxyCodeLine{00662\ \ \ \ \ reverse(back.\_prims.begin(),\ back.\_prims.end());}
\DoxyCodeLine{00663\ \ \ \}}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \textcolor{keywordtype}{bool}\ will\_reverse\ =\ front.\mbox{\hyperlink{classEggMesherStrip_ac7fd6ad9fe8fb24a83d18675e92cb035}{would\_reverse\_tail}}(type);}
\DoxyCodeLine{00666\ \ \ \textcolor{keywordtype}{bool}\ is\_headtotail\ =\ (front.get\_tail\_edge()\ ==\ back.get\_head\_edge());}
\DoxyCodeLine{00667\ \ \ \textcolor{keywordflow}{if}\ (will\_reverse\ ==\ is\_headtotail)\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{comment}{//\ Oops,\ we\ tried\ to\ join\ two\ backfacing\ strips.\ \ This\ really\ shouldn't}}
\DoxyCodeLine{00669\ \ \ \ \ \textcolor{comment}{//\ happen,\ but\ it\ occasionally\ does\ for\ some\ mysterious\ reason.\ \ Maybe\ one}}
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{comment}{//\ day\ I'll\ understand\ why.\ \ In\ the\ meantime,\ just\ recover\ and\ carry\ on.}}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse\_back)\ \{}
\DoxyCodeLine{00672\ \ \ \ \ \ \ reverse(back.\_verts.begin(),\ back.\_verts.end());}
\DoxyCodeLine{00673\ \ \ \ \ \ \ reverse(back.\_prims.begin(),\ back.\_prims.end());}
\DoxyCodeLine{00674\ \ \ \ \ \}}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{keywordflow}{if}\ (invert\_back)\ \{}
\DoxyCodeLine{00676\ \ \ \ \ \ \ back.\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}}();}
\DoxyCodeLine{00677\ \ \ \ \ \}}
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keywordflow}{if}\ (reverse\_front)\ \{}
\DoxyCodeLine{00679\ \ \ \ \ \ \ reverse(front.\_verts.begin(),\ front.\_verts.end());}
\DoxyCodeLine{00680\ \ \ \ \ \ \ reverse(front.\_prims.begin(),\ front.\_prims.end());}
\DoxyCodeLine{00681\ \ \ \ \ \}}
\DoxyCodeLine{00682\ \ \ \ \ \textcolor{keywordflow}{if}\ (invert\_front)\ \{}
\DoxyCodeLine{00683\ \ \ \ \ \ \ front.\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}}();}
\DoxyCodeLine{00684\ \ \ \ \ \}}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00686\ \ \ \}}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ front.\mbox{\hyperlink{classEggMesherStrip_affa33d62cbb644539d3fc00fdee34fd2}{convert\_to\_type}}(type);}
\DoxyCodeLine{00689\ \ \ back.\mbox{\hyperlink{classEggMesherStrip_affa33d62cbb644539d3fc00fdee34fd2}{convert\_to\_type}}(type);}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00692\ \textcolor{comment}{\ \ if\ (!\ (front.get\_tail\_edge()\ ==\ back.get\_head\_edge())\ )\ \{}}
\DoxyCodeLine{00693\ \textcolor{comment}{\ \ \ \ builder\_cat.error()}}
\DoxyCodeLine{00694\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\(\backslash\)nFailure,\ trying\ to\ connect\ "{}\ <<\ front}}
\DoxyCodeLine{00695\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\(\backslash\)nto\ "{}\ <<\ back}}
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\(\backslash\)nreverse\_front\ =\ "{}\ <<\ reverse\_front}}
\DoxyCodeLine{00697\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\ reverse\_back\ =\ "{}\ <<\ reverse\_back}}
\DoxyCodeLine{00698\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\ invert\_front\ =\ "{}\ <<\ invert\_front}}
\DoxyCodeLine{00699\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00700\ \textcolor{comment}{\ \ \ \ Edges::iterator\ ei;}}
\DoxyCodeLine{00701\ \textcolor{comment}{}}
\DoxyCodeLine{00702\ \textcolor{comment}{\ \ \ \ nout\ <<\ "{}\(\backslash\)nFront\ edges:\(\backslash\)n"{};}}
\DoxyCodeLine{00703\ \textcolor{comment}{\ \ \ \ for\ (ei\ =\ front.\_edges.begin();\ ei\ !=\ front.\_edges.end();\ ++ei)\ \{}}
\DoxyCodeLine{00704\ \textcolor{comment}{\ \ \ \ \ \ nout\ <<\ **ei\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00705\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00706\ \textcolor{comment}{}}
\DoxyCodeLine{00707\ \textcolor{comment}{\ \ \ \ nout\ <<\ "{}\(\backslash\)nBack\ edges:\(\backslash\)n"{};}}
\DoxyCodeLine{00708\ \textcolor{comment}{\ \ \ \ for\ (ei\ =\ back.\_edges.begin();\ ei\ !=\ back.\_edges.end();\ ++ei)\ \{}}
\DoxyCodeLine{00709\ \textcolor{comment}{\ \ \ \ \ \ nout\ <<\ **ei\ <<\ "{}\(\backslash\)n"{};}}
\DoxyCodeLine{00710\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00711\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00712\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \textcolor{comment}{//\ If\ this\ assertion\ fails,\ we\ were\ misinformed\ about\ our\ ability\ to\ join}}
\DoxyCodeLine{00715\ \ \ \textcolor{comment}{//\ these\ two\ strips.\ \ Either\ the\ must\_invert()\ call\ returned\ the\ incorrect}}
\DoxyCodeLine{00716\ \ \ \textcolor{comment}{//\ value,\ or\ our\ edge-\/detection\ logic\ failed\ and\ we\ attempted\ to\ join\ two}}
\DoxyCodeLine{00717\ \ \ \textcolor{comment}{//\ oppositely-\/facing\ strips.\ \ nassertr(front.get\_tail\_edge()\ ==}}
\DoxyCodeLine{00718\ \ \ \textcolor{comment}{//\ back.get\_head\_edge(),\ false);}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ front.\_verts.pop\_back();}
\DoxyCodeLine{00721\ \ \ front.\_verts.pop\_back();}
\DoxyCodeLine{00722\ \ \ front.\_verts.splice(front.\_verts.end(),\ back.\_verts);}
\DoxyCodeLine{00723\ \ \ front.\_prims.splice(front.\_prims.end(),\ back.\_prims);}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00726\ \}}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00732\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a454f4f9a31623e76abcd6d64908b7908}{EggMesherStrip::}}}
\DoxyCodeLine{00733\ \mbox{\hyperlink{classEggMesherStrip_a454f4f9a31623e76abcd6d64908b7908}{must\_invert}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&front,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&back,}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ will\_reverse\_back,\ EggMesherStrip::PrimType\ type)\ \{}
\DoxyCodeLine{00735\ \ \ \textcolor{keywordtype}{bool}\ invert\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \textcolor{keywordflow}{if}\ ((front.\_type\ ==\ PT\_quad\ ||\ front.\_type\ ==\ PT\_quadstrip)\ \&\&}
\DoxyCodeLine{00738\ \ \ \ \ \ \ type\ ==\ PT\_tristrip)\ \{}
\DoxyCodeLine{00739\ \ \ \ \ \textcolor{comment}{//\ If\ we'll\ be\ converting\ from\ quads\ to\ tris,\ the\ tail\ edge\ of\ the\ front}}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{comment}{//\ strip\ will\ always\ be\ even.}}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00742\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (front.\mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{is\_odd}}())\ \{}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ we\ have\ to\ flip\ if\ the\ tail\ edge\ is\ odd.}}
\DoxyCodeLine{00744\ \ \ \ \ invert\ =\ !\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}};}
\DoxyCodeLine{00745\ \ \ \}}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \textcolor{keywordflow}{if}\ (will\_reverse\_back)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ \textcolor{comment}{//\ With\ the\ back\ strip,\ we\ don't\ care\ about\ what\ will\ happen\ to\ its\ tail}}
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{comment}{//\ edge\ when\ we\ convert\ it,\ but\ we\ do\ care\ what\ happens\ to\ its\ front\ edge}}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{comment}{//\ if\ we\ reverse\ it.}}
\DoxyCodeLine{00751\ \ \ \ \ \textcolor{keywordflow}{if}\ (back.\mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{is\_odd}}())\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \textcolor{comment}{//\ Specifically,\ the\ front\ edge\ will\ be\ reversed\ when\ the\ strip\ is}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \textcolor{comment}{//\ reversed\ only\ if\ the\ strip\ is\ odd.}}
\DoxyCodeLine{00754\ \ \ \ \ \ \ invert\ =\ !\mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}};}
\DoxyCodeLine{00755\ \ \ \ \ \}}
\DoxyCodeLine{00756\ \ \ \}}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}};}
\DoxyCodeLine{00759\ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00765\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_acc343f8e5bb056b0af2bb194826a2cb0}{EggMesherStrip::}}}
\DoxyCodeLine{00766\ \mbox{\hyperlink{classEggMesherStrip_acc343f8e5bb056b0af2bb194826a2cb0}{convex\_quad}}(\mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *common\_edge,\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&front,}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&back,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\ \{}
\DoxyCodeLine{00768\ \ \ \textcolor{comment}{//\ Find\ the\ edge\ from\ the\ apex\ of\ one\ triangle\ to\ the\ apex\ of\ the\ other.}}
\DoxyCodeLine{00769\ \ \ \textcolor{comment}{//\ This\ is\ the\ "{}other"{}\ diagonal\ of\ the\ quad-\/to-\/be,\ other\ than\ the}}
\DoxyCodeLine{00770\ \ \ \textcolor{comment}{//\ common\_edge.}}
\DoxyCodeLine{00771\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ front.\mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{find\_uncommon\_vertex}}(common\_edge);}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ back.\mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{find\_uncommon\_vertex}}(common\_edge);}
\DoxyCodeLine{00773\ \ \ nassertr(vi\_a\ >=\ 0\ \&\&\ vi\_b\ >=\ 0,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00775\ \ \ LPoint3d\ a3,\ b3,\ c3,\ d3;}
\DoxyCodeLine{00776\ \ \ a3\ =\ vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(vi\_a)-\/>get\_pos3();}
\DoxyCodeLine{00777\ \ \ b3\ =\ vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(vi\_b)-\/>get\_pos3();}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ c3\ =\ vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(common\_edge-\/>\_vi\_a)-\/>get\_pos3();}
\DoxyCodeLine{00780\ \ \ d3\ =\ vertex\_pool-\/>\mbox{\hyperlink{classEggVertexPool_a96aa341200afac8be8cba0eb019595ee}{get\_vertex}}(common\_edge-\/>\_vi\_b)-\/>get\_pos3();}
\DoxyCodeLine{00781\ }
\DoxyCodeLine{00782\ \ \ \textcolor{comment}{//\ Project\ both\ edges\ into\ the\ 2-\/d\ axis\ plane\ most\ nearly\ perpendicular\ to}}
\DoxyCodeLine{00783\ \ \ \textcolor{comment}{//\ the\ normal.\ \ We're\ assuming\ both\ tris\ have\ the\ same\ normal.}}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ nassertr(front.\_planar,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \ \ LNormald\ n(front.\_plane\_normal);}
\DoxyCodeLine{00788\ \ \ \textcolor{keywordtype}{int}\ xi,\ yi;}
\DoxyCodeLine{00789\ }
\DoxyCodeLine{00790\ \ \ \textcolor{comment}{//\ Find\ the\ largest\ dimension\ of\ the\ normal.}}
\DoxyCodeLine{00791\ \ \ \textcolor{keywordflow}{if}\ (fabs(n[0])\ >\ fabs(n[1]))\ \{}
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(n[0])\ >\ fabs(n[2]))\ \{}
\DoxyCodeLine{00793\ \ \ \ \ \ \ xi\ =\ 1;}
\DoxyCodeLine{00794\ \ \ \ \ \ \ yi\ =\ 2;}
\DoxyCodeLine{00795\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00796\ \ \ \ \ \ \ xi\ =\ 0;}
\DoxyCodeLine{00797\ \ \ \ \ \ \ yi\ =\ 1;}
\DoxyCodeLine{00798\ \ \ \ \ \}}
\DoxyCodeLine{00799\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(n[1])\ >\ fabs(n[2]))\ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ xi\ =\ 0;}
\DoxyCodeLine{00802\ \ \ \ \ \ \ yi\ =\ 2;}
\DoxyCodeLine{00803\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00804\ \ \ \ \ \ \ xi\ =\ 0;}
\DoxyCodeLine{00805\ \ \ \ \ \ \ yi\ =\ 1;}
\DoxyCodeLine{00806\ \ \ \ \ \}}
\DoxyCodeLine{00807\ \ \ \}}
\DoxyCodeLine{00808\ }
\DoxyCodeLine{00809\ \ \ LVecBase2d\ a2,\ b2,\ c2,\ d2;}
\DoxyCodeLine{00810\ \ \ a2.set(a3[xi],\ a3[yi]);}
\DoxyCodeLine{00811\ \ \ b2.set(b3[xi],\ b3[yi]);}
\DoxyCodeLine{00812\ \ \ c2.set(c3[xi],\ c3[yi]);}
\DoxyCodeLine{00813\ \ \ d2.set(d3[xi],\ d3[yi]);}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00815\ \ \ \textcolor{comment}{//\ Now\ (c2-\/d2)\ is\ the\ common\ edge,\ and\ (a2-\/b2)\ is\ the\ new\ edge.\ \ The\ quad\ is}}
\DoxyCodeLine{00816\ \ \ \textcolor{comment}{//\ convex\ iff\ (c2-\/d2)\ intersects\ (a2-\/b2).\ \ We\ actually\ only\ need\ to\ test}}
\DoxyCodeLine{00817\ \ \ \textcolor{comment}{//\ whether\ (c2-\/d2)\ intersects\ the\ infinite\ line\ passing\ through\ (a2-\/b2).}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \textcolor{comment}{//\ The\ equation\ for\ the\ infinite\ line\ containing\ (a2-\/b2):\ Ax\ +\ By\ +\ C\ =\ 0}}
\DoxyCodeLine{00820\ \ \ \textcolor{keywordtype}{double}\ A\ =\ (b2[1]\ -\/\ a2[1]);}
\DoxyCodeLine{00821\ \ \ \textcolor{keywordtype}{double}\ B\ =\ (a2[0]\ -\/\ b2[0]);}
\DoxyCodeLine{00822\ \ \ \textcolor{keywordtype}{double}\ C\ =\ -\/(A*b2[0]\ +\ B*b2[1]);}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \textcolor{comment}{//\ The\ parametric\ equations\ for\ the\ line\ segment\ (c2-\/d2):\ x\ =\ c2[0]\ +}}
\DoxyCodeLine{00825\ \ \ \textcolor{comment}{//\ (d2[0]-\/c2[0])t\ y\ =\ c2[1]\ +\ (d2[1]-\/c2[1])t}}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00827\ \ \ \textcolor{comment}{//\ Solved\ for\ t:}}
\DoxyCodeLine{00828\ \ \ \textcolor{keywordtype}{double}\ t\ =\ -\/\ ((A*c2[0]\ +\ B*c2[1])\ +\ C)\ /\ (A*(d2[0]-\/c2[0])\ +\ B*(d2[1]-\/c2[1]));}
\DoxyCodeLine{00829\ }
\DoxyCodeLine{00830\ \ \ \textcolor{comment}{//\ Now\ the\ lines\ intersect\ if\ t\ is\ in\ [0,\ 1].}}
\DoxyCodeLine{00831\ \ \ \textcolor{keywordflow}{return}\ (0.0\ <=\ t\ \&\&\ t\ <=\ 1.0);}
\DoxyCodeLine{00832\ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00837\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classEggMesherStrip_a45e63634b8577858c414b3a970921384}{EggMesherStrip::}}}
\DoxyCodeLine{00838\ \mbox{\hyperlink{classEggMesherStrip_a45e63634b8577858c414b3a970921384}{count\_neighbors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00839\ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{00840\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00843\ \ \ \ \ count\ +=\ (*ei)-\/>\_strips.size();}
\DoxyCodeLine{00844\ \ \ \}}
\DoxyCodeLine{00845\ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{00846\ \}}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00851\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_a3bc20c3222a6031b353514323140d56f}{EggMesherStrip::}}}
\DoxyCodeLine{00852\ \mbox{\hyperlink{classEggMesherStrip_a3bc20c3222a6031b353514323140d56f}{output\_neighbors}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00853\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00854\ \ \ EggMesherEdge::Strips::const\_iterator\ si;}
\DoxyCodeLine{00855\ }
\DoxyCodeLine{00856\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00857\ \ \ \ \ \textcolor{keywordflow}{for}\ (si\ =\ (*ei)-\/>\_strips.begin();}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ si\ !=\ (*ei)-\/>\_strips.end();}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ ++si)\ \{}
\DoxyCodeLine{00860\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ (*si)-\/>\_index;}
\DoxyCodeLine{00861\ \ \ \ \ \}}
\DoxyCodeLine{00862\ \ \ \}}
\DoxyCodeLine{00863\ \}}
\DoxyCodeLine{00864\ }
\DoxyCodeLine{00868\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{EggMesherStrip::}}}
\DoxyCodeLine{00869\ \mbox{\hyperlink{classEggMesherStrip_aab1567130e9882e18c2bc7c68bc13624}{find\_uncommon\_vertex}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00870\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00871\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00874\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00875\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *e\ =\ (*ei);}
\DoxyCodeLine{00876\ }
\DoxyCodeLine{00877\ \ \ \ \ \textcolor{keywordflow}{if}\ (e-\/>\_vi\_a\ !=\ vi\_a\ \&\&\ e-\/>\_vi\_a\ !=\ vi\_b)\ \{}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e-\/>\_vi\_a;}
\DoxyCodeLine{00879\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (e-\/>\_vi\_b\ !=\ vi\_a\ \&\&\ e-\/>\_vi\_b\ !=\ vi\_b)\ \{}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e-\/>\_vi\_b;}
\DoxyCodeLine{00881\ \ \ \ \ \}}
\DoxyCodeLine{00882\ \ \ \}}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00885\ \}}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00891\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *\mbox{\hyperlink{classEggMesherStrip_a9fd80b6f42e42475c9c27bea141e3c48}{EggMesherStrip::}}}
\DoxyCodeLine{00892\ \mbox{\hyperlink{classEggMesherStrip_a9fd80b6f42e42475c9c27bea141e3c48}{find\_opposite\_edge}}(\textcolor{keywordtype}{int}\ vi)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00893\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00894\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00895\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *e\ =\ (*ei);}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{keywordflow}{if}\ (!e-\/>contains\_vertex(vi))\ \{}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e;}
\DoxyCodeLine{00898\ \ \ \ \ \}}
\DoxyCodeLine{00899\ \ \ \}}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00902\ \}}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00908\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *\mbox{\hyperlink{classEggMesherStrip_a9fd80b6f42e42475c9c27bea141e3c48}{EggMesherStrip::}}}
\DoxyCodeLine{00909\ \mbox{\hyperlink{classEggMesherStrip_a9fd80b6f42e42475c9c27bea141e3c48}{find\_opposite\_edge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00910\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00911\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00913\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00914\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00915\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *e\ =\ (*ei);}
\DoxyCodeLine{00916\ \ \ \ \ \textcolor{keywordflow}{if}\ (!e-\/>contains\_vertex(vi\_a)\ \&\&\ !e-\/>contains\_vertex(vi\_b))\ \{}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e;}
\DoxyCodeLine{00918\ \ \ \ \ \}}
\DoxyCodeLine{00919\ \ \ \}}
\DoxyCodeLine{00920\ }
\DoxyCodeLine{00921\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00922\ \}}
\DoxyCodeLine{00923\ }
\DoxyCodeLine{00928\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *\mbox{\hyperlink{classEggMesherStrip_af5edd4fcba8d2539482944fc90d02fb7}{EggMesherStrip::}}}
\DoxyCodeLine{00929\ \mbox{\hyperlink{classEggMesherStrip_af5edd4fcba8d2539482944fc90d02fb7}{find\_adjacent\_edge}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00930\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00931\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00932\ }
\DoxyCodeLine{00933\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{00934\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{00935\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *e\ =\ (*ei);}
\DoxyCodeLine{00936\ \ \ \ \ \textcolor{keywordflow}{if}\ (e-\/>contains\_vertex(vi\_a)\ !=\ e-\/>contains\_vertex(vi\_b))\ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ e;}
\DoxyCodeLine{00938\ \ \ \ \ \}}
\DoxyCodeLine{00939\ \ \ \}}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00942\ \}}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00948\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_ac5fccb3398db88a6f2065ed7effb0b7c}{EggMesherStrip::}}}
\DoxyCodeLine{00949\ \mbox{\hyperlink{classEggMesherStrip_ac5fccb3398db88a6f2065ed7effb0b7c}{rotate\_to\_front}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge)\ \{}
\DoxyCodeLine{00950\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00951\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00952\ }
\DoxyCodeLine{00953\ \ \ \textcolor{comment}{//\ See\ if\ we're\ already\ there.}}
\DoxyCodeLine{00954\ \ \ \textcolor{keywordflow}{if}\ (\_verts.front()\ ==\ vi\_a\ ||\ \_verts.front()\ ==\ vi\_b)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ Verts::iterator\ vi\ =\ \_verts.begin();}
\DoxyCodeLine{00956\ \ \ \ \ ++vi;}
\DoxyCodeLine{00957\ \ \ \ \ \textcolor{keywordflow}{if}\ (*vi\ ==\ vi\_a\ ||\ *vi\ ==\ vi\_b)\ \{}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \textcolor{comment}{//\ Yes!}}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00960\ \ \ \ \ \}}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00962\ \ \ \ \ \textcolor{comment}{//\ No,\ we\ must\ be\ right\ on\ the\ line.\ \ Roll\ back\ one.}}
\DoxyCodeLine{00963\ \ \ \ \ rotate\_back();}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00966\ \ \ \ \ \textcolor{comment}{//\ Roll\ forward\ until\ it\ comes\ into\ view.}}
\DoxyCodeLine{00967\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_verts\ =\ \_verts.size();}
\DoxyCodeLine{00968\ \ \ \ \ \textcolor{keywordflow}{while}\ (\_verts.front()\ !=\ vi\_a\ \&\&\ \_verts.front()\ !=\ vi\_b)\ \{}
\DoxyCodeLine{00969\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ either\ vertex\ exists.}}
\DoxyCodeLine{00970\ \ \ \ \ \ \ num\_verts-\/-\/;}
\DoxyCodeLine{00971\ \ \ \ \ \ \ nassertv(num\_verts\ >\ 0);}
\DoxyCodeLine{00972\ \ \ \ \ \ \ rotate\_forward();}
\DoxyCodeLine{00973\ \ \ \ \ \}}
\DoxyCodeLine{00974\ \ \ \}}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{00977\ \ \ \textcolor{comment}{//\ Now\ make\ sure\ the\ edge\ actually\ exists.}}
\DoxyCodeLine{00978\ \ \ Verts::iterator\ vi\ =\ \_verts.begin();}
\DoxyCodeLine{00979\ \ \ ++vi;}
\DoxyCodeLine{00980\ \ \ nassertv(*vi\ ==\ vi\_a\ ||\ *vi\ ==\ vi\_b);}
\DoxyCodeLine{00981\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00982\ \}}
\DoxyCodeLine{00983\ }
\DoxyCodeLine{00988\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_af00da3c164183d7ff2365d58b66e25a9}{EggMesherStrip::}}}
\DoxyCodeLine{00989\ \mbox{\hyperlink{classEggMesherStrip_af00da3c164183d7ff2365d58b66e25a9}{rotate\_to\_back}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ *edge)\ \{}
\DoxyCodeLine{00990\ \ \ \textcolor{keywordtype}{int}\ vi\_a\ =\ edge-\/>\_vi\_a;}
\DoxyCodeLine{00991\ \ \ \textcolor{keywordtype}{int}\ vi\_b\ =\ edge-\/>\_vi\_b;}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00993\ \ \ \textcolor{comment}{//\ See\ if\ we're\ already\ there.}}
\DoxyCodeLine{00994\ \ \ \textcolor{keywordflow}{if}\ (\_verts.back()\ ==\ vi\_a\ ||\ \_verts.back()\ ==\ vi\_b)\ \{}
\DoxyCodeLine{00995\ \ \ \ \ Verts::reverse\_iterator\ vi\ =\ \_verts.rbegin();}
\DoxyCodeLine{00996\ \ \ \ \ ++vi;}
\DoxyCodeLine{00997\ \ \ \ \ \textcolor{keywordflow}{if}\ (*vi\ ==\ vi\_a\ ||\ *vi\ ==\ vi\_b)\ \{}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \textcolor{comment}{//\ Yes!}}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01000\ \ \ \ \ \}}
\DoxyCodeLine{01001\ }
\DoxyCodeLine{01002\ \ \ \ \ \textcolor{comment}{//\ No,\ we\ must\ be\ right\ on\ the\ line.\ \ Roll\ forward\ one.}}
\DoxyCodeLine{01003\ \ \ \ \ rotate\_forward();}
\DoxyCodeLine{01004\ }
\DoxyCodeLine{01005\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01006\ \ \ \ \ \textcolor{comment}{//\ Roll\ backward\ until\ it\ comes\ into\ view.}}
\DoxyCodeLine{01007\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_verts\ =\ \_verts.size();}
\DoxyCodeLine{01008\ \ \ \ \ \textcolor{keywordflow}{while}\ (\_verts.back()\ !=\ vi\_a\ \&\&\ \_verts.back()\ !=\ vi\_b)\ \{}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ either\ vertex\ exists.}}
\DoxyCodeLine{01010\ \ \ \ \ \ \ num\_verts-\/-\/;}
\DoxyCodeLine{01011\ \ \ \ \ \ \ nassertv(num\_verts\ >\ 0);}
\DoxyCodeLine{01012\ \ \ \ \ \ \ rotate\_back();}
\DoxyCodeLine{01013\ \ \ \ \ \}}
\DoxyCodeLine{01014\ \ \ \}}
\DoxyCodeLine{01015\ }
\DoxyCodeLine{01016\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{01017\ \ \ \textcolor{comment}{//\ Now\ make\ sure\ the\ edge\ actually\ exists.}}
\DoxyCodeLine{01018\ \ \ Verts::reverse\_iterator\ vi\ =\ \_verts.rbegin();}
\DoxyCodeLine{01019\ \ \ ++vi;}
\DoxyCodeLine{01020\ \ \ nassertv(*vi\ ==\ vi\_a\ ||\ *vi\ ==\ vi\_b);}
\DoxyCodeLine{01021\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01022\ \}}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ }
\DoxyCodeLine{01029\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a8ea944d1c5504f8c15ad68e391e4d1a1}{EggMesherStrip::}}}
\DoxyCodeLine{01030\ \mbox{\hyperlink{classEggMesherStrip_a8ea944d1c5504f8c15ad68e391e4d1a1}{can\_invert}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01031\ \ \ \textcolor{keywordflow}{return}\ (\_type\ ==\ PT\_quadstrip\ ||\ \_type\ ==\ PT\_quad);}
\DoxyCodeLine{01032\ \}}
\DoxyCodeLine{01033\ }
\DoxyCodeLine{01038\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{EggMesherStrip::}}}
\DoxyCodeLine{01039\ \mbox{\hyperlink{classEggMesherStrip_a09ae14632399309c8725f42727622df1}{invert}}()\ \{}
\DoxyCodeLine{01040\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classEggMesherStrip_a8ea944d1c5504f8c15ad68e391e4d1a1}{can\_invert}}())\ \{}
\DoxyCodeLine{01041\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01042\ \ \ \}}
\DoxyCodeLine{01043\ \ \ Verts::iterator\ vi,\ vi2;}
\DoxyCodeLine{01044\ \ \ vi\ =\ \_verts.begin();}
\DoxyCodeLine{01045\ \ \ \textcolor{keywordflow}{while}\ (vi\ !=\ \_verts.end())\ \{}
\DoxyCodeLine{01046\ \ \ \ \ vi2\ =\ vi;}
\DoxyCodeLine{01047\ \ \ \ \ ++vi2;}
\DoxyCodeLine{01048\ \ \ \ \ nassertr(vi2\ !=\ \_verts.end(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{01049\ }
\DoxyCodeLine{01050\ \ \ \ \ \textcolor{comment}{//\ Exchange\ vi\ and\ vi2}}
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ *vi2;}
\DoxyCodeLine{01052\ \ \ \ \ *vi2\ =\ *vi;}
\DoxyCodeLine{01053\ \ \ \ \ *vi\ =\ t;}
\DoxyCodeLine{01054\ }
\DoxyCodeLine{01055\ \ \ \ \ \textcolor{comment}{//\ Increment}}
\DoxyCodeLine{01056\ \ \ \ \ vi\ =\ vi2;}
\DoxyCodeLine{01057\ \ \ \ \ ++vi;}
\DoxyCodeLine{01058\ \ \ \}}
\DoxyCodeLine{01059\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01060\ \}}
\DoxyCodeLine{01061\ }
\DoxyCodeLine{01065\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{EggMesherStrip::}}}
\DoxyCodeLine{01066\ \mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{is\_odd}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01067\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ PT\_quadstrip\ ||\ \_type\ ==\ PT\_quad)\ \{}
\DoxyCodeLine{01068\ \ \ \ \ \textcolor{comment}{//\ If\ a\ quadstrip\ has\ a\ multiple\ of\ four\ vertices,\ it\ has\ an\ odd\ number\ of}}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{comment}{//\ quads.}}
\DoxyCodeLine{01070\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_verts.size()\ \%\ 4\ ==\ 0);}
\DoxyCodeLine{01071\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01072\ \ \ \ \ \textcolor{comment}{//\ If\ a\ tristrip\ has\ an\ odd\ number\ of\ vertices,\ it\ has\ an\ odd\ number\ of}}
\DoxyCodeLine{01073\ \ \ \ \ \textcolor{comment}{//\ tris.}}
\DoxyCodeLine{01074\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_verts.size()\ \%\ 2\ ==\ 1);}
\DoxyCodeLine{01075\ \ \ \}}
\DoxyCodeLine{01076\ \}}
\DoxyCodeLine{01077\ }
\DoxyCodeLine{01082\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_ac7fd6ad9fe8fb24a83d18675e92cb035}{EggMesherStrip::}}}
\DoxyCodeLine{01083\ \mbox{\hyperlink{classEggMesherStrip_ac7fd6ad9fe8fb24a83d18675e92cb035}{would\_reverse\_tail}}(EggMesherStrip::PrimType\ want\_type)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01084\ \ \ \textcolor{keywordtype}{bool}\ reverse\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ want\_type)\ \{}
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01088\ \ \ \}}
\DoxyCodeLine{01089\ \ \ \textcolor{keywordflow}{if}\ (want\_type\ ==\ PT\_tristrip)\ \{}
\DoxyCodeLine{01090\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{01091\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tri:}
\DoxyCodeLine{01092\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01094\ }
\DoxyCodeLine{01095\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{01096\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \textcolor{comment}{//\ When\ we\ convert\ a\ quadstrip\ to\ a\ tristrip,\ we\ reverse\ the\ tail\ edge}}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \textcolor{comment}{//\ if\ we\ have\ a\ multiple\ of\ four\ verts.}}
\DoxyCodeLine{01099\ \ \ \ \ \ \ reverse\ =\ (\_verts.size()\ \%\ 4\ ==\ 0);}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01103\ \ \ \ \ \ \ egg\_cat.fatal()\ <<\ \textcolor{stringliteral}{"{}Invalid\ conversion!\(\backslash\)n"{}};}
\DoxyCodeLine{01104\ \ \ \ \ \ \ abort();}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01106\ \ \ \ \ \}}
\DoxyCodeLine{01107\ }
\DoxyCodeLine{01108\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (want\_type\ ==\ PT\_quadstrip)\ \{}
\DoxyCodeLine{01109\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{01111\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01114\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tri:}
\DoxyCodeLine{01115\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ convert\ tristrips\ to\ quadstrips;\ fall\ through.}}
\DoxyCodeLine{01117\ }
\DoxyCodeLine{01118\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01119\ \ \ \ \ \ \ egg\_cat.fatal()\ <<\ \textcolor{stringliteral}{"{}Invalid\ conversion!\(\backslash\)n"{}};}
\DoxyCodeLine{01120\ \ \ \ \ \ \ abort();}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01122\ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \}}
\DoxyCodeLine{01124\ }
\DoxyCodeLine{01125\ \ \ \textcolor{keywordflow}{return}\ reverse;}
\DoxyCodeLine{01126\ \}}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01128\ }
\DoxyCodeLine{01133\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_affa33d62cbb644539d3fc00fdee34fd2}{EggMesherStrip::}}}
\DoxyCodeLine{01134\ \mbox{\hyperlink{classEggMesherStrip_affa33d62cbb644539d3fc00fdee34fd2}{convert\_to\_type}}(EggMesherStrip::PrimType\ want\_type)\ \{}
\DoxyCodeLine{01135\ \ \ Verts::iterator\ vi,\ vi2;}
\DoxyCodeLine{01136\ \ \ \textcolor{keywordtype}{int}\ even;}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01138\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ want\_type)\ \{}
\DoxyCodeLine{01139\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01140\ \ \ \}}
\DoxyCodeLine{01141\ \ \ \textcolor{keywordflow}{if}\ (want\_type\ ==\ PT\_tristrip)\ \{}
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tri:}
\DoxyCodeLine{01144\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01146\ }
\DoxyCodeLine{01147\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{01148\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \textcolor{comment}{//\ To\ convert\ from\ quadquadstrip\ to\ tristrip,\ we\ reverse\ every\ other}}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \textcolor{comment}{//\ pair\ of\ vertices.}}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \ \ \ \ vi\ =\ \_verts.begin();}
\DoxyCodeLine{01153\ \ \ \ \ \ \ even\ =\ 0;}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (vi\ !=\ \_verts.end())\ \{}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ vi2\ =\ vi;}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ ++vi2;}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ nassertv(vi2\ !=\ \_verts.end());}
\DoxyCodeLine{01158\ }
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ vi\ and\ vi2\ are\ a\ pair.\ \ Should\ we\ reverse\ them?}}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (even)\ \{}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ *vi2;}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \ \ *vi2\ =\ *vi;}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \ \ *vi\ =\ t;}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01165\ }
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Increment}}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ vi\ =\ vi2;}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ ++vi;}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ even\ =\ !even;}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01171\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01174\ \ \ \ \ \ \ egg\_cat.fatal()\ <<\ \textcolor{stringliteral}{"{}Invalid\ conversion!\(\backslash\)n"{}};}
\DoxyCodeLine{01175\ \ \ \ \ \ \ abort();}
\DoxyCodeLine{01176\ \ \ \ \ \}}
\DoxyCodeLine{01177\ }
\DoxyCodeLine{01178\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (want\_type\ ==\ PT\_quadstrip)\ \{}
\DoxyCodeLine{01179\ \ \ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{01180\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{01181\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01183\ }
\DoxyCodeLine{01184\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tri:}
\DoxyCodeLine{01185\ \ \ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ don't\ convert\ tristrips\ to\ quadstrips;\ fall\ through.}}
\DoxyCodeLine{01187\ }
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01189\ \ \ \ \ \ \ egg\_cat.fatal()\ <<\ \textcolor{stringliteral}{"{}Invalid\ conversion!\(\backslash\)n"{}};}
\DoxyCodeLine{01190\ \ \ \ \ \ \ abort();}
\DoxyCodeLine{01191\ \ \ \ \ \}}
\DoxyCodeLine{01192\ \ \ \}}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \ \ \_type\ =\ want\_type;}
\DoxyCodeLine{01195\ \}}
\DoxyCodeLine{01196\ }
\DoxyCodeLine{01202\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_a6227f2d300cdacd98f3866af92e0503e}{EggMesherStrip::}}}
\DoxyCodeLine{01203\ \mbox{\hyperlink{classEggMesherStrip_a6227f2d300cdacd98f3866af92e0503e}{combine\_edges}}(\mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&other,\ \textcolor{keywordtype}{int}\ remove\_sides)\ \{}
\DoxyCodeLine{01204\ \ \ Edges::iterator\ ei;}
\DoxyCodeLine{01205\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ other.\_edges.begin();\ ei\ !=\ other.\_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{01206\ \ \ \ \ (*ei)-\/>change\_strip(\&other,\ \textcolor{keyword}{this});}
\DoxyCodeLine{01207\ \ \ \}}
\DoxyCodeLine{01208\ }
\DoxyCodeLine{01209\ \ \ \_edges.splice(\_edges.end(),\ other.\_edges);}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ \textcolor{keywordflow}{if}\ (remove\_sides)\ \{}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{comment}{//\ Identify\ the\ head\ and\ tail\ edges\ so\ we\ can\ remove\ everything\ else.}}
\DoxyCodeLine{01213\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ head\ =\ get\_head\_edge();}
\DoxyCodeLine{01214\ \ \ \ \ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ tail\ =\ get\_tail\_edge();}
\DoxyCodeLine{01215\ }
\DoxyCodeLine{01216\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classEggMesherStrip_a922866992bdc3293b96187c1f8cee614}{is\_odd}}())\ \{}
\DoxyCodeLine{01217\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ strip\ is\ odd,\ its\ true\ tail\ edge\ is\ the\ inverse\ of\ its\ actual}}
\DoxyCodeLine{01218\ \ \ \ \ \ \ \textcolor{comment}{//\ edge.}}
\DoxyCodeLine{01219\ \ \ \ \ \ \ tail\ =\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}(tail.\_vi\_b,\ tail.\_vi\_a);}
\DoxyCodeLine{01220\ \ \ \ \ \}}
\DoxyCodeLine{01221\ }
\DoxyCodeLine{01222\ \ \ \ \ \mbox{\hyperlink{classplist}{Edges}}\ junk\_edges;}
\DoxyCodeLine{01223\ }
\DoxyCodeLine{01224\ \ \ \ \ Edges::iterator\ next\_ei;}
\DoxyCodeLine{01225\ \ \ \ \ ei\ =\ \_edges.begin();}
\DoxyCodeLine{01226\ \ \ \ \ \textcolor{keywordflow}{while}\ (ei\ !=\ \_edges.end())\ \{}
\DoxyCodeLine{01227\ \ \ \ \ \ \ next\_ei\ =\ ei;}
\DoxyCodeLine{01228\ \ \ \ \ \ \ ++next\_ei;}
\DoxyCodeLine{01229\ }
\DoxyCodeLine{01230\ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ this\ edge\ to\ be\ saved\ or\ is\ it\ fodder?}}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!(**ei\ ==\ head)\ \&\&\ !(**ei\ ==\ tail))\ \{}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Fodder!\ \ But\ we\ can't\ remove\ it\ right\ away,\ because\ this\ will\ upset}}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ current\ list;\ instead,\ we'll\ splice\ it\ to\ junk\_edges.}}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ junk\_edges.splice(junk\_edges.end(),\ \_edges,\ ei);}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01236\ \ \ \ \ \ \ ei\ =\ next\_ei;}
\DoxyCodeLine{01237\ \ \ \ \ \}}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{comment}{//\ Now\ we\ can\ safely\ remove\ all\ the\ to-\/be-\/junked\ edges.}}
\DoxyCodeLine{01240\ \ \ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ junk\_edges.begin();\ ei\ !=\ junk\_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{01241\ \ \ \ \ \ \ (*ei)-\/>remove(\textcolor{keyword}{this});}
\DoxyCodeLine{01242\ \ \ \ \ \}}
\DoxyCodeLine{01243\ \ \ \}}
\DoxyCodeLine{01244\ \}}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ }
\DoxyCodeLine{01251\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_ac9673c1f507ed5663655da7b009dd69c}{EggMesherStrip::}}}
\DoxyCodeLine{01252\ \mbox{\hyperlink{classEggMesherStrip_ac9673c1f507ed5663655da7b009dd69c}{remove\_all\_edges}}()\ \{}
\DoxyCodeLine{01253\ \ \ \textcolor{comment}{//\ First,\ move\ all\ the\ edges\ to\ a\ safe\ place\ so\ we\ can\ traverse\ the\ list}}
\DoxyCodeLine{01254\ \ \ \textcolor{comment}{//\ without\ it\ changing\ on\ us.}}
\DoxyCodeLine{01255\ \ \ \mbox{\hyperlink{classplist}{Edges}}\ junk\_edges;}
\DoxyCodeLine{01256\ \ \ junk\_edges.splice(junk\_edges.end(),\ \_edges);}
\DoxyCodeLine{01257\ }
\DoxyCodeLine{01258\ \ \ \textcolor{comment}{//\ Now\ we\ can\ safely\ remove\ all\ the\ to-\/be-\/junked\ edges.}}
\DoxyCodeLine{01259\ \ \ Edges::iterator\ ei;}
\DoxyCodeLine{01260\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ junk\_edges.begin();\ ei\ !=\ junk\_edges.end();\ ++ei)\ \{}
\DoxyCodeLine{01261\ \ \ \ \ (*ei)-\/>remove(\textcolor{keyword}{this});}
\DoxyCodeLine{01262\ \ \ \}}
\DoxyCodeLine{01263\ \}}
\DoxyCodeLine{01264\ }
\DoxyCodeLine{01270\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a77083a7d9c7cd67323039ffc0617c312}{EggMesherStrip::}}}
\DoxyCodeLine{01271\ \mbox{\hyperlink{classEggMesherStrip_a77083a7d9c7cd67323039ffc0617c312}{pick\_mate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&a\_strip,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&b\_strip,}
\DoxyCodeLine{01272\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ \&a\_edge,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherEdge}{EggMesherEdge}}\ \&b\_edge,}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggVertexPool}{EggVertexPool}}\ *vertex\_pool)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01274\ \ \ \textcolor{comment}{//\ First,\ try\ to\ avoid\ polluting\ quads,\ quadstrips,\ and\ tristrips\ with}}
\DoxyCodeLine{01275\ \ \ \textcolor{comment}{//\ arbitrary\ triangles.\ \ When\ we\ mate\ a\ tri\ or\ tristrip\ to\ a\ quadstrip,\ we}}
\DoxyCodeLine{01276\ \ \ \textcolor{comment}{//\ end\ up\ with\ a\ tristrip\ that\ may\ be\ less\ versatile\ than\ the\ original}}
\DoxyCodeLine{01277\ \ \ \textcolor{comment}{//\ quadstrip.\ \ Better\ to\ avoid\ this\ if\ we\ can.\ \ Try\ to\ choose\ a\ mate\ that}}
\DoxyCodeLine{01278\ \ \ \textcolor{comment}{//\ more\ closely\ matches\ our\ own\ type.}}
\DoxyCodeLine{01279\ \ \ \textcolor{keywordtype}{int}\ a\_cat\ =\ a\_strip.type\_category();}
\DoxyCodeLine{01280\ \ \ \textcolor{keywordtype}{int}\ b\_cat\ =\ b\_strip.type\_category();}
\DoxyCodeLine{01281\ \ \ \textcolor{keywordflow}{if}\ (a\_cat\ !=\ b\_cat)\ \{}
\DoxyCodeLine{01282\ \ \ \ \ \textcolor{keywordtype}{int}\ me\_cat\ =\ type\_category();}
\DoxyCodeLine{01283\ \ \ \ \ \textcolor{keywordflow}{return}\ abs(a\_cat\ -\/\ me\_cat)\ <\ abs(b\_cat\ -\/\ me\_cat);}
\DoxyCodeLine{01284\ \ \ \}}
\DoxyCodeLine{01285\ }
\DoxyCodeLine{01286\ \ \ \textcolor{comment}{//\ Now,\ if\ we're\ connecting\ two\ tris,\ try\ to\ connect\ them\ up\ so\ they\ make}}
\DoxyCodeLine{01287\ \ \ \textcolor{comment}{//\ good\ quads.}}
\DoxyCodeLine{01288\ \ \ \textcolor{keywordflow}{if}\ (\_type\ ==\ PT\_tri\ \&\&\ a\_strip.\_type\ ==\ PT\_tri\ \&\&}
\DoxyCodeLine{01289\ \ \ \ \ \ \ b\_strip.\_type\ ==\ PT\_tri)\ \{}
\DoxyCodeLine{01290\ }
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{comment}{//\ This\ will\ depend\ on\ both\ coplanarity\ and\ edge\ length.\ \ We\ can't\ use}}
\DoxyCodeLine{01292\ \ \ \ \ \textcolor{comment}{//\ just\ one\ or\ the\ other,\ because\ some\ tris\ are\ nearly\ isosceles,\ and\ some}}
\DoxyCodeLine{01293\ \ \ \ \ \textcolor{comment}{//\ have\ more\ than\ one\ coplanar\ neighbor.\ \ Hopefully\ the\ combination\ of}}
\DoxyCodeLine{01294\ \ \ \ \ \textcolor{comment}{//\ both\ factors\ will\ zero\ us\ in\ on\ the\ correct\ neighbor\ first.}}
\DoxyCodeLine{01295\ }
\DoxyCodeLine{01296\ \ \ \ \ \textcolor{keywordtype}{double}\ a\_coplanar\ =\ coplanarity(a\_strip);}
\DoxyCodeLine{01297\ \ \ \ \ \textcolor{keywordtype}{double}\ b\_coplanar\ =\ coplanarity(b\_strip);}
\DoxyCodeLine{01298\ \ \ \ \ \textcolor{keywordtype}{double}\ coplanar\_diff\ =\ a\_coplanar\ -\/\ b\_coplanar;}
\DoxyCodeLine{01299\ }
\DoxyCodeLine{01300\ \ \ \ \ \textcolor{keywordtype}{double}\ a\_length\ =\ a\_edge.compute\_length(vertex\_pool);}
\DoxyCodeLine{01301\ \ \ \ \ \textcolor{keywordtype}{double}\ b\_length\ =\ b\_edge.compute\_length(vertex\_pool);}
\DoxyCodeLine{01302\ \ \ \ \ \textcolor{keywordtype}{double}\ length\_diff\ =\ (a\_length\ -\/\ b\_length)\ /\ (a\_length\ +\ b\_length);}
\DoxyCodeLine{01303\ }
\DoxyCodeLine{01304\ \ \ \ \ \textcolor{comment}{//\ These\ weights\ were\ chosen\ empirically\ to\ yield\ fairly\ good\ results.}}
\DoxyCodeLine{01305\ \ \ \ \ \textcolor{keywordtype}{double}\ sum\ =\ 4.0\ *\ coplanar\_diff\ -\/\ 1.0\ *\ length\_diff;}
\DoxyCodeLine{01306\ \ \ \ \ \textcolor{keywordflow}{return}\ sum\ <\ 0;}
\DoxyCodeLine{01307\ \ \ \}}
\DoxyCodeLine{01308\ }
\DoxyCodeLine{01309\ \ \ \textcolor{comment}{//\ Then,\ get\ the\ smallest\ strip.}}
\DoxyCodeLine{01310\ \ \ \textcolor{keywordflow}{if}\ (a\_strip.\_prims.size()\ !=\ b\_strip.\_prims.size())\ \{}
\DoxyCodeLine{01311\ \ \ \ \ \textcolor{keywordflow}{return}\ a\_strip.\_prims.size()\ <\ b\_strip.\_prims.size();}
\DoxyCodeLine{01312\ \ \ \}}
\DoxyCodeLine{01313\ }
\DoxyCodeLine{01314\ \ \ \textcolor{comment}{//\ Finally,\ get\ the\ strip\ with\ the\ fewest\ neighbors.}}
\DoxyCodeLine{01315\ \ \ \textcolor{keywordflow}{return}\ a\_strip.\mbox{\hyperlink{classEggMesherStrip_a45e63634b8577858c414b3a970921384}{count\_neighbors}}()\ <\ b\_strip.\mbox{\hyperlink{classEggMesherStrip_a45e63634b8577858c414b3a970921384}{count\_neighbors}}();}
\DoxyCodeLine{01316\ \}}
\DoxyCodeLine{01317\ }
\DoxyCodeLine{01324\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggMesherStrip_a7b847ced86b69527a8a3a77345498226}{EggMesherStrip::}}}
\DoxyCodeLine{01325\ \mbox{\hyperlink{classEggMesherStrip_a7b847ced86b69527a8a3a77345498226}{pick\_sheet\_mate}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&a\_strip,}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classEggMesherStrip}{EggMesherStrip}}\ \&b\_strip)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01327\ \ \ \textcolor{comment}{//\ First,\ try\ to\ get\ the\ poly\ which\ is\ closest\ to\ our\ own\ normal.}}
\DoxyCodeLine{01328\ \ \ \textcolor{keywordflow}{if}\ (\_planar\ \&\&\ a\_strip.\_planar\ \&\&\ b\_strip.\_planar)\ \{}
\DoxyCodeLine{01329\ \ \ \ \ \textcolor{keywordtype}{double}\ a\_diff\ =\ dot(LNormald(\_plane\_normal),\ LNormald(a\_strip.\_plane\_normal));}
\DoxyCodeLine{01330\ \ \ \ \ \textcolor{keywordtype}{double}\ b\_diff\ =\ dot(LNormald(\_plane\_normal),\ LNormald(b\_strip.\_plane\_normal));}
\DoxyCodeLine{01331\ }
\DoxyCodeLine{01332\ \ \ \ \ \textcolor{keywordflow}{if}\ (fabs(a\_diff\ -\/\ b\_diff)\ >\ 0.0001)\ \{}
\DoxyCodeLine{01333\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ a\_diff\ >\ b\_diff;}
\DoxyCodeLine{01334\ \ \ \ \ \}}
\DoxyCodeLine{01335\ \ \ \}}
\DoxyCodeLine{01336\ }
\DoxyCodeLine{01337\ \ \ \textcolor{comment}{//\ Then,\ pick\ the\ one\ that's\ most\ like\ our\ own\ type.}}
\DoxyCodeLine{01338\ \ \ \textcolor{keywordtype}{int}\ a\_cat\ =\ a\_strip.type\_category();}
\DoxyCodeLine{01339\ \ \ \textcolor{keywordtype}{int}\ b\_cat\ =\ b\_strip.type\_category();}
\DoxyCodeLine{01340\ \ \ \textcolor{keywordflow}{if}\ (a\_cat\ !=\ b\_cat)\ \{}
\DoxyCodeLine{01341\ \ \ \ \ \textcolor{keywordtype}{int}\ me\_cat\ =\ type\_category();}
\DoxyCodeLine{01342\ \ \ \ \ \textcolor{keywordflow}{return}\ abs(a\_cat\ -\/\ me\_cat)\ <\ abs(b\_cat\ -\/\ me\_cat);}
\DoxyCodeLine{01343\ \ \ \}}
\DoxyCodeLine{01344\ }
\DoxyCodeLine{01345\ \ \ \textcolor{comment}{//\ Oh,\ just\ pick\ any\ old\ one.}}
\DoxyCodeLine{01346\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01347\ \}}
\DoxyCodeLine{01348\ }
\DoxyCodeLine{01352\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggMesherStrip_ab2bef54f185dd353e2f0d6f94908f081}{EggMesherStrip::}}}
\DoxyCodeLine{01353\ \mbox{\hyperlink{classEggMesherStrip_ab2bef54f185dd353e2f0d6f94908f081}{output}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01354\ \ \ \textcolor{keywordflow}{switch}\ (\_status)\ \{}
\DoxyCodeLine{01355\ \ \ \textcolor{keywordflow}{case}\ MS\_alive:}
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01357\ }
\DoxyCodeLine{01358\ \ \ \textcolor{keywordflow}{case}\ MS\_dead:}
\DoxyCodeLine{01359\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Dead\ "{}};}
\DoxyCodeLine{01360\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01361\ }
\DoxyCodeLine{01362\ \ \ \textcolor{keywordflow}{case}\ MS\_done:}
\DoxyCodeLine{01363\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Done\ "{}};}
\DoxyCodeLine{01364\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01365\ }
\DoxyCodeLine{01366\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01367\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Unknown\ status\ "{}};}
\DoxyCodeLine{01368\ \ \ \}}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{01371\ \ \ \textcolor{keywordflow}{case}\ PT\_tri:}
\DoxyCodeLine{01372\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Tri"{}};}
\DoxyCodeLine{01373\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01374\ }
\DoxyCodeLine{01375\ \ \ \textcolor{keywordflow}{case}\ PT\_quad:}
\DoxyCodeLine{01376\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Quad"{}};}
\DoxyCodeLine{01377\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01378\ }
\DoxyCodeLine{01379\ \ \ \textcolor{keywordflow}{case}\ PT\_tristrip:}
\DoxyCodeLine{01380\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}TriStrip"{}};}
\DoxyCodeLine{01381\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01382\ }
\DoxyCodeLine{01383\ \ \ \textcolor{keywordflow}{case}\ PT\_trifan:}
\DoxyCodeLine{01384\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}TriFan"{}};}
\DoxyCodeLine{01385\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01386\ }
\DoxyCodeLine{01387\ \ \ \textcolor{keywordflow}{case}\ PT\_quadstrip:}
\DoxyCodeLine{01388\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}QuadStrip"{}};}
\DoxyCodeLine{01389\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01390\ }
\DoxyCodeLine{01391\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01392\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}Unknown"{}};}
\DoxyCodeLine{01393\ \ \ \}}
\DoxyCodeLine{01394\ }
\DoxyCodeLine{01395\ \ \ \textcolor{keywordflow}{if}\ (\_planar)\ \{}
\DoxyCodeLine{01396\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ (planar)"{}};}
\DoxyCodeLine{01397\ \ \ \}}
\DoxyCodeLine{01398\ }
\DoxyCodeLine{01399\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \_index\ <<\ \textcolor{stringliteral}{"{}\ ["{}};}
\DoxyCodeLine{01400\ }
\DoxyCodeLine{01401\ \ \ Verts::const\_iterator\ vi;}
\DoxyCodeLine{01402\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_verts.begin();\ vi\ !=\ \_verts.end();\ vi++)\ \{}
\DoxyCodeLine{01403\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ *vi;}
\DoxyCodeLine{01404\ \ \ \}}
\DoxyCodeLine{01405\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ ]:\ "{}}\ <<\ \_prims.size()}
\DoxyCodeLine{01406\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ prims,\ "{}}\ <<\ \mbox{\hyperlink{classEggMesherStrip_a45e63634b8577858c414b3a970921384}{count\_neighbors}}()\ <<\ \textcolor{stringliteral}{"{}\ neighbors"{}};}
\DoxyCodeLine{01407\ }
\DoxyCodeLine{01408\ \ \ \mbox{\hyperlink{classEggMesherStrip_a3bc20c3222a6031b353514323140d56f}{output\_neighbors}}(out);}
\DoxyCodeLine{01409\ }
\DoxyCodeLine{01410\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ edges"{}};}
\DoxyCodeLine{01411\ \ \ Edges::const\_iterator\ ei;}
\DoxyCodeLine{01412\ \ \ \textcolor{keywordflow}{for}\ (ei\ =\ \_edges.begin();\ ei\ !=\ \_edges.end();\ ei++)\ \{}
\DoxyCodeLine{01413\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ (\textcolor{keywordtype}{void}\ *)(*ei);}
\DoxyCodeLine{01414\ \ \ \}}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01416\ \ \ out\ <<\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{01417\ \}}

\end{DoxyCode}
