\doxysection{iff\+Input\+File.\+cxx}
\hypertarget{iffInputFile_8cxx_source}{}\label{iffInputFile_8cxx_source}\index{pandatool/src/lwo/iffInputFile.cxx@{pandatool/src/lwo/iffInputFile.cxx}}
\mbox{\hyperlink{iffInputFile_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{iffInputFile_8h}{iffInputFile.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{iffGenericChunk_8h}{iffGenericChunk.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ IffInputFile::\_type\_handle;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00025\ IffInputFile::}
\DoxyCodeLine{00026\ IffInputFile()\ \{}
\DoxyCodeLine{00027\ \ \ \_input\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00028\ \ \ \_owns\_istream\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00029\ \ \ \_eof\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00030\ \ \ \_unexpected\_eof\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00031\ \ \ \_bytes\_read\ =\ 0;}
\DoxyCodeLine{00032\ \}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00037\ IffInputFile::}
\DoxyCodeLine{00038\ \string~IffInputFile()\ \{}
\DoxyCodeLine{00039\ \ \ \textcolor{keywordflow}{if}\ (\_owns\_istream)\ \{}
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00041\ \ \ \ \ vfs-\/>close\_read\_file(\_input);}
\DoxyCodeLine{00042\ \ \ \}}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00049\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classIffInputFile_a18d22f0fdbf29ab9ed4ed64541447923}{IffInputFile::}}}
\DoxyCodeLine{00050\ \mbox{\hyperlink{classIffInputFile_a18d22f0fdbf29ab9ed4ed64541447923}{open\_read}}(\mbox{\hyperlink{classFilename}{Filename}}\ filename)\ \{}
\DoxyCodeLine{00051\ \ \ filename.set\_binary();}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00054\ \ \ std::istream\ *in\ =\ vfs-\/>open\_read\_file(filename,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{if}\ (in\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00057\ \ \ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \mbox{\hyperlink{classIffInputFile_a41c404556cdcdf3a145dacfc07a82e88}{set\_input}}(in,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00060\ \ \ set\_filename(filename);}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00070\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classIffInputFile_a41c404556cdcdf3a145dacfc07a82e88}{IffInputFile::}}}
\DoxyCodeLine{00071\ \mbox{\hyperlink{classIffInputFile_a41c404556cdcdf3a145dacfc07a82e88}{set\_input}}(std::istream\ *input,\ \textcolor{keywordtype}{bool}\ owns\_istream)\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{if}\ (\_owns\_istream)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00074\ \ \ \ \ vfs-\/>close\_read\_file(\_input);}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ \ \ \_input\ =\ input;}
\DoxyCodeLine{00077\ \ \ \_owns\_istream\ =\ owns\_istream;}
\DoxyCodeLine{00078\ \ \ \_eof\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00079\ \ \ \_unexpected\_eof\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00080\ \ \ \_bytes\_read\ =\ 0;}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00086\ int8\_t\ \mbox{\hyperlink{classIffInputFile_a99b6985f431ca89bf91d9d439890b255}{IffInputFile::}}}
\DoxyCodeLine{00087\ \mbox{\hyperlink{classIffInputFile_a99b6985f431ca89bf91d9d439890b255}{get\_int8}}()\ \{}
\DoxyCodeLine{00088\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 1))\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_int8();}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00099\ uint8\_t\ \mbox{\hyperlink{classIffInputFile_adff39f1f6c88b4b5316b41167fc7be5f}{IffInputFile::}}}
\DoxyCodeLine{00100\ \mbox{\hyperlink{classIffInputFile_adff39f1f6c88b4b5316b41167fc7be5f}{get\_uint8}}()\ \{}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 1))\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00104\ \ \ \}}
\DoxyCodeLine{00105\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_int8();}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00112\ int16\_t\ \mbox{\hyperlink{classIffInputFile_acab25a64a2fe3291d2fd190a484e3932}{IffInputFile::}}}
\DoxyCodeLine{00113\ \mbox{\hyperlink{classIffInputFile_acab25a64a2fe3291d2fd190a484e3932}{get\_be\_int16}}()\ \{}
\DoxyCodeLine{00114\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 2))\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_be\_int16();}
\DoxyCodeLine{00120\ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00125\ int32\_t\ \mbox{\hyperlink{classIffInputFile_a8c8b670024a511e90b1868315dd2d8b8}{IffInputFile::}}}
\DoxyCodeLine{00126\ \mbox{\hyperlink{classIffInputFile_a8c8b670024a511e90b1868315dd2d8b8}{get\_be\_int32}}()\ \{}
\DoxyCodeLine{00127\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 4))\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00130\ \ \ \}}
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00132\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_be\_int32();}
\DoxyCodeLine{00133\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00138\ uint16\_t\ \mbox{\hyperlink{classIffInputFile_a52e6c61f39828c32517fe11e4268db0e}{IffInputFile::}}}
\DoxyCodeLine{00139\ \mbox{\hyperlink{classIffInputFile_a52e6c61f39828c32517fe11e4268db0e}{get\_be\_uint16}}()\ \{}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 2))\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_be\_uint16();}
\DoxyCodeLine{00146\ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00151\ uint32\_t\ \mbox{\hyperlink{classIffInputFile_a7af777325255b9dc8b0f838291f18271}{IffInputFile::}}}
\DoxyCodeLine{00152\ \mbox{\hyperlink{classIffInputFile_a7af777325255b9dc8b0f838291f18271}{get\_be\_uint32}}()\ \{}
\DoxyCodeLine{00153\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 4))\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00156\ \ \ \}}
\DoxyCodeLine{00157\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00158\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_be\_uint32();}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00164\ PN\_stdfloat\ \mbox{\hyperlink{classIffInputFile_a2c33f99892ad49a0021d2c7badcd9f03}{IffInputFile::}}}
\DoxyCodeLine{00165\ \mbox{\hyperlink{classIffInputFile_a2c33f99892ad49a0021d2c7badcd9f03}{get\_be\_float32}}()\ \{}
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 4))\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00169\ \ \ \}}
\DoxyCodeLine{00170\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ dgi(dg);}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{return}\ dgi.get\_be\_float32();}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00177\ std::string\ \mbox{\hyperlink{classIffInputFile_af022bea640741475b0904b6a41a04f4a}{IffInputFile::}}}
\DoxyCodeLine{00178\ \mbox{\hyperlink{classIffInputFile_af022bea640741475b0904b6a41a04f4a}{get\_string}}()\ \{}
\DoxyCodeLine{00179\ \ \ std::string\ result;}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordtype}{char}\ byte;}
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{while}\ (\mbox{\hyperlink{classIffInputFile_ac95e95b9c8f53990d6e7333fe7a10cc3}{read\_byte}}(\textcolor{keywordtype}{byte}))\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{byte}\ ==\ 0)\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ result\ +=\ byte;}
\DoxyCodeLine{00186\ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ align();}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00190\ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00195\ \mbox{\hyperlink{classIffId}{IffId}}\ \mbox{\hyperlink{classIffInputFile_a5fc3d251187256a0d4a2db4c664e1302}{IffInputFile::}}}
\DoxyCodeLine{00196\ \mbox{\hyperlink{classIffInputFile_a5fc3d251187256a0d4a2db4c664e1302}{get\_id}}()\ \{}
\DoxyCodeLine{00197\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ dg;}
\DoxyCodeLine{00198\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(dg,\ 4))\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classIffId}{IffId}}();}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\textcolor{keywordtype}{id}\ =\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)dg.get\_data();}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classIffId}{IffId}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00203\ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00211\ PT(\mbox{\hyperlink{classIffChunk}{IffChunk}})\ IffInputFile::}
\DoxyCodeLine{00212\ get\_chunk()\ \{}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00215\ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \mbox{\hyperlink{classIffId}{IffId}}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{classIffInputFile_a5fc3d251187256a0d4a2db4c664e1302}{get\_id}}();}
\DoxyCodeLine{00218\ \ \ uint32\_t\ length\ =\ \mbox{\hyperlink{classIffInputFile_a7af777325255b9dc8b0f838291f18271}{get\_be\_uint32}}();}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{if}\ (!is\_eof())\ \{}
\DoxyCodeLine{00221\ \ \ \ \ PT(\mbox{\hyperlink{classIffChunk}{IffChunk}})\ chunk\ =\ \mbox{\hyperlink{classIffInputFile_a53fe4cdeeb5f203ff257bc27d55fe07b}{make\_new\_chunk}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00222\ \ \ \ \ chunk-\/>set\_id(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ start\_point\ =\ get\_bytes\_read();}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ end\_point\ =\ start\_point\ +\ length;}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{if}\ (chunk-\/>read\_iff(\textcolor{keyword}{this},\ end\_point))\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_unexpected\_eof)\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Unexpected\ EOF\ on\ file\ reading\ "{}}\ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \_unexpected\_eof\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_bytes\_read\ =\ get\_bytes\_read()\ -\/\ start\_point;}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_bytes\_read\ >\ length)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ nout\ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\ read\ "{}}\ <<\ num\_bytes\_read}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ instead\ of\ "{}}\ <<\ length\ <<\ \textcolor{stringliteral}{"{}\ bytes.\(\backslash\)n"{}};}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (num\_bytes\_read\ <\ length)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ skip\_count\ =\ length\ -\/\ num\_bytes\_read;}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Ignoring\ "{}}\ <<\ skip\_count\ <<\ \textcolor{stringliteral}{"{}\ bytes\ at\ the\ end\ of\ "{}}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classIffInputFile_abf5ced7c54a09c69789f63e835820bbe}{skip\_bytes}}(skip\_count);}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ chunk;}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00253\ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00261\ PT(\mbox{\hyperlink{classIffChunk}{IffChunk}})\ IffInputFile::}
\DoxyCodeLine{00262\ get\_subchunk(\mbox{\hyperlink{classIffChunk}{IffChunk}}\ *context)\ \{}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00265\ \ \ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \mbox{\hyperlink{classIffId}{IffId}}\ \textcolor{keywordtype}{id}\ =\ \mbox{\hyperlink{classIffInputFile_a5fc3d251187256a0d4a2db4c664e1302}{get\_id}}();}
\DoxyCodeLine{00268\ \ \ uint16\_t\ length\ =\ \mbox{\hyperlink{classIffInputFile_a52e6c61f39828c32517fe11e4268db0e}{get\_be\_uint16}}();}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \textcolor{keywordflow}{if}\ (!is\_eof())\ \{}
\DoxyCodeLine{00271\ \ \ \ \ PT(\mbox{\hyperlink{classIffChunk}{IffChunk}})\ chunk\ =\ context-\/>\mbox{\hyperlink{classIffChunk_a021762d59bdc58b095eec69b9662ba31}{make\_new\_chunk}}(\textcolor{keyword}{this},\ \textcolor{keywordtype}{id});}
\DoxyCodeLine{00272\ \ \ \ \ chunk-\/>set\_id(\textcolor{keywordtype}{id});}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ start\_point\ =\ get\_bytes\_read();}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ end\_point\ =\ start\_point\ +\ length;}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{if}\ (chunk-\/>read\_iff(\textcolor{keyword}{this},\ end\_point))\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_unexpected\_eof)\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Unexpected\ EOF\ on\ file\ reading\ "{}}\ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \_unexpected\_eof\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ num\_bytes\_read\ =\ get\_bytes\_read()\ -\/\ start\_point;}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (num\_bytes\_read\ >\ length)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ nout\ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\ read\ "{}}\ <<\ num\_bytes\_read}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ instead\ of\ "{}}\ <<\ length\ <<\ \textcolor{stringliteral}{"{}\ bytes.\(\backslash\)n"{}};}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (num\_bytes\_read\ <\ length)\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ skip\_count\ =\ length\ -\/\ num\_bytes\_read;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Ignoring\ "{}}\ <<\ skip\_count\ <<\ \textcolor{stringliteral}{"{}\ bytes\ at\ the\ end\ of\ "{}}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ <<\ *chunk\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classIffInputFile_abf5ced7c54a09c69789f63e835820bbe}{skip\_bytes}}(skip\_count);}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ chunk;}
\DoxyCodeLine{00299\ \ \ \ \ \}}
\DoxyCodeLine{00300\ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00303\ \}}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00308\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classIffInputFile_ac95e95b9c8f53990d6e7333fe7a10cc3}{IffInputFile::}}}
\DoxyCodeLine{00309\ \mbox{\hyperlink{classIffInputFile_ac95e95b9c8f53990d6e7333fe7a10cc3}{read\_byte}}(\textcolor{keywordtype}{char}\ \&\textcolor{keywordtype}{byte})\ \{}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \_input-\/>get(\textcolor{keywordtype}{byte});}
\DoxyCodeLine{00315\ \ \ \_bytes\_read++;}
\DoxyCodeLine{00316\ \ \ \_eof\ =\ \_input-\/>eof()\ ||\ \_input-\/>fail();}
\DoxyCodeLine{00317\ \ \ \textcolor{keywordflow}{return}\ !is\_eof();}
\DoxyCodeLine{00318\ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00324\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{IffInputFile::}}}
\DoxyCodeLine{00325\ \mbox{\hyperlink{classIffInputFile_a379fc153d885a3997b6de145ec1858f4}{read\_bytes}}(\mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00326\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordtype}{char}\ *buffer\ =\ \textcolor{keyword}{new}\ \textcolor{keywordtype}{char}[length];}
\DoxyCodeLine{00331\ \ \ \_input-\/>read(buffer,\ length);}
\DoxyCodeLine{00332\ \ \ \_eof\ =\ (\_input-\/>gcount()\ !=\ length);}
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \_bytes\_read\ +=\ length;}
\DoxyCodeLine{00338\ \ \ datagram\ =\ \mbox{\hyperlink{classDatagram}{Datagram}}(buffer,\ length);}
\DoxyCodeLine{00339\ \ \ \textcolor{keyword}{delete}[]\ buffer;}
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00347\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classIffInputFile_abf5ced7c54a09c69789f63e835820bbe}{IffInputFile::}}}
\DoxyCodeLine{00348\ \mbox{\hyperlink{classIffInputFile_abf5ced7c54a09c69789f63e835820bbe}{skip\_bytes}}(\textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00349\ \ \ \textcolor{keywordflow}{if}\ (is\_eof())\ \{}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00351\ \ \ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \textcolor{keywordtype}{char}\ byte;}
\DoxyCodeLine{00354\ \ \ \textcolor{keywordflow}{while}\ (length\ >\ 0\ \&\&\ !is\_eof())\ \{}
\DoxyCodeLine{00355\ \ \ \ \ \mbox{\hyperlink{classIffInputFile_ac95e95b9c8f53990d6e7333fe7a10cc3}{read\_byte}}(\textcolor{keywordtype}{byte});}
\DoxyCodeLine{00356\ \ \ \ \ length-\/-\/;}
\DoxyCodeLine{00357\ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{return}\ !is\_eof();}
\DoxyCodeLine{00360\ \}}
\DoxyCodeLine{00361\ }
\DoxyCodeLine{00366\ \mbox{\hyperlink{classIffChunk}{IffChunk}}\ *\mbox{\hyperlink{classIffInputFile_a53fe4cdeeb5f203ff257bc27d55fe07b}{IffInputFile::}}}
\DoxyCodeLine{00367\ \mbox{\hyperlink{classIffInputFile_a53fe4cdeeb5f203ff257bc27d55fe07b}{make\_new\_chunk}}(\mbox{\hyperlink{classIffId}{IffId}})\ \{}
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classIffGenericChunk}{IffGenericChunk}};}
\DoxyCodeLine{00369\ \}}

\end{DoxyCode}
