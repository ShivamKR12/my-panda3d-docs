\doxysection{clip.\+cxx}
\hypertarget{clip_8cxx_source}{}\label{clip_8cxx_source}\index{panda/src/tinydisplay/clip.cxx@{panda/src/tinydisplay/clip.cxx}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#include\ "{}zgl.h"{}}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#include\ <limits.h>}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{comment}{/*\ fill\ triangle\ profile\ */}}
\DoxyCodeLine{00005\ \textcolor{comment}{/*\ \#define\ PROFILE\ */}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#define\ CLIP\_XMIN\ \ \ (1<<0)}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#define\ CLIP\_XMAX\ \ \ (1<<1)}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ CLIP\_YMIN\ \ \ (1<<2)}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ CLIP\_YMAX\ \ \ (1<<3)}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ CLIP\_ZMIN\ \ \ (1<<4)}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ CLIP\_ZMAX\ \ \ (1<<5)}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keywordtype}{void}\ gl\_transform\_to\_viewport(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *v)}
\DoxyCodeLine{00017\ \{}
\DoxyCodeLine{00018\ \ \ PN\_stdfloat\ winv;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \textcolor{comment}{/*\ coordinates\ */}}
\DoxyCodeLine{00021\ \ \ winv\ =\ 1.0f\ /\ v-\/>pc.v[3];}
\DoxyCodeLine{00022\ \ \ v-\/>zp.x=\ (int)\ (\ v-\/>pc.v[0]\ *\ winv\ *\ c-\/>viewport.scale.v[0]\ }
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ c-\/>viewport.trans.v[0]\ );}
\DoxyCodeLine{00024\ \ \ v-\/>zp.y=\ (int)\ (\ v-\/>pc.v[1]\ *\ winv\ *\ c-\/>viewport.scale.v[1]\ }
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ c-\/>viewport.trans.v[1]\ );}
\DoxyCodeLine{00026\ \ \ v-\/>zp.z=\ (int)\ (\ v-\/>pc.v[2]\ *\ winv\ *\ c-\/>viewport.scale.v[2]\ }
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ c-\/>viewport.trans.v[2]\ );}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \textcolor{comment}{//\ Add\ the\ z-\/bias,\ if\ any.\ \ Be\ careful\ not\ to\ overflow\ the\ int.}}
\DoxyCodeLine{00030\ \ \ \textcolor{keywordtype}{int}\ z\ =\ v-\/>zp.z\ +\ (c-\/>zbias\ <<\ (ZB\_POINT\_Z\_FRAC\_BITS\ +\ 4));}
\DoxyCodeLine{00031\ \ \ \textcolor{keywordflow}{if}\ (z\ <\ v-\/>zp.z\ \&\&\ c-\/>zbias\ >\ 0)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ v-\/>zp.z\ =\ INT\_MAX;}
\DoxyCodeLine{00033\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (z\ >\ v-\/>zp.z\ \&\&\ c-\/>zbias\ <\ 0)\ \{}
\DoxyCodeLine{00034\ \ \ \ \ v-\/>zp.z\ =\ -\/INT\_MAX;}
\DoxyCodeLine{00035\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00036\ \ \ \ \ v-\/>zp.z\ =\ z;}
\DoxyCodeLine{00037\ \ \ \}}
\DoxyCodeLine{00038\ \ \ \textcolor{keywordflow}{if}\ (c-\/>has\_zrange)\ \{}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ Rescale\ the\ Z\ value\ into\ the\ specified\ range.}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ z\_range\ =\ (1\ <<\ (ZB\_Z\_BITS\ +\ ZB\_POINT\_Z\_FRAC\_BITS))\ -\/\ 1;}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{keywordtype}{double}\ z\ =\ 1.0\ -\/\ (double)(v-\/>zp.z)\ /\ (double)(z\_range);}
\DoxyCodeLine{00042\ \ \ \ \ z\ =\ z\ *\ c-\/>zrange\ +\ c-\/>zmin;}
\DoxyCodeLine{00043\ \ \ \ \ v-\/>zp.z\ =\ (int)((1.0\ -\/\ z)\ *\ (double)(z\_range))\ +\ 1;}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{/*\ color\ */}}
\DoxyCodeLine{00047\ \ \ v-\/>zp.r=min((\textcolor{keywordtype}{int})(v-\/>color.v[0]\ *\ (ZB\_POINT\_RED\_MAX\ -\/\ ZB\_POINT\_RED\_MIN))}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ZB\_POINT\_RED\_MIN,\ ZB\_POINT\_RED\_MAX);}
\DoxyCodeLine{00049\ \ \ v-\/>zp.g=min((\textcolor{keywordtype}{int})(v-\/>color.v[1]\ *\ (ZB\_POINT\_GREEN\_MAX\ -\/\ ZB\_POINT\_GREEN\_MIN))}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ZB\_POINT\_GREEN\_MIN,\ ZB\_POINT\_GREEN\_MAX);}
\DoxyCodeLine{00051\ \ \ v-\/>zp.b=min((\textcolor{keywordtype}{int})(v-\/>color.v[2]\ *\ (ZB\_POINT\_BLUE\_MAX\ -\/\ ZB\_POINT\_BLUE\_MIN))}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ZB\_POINT\_BLUE\_MIN,\ ZB\_POINT\_BLUE\_MAX);}
\DoxyCodeLine{00053\ \ \ v-\/>zp.a=min((\textcolor{keywordtype}{int})(v-\/>color.v[3]\ *\ (ZB\_POINT\_ALPHA\_MAX\ -\/\ ZB\_POINT\_ALPHA\_MIN))}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ +\ ZB\_POINT\_ALPHA\_MIN,\ ZB\_POINT\_ALPHA\_MAX);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{/*\ texture\ */}}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{if}\ (c-\/>num\_textures\_enabled\ >=\ 1)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ si\ =\ 0;}
\DoxyCodeLine{00059\ \ \ \ \ v-\/>zp.s\ =\ (int)(v-\/>tex\_coord[si].v[0]\ *\ c-\/>current\_textures[si]-\/>s\_max);\ }
\DoxyCodeLine{00060\ \ \ \ \ v-\/>zp.t\ =\ (int)(v-\/>tex\_coord[si].v[1]\ *\ c-\/>current\_textures[si]-\/>t\_max);}
\DoxyCodeLine{00061\ \ \ \}}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{if}\ (c-\/>num\_textures\_enabled\ >=\ 2)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ si\ =\ 1;}
\DoxyCodeLine{00064\ \ \ \ \ v-\/>zp.sa\ =\ (int)(v-\/>tex\_coord[si].v[0]\ *\ c-\/>current\_textures[si]-\/>s\_max);\ }
\DoxyCodeLine{00065\ \ \ \ \ v-\/>zp.ta\ =\ (int)(v-\/>tex\_coord[si].v[1]\ *\ c-\/>current\_textures[si]-\/>t\_max);}
\DoxyCodeLine{00066\ \ \ \}}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordflow}{if}\ (c-\/>num\_textures\_enabled\ >=\ 3)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ si\ =\ 2;}
\DoxyCodeLine{00069\ \ \ \ \ v-\/>zp.sb\ =\ (int)(v-\/>tex\_coord[si].v[0]\ *\ c-\/>current\_textures[si]-\/>s\_max);\ }
\DoxyCodeLine{00070\ \ \ \ \ v-\/>zp.tb\ =\ (int)(v-\/>tex\_coord[si].v[1]\ *\ c-\/>current\_textures[si]-\/>t\_max);}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{comment}{/*\ point\ */}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{void}\ gl\_draw\_point(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0)}
\DoxyCodeLine{00078\ \{}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{if}\ (p0-\/>clip\_code\ ==\ 0)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ ZB\_plot(c-\/>zb,\&p0-\/>zp);}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{comment}{/*\ line\ */}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ interpolate(\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *q,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,PN\_stdfloat\ t)}
\DoxyCodeLine{00087\ \{}
\DoxyCodeLine{00088\ \ \ q-\/>pc.v[0]=p0-\/>pc.v[0]+(p1-\/>pc.v[0]-\/p0-\/>pc.v[0])*t;}
\DoxyCodeLine{00089\ \ \ q-\/>pc.v[1]=p0-\/>pc.v[1]+(p1-\/>pc.v[1]-\/p0-\/>pc.v[1])*t;}
\DoxyCodeLine{00090\ \ \ q-\/>pc.v[2]=p0-\/>pc.v[2]+(p1-\/>pc.v[2]-\/p0-\/>pc.v[2])*t;}
\DoxyCodeLine{00091\ \ \ q-\/>pc.v[3]=p0-\/>pc.v[3]+(p1-\/>pc.v[3]-\/p0-\/>pc.v[3])*t;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ q-\/>color.v[0]=p0-\/>color.v[0]\ +\ (p1-\/>color.v[0]-\/p0-\/>color.v[0])*t;}
\DoxyCodeLine{00094\ \ \ q-\/>color.v[1]=p0-\/>color.v[1]\ +\ (p1-\/>color.v[1]-\/p0-\/>color.v[1])*t;}
\DoxyCodeLine{00095\ \ \ q-\/>color.v[2]=p0-\/>color.v[2]\ +\ (p1-\/>color.v[2]-\/p0-\/>color.v[2])*t;}
\DoxyCodeLine{00096\ \ \ q-\/>color.v[3]=p0-\/>color.v[3]\ +\ (p1-\/>color.v[3]-\/p0-\/>color.v[3])*t;}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \textcolor{comment}{/*}}
\DoxyCodeLine{00100\ \textcolor{comment}{\ *\ Line\ Clipping\ }}
\DoxyCodeLine{00101\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \textcolor{comment}{/*\ Line\ Clipping\ algorithm\ from\ 'Computer\ Graphics',\ Principles\ and}}
\DoxyCodeLine{00104\ \textcolor{comment}{\ \ \ Practice\ */}}
\DoxyCodeLine{00105\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{int}\ ClipLine1(PN\_stdfloat\ denom,PN\_stdfloat\ num,PN\_stdfloat\ *tmin,PN\_stdfloat\ *tmax)}
\DoxyCodeLine{00106\ \{}
\DoxyCodeLine{00107\ \ \ PN\_stdfloat\ t;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}\ (denom>0)\ \{}
\DoxyCodeLine{00110\ \ \ \ \ t=num/denom;}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{if}\ (t>*tmax)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{if}\ (t>*tmin)\ *tmin=t;}
\DoxyCodeLine{00113\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (denom<0)\ \{}
\DoxyCodeLine{00114\ \ \ \ \ t=num/denom;}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (t<*tmin)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keywordflow}{if}\ (t<*tmax)\ *tmax=t;}
\DoxyCodeLine{00117\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (num>0)\ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00119\ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \textcolor{keywordtype}{void}\ gl\_draw\_line(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2)}
\DoxyCodeLine{00122\ \{}
\DoxyCodeLine{00123\ \ \ PN\_stdfloat\ dx,dy,dz,dw,x1,y1,z1,w1;}
\DoxyCodeLine{00124\ \ \ PN\_stdfloat\ tmin,tmax;}
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ q1,q2;}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{int}\ cc1,cc2;}
\DoxyCodeLine{00127\ \ \ }
\DoxyCodeLine{00128\ \ \ cc1=p1-\/>clip\_code;}
\DoxyCodeLine{00129\ \ \ cc2=p2-\/>clip\_code;}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{if}\ (\ (cc1\ |\ cc2)\ ==\ 0)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>depth\_test)}
\DoxyCodeLine{00133\ \ \ \ \ \ \ ZB\_line\_z(c-\/>zb,\&p1-\/>zp,\&p2-\/>zp);}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ ZB\_line(c-\/>zb,\&p1-\/>zp,\&p2-\/>zp);}
\DoxyCodeLine{00136\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\ (cc1\&cc2)\ !=\ 0\ )\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00138\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00139\ \ \ \ \ dx=p2-\/>pc.v[0]-\/p1-\/>pc.v[0];}
\DoxyCodeLine{00140\ \ \ \ \ dy=p2-\/>pc.v[1]-\/p1-\/>pc.v[1];}
\DoxyCodeLine{00141\ \ \ \ \ dz=p2-\/>pc.v[2]-\/p1-\/>pc.v[2];}
\DoxyCodeLine{00142\ \ \ \ \ dw=p2-\/>pc.v[3]-\/p1-\/>pc.v[3];}
\DoxyCodeLine{00143\ \ \ \ \ x1=p1-\/>pc.v[0];}
\DoxyCodeLine{00144\ \ \ \ \ y1=p1-\/>pc.v[1];}
\DoxyCodeLine{00145\ \ \ \ \ z1=p1-\/>pc.v[2];}
\DoxyCodeLine{00146\ \ \ \ \ w1=p1-\/>pc.v[3];}
\DoxyCodeLine{00147\ \ \ \ \ }
\DoxyCodeLine{00148\ \ \ \ \ tmin=0;}
\DoxyCodeLine{00149\ \ \ \ \ tmax=1;}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{if}\ (ClipLine1(dx+dw,-\/x1-\/w1,\&tmin,\&tmax)\ \&\&}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ ClipLine1(-\/dx+dw,x1-\/w1,\&tmin,\&tmax)\ \&\&}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ ClipLine1(dy+dw,-\/y1-\/w1,\&tmin,\&tmax)\ \&\&}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ ClipLine1(-\/dy+dw,y1-\/w1,\&tmin,\&tmax)\ \&\&}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ ClipLine1(dz+dw,-\/z1-\/w1,\&tmin,\&tmax)\ \&\&\ }
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ ClipLine1(-\/dz+dw,z1-\/w1,\&tmin,\&tmax))\ \{}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \ \ \ \ \ \ interpolate(\&q1,p1,p2,tmin);}
\DoxyCodeLine{00158\ \ \ \ \ \ \ interpolate(\&q2,p1,p2,tmax);}
\DoxyCodeLine{00159\ \ \ \ \ \ \ gl\_transform\_to\_viewport(c,\&q1);}
\DoxyCodeLine{00160\ \ \ \ \ \ \ gl\_transform\_to\_viewport(c,\&q2);}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>depth\_test)}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ ZB\_line\_z(c-\/>zb,\&q1.zp,\&q2.zp);}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ ZB\_line(c-\/>zb,\&q1.zp,\&q2.zp);}
\DoxyCodeLine{00166\ \ \ \ \ \}}
\DoxyCodeLine{00167\ \ \ \}}
\DoxyCodeLine{00168\ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \textcolor{comment}{/*\ triangle\ */}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \textcolor{comment}{/*}}
\DoxyCodeLine{00174\ \textcolor{comment}{\ *\ Clipping}}
\DoxyCodeLine{00175\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \textcolor{comment}{/*\ We\ clip\ the\ segment\ [a,b]\ against\ the\ 6\ planes\ of\ the\ normal\ volume.}}
\DoxyCodeLine{00178\ \textcolor{comment}{\ *\ We\ compute\ the\ point\ 'c'\ of\ intersection\ and\ the\ value\ of\ the\ parameter\ 't'}}
\DoxyCodeLine{00179\ \textcolor{comment}{\ *\ of\ the\ intersection\ if\ x=a+t(b-\/a).\ }}
\DoxyCodeLine{00180\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\#define\ clip\_func(name,\ sign,\ dir,\ dir1,\ dir2)\ \(\backslash\)}}
\DoxyCodeLine{00183\ \textcolor{preprocessor}{static\ PN\_stdfloat\ name(V4\ *c,\ V4\ *a,\ V4\ *b)\ \(\backslash\)}}
\DoxyCodeLine{00184\ \textcolor{preprocessor}{\{\(\backslash\)}}
\DoxyCodeLine{00185\ \textcolor{preprocessor}{\ \ PN\_stdfloat\ t,den;\(\backslash\)}}
\DoxyCodeLine{00186\ \textcolor{preprocessor}{\ \ PN\_stdfloat\ d[4];\(\backslash\)}}
\DoxyCodeLine{00187\ \textcolor{preprocessor}{\ \ d[0]\ =\ (b-\/>v[0]\ -\/\ a-\/>v[0]);\(\backslash\)}}
\DoxyCodeLine{00188\ \textcolor{preprocessor}{\ \ d[1]\ =\ (b-\/>v[1]\ -\/\ a-\/>v[1]);\(\backslash\)}}
\DoxyCodeLine{00189\ \textcolor{preprocessor}{\ \ d[2]\ =\ (b-\/>v[2]\ -\/\ a-\/>v[2]);\(\backslash\)}}
\DoxyCodeLine{00190\ \textcolor{preprocessor}{\ \ d[3]\ =\ (b-\/>v[3]\ -\/\ a-\/>v[3]);\(\backslash\)}}
\DoxyCodeLine{00191\ \textcolor{preprocessor}{\ \ den\ =\ -\/(sign\ d[dir])\ +\ d[3];\(\backslash\)}}
\DoxyCodeLine{00192\ \textcolor{preprocessor}{\ \ if\ (den\ ==\ 0)\ t=0;\(\backslash\)}}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\ \ else\ t\ =\ (\ sign\ a-\/>v[dir]\ -\/\ a-\/>v[3])\ /\ den;\(\backslash\)}}
\DoxyCodeLine{00194\ \textcolor{preprocessor}{\ \ c-\/>v[dir1]\ =\ a-\/>v[dir1]\ +\ t\ *\ d[dir1];\(\backslash\)}}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\ \ c-\/>v[dir2]\ =\ a-\/>v[dir2]\ +\ t\ *\ d[dir2];\(\backslash\)}}
\DoxyCodeLine{00196\ \textcolor{preprocessor}{\ \ c-\/>v[3]\ =\ a-\/>v[3]\ +\ t\ *\ d[3];\(\backslash\)}}
\DoxyCodeLine{00197\ \textcolor{preprocessor}{\ \ c-\/>v[dir]\ =\ sign\ c-\/>v[3];\(\backslash\)}}
\DoxyCodeLine{00198\ \textcolor{preprocessor}{\ \ return\ t;\(\backslash\)}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\}}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ clip\_func(clip\_xmin,\ -\/,\ 0,\ 1,\ 2)}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ clip\_func(clip\_xmax,\ +,\ 0,\ 1,\ 2)}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ clip\_func(clip\_ymin,\ -\/,\ 1,\ 0,\ 2)}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ clip\_func(clip\_ymax,\ +,\ 1,\ 0,\ 2)}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ clip\_func(clip\_zmin,\ -\/,\ 2,\ 0,\ 1)}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ clip\_func(clip\_zmax,\ +,\ 2,\ 0,\ 1)}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ PN\_stdfloat\ (*clip\_proc[6])(\mbox{\hyperlink{structV4}{V4}}\ *,\mbox{\hyperlink{structV4}{V4}}\ *,\mbox{\hyperlink{structV4}{V4}}\ *)=\ \ \{}
\DoxyCodeLine{00216\ \ \ \ \ clip\_xmin,clip\_xmax,}
\DoxyCodeLine{00217\ \ \ \ \ clip\_ymin,clip\_ymax,}
\DoxyCodeLine{00218\ \ \ \ \ clip\_zmin,clip\_zmax}
\DoxyCodeLine{00219\ \};}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ updateTmp(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *q,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,PN\_stdfloat\ t)}
\DoxyCodeLine{00223\ \{}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{if}\ (c-\/>smooth\_shade\_model)\ \{}
\DoxyCodeLine{00225\ \ \ \ \ q-\/>color.v[0]=p0-\/>color.v[0]\ +\ (p1-\/>color.v[0]-\/p0-\/>color.v[0])*t;}
\DoxyCodeLine{00226\ \ \ \ \ q-\/>color.v[1]=p0-\/>color.v[1]\ +\ (p1-\/>color.v[1]-\/p0-\/>color.v[1])*t;}
\DoxyCodeLine{00227\ \ \ \ \ q-\/>color.v[2]=p0-\/>color.v[2]\ +\ (p1-\/>color.v[2]-\/p0-\/>color.v[2])*t;}
\DoxyCodeLine{00228\ \ \ \ \ q-\/>color.v[3]=p0-\/>color.v[3]\ +\ (p1-\/>color.v[3]-\/p0-\/>color.v[3])*t;}
\DoxyCodeLine{00229\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00230\ \ \ \ \ q-\/>color.v[0]=p0-\/>color.v[0];}
\DoxyCodeLine{00231\ \ \ \ \ q-\/>color.v[1]=p0-\/>color.v[1];}
\DoxyCodeLine{00232\ \ \ \ \ q-\/>color.v[2]=p0-\/>color.v[2];}
\DoxyCodeLine{00233\ \ \ \ \ q-\/>color.v[3]=p0-\/>color.v[3];}
\DoxyCodeLine{00234\ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ si\ =\ 0;\ si\ <\ c-\/>num\_textures\_enabled;\ ++si)\ \{}
\DoxyCodeLine{00237\ \ \ \ \ q-\/>tex\_coord[si].v[0]=p0-\/>tex\_coord[si].v[0]\ +\ (p1-\/>tex\_coord[si].v[0]-\/p0-\/>tex\_coord[si].v[0])*t;}
\DoxyCodeLine{00238\ \ \ \ \ q-\/>tex\_coord[si].v[1]=p0-\/>tex\_coord[si].v[1]\ +\ (p1-\/>tex\_coord[si].v[1]-\/p0-\/>tex\_coord[si].v[1])*t;}
\DoxyCodeLine{00239\ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ q-\/>clip\_code=gl\_clipcode(q-\/>pc.v[0],q-\/>pc.v[1],q-\/>pc.v[2],q-\/>pc.v[3]);}
\DoxyCodeLine{00242\ \ \ \textcolor{keywordflow}{if}\ (q-\/>clip\_code==0)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ gl\_transform\_to\_viewport(c,q);}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ \}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle\_clip(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2,\textcolor{keywordtype}{int}\ clip\_bit);}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2)}
\DoxyCodeLine{00252\ \{}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordtype}{int}\ co,c\_and,cc[3],front;}
\DoxyCodeLine{00254\ \ \ PN\_stdfloat\ norm;}
\DoxyCodeLine{00255\ \ \ }
\DoxyCodeLine{00256\ \ \ cc[0]=p0-\/>clip\_code;}
\DoxyCodeLine{00257\ \ \ cc[1]=p1-\/>clip\_code;}
\DoxyCodeLine{00258\ \ \ cc[2]=p2-\/>clip\_code;}
\DoxyCodeLine{00259\ \ \ }
\DoxyCodeLine{00260\ \ \ co=cc[0]\ |\ cc[1]\ |\ cc[2];}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{comment}{/*\ we\ handle\ the\ non\ clipped\ case\ here\ to\ go\ faster\ */}}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{if}\ (co==0)\ \{}
\DoxyCodeLine{00264\ \ \ \ \ }
\DoxyCodeLine{00265\ \ \ \ \ \ \ norm=(PN\_stdfloat)(p1-\/>zp.x-\/p0-\/>zp.x)*(PN\_stdfloat)(p2-\/>zp.y-\/p0-\/>zp.y)-\/}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ (PN\_stdfloat)(p2-\/>zp.x-\/p0-\/>zp.x)*(PN\_stdfloat)(p1-\/>zp.y-\/p0-\/>zp.y);}
\DoxyCodeLine{00267\ \ \ \ \ \ \ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (norm\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \ \ front\ =\ norm\ <\ 0.0;}
\DoxyCodeLine{00271\ \ \ }
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{comment}{/*\ back\ face\ culling\ */}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>cull\_face\_enabled)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ most\ used\ case\ first\ */}}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>cull\_clockwise)\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (front\ ==\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ c-\/>draw\_triangle\_front(c,p0,p1,p2);}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (front\ !=\ 0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ c-\/>draw\_triangle\_back(c,p0,p1,p2);}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*\ no\ culling\ */}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (front)\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ c-\/>draw\_triangle\_front(c,p0,p1,p2);}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ c-\/>draw\_triangle\_back(c,p0,p1,p2);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00290\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00291\ \ \ \ \ c\_and=cc[0]\ \&\ cc[1]\ \&\ cc[2];}
\DoxyCodeLine{00292\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\_and==0)\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ gl\_draw\_triangle\_clip(c,p0,p1,p2,0);}
\DoxyCodeLine{00294\ \ \ \ \ \}}
\DoxyCodeLine{00295\ \ \ \}}
\DoxyCodeLine{00296\ \}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle\_clip(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2,\textcolor{keywordtype}{int}\ clip\_bit)}
\DoxyCodeLine{00300\ \{}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordtype}{int}\ co,c\_and,co1,cc[3],edge\_flag\_tmp,clip\_mask;}
\DoxyCodeLine{00302\ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ tmp1,tmp2,*q[3];}
\DoxyCodeLine{00303\ \ \ PN\_stdfloat\ tt;}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ cc[0]=p0-\/>clip\_code;}
\DoxyCodeLine{00306\ \ \ cc[1]=p1-\/>clip\_code;}
\DoxyCodeLine{00307\ \ \ cc[2]=p2-\/>clip\_code;}
\DoxyCodeLine{00308\ \ \ }
\DoxyCodeLine{00309\ \ \ co=cc[0]\ |\ cc[1]\ |\ cc[2];}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{if}\ (co\ ==\ 0)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ gl\_draw\_triangle(c,p0,p1,p2);}
\DoxyCodeLine{00312\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00313\ \ \ \ \ c\_and=cc[0]\ \&\ cc[1]\ \&\ cc[2];}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{/*\ the\ triangle\ is\ completely\ outside\ */}}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{keywordflow}{if}\ (c\_and!=0)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{comment}{/*\ find\ the\ next\ direction\ to\ clip\ */}}
\DoxyCodeLine{00318\ \ \ \ \ \textcolor{keywordflow}{while}\ (clip\_bit\ <\ 6\ \&\&\ (co\ \&\ (1\ <<\ clip\_bit))\ ==\ 0)\ \ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ clip\_bit++;}
\DoxyCodeLine{00320\ \ \ \ \ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{comment}{/*\ this\ test\ can\ be\ true\ only\ in\ case\ of\ rounding\ errors\ */}}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}\ (clip\_bit\ ==\ 6)\ \{}
\DoxyCodeLine{00324\ \textcolor{preprocessor}{\#if\ 0}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}Error:\(\backslash\)n"{}});}
\DoxyCodeLine{00326\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%f\ \%f\ \%f\ \%f\(\backslash\)n"{}},p0-\/>pc.v[0],p0-\/>pc.v[1],p0-\/>pc.v[2],p0-\/>pc.v[3]);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%f\ \%f\ \%f\ \%f\(\backslash\)n"{}},p1-\/>pc.v[0],p1-\/>pc.v[1],p1-\/>pc.v[2],p1-\/>pc.v[3]);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ printf(\textcolor{stringliteral}{"{}\%f\ \%f\ \%f\ \%f\(\backslash\)n"{}},p2-\/>pc.v[0],p2-\/>pc.v[1],p2-\/>pc.v[2],p2-\/>pc.v[3]);}
\DoxyCodeLine{00329\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00331\ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ }
\DoxyCodeLine{00333\ \ \ \ \ clip\_mask\ =\ 1\ <<\ clip\_bit;}
\DoxyCodeLine{00334\ \ \ \ \ co1=(cc[0]\ \string^\ cc[1]\ \string^\ cc[2])\ \&\ clip\_mask;}
\DoxyCodeLine{00335\ \ \ \ \ }
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordflow}{if}\ (co1)\ \ \{\ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{comment}{/*\ one\ point\ outside\ */}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cc[0]\ \&\ clip\_mask)\ \{\ q[0]=p0;\ q[1]=p1;\ q[2]=p2;\ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cc[1]\ \&\ clip\_mask)\ \{\ q[0]=p1;\ q[1]=p2;\ q[2]=p0;\ \}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{\ q[0]=p2;\ q[1]=p0;\ q[2]=p1;\ \}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ }
\DoxyCodeLine{00343\ \ \ \ \ \ \ tt=clip\_proc[clip\_bit](\&tmp1.pc,\&q[0]-\/>pc,\&q[1]-\/>pc);}
\DoxyCodeLine{00344\ \ \ \ \ \ \ updateTmp(c,\&tmp1,q[0],q[1],tt);}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ \ \ tt=clip\_proc[clip\_bit](\&tmp2.pc,\&q[0]-\/>pc,\&q[2]-\/>pc);}
\DoxyCodeLine{00347\ \ \ \ \ \ \ updateTmp(c,\&tmp2,q[0],q[2],tt);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ tmp1.edge\_flag=q[0]-\/>edge\_flag;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ edge\_flag\_tmp=q[2]-\/>edge\_flag;}
\DoxyCodeLine{00351\ \ \ \ \ \ \ q[2]-\/>edge\_flag=0;}
\DoxyCodeLine{00352\ \ \ \ \ \ \ gl\_draw\_triangle\_clip(c,\&tmp1,q[1],q[2],clip\_bit+1);}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \ \ tmp2.edge\_flag=1;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ tmp1.edge\_flag=0;}
\DoxyCodeLine{00356\ \ \ \ \ \ \ q[2]-\/>edge\_flag=edge\_flag\_tmp;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ gl\_draw\_triangle\_clip(c,\&tmp2,\&tmp1,q[2],clip\_bit+1);}
\DoxyCodeLine{00358\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \textcolor{comment}{/*\ two\ points\ outside\ */}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((cc[0]\ \&\ clip\_mask)==0)\ \{\ q[0]=p0;\ q[1]=p1;\ q[2]=p2;\ \}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((cc[1]\ \&\ clip\_mask)==0)\ \{\ q[0]=p1;\ q[1]=p2;\ q[2]=p0;\ \}\ }
\DoxyCodeLine{00363\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{\ q[0]=p2;\ q[1]=p0;\ q[2]=p1;\ \}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ }
\DoxyCodeLine{00365\ \ \ \ \ \ \ tt=clip\_proc[clip\_bit](\&tmp1.pc,\&q[0]-\/>pc,\&q[1]-\/>pc);}
\DoxyCodeLine{00366\ \ \ \ \ \ \ updateTmp(c,\&tmp1,q[0],q[1],tt);}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \ \ tt=clip\_proc[clip\_bit](\&tmp2.pc,\&q[0]-\/>pc,\&q[2]-\/>pc);}
\DoxyCodeLine{00369\ \ \ \ \ \ \ updateTmp(c,\&tmp2,q[0],q[2],tt);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ }
\DoxyCodeLine{00371\ \ \ \ \ \ \ tmp1.edge\_flag=1;}
\DoxyCodeLine{00372\ \ \ \ \ \ \ tmp2.edge\_flag=q[2]-\/>edge\_flag;}
\DoxyCodeLine{00373\ \ \ \ \ \ \ gl\_draw\_triangle\_clip(c,q[0],\&tmp1,\&tmp2,clip\_bit+1);}
\DoxyCodeLine{00374\ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \}}
\DoxyCodeLine{00376\ \}}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \textcolor{preprocessor}{\#ifdef\ PROFILE}}
\DoxyCodeLine{00380\ \textcolor{keywordtype}{int}\ count\_triangles,count\_triangles\_textured,count\_pixels;}
\DoxyCodeLine{00381\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle\_fill(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2)}
\DoxyCodeLine{00385\ \{}
\DoxyCodeLine{00386\ \textcolor{preprocessor}{\#ifdef\ PROFILE}}
\DoxyCodeLine{00387\ \ \ \{}
\DoxyCodeLine{00388\ \ \ \ \ \textcolor{keywordtype}{int}\ norm;}
\DoxyCodeLine{00389\ \ \ \ \ assert(p0-\/>zp.x\ >=\ 0\ \&\&\ p0-\/>zp.x\ <\ c-\/>zb-\/>xsize);}
\DoxyCodeLine{00390\ \ \ \ \ assert(p0-\/>zp.y\ >=\ 0\ \&\&\ p0-\/>zp.y\ <\ c-\/>zb-\/>ysize);}
\DoxyCodeLine{00391\ \ \ \ \ assert(p1-\/>zp.x\ >=\ 0\ \&\&\ p1-\/>zp.x\ <\ c-\/>zb-\/>xsize);}
\DoxyCodeLine{00392\ \ \ \ \ assert(p1-\/>zp.y\ >=\ 0\ \&\&\ p1-\/>zp.y\ <\ c-\/>zb-\/>ysize);}
\DoxyCodeLine{00393\ \ \ \ \ assert(p2-\/>zp.x\ >=\ 0\ \&\&\ p2-\/>zp.x\ <\ c-\/>zb-\/>xsize);}
\DoxyCodeLine{00394\ \ \ \ \ assert(p2-\/>zp.y\ >=\ 0\ \&\&\ p2-\/>zp.y\ <\ c-\/>zb-\/>ysize);}
\DoxyCodeLine{00395\ \ \ \ \ }
\DoxyCodeLine{00396\ \ \ \ \ norm=(p1-\/>zp.x-\/p0-\/>zp.x)*(p2-\/>zp.y-\/p0-\/>zp.y)-\/}
\DoxyCodeLine{00397\ \ \ \ \ \ \ (p2-\/>zp.x-\/p0-\/>zp.x)*(p1-\/>zp.y-\/p0-\/>zp.y);}
\DoxyCodeLine{00398\ \ \ \ \ count\_pixels+=abs(norm)/2;}
\DoxyCodeLine{00399\ \ \ \ \ count\_triangles++;}
\DoxyCodeLine{00400\ \ \ \}}
\DoxyCodeLine{00401\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00402\ \ \ \ \ }
\DoxyCodeLine{00403\ \textcolor{preprocessor}{\#ifdef\ PROFILE}}
\DoxyCodeLine{00404\ \ \ \textcolor{keywordflow}{if}\ (c-\/>num\_textures\_enabled\ !=\ 0)\ \{}
\DoxyCodeLine{00405\ \ \ \ \ count\_triangles\_textured++;}
\DoxyCodeLine{00406\ \ \ \}}
\DoxyCodeLine{00407\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ (*c-\/>zb\_fill\_tri)(c-\/>zb,\&p0-\/>zp,\&p1-\/>zp,\&p2-\/>zp);}
\DoxyCodeLine{00410\ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \textcolor{comment}{/*\ Render\ a\ clipped\ triangle\ in\ line\ mode\ */}\ \ }
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle\_line(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2)}
\DoxyCodeLine{00416\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \textcolor{keywordflow}{if}\ (c-\/>depth\_test)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p0-\/>edge\_flag)\ ZB\_line\_z(c-\/>zb,\&p0-\/>zp,\&p1-\/>zp);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p1-\/>edge\_flag)\ ZB\_line\_z(c-\/>zb,\&p1-\/>zp,\&p2-\/>zp);}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p2-\/>edge\_flag)\ ZB\_line\_z(c-\/>zb,\&p2-\/>zp,\&p0-\/>zp);}
\DoxyCodeLine{00421\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p0-\/>edge\_flag)\ ZB\_line(c-\/>zb,\&p0-\/>zp,\&p1-\/>zp);}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p1-\/>edge\_flag)\ ZB\_line(c-\/>zb,\&p1-\/>zp,\&p2-\/>zp);}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p2-\/>edge\_flag)\ ZB\_line(c-\/>zb,\&p2-\/>zp,\&p0-\/>zp);}
\DoxyCodeLine{00425\ \ \ \ \ \}}
\DoxyCodeLine{00426\ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \textcolor{comment}{/*\ Render\ a\ clipped\ triangle\ in\ point\ mode\ */}}
\DoxyCodeLine{00431\ \textcolor{keywordtype}{void}\ gl\_draw\_triangle\_point(\mbox{\hyperlink{structGLContext}{GLContext}}\ *c,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p0,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p1,\mbox{\hyperlink{structGLVertex}{GLVertex}}\ *p2)}
\DoxyCodeLine{00433\ \{}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{if}\ (p0-\/>edge\_flag)\ ZB\_plot(c-\/>zb,\&p0-\/>zp);}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{if}\ (p1-\/>edge\_flag)\ ZB\_plot(c-\/>zb,\&p1-\/>zp);}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{if}\ (p2-\/>edge\_flag)\ ZB\_plot(c-\/>zb,\&p2-\/>zp);}
\DoxyCodeLine{00437\ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ }
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ }

\end{DoxyCode}
