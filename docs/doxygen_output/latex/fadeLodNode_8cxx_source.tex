\doxysection{fade\+Lod\+Node.\+cxx}
\hypertarget{fadeLodNode_8cxx_source}{}\label{fadeLodNode_8cxx_source}\index{panda/src/pgraphnodes/fadeLodNode.cxx@{panda/src/pgraphnodes/fadeLodNode.cxx}}
\mbox{\hyperlink{fadeLodNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fadeLodNode_8h}{fadeLodNode.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fadeLodNodeData_8h}{fadeLodNodeData.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverserData_8h}{cullTraverserData.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverser_8h}{cullTraverser.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{clockObject_8h}{clockObject.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{colorScaleAttrib_8h}{colorScaleAttrib.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{depthWriteAttrib_8h}{depthWriteAttrib.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{transparencyAttrib_8h}{transparencyAttrib.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullBinAttrib_8h}{cullBinAttrib.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{depthOffsetAttrib_8h}{depthOffsetAttrib.h}}"{}}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ FadeLODNode::\_type\_handle;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ FadeLODNode::}
\DoxyCodeLine{00031\ FadeLODNode(\textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00032\ \ \ \mbox{\hyperlink{classLODNode}{LODNode}}(name)}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ set\_cull\_callback();}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \_fade\_time\ =\ lod\_fade\_time;}
\DoxyCodeLine{00037\ \ \ \_fade\_bin\_name\ =\ lod\_fade\_bin\_name;}
\DoxyCodeLine{00038\ \ \ \_fade\_bin\_draw\_order\ =\ lod\_fade\_bin\_draw\_order;}
\DoxyCodeLine{00039\ \ \ \_fade\_state\_override\ =\ lod\_fade\_state\_override;}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00045\ FadeLODNode::}
\DoxyCodeLine{00046\ FadeLODNode(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFadeLODNode}{FadeLODNode}}\ \&copy)\ :}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classLODNode}{LODNode}}(copy)}
\DoxyCodeLine{00048\ \{}
\DoxyCodeLine{00049\ \ \ \_fade\_time\ =\ copy.\_fade\_time;}
\DoxyCodeLine{00050\ \ \ \_fade\_bin\_name\ =\ copy.\_fade\_bin\_name;}
\DoxyCodeLine{00051\ \ \ \_fade\_bin\_draw\_order\ =\ copy.\_fade\_bin\_draw\_order;}
\DoxyCodeLine{00052\ \ \ \_fade\_state\_override\ =\ copy.\_fade\_state\_override;}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00060\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classFadeLODNode_ad644a9051367f73da9bb84420c506040}{FadeLODNode::}}}
\DoxyCodeLine{00061\ \mbox{\hyperlink{classFadeLODNode_ad644a9051367f73da9bb84420c506040}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFadeLODNode}{FadeLODNode}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00083\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFadeLODNode_a775347a4914145ec60707cff21e0c751}{FadeLODNode::}}}
\DoxyCodeLine{00084\ \mbox{\hyperlink{classFadeLODNode_a775347a4914145ec60707cff21e0c751}{cull\_callback}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{if}\ (!support\_fade\_lod)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classLODNode_a45f2951e642bdbf52e0bdd891edf5b18}{LODNode::cull\_callback}}(trav,\ data);}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{if}\ (is\_any\_shown())\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classLODNode_a4e0a60f81ca9ae974c36e4ad9c6ea950}{show\_switches\_cull\_callback}}(trav,\ data);}
\DoxyCodeLine{00091\ \ \ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ consider\_verify\_lods(trav,\ data);}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \mbox{\hyperlink{classCamera}{Camera}}\ *camera\ =\ trav-\/>get\_scene()-\/>get\_camera\_node();}
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ this\_np\ =\ data.get\_node\_path();}
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{classFadeLODNodeData}{FadeLODNodeData}}\ *ldata\ =}
\DoxyCodeLine{00098\ \ \ \ \ DCAST(\mbox{\hyperlink{classFadeLODNodeData}{FadeLODNodeData}},\ camera-\/>\mbox{\hyperlink{classCamera_a1fffe7f58368fb6abab8d65c40f2295c}{get\_aux\_scene\_data}}(this\_np));}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordtype}{double}\ now\ =\ ClockObject::get\_global\_clock()-\/>get\_frame\_time();}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{if}\ (ldata\ ==\ \textcolor{keyword}{nullptr}\ ||\ now\ >\ ldata-\/>get\_expiration\_time())\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ first\ time\ we\ have\ rendered\ this\ instance\ of\ this\ LOD\ node}}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{comment}{//\ in\ a\ while.}}
\DoxyCodeLine{00105\ \ \ \ \ ldata\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFadeLODNodeData}{FadeLODNodeData}};}
\DoxyCodeLine{00106\ \ \ \ \ ldata-\/>\_fade\_mode\ =\ FadeLODNodeData::FM\_solid;}
\DoxyCodeLine{00107\ \ \ \ \ ldata-\/>\_fade\_out\ =\ -\/1;}
\DoxyCodeLine{00108\ \ \ \ \ ldata-\/>\_fade\_in\ =\ \mbox{\hyperlink{classLODNode_a959c6bcddad7c937c7fc28cbcaad9dc3}{compute\_child}}(trav,\ data);}
\DoxyCodeLine{00109\ \ \ \ \ camera-\/>set\_aux\_scene\_data(this\_np,\ ldata);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{comment}{//\ We\ had\ rendered\ this\ LOD\ node\ last\ frame\ (or\ not\ too\ long\ ago,\ at}}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{comment}{//\ least).}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (ldata-\/>\_fade\_mode\ ==\ FadeLODNodeData::FM\_solid)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ were\ drawing\ just\ one\ solid\ child\ last\ frame;\ check\ whether\ it's}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{comment}{//\ time\ to\ begin\ a\ transition.}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ \mbox{\hyperlink{classLODNode_a959c6bcddad7c937c7fc28cbcaad9dc3}{compute\_child}}(trav,\ data);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ !=\ ldata-\/>\_fade\_in)\ \{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Start\ a\ transition.}}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >=\ 0\ \&\&\ ldata-\/>\_fade\_in\ >=\ 0\ \&\&}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ get\_out(index)\ >\ get\_out(ldata-\/>\_fade\_in))\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ are\ fading\ from\ a\ more-\/detailed\ model\ to\ a\ less-\/detailed}}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model.}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_mode\ =\ FadeLODNodeData::FM\_less\_detail;}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ are\ fading\ from\ a\ less-\/detailed\ model\ to\ a\ more-\/detailed}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model.}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_mode\ =\ FadeLODNodeData::FM\_more\_detail;}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ start\ the\ fade\ as\ of\ the\ last\ frame\ we\ actually\ rendered;\ that}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ way,\ if\ the\ object\ happened\ to\ be\ offscreen\ for\ a\ large\ part\ of\ the}}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ fade,\ we'll\ just\ view\ the\ tail\ end\ of\ it-\/-\/a\ little\ nicer.}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_start\ =\ ldata-\/>get\_last\_render\_time();}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_out\ =\ ldata-\/>\_fade\_in;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_in\ =\ index;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00139\ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{if}\ (ldata-\/>\_fade\_mode\ !=\ FadeLODNodeData::FM\_solid)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{comment}{//\ Play\ the\ transition.}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \ \ PN\_stdfloat\ elapsed\ =\ now\ -\/\ ldata-\/>\_fade\_start;}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elapsed\ >=\ \_fade\_time)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Transition\ complete.}}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ ldata-\/>\_fade\_mode\ =\ FadeLODNodeData::FM\_solid;}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ PN\_stdfloat\ half\_fade\_time\ =\ \_fade\_time\ *\ 0.5f;}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ in\_child\ =\ ldata-\/>\_fade\_in;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ out\_child\ =\ ldata-\/>\_fade\_out;}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ldata-\/>\_fade\_mode\ ==\ FadeLODNodeData::FM\_less\_detail)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we're\ fading\ from\ a\ more-\/detailed\ model\ to\ a\ less-\/detailed}}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ model,\ reverse\ the\ fade\ effect\ for\ best\ visual\ quality.}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ elapsed\ =\ \_fade\_time\ -\/\ elapsed;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ in\_child;}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ in\_child\ =\ out\_child;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ out\_child\ =\ t;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ nassertr(elapsed\ >=\ 0.0f\ \&\&\ elapsed\ <=\ \_fade\_time,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ Children\ children\ =\ get\_children();}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (elapsed\ <\ half\_fade\_time)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ FIRST\ HALF\ OF\ FADE\ Fade\ the\ new\ LOD\ in\ with\ z\ writing\ off\ Keep}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ drawing\ the\ old\ LOD\ opaque\ with\ z\ writing\ on}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (out\_child\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})out\_child\ <\ children.get\_num\_children())\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode_1_1DownConnection}{PandaNode::DownConnection}}\ \&child\ =\ children.get\_child\_connection(out\_child);}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ trav-\/>traverse\_down(data,\ child,}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.\_state-\/>compose(get\_fade\_1\_old\_state()));}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_child\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})in\_child\ <\ children.get\_num\_children())\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode_1_1DownConnection}{PandaNode::DownConnection}}\ \&child\ =\ children.get\_child\_connection(in\_child);}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ in\_alpha\ =\ elapsed\ /\ half\_fade\_time;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ trav-\/>traverse\_down(data,\ child,}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.\_state-\/>compose(get\_fade\_1\_new\_state(in\_alpha)));}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ SECOND\ HALF\ OF\ FADE:\ Fade\ out\ the\ old\ LOD\ with\ z\ write\ off\ and}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ draw\ the\ opaque\ new\ LOD\ with\ z\ write\ on}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (in\_child\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})in\_child\ <\ children.get\_num\_children())\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode_1_1DownConnection}{PandaNode::DownConnection}}\ \&child\ =\ children.get\_child\_connection(in\_child);}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ trav-\/>traverse\_down(data,\ child,}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.\_state-\/>compose(get\_fade\_2\_new\_state()));}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (out\_child\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})out\_child\ <\ children.get\_num\_children())\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode_1_1DownConnection}{PandaNode::DownConnection}}\ \&child\ =\ children.get\_child\_connection(out\_child);}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ out\_alpha\ =\ 1.0f\ -\/\ (elapsed\ -\/\ half\_fade\_time)\ /\ half\_fade\_time;}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ trav-\/>traverse\_down(data,\ child,}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.\_state-\/>compose(get\_fade\_2\_old\_state(out\_alpha)));}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00201\ \ \ \ \ \}}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ \textcolor{keywordflow}{if}\ (ldata-\/>\_fade\_mode\ ==\ FadeLODNodeData::FM\_solid)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{comment}{//\ This\ is\ the\ normal\ case:\ we're\ not\ in\ the\ middle\ of\ a\ transition;\ we're}}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ just\ drawing\ one\ child\ of\ the\ LOD.}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordtype}{int}\ index\ =\ ldata-\/>\_fade\_in;}
\DoxyCodeLine{00208\ \ \ \ \ Children\ children\ =\ get\_children();}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{keywordflow}{if}\ (index\ >=\ 0\ \&\&\ (\textcolor{keywordtype}{size\_t})index\ <\ children.get\_num\_children())\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode_1_1DownConnection}{PandaNode::DownConnection}}\ \&child\ =\ children.get\_child\_connection(index);}
\DoxyCodeLine{00211\ \ \ \ \ \ \ trav-\/>traverse\_down(data,\ child,\ data.\_state);}
\DoxyCodeLine{00212\ \ \ \ \ \}}
\DoxyCodeLine{00213\ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ ldata-\/>set\_last\_render\_time(now);}
\DoxyCodeLine{00216\ \ \ ldata-\/>set\_duration(\_fade\_time);}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00224\ \textcolor{keywordtype}{void}\ FadeLODNode::}
\DoxyCodeLine{00225\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00226\ \ \ LODNode::output(out);}
\DoxyCodeLine{00227\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ fade\ time:\ "{}}\ <<\ \_fade\_time;}
\DoxyCodeLine{00228\ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00234\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFadeLODNode_a815a0386f9155f1fdaf81e949f1368cd}{FadeLODNode::}}}
\DoxyCodeLine{00235\ \mbox{\hyperlink{classFadeLODNode_a815a0386f9155f1fdaf81e949f1368cd}{set\_fade\_bin}}(\textcolor{keyword}{const}\ std::string\ \&name,\ \textcolor{keywordtype}{int}\ draw\_order)\ \{}
\DoxyCodeLine{00236\ \ \ \_fade\_bin\_name\ =\ name;}
\DoxyCodeLine{00237\ \ \ \_fade\_bin\_draw\_order\ =\ draw\_order;}
\DoxyCodeLine{00238\ \ \ \_fade\_1\_new\_state.clear();}
\DoxyCodeLine{00239\ \ \ \_fade\_2\_old\_state.clear();}
\DoxyCodeLine{00240\ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00247\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFadeLODNode_a7f32d963905d234a96a3a4f48dc091b2}{FadeLODNode::}}}
\DoxyCodeLine{00248\ \mbox{\hyperlink{classFadeLODNode_a7f32d963905d234a96a3a4f48dc091b2}{set\_fade\_state\_override}}(\textcolor{keywordtype}{int}\ \textcolor{keyword}{override})\ \{}
\DoxyCodeLine{00249\ \ \ \_fade\_state\_override\ =\ \textcolor{keyword}{override};}
\DoxyCodeLine{00250\ \ \ \_fade\_1\_old\_state.clear();}
\DoxyCodeLine{00251\ \ \ \_fade\_1\_new\_state.clear();}
\DoxyCodeLine{00252\ \ \ \_fade\_2\_old\_state.clear();}
\DoxyCodeLine{00253\ \ \ \_fade\_2\_new\_state.clear();}
\DoxyCodeLine{00254\ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00260\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ FadeLODNode::}
\DoxyCodeLine{00261\ get\_fade\_1\_old\_state()\ \{}
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{if}\ (\_fade\_1\_old\_state\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \_fade\_1\_old\_state\ =\ RenderState::make\_empty();}
\DoxyCodeLine{00264\ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{keywordflow}{return}\ \_fade\_1\_old\_state;}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00273\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ FadeLODNode::}
\DoxyCodeLine{00274\ get\_fade\_1\_new\_state(PN\_stdfloat\ in\_alpha)\ \{}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{if}\ (\_fade\_1\_new\_state\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00276\ \ \ \ \ \_fade\_1\_new\_state\ =\ RenderState::make}
\DoxyCodeLine{00277\ \ \ \ \ \ \ (TransparencyAttrib::make(TransparencyAttrib::M\_alpha),}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ CullBinAttrib::make(\_fade\_bin\_name,\ \_fade\_bin\_draw\_order),}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ DepthOffsetAttrib::make(),}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \_fade\_state\_override);}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ LVecBase4\ alpha\_scale(1.0f,\ 1.0f,\ 1.0f,\ in\_alpha);}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{return}\ \_fade\_1\_new\_state-\/>compose}
\DoxyCodeLine{00285\ \ \ \ \ (RenderState::make(ColorScaleAttrib::make(alpha\_scale)));}
\DoxyCodeLine{00286\ \}}
\DoxyCodeLine{00287\ }
\DoxyCodeLine{00292\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ FadeLODNode::}
\DoxyCodeLine{00293\ get\_fade\_2\_old\_state(PN\_stdfloat\ out\_alpha)\ \{}
\DoxyCodeLine{00294\ \ \ \textcolor{keywordflow}{if}\ (\_fade\_2\_old\_state\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \_fade\_2\_old\_state\ =\ RenderState::make}
\DoxyCodeLine{00296\ \ \ \ \ \ \ (TransparencyAttrib::make(TransparencyAttrib::M\_alpha),}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ DepthWriteAttrib::make(DepthWriteAttrib::M\_off),}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ CullBinAttrib::make(\_fade\_bin\_name,\ \_fade\_bin\_draw\_order),}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \_fade\_state\_override);}
\DoxyCodeLine{00300\ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ LVecBase4\ alpha\_scale(1.0f,\ 1.0f,\ 1.0f,\ out\_alpha);}
\DoxyCodeLine{00303\ \ \ \textcolor{keywordflow}{return}\ \_fade\_2\_old\_state-\/>compose}
\DoxyCodeLine{00304\ \ \ \ \ (RenderState::make(ColorScaleAttrib::make(alpha\_scale)));}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00311\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ FadeLODNode::}
\DoxyCodeLine{00312\ get\_fade\_2\_new\_state()\ \{}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{if}\ (\_fade\_2\_new\_state\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \_fade\_2\_new\_state\ =\ RenderState::make}
\DoxyCodeLine{00315\ \ \ \ \ \ \ (DepthOffsetAttrib::make(),}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \_fade\_state\_override);}
\DoxyCodeLine{00317\ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{return}\ \_fade\_2\_new\_state;}
\DoxyCodeLine{00320\ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00325\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFadeLODNode_af762e55a31e3b5ed77ed42ed9ac0535e}{FadeLODNode::}}}
\DoxyCodeLine{00326\ \mbox{\hyperlink{classFadeLODNode_af762e55a31e3b5ed77ed42ed9ac0535e}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00327\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classFadeLODNode_abf573d9e4ad126e1321db56f21760598}{make\_from\_bam}});}
\DoxyCodeLine{00328\ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00334\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFadeLODNode_a9963aab6494971a848947dd30a550fdb}{FadeLODNode::}}}
\DoxyCodeLine{00335\ \mbox{\hyperlink{classFadeLODNode_a9963aab6494971a848947dd30a550fdb}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00336\ \ \ \mbox{\hyperlink{classLODNode_afbf4c6f44d6802c2143be2689f5a72e9}{LODNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00337\ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00344\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classFadeLODNode_abf573d9e4ad126e1321db56f21760598}{FadeLODNode::}}}
\DoxyCodeLine{00345\ \mbox{\hyperlink{classFadeLODNode_abf573d9e4ad126e1321db56f21760598}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00346\ \ \ \mbox{\hyperlink{classFadeLODNode}{FadeLODNode}}\ *node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFadeLODNode}{FadeLODNode}}(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00347\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00348\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00351\ \ \ node-\/>\mbox{\hyperlink{classFadeLODNode_aace7426ab67255ad290a6359a5f6b732}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \textcolor{keywordflow}{return}\ node;}
\DoxyCodeLine{00354\ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00360\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFadeLODNode_aace7426ab67255ad290a6359a5f6b732}{FadeLODNode::}}}
\DoxyCodeLine{00361\ \mbox{\hyperlink{classFadeLODNode_aace7426ab67255ad290a6359a5f6b732}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00362\ \ \ \mbox{\hyperlink{classLODNode_acfe046ddef008b7c08c8bc46f47ab7a2}{LODNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00363\ \}}

\end{DoxyCode}
