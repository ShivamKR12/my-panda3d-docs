\doxysection{flt\+Header.\+cxx}
\hypertarget{fltHeader_8cxx_source}{}\label{fltHeader_8cxx_source}\index{pandatool/src/flt/fltHeader.cxx@{pandatool/src/flt/fltHeader.cxx}}
\mbox{\hyperlink{fltHeader_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltHeader_8h}{fltHeader.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltRecordReader_8h}{fltRecordReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltRecordWriter_8h}{fltRecordWriter.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltUnsupportedRecord_8h}{fltUnsupportedRecord.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__flt_8h}{config\_flt.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{zStream_8h}{zStream.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nearly__zero_8h}{nearly\_zero.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{math_8h}{math.h}}>}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ FltHeader::\_type\_handle;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00038\ \mbox{\hyperlink{classFltHeader_a6c09b83b290c32c5dd79bbd0b41601ca}{FltHeader::}}}
\DoxyCodeLine{00039\ \mbox{\hyperlink{classFltHeader_a6c09b83b290c32c5dd79bbd0b41601ca}{FltHeader}}(\mbox{\hyperlink{classPathReplace}{PathReplace}}\ *path\_replace)\ :\ \mbox{\hyperlink{classFltBeadID}{FltBeadID}}(this)\ \{}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{if}\ (path\_replace\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \_path\_replace\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPathReplace}{PathReplace}};}
\DoxyCodeLine{00042\ \ \ \ \ \_path\_replace-\/>\_path\_store\ =\ PS\_absolute;}
\DoxyCodeLine{00043\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00044\ \ \ \ \ \_path\_replace\ =\ path\_replace;}
\DoxyCodeLine{00045\ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \_format\_revision\_level\ =\ 1570;}
\DoxyCodeLine{00048\ \ \ \_edit\_revision\_level\ =\ 1570;}
\DoxyCodeLine{00049\ \ \ \_next\_group\_id\ =\ 1;}
\DoxyCodeLine{00050\ \ \ \_next\_lod\_id\ =\ 1;}
\DoxyCodeLine{00051\ \ \ \_next\_object\_id\ =\ 1;}
\DoxyCodeLine{00052\ \ \ \_next\_face\_id\ =\ 1;}
\DoxyCodeLine{00053\ \ \ \_unit\_multiplier\ =\ 1;}
\DoxyCodeLine{00054\ \ \ \_vertex\_units\ =\ U\_feet;}
\DoxyCodeLine{00055\ \ \ \_texwhite\_new\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \_flags\ =\ 0;}
\DoxyCodeLine{00057\ \ \ \_projection\_type\ =\ PT\_flat\_earth;}
\DoxyCodeLine{00058\ \ \ \_next\_dof\_id\ =\ 1;}
\DoxyCodeLine{00059\ \ \ \_vertex\_storage\_type\ =\ VTS\_double;}
\DoxyCodeLine{00060\ \ \ \_database\_origin\ =\ DO\_open\_flight;}
\DoxyCodeLine{00061\ \ \ \_sw\_x\ =\ 0.0;}
\DoxyCodeLine{00062\ \ \ \_sw\_y\ =\ 0.0;}
\DoxyCodeLine{00063\ \ \ \_delta\_x\ =\ 0.0;}
\DoxyCodeLine{00064\ \ \ \_delta\_y\ =\ 0.0;}
\DoxyCodeLine{00065\ \ \ \_next\_sound\_id\ =\ 1;}
\DoxyCodeLine{00066\ \ \ \_next\_path\_id\ =\ 1;}
\DoxyCodeLine{00067\ \ \ \_next\_clip\_id\ =\ 1;}
\DoxyCodeLine{00068\ \ \ \_next\_text\_id\ =\ 1;}
\DoxyCodeLine{00069\ \ \ \_next\_bsp\_id\ =\ 1;}
\DoxyCodeLine{00070\ \ \ \_next\_switch\_id\ =\ 1;}
\DoxyCodeLine{00071\ \ \ \_sw\_lat\ =\ 0.0;}
\DoxyCodeLine{00072\ \ \ \_sw\_long\ =\ 0.0;}
\DoxyCodeLine{00073\ \ \ \_ne\_lat\ =\ 0.0;}
\DoxyCodeLine{00074\ \ \ \_ne\_long\ =\ 0.0;}
\DoxyCodeLine{00075\ \ \ \_origin\_lat\ =\ 0.0;}
\DoxyCodeLine{00076\ \ \ \_origin\_long\ =\ 0.0;}
\DoxyCodeLine{00077\ \ \ \_lambert\_upper\_lat\ =\ 0.0;}
\DoxyCodeLine{00078\ \ \ \_lambert\_lower\_lat\ =\ 0.0;}
\DoxyCodeLine{00079\ \ \ \_next\_light\_id\ =\ 1;}
\DoxyCodeLine{00080\ \ \ \_next\_road\_id\ =\ 1;}
\DoxyCodeLine{00081\ \ \ \_next\_cat\_id\ =\ 1;}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//\ New\ with\ 15.2}}
\DoxyCodeLine{00084\ \ \ \_earth\_model\ =\ EM\_wgs84;}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ New\ with\ 15.6}}
\DoxyCodeLine{00087\ \ \ \_next\_adaptive\_id\ =\ 0;}
\DoxyCodeLine{00088\ \ \ \_next\_curve\_id\ =\ 0;}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ New\ with\ 15.7}}
\DoxyCodeLine{00091\ \ \ \_delta\_z\ =\ 0.0;}
\DoxyCodeLine{00092\ \ \ \_radius\ =\ 0.0;}
\DoxyCodeLine{00093\ \ \ \_next\_mesh\_id\ =\ 0;}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \_vertex\_lookups\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00096\ \ \ \_current\_vertex\_offset\ =\ 0;}
\DoxyCodeLine{00097\ \ \ \_next\_material\_index\ =\ 1;}
\DoxyCodeLine{00098\ \ \ \_next\_pattern\_index\ =\ 1;}
\DoxyCodeLine{00099\ \ \ \_got\_color\_palette\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00100\ \ \ \_got\_14\_material\_palette\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00101\ \ \ \_got\_eyepoint\_trackplane\_palette\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \_auto\_attr\_update\ =\ AU\_if\_missing;}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00112\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a4aba46e36b93193c32f053e5c1c86f7f}{FltHeader::}}}
\DoxyCodeLine{00113\ \mbox{\hyperlink{classFltHeader_a4aba46e36b93193c32f053e5c1c86f7f}{apply\_converted\_filenames}}()\ \{}
\DoxyCodeLine{00114\ \ \ Textures::const\_iterator\ ti;}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_textures.begin();\ ti\ !=\ \_textures.end();\ ++ti)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{classFltTexture}{FltTexture}}\ *texture\ =\ (*ti).second;}
\DoxyCodeLine{00117\ \ \ \ \ texture-\/>\mbox{\hyperlink{classFltTexture_af41769e9f83d9e6aca505c4508757a08}{apply\_converted\_filenames}}();}
\DoxyCodeLine{00118\ \ \ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \mbox{\hyperlink{classFltRecord_ac0d47828d9e2fa4fa4f159150f6e34ae}{FltBeadID::apply\_converted\_filenames}}();}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a5f65f6bed8a9b73280e9295a28288780}{FltHeader::}}}
\DoxyCodeLine{00128\ \mbox{\hyperlink{classFltHeader_a5f65f6bed8a9b73280e9295a28288780}{set\_path\_replace}}(\mbox{\hyperlink{classPathReplace}{PathReplace}}\ *path\_replace)\ \{}
\DoxyCodeLine{00129\ \ \ \_path\_replace\ =\ path\_replace;}
\DoxyCodeLine{00130\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00137\ \mbox{\hyperlink{classPathReplace}{PathReplace}}\ *\mbox{\hyperlink{classFltHeader_aa80cd79c4eb410db10be953cccaff1ac}{FltHeader::}}}
\DoxyCodeLine{00138\ \mbox{\hyperlink{classFltHeader_aa80cd79c4eb410db10be953cccaff1ac}{get\_path\_replace}}()\ \{}
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{return}\ \_path\_replace;}
\DoxyCodeLine{00140\ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00147\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPathReplace}{PathReplace}}\ *\mbox{\hyperlink{classFltHeader_aa80cd79c4eb410db10be953cccaff1ac}{FltHeader::}}}
\DoxyCodeLine{00148\ \mbox{\hyperlink{classFltHeader_aa80cd79c4eb410db10be953cccaff1ac}{get\_path\_replace}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{return}\ \_path\_replace;}
\DoxyCodeLine{00150\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00156\ \mbox{\hyperlink{classFilename}{Filename}}\ \mbox{\hyperlink{classFltHeader_ad5a485360d1ca93228ede42567991652}{FltHeader::}}}
\DoxyCodeLine{00157\ \mbox{\hyperlink{classFltHeader_ad5a485360d1ca93228ede42567991652}{convert\_path}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&orig\_filename,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classDSearchPath}{DSearchPath}}\ \&additional\_path)\ \{}
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{classDSearchPath}{DSearchPath}}\ file\_path;}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{if}\ (!\_flt\_filename.empty())\ \{}
\DoxyCodeLine{00160\ \ \ \ \ file\_path.append\_directory(\_flt\_filename.get\_dirname());}
\DoxyCodeLine{00161\ \ \ \}}
\DoxyCodeLine{00162\ \ \ file\_path.append\_path(additional\_path);}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordflow}{return}\ \_path\_replace-\/>convert\_path(orig\_filename,\ file\_path);}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00170\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a5f2560928beda6b15602719c96d81ee7}{FltHeader::}}}
\DoxyCodeLine{00171\ \mbox{\hyperlink{classFltHeader_a5f2560928beda6b15602719c96d81ee7}{set\_flt\_filename}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&flt\_filename)\ \{}
\DoxyCodeLine{00172\ \ \ \_flt\_filename\ =\ flt\_filename;}
\DoxyCodeLine{00173\ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00178\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&\mbox{\hyperlink{classFltHeader_a4790887f94faeee8e2db0c1a69365bbd}{FltHeader::}}}
\DoxyCodeLine{00179\ \mbox{\hyperlink{classFltHeader_a4790887f94faeee8e2db0c1a69365bbd}{get\_flt\_filename}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{return}\ \_flt\_filename;}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00187\ FltError\ \mbox{\hyperlink{classFltHeader_a6afae3c73850ac375442dd40ebfcd4ab}{FltHeader::}}}
\DoxyCodeLine{00188\ \mbox{\hyperlink{classFltHeader_a6afae3c73850ac375442dd40ebfcd4ab}{read\_flt}}(\mbox{\hyperlink{classFilename}{Filename}}\ filename)\ \{}
\DoxyCodeLine{00189\ \ \ filename.set\_binary();}
\DoxyCodeLine{00190\ \ \ \_flt\_filename\ =\ filename;}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00193\ \ \ std::istream\ *in\ =\ vfs-\/>open\_read\_file(filename,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{if}\ (in\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00195\ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_could\_not\_open;}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ \ \ FltError\ result\ =\ \mbox{\hyperlink{classFltHeader_a6afae3c73850ac375442dd40ebfcd4ab}{read\_flt}}(*in);}
\DoxyCodeLine{00199\ \ \ vfs-\/>close\_read\_file(in);}
\DoxyCodeLine{00200\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00201\ \}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00207\ FltError\ \mbox{\hyperlink{classFltHeader_a6afae3c73850ac375442dd40ebfcd4ab}{FltHeader::}}}
\DoxyCodeLine{00208\ \mbox{\hyperlink{classFltHeader_a6afae3c73850ac375442dd40ebfcd4ab}{read\_flt}}(std::istream\ \&in)\ \{}
\DoxyCodeLine{00209\ \ \ \mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ reader(in);}
\DoxyCodeLine{00210\ \ \ FltError\ result\ =\ reader.\mbox{\hyperlink{classFltRecordReader_ada6e97e3e0515ff92c204decea17f91d}{advance}}();}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (result\ ==\ FE\_end\_of\_file)\ \{}
\DoxyCodeLine{00212\ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_empty\_file;}
\DoxyCodeLine{00214\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00216\ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ result\ =\ \mbox{\hyperlink{classFltRecord_a57aef624dade63d8fe3b255ef38e6806}{read\_record\_and\_children}}(reader);}
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00221\ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{if}\ (!reader.\mbox{\hyperlink{classFltRecordReader_a4a9a03bb1929bc88f7eec34da1b6ee9c}{eof}}())\ \{}
\DoxyCodeLine{00224\ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_extra\_data;}
\DoxyCodeLine{00226\ \ \ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{00229\ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00236\ FltError\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{FltHeader::}}}
\DoxyCodeLine{00237\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{write\_flt}}(\mbox{\hyperlink{classFilename}{Filename}}\ filename)\ \{}
\DoxyCodeLine{00238\ \ \ filename.set\_binary();}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ std::ofstream\ out;}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{if}\ (!filename.\mbox{\hyperlink{classFilename_ad37a9d52c837218b01076de184dc5f4d}{open\_write}}(out))\ \{}
\DoxyCodeLine{00242\ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_could\_not\_open;}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \textcolor{preprocessor}{\#ifdef\ HAVE\_ZLIB}}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordflow}{if}\ (filename.get\_extension()\ ==\ \textcolor{stringliteral}{"{}pz"{}})\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{comment}{//\ The\ filename\ ends\ in\ .pz,\ which\ means\ to\ automatically\ compress\ the\ flt}}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{comment}{//\ file\ that\ we\ write.}}
\DoxyCodeLine{00250\ \ \ \ \ OCompressStream\ compressor(\&out,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00251\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{write\_flt}}(compressor);}
\DoxyCodeLine{00252\ \ \ \}}
\DoxyCodeLine{00253\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_ZLIB}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{write\_flt}}(out);}
\DoxyCodeLine{00256\ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00262\ FltError\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{FltHeader::}}}
\DoxyCodeLine{00263\ \mbox{\hyperlink{classFltHeader_ab42cafbb8cb335755b27db8c9a4e8474}{write\_flt}}(std::ostream\ \&out)\ \{}
\DoxyCodeLine{00264\ \ \ \mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ writer(out);}
\DoxyCodeLine{00265\ \ \ FltError\ result\ =\ \mbox{\hyperlink{classFltRecord_a57dfc04ee8d2402d92e44d6657c6cac3}{write\_record\_and\_children}}(writer);}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \textcolor{keywordflow}{if}\ (out.fail())\ \{}
\DoxyCodeLine{00268\ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_write\_error;}
\DoxyCodeLine{00270\ \ \ \}}
\DoxyCodeLine{00271\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00290\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a5b482b061f9a68c8e71c244d3151869b}{FltHeader::}}}
\DoxyCodeLine{00291\ \mbox{\hyperlink{classFltHeader_a5b482b061f9a68c8e71c244d3151869b}{set\_auto\_attr\_update}}(FltHeader::AttrUpdate\ attr)\ \{}
\DoxyCodeLine{00292\ \ \ \_auto\_attr\_update\ =\ attr;}
\DoxyCodeLine{00293\ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00299\ FltHeader::AttrUpdate\ \mbox{\hyperlink{classFltHeader_a579744dd6114892017f4dcc4a7f29dfe}{FltHeader::}}}
\DoxyCodeLine{00300\ \mbox{\hyperlink{classFltHeader_a579744dd6114892017f4dcc4a7f29dfe}{get\_auto\_attr\_update}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{return}\ \_auto\_attr\_update;}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00308\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{FltHeader::}}}
\DoxyCodeLine{00309\ \mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00310\ \ \ \textcolor{keywordflow}{if}\ (\_format\_revision\_level\ <\ 1420)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{return}\ \_format\_revision\_level\ *\ 100;}
\DoxyCodeLine{00312\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordflow}{return}\ \_format\_revision\_level;}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00321\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a60822822bd601c3b540d9512dea8c937}{FltHeader::}}}
\DoxyCodeLine{00322\ \mbox{\hyperlink{classFltHeader_a60822822bd601c3b540d9512dea8c937}{set\_flt\_version}}(\textcolor{keywordtype}{int}\ version)\ \{}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordflow}{if}\ (version\ <\ 14.2)\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \_format\_revision\_level\ =\ version\ /\ 100;}
\DoxyCodeLine{00325\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \_format\_revision\_level\ =\ version;}
\DoxyCodeLine{00327\ \ \ \}}
\DoxyCodeLine{00328\ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00334\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a981cce300505c2d179d4217405e2b176}{FltHeader::}}}
\DoxyCodeLine{00335\ \mbox{\hyperlink{classFltHeader_a981cce300505c2d179d4217405e2b176}{min\_flt\_version}}()\ \{}
\DoxyCodeLine{00336\ \ \ \textcolor{keywordflow}{return}\ 1400;}
\DoxyCodeLine{00337\ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00344\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a090a6a77f54d7744a1b1a646f4d384ca}{FltHeader::}}}
\DoxyCodeLine{00345\ \mbox{\hyperlink{classFltHeader_a090a6a77f54d7744a1b1a646f4d384ca}{max\_flt\_version}}()\ \{}
\DoxyCodeLine{00346\ \ \ \textcolor{keywordflow}{return}\ 1570;}
\DoxyCodeLine{00347\ \}}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00356\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a62063085a5b0877d9aca13719fefafde}{FltHeader::}}}
\DoxyCodeLine{00357\ \mbox{\hyperlink{classFltHeader_a62063085a5b0877d9aca13719fefafde}{check\_version}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00358\ \ \ \textcolor{keywordtype}{int}\ version\ =\ \mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}();}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (version\ <\ \mbox{\hyperlink{classFltHeader_a981cce300505c2d179d4217405e2b176}{min\_flt\_version}}())\ \{}
\DoxyCodeLine{00361\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Warning!\ \ The\ version\ number\ of\ this\ file\ appears\ to\ be\ "{}}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ <<\ version\ /\ 100.0\ <<\ \textcolor{stringliteral}{"{},\ which\ is\ older\ than\ "{}}\ <<\ \mbox{\hyperlink{classFltHeader_a981cce300505c2d179d4217405e2b176}{min\_flt\_version}}()\ /\ 100.0}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ the\ oldest\ OpenFlight\ version\ understood\ by\ this\ program.\ \ "{}}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}It\ is\ unlikely\ that\ this\ program\ will\ be\ able\ to\ read\ the\ file\ "{}}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}correctly.\(\backslash\)n"{}};}
\DoxyCodeLine{00366\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00367\ \ \ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00369\ \ \ \textcolor{keywordflow}{if}\ (version\ >\ \mbox{\hyperlink{classFltHeader_a090a6a77f54d7744a1b1a646f4d384ca}{max\_flt\_version}}())\ \{}
\DoxyCodeLine{00370\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Warning!\ \ The\ version\ number\ of\ this\ file\ appears\ to\ be\ "{}}}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ <<\ version\ /\ 100.0\ <<\ \textcolor{stringliteral}{"{},\ which\ is\ newer\ than\ "{}}\ <<\ \mbox{\hyperlink{classFltHeader_a090a6a77f54d7744a1b1a646f4d384ca}{max\_flt\_version}}()\ /\ 100.0}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{},\ the\ newest\ OpenFlight\ version\ understood\ by\ this\ program.\ \ "{}}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Chances\ are\ good\ that\ the\ program\ will\ still\ be\ able\ to\ read\ it\ "{}}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}correctly,\ but\ any\ features\ in\ the\ file\ that\ are\ specific\ to\ "{}}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{stringliteral}{"{}the\ latest\ version\ of\ OpenFlight\ will\ not\ be\ understood.\(\backslash\)n"{}};}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00377\ \ \ \}}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00380\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00386\ \mbox{\hyperlink{distanceUnit_8h_a4c67a7b952f3804e2bd056cf95c4161a}{DistanceUnit}}\ \mbox{\hyperlink{classFltHeader_a146bfc2912799e2e19b2b01e7893385d}{FltHeader::}}}
\DoxyCodeLine{00387\ \mbox{\hyperlink{classFltHeader_a146bfc2912799e2e19b2b01e7893385d}{get\_units}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00388\ \ \ \textcolor{keywordflow}{switch}\ (\_vertex\_units)\ \{}
\DoxyCodeLine{00389\ \ \ \textcolor{keywordflow}{case}\ FltHeader::U\_meters:}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordflow}{return}\ DU\_meters;}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{case}\ FltHeader::U\_kilometers:}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordflow}{return}\ DU\_kilometers;}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{case}\ FltHeader::U\_feet:}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keywordflow}{return}\ DU\_feet;}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{keywordflow}{case}\ FltHeader::U\_inches:}
\DoxyCodeLine{00399\ \ \ \ \ \textcolor{keywordflow}{return}\ DU\_inches;}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{case}\ FltHeader::U\_nautical\_miles:}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{return}\ DU\_nautical\_miles;}
\DoxyCodeLine{00403\ \ \ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \textcolor{comment}{//\ Unknown\ units.}}
\DoxyCodeLine{00406\ \ \ \textcolor{keywordflow}{return}\ DU\_invalid;}
\DoxyCodeLine{00407\ \}}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00412\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_af3ddeb5caa3cf41753f92b6be9eb42dc}{FltHeader::}}}
\DoxyCodeLine{00413\ \mbox{\hyperlink{classFltHeader_af3ddeb5caa3cf41753f92b6be9eb42dc}{has\_instance}}(\textcolor{keywordtype}{int}\ instance\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00414\ \ \ \textcolor{keywordflow}{return}\ (\_instances.count(instance\_index)\ !=\ 0);}
\DoxyCodeLine{00415\ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00421\ \mbox{\hyperlink{classFltInstanceDefinition}{FltInstanceDefinition}}\ *\mbox{\hyperlink{classFltHeader_aa15da57edad5255f892c06285dc0f8b6}{FltHeader::}}}
\DoxyCodeLine{00422\ \mbox{\hyperlink{classFltHeader_aa15da57edad5255f892c06285dc0f8b6}{get\_instance}}(\textcolor{keywordtype}{int}\ instance\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00423\ \ \ Instances::const\_iterator\ mi;}
\DoxyCodeLine{00424\ \ \ mi\ =\ \_instances.find(instance\_index);}
\DoxyCodeLine{00425\ \ \ \textcolor{keywordflow}{if}\ (mi\ !=\ \_instances.end())\ \{}
\DoxyCodeLine{00426\ \ \ \ \ \textcolor{keywordflow}{return}\ (*mi).second;}
\DoxyCodeLine{00427\ \ \ \}}
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00429\ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00434\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a9674b260aac09bef6518b59e9ec9bb45}{FltHeader::}}}
\DoxyCodeLine{00435\ \mbox{\hyperlink{classFltHeader_a9674b260aac09bef6518b59e9ec9bb45}{clear\_instances}}()\ \{}
\DoxyCodeLine{00436\ \ \ \_instances.clear();}
\DoxyCodeLine{00437\ \}}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00444\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a2d70d109343bd86b2528eae5e5265f1c}{FltHeader::}}}
\DoxyCodeLine{00445\ \mbox{\hyperlink{classFltHeader_a2d70d109343bd86b2528eae5e5265f1c}{add\_instance}}(\mbox{\hyperlink{classFltInstanceDefinition}{FltInstanceDefinition}}\ *instance)\ \{}
\DoxyCodeLine{00446\ \ \ \_instances[instance-\/>\_instance\_index]\ =\ instance;}
\DoxyCodeLine{00447\ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00452\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a9426ae777947478703c87359dc953830}{FltHeader::}}}
\DoxyCodeLine{00453\ \mbox{\hyperlink{classFltHeader_a9426ae777947478703c87359dc953830}{remove\_instance}}(\textcolor{keywordtype}{int}\ instance\_index)\ \{}
\DoxyCodeLine{00454\ \ \ \_instances.erase(instance\_index);}
\DoxyCodeLine{00455\ \}}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00460\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_ad87ebbe1587120f37e439785d623f8e0}{FltHeader::}}}
\DoxyCodeLine{00461\ \mbox{\hyperlink{classFltHeader_ad87ebbe1587120f37e439785d623f8e0}{get\_num\_vertices}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00462\ \ \ \textcolor{keywordflow}{return}\ \_vertices.size();}
\DoxyCodeLine{00463\ \}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00468\ \mbox{\hyperlink{classFltVertex}{FltVertex}}\ *\mbox{\hyperlink{classFltHeader_a84e3b717dd953494665a60009c84ff43}{FltHeader::}}}
\DoxyCodeLine{00469\ \mbox{\hyperlink{classFltHeader_a84e3b717dd953494665a60009c84ff43}{get\_vertex}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00470\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_vertices.size(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{return}\ \_vertices[n];}
\DoxyCodeLine{00472\ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00477\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_acf2c072a55920b2aecf9556feb90c7df}{FltHeader::}}}
\DoxyCodeLine{00478\ \mbox{\hyperlink{classFltHeader_acf2c072a55920b2aecf9556feb90c7df}{clear\_vertices}}()\ \{}
\DoxyCodeLine{00479\ \ \ \_vertices.clear();}
\DoxyCodeLine{00480\ \ \ \_unique\_vertices.clear();}
\DoxyCodeLine{00481\ \ \ \_vertices\_by\_offset.clear();}
\DoxyCodeLine{00482\ \ \ \_offsets\_by\_vertex.clear();}
\DoxyCodeLine{00483\ \ \ \_vertex\_lookups\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00484\ \}}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00490\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a56722f1f418edecedd46e2ba4d9bd89c}{FltHeader::}}}
\DoxyCodeLine{00491\ \mbox{\hyperlink{classFltHeader_a56722f1f418edecedd46e2ba4d9bd89c}{add\_vertex}}(\mbox{\hyperlink{classFltVertex}{FltVertex}}\ *vertex)\ \{}
\DoxyCodeLine{00492\ \ \ \textcolor{keywordtype}{bool}\ inserted\ =\ \_unique\_vertices.insert(vertex).second;}
\DoxyCodeLine{00493\ \ \ \textcolor{keywordflow}{if}\ (inserted)\ \{}
\DoxyCodeLine{00494\ \ \ \ \ \_vertices.push\_back(vertex);}
\DoxyCodeLine{00495\ \ \ \}}
\DoxyCodeLine{00496\ \ \ \_vertex\_lookups\_stale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00497\ \ \ nassertv(\_unique\_vertices.size()\ ==\ \_vertices.size());}
\DoxyCodeLine{00498\ \}}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00505\ \mbox{\hyperlink{classFltVertex}{FltVertex}}\ *\mbox{\hyperlink{classFltHeader_a6d7f7d658340ec1ffa1c47e3abbaaff9}{FltHeader::}}}
\DoxyCodeLine{00506\ \mbox{\hyperlink{classFltHeader_a6d7f7d658340ec1ffa1c47e3abbaaff9}{get\_vertex\_by\_offset}}(\textcolor{keywordtype}{int}\ offset)\ \{}
\DoxyCodeLine{00507\ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_lookups\_stale)\ \{}
\DoxyCodeLine{00508\ \ \ \ \ update\_vertex\_lookups();}
\DoxyCodeLine{00509\ \ \ \}}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ VerticesByOffset::const\_iterator\ vi;}
\DoxyCodeLine{00512\ \ \ vi\ =\ \_vertices\_by\_offset.find(offset);}
\DoxyCodeLine{00513\ \ \ \textcolor{keywordflow}{if}\ (vi\ ==\ \_vertices\_by\_offset.end())\ \{}
\DoxyCodeLine{00514\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}No\ vertex\ with\ offset\ "{}}\ <<\ offset\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00515\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00516\ \ \ \}}
\DoxyCodeLine{00517\ \ \ \textcolor{keywordflow}{return}\ (*vi).second;}
\DoxyCodeLine{00518\ \}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00525\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a25bb4f09fab13118fc90ee674bc3c1db}{FltHeader::}}}
\DoxyCodeLine{00526\ \mbox{\hyperlink{classFltHeader_a25bb4f09fab13118fc90ee674bc3c1db}{get\_offset\_by\_vertex}}(\mbox{\hyperlink{classFltVertex}{FltVertex}}\ *vertex)\ \{}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{if}\ (\_vertex\_lookups\_stale)\ \{}
\DoxyCodeLine{00528\ \ \ \ \ update\_vertex\_lookups();}
\DoxyCodeLine{00529\ \ \ \}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ OffsetsByVertex::const\_iterator\ vi;}
\DoxyCodeLine{00532\ \ \ vi\ =\ \_offsets\_by\_vertex.find(vertex);}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{if}\ (vi\ ==\ \_offsets\_by\_vertex.end())\ \{}
\DoxyCodeLine{00534\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Vertex\ does\ not\ appear\ in\ palette.\(\backslash\)n"{}};}
\DoxyCodeLine{00535\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00536\ \ \ \}}
\DoxyCodeLine{00537\ \ \ \textcolor{keywordflow}{return}\ (*vi).second;}
\DoxyCodeLine{00538\ \}}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00549\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_abc4bd6627f7e1063ea745e9e79974a54}{FltHeader::}}}
\DoxyCodeLine{00550\ \mbox{\hyperlink{classFltHeader_abc4bd6627f7e1063ea745e9e79974a54}{get\_num\_colors}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00551\ \ \ \textcolor{keywordflow}{return}\ \_colors.size()\ *\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}();}
\DoxyCodeLine{00552\ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00558\ LColor\ \mbox{\hyperlink{classFltHeader_a7fcd54f4c876c34ae20a4ff88727510f}{FltHeader::}}}
\DoxyCodeLine{00559\ \mbox{\hyperlink{classFltHeader_a7fcd54f4c876c34ae20a4ff88727510f}{get\_color}}(\textcolor{keywordtype}{int}\ color\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00560\ \ \ nassertr(color\_index\ >=\ 0\ \&\&\ color\_index\ <\ \mbox{\hyperlink{classFltHeader_abc4bd6627f7e1063ea745e9e79974a54}{get\_num\_colors}}(),}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \ LColor(0.0,\ 0.0,\ 0.0,\ 0.0));}
\DoxyCodeLine{00562\ \ \ \textcolor{keywordtype}{int}\ num\_color\_shades\ =\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}();}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ \ \ \textcolor{keywordtype}{int}\ index\ =\ (color\_index\ /\ num\_color\_shades);}
\DoxyCodeLine{00565\ \ \ \textcolor{keywordtype}{int}\ level\ =\ (color\_index\ \%\ num\_color\_shades);}
\DoxyCodeLine{00566\ \ \ nassertr(index\ >=\ 0\ \&\&\ index\ <\ (\textcolor{keywordtype}{int})\_colors.size(),}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ \ \ \ LColor(0.0,\ 0.0,\ 0.0,\ 0.0));}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ LColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ \_colors[index].get\_color();}
\DoxyCodeLine{00570\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcolor}{color}}\ *\ ((double)level\ /\ (\textcolor{keywordtype}{double})(num\_color\_shades\ -\/\ 1));}
\DoxyCodeLine{00571\ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00577\ LRGBColor\ \mbox{\hyperlink{classFltHeader_a8cf60dafe332ef4f88cc290456786a2a}{FltHeader::}}}
\DoxyCodeLine{00578\ \mbox{\hyperlink{classFltHeader_a8cf60dafe332ef4f88cc290456786a2a}{get\_rgb}}(\textcolor{keywordtype}{int}\ color\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00579\ \ \ nassertr(color\_index\ >=\ 0\ \&\&\ color\_index\ <\ \mbox{\hyperlink{classFltHeader_abc4bd6627f7e1063ea745e9e79974a54}{get\_num\_colors}}(),}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ LRGBColor(0.0,\ 0.0,\ 0.0));}
\DoxyCodeLine{00581\ \ \ \textcolor{keywordtype}{int}\ num\_color\_shades\ =\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}();}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keywordtype}{int}\ index\ =\ (color\_index\ /\ num\_color\_shades);}
\DoxyCodeLine{00584\ \ \ \textcolor{keywordtype}{int}\ level\ =\ (color\_index\ \%\ num\_color\_shades);}
\DoxyCodeLine{00585\ \ \ nassertr(index\ >=\ 0\ \&\&\ index\ <\ (\textcolor{keywordtype}{int})\_colors.size(),}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ LRGBColor(0.0,\ 0.0,\ 0.0));}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ LRGBColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ \_colors[index].get\_rgb();}
\DoxyCodeLine{00589\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcolor}{color}}\ *\ ((double)level\ /\ (\textcolor{keywordtype}{double})(num\_color\_shades\ -\/\ 1));}
\DoxyCodeLine{00590\ \}}
\DoxyCodeLine{00591\ }
\DoxyCodeLine{00595\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a6f1c1bc9711cbf013c89713fa3e84847}{FltHeader::}}}
\DoxyCodeLine{00596\ \mbox{\hyperlink{classFltHeader_a6f1c1bc9711cbf013c89713fa3e84847}{has\_color\_name}}(\textcolor{keywordtype}{int}\ color\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00597\ \ \ \textcolor{keywordflow}{return}\ (\_color\_names.count(color\_index)\ !=\ 0);}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00603\ std::string\ \mbox{\hyperlink{classFltHeader_a66bd9ba2994d4219801e16774339e7e5}{FltHeader::}}}
\DoxyCodeLine{00604\ \mbox{\hyperlink{classFltHeader_a66bd9ba2994d4219801e16774339e7e5}{get\_color\_name}}(\textcolor{keywordtype}{int}\ color\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00605\ \ \ ColorNames::const\_iterator\ ni;}
\DoxyCodeLine{00606\ \ \ ni\ =\ \_color\_names.find(color\_index);}
\DoxyCodeLine{00607\ \ \ \textcolor{keywordflow}{if}\ (ni\ !=\ \_color\_names.end())\ \{}
\DoxyCodeLine{00608\ \ \ \ \ \textcolor{keywordflow}{return}\ (*ni).second;}
\DoxyCodeLine{00609\ \ \ \}}
\DoxyCodeLine{00610\ \ \ \textcolor{keywordflow}{return}\ std::string();}
\DoxyCodeLine{00611\ \}}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00617\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_acef8b57a65214c11112216ad11d84c6b}{FltHeader::}}}
\DoxyCodeLine{00618\ \mbox{\hyperlink{classFltHeader_acef8b57a65214c11112216ad11d84c6b}{get\_closest\_color}}(\textcolor{keyword}{const}\ LColor\ \&color0)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00619\ \ \ \textcolor{comment}{//\ Since\ the\ colortable\ stores\ the\ brightest\ colors,\ with\ num\_color\_shades}}
\DoxyCodeLine{00620\ \ \ \textcolor{comment}{//\ scaled\ versions\ of\ each\ color\ implicitly\ available,\ we\ really\ only\ care}}
\DoxyCodeLine{00621\ \ \ \textcolor{comment}{//\ about\ the\ relative\ brightnesses\ of\ the\ various\ components.\ \ Normalize\ the}}
\DoxyCodeLine{00622\ \ \ \textcolor{comment}{//\ color\ in\ terms\ of\ the\ largest\ of\ these.}}
\DoxyCodeLine{00623\ \ \ LColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ color0;}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \textcolor{keywordtype}{double}\ scale\ =\ 1.0;}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[0]\ ==\ 0.0\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[1]\ ==\ 0.0\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[2]\ ==\ 0.0\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[3]\ ==\ 0.0)\ \{}
\DoxyCodeLine{00628\ \ \ \ \ \textcolor{comment}{//\ Oh,\ this\ is\ invisible\ black.}}
\DoxyCodeLine{00629\ \ \ \ \ scale\ =\ 0.0;}
\DoxyCodeLine{00630\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}.set(1.0,\ 1.0,\ 1.0,\ 1.0);}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00633\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[0]\ >=\ \mbox{\hyperlink{structcolor}{color}}[1]\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[0]\ >=\ \mbox{\hyperlink{structcolor}{color}}[2]\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[0]\ >=\ \mbox{\hyperlink{structcolor}{color}}[3])\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \textcolor{comment}{//\ color[0]\ is\ largest.}}
\DoxyCodeLine{00635\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[0];}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[1]\ >=\ \mbox{\hyperlink{structcolor}{color}}[2]\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[1]\ >=\ \mbox{\hyperlink{structcolor}{color}}[3])\ \{}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \textcolor{comment}{//\ color[1]\ is\ largest.}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[1];}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[2]\ >=\ \mbox{\hyperlink{structcolor}{color}}[3])\ \{}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \textcolor{comment}{//\ color[2]\ is\ largest.}}
\DoxyCodeLine{00643\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[2];}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \textcolor{comment}{//\ color[3]\ is\ largest.}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[3];}
\DoxyCodeLine{00648\ \ \ \ \ \}}
\DoxyCodeLine{00649\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ /=\ scale;}
\DoxyCodeLine{00650\ \ \ \}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \textcolor{comment}{//\ Now\ search\ for\ the\ best\ match.}}
\DoxyCodeLine{00653\ \ \ PN\_stdfloat\ best\_dist\ =\ 5.0;\ \ \textcolor{comment}{//\ Greater\ than\ 4.}}
\DoxyCodeLine{00654\ \ \ \textcolor{keywordtype}{int}\ best\_i\ =\ -\/1;}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ \textcolor{keywordtype}{int}\ num\_color\_entries\ =\ \mbox{\hyperlink{classFltHeader_a4f4a6a302e957c9d845d2f43604a8db6}{get\_num\_color\_entries}}();}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_color\_entries;\ i++)\ \{}
\DoxyCodeLine{00658\ \ \ \ \ LColor\ consider\ =\ \_colors[i].get\_color();}
\DoxyCodeLine{00659\ \ \ \ \ PN\_stdfloat\ dist2\ =\ dot(consider\ -\/\ \mbox{\hyperlink{structcolor}{color}},\ consider\ -\/\ \mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{00660\ \ \ \ \ nassertr(dist2\ <\ 5.0,\ 0);}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \ \ \ \ \textcolor{keywordflow}{if}\ (dist2\ <\ best\_dist)\ \{}
\DoxyCodeLine{00663\ \ \ \ \ \ \ best\_dist\ =\ dist2;}
\DoxyCodeLine{00664\ \ \ \ \ \ \ best\_i\ =\ i;}
\DoxyCodeLine{00665\ \ \ \ \ \}}
\DoxyCodeLine{00666\ \ \ \}}
\DoxyCodeLine{00667\ \ \ nassertr(best\_i\ >=\ 0,\ 0);}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \textcolor{keywordtype}{int}\ num\_color\_shades\ =\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}();}
\DoxyCodeLine{00670\ \ \ \textcolor{keywordtype}{int}\ shade\_index\ =\ (int)floor((num\_color\_shades-\/1)\ *\ scale\ +\ 0.5);}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \textcolor{keywordflow}{return}\ (best\_i\ *\ num\_color\_shades)\ +\ shade\_index;}
\DoxyCodeLine{00673\ \}}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00679\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_ab8cb3afc412473351ed7e970bdac27cc}{FltHeader::}}}
\DoxyCodeLine{00680\ \mbox{\hyperlink{classFltHeader_ab8cb3afc412473351ed7e970bdac27cc}{get\_closest\_rgb}}(\textcolor{keyword}{const}\ LRGBColor\ \&color0)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00681\ \ \ \textcolor{comment}{//\ Since\ the\ colortable\ stores\ the\ brightest\ colors,\ with\ num\_color\_shades}}
\DoxyCodeLine{00682\ \ \ \textcolor{comment}{//\ scaled\ versions\ of\ each\ color\ implicitly\ available,\ we\ really\ only\ care}}
\DoxyCodeLine{00683\ \ \ \textcolor{comment}{//\ about\ the\ relative\ brightnesses\ of\ the\ various\ components.\ \ Normalize\ the}}
\DoxyCodeLine{00684\ \ \ \textcolor{comment}{//\ color\ in\ terms\ of\ the\ largest\ of\ these.}}
\DoxyCodeLine{00685\ }
\DoxyCodeLine{00686\ \ \ LRGBColor\ \mbox{\hyperlink{structcolor}{color}}\ =\ color0;}
\DoxyCodeLine{00687\ \ \ \textcolor{keywordtype}{double}\ scale\ =\ 1.0;}
\DoxyCodeLine{00688\ }
\DoxyCodeLine{00689\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[0]\ ==\ 0.0\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[1]\ ==\ 0.0\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[2]\ ==\ 0.0)\ \{}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{comment}{//\ Oh,\ this\ is\ black.}}
\DoxyCodeLine{00691\ \ \ \ \ scale\ =\ 0.0;}
\DoxyCodeLine{00692\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}.set(1.0,\ 1.0,\ 1.0);}
\DoxyCodeLine{00693\ }
\DoxyCodeLine{00694\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00695\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[0]\ >=\ \mbox{\hyperlink{structcolor}{color}}[1]\ \&\&\ \mbox{\hyperlink{structcolor}{color}}[0]\ >=\ \mbox{\hyperlink{structcolor}{color}}[2])\ \{}
\DoxyCodeLine{00696\ \ \ \ \ \ \ \textcolor{comment}{//\ color[0]\ is\ largest.}}
\DoxyCodeLine{00697\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[0];}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structcolor}{color}}[1]\ >=\ \mbox{\hyperlink{structcolor}{color}}[2])\ \{}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \textcolor{comment}{//\ color[1]\ is\ largest.}}
\DoxyCodeLine{00701\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[1];}
\DoxyCodeLine{00702\ }
\DoxyCodeLine{00703\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \textcolor{comment}{//\ color[2]\ is\ largest.}}
\DoxyCodeLine{00705\ \ \ \ \ \ \ scale\ =\ \mbox{\hyperlink{structcolor}{color}}[2];}
\DoxyCodeLine{00706\ \ \ \ \ \}}
\DoxyCodeLine{00707\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ /=\ scale;}
\DoxyCodeLine{00708\ \ \ \}}
\DoxyCodeLine{00709\ }
\DoxyCodeLine{00710\ \ \ \textcolor{comment}{//\ Now\ search\ for\ the\ best\ match.}}
\DoxyCodeLine{00711\ \ \ PN\_stdfloat\ best\_dist\ =\ 5.0;\ \ \textcolor{comment}{//\ Greater\ than\ 4.}}
\DoxyCodeLine{00712\ \ \ \textcolor{keywordtype}{int}\ best\_i\ =\ -\/1;}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ \textcolor{keywordtype}{int}\ num\_color\_entries\ =\ \mbox{\hyperlink{classFltHeader_a4f4a6a302e957c9d845d2f43604a8db6}{get\_num\_color\_entries}}();}
\DoxyCodeLine{00715\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_color\_entries;\ i++)\ \{}
\DoxyCodeLine{00716\ \ \ \ \ LRGBColor\ consider\ =\ \_colors[i].get\_rgb();}
\DoxyCodeLine{00717\ \ \ \ \ PN\_stdfloat\ dist2\ =\ dot(consider\ -\/\ \mbox{\hyperlink{structcolor}{color}},\ consider\ -\/\ \mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{00718\ \ \ \ \ nassertr(dist2\ <\ 5.0,\ 0);}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \textcolor{keywordflow}{if}\ (dist2\ <\ best\_dist)\ \{}
\DoxyCodeLine{00721\ \ \ \ \ \ \ best\_dist\ =\ dist2;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ best\_i\ =\ i;}
\DoxyCodeLine{00723\ \ \ \ \ \}}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ \ \ nassertr(best\_i\ >=\ 0,\ 0);}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ \textcolor{keywordtype}{int}\ num\_color\_shades\ =\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}();}
\DoxyCodeLine{00728\ \ \ \textcolor{keywordtype}{int}\ shade\_index\ =\ (int)floor((num\_color\_shades-\/1)\ *\ scale\ +\ 0.5);}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ \textcolor{keywordflow}{return}\ (best\_i\ *\ num\_color\_shades)\ +\ shade\_index;}
\DoxyCodeLine{00731\ \}}
\DoxyCodeLine{00732\ }
\DoxyCodeLine{00737\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a4f4a6a302e957c9d845d2f43604a8db6}{FltHeader::}}}
\DoxyCodeLine{00738\ \mbox{\hyperlink{classFltHeader_a4f4a6a302e957c9d845d2f43604a8db6}{get\_num\_color\_entries}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00739\ \ \ \textcolor{keywordflow}{return}\ \_colors.size();}
\DoxyCodeLine{00740\ \}}
\DoxyCodeLine{00741\ }
\DoxyCodeLine{00747\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{FltHeader::}}}
\DoxyCodeLine{00748\ \mbox{\hyperlink{classFltHeader_a1d17bde6e5a07b1acdf21dbcb89faf6b}{get\_num\_color\_shades}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00749\ \ \ \textcolor{keywordflow}{return}\ 128;}
\DoxyCodeLine{00750\ \}}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00757\ LColor\ \mbox{\hyperlink{classFltHeader_a7fcd54f4c876c34ae20a4ff88727510f}{FltHeader::}}}
\DoxyCodeLine{00758\ \mbox{\hyperlink{classFltHeader_a7fcd54f4c876c34ae20a4ff88727510f}{get\_color}}(\textcolor{keywordtype}{int}\ color\_index,\ \textcolor{keywordtype}{bool}\ use\_packed\_color,}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFltPackedColor}{FltPackedColor}}\ \&packed\_color,}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ transparency)\ \{}
\DoxyCodeLine{00761\ \ \ \textcolor{keywordflow}{if}\ (!use\_packed\_color)\ \{}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltHeader_a7fcd54f4c876c34ae20a4ff88727510f}{get\_color}}(color\_index);}
\DoxyCodeLine{00763\ \ \ \}}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ LColor\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00766\ \ \ \mbox{\hyperlink{structcolor}{color}}[0]\ =\ packed\_color.\_r\ /\ 255.0;}
\DoxyCodeLine{00767\ \ \ \mbox{\hyperlink{structcolor}{color}}[1]\ =\ packed\_color.\_g\ /\ 255.0;}
\DoxyCodeLine{00768\ \ \ \mbox{\hyperlink{structcolor}{color}}[2]\ =\ packed\_color.\_b\ /\ 255.0;}
\DoxyCodeLine{00769\ \ \ \textcolor{comment}{//\ MultiGen\ doesn't\ yet\ use\ the\ A\ component\ of\ RGBA.\ color[3]\ =}}
\DoxyCodeLine{00770\ \ \ \textcolor{comment}{//\ packed\_color.\_a\ \ 255.0;}}
\DoxyCodeLine{00771\ \ \ \mbox{\hyperlink{structcolor}{color}}[3]\ =\ 1.0\ -\/\ (transparency\ /\ 65535.0);}
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00773\ \}}
\DoxyCodeLine{00774\ }
\DoxyCodeLine{00780\ LRGBColor\ \mbox{\hyperlink{classFltHeader_a8cf60dafe332ef4f88cc290456786a2a}{FltHeader::}}}
\DoxyCodeLine{00781\ \mbox{\hyperlink{classFltHeader_a8cf60dafe332ef4f88cc290456786a2a}{get\_rgb}}(\textcolor{keywordtype}{int}\ color\_index,\ \textcolor{keywordtype}{bool}\ use\_packed\_color,}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFltPackedColor}{FltPackedColor}}\ \&packed\_color)\ \{}
\DoxyCodeLine{00783\ \ \ \textcolor{keywordflow}{if}\ (!use\_packed\_color)\ \{}
\DoxyCodeLine{00784\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltHeader_a8cf60dafe332ef4f88cc290456786a2a}{get\_rgb}}(color\_index);}
\DoxyCodeLine{00785\ \ \ \}}
\DoxyCodeLine{00786\ }
\DoxyCodeLine{00787\ \ \ LRGBColor\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00788\ \ \ \mbox{\hyperlink{structcolor}{color}}[0]\ =\ packed\_color.\_r\ /\ 255.0;}
\DoxyCodeLine{00789\ \ \ \mbox{\hyperlink{structcolor}{color}}[1]\ =\ packed\_color.\_g\ /\ 255.0;}
\DoxyCodeLine{00790\ \ \ \mbox{\hyperlink{structcolor}{color}}[2]\ =\ packed\_color.\_b\ /\ 255.0;}
\DoxyCodeLine{00791\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00792\ \}}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00797\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_ad87c2f826bb6f5982d52505ee733e557}{FltHeader::}}}
\DoxyCodeLine{00798\ \mbox{\hyperlink{classFltHeader_ad87c2f826bb6f5982d52505ee733e557}{has\_material}}(\textcolor{keywordtype}{int}\ material\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00799\ \ \ \textcolor{keywordflow}{return}\ (\_materials.count(material\_index)\ !=\ 0);}
\DoxyCodeLine{00800\ \}}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00806\ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}\ *\mbox{\hyperlink{classFltHeader_a35c8efe2e4895eec96e806718644da3b}{FltHeader::}}}
\DoxyCodeLine{00807\ \mbox{\hyperlink{classFltHeader_a35c8efe2e4895eec96e806718644da3b}{get\_material}}(\textcolor{keywordtype}{int}\ material\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00808\ \ \ Materials::const\_iterator\ mi;}
\DoxyCodeLine{00809\ \ \ mi\ =\ \_materials.find(material\_index);}
\DoxyCodeLine{00810\ \ \ \textcolor{keywordflow}{if}\ (mi\ !=\ \_materials.end())\ \{}
\DoxyCodeLine{00811\ \ \ \ \ \textcolor{keywordflow}{return}\ (*mi).second;}
\DoxyCodeLine{00812\ \ \ \}}
\DoxyCodeLine{00813\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00814\ \}}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00819\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_ac3df89f9079ca16067bc2c8e0ef15465}{FltHeader::}}}
\DoxyCodeLine{00820\ \mbox{\hyperlink{classFltHeader_ac3df89f9079ca16067bc2c8e0ef15465}{clear\_materials}}()\ \{}
\DoxyCodeLine{00821\ \ \ \_materials.clear();}
\DoxyCodeLine{00822\ \}}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00829\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a10ceda800832334d9814829a4ac5487a}{FltHeader::}}}
\DoxyCodeLine{00830\ \mbox{\hyperlink{classFltHeader_a10ceda800832334d9814829a4ac5487a}{add\_material}}(\mbox{\hyperlink{classFltMaterial}{FltMaterial}}\ *material)\ \{}
\DoxyCodeLine{00831\ \ \ \textcolor{keywordflow}{if}\ (material-\/>\_material\_index\ <\ 0)\ \{}
\DoxyCodeLine{00832\ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ make\ up\ a\ new\ material\ index\ for\ the\ material.}}
\DoxyCodeLine{00833\ \ \ \ \ material-\/>\_material\_index\ =\ \_next\_material\_index;}
\DoxyCodeLine{00834\ \ \ \ \ \_next\_material\_index++;}
\DoxyCodeLine{00835\ }
\DoxyCodeLine{00836\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ our\ next\ generated\ material\ index\ will\ be\ different\ from\ any}}
\DoxyCodeLine{00838\ \ \ \ \ \textcolor{comment}{//\ existing\ material\ indices.}}
\DoxyCodeLine{00839\ \ \ \ \ \_next\_material\_index\ =\ std::max(\_next\_material\_index,\ material-\/>\_material\_index\ +\ 1);}
\DoxyCodeLine{00840\ \ \ \}}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \_materials[material-\/>\_material\_index]\ =\ material;}
\DoxyCodeLine{00843\ \}}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00848\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_ab313e279d5ec1208d4a3a129f7cd77f9}{FltHeader::}}}
\DoxyCodeLine{00849\ \mbox{\hyperlink{classFltHeader_ab313e279d5ec1208d4a3a129f7cd77f9}{remove\_material}}(\textcolor{keywordtype}{int}\ material\_index)\ \{}
\DoxyCodeLine{00850\ \ \ \_materials.erase(material\_index);}
\DoxyCodeLine{00851\ \}}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00856\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a466f66b7836bfd2d64cc4486ee1fe917}{FltHeader::}}}
\DoxyCodeLine{00857\ \mbox{\hyperlink{classFltHeader_a466f66b7836bfd2d64cc4486ee1fe917}{has\_texture}}(\textcolor{keywordtype}{int}\ texture\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00858\ \ \ \textcolor{keywordflow}{return}\ (\_textures.count(texture\_index)\ !=\ 0);}
\DoxyCodeLine{00859\ \}}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00865\ \mbox{\hyperlink{classFltTexture}{FltTexture}}\ *\mbox{\hyperlink{classFltHeader_af16342d39403e7209900f40fd1e571da}{FltHeader::}}}
\DoxyCodeLine{00866\ \mbox{\hyperlink{classFltHeader_af16342d39403e7209900f40fd1e571da}{get\_texture}}(\textcolor{keywordtype}{int}\ texture\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00867\ \ \ Textures::const\_iterator\ mi;}
\DoxyCodeLine{00868\ \ \ mi\ =\ \_textures.find(texture\_index);}
\DoxyCodeLine{00869\ \ \ \textcolor{keywordflow}{if}\ (mi\ !=\ \_textures.end())\ \{}
\DoxyCodeLine{00870\ \ \ \ \ \textcolor{keywordflow}{return}\ (*mi).second;}
\DoxyCodeLine{00871\ \ \ \}}
\DoxyCodeLine{00872\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00873\ \}}
\DoxyCodeLine{00874\ }
\DoxyCodeLine{00878\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_aa0ef25316cc78bd99f142a83471759ac}{FltHeader::}}}
\DoxyCodeLine{00879\ \mbox{\hyperlink{classFltHeader_aa0ef25316cc78bd99f142a83471759ac}{clear\_textures}}()\ \{}
\DoxyCodeLine{00880\ \ \ \_textures.clear();}
\DoxyCodeLine{00881\ \}}
\DoxyCodeLine{00882\ }
\DoxyCodeLine{00888\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a5f87cff0c5758fcfbae2d2c328cf06e2}{FltHeader::}}}
\DoxyCodeLine{00889\ \mbox{\hyperlink{classFltHeader_a5f87cff0c5758fcfbae2d2c328cf06e2}{add\_texture}}(\mbox{\hyperlink{classFltTexture}{FltTexture}}\ *texture)\ \{}
\DoxyCodeLine{00890\ \ \ \textcolor{keywordflow}{if}\ (texture-\/>\_pattern\_index\ <\ 0)\ \{}
\DoxyCodeLine{00891\ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ make\ up\ a\ new\ pattern\ index\ for\ the\ texture.}}
\DoxyCodeLine{00892\ \ \ \ \ texture-\/>\_pattern\_index\ =\ \_next\_pattern\_index;}
\DoxyCodeLine{00893\ \ \ \ \ \_next\_pattern\_index++;}
\DoxyCodeLine{00894\ }
\DoxyCodeLine{00895\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00896\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ our\ next\ generated\ pattern\ index\ will\ be\ different\ from\ any}}
\DoxyCodeLine{00897\ \ \ \ \ \textcolor{comment}{//\ existing\ texture\ indices.}}
\DoxyCodeLine{00898\ \ \ \ \ \_next\_pattern\_index\ =\ std::max(\_next\_pattern\_index,\ texture-\/>\_pattern\_index\ +\ 1);}
\DoxyCodeLine{00899\ \ \ \}}
\DoxyCodeLine{00900\ }
\DoxyCodeLine{00901\ \ \ \_textures[texture-\/>\_pattern\_index]\ =\ texture;}
\DoxyCodeLine{00902\ \}}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00907\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_acbe5be16c73830756586d0727b75758e}{FltHeader::}}}
\DoxyCodeLine{00908\ \mbox{\hyperlink{classFltHeader_acbe5be16c73830756586d0727b75758e}{remove\_texture}}(\textcolor{keywordtype}{int}\ texture\_index)\ \{}
\DoxyCodeLine{00909\ \ \ \_textures.erase(texture\_index);}
\DoxyCodeLine{00910\ \}}
\DoxyCodeLine{00911\ }
\DoxyCodeLine{00915\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a4f0b9504243b63751bd13e6d3299dfa7}{FltHeader::}}}
\DoxyCodeLine{00916\ \mbox{\hyperlink{classFltHeader_a4f0b9504243b63751bd13e6d3299dfa7}{has\_light\_source}}(\textcolor{keywordtype}{int}\ light\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00917\ \ \ \textcolor{keywordflow}{return}\ (\_light\_sources.count(light\_index)\ !=\ 0);}
\DoxyCodeLine{00918\ \}}
\DoxyCodeLine{00919\ }
\DoxyCodeLine{00924\ \mbox{\hyperlink{classFltLightSourceDefinition}{FltLightSourceDefinition}}\ *\mbox{\hyperlink{classFltHeader_ac48b0e0e1ab4030059c801da77cd8524}{FltHeader::}}}
\DoxyCodeLine{00925\ \mbox{\hyperlink{classFltHeader_ac48b0e0e1ab4030059c801da77cd8524}{get\_light\_source}}(\textcolor{keywordtype}{int}\ light\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00926\ \ \ LightSources::const\_iterator\ li;}
\DoxyCodeLine{00927\ \ \ li\ =\ \_light\_sources.find(light\_index);}
\DoxyCodeLine{00928\ \ \ \textcolor{keywordflow}{if}\ (li\ !=\ \_light\_sources.end())\ \{}
\DoxyCodeLine{00929\ \ \ \ \ \textcolor{keywordflow}{return}\ (*li).second;}
\DoxyCodeLine{00930\ \ \ \}}
\DoxyCodeLine{00931\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00932\ \}}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00937\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_ad291614fc2861ae8668c43dd3feead7a}{FltHeader::}}}
\DoxyCodeLine{00938\ \mbox{\hyperlink{classFltHeader_ad291614fc2861ae8668c43dd3feead7a}{clear\_light\_sources}}()\ \{}
\DoxyCodeLine{00939\ \ \ \_light\_sources.clear();}
\DoxyCodeLine{00940\ \}}
\DoxyCodeLine{00941\ }
\DoxyCodeLine{00947\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a9f7d238238d57b4e77901c6656d74d08}{FltHeader::}}}
\DoxyCodeLine{00948\ \mbox{\hyperlink{classFltHeader_a9f7d238238d57b4e77901c6656d74d08}{add\_light\_source}}(\mbox{\hyperlink{classFltLightSourceDefinition}{FltLightSourceDefinition}}\ *light\_source)\ \{}
\DoxyCodeLine{00949\ \ \ \_light\_sources[light\_source-\/>\_light\_index]\ =\ light\_source;}
\DoxyCodeLine{00950\ \}}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00956\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_a997274b54e6a469ae682d19aba3c452f}{FltHeader::}}}
\DoxyCodeLine{00957\ \mbox{\hyperlink{classFltHeader_a997274b54e6a469ae682d19aba3c452f}{remove\_light\_source}}(\textcolor{keywordtype}{int}\ light\_index)\ \{}
\DoxyCodeLine{00958\ \ \ \_light\_sources.erase(light\_index);}
\DoxyCodeLine{00959\ \}}
\DoxyCodeLine{00960\ }
\DoxyCodeLine{00966\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_ade1634ed726894749530647c15dc7895}{FltHeader::}}}
\DoxyCodeLine{00967\ \mbox{\hyperlink{classFltHeader_ade1634ed726894749530647c15dc7895}{got\_eyepoint\_trackplane\_palette}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00968\ \ \ \textcolor{keywordflow}{return}\ \_got\_eyepoint\_trackplane\_palette;}
\DoxyCodeLine{00969\ \}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00977\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltHeader_ab6c30fd70140dacc536bbae941ecb910}{FltHeader::}}}
\DoxyCodeLine{00978\ \mbox{\hyperlink{classFltHeader_ab6c30fd70140dacc536bbae941ecb910}{set\_eyepoint\_trackplane\_palette}}(\textcolor{keywordtype}{bool}\ flag)\ \{}
\DoxyCodeLine{00979\ \ \ \_got\_eyepoint\_trackplane\_palette\ =\ flag;}
\DoxyCodeLine{00980\ \}}
\DoxyCodeLine{00981\ }
\DoxyCodeLine{00986\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_a32d41c2de9bbbe0a2637e4de0804c6cc}{FltHeader::}}}
\DoxyCodeLine{00987\ \mbox{\hyperlink{classFltHeader_a32d41c2de9bbbe0a2637e4de0804c6cc}{get\_num\_eyepoints}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00988\ \ \ \textcolor{keywordflow}{return}\ 10;}
\DoxyCodeLine{00989\ \}}
\DoxyCodeLine{00990\ }
\DoxyCodeLine{00994\ \mbox{\hyperlink{classFltEyepoint}{FltEyepoint}}\ *\mbox{\hyperlink{classFltHeader_a4be030a951cb13a9f9893a79dbe3f040}{FltHeader::}}}
\DoxyCodeLine{00995\ \mbox{\hyperlink{classFltHeader_a4be030a951cb13a9f9893a79dbe3f040}{get\_eyepoint}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{00996\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ \mbox{\hyperlink{classFltHeader_a32d41c2de9bbbe0a2637e4de0804c6cc}{get\_num\_eyepoints}}(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00997\ \ \ \textcolor{keywordflow}{return}\ \&\_eyepoints[n];}
\DoxyCodeLine{00998\ \}}
\DoxyCodeLine{00999\ }
\DoxyCodeLine{01004\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltHeader_acd16faca18682126f0fae1061b7cca69}{FltHeader::}}}
\DoxyCodeLine{01005\ \mbox{\hyperlink{classFltHeader_acd16faca18682126f0fae1061b7cca69}{get\_num\_trackplanes}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01006\ \ \ \textcolor{keywordflow}{return}\ 10;}
\DoxyCodeLine{01007\ \}}
\DoxyCodeLine{01008\ }
\DoxyCodeLine{01012\ \mbox{\hyperlink{classFltTrackplane}{FltTrackplane}}\ *\mbox{\hyperlink{classFltHeader_a9857f78fd7b891460708d42e58e63eb4}{FltHeader::}}}
\DoxyCodeLine{01013\ \mbox{\hyperlink{classFltHeader_a9857f78fd7b891460708d42e58e63eb4}{get\_trackplane}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{01014\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ \mbox{\hyperlink{classFltHeader_acd16faca18682126f0fae1061b7cca69}{get\_num\_trackplanes}}(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{01015\ \ \ \textcolor{keywordflow}{return}\ \&\_trackplanes[n];}
\DoxyCodeLine{01016\ \}}
\DoxyCodeLine{01017\ }
\DoxyCodeLine{01026\ \textcolor{keywordtype}{int}\ FltHeader::}
\DoxyCodeLine{01027\ update\_vertex\_lookups()\ \{}
\DoxyCodeLine{01028\ \ \ \textcolor{comment}{//\ We\ start\ with\ the\ length\ of\ the\ vertex\ palette\ record\ itself.}}
\DoxyCodeLine{01029\ \ \ \textcolor{keywordtype}{int}\ offset\ =\ 8;}
\DoxyCodeLine{01030\ }
\DoxyCodeLine{01031\ \ \ Vertices::const\_iterator\ vi;}
\DoxyCodeLine{01032\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{01033\ \ \ \ \ \mbox{\hyperlink{classFltVertex}{FltVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{01034\ }
\DoxyCodeLine{01035\ \ \ \ \ \_offsets\_by\_vertex[vertex]\ =\ offset;}
\DoxyCodeLine{01036\ \ \ \ \ \_vertices\_by\_offset[offset]\ =\ vertex;}
\DoxyCodeLine{01037\ \ \ \ \ offset\ +=\ vertex-\/>\mbox{\hyperlink{classFltVertex_a0cd3bf28e724a754b97d614561b33c19}{get\_record\_length}}();}
\DoxyCodeLine{01038\ \ \ \}}
\DoxyCodeLine{01039\ }
\DoxyCodeLine{01040\ \ \ \_vertex\_lookups\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01041\ }
\DoxyCodeLine{01042\ \ \ \textcolor{keywordflow}{return}\ offset;}
\DoxyCodeLine{01043\ \}}
\DoxyCodeLine{01044\ }
\DoxyCodeLine{01050\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a4fe84fb5c1772989389d56b08688d605}{FltHeader::}}}
\DoxyCodeLine{01051\ \mbox{\hyperlink{classFltHeader_a4fe84fb5c1772989389d56b08688d605}{extract\_record}}(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01052\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFltBeadID_af96b9be03843db7c55d832fd9f7f86f3}{FltBeadID::extract\_record}}(reader))\ \{}
\DoxyCodeLine{01053\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01054\ \ \ \}}
\DoxyCodeLine{01055\ }
\DoxyCodeLine{01056\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_header,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01057\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{01058\ }
\DoxyCodeLine{01059\ \ \ \_format\_revision\_level\ =\ iterator.get\_be\_int32();}
\DoxyCodeLine{01060\ \ \ \_edit\_revision\_level\ =\ iterator.get\_be\_int32();}
\DoxyCodeLine{01061\ \ \ \_last\_revision\ =\ iterator.\mbox{\hyperlink{classDatagramIterator_aa0038f71ae865a3dc7d3d93f72491b95}{get\_fixed\_string}}(32);}
\DoxyCodeLine{01062\ \ \ \_next\_group\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01063\ \ \ \_next\_lod\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01064\ \ \ \_next\_object\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01065\ \ \ \_next\_face\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01066\ \ \ \_unit\_multiplier\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01067\ \ \ \_vertex\_units\ =\ (Units)iterator.get\_int8();}
\DoxyCodeLine{01068\ \ \ \_texwhite\_new\ =\ (iterator.get\_int8()\ !=\ 0);}
\DoxyCodeLine{01069\ \ \ \_flags\ =\ iterator.get\_be\_uint32();}
\DoxyCodeLine{01070\ \ \ iterator.skip\_bytes(24);}
\DoxyCodeLine{01071\ \ \ \_projection\_type\ =\ (ProjectionType)iterator.get\_be\_int32();}
\DoxyCodeLine{01072\ \ \ iterator.skip\_bytes(28);}
\DoxyCodeLine{01073\ \ \ \_next\_dof\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01074\ \ \ \_vertex\_storage\_type\ =\ (VertexStorageType)iterator.get\_be\_int16();}
\DoxyCodeLine{01075\ \ \ \_database\_origin\ =\ (DatabaseOrigin)iterator.get\_be\_int32();}
\DoxyCodeLine{01076\ \ \ \_sw\_x\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01077\ \ \ \_sw\_y\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01078\ \ \ \_delta\_x\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01079\ \ \ \_delta\_y\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01080\ \ \ \_next\_sound\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01081\ \ \ \_next\_path\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01082\ \ \ iterator.skip\_bytes(8);}
\DoxyCodeLine{01083\ \ \ \_next\_clip\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01084\ \ \ \_next\_text\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01085\ \ \ \_next\_bsp\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01086\ \ \ \_next\_switch\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01087\ \ \ iterator.skip\_bytes(4);}
\DoxyCodeLine{01088\ \ \ \_sw\_lat\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01089\ \ \ \_sw\_long\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01090\ \ \ \_ne\_lat\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01091\ \ \ \_ne\_long\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01092\ \ \ \_origin\_lat\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01093\ \ \ \_origin\_long\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01094\ \ \ \_lambert\_upper\_lat\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01095\ \ \ \_lambert\_lower\_lat\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01096\ \ \ \_next\_light\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01097\ \ \ iterator.skip\_bytes(2);}
\DoxyCodeLine{01098\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1420\ \&\&\ iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01099\ \ \ \ \ \_next\_road\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01100\ \ \ \ \ \_next\_cat\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1520\ \&\&\ iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01103\ \ \ \ \ \ \ iterator.skip\_bytes(2\ +\ 2\ +\ 2\ +\ 2);}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \_earth\_model\ =\ (EarthModel)iterator.get\_be\_int32();}
\DoxyCodeLine{01105\ }
\DoxyCodeLine{01106\ \ \ \ \ \ \ \textcolor{comment}{//\ Undocumented\ padding.}}
\DoxyCodeLine{01107\ \ \ \ \ \ \ iterator.skip\_bytes(4);}
\DoxyCodeLine{01108\ }
\DoxyCodeLine{01109\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1560\ \&\&\ iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \_next\_adaptive\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \_next\_curve\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ iterator.skip\_bytes(4);}
\DoxyCodeLine{01113\ }
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1570\ \&\&\ iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ \_delta\_z\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \_radius\ =\ iterator.get\_be\_float64();}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \_next\_mesh\_id\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ iterator.skip\_bytes(2);}
\DoxyCodeLine{01119\ }
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Undocumented\ padding.}}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \ \ iterator.skip\_bytes(4);}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01124\ \ \ \ \ \}}
\DoxyCodeLine{01125\ \ \ \}}
\DoxyCodeLine{01126\ }
\DoxyCodeLine{01127\ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator);}
\DoxyCodeLine{01128\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01129\ \}}
\DoxyCodeLine{01130\ }
\DoxyCodeLine{01136\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_ad8d0caf9af10b588a48c3a75ad3435ff}{FltHeader::}}}
\DoxyCodeLine{01137\ \mbox{\hyperlink{classFltHeader_ad8d0caf9af10b588a48c3a75ad3435ff}{extract\_ancillary}}(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01138\ \ \ \textcolor{keywordflow}{switch}\ (reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}())\ \{}
\DoxyCodeLine{01139\ \ \ \textcolor{keywordflow}{case}\ FO\_vertex\_palette:}
\DoxyCodeLine{01140\ \ \ \ \ \textcolor{comment}{//\ We're\ about\ to\ begin\ the\ vertex\ palette!}}
\DoxyCodeLine{01141\ \ \ \ \ \mbox{\hyperlink{classFltHeader_acf2c072a55920b2aecf9556feb90c7df}{clear\_vertices}}();}
\DoxyCodeLine{01142\ \ \ \ \ \_current\_vertex\_offset\ =\ reader.\mbox{\hyperlink{classFltRecordReader_a6b40ca800805a50ade7098e373f305ae}{get\_record\_length}}();}
\DoxyCodeLine{01143\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01144\ }
\DoxyCodeLine{01145\ \ \ \textcolor{keywordflow}{case}\ FO\_vertex\_c:}
\DoxyCodeLine{01146\ \ \ \textcolor{keywordflow}{case}\ FO\_vertex\_cn:}
\DoxyCodeLine{01147\ \ \ \textcolor{keywordflow}{case}\ FO\_vertex\_cnu:}
\DoxyCodeLine{01148\ \ \ \textcolor{keywordflow}{case}\ FO\_vertex\_cu:}
\DoxyCodeLine{01149\ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ new\ vertex\ for\ the\ palette.}}
\DoxyCodeLine{01150\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_vertex(reader);}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01152\ \ \ \textcolor{keywordflow}{case}\ FO\_color\_palette:}
\DoxyCodeLine{01153\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_color\_palette(reader);}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \textcolor{keywordflow}{case}\ FO\_15\_material:}
\DoxyCodeLine{01156\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_material(reader);}
\DoxyCodeLine{01157\ }
\DoxyCodeLine{01158\ \ \ \textcolor{keywordflow}{case}\ FO\_14\_material\_palette:}
\DoxyCodeLine{01159\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_14\_material\_palette(reader);}
\DoxyCodeLine{01160\ }
\DoxyCodeLine{01161\ \ \ \textcolor{keywordflow}{case}\ FO\_texture:}
\DoxyCodeLine{01162\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_texture(reader);}
\DoxyCodeLine{01163\ }
\DoxyCodeLine{01164\ \ \ \textcolor{keywordflow}{case}\ FO\_texture\_map\_palette:}
\DoxyCodeLine{01165\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_texture\_map(reader);}
\DoxyCodeLine{01166\ }
\DoxyCodeLine{01167\ \ \ \textcolor{keywordflow}{case}\ FO\_light\_definition:}
\DoxyCodeLine{01168\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_light\_source(reader);}
\DoxyCodeLine{01169\ }
\DoxyCodeLine{01170\ \ \ \textcolor{keywordflow}{case}\ FO\_eyepoint\_palette:}
\DoxyCodeLine{01171\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_eyepoint\_palette(reader);}
\DoxyCodeLine{01172\ }
\DoxyCodeLine{01173\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01174\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltBeadID_ad0b4e4c3735f5038198d4be4228ad923}{FltBeadID::extract\_ancillary}}(reader);}
\DoxyCodeLine{01175\ \ \ \}}
\DoxyCodeLine{01176\ \}}
\DoxyCodeLine{01177\ }
\DoxyCodeLine{01183\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltHeader_a2016717916edacd1d73aedecff5bdc37}{FltHeader::}}}
\DoxyCodeLine{01184\ \mbox{\hyperlink{classFltHeader_a2016717916edacd1d73aedecff5bdc37}{build\_record}}(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01185\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFltBeadID_a1c0c52f9634921598f2df0b3eb2a33b1}{FltBeadID::build\_record}}(writer))\ \{}
\DoxyCodeLine{01186\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01187\ \ \ \}}
\DoxyCodeLine{01188\ }
\DoxyCodeLine{01189\ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_header);}
\DoxyCodeLine{01190\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{01191\ }
\DoxyCodeLine{01192\ \ \ datagram.add\_be\_int32(\_format\_revision\_level);}
\DoxyCodeLine{01193\ \ \ datagram.add\_be\_int32(\_edit\_revision\_level);}
\DoxyCodeLine{01194\ \ \ datagram.add\_fixed\_string(\_last\_revision,\ 32);}
\DoxyCodeLine{01195\ \ \ datagram.add\_be\_int16(\_next\_group\_id);}
\DoxyCodeLine{01196\ \ \ datagram.add\_be\_int16(\_next\_lod\_id);}
\DoxyCodeLine{01197\ \ \ datagram.add\_be\_int16(\_next\_object\_id);}
\DoxyCodeLine{01198\ \ \ datagram.add\_be\_int16(\_next\_face\_id);}
\DoxyCodeLine{01199\ \ \ datagram.add\_be\_int16(\_unit\_multiplier);}
\DoxyCodeLine{01200\ \ \ datagram.add\_int8(\_vertex\_units);}
\DoxyCodeLine{01201\ \ \ datagram.add\_int8(\_texwhite\_new);}
\DoxyCodeLine{01202\ \ \ datagram.add\_be\_uint32(\_flags);}
\DoxyCodeLine{01203\ \ \ datagram.pad\_bytes(24);}
\DoxyCodeLine{01204\ \ \ datagram.add\_be\_int32(\_projection\_type);}
\DoxyCodeLine{01205\ \ \ datagram.pad\_bytes(28);}
\DoxyCodeLine{01206\ \ \ datagram.add\_be\_int16(\_next\_dof\_id);}
\DoxyCodeLine{01207\ \ \ datagram.add\_be\_int16(\_vertex\_storage\_type);}
\DoxyCodeLine{01208\ \ \ datagram.add\_be\_int32(\_database\_origin);}
\DoxyCodeLine{01209\ \ \ datagram.add\_be\_float64(\_sw\_x);}
\DoxyCodeLine{01210\ \ \ datagram.add\_be\_float64(\_sw\_y);}
\DoxyCodeLine{01211\ \ \ datagram.add\_be\_float64(\_delta\_x);}
\DoxyCodeLine{01212\ \ \ datagram.add\_be\_float64(\_delta\_y);}
\DoxyCodeLine{01213\ \ \ datagram.add\_be\_int16(\_next\_sound\_id);}
\DoxyCodeLine{01214\ \ \ datagram.add\_be\_int16(\_next\_path\_id);}
\DoxyCodeLine{01215\ \ \ datagram.pad\_bytes(8);}
\DoxyCodeLine{01216\ \ \ datagram.add\_be\_int16(\_next\_clip\_id);}
\DoxyCodeLine{01217\ \ \ datagram.add\_be\_int16(\_next\_text\_id);}
\DoxyCodeLine{01218\ \ \ datagram.add\_be\_int16(\_next\_bsp\_id);}
\DoxyCodeLine{01219\ \ \ datagram.add\_be\_int16(\_next\_switch\_id);}
\DoxyCodeLine{01220\ \ \ datagram.pad\_bytes(4);}
\DoxyCodeLine{01221\ \ \ datagram.add\_be\_float64(\_sw\_lat);}
\DoxyCodeLine{01222\ \ \ datagram.add\_be\_float64(\_sw\_long);}
\DoxyCodeLine{01223\ \ \ datagram.add\_be\_float64(\_ne\_lat);}
\DoxyCodeLine{01224\ \ \ datagram.add\_be\_float64(\_ne\_long);}
\DoxyCodeLine{01225\ \ \ datagram.add\_be\_float64(\_origin\_lat);}
\DoxyCodeLine{01226\ \ \ datagram.add\_be\_float64(\_origin\_long);}
\DoxyCodeLine{01227\ \ \ datagram.add\_be\_float64(\_lambert\_upper\_lat);}
\DoxyCodeLine{01228\ \ \ datagram.add\_be\_float64(\_lambert\_lower\_lat);}
\DoxyCodeLine{01229\ \ \ datagram.add\_be\_int16(\_next\_light\_id);}
\DoxyCodeLine{01230\ \ \ datagram.pad\_bytes(2);}
\DoxyCodeLine{01231\ \ \ datagram.add\_be\_int16(\_next\_road\_id);}
\DoxyCodeLine{01232\ \ \ datagram.add\_be\_int16(\_next\_cat\_id);}
\DoxyCodeLine{01233\ }
\DoxyCodeLine{01234\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1520)\ \{}
\DoxyCodeLine{01235\ \ \ \ \ \textcolor{comment}{//\ New\ with\ 15.2}}
\DoxyCodeLine{01236\ \ \ \ \ datagram.pad\_bytes(2\ +\ 2\ +\ 2\ +\ 2);}
\DoxyCodeLine{01237\ \ \ \ \ datagram.add\_be\_int32(\_earth\_model);}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ datagram.pad\_bytes(4);}
\DoxyCodeLine{01240\ }
\DoxyCodeLine{01241\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1560)\ \{}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \textcolor{comment}{//\ New\ with\ 15.6}}
\DoxyCodeLine{01243\ \ \ \ \ \ \ datagram.add\_be\_int16(\_next\_adaptive\_id);}
\DoxyCodeLine{01244\ \ \ \ \ \ \ datagram.add\_be\_int16(\_next\_curve\_id);}
\DoxyCodeLine{01245\ \ \ \ \ \ \ datagram.pad\_bytes(4);}
\DoxyCodeLine{01246\ }
\DoxyCodeLine{01247\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1570)\ \{}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ New\ with\ 15.7}}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ datagram.add\_be\_float64(\_delta\_z);}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ datagram.add\_be\_float64(\_radius);}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ datagram.add\_be\_int16(\_next\_mesh\_id);}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ datagram.pad\_bytes(2);}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \ \ datagram.pad\_bytes(4);}
\DoxyCodeLine{01254\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01255\ \ \ \ \ \}}
\DoxyCodeLine{01256\ \ \ \}}
\DoxyCodeLine{01257\ }
\DoxyCodeLine{01258\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01259\ \}}
\DoxyCodeLine{01260\ }
\DoxyCodeLine{01265\ FltError\ \mbox{\hyperlink{classFltHeader_ad4f9ca5e54182c2fd596b4721737425e}{FltHeader::}}}
\DoxyCodeLine{01266\ \mbox{\hyperlink{classFltHeader_ad4f9ca5e54182c2fd596b4721737425e}{write\_ancillary}}(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01267\ \ \ FltError\ result;}
\DoxyCodeLine{01268\ }
\DoxyCodeLine{01269\ \ \ result\ =\ write\_color\_palette(writer);}
\DoxyCodeLine{01270\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01271\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01272\ \ \ \}}
\DoxyCodeLine{01273\ }
\DoxyCodeLine{01274\ \ \ result\ =\ write\_material\_palette(writer);}
\DoxyCodeLine{01275\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01276\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01277\ \ \ \}}
\DoxyCodeLine{01278\ }
\DoxyCodeLine{01279\ \ \ result\ =\ write\_texture\_palette(writer);}
\DoxyCodeLine{01280\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01281\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01282\ \ \ \}}
\DoxyCodeLine{01283\ }
\DoxyCodeLine{01284\ \ \ result\ =\ write\_light\_source\_palette(writer);}
\DoxyCodeLine{01285\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01286\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01287\ \ \ \}}
\DoxyCodeLine{01288\ }
\DoxyCodeLine{01289\ \ \ result\ =\ write\_eyepoint\_palette(writer);}
\DoxyCodeLine{01290\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01291\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01292\ \ \ \}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \ \ result\ =\ write\_vertex\_palette(writer);}
\DoxyCodeLine{01295\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01296\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01297\ \ \ \}}
\DoxyCodeLine{01298\ }
\DoxyCodeLine{01299\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltBeadID_a70169d6c8d4db5a84daa244d25b19ce7}{FltBeadID::write\_ancillary}}(writer);}
\DoxyCodeLine{01300\ \}}
\DoxyCodeLine{01301\ }
\DoxyCodeLine{01306\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01307\ extract\_vertex(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01308\ \ \ \mbox{\hyperlink{classFltVertex}{FltVertex}}\ *vertex\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltVertex}{FltVertex}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01309\ \ \ \textcolor{keywordflow}{if}\ (!vertex-\/>\mbox{\hyperlink{classFltVertex_a00211a399590c8ac78ad56393dd32db4}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{01310\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01311\ \ \ \}}
\DoxyCodeLine{01312\ \ \ \_vertices.push\_back(vertex);}
\DoxyCodeLine{01313\ \ \ \_unique\_vertices.insert(vertex);}
\DoxyCodeLine{01314\ \ \ \_offsets\_by\_vertex[vertex]\ =\ \_current\_vertex\_offset;}
\DoxyCodeLine{01315\ \ \ \_vertices\_by\_offset[\_current\_vertex\_offset]\ =\ vertex;}
\DoxyCodeLine{01316\ \ \ \_current\_vertex\_offset\ +=\ reader.\mbox{\hyperlink{classFltRecordReader_a6b40ca800805a50ade7098e373f305ae}{get\_record\_length}}();}
\DoxyCodeLine{01317\ }
\DoxyCodeLine{01318\ \ \ \textcolor{comment}{//\ \_vertex\_lookups\_stale\ remains\ false.}}
\DoxyCodeLine{01319\ }
\DoxyCodeLine{01320\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01321\ \}}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01326\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01327\ extract\_color\_palette(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01328\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_color\_palette,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01329\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{01330\ }
\DoxyCodeLine{01331\ \ \ \textcolor{keywordflow}{if}\ (\_got\_color\_palette)\ \{}
\DoxyCodeLine{01332\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Warning:\ multiple\ color\ palettes\ found.\(\backslash\)n"{}};}
\DoxyCodeLine{01333\ \ \ \}}
\DoxyCodeLine{01334\ \ \ \_got\_color\_palette\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01335\ }
\DoxyCodeLine{01336\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ expected\_color\_entries\ =\ 1024;}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \ \ iterator.skip\_bytes(128);}
\DoxyCodeLine{01339\ \ \ \_colors.clear();}
\DoxyCodeLine{01340\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ expected\_color\_entries;\ i++)\ \{}
\DoxyCodeLine{01341\ \ \ \ \ \textcolor{keywordflow}{if}\ (iterator.get\_remaining\_size()\ ==\ 0)\ \{}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \textcolor{comment}{//\ An\ early\ end\ to\ the\ palette\ is\ acceptable.}}
\DoxyCodeLine{01343\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01344\ \ \ \ \ \}}
\DoxyCodeLine{01345\ \ \ \ \ \mbox{\hyperlink{classFltPackedColor}{FltPackedColor}}\ \mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{01346\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structcolor}{color}}.extract\_record(reader))\ \{}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01348\ \ \ \ \ \}}
\DoxyCodeLine{01349\ \ \ \ \ \_colors.push\_back(\mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{01350\ \ \ \}}
\DoxyCodeLine{01351\ }
\DoxyCodeLine{01352\ \ \ \textcolor{comment}{//\ Now\ pull\ out\ the\ color\ names.}}
\DoxyCodeLine{01353\ \ \ \textcolor{keywordflow}{while}\ (iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01354\ \ \ \ \ \textcolor{keywordtype}{int}\ entry\_length\ =\ iterator.get\_be\_uint16();}
\DoxyCodeLine{01355\ \ \ \ \ iterator.skip\_bytes(2);}
\DoxyCodeLine{01356\ \ \ \ \ \textcolor{keywordflow}{if}\ (iterator.get\_remaining\_size()\ >\ 0)\ \{}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ color\_index\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{01358\ \ \ \ \ \ \ iterator.skip\_bytes(2);}
\DoxyCodeLine{01359\ }
\DoxyCodeLine{01360\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ name\_length\ =\ entry\_length\ -\/\ 8;}
\DoxyCodeLine{01361\ \ \ \ \ \ \ nassertr(color\_index\ >=\ 0\ \&\&\ color\_index\ <\ (\textcolor{keywordtype}{int})\_colors.size(),\ \textcolor{keyword}{false});}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \_color\_names[color\_index]\ =\ iterator.\mbox{\hyperlink{classDatagramIterator_aa0038f71ae865a3dc7d3d93f72491b95}{get\_fixed\_string}}(name\_length);}
\DoxyCodeLine{01363\ \ \ \ \ \}}
\DoxyCodeLine{01364\ \ \ \}}
\DoxyCodeLine{01365\ }
\DoxyCodeLine{01366\ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator,\ \textcolor{stringliteral}{"{}color\ palette"{}});}
\DoxyCodeLine{01367\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01368\ \}}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01373\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01374\ extract\_material(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01375\ \ \ PT(\mbox{\hyperlink{classFltMaterial}{FltMaterial}})\ material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01376\ \ \ \textcolor{keywordflow}{if}\ (!material-\/>extract\_record(reader))\ \{}
\DoxyCodeLine{01377\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01378\ \ \ \}}
\DoxyCodeLine{01379\ \ \ \mbox{\hyperlink{classFltHeader_a10ceda800832334d9814829a4ac5487a}{add\_material}}(material);}
\DoxyCodeLine{01380\ }
\DoxyCodeLine{01381\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01382\ \}}
\DoxyCodeLine{01383\ }
\DoxyCodeLine{01387\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01388\ extract\_14\_material\_palette(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01389\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_14\_material\_palette,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01390\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \ \ \textcolor{keywordflow}{if}\ (\_got\_14\_material\_palette)\ \{}
\DoxyCodeLine{01393\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Warning:\ multiple\ material\ palettes\ found.\(\backslash\)n"{}};}
\DoxyCodeLine{01394\ \ \ \}}
\DoxyCodeLine{01395\ \ \ \_got\_14\_material\_palette\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01396\ }
\DoxyCodeLine{01397\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ expected\_material\_entries\ =\ 64;}
\DoxyCodeLine{01398\ }
\DoxyCodeLine{01399\ \ \ \_materials.clear();}
\DoxyCodeLine{01400\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ expected\_material\_entries;\ i++)\ \{}
\DoxyCodeLine{01401\ \ \ \ \ \textcolor{keywordflow}{if}\ (iterator.get\_remaining\_size()\ ==\ 0)\ \{}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \textcolor{comment}{//\ An\ early\ end\ to\ the\ palette\ is\ acceptable.}}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01404\ \ \ \ \ \}}
\DoxyCodeLine{01405\ \ \ \ \ PT(\mbox{\hyperlink{classFltMaterial}{FltMaterial}})\ material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01406\ \ \ \ \ \textcolor{keywordflow}{if}\ (!material-\/>extract\_14\_record(i,\ iterator))\ \{}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01408\ \ \ \ \ \}}
\DoxyCodeLine{01409\ \ \ \ \ \mbox{\hyperlink{classFltHeader_a10ceda800832334d9814829a4ac5487a}{add\_material}}(material);}
\DoxyCodeLine{01410\ \ \ \}}
\DoxyCodeLine{01411\ }
\DoxyCodeLine{01412\ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator,\ \textcolor{stringliteral}{"{}material\ palette"{}});}
\DoxyCodeLine{01413\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01414\ \}}
\DoxyCodeLine{01415\ }
\DoxyCodeLine{01419\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01420\ extract\_texture(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01421\ \ \ \mbox{\hyperlink{classFltTexture}{FltTexture}}\ *texture\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTexture}{FltTexture}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01422\ \ \ \textcolor{keywordflow}{if}\ (!texture-\/>extract\_record(reader))\ \{}
\DoxyCodeLine{01423\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01424\ \ \ \}}
\DoxyCodeLine{01425\ \ \ \mbox{\hyperlink{classFltHeader_a5f87cff0c5758fcfbae2d2c328cf06e2}{add\_texture}}(texture);}
\DoxyCodeLine{01426\ }
\DoxyCodeLine{01427\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01428\ \}}
\DoxyCodeLine{01429\ }
\DoxyCodeLine{01434\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01435\ extract\_texture\_map(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01436\ \ \ \textcolor{comment}{//\ At\ the\ moment,\ we\ ignore\ this,\ since\ it's\ not\ needed\ for\ meaningful}}
\DoxyCodeLine{01437\ \ \ \textcolor{comment}{//\ extraction\ of\ data:\ we\ can\ get\ this\ information\ from\ the\ UV's\ for\ a}}
\DoxyCodeLine{01438\ \ \ \textcolor{comment}{//\ particular\ model.\ \ We\ just\ add\ an\ UnsupportedRecord\ for\ it.}}
\DoxyCodeLine{01439\ \ \ \mbox{\hyperlink{classFltUnsupportedRecord}{FltUnsupportedRecord}}\ *rec\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltUnsupportedRecord}{FltUnsupportedRecord}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01440\ \ \ \textcolor{keywordflow}{if}\ (!rec-\/>\mbox{\hyperlink{classFltUnsupportedRecord_a92fbd876e9854dc3c0aa53112f17717f}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{01441\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01442\ \ \ \}}
\DoxyCodeLine{01443\ \ \ \mbox{\hyperlink{classFltRecord_aced710ccfadb8df96a76219eb32cd439}{add\_ancillary}}(rec);}
\DoxyCodeLine{01444\ }
\DoxyCodeLine{01445\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01446\ \}}
\DoxyCodeLine{01447\ }
\DoxyCodeLine{01451\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01452\ extract\_light\_source(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01453\ \ \ \mbox{\hyperlink{classFltLightSourceDefinition}{FltLightSourceDefinition}}\ *light\_source\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltLightSourceDefinition}{FltLightSourceDefinition}}(\textcolor{keyword}{this});}
\DoxyCodeLine{01454\ \ \ \textcolor{keywordflow}{if}\ (!light\_source-\/>\mbox{\hyperlink{classFltLightSourceDefinition_ad2a0f6df820ac80c6f834b3cbf4d9b9b}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{01455\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01456\ \ \ \}}
\DoxyCodeLine{01457\ \ \ \mbox{\hyperlink{classFltHeader_a9f7d238238d57b4e77901c6656d74d08}{add\_light\_source}}(light\_source);}
\DoxyCodeLine{01458\ }
\DoxyCodeLine{01459\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01460\ \}}
\DoxyCodeLine{01461\ }
\DoxyCodeLine{01465\ \textcolor{keywordtype}{bool}\ FltHeader::}
\DoxyCodeLine{01466\ extract\_eyepoint\_palette(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{01467\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_eyepoint\_palette,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01468\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ iterator.skip\_bytes(4);}
\DoxyCodeLine{01471\ }
\DoxyCodeLine{01472\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{01473\ \ \ \textcolor{keywordtype}{int}\ num\_eyepoints\ =\ \mbox{\hyperlink{classFltHeader_a32d41c2de9bbbe0a2637e4de0804c6cc}{get\_num\_eyepoints}}();}
\DoxyCodeLine{01474\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_eyepoints;\ i++)\ \{}
\DoxyCodeLine{01475\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_eyepoints[i].\mbox{\hyperlink{classFltHeader_a4fe84fb5c1772989389d56b08688d605}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01477\ \ \ \ \ \}}
\DoxyCodeLine{01478\ \ \ \}}
\DoxyCodeLine{01479\ }
\DoxyCodeLine{01480\ \ \ \textcolor{keywordtype}{int}\ num\_trackplanes\ =\ \mbox{\hyperlink{classFltHeader_acd16faca18682126f0fae1061b7cca69}{get\_num\_trackplanes}}();}
\DoxyCodeLine{01481\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_trackplanes;\ i++)\ \{}
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_trackplanes[i].\mbox{\hyperlink{classFltHeader_a4fe84fb5c1772989389d56b08688d605}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01484\ \ \ \ \ \}}
\DoxyCodeLine{01485\ \ \ \}}
\DoxyCodeLine{01486\ }
\DoxyCodeLine{01487\ \ \ \_got\_eyepoint\_trackplane\_palette\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01488\ }
\DoxyCodeLine{01489\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1420)\ \{}
\DoxyCodeLine{01490\ \ \ \ \ \textcolor{comment}{//\ I\ have\ no\ idea\ what\ bytes\ are\ supposed\ to\ be\ here\ in\ earlier\ versions}}
\DoxyCodeLine{01491\ \ \ \ \ \textcolor{comment}{//\ that\ 14.2,\ but\ who\ really\ cares?\ \ Don't\ bother\ reporting\ it\ if\ there}}
\DoxyCodeLine{01492\ \ \ \ \ \textcolor{comment}{//\ are\ too\ many\ bytes\ in\ old\ versions.}}
\DoxyCodeLine{01493\ \ \ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator,\ \textcolor{stringliteral}{"{}eyepoint\ palette"{}});}
\DoxyCodeLine{01494\ \ \ \}}
\DoxyCodeLine{01495\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01496\ \}}
\DoxyCodeLine{01497\ }
\DoxyCodeLine{01501\ FltError\ FltHeader::}
\DoxyCodeLine{01502\ write\_vertex\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01503\ \ \ FltError\ result;}
\DoxyCodeLine{01504\ }
\DoxyCodeLine{01505\ \ \ \textcolor{keywordtype}{int}\ vertex\_palette\_length\ =}
\DoxyCodeLine{01506\ \ \ \ \ ((\mbox{\hyperlink{classFltHeader}{FltHeader}}\ *)\textcolor{keyword}{this})-\/>update\_vertex\_lookups();}
\DoxyCodeLine{01507\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ vertex\_palette;}
\DoxyCodeLine{01508\ \ \ vertex\_palette.add\_be\_int32(vertex\_palette\_length);}
\DoxyCodeLine{01509\ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_abd23a8463ae21842d4930b1fbc76060b}{write\_record}}(FO\_vertex\_palette,\ vertex\_palette);}
\DoxyCodeLine{01510\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01511\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01512\ \ \ \}}
\DoxyCodeLine{01513\ \ \ \textcolor{comment}{//\ Now\ write\ out\ each\ vertex\ in\ the\ palette.}}
\DoxyCodeLine{01514\ \ \ Vertices::const\_iterator\ vi;}
\DoxyCodeLine{01515\ \ \ \textcolor{keywordflow}{for}\ (vi\ =\ \_vertices.begin();\ vi\ !=\ \_vertices.end();\ ++vi)\ \{}
\DoxyCodeLine{01516\ \ \ \ \ \mbox{\hyperlink{classFltVertex}{FltVertex}}\ *vertex\ =\ (*vi);}
\DoxyCodeLine{01517\ \ \ \ \ vertex-\/>\mbox{\hyperlink{classFltVertex_a11723670933d7abaaf610fd7ea4281cd}{build\_record}}(writer);}
\DoxyCodeLine{01518\ \ \ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01519\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01521\ \ \ \ \ \}}
\DoxyCodeLine{01522\ \ \ \}}
\DoxyCodeLine{01523\ }
\DoxyCodeLine{01524\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01525\ \}}
\DoxyCodeLine{01526\ }
\DoxyCodeLine{01527\ }
\DoxyCodeLine{01531\ FltError\ FltHeader::}
\DoxyCodeLine{01532\ write\_color\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01533\ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_color\_palette);}
\DoxyCodeLine{01534\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{01535\ }
\DoxyCodeLine{01536\ \ \ datagram.pad\_bytes(128);}
\DoxyCodeLine{01537\ }
\DoxyCodeLine{01538\ \ \ \textcolor{comment}{//\ How\ many\ colors\ should\ we\ write?}}
\DoxyCodeLine{01539\ \ \ \textcolor{keywordtype}{int}\ num\_colors\ =\ 1024;}
\DoxyCodeLine{01540\ }
\DoxyCodeLine{01541\ \ \ Colors::const\_iterator\ ci;}
\DoxyCodeLine{01542\ \ \ \textcolor{keywordflow}{for}\ (ci\ =\ \_colors.begin();\ num\_colors\ >\ 0\ \&\&\ ci\ !=\ \_colors.end();\ ++ci)\ \{}
\DoxyCodeLine{01543\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ci).build\_record(writer))\ \{}
\DoxyCodeLine{01544\ \ \ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{01545\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_invalid\_record;}
\DoxyCodeLine{01546\ \ \ \ \ \}}
\DoxyCodeLine{01547\ \ \ \ \ num\_colors-\/-\/;}
\DoxyCodeLine{01548\ \ \ \}}
\DoxyCodeLine{01549\ }
\DoxyCodeLine{01550\ \ \ \textcolor{comment}{//\ Now\ we\ might\ need\ to\ pad\ the\ record\ to\ fill\ up\ the\ required\ number\ of}}
\DoxyCodeLine{01551\ \ \ \textcolor{comment}{//\ colors.}}
\DoxyCodeLine{01552\ \ \ \textcolor{keywordflow}{if}\ (num\_colors\ >\ 0)\ \{}
\DoxyCodeLine{01553\ \ \ \ \ \mbox{\hyperlink{classFltPackedColor}{FltPackedColor}}\ empty;}
\DoxyCodeLine{01554\ \ \ \ \ \textcolor{keywordflow}{while}\ (num\_colors\ >\ 0)\ \{}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!empty.build\_record(writer))\ \{}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{01557\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_invalid\_record;}
\DoxyCodeLine{01558\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01559\ \ \ \ \ \ \ num\_colors-\/-\/;}
\DoxyCodeLine{01560\ \ \ \ \ \}}
\DoxyCodeLine{01561\ \ \ \}}
\DoxyCodeLine{01562\ }
\DoxyCodeLine{01563\ \ \ \textcolor{comment}{//\ Now\ append\ all\ the\ names\ at\ the\ end.}}
\DoxyCodeLine{01564\ \ \ ColorNames::const\_iterator\ ni;}
\DoxyCodeLine{01565\ \ \ \textcolor{keywordflow}{for}\ (ni\ =\ \_color\_names.begin();\ ni\ !=\ \_color\_names.end();\ ++ni)\ \{}
\DoxyCodeLine{01566\ \ \ \ \ std::string\ name\ =\ (*ni).second.substr(0,\ 80);}
\DoxyCodeLine{01567\ \ \ \ \ \textcolor{keywordtype}{int}\ entry\_length\ =\ name.length()\ +\ 8;}
\DoxyCodeLine{01568\ \ \ \ \ datagram.add\_be\_uint16(entry\_length);}
\DoxyCodeLine{01569\ \ \ \ \ datagram.pad\_bytes(2);}
\DoxyCodeLine{01570\ \ \ \ \ datagram.add\_be\_uint16((*ni).first);}
\DoxyCodeLine{01571\ \ \ \ \ datagram.pad\_bytes(2);}
\DoxyCodeLine{01572\ \ \ \ \ datagram.add\_fixed\_string(name,\ name.length());}
\DoxyCodeLine{01573\ \ \ \}}
\DoxyCodeLine{01574\ }
\DoxyCodeLine{01575\ \ \ \textcolor{keywordflow}{return}\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01576\ \}}
\DoxyCodeLine{01577\ }
\DoxyCodeLine{01581\ FltError\ FltHeader::}
\DoxyCodeLine{01582\ write\_material\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01583\ \ \ FltError\ result;}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classFltHeader_a4d3d098d6802e74e3d79104c972cbe1e}{get\_flt\_version}}()\ >=\ 1520)\ \{}
\DoxyCodeLine{01586\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ version\ 15\ material\ palette.}}
\DoxyCodeLine{01587\ \ \ \ \ Materials::const\_iterator\ mi;}
\DoxyCodeLine{01588\ \ \ \ \ \textcolor{keywordflow}{for}\ (mi\ =\ \_materials.begin();\ mi\ !=\ \_materials.end();\ ++mi)\ \{}
\DoxyCodeLine{01589\ \ \ \ \ \ \ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}\ *material\ =\ (*mi).second;}
\DoxyCodeLine{01590\ \ \ \ \ \ \ material-\/>\mbox{\hyperlink{classFltMaterial_a3177dd9fc338c87c61e96c4b6294aeca}{build\_record}}(writer);}
\DoxyCodeLine{01591\ }
\DoxyCodeLine{01592\ \ \ \ \ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01593\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01596\ \ \ \ \ \}}
\DoxyCodeLine{01597\ }
\DoxyCodeLine{01598\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01599\ \ \ \ \ \textcolor{comment}{//\ Write\ a\ version\ 14\ material\ palette.}}
\DoxyCodeLine{01600\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_materials.empty())\ \{}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \textcolor{comment}{//\ No\ palette\ is\ OK.}}
\DoxyCodeLine{01602\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01603\ \ \ \ \ \}}
\DoxyCodeLine{01604\ \ \ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_14\_material\_palette);}
\DoxyCodeLine{01605\ \ \ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{01606\ }
\DoxyCodeLine{01607\ \ \ \ \ PT(\mbox{\hyperlink{classFltMaterial}{FltMaterial}})\ dummy\_material\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}(\_header);}
\DoxyCodeLine{01608\ }
\DoxyCodeLine{01609\ \ \ \ \ Materials::const\_iterator\ mi\ =\ \_materials.lower\_bound(0);}
\DoxyCodeLine{01610\ \ \ \ \ \textcolor{keywordtype}{int}\ index;}
\DoxyCodeLine{01611\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ expected\_material\_entries\ =\ 64;}
\DoxyCodeLine{01612\ \ \ \ \ \textcolor{keywordflow}{for}\ (index\ =\ 0;\ index\ <\ expected\_material\_entries;\ index++)\ \{}
\DoxyCodeLine{01613\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mi\ ==\ \_materials.end()\ ||\ index\ <\ (*mi).first)\ \{}
\DoxyCodeLine{01614\ \ \ \ \ \ \ \ \ dummy\_material-\/>build\_14\_record(datagram);}
\DoxyCodeLine{01615\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ nassertr(index\ ==\ (*mi).first,\ FE\_internal);}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFltMaterial}{FltMaterial}}\ *material\ =\ (*mi).second;}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ material-\/>\mbox{\hyperlink{classFltMaterial_a65c62e142e5376a957c03852325c9209}{build\_14\_record}}(datagram);}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ ++mi;}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01621\ \ \ \ \ \}}
\DoxyCodeLine{01622\ }
\DoxyCodeLine{01623\ \ \ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01624\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01626\ \ \ \ \ \}}
\DoxyCodeLine{01627\ \ \ \}}
\DoxyCodeLine{01628\ }
\DoxyCodeLine{01629\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01630\ \}}
\DoxyCodeLine{01631\ }
\DoxyCodeLine{01635\ FltError\ FltHeader::}
\DoxyCodeLine{01636\ write\_texture\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01637\ \ \ FltError\ result;}
\DoxyCodeLine{01638\ }
\DoxyCodeLine{01639\ \ \ Textures::const\_iterator\ ti;}
\DoxyCodeLine{01640\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_textures.begin();\ ti\ !=\ \_textures.end();\ ++ti)\ \{}
\DoxyCodeLine{01641\ \ \ \ \ \mbox{\hyperlink{classFltTexture}{FltTexture}}\ *texture\ =\ (*ti).second;}
\DoxyCodeLine{01642\ \ \ \ \ texture-\/>\mbox{\hyperlink{classFltTexture_ad25ab4f8345b8626337daefc41ce77e1}{build\_record}}(writer);}
\DoxyCodeLine{01643\ \ \ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01644\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01646\ \ \ \ \ \}}
\DoxyCodeLine{01647\ \ \ \}}
\DoxyCodeLine{01648\ }
\DoxyCodeLine{01649\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01650\ \}}
\DoxyCodeLine{01651\ }
\DoxyCodeLine{01655\ FltError\ FltHeader::}
\DoxyCodeLine{01656\ write\_light\_source\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01657\ \ \ FltError\ result;}
\DoxyCodeLine{01658\ }
\DoxyCodeLine{01659\ \ \ LightSources::const\_iterator\ li;}
\DoxyCodeLine{01660\ \ \ \textcolor{keywordflow}{for}\ (li\ =\ \_light\_sources.begin();\ li\ !=\ \_light\_sources.end();\ ++li)\ \{}
\DoxyCodeLine{01661\ \ \ \ \ \mbox{\hyperlink{classFltLightSourceDefinition}{FltLightSourceDefinition}}\ *light\_source\ =\ (*li).second;}
\DoxyCodeLine{01662\ \ \ \ \ light\_source-\/>\mbox{\hyperlink{classFltLightSourceDefinition_acecb995f158139a6546c703154ae5355}{build\_record}}(writer);}
\DoxyCodeLine{01663\ \ \ \ \ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01664\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{01666\ \ \ \ \ \}}
\DoxyCodeLine{01667\ \ \ \}}
\DoxyCodeLine{01668\ }
\DoxyCodeLine{01669\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01670\ \}}
\DoxyCodeLine{01671\ }
\DoxyCodeLine{01675\ FltError\ FltHeader::}
\DoxyCodeLine{01676\ write\_eyepoint\_palette(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01677\ \ \ \textcolor{keywordflow}{if}\ (!\_got\_eyepoint\_trackplane\_palette)\ \{}
\DoxyCodeLine{01678\ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{01679\ \ \ \}}
\DoxyCodeLine{01680\ }
\DoxyCodeLine{01681\ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_eyepoint\_palette);}
\DoxyCodeLine{01682\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{01683\ \ \ datagram.pad\_bytes(4);}
\DoxyCodeLine{01684\ }
\DoxyCodeLine{01685\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{01686\ \ \ \textcolor{keywordtype}{int}\ num\_eyepoints\ =\ \mbox{\hyperlink{classFltHeader_a32d41c2de9bbbe0a2637e4de0804c6cc}{get\_num\_eyepoints}}();}
\DoxyCodeLine{01687\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_eyepoints;\ i++)\ \{}
\DoxyCodeLine{01688\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_eyepoints[i].\mbox{\hyperlink{classFltHeader_a2016717916edacd1d73aedecff5bdc37}{build\_record}}(writer))\ \{}
\DoxyCodeLine{01689\ \ \ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_bad\_data;}
\DoxyCodeLine{01691\ \ \ \ \ \}}
\DoxyCodeLine{01692\ \ \ \}}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \ \ \textcolor{keywordtype}{int}\ num\_trackplanes\ =\ \mbox{\hyperlink{classFltHeader_acd16faca18682126f0fae1061b7cca69}{get\_num\_trackplanes}}();}
\DoxyCodeLine{01695\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_trackplanes;\ i++)\ \{}
\DoxyCodeLine{01696\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_trackplanes[i].\mbox{\hyperlink{classFltHeader_a2016717916edacd1d73aedecff5bdc37}{build\_record}}(writer))\ \{}
\DoxyCodeLine{01697\ \ \ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_bad\_data;}
\DoxyCodeLine{01699\ \ \ \ \ \}}
\DoxyCodeLine{01700\ \ \ \}}
\DoxyCodeLine{01701\ }
\DoxyCodeLine{01702\ \ \ \textcolor{keywordflow}{return}\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{01703\ \}}

\end{DoxyCode}
