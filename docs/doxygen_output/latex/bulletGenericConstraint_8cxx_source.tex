\doxysection{bullet\+Generic\+Constraint.\+cxx}
\hypertarget{bulletGenericConstraint_8cxx_source}{}\label{bulletGenericConstraint_8cxx_source}\index{panda/src/bullet/bulletGenericConstraint.cxx@{panda/src/bullet/bulletGenericConstraint.cxx}}
\mbox{\hyperlink{bulletGenericConstraint_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletGenericConstraint_8h}{bulletGenericConstraint.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletRigidBodyNode_8h}{bulletRigidBodyNode.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletWorld_8h}{bulletWorld.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BulletGenericConstraint::\_type\_handle;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00024\ BulletGenericConstraint::}
\DoxyCodeLine{00025\ BulletGenericConstraint(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBulletRigidBodyNode}{BulletRigidBodyNode}}\ *node\_a,}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *frame\_a,}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_frame\_a)\ \{}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classbtRigidBody}{btRigidBody}}\ *ptr\_a\ =\ btRigidBody::upcast(node\_a-\/>get\_object());}
\DoxyCodeLine{00030\ \ \ btTransform\ trans\_a\ =\ TransformState\_to\_btTrans(frame\_a);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \ \ \_constraint\ =\ \textcolor{keyword}{new}\ btGeneric6DofConstraint(*ptr\_a,\ trans\_a,\ use\_frame\_a);}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ BulletGenericConstraint::}
\DoxyCodeLine{00039\ BulletGenericConstraint(\textcolor{keyword}{const}\ \mbox{\hyperlink{classBulletRigidBodyNode}{BulletRigidBodyNode}}\ *node\_a,}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classBulletRigidBodyNode}{BulletRigidBodyNode}}\ *node\_b,}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *frame\_a,}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *frame\_b,}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ use\_frame\_a)\ \{}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{classbtRigidBody}{btRigidBody}}\ *ptr\_a\ =\ btRigidBody::upcast(node\_a-\/>get\_object());}
\DoxyCodeLine{00046\ \ \ btTransform\ trans\_a\ =\ TransformState\_to\_btTrans(frame\_a);}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \mbox{\hyperlink{classbtRigidBody}{btRigidBody}}\ *ptr\_b\ =\ btRigidBody::upcast(node\_b-\/>get\_object());}
\DoxyCodeLine{00049\ \ \ btTransform\ trans\_b\ =\ TransformState\_to\_btTrans(frame\_b);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \_constraint\ =\ \textcolor{keyword}{new}\ btGeneric6DofConstraint(*ptr\_a,\ *ptr\_b,\ trans\_a,\ trans\_b,\ use\_frame\_a);}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00057\ btTypedConstraint\ *BulletGenericConstraint::}
\DoxyCodeLine{00058\ ptr()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \textcolor{keywordflow}{return}\ \_constraint;}
\DoxyCodeLine{00061\ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00066\ LVector3\ BulletGenericConstraint::}
\DoxyCodeLine{00067\ get\_axis(\textcolor{keywordtype}{int}\ axis)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ nassertr(axis\ >=\ 0,\ LVector3::zero());}
\DoxyCodeLine{00071\ \ \ nassertr(axis\ <=\ 3,\ LVector3::zero());}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \_constraint-\/>buildJacobian();}
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{return}\ btVector3\_to\_LVector3(\_constraint-\/>getAxis(axis));}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00080\ PN\_stdfloat\ BulletGenericConstraint::}
\DoxyCodeLine{00081\ get\_pivot(\textcolor{keywordtype}{int}\ axis)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00082\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ nassertr(axis\ >=\ 0,\ 0.0f);}
\DoxyCodeLine{00085\ \ \ nassertr(axis\ <=\ 3,\ 0.0f);}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \_constraint-\/>buildJacobian();}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{return}\ \_constraint-\/>getRelativePivotPosition(axis);}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00094\ PN\_stdfloat\ BulletGenericConstraint::}
\DoxyCodeLine{00095\ get\_angle(\textcolor{keywordtype}{int}\ axis)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00096\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ nassertr(axis\ >=\ 0,\ 0.0f);}
\DoxyCodeLine{00099\ \ \ nassertr(axis\ <=\ 3,\ 0.0f);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \_constraint-\/>buildJacobian();}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{return}\ \_constraint-\/>getAngle(axis);}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00108\ \textcolor{keywordtype}{void}\ BulletGenericConstraint::}
\DoxyCodeLine{00109\ set\_linear\_limit(\textcolor{keywordtype}{int}\ axis,\ PN\_stdfloat\ low,\ PN\_stdfloat\ high)\ \{}
\DoxyCodeLine{00110\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ nassertv(axis\ >=\ 0);}
\DoxyCodeLine{00113\ \ \ nassertv(axis\ <=\ 3);}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \_constraint-\/>buildJacobian();}
\DoxyCodeLine{00116\ \ \ \_constraint-\/>setLimit(axis,\ low,\ high);}
\DoxyCodeLine{00117\ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ BulletGenericConstraint::}
\DoxyCodeLine{00123\ set\_angular\_limit(\textcolor{keywordtype}{int}\ axis,\ PN\_stdfloat\ low,\ PN\_stdfloat\ high)\ \{}
\DoxyCodeLine{00124\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ nassertv(axis\ >=\ 0);}
\DoxyCodeLine{00127\ \ \ nassertv(axis\ <=\ 3);}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ low\ \ =\ deg\_2\_rad(low);}
\DoxyCodeLine{00130\ \ \ high\ =\ deg\_2\_rad(high);}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \_constraint-\/>buildJacobian();}
\DoxyCodeLine{00133\ \ \ \_constraint-\/>setLimit(axis\ +\ 3,\ low,\ high);}
\DoxyCodeLine{00134\ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00139\ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ BulletGenericConstraint::}
\DoxyCodeLine{00140\ get\_frame\_a()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{keywordflow}{return}\ btTrans\_to\_TransformState(\_constraint-\/>getFrameOffsetA());}
\DoxyCodeLine{00144\ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00149\ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ BulletGenericConstraint::}
\DoxyCodeLine{00150\ get\_frame\_b()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00151\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{return}\ btTrans\_to\_TransformState(\_constraint-\/>getFrameOffsetB());}
\DoxyCodeLine{00154\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00159\ \mbox{\hyperlink{classBulletRotationalLimitMotor}{BulletRotationalLimitMotor}}\ BulletGenericConstraint::}
\DoxyCodeLine{00160\ get\_rotational\_limit\_motor(\textcolor{keywordtype}{int}\ axis)\ \{}
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classBulletRotationalLimitMotor}{BulletRotationalLimitMotor}}(*\_constraint-\/>getRotationalLimitMotor(axis));}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00169\ \mbox{\hyperlink{classBulletTranslationalLimitMotor}{BulletTranslationalLimitMotor}}\ BulletGenericConstraint::}
\DoxyCodeLine{00170\ get\_translational\_limit\_motor()\ \{}
\DoxyCodeLine{00171\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classBulletTranslationalLimitMotor}{BulletTranslationalLimitMotor}}(*\_constraint-\/>getTranslationalLimitMotor());}
\DoxyCodeLine{00174\ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00179\ \textcolor{keywordtype}{void}\ BulletGenericConstraint::}
\DoxyCodeLine{00180\ set\_frames(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *ts\_a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *ts\_b)\ \{}
\DoxyCodeLine{00181\ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ btTransform\ frame\_a\ =\ TransformState\_to\_btTrans(ts\_a);}
\DoxyCodeLine{00184\ \ \ btTransform\ frame\_b\ =\ TransformState\_to\_btTrans(ts\_b);}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \_constraint-\/>setFrames(frame\_a,\ frame\_b);}
\DoxyCodeLine{00187\ \}}

\end{DoxyCode}
