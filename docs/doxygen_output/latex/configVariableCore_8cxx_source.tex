\doxysection{config\+Variable\+Core.\+cxx}
\hypertarget{configVariableCore_8cxx_source}{}\label{configVariableCore_8cxx_source}\index{dtool/src/prc/configVariableCore.cxx@{dtool/src/prc/configVariableCore.cxx}}
\mbox{\hyperlink{configVariableCore_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableCore_8h}{configVariableCore.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configDeclaration_8h}{configDeclaration.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configPage_8h}{configPage.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pset_8h}{pset.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnotify_8h}{pnotify.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__prc_8h}{config\_prc.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{comment}{//\ This\ file\ is\ generated\ by\ ppremake.}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}prc\_parameters.h"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00033\ ConfigVariableCore::}
\DoxyCodeLine{00034\ ConfigVariableCore(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ :}
\DoxyCodeLine{00035\ \ \ \_name(name),}
\DoxyCodeLine{00036\ \ \ \_is\_used(false),}
\DoxyCodeLine{00037\ \ \ \_value\_type(VT\_undefined),}
\DoxyCodeLine{00038\ \ \ \_flags(0),}
\DoxyCodeLine{00039\ \ \ \_default\_value(nullptr),}
\DoxyCodeLine{00040\ \ \ \_local\_value(nullptr),}
\DoxyCodeLine{00041\ \ \ \_declarations\_sorted(true),}
\DoxyCodeLine{00042\ \ \ \_value\_queried(false)}
\DoxyCodeLine{00043\ \{}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#if\ defined(PRC\_INC\_TRUST\_LEVEL)\ \&\&\ PRC\_INC\_TRUST\_LEVEL\ !=\ 0}}
\DoxyCodeLine{00045\ \ \ \_flags\ =\ (\_flags\ \&\ \string~F\_trust\_level\_mask)\ |\ ((\_flags\ \&\ F\_trust\_level\_mask)\ +\ PRC\_INC\_TRUST\_LEVEL);}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_INC\_TRUST\_LEVEL}}
\DoxyCodeLine{00047\ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00054\ ConfigVariableCore::}
\DoxyCodeLine{00055\ ConfigVariableCore(\textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigVariableCore}{ConfigVariableCore}}\ \&templ,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ :}
\DoxyCodeLine{00056\ \ \ \_name(name),}
\DoxyCodeLine{00057\ \ \ \_is\_used(templ.\_is\_used),}
\DoxyCodeLine{00058\ \ \ \_value\_type(templ.\_value\_type),}
\DoxyCodeLine{00059\ \ \ \_description(templ.\_description),}
\DoxyCodeLine{00060\ \ \ \_flags(templ.\_flags),}
\DoxyCodeLine{00061\ \ \ \_default\_value(nullptr),}
\DoxyCodeLine{00062\ \ \ \_local\_value(nullptr),}
\DoxyCodeLine{00063\ \ \ \_declarations\_sorted(false),}
\DoxyCodeLine{00064\ \ \ \_value\_queried(false)}
\DoxyCodeLine{00065\ \{}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{if}\ (templ.\_default\_value\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00067\ \ \ \ \ set\_default\_value(templ.\_default\_value-\/>get\_string\_value());}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00075\ ConfigVariableCore::}
\DoxyCodeLine{00076\ \string~ConfigVariableCore()\ \{}
\DoxyCodeLine{00077\ \ \ prc\_cat-\/>error()}
\DoxyCodeLine{00078\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Internal\ error-\/-\/ConfigVariableCore\ destructor\ called!\(\backslash\)n"{}};}
\DoxyCodeLine{00079\ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00086\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00087\ set\_value\_type(ConfigVariableCore::ValueType\ value\_type)\ \{}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{if}\ (\_value\_queried\ \&\&\ \_value\_type\ !=\ value\_type)\ \{}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_flags\ \&\ F\_dconfig)\ !=\ 0)\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \textcolor{comment}{//\ As\ a\ special\ exception,\ if\ the\ flags\ include\ F\_dconfig,\ we\ don't}}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \textcolor{comment}{//\ report\ a\ warning\ for\ changing\ the\ type,\ assuming\ the\ variable\ is}}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{comment}{//\ being\ defined\ through\ the\ older\ DConfig\ interface.}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00094\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}changing\ type\ for\ ConfigVariable\ "{}}}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ \_value\_type\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ <<\ value\_type\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \_value\_type\ =\ value\_type;}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00111\ set\_flags(\textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00112\ \ \ \textcolor{keywordflow}{if}\ ((flags\ \&\ F\_dconfig)\ !=\ 0)\ \{}
\DoxyCodeLine{00113\ \ \ \ \ flags\ =\ (flags\ \&\ \string~F\_trust\_level\_mask)\ |\ PRC\_DCONFIG\_TRUST\_LEVEL;}
\DoxyCodeLine{00114\ \ \ \}}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{preprocessor}{\#if\ defined(PRC\_INC\_TRUST\_LEVEL)\ \&\&\ PRC\_INC\_TRUST\_LEVEL\ !=\ 0}}
\DoxyCodeLine{00117\ \ \ flags\ =\ (flags\ \&\ \string~F\_trust\_level\_mask)\ |\ ((flags\ \&\ F\_trust\_level\_mask)\ +\ PRC\_INC\_TRUST\_LEVEL);}
\DoxyCodeLine{00118\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_INC\_TRUST\_LEVEL}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{if}\ (\_value\_queried)\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordtype}{int}\ bits\_changed\ =\ (\_flags\ \string^\ flags);}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordflow}{if}\ ((bits\_changed\ \&\ F\_trust\_level\_mask)\ !=\ 0)\ \{}
\DoxyCodeLine{00123\ \ \ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}changing\ trust\ level\ for\ ConfigVariable\ "{}}}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ (\_flags\ \&\ F\_trust\_level\_mask)\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ <<\ (flags\ \&\ F\_trust\_level\_mask)\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00127\ \ \ \ \ \}}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{if}\ ((bits\_changed\ \&\ \string~(F\_trust\_level\_mask\ |\ F\_dconfig))\ !=\ 0)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}changing\ flags\ for\ ConfigVariable\ "{}}}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ from\ "{}}\ <<\ std::hex}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ <<\ (\_flags\ \&\ \string~F\_trust\_level\_mask)\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ <<\ (flags\ \&\ \string~F\_trust\_level\_mask)\ <<\ std::dec\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00134\ \ \ \ \ \}}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \_flags\ =\ flags;}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{comment}{//\ Changing\ the\ trust\ level\ will\ require\ re-\/sorting\ the\ declarations.}}
\DoxyCodeLine{00140\ \ \ \_declarations\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00149\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00150\ set\_description(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&description)\ \{}
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{if}\ (\_value\_queried\ \&\&\ \_description\ !=\ description)\ \{}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_flags\ \&\ F\_dconfig)\ !=\ 0)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \textcolor{comment}{//\ As\ a\ special\ exception,\ if\ the\ flags\ include\ F\_dconfig,\ we\ don't}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \textcolor{comment}{//\ change\ it,\ since\ this\ is\ presumably\ coming\ from\ the\ older\ DConfig}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \textcolor{comment}{//\ interface.}}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00157\ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{if}\ (description\ ==\ \textcolor{stringliteral}{"{}DConfig"{}})\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{comment}{//\ As\ a\ similar\ exception,\ we\ don't\ replace\ an\ existing\ description\ with}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{comment}{//\ one\ that\ reads\ simply\ "{}DConfig"{},\ unless\ it\ was\ empty\ previously.}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_description.empty())\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \_description\ =\ description;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{if}\ (description.empty())\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ new\ description\ is\ empty,\ we\ don't\ do\ anything.}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00170\ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_description.empty())\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ previous\ description\ was\ empty,\ we\ quietly\ replace\ it.}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \_description\ =\ description;}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00179\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}changing\ description\ for\ ConfigVariable\ "{}}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00181\ \ \ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \_description\ =\ description;}
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00190\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00191\ set\_default\_value(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&default\_value)\ \{}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{if}\ (\_default\_value\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{comment}{//\ Defining\ the\ default\ value\ for\ the\ first\ time.}}
\DoxyCodeLine{00194\ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *default\_page\ =\ ConfigPage::get\_default\_page();}
\DoxyCodeLine{00195\ \ \ \ \ \_default\_value\ =\ default\_page-\/>\mbox{\hyperlink{classConfigPage_a2d71356e38ee708a24c2e014a64edca8}{make\_declaration}}(\textcolor{keyword}{this},\ default\_value);}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ Modifying\ an\ existing\ default\ value.}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{comment}{//\ We\ set\ the\ original\ default\ value\ first,\ to\ avoid\ infinite\ recursion}}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//\ when\ the\ config\ variable\ in\ question\ happens\ to\ be\ consulted\ in}}
\DoxyCodeLine{00202\ \ \ \ \ \textcolor{comment}{//\ NotifyCategory::out()\ (for\ instance,\ notify-\/timestamp).}}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordtype}{string}\ orig\_default\_value\ =\ \_default\_value-\/>get\_string\_value();}
\DoxyCodeLine{00204\ \ \ \ \ \_default\_value-\/>set\_string\_value(default\_value);}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordflow}{if}\ (orig\_default\_value\ !=\ default\_value)\ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_flags\ \&\ F\_dconfig)\ !=\ 0)\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ As\ a\ special\ exception,\ if\ the\ flags\ include\ F\_dconfig,\ we\ don't}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ report\ a\ warning\ for\ changing\ the\ default\ value,\ assuming\ the}}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ variable\ is\ being\ defined\ through\ the\ older\ DConfig\ interface.}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}changing\ default\ value\ for\ ConfigVariable\ "{}}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}\ from\ '"{}}\ <<\ orig\_default\_value}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}'\ to\ '"{}}\ <<\ default\_value\ <<\ \textcolor{stringliteral}{"{}'.\(\backslash\)n"{}};}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \ \ \}}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00231\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *ConfigVariableCore::}
\DoxyCodeLine{00232\ make\_local\_value()\ \{}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{if}\ (\_local\_value\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *local\_page\ =\ \mbox{\hyperlink{classConfigPage_abf7109992b84117f71a419b64f60015a}{ConfigPage::get\_local\_page}}();}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordtype}{string}\ string\_value\ =\ get\_declaration(0)-\/>get\_string\_value();}
\DoxyCodeLine{00236\ \ \ \ \ \_local\_value\ =\ local\_page-\/>\mbox{\hyperlink{classConfigPage_a2d71356e38ee708a24c2e014a64edca8}{make\_declaration}}(\textcolor{keyword}{this},\ string\_value);}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_closed())\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ prc\_cat.warning()}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Assigning\ a\ local\ value\ to\ a\ \(\backslash\)"{}closed\(\backslash\)"{}\ ConfigVariable.\ \ "{}}}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}This\ is\ legal\ in\ a\ development\ build,\ but\ illegal\ in\ a\ release\ "{}}}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}build\ and\ may\ result\ in\ a\ compilation\ error\ or\ exception.\(\backslash\)n"{}};}
\DoxyCodeLine{00243\ \ \ \ \ \}}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{return}\ \_local\_value;}
\DoxyCodeLine{00247\ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00256\ \textcolor{keywordtype}{bool}\ ConfigVariableCore::}
\DoxyCodeLine{00257\ clear\_local\_value()\ \{}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordflow}{if}\ (\_local\_value\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \mbox{\hyperlink{classConfigPage_abf7109992b84117f71a419b64f60015a}{ConfigPage::get\_local\_page}}()-\/>\mbox{\hyperlink{classConfigPage_a182f27eca4d1f326824967d2478df2a5}{delete\_declaration}}(\_local\_value);}
\DoxyCodeLine{00260\ \ \ \ \ \_local\_value\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00261\ \ \ \ \ invalidate\_cache();}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00266\ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00272\ \textcolor{keywordtype}{bool}\ ConfigVariableCore::}
\DoxyCodeLine{00273\ has\_value()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00274\ \ \ \textcolor{keywordflow}{if}\ (has\_local\_value())\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00276\ \ \ \}}
\DoxyCodeLine{00277\ \ \ check\_sort\_declarations();}
\DoxyCodeLine{00278\ \ \ \textcolor{keywordflow}{return}\ (!\_trusted\_declarations.empty());}
\DoxyCodeLine{00279\ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00286\ \textcolor{keywordtype}{size\_t}\ ConfigVariableCore::}
\DoxyCodeLine{00287\ get\_num\_declarations()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00288\ \ \ \textcolor{keywordflow}{if}\ (has\_local\_value())\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00290\ \ \ \}}
\DoxyCodeLine{00291\ \ \ check\_sort\_declarations();}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordflow}{if}\ (!\_trusted\_declarations.empty())\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{return}\ \_trusted\_declarations.size();}
\DoxyCodeLine{00294\ \ \ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \textcolor{comment}{//\ We\ always\ have\ at\ least\ one:\ the\ default\ value.}}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00298\ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00306\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *ConfigVariableCore::}
\DoxyCodeLine{00307\ get\_declaration(\textcolor{keywordtype}{size\_t}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00308\ \ \ ((\mbox{\hyperlink{classConfigVariableCore}{ConfigVariableCore}}\ *)\textcolor{keyword}{this})-\/>\_value\_queried\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{if}\ (\_default\_value\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00310\ \ \ \ \ prc\_cat-\/>warning()}
\DoxyCodeLine{00311\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}value\ queried\ before\ default\ value\ set\ for\ "{}}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00313\ \ \ \ \ ((\mbox{\hyperlink{classConfigVariableCore}{ConfigVariableCore}}\ *)\textcolor{keyword}{this})-\/>set\_default\_value(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{if}\ (has\_local\_value())\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{return}\ \_local\_value;}
\DoxyCodeLine{00318\ \ \ \}}
\DoxyCodeLine{00319\ \ \ check\_sort\_declarations();}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{if}\ (n\ <\ \_trusted\_declarations.size())\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordflow}{return}\ \_trusted\_declarations[n];}
\DoxyCodeLine{00322\ \ \ \}}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordflow}{return}\ \_default\_value;}
\DoxyCodeLine{00324\ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00329\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00330\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00331\ \ \ out\ <<\ get\_declaration(0)-\/>get\_string\_value();}
\DoxyCodeLine{00332\ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00337\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00338\ write(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00339\ \ \ out\ <<\ \textcolor{stringliteral}{"{}ConfigVariable\ "{}}\ <<\ get\_name()\ <<\ \textcolor{stringliteral}{"{}:\(\backslash\)n"{}};}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ check\_sort\_declarations();}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00343\ \ \ \textcolor{keywordflow}{if}\ (has\_local\_value())\ \{}
\DoxyCodeLine{00344\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ *\_local\_value\ <<\ \textcolor{stringliteral}{"{}\ \ (defined\ locally)\(\backslash\)n"{}};}
\DoxyCodeLine{00345\ \ \ \}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ Declarations::const\_iterator\ di;}
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{for}\ (di\ =\ \_trusted\_declarations.begin();}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ di\ !=\ \_trusted\_declarations.end();}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ ++di)\ \{}
\DoxyCodeLine{00351\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ *(*di)}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ (from\ "{}}\ <<\ (*di)-\/>get\_page()-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00353\ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{keywordflow}{if}\ (\_default\_value\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00356\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ *\_default\_value\ <<\ \textcolor{stringliteral}{"{}\ \ (default\ value)\(\backslash\)n"{}};}
\DoxyCodeLine{00357\ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{for}\ (di\ =\ \_untrusted\_declarations.begin();}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ di\ !=\ \_untrusted\_declarations.end();}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ ++di)\ \{}
\DoxyCodeLine{00362\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ *(*di)}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ (from\ "{}}\ <<\ (*di)-\/>get\_page()-\/>get\_name()\ <<\ \textcolor{stringliteral}{"{},\ untrusted)\(\backslash\)n"{}};}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \textcolor{keywordflow}{if}\ (!\_description.empty())\ \{}
\DoxyCodeLine{00367\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ \_description\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00368\ \ \ \}}
\DoxyCodeLine{00369\ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00375\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00376\ add\_declaration(\mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *decl)\ \{}
\DoxyCodeLine{00377\ \ \ \_declarations.push\_back(decl);}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \_declarations\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00380\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00386\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00387\ remove\_declaration(\mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *decl)\ \{}
\DoxyCodeLine{00388\ \ \ Declarations::iterator\ di;}
\DoxyCodeLine{00389\ \ \ \textcolor{keywordflow}{for}\ (di\ =\ \_declarations.begin();\ di\ !=\ \_declarations.end();\ ++di)\ \{}
\DoxyCodeLine{00390\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*di)\ ==\ decl)\ \{}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \textcolor{comment}{//\ Rather\ than\ deleting\ the\ declaration\ from\ the\ middle\ of\ the\ list,\ we}}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \textcolor{comment}{//\ maybe\ save\ a\ bit\ of\ time\ by\ swapping\ in\ the\ one\ at\ the\ end\ of\ the}}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{comment}{//\ list\ (although\ this\ will\ unsort\ the\ list).}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ Declarations::iterator\ di2\ =\ \_declarations.end();}
\DoxyCodeLine{00395\ \ \ \ \ \ \ di2-\/-\/;}
\DoxyCodeLine{00396\ \ \ \ \ \ \ (*di)\ =\ (*di2);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \_declarations.erase(di2);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \_declarations\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00400\ \ \ \ \ \}}
\DoxyCodeLine{00401\ \ \ \}}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \textcolor{comment}{//\ Hmm,\ it\ wasn't\ here.\ \ Oh\ well.}}
\DoxyCodeLine{00404\ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \textcolor{comment}{//\ This\ class\ is\ used\ in\ sort\_declarations,\ below.}}
\DoxyCodeLine{00407\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCompareConfigDeclarations}{CompareConfigDeclarations}}\ \{}
\DoxyCodeLine{00408\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00409\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *b)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00410\ \ \ \ \ \textcolor{keywordflow}{return}\ (*a)\ <\ (*b);}
\DoxyCodeLine{00411\ \ \ \}}
\DoxyCodeLine{00412\ \};}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00419\ \textcolor{keywordtype}{void}\ ConfigVariableCore::}
\DoxyCodeLine{00420\ sort\_declarations()\ \{}
\DoxyCodeLine{00421\ \ \ sort(\_declarations.begin(),\ \_declarations.end(),\ \mbox{\hyperlink{classCompareConfigDeclarations}{CompareConfigDeclarations}}());}
\DoxyCodeLine{00422\ \ \ Declarations::iterator\ di;}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \textcolor{comment}{//\ Now\ that\ they're\ sorted,\ divide\ them\ into\ either\ trusted\ or\ untrusted}}
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//\ declarations.}}
\DoxyCodeLine{00426\ \textcolor{preprocessor}{\#ifdef\ PRC\_RESPECT\_TRUST\_LEVEL}}
\DoxyCodeLine{00427\ \ \ \textcolor{comment}{//\ In\ this\ mode,\ normally\ for\ a\ release\ build,\ we\ sort\ the\ declarations}}
\DoxyCodeLine{00428\ \ \ \textcolor{comment}{//\ honestly\ according\ to\ whether\ the\ prc\ file\ that\ defines\ them\ meets\ the}}
\DoxyCodeLine{00429\ \ \ \textcolor{comment}{//\ required\ trust\ level.}}
\DoxyCodeLine{00430\ \ \ \_trusted\_declarations.clear();}
\DoxyCodeLine{00431\ \ \ \_untrusted\_declarations.clear();}
\DoxyCodeLine{00432\ \ \ \textcolor{keywordflow}{for}\ (di\ =\ \_declarations.begin();\ di\ !=\ \_declarations.end();\ ++di)\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *decl\ =\ (*di);}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_closed()\ \&\&}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ get\_trust\_level()\ <=\ decl-\/>get\_page()-\/>get\_trust\_level())\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \_trusted\_declarations.push\_back(decl);}
\DoxyCodeLine{00437\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \_untrusted\_declarations.push\_back(decl);}
\DoxyCodeLine{00439\ \ \ \ \ \}}
\DoxyCodeLine{00440\ \ \ \}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \textcolor{preprocessor}{\#else\ \ }\textcolor{comment}{//\ PRC\_RESPECT\_TRUST\_LEVEL}}
\DoxyCodeLine{00443\ \ \ \textcolor{comment}{//\ In\ this\ mode,\ normally\ for\ the\ development\ environment,\ all\ declarations}}
\DoxyCodeLine{00444\ \ \ \textcolor{comment}{//\ are\ trusted,\ regardless\ of\ the\ trust\ level.}}
\DoxyCodeLine{00445\ \ \ \_trusted\_declarations\ =\ \_declarations;}
\DoxyCodeLine{00446\ \ \ \_untrusted\_declarations.clear();}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_RESPECT\_TRUST\_LEVEL}}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \textcolor{comment}{//\ Finally,\ determine\ the\ set\ of\ unique,\ trusted\ declarations-\/-\/trusted}}
\DoxyCodeLine{00451\ \ \ \textcolor{comment}{//\ declarations\ that\ have\ a\ unique\ string\ value.\ \ This\ is\ usually\ unneeded,}}
\DoxyCodeLine{00452\ \ \ \textcolor{comment}{//\ but\ what\ the\ heck,\ it\ doesn't\ need\ to\ be\ recomputed\ all\ that\ often.}}
\DoxyCodeLine{00453\ \ \ \_unique\_declarations.clear();}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00455\ \ \ init\_system\_type\_handles();\ \ \textcolor{comment}{//\ Make\ sure\ pset\_type\_handle\ is\ initted.}}
\DoxyCodeLine{00456\ \ \ \mbox{\hyperlink{classpset}{pset<string>}}\ already\_added;}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{for}\ (di\ =\ \_trusted\_declarations.begin();}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ di\ !=\ \_trusted\_declarations.end();}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ ++di)\ \{}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigDeclaration}{ConfigDeclaration}}\ *decl\ =\ (*di);}
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keywordflow}{if}\ (already\_added.insert(decl-\/>get\_string\_value()).second)\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \_unique\_declarations.push\_back(decl);}
\DoxyCodeLine{00463\ \ \ \ \ \}}
\DoxyCodeLine{00464\ \ \ \}}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \_declarations\_sorted\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00467\ \}}

\end{DoxyCode}
