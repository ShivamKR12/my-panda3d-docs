\doxysection{find\+Approx\+Path.\+cxx}
\hypertarget{findApproxPath_8cxx_source}{}\label{findApproxPath_8cxx_source}\index{panda/src/pgraph/findApproxPath.cxx@{panda/src/pgraph/findApproxPath.cxx}}
\mbox{\hyperlink{findApproxPath_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{findApproxPath_8h}{findApproxPath.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandaNode_8h}{pandaNode.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00021\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ \textcolor{keywordtype}{bool}\ FindApproxPath::Component::}
\DoxyCodeLine{00028\ matches(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *node)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordtype}{string}\ node\_name;}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{00032\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name:}
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ name\ exactly.}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_name\ ==\ node-\/>get\_name());}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name\_insensitive:}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ name\ exactly,\ with\ case-\/insensitive\ comparison.}}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordflow}{return}\ cmp\_nocase(\_name,\ node-\/>get\_name())\ ==\ 0;}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name\_glob:}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ name\ according\ to\ filename\ globbing\ rules.}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_glob.matches(node-\/>get\_name()));}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_exact\_type:}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ type\ exactly.}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{return}\ (node-\/>is\_exact\_type(\_type\_handle));}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_inexact\_type:}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ type\ inexactly:\ it's\ a\ match\ if\ the\ node\ is\ the\ type,}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ or\ is\ derived\ from\ the\ type.}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordflow}{return}\ (node-\/>is\_of\_type(\_type\_handle));}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_tag:}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ tag\ only.}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return}\ (node-\/>has\_tag(\_name));}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_tag\_value:}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{//\ Match\ the\ node's\ tag\ and\ value.}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keywordflow}{if}\ (node-\/>has\_tag(\_name))\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_glob.matches(node-\/>get\_tag(\_name));}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_one:}
\DoxyCodeLine{00065\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_many:}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ Match\ any\ node.}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_pointer:}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ Match\ only\ this\ one\ particular\ node.}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keywordflow}{return}\ (\_pointer\ ==\ node);}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00075\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ component\ in\ FindApproxPath\(\backslash\)n"{}};}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00082\ \textcolor{keywordtype}{void}\ FindApproxPath::Component::}
\DoxyCodeLine{00083\ output(ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00084\ \ \ out\ <<\ \_type;}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{switch}\ (\_type)\ \{}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name:}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name\_insensitive:}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_name\_glob:}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_tag:}
\DoxyCodeLine{00090\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \(\backslash\)"{}"{}}\ <<\ \_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_tag\_value:}
\DoxyCodeLine{00094\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \(\backslash\)"{}"{}}\ <<\ \_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}=\(\backslash\)"{}"{}}\ <<\ \_glob\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_exact\_type:}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_inexact\_type:}
\DoxyCodeLine{00099\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ \_type\_handle;}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{case}\ CT\_match\_pointer:}
\DoxyCodeLine{00103\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ ("{}}\ <<\ *\_pointer\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00108\ \ \ \}}
\DoxyCodeLine{00109\ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00116\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFindApproxPath_abc26a2e798fc7f2a874d674673371be9}{FindApproxPath::}}}
\DoxyCodeLine{00117\ \mbox{\hyperlink{classFindApproxPath_abc26a2e798fc7f2a874d674673371be9}{add\_string}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str\_path)\ \{}
\DoxyCodeLine{00118\ \ \ \textcolor{comment}{//\ First,\ chop\ the\ string\ up\ by\ slashes\ into\ its\ components.}}
\DoxyCodeLine{00119\ \ \ vector\_string\ components;}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keywordtype}{size\_t}\ start\ =\ 0;}
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{size\_t}\ slash\ =\ str\_path.find(\textcolor{charliteral}{'/'});}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{while}\ (slash\ !=\ string::npos)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ components.push\_back(str\_path.substr(start,\ slash\ -\/\ start));}
\DoxyCodeLine{00125\ \ \ \ \ start\ =\ slash\ +\ 1;}
\DoxyCodeLine{00126\ \ \ \ \ slash\ =\ str\_path.find(\textcolor{charliteral}{'/'},\ start);}
\DoxyCodeLine{00127\ \ \ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{size\_t}\ semicolon\ =\ str\_path.rfind(\textcolor{charliteral}{';'});}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ We\ want\ to\ find\ the\ *last*\ semicolon\ at\ start\ or\ later,\ if\ there\ happens}}
\DoxyCodeLine{00132\ \ \ \textcolor{comment}{//\ to\ be\ more\ than\ one.\ \ rfind\ will\ find\ the\ rightmost\ semicolon\ in\ the}}
\DoxyCodeLine{00133\ \ \ \textcolor{comment}{//\ entire\ string;\ if\ this\ is\ less\ than\ start,\ there\ is\ no\ semicolon\ right\ of}}
\DoxyCodeLine{00134\ \ \ \textcolor{comment}{//\ start.}}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (semicolon\ <\ start)\ \{}
\DoxyCodeLine{00136\ \ \ \ \ semicolon\ =\ string::npos;}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ components.push\_back(str\_path.substr(start,\ semicolon\ -\/\ start));}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{if}\ (semicolon\ !=\ string::npos)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFindApproxPath_a4103fd3eadf9bdc53c289539d2286bd6}{add\_flags}}(str\_path.substr(semicolon\ +\ 1)))\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00144\ \ \ \ \ \}}
\DoxyCodeLine{00145\ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ Now\ decode\ each\ component\ and\ add\ it\ to\ the\ path.}}
\DoxyCodeLine{00148\ \ \ vector\_string::const\_iterator\ ci;}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{for}\ (ci\ =\ components.begin();\ ci\ !=\ components.end();\ ++ci)\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFindApproxPath_a9db1ea979d17889244b6c666450a1f9c}{add\_component}}(*ci))\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00152\ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00156\ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00163\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFindApproxPath_a4103fd3eadf9bdc53c289539d2286bd6}{FindApproxPath::}}}
\DoxyCodeLine{00164\ \mbox{\hyperlink{classFindApproxPath_a4103fd3eadf9bdc53c289539d2286bd6}{add\_flags}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str\_flags)\ \{}
\DoxyCodeLine{00165\ \ \ string::const\_iterator\ pi\ =\ str\_flags.begin();}
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{while}\ (pi\ !=\ str\_flags.end())\ \{}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{bool}\ on;}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{switch}\ (*pi)\ \{}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'+'}:}
\DoxyCodeLine{00170\ \ \ \ \ \ \ on\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'-\/'}:}
\DoxyCodeLine{00173\ \ \ \ \ \ \ on\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00175\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00176\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ control\ flag\ string:\ "{}}\ <<\ str\_flags\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00179\ \ \ \ \ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \ \ ++pi;}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{keywordflow}{if}\ (pi\ ==\ str\_flags.end())\ \{}
\DoxyCodeLine{00183\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ control\ flag\ string:\ "{}}\ <<\ str\_flags\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00186\ \ \ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{switch}\ (*pi)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'h'}:}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \_return\_hidden\ =\ on;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \_return\_stashed\ =\ on;}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'i'}:}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \_case\_insensitive\ =\ on;}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00202\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ control\ flag\ string:\ "{}}\ <<\ str\_flags\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00205\ \ \ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ ++pi;}
\DoxyCodeLine{00208\ \ \ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00211\ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00219\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFindApproxPath_a9db1ea979d17889244b6c666450a1f9c}{FindApproxPath::}}}
\DoxyCodeLine{00220\ \mbox{\hyperlink{classFindApproxPath_a9db1ea979d17889244b6c666450a1f9c}{add\_component}}(\textcolor{keywordtype}{string}\ str\_component)\ \{}
\DoxyCodeLine{00221\ \ \ \textcolor{keywordtype}{int}\ flags\ =\ 0;}
\DoxyCodeLine{00222\ \ \ \textcolor{keywordflow}{if}\ (str\_component.size()\ >=\ 2\ \&\&\ str\_component.substr(0,\ 2)\ ==\ \textcolor{stringliteral}{"{}@@"{}})\ \{}
\DoxyCodeLine{00223\ \ \ \ \ flags\ |=\ CF\_stashed;}
\DoxyCodeLine{00224\ \ \ \ \ str\_component\ =\ str\_component.substr(2);}
\DoxyCodeLine{00225\ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{if}\ (str\_component\ ==\ \textcolor{stringliteral}{"{}*"{}})\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_a315e3a87722985cfd7433fea2019b23c}{add\_match\_one}}(flags);}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (str\_component\ ==\ \textcolor{stringliteral}{"{}**"{}})\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}\ ((flags\ \&\ CF\_stashed)\ !=\ 0)\ \{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}@@**\ is\ undefined;\ use\ @@*/**\ or\ **/@@*\ instead.\(\backslash\)n"{}};}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00235\ \ \ \ \ \}}
\DoxyCodeLine{00236\ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_abab201b5b552f2c44784663b608d5aca}{add\_match\_many}}(flags);}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!str\_component.empty()\ \&\&\ str\_component[0]\ ==\ \textcolor{charliteral}{'-\/'})\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordtype}{string}\ type\_name\ =\ str\_component.substr(1);}
\DoxyCodeLine{00240\ \ \ \ \ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ handle\ =\ TypeRegistry::ptr()-\/>\mbox{\hyperlink{classTypeRegistry_ace84a2c2729c7c85c6456ba84b6f46d3}{find\_type}}(type\_name);}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{if}\ (handle\ ==\ TypeHandle::none())\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ type\ name:\ "{}}\ <<\ type\_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_a4b19ddba024a0000827bfa154fe4f006}{add\_match\_exact\_type}}(handle,\ flags);}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!str\_component.empty()\ \&\&\ str\_component[0]\ ==\ \textcolor{charliteral}{'+'})\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{keywordtype}{string}\ type\_name\ =\ str\_component.substr(1);}
\DoxyCodeLine{00253\ \ \ \ \ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ handle\ =\ TypeRegistry::ptr()-\/>\mbox{\hyperlink{classTypeRegistry_ace84a2c2729c7c85c6456ba84b6f46d3}{find\_type}}(type\_name);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{if}\ (handle\ ==\ TypeHandle::none())\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ type\ name:\ "{}}\ <<\ type\_name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_aba53b1413246d41e94db02bfc71e6cf2}{add\_match\_inexact\_type}}(handle,\ flags);}
\DoxyCodeLine{00262\ \ \ \ \ \}}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!str\_component.empty()\ \&\&\ str\_component[0]\ ==\ \textcolor{charliteral}{'='})\ \{}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ equals\ =\ str\_component.find(\textcolor{charliteral}{'='},\ 1);}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{if}\ (equals\ !=\ string::npos)\ \{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \textcolor{comment}{//\ =key=value}}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ tag\_key\ =\ str\_component.substr(1,\ equals\ -\/\ 1);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ tag\_value\ =\ str\_component.substr(equals\ +\ 1);}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_a60aa6b94997b18519bee2b03ee61d6b9}{add\_match\_tag\_value}}(tag\_key,\ tag\_value,\ flags);}
\DoxyCodeLine{00271\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \textcolor{comment}{//\ =key}}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ tag\_key\ =\ str\_component.substr(1);}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_aac7c53b215d1cf6003e0f7556cd7848d}{add\_match\_tag}}(tag\_key,\ flags);}
\DoxyCodeLine{00275\ \ \ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00278\ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_af2743da4bdaf8fbde1b5705f9f026983}{add\_match\_name\_glob}}(str\_component,\ flags);}
\DoxyCodeLine{00279\ \ \ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00282\ \}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00287\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_ac0e054b119a6a3625a978abc977911e4}{FindApproxPath::}}}
\DoxyCodeLine{00288\ \mbox{\hyperlink{classFindApproxPath_ac0e054b119a6a3625a978abc977911e4}{add\_match\_name}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00289\ \ \ Component\ comp;}
\DoxyCodeLine{00290\ \ \ comp.\_type\ =\ \_case\_insensitive\ ?\ CT\_match\_name\_insensitive\ :\ CT\_match\_name;}
\DoxyCodeLine{00291\ \ \ comp.\_name\ =\ name;}
\DoxyCodeLine{00292\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00293\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00294\ \}}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00300\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_af2743da4bdaf8fbde1b5705f9f026983}{FindApproxPath::}}}
\DoxyCodeLine{00301\ \mbox{\hyperlink{classFindApproxPath_af2743da4bdaf8fbde1b5705f9f026983}{add\_match\_name\_glob}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00302\ \ \ Component\ comp;}
\DoxyCodeLine{00303\ \ \ comp.\_type\ =\ CT\_match\_name\_glob;}
\DoxyCodeLine{00304\ \ \ comp.\_name\ =\ name;}
\DoxyCodeLine{00305\ \ \ comp.\_glob.set\_pattern(name);}
\DoxyCodeLine{00306\ \ \ comp.\_glob.set\_case\_sensitive(!\_case\_insensitive);}
\DoxyCodeLine{00307\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00308\ \ \ \textcolor{keywordflow}{if}\ (!comp.\_glob.has\_glob\_characters())\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \textcolor{comment}{//\ The\ glob\ pattern\ contains\ no\ special\ characters;\ make\ it\ a\ literal}}
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{comment}{//\ match\ for\ efficiency.}}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{classFindApproxPath_ac0e054b119a6a3625a978abc977911e4}{add\_match\_name}}(name,\ flags);}
\DoxyCodeLine{00312\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00314\ \ \ \}}
\DoxyCodeLine{00315\ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00321\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_a4b19ddba024a0000827bfa154fe4f006}{FindApproxPath::}}}
\DoxyCodeLine{00322\ \mbox{\hyperlink{classFindApproxPath_a4b19ddba024a0000827bfa154fe4f006}{add\_match\_exact\_type}}(\mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ type,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00323\ \ \ Component\ comp;}
\DoxyCodeLine{00324\ \ \ comp.\_type\ =\ CT\_match\_exact\_type;}
\DoxyCodeLine{00325\ \ \ comp.\_type\_handle\ =\ type;}
\DoxyCodeLine{00326\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00327\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00328\ \}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00334\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_aba53b1413246d41e94db02bfc71e6cf2}{FindApproxPath::}}}
\DoxyCodeLine{00335\ \mbox{\hyperlink{classFindApproxPath_aba53b1413246d41e94db02bfc71e6cf2}{add\_match\_inexact\_type}}(\mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ type,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00336\ \ \ Component\ comp;}
\DoxyCodeLine{00337\ \ \ comp.\_type\ =\ CT\_match\_inexact\_type;}
\DoxyCodeLine{00338\ \ \ comp.\_type\_handle\ =\ type;}
\DoxyCodeLine{00339\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00340\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00347\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_aac7c53b215d1cf6003e0f7556cd7848d}{FindApproxPath::}}}
\DoxyCodeLine{00348\ \mbox{\hyperlink{classFindApproxPath_aac7c53b215d1cf6003e0f7556cd7848d}{add\_match\_tag}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00349\ \ \ Component\ comp;}
\DoxyCodeLine{00350\ \ \ comp.\_type\ =\ CT\_match\_tag;}
\DoxyCodeLine{00351\ \ \ comp.\_name\ =\ name;}
\DoxyCodeLine{00352\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00353\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00354\ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00361\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_a60aa6b94997b18519bee2b03ee61d6b9}{FindApproxPath::}}}
\DoxyCodeLine{00362\ \mbox{\hyperlink{classFindApproxPath_a60aa6b94997b18519bee2b03ee61d6b9}{add\_match\_tag\_value}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&value,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00363\ \ \ Component\ comp;}
\DoxyCodeLine{00364\ \ \ comp.\_type\ =\ CT\_match\_tag\_value;}
\DoxyCodeLine{00365\ \ \ comp.\_name\ =\ name;}
\DoxyCodeLine{00366\ \ \ comp.\_glob.set\_pattern(value);}
\DoxyCodeLine{00367\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00368\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00369\ \}}
\DoxyCodeLine{00370\ }
\DoxyCodeLine{00374\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_a315e3a87722985cfd7433fea2019b23c}{FindApproxPath::}}}
\DoxyCodeLine{00375\ \mbox{\hyperlink{classFindApproxPath_a315e3a87722985cfd7433fea2019b23c}{add\_match\_one}}(\textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00376\ \ \ Component\ comp;}
\DoxyCodeLine{00377\ \ \ comp.\_type\ =\ CT\_match\_one;}
\DoxyCodeLine{00378\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00379\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00380\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00385\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_abab201b5b552f2c44784663b608d5aca}{FindApproxPath::}}}
\DoxyCodeLine{00386\ \mbox{\hyperlink{classFindApproxPath_abab201b5b552f2c44784663b608d5aca}{add\_match\_many}}(\textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00387\ \ \ Component\ comp;}
\DoxyCodeLine{00388\ \ \ comp.\_type\ =\ CT\_match\_many;}
\DoxyCodeLine{00389\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00390\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00391\ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00396\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFindApproxPath_ade3bcfc63642c56afe9b81adb6e66a2e}{FindApproxPath::}}}
\DoxyCodeLine{00397\ \mbox{\hyperlink{classFindApproxPath_ade3bcfc63642c56afe9b81adb6e66a2e}{add\_match\_pointer}}(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *pointer,\ \textcolor{keywordtype}{int}\ flags)\ \{}
\DoxyCodeLine{00398\ \ \ Component\ comp;}
\DoxyCodeLine{00399\ \ \ comp.\_type\ =\ CT\_match\_pointer;}
\DoxyCodeLine{00400\ \ \ comp.\_pointer\ =\ pointer;}
\DoxyCodeLine{00401\ \ \ comp.\_flags\ =\ flags;}
\DoxyCodeLine{00402\ \ \ \_path.push\_back(comp);}
\DoxyCodeLine{00403\ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00408\ \textcolor{keywordtype}{void}\ FindApproxPath::}
\DoxyCodeLine{00409\ output(ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00410\ \ \ out\ <<\ \textcolor{stringliteral}{"{}("{}};}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{if}\ (!\_path.empty())\ \{}
\DoxyCodeLine{00412\ \ \ \ \ Path::const\_iterator\ pi\ =\ \_path.begin();}
\DoxyCodeLine{00413\ \ \ \ \ out\ <<\ *pi;}
\DoxyCodeLine{00414\ \ \ \ \ ++pi;}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{while}\ (pi\ !=\ \_path.end())\ \{}
\DoxyCodeLine{00416\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ /\ "{}}\ <<\ *pi;}
\DoxyCodeLine{00417\ \ \ \ \ \ \ ++pi;}
\DoxyCodeLine{00418\ \ \ \ \ \}}
\DoxyCodeLine{00419\ \ \ \}}
\DoxyCodeLine{00420\ \ \ out\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00421\ \}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00423\ ostream\ \&}
\DoxyCodeLine{00424\ operator\ <<\ (ostream\ \&out,\ FindApproxPath::ComponentType\ type)\ \{}
\DoxyCodeLine{00425\ \ \ \textcolor{keywordflow}{switch}\ (type)\ \{}
\DoxyCodeLine{00426\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_name:}
\DoxyCodeLine{00427\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_name"{}};}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_name\_insensitive:}
\DoxyCodeLine{00430\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_name\_insensitive"{}};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_name\_glob:}
\DoxyCodeLine{00433\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_name\_glob"{}};}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_exact\_type:}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_exact\_type"{}};}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_inexact\_type:}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_inexact\_type"{}};}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_tag:}
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_tag"{}};}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_tag\_value:}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_tag\_value"{}};}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_one:}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_one"{}};}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_many:}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_many"{}};}
\DoxyCodeLine{00452\ }
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{case}\ FindApproxPath::CT\_match\_pointer:}
\DoxyCodeLine{00454\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}match\_pointer"{}};}
\DoxyCodeLine{00455\ \ \ \};}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}**invalid**"{}};}
\DoxyCodeLine{00458\ \};}

\end{DoxyCode}
