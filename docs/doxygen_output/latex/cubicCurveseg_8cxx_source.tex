\doxysection{cubic\+Curveseg.\+cxx}
\hypertarget{cubicCurveseg_8cxx_source}{}\label{cubicCurveseg_8cxx_source}\index{panda/src/parametrics/cubicCurveseg.cxx@{panda/src/parametrics/cubicCurveseg.cxx}}
\mbox{\hyperlink{cubicCurveseg_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{piecewiseCurve_8h}{piecewiseCurve.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__parametrics_8h}{config\_parametrics.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{hermiteCurve_8h}{hermiteCurve.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ CubicCurveseg::\_type\_handle;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00029\ CubicCurveseg::}
\DoxyCodeLine{00030\ CubicCurveseg()\ \{}
\DoxyCodeLine{00031\ \}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00037\ CubicCurveseg::}
\DoxyCodeLine{00038\ CubicCurveseg(\textcolor{keyword}{const}\ LMatrix4\ \&basis)\ \{}
\DoxyCodeLine{00039\ \ \ Bx\ =\ basis.get\_col(0);}
\DoxyCodeLine{00040\ \ \ By\ =\ basis.get\_col(1);}
\DoxyCodeLine{00041\ \ \ Bz\ =\ basis.get\_col(2);}
\DoxyCodeLine{00042\ \ \ Bw\ =\ basis.get\_col(3);}
\DoxyCodeLine{00043\ \ \ rational\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00044\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ CubicCurveseg::}
\DoxyCodeLine{00051\ CubicCurveseg(\textcolor{keyword}{const}\ \mbox{\hyperlink{structParametricCurve_1_1BezierSeg}{BezierSeg}}\ \&seg)\ \{}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{classCubicCurveseg_a0ffe100be50329e91a7a5ae60edd86de}{bezier\_basis}}(seg);}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00060\ CubicCurveseg::}
\DoxyCodeLine{00061\ CubicCurveseg(\textcolor{keywordtype}{int}\ order,\ \textcolor{keyword}{const}\ PN\_stdfloat\ knots[],\ \textcolor{keyword}{const}\ LVecBase4\ cvs[])\ \{}
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{classCubicCurveseg_ae410df9c51d74b47a9cc4d4670f46c85}{nurbs\_basis}}(order,\ knots,\ cvs);}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00068\ CubicCurveseg::}
\DoxyCodeLine{00069\ \string~CubicCurveseg()\ \{}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{bool}\ CubicCurveseg::}
\DoxyCodeLine{00078\ get\_point(PN\_stdfloat\ t,\ LVecBase3\ \&point)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ PN\_stdfloat\ t\_sqrd\ =\ t*t;}
\DoxyCodeLine{00080\ \ \ evaluate\_point(LVecBase4(t*t\_sqrd,\ t\_sqrd,\ t,\ 1.0f),\ point);}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00082\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00087\ \textcolor{keywordtype}{bool}\ CubicCurveseg::}
\DoxyCodeLine{00088\ get\_tangent(PN\_stdfloat\ t,\ LVecBase3\ \&tangent)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00089\ \ \ evaluate\_vector(LVecBase4(3.0f*t*t,\ 2.0f*t,\ 1.0f,\ 0.0f),\ tangent);}
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00097\ \textcolor{keywordtype}{bool}\ CubicCurveseg::}
\DoxyCodeLine{00098\ get\_pt(PN\_stdfloat\ t,\ LVecBase3\ \&point,\ LVecBase3\ \&tangent)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00099\ \ \ PN\_stdfloat\ t\_sqrd=t*t;}
\DoxyCodeLine{00100\ \ \ evaluate\_point(LVecBase4(t*t\_sqrd,\ t\_sqrd,\ t,\ 1.0f),\ point);}
\DoxyCodeLine{00101\ \ \ evaluate\_vector(LVecBase4(3.0f*t\_sqrd,\ \textcolor{comment}{/*2.0f*t*/}t+t,\ 1.0f,\ 0.0f),\ tangent);}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00108\ \textcolor{keywordtype}{bool}\ CubicCurveseg::}
\DoxyCodeLine{00109\ get\_2ndtangent(PN\_stdfloat\ t,\ LVecBase3\ \&tangent2)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00110\ \ \ evaluate\_vector(LVecBase4(6.0f*t,\ 2.0f,\ 0.0f,\ 0.0f),\ tangent2);}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00112\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00120\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_a899e5e58b29721e718dc98e50c8eec60}{CubicCurveseg::}}}
\DoxyCodeLine{00121\ \mbox{\hyperlink{classCubicCurveseg_a899e5e58b29721e718dc98e50c8eec60}{hermite\_basis}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classHermiteCurveCV}{HermiteCurveCV}}\ \&cv0,}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classHermiteCurveCV}{HermiteCurveCV}}\ \&cv1,}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ tlength)\ \{}
\DoxyCodeLine{00124\ \ \ \textcolor{keyword}{static}\ LMatrix4}
\DoxyCodeLine{00125\ \ \ \ \ Mh(\ 2.0f,\ -\/3.0f,\ 0.0f,\ 1.0f,}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ -\/2.0f,\ \ 3.0f,\ 0.0f,\ 0.0f,}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ 1.0f,\ -\/2.0f,\ 1.0f,\ 0.0f,}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ 1.0f,\ -\/1.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ LVecBase4\ Gx(cv0.\_p[0],\ cv1.\_p[0],}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv0.\_out[0]*tlength,\ cv1.\_in[0]*tlength);}
\DoxyCodeLine{00132\ \ \ LVecBase4\ Gy(cv0.\_p[1],\ cv1.\_p[1],}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv0.\_out[1]*tlength,\ cv1.\_in[1]*tlength);}
\DoxyCodeLine{00134\ \ \ LVecBase4\ Gz(cv0.\_p[2],\ cv1.\_p[2],}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cv0.\_out[2]*tlength,\ cv1.\_in[2]*tlength);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ Bx\ =\ Gx\ *\ Mh;}
\DoxyCodeLine{00138\ \ \ By\ =\ Gy\ *\ Mh;}
\DoxyCodeLine{00139\ \ \ Bz\ =\ Gz\ *\ Mh;}
\DoxyCodeLine{00140\ \ \ rational\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00148\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_a0ffe100be50329e91a7a5ae60edd86de}{CubicCurveseg::}}}
\DoxyCodeLine{00149\ \mbox{\hyperlink{classCubicCurveseg_a0ffe100be50329e91a7a5ae60edd86de}{bezier\_basis}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structParametricCurve_1_1BezierSeg}{BezierSeg}}\ \&seg)\ \{}
\DoxyCodeLine{00150\ \ \ \textcolor{keyword}{static}\ LMatrix4}
\DoxyCodeLine{00151\ \ \ \ \ Mb(-\/1.0f,\ \ 3.0f,\ -\/3.0f,\ 1.0f,}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ 3.0f,\ -\/6.0f,\ \ 3.0f,\ 0.0f,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ -\/3.0f,\ \ 3.0f,\ \ 0.0f,\ 0.0f,}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ 1.0f,\ \ 0.0f,\ \ 0.0f,\ 0.0f);}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ LVecBase4\ Gx(seg.\_v[0][0],\ seg.\_v[1][0],\ seg.\_v[2][0],\ seg.\_v[3][0]);}
\DoxyCodeLine{00157\ \ \ LVecBase4\ Gy(seg.\_v[0][1],\ seg.\_v[1][1],\ seg.\_v[2][1],\ seg.\_v[3][1]);}
\DoxyCodeLine{00158\ \ \ LVecBase4\ Gz(seg.\_v[0][2],\ seg.\_v[1][2],\ seg.\_v[2][2],\ seg.\_v[3][2]);}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ Bx\ =\ Gx\ *\ Mb;}
\DoxyCodeLine{00161\ \ \ By\ =\ Gy\ *\ Mb;}
\DoxyCodeLine{00162\ \ \ Bz\ =\ Gz\ *\ Mb;}
\DoxyCodeLine{00163\ \ \ rational\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \textcolor{keyword}{static}\ LVecBase4}
\DoxyCodeLine{00167\ nurbs\_blending\_function(\textcolor{keywordtype}{int}\ order,\ \textcolor{keywordtype}{int}\ i,\ \textcolor{keywordtype}{int}\ j,}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PN\_stdfloat\ knots[])\ \{}
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ This\ is\ doubly\ recursive.\ \ Ick.}}
\DoxyCodeLine{00170\ \ \ LVecBase4\ r;}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (j==1)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordflow}{if}\ (i==order-\/1\ \&\&\ knots[i]\ <\ knots[i+1])\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ r.set(0.0f,\ 0.0f,\ 0.0f,\ 1.0f);}
\DoxyCodeLine{00175\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ r.set(0.0f,\ 0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00177\ \ \ \ \ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00180\ \ \ \ \ LVecBase4\ bi0\ =\ nurbs\_blending\_function(order,\ i,\ j-\/1,\ knots);}
\DoxyCodeLine{00181\ \ \ \ \ LVecBase4\ bi1\ =\ nurbs\_blending\_function(order,\ i+1,\ j-\/1,\ knots);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ PN\_stdfloat\ d0\ =\ knots[i+j-\/1]\ -\/\ knots[i];}
\DoxyCodeLine{00184\ \ \ \ \ PN\_stdfloat\ d1\ =\ knots[i+j]\ -\/\ knots[i+1];}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{comment}{//\ First\ term.\ \ Division\ by\ zero\ is\ defined\ to\ equal\ zero.}}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{if}\ (d0\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d1\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ r\ =\ bi0\ /\ d0\ -\/\ bi1\ /\ d1;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ r\ =\ bi0\ /\ d0;}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (d1\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ \ \ r\ =\ -\/\ bi1\ /\ d1;}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ r.set(0.0f,\ 0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00199\ \ \ \ \ \}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{comment}{//\ scale\ by\ t.}}
\DoxyCodeLine{00202\ \ \ \ \ r[0]\ =\ r[1];}
\DoxyCodeLine{00203\ \ \ \ \ r[1]\ =\ r[2];}
\DoxyCodeLine{00204\ \ \ \ \ r[2]\ =\ r[3];}
\DoxyCodeLine{00205\ \ \ \ \ r[3]\ =\ 0.0f;}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{comment}{//\ Second\ term.}}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ (d0\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (d1\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ r\ +=\ bi0\ *\ (-\/\ knots[i]\ /\ d0)\ +\ bi1\ *\ (knots[i+j]\ /\ d1);}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ r\ +=\ bi0\ *\ (-\/\ knots[i]\ /\ d0);}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00215\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (d1\ !=\ 0.0f)\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \ \ r\ +=\ bi1\ *\ (knots[i+j]\ /\ d1);}
\DoxyCodeLine{00217\ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{return}\ r;}
\DoxyCodeLine{00221\ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00224\ compute\_nurbs\_basis(\textcolor{keywordtype}{int}\ order,}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PN\_stdfloat\ knots\_in[],}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LMatrix4\ \&basis)\ \{}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ Scale\ the\ supplied\ knots\ to\ the\ range\ 0..1.}}
\DoxyCodeLine{00230\ \ \ PN\_stdfloat\ knots[8];}
\DoxyCodeLine{00231\ \ \ PN\_stdfloat\ mink\ =\ knots\_in[order-\/1];}
\DoxyCodeLine{00232\ \ \ PN\_stdfloat\ maxk\ =\ knots\_in[order];}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \textcolor{keywordflow}{if}\ (mink==maxk)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{comment}{//\ Huh.\ \ What\ were\ you\ thinking?\ \ This\ is\ a\ trivial\ NURBS.}}
\DoxyCodeLine{00236\ \ \ \ \ parametrics\_cat-\/>warning()}
\DoxyCodeLine{00237\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Trivial\ NURBS\ curve\ specified."{}}\ <<\ std::endl;}
\DoxyCodeLine{00238\ \ \ \ \ memset((\textcolor{keywordtype}{void}\ *)\&basis,\ 0,\ \textcolor{keyword}{sizeof}(LMatrix4));}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00240\ \ \ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i<2*order;\ i++)\ \{}
\DoxyCodeLine{00243\ \ \ \ \ knots[i]\ =\ (knots\_in[i]\ -\/\ mink)\ /\ (maxk-\/mink);}
\DoxyCodeLine{00244\ \ \ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ LVecBase4\ b[4];}
\DoxyCodeLine{00248\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i<order;\ i++)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ b[i]\ =\ nurbs\_blending\_function(order,\ i,\ order,\ knots);}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i<order;\ i++)\ \{}
\DoxyCodeLine{00253\ \ \ \ \ basis.set\_row(i,\ b[i]);}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keywordflow}{for}\ (i=order;\ i<4;\ i++)\ \{}
\DoxyCodeLine{00257\ \ \ \ \ basis.set\_row(i,\ LVecBase4::zero());}
\DoxyCodeLine{00258\ \ \ \}}
\DoxyCodeLine{00259\ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00268\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_ae410df9c51d74b47a9cc4d4670f46c85}{CubicCurveseg::}}}
\DoxyCodeLine{00269\ \mbox{\hyperlink{classCubicCurveseg_ae410df9c51d74b47a9cc4d4670f46c85}{nurbs\_basis}}(\textcolor{keywordtype}{int}\ order,\ \textcolor{keyword}{const}\ PN\_stdfloat\ knots[],\ \textcolor{keyword}{const}\ LVecBase4\ cvs[])\ \{}
\DoxyCodeLine{00270\ \ \ assert(order>=1\ \&\&\ order<=4);}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ LMatrix4\ B;}
\DoxyCodeLine{00273\ \ \ compute\_nurbs\_basis(order,\ knots,\ B);}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \textcolor{comment}{//\ Create\ a\ local\ copy\ of\ our\ CV's,\ so\ we\ can\ zero\ out\ the\ unused\ elements.}}
\DoxyCodeLine{00276\ \ \ LVecBase4\ c[4];}
\DoxyCodeLine{00277\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 4;\ i++)\ \{}
\DoxyCodeLine{00278\ \ \ \ \ c[i]\ =\ (i<order)\ ?\ cvs[i]\ :\ LVecBase4(0.0f,\ 0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00279\ \ \ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ Bx\ =\ LVecBase4(c[0][0],\ c[1][0],\ c[2][0],\ c[3][0])\ *\ B;}
\DoxyCodeLine{00282\ \ \ By\ =\ LVecBase4(c[0][1],\ c[1][1],\ c[2][1],\ c[3][1])\ *\ B;}
\DoxyCodeLine{00283\ \ \ Bz\ =\ LVecBase4(c[0][2],\ c[1][2],\ c[2][2],\ c[3][2])\ *\ B;}
\DoxyCodeLine{00284\ \ \ Bw\ =\ LVecBase4(c[0][3],\ c[1][3],\ c[2][3],\ c[3][3])\ *\ B;}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ rational\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00287\ \}}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00294\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classCubicCurveseg_ad44e19e75dd0980138e36dd70d8182c3}{CubicCurveseg::}}}
\DoxyCodeLine{00295\ \mbox{\hyperlink{classCubicCurveseg_ad44e19e75dd0980138e36dd70d8182c3}{get\_bezier\_seg}}(\mbox{\hyperlink{structParametricCurve_1_1BezierSeg}{BezierSeg}}\ \&seg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{static}\ LMatrix4}
\DoxyCodeLine{00297\ \ \ \ \ Mbi(0.0f,\ 0.0f,\ 0.0f,\ 1.0f,}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ 0.0f,\ 0.0f,\ 1.0f/3.0f,\ 1.0f,}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ 0.0f,\ 1.0f/3.0f,\ 2.0f/3.0f,\ 1.0f,}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ 1.0f,\ 1.0f,\ 1.0f,\ 1.0f);}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ LVecBase4\ Gx\ =\ Bx\ *\ Mbi;}
\DoxyCodeLine{00303\ \ \ LVecBase4\ Gy\ =\ By\ *\ Mbi;}
\DoxyCodeLine{00304\ \ \ LVecBase4\ Gz\ =\ Bz\ *\ Mbi;}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{keywordflow}{if}\ (rational)\ \{}
\DoxyCodeLine{00307\ \ \ \ \ LVecBase4\ Gw\ =\ Bw\ *\ Mbi;}
\DoxyCodeLine{00308\ \ \ \ \ seg.\_v[0].set(Gx[0]/Gw[0],\ Gy[0]/Gw[0],\ Gz[0]/Gw[0]);}
\DoxyCodeLine{00309\ \ \ \ \ seg.\_v[1].set(Gx[1]/Gw[1],\ Gy[1]/Gw[1],\ Gz[1]/Gw[1]);}
\DoxyCodeLine{00310\ \ \ \ \ seg.\_v[2].set(Gx[2]/Gw[2],\ Gy[2]/Gw[2],\ Gz[2]/Gw[2]);}
\DoxyCodeLine{00311\ \ \ \ \ seg.\_v[3].set(Gx[3]/Gw[3],\ Gy[3]/Gw[3],\ Gz[3]/Gw[3]);}
\DoxyCodeLine{00312\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00313\ \ \ \ \ seg.\_v[0].set(Gx[0],\ Gy[0],\ Gz[0]);}
\DoxyCodeLine{00314\ \ \ \ \ seg.\_v[1].set(Gx[1],\ Gy[1],\ Gz[1]);}
\DoxyCodeLine{00315\ \ \ \ \ seg.\_v[2].set(Gx[2],\ Gy[2],\ Gz[2]);}
\DoxyCodeLine{00316\ \ \ \ \ seg.\_v[3].set(Gx[3],\ Gy[3],\ Gz[3]);}
\DoxyCodeLine{00317\ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00320\ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \textcolor{comment}{//\ We\ need\ this\ operator\ since\ Performer\ didn't\ supply\ it.}}
\DoxyCodeLine{00323\ \textcolor{keyword}{inline}\ LVecBase4}
\DoxyCodeLine{00324\ col\_mult(\textcolor{keyword}{const}\ LMatrix4\ \&M,\ \textcolor{keyword}{const}\ LVecBase4\ \&v)\ \{}
\DoxyCodeLine{00325\ \ \ \textcolor{keywordflow}{return}\ LVecBase4(M(0,0)*v[0]\ +\ M(0,1)*v[1]\ +\ M(0,2)*v[2]\ +\ M(0,3)*v[3],}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M(1,0)*v[0]\ +\ M(1,1)*v[1]\ +\ M(1,2)*v[2]\ +\ M(1,3)*v[3],}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M(2,0)*v[0]\ +\ M(2,1)*v[1]\ +\ M(2,2)*v[2]\ +\ M(2,3)*v[3],}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ M(3,0)*v[0]\ +\ M(3,1)*v[1]\ +\ M(3,2)*v[2]\ +\ M(3,3)*v[3]);}
\DoxyCodeLine{00329\ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00335\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00336\ compute\_seg\_col(\textcolor{keywordtype}{int}\ c,}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ rtype,\ PN\_stdfloat\ t,\ \textcolor{keyword}{const}\ LVecBase4\ \&v,}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&B,}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&Bi,}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&G,}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&GB,}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ LMatrix4\ \&T,\ LMatrix4\ \&P)\ \{}
\DoxyCodeLine{00343\ \ \ \textcolor{keywordtype}{bool}\ keep\_orig\ =\ ((rtype\ \&\ RT\_KEEP\_ORIG)\ !=\ 0);}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_debug())\ \{}
\DoxyCodeLine{00346\ \ \ \ \ parametrics\_cat.debug()}
\DoxyCodeLine{00347\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Computing\ col\ "{}}\ <<\ c\ <<\ \textcolor{stringliteral}{"{}\ type\ "{}}\ <<\ (rtype\ \&\ RT\_BASE\_TYPE)}
\DoxyCodeLine{00348\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ at\ "{}}\ <<\ t\ <<\ \textcolor{stringliteral}{"{}\ keep\_orig\ =\ "{}}\ <<\ keep\_orig}
\DoxyCodeLine{00349\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ v\ =\ "{}}\ <<\ v\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{keywordflow}{switch}\ (rtype\ \&\ RT\_BASE\_TYPE)\ \{}
\DoxyCodeLine{00353\ \ \ \ \ \textcolor{comment}{//\ RT\_point\ defines\ the\ point\ on\ the\ curve\ at\ t.\ \ This\ is\ the\ vector\ [\ t\string^3}}
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{comment}{//\ t\string^2\ t\string^1\ t\string^0\ ].}}
\DoxyCodeLine{00355\ \ \ \ \ PN\_stdfloat\ t\_sqrd,t\_cubed;}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{case}\ RT\_POINT:}
\DoxyCodeLine{00358\ \ \ \ \ t\_sqrd\ =\ t*t;}
\DoxyCodeLine{00359\ \ \ \ \ t\_cubed\ =\ t\_sqrd*t;}
\DoxyCodeLine{00360\ \ \ \ \ T.set\_col(c,\ LVecBase4(t\_cubed,\ t\_sqrd,\ t,\ 1.0f));}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{if}\ (keep\_orig)\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ LVecBase4\ vec(t\_cubed,\ t\_sqrd,\ t,\ 1.0f);}
\DoxyCodeLine{00363\ \ \ \ \ \ \ LVecBase4\ ov\ =\ col\_mult(GB,\ vec);}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_debug())\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ parametrics\_cat.debug()}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}orig\ point\ =\ "{}}\ <<\ ov\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ P.set\_col(c,\ ov);}
\DoxyCodeLine{00369\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ P.set\_col(c,\ v);}
\DoxyCodeLine{00371\ \ \ \ \ \}}
\DoxyCodeLine{00372\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{comment}{//\ RT\_tangent\ defines\ the\ tangent\ to\ the\ curve\ at\ t.\ \ This\ is\ the\ vector\ [}}
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{comment}{//\ 3t\string^2\ 2t\ 1\ 0\ ].}}
\DoxyCodeLine{00376\ \ \ \textcolor{keywordflow}{case}\ RT\_TANGENT:}
\DoxyCodeLine{00377\ \ \ \ \ t\_sqrd\ =\ t*t;}
\DoxyCodeLine{00378\ \ \ \ \ T.set\_col(c,\ LVecBase4(3.0f*t\_sqrd,\ t+t,\ 1.0f,\ 0.0f));}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{if}\ (keep\_orig)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ LVecBase4\ vec(3.0f*t\_sqrd,\ \textcolor{comment}{/*2.0f*t*/}t+t,\ 1.0f,\ 0.0f);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ LVecBase4\ ov\ =\ col\_mult(GB,\ vec);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_debug())\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ parametrics\_cat.debug()}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Matrix\ is:\(\backslash\)n"{}};}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ GB.write(parametrics\_cat.debug(\textcolor{keyword}{false}),\ 2);}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ parametrics\_cat.debug(\textcolor{keyword}{false})}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}vector\ is\ "{}}\ <<\ vec\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}orig\ tangent\ =\ "{}}\ <<\ ov\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ P.set\_col(c,\ ov);}
\DoxyCodeLine{00391\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ P.set\_col(c,\ v);}
\DoxyCodeLine{00393\ \ \ \ \ \}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{comment}{//\ RT\_cv\ defines\ the\ cth\ control\ point.\ \ This\ is\ the\ cth\ column\ vector}}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{comment}{//\ from\ Bi.}}
\DoxyCodeLine{00398\ \ \ \textcolor{keywordflow}{case}\ RT\_CV:}
\DoxyCodeLine{00399\ \ \ \ \ T.set\_col(c,\ Bi.get\_col(c));}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{if}\ (keep\_orig)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_debug())\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ parametrics\_cat.debug()}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}orig\ CV\ =\ "{}}\ <<\ G.get\_col(c)\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ P.set\_col(c,\ G.get\_col(c));}
\DoxyCodeLine{00406\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00407\ \ \ \ \ \ \ P.set\_col(c,\ v);}
\DoxyCodeLine{00408\ \ \ \ \ \}}
\DoxyCodeLine{00409\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00412\ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Invalid\ rebuild\ type\ in\ compute\_seg\(\backslash\)n"{}};}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00414\ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00417\ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00458\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classCubicCurveseg_af82a33052581a1016172ee4a3696ca8c}{CubicCurveseg::}}}
\DoxyCodeLine{00459\ \mbox{\hyperlink{classCubicCurveseg_af82a33052581a1016172ee4a3696ca8c}{compute\_seg}}(\textcolor{keywordtype}{int}\ rtype0,\ PN\_stdfloat\ t0,\ \textcolor{keyword}{const}\ LVecBase4\ \&v0,}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ rtype1,\ PN\_stdfloat\ t1,\ \textcolor{keyword}{const}\ LVecBase4\ \&v1,}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ rtype2,\ PN\_stdfloat\ t2,\ \textcolor{keyword}{const}\ LVecBase4\ \&v2,}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ rtype3,\ PN\_stdfloat\ t3,\ \textcolor{keyword}{const}\ LVecBase4\ \&v3,}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&B,}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LMatrix4\ \&Bi,}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ LMatrix4\ \&G)\ \{}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \textcolor{comment}{//\ We\ can\ define\ a\ cubic\ curve\ segment\ given\ four\ arbitrary\ properties\ of}}
\DoxyCodeLine{00468\ \ \ \textcolor{comment}{//\ the\ segment:\ any\ point\ along\ the\ curve,\ any\ tangent\ along\ the\ curve,\ any}}
\DoxyCodeLine{00469\ \ \ \textcolor{comment}{//\ control\ point.\ \ Given\ any\ four\ such\ properties,\ a\ single\ cubic\ curve}}
\DoxyCodeLine{00470\ \ \ \textcolor{comment}{//\ segment\ is\ defined.}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{comment}{//\ For\ a\ given\ cubic\ curve\ segment\ so\ defined,\ and\ given\ a\ basis\ matrix\ B,}}
\DoxyCodeLine{00473\ \ \ \textcolor{comment}{//\ we\ can\ define\ the\ four\ control\ vertices\ that\ represent\ the\ segment\ with}}
\DoxyCodeLine{00474\ \ \ \textcolor{comment}{//\ the\ basis\ matrix.\ \ That\ is,\ we\ can\ define\ the\ matrix\ G\ such\ that\ G\ *\ B\ *}}
\DoxyCodeLine{00475\ \ \ \textcolor{comment}{//\ tc,\ where\ tc\ is\ [\ t\string^3\ t\string^2\ t\string^1\ t\string^0\ ]\ for\ t\ in\ [\ 0..1\ ],\ represents\ the}}
\DoxyCodeLine{00476\ \ \ \textcolor{comment}{//\ point\ on\ the\ curve\ segment\ corresponding\ to\ t.}}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \textcolor{comment}{//\ First,\ we\ build\ a\ matrix\ T,\ such\ that\ each\ of\ the\ four\ columns\ of\ T}}
\DoxyCodeLine{00479\ \ \ \textcolor{comment}{//\ contains\ the\ vector\ that\ would\ compute\ the\ corresponding\ property.\ \ We}}
\DoxyCodeLine{00480\ \ \ \textcolor{comment}{//\ also\ build\ a\ corresponding\ matrix\ P,\ such\ that\ each\ of\ its\ columns}}
\DoxyCodeLine{00481\ \ \ \textcolor{comment}{//\ contains\ the\ vector\ that\ is\ the\ solution\ of\ the\ corresponding\ column\ in}}
\DoxyCodeLine{00482\ \ \ \textcolor{comment}{//\ T.}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ LMatrix4\ T,\ P,\ GB;}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \textcolor{comment}{//\ GB\ is\ G\ *\ B,\ but\ we\ only\ need\ to\ compute\ this\ if\ any\ of\ the\ columns\ wants}}
\DoxyCodeLine{00487\ \ \ \textcolor{comment}{//\ the\ value\ from\ the\ original\ G.}}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{if}\ ((rtype0\ |\ rtype1\ |\ rtype2\ |\ rtype3)\ \&\ RT\_KEEP\_ORIG)\ \{}
\DoxyCodeLine{00489\ \ \ \ \ GB\ =\ G\ *\ B;}
\DoxyCodeLine{00490\ \ \ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \textcolor{keywordflow}{if}\ (!\ (compute\_seg\_col(0,\ rtype0,\ t0,\ v0,\ B,\ Bi,\ G,\ GB,\ T,\ P)\ \&\&}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ compute\_seg\_col(1,\ rtype1,\ t1,\ v1,\ B,\ Bi,\ G,\ GB,\ T,\ P)\ \&\&}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ compute\_seg\_col(2,\ rtype2,\ t2,\ v2,\ B,\ Bi,\ G,\ GB,\ T,\ P)\ \&\&}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ compute\_seg\_col(3,\ rtype3,\ t3,\ v3,\ B,\ Bi,\ G,\ GB,\ T,\ P)))\ \{}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00497\ \ \ \}}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ LMatrix4\ Ti;}
\DoxyCodeLine{00500\ \ \ Ti\ =\ invert(T);}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \textcolor{comment}{//\ Now\ we\ have\ T\ and\ P\ such\ that\ P\ represents\ the\ solution\ of\ T,\ when\ T\ is}}
\DoxyCodeLine{00503\ \ \ \textcolor{comment}{//\ applied\ to\ the\ geometry\ and\ basis\ matrices.\ \ That\ is,\ each\ column\ of\ P}}
\DoxyCodeLine{00504\ \ \ \textcolor{comment}{//\ represents\ the\ solution\ computed\ by\ the\ corresponding\ column\ of\ T.\ \ P\ =\ G}}
\DoxyCodeLine{00505\ \ \ \textcolor{comment}{//\ *\ B\ *\ T.}}
\DoxyCodeLine{00506\ }
\DoxyCodeLine{00507\ \ \ \textcolor{comment}{//\ We\ simply\ solve\ for\ G\ and\ get\ G\ =\ P\ *\ T\string^(-\/1)\ *\ B\string^(-\/1).}}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ G\ =\ P\ *\ Ti\ *\ Bi;}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00512\ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00517\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_a926cbe3d2d9d7fccd9a90c5f8fb41d1a}{CubicCurveseg::}}}
\DoxyCodeLine{00518\ \mbox{\hyperlink{classCubicCurveseg_a926cbe3d2d9d7fccd9a90c5f8fb41d1a}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00519\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classCubicCurveseg_a93f39356c9cab32d378e26984758cb9b}{make\_from\_bam}});}
\DoxyCodeLine{00520\ \}}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00525\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classCubicCurveseg_a93f39356c9cab32d378e26984758cb9b}{CubicCurveseg::}}}
\DoxyCodeLine{00526\ \mbox{\hyperlink{classCubicCurveseg_a93f39356c9cab32d378e26984758cb9b}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00527\ \ \ \mbox{\hyperlink{classCubicCurveseg}{CubicCurveseg}}\ *me\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classCubicCurveseg}{CubicCurveseg}};}
\DoxyCodeLine{00528\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00529\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00532\ \ \ me-\/>\mbox{\hyperlink{classCubicCurveseg_a3303653497efd53a9f137d60fbd632a9}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00533\ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{00534\ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00540\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_a09be1852b0187a9ebb6dae1b9ec86fe0}{CubicCurveseg::}}}
\DoxyCodeLine{00541\ \mbox{\hyperlink{classCubicCurveseg_a09be1852b0187a9ebb6dae1b9ec86fe0}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{00542\ \ \ \mbox{\hyperlink{classParametricCurve_ad9e07d824908e0ed361c8db20fbe54ce}{ParametricCurve::write\_datagram}}(manager,\ me);}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ Bx.write\_datagram(me);}
\DoxyCodeLine{00545\ \ \ By.write\_datagram(me);}
\DoxyCodeLine{00546\ \ \ Bz.write\_datagram(me);}
\DoxyCodeLine{00547\ \ \ Bw.write\_datagram(me);}
\DoxyCodeLine{00548\ \ \ me.add\_bool(rational);}
\DoxyCodeLine{00549\ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00556\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCubicCurveseg_a3303653497efd53a9f137d60fbd632a9}{CubicCurveseg::}}}
\DoxyCodeLine{00557\ \mbox{\hyperlink{classCubicCurveseg_a3303653497efd53a9f137d60fbd632a9}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00558\ \ \ \mbox{\hyperlink{classParametricCurve_aa51af67f91e4da4d0a9ba3b4a86eddad}{ParametricCurve::fillin}}(scan,\ manager);}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00560\ \ \ Bx.read\_datagram(scan);}
\DoxyCodeLine{00561\ \ \ By.read\_datagram(scan);}
\DoxyCodeLine{00562\ \ \ Bz.read\_datagram(scan);}
\DoxyCodeLine{00563\ \ \ Bw.read\_datagram(scan);}
\DoxyCodeLine{00564\ \ \ rational\ =\ scan.get\_bool();}
\DoxyCodeLine{00565\ \}}

\end{DoxyCode}
