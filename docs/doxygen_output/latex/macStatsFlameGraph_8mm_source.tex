\doxysection{mac\+Stats\+Flame\+Graph.\+mm}
\hypertarget{macStatsFlameGraph_8mm_source}{}\label{macStatsFlameGraph_8mm_source}\index{pandatool/src/mac-\/stats/macStatsFlameGraph.mm@{pandatool/src/mac-\/stats/macStatsFlameGraph.mm}}
\mbox{\hyperlink{macStatsFlameGraph_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsFlameGraph_8h}{macStatsFlameGraph.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsMonitor_8h}{macStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsGraphView_8h}{macStatsGraphView.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsScaleArea_8h}{macStatsScaleArea.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatCollectorDef_8h}{pStatCollectorDef.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cocoa__compat_8h}{cocoa\_compat.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{@interface\ }\mbox{\hyperlink{interfaceMacStatsFlameGraphViewController}{MacStatsFlameGraphViewController}}\ :\ \mbox{\hyperlink{interfaceMacStatsGraphViewController}{MacStatsGraphViewController}}}
\DoxyCodeLine{00022\ \textcolor{keyword}{@end}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_flame\_graph\_width\ =\ 800;}
\DoxyCodeLine{00025\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_flame\_graph\_height\ =\ 250;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ MacStatsFlameGraph::}
\DoxyCodeLine{00031\ MacStatsFlameGraph(\mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor,\ \textcolor{keywordtype}{int}\ thread\_index,}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ :}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classPStatFlameGraph}{PStatFlameGraph}}(monitor,\ thread\_index,\ collector\_index,\ frame\_number,\ 0,\ 0),}
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classMacStatsGraph}{MacStatsGraph}}(monitor,\ [\mbox{\hyperlink{interfaceMacStatsFlameGraphViewController}{MacStatsFlameGraphViewController}}\ alloc])}
\DoxyCodeLine{00035\ \{}
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ Used\ for\ popup\ menus.}}
\DoxyCodeLine{00037\ \ \ \_menu\_delegate\ =\ [[\mbox{\hyperlink{interfaceMacStatsChartMenuDelegate}{MacStatsChartMenuDelegate}}\ alloc]\ initWithMonitor:monitor\ threadIndex:thread\_index];}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ Set\ the\ initial\ size\ of\ the\ graph.}}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordtype}{int}\ height\ =\ default\_flame\_graph\_height\ +\ \_window.frame.size.height\ -\/\ \_window.contentLayoutRect.size.height;}
\DoxyCodeLine{00041\ \ \ \_graph\_view.frame\ =\ NSMakeRect(0,\ 0,\ default\_flame\_graph\_width,\ height);}
\DoxyCodeLine{00042\ \ \ \_graph\_view\_controller.view.frame\ =\ NSMakeRect(0,\ 0,\ default\_flame\_graph\_width,\ height);}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \_total\_item\ =\ nil;}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00046\ \ \ \ \ NSToolbar\ *toolbar\ =\ [[NSToolbar\ alloc]\ initWithIdentifier:@"{}"{}];}
\DoxyCodeLine{00047\ \ \ \ \ toolbar.delegate\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00048\ \ \ \ \ toolbar.displayMode\ =\ NSToolbarDisplayModeIconOnly;}
\DoxyCodeLine{00049\ \ \ \ \ \_window.toolbar\ =\ toolbar;}
\DoxyCodeLine{00050\ \ \ \ \ [\_window\ setToolbarStyle:NSWindowToolbarStyleUnifiedCompact];}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{for}\ (NSToolbarItem\ *item\ in\ toolbar.items)\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ([item.itemIdentifier\ isEqual:\textcolor{stringliteral}{@"{}total"{}}])\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \_total\_item\ =\ item;}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ \ \ \ \ [toolbar\ release];}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//MacStatsScaleAreaController\ *scale\_area\_controller\ =\ [[MacStatsScaleAreaController\ alloc]\ initWithGraph:this];}}
\DoxyCodeLine{00062\ \ \ \textcolor{comment}{//scale\_area\_controller.layoutAttribute\ =\ NSLayoutAttributeRight;}}
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\_scale\_area\ =\ scale\_area\_controller.view;}}
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//[\_window\ addTitlebarAccessoryViewController:scale\_area\_controller];}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \_window.contentViewController\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \_graph\_view\_controller.backToolbarItemVisible\ =\ NO;}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \textcolor{comment}{//\ Let's\ show\ the\ units\ on\ the\ guide\ bar\ labels.\ \ There's\ room.}}
\DoxyCodeLine{00071\ \ \ set\_guide\_bar\_units(get\_guide\_bar\_units()\ |\ GBU\_show\_units);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{if}\ (get\_average\_mode())\ \{}
\DoxyCodeLine{00074\ \ \ \ \ start\_animation();}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{if}\ (is\_title\_unknown())\ \{}
\DoxyCodeLine{00078\ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00081\ \ \ \ \ \}}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00085\ \ \ \ \ std::string\ text\ =\ format\_number(get\_horizontal\_scale(),\ get\_guide\_bar\_units(),\ get\_guide\_bar\_unit\_name());}
\DoxyCodeLine{00086\ \ \ \ \ [\_total\_item\ setTitle:[NSString\ stringWithUTF8String:text.c\_str()]];}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ [\_window\ makeKeyAndOrderFront:nil];}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ MacStatsFlameGraph::}
\DoxyCodeLine{00096\ \string~MacStatsFlameGraph()\ \{}
\DoxyCodeLine{00097\ \ \ [\_menu\_delegate\ release];}
\DoxyCodeLine{00098\ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00103\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a9dd7486e38c8a474118b3dbfe7a67608}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00104\ \mbox{\hyperlink{classMacStatsFlameGraph_a9dd7486e38c8a474118b3dbfe7a67608}{new\_collector}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00105\ \ \ \mbox{\hyperlink{classMacStatsGraph_a7d2d70b5ae3435b56c1d61492d912d3e}{MacStatsGraph::new\_collector}}(collector\_index);}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00114\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a6c90ea42ef06b42b88c5086284bb6585}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00115\ \mbox{\hyperlink{classMacStatsFlameGraph_a6c90ea42ef06b42b88c5086284bb6585}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{if}\ (is\_title\_unknown())\ \{}
\DoxyCodeLine{00117\ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00120\ \ \ \ \ \}}
\DoxyCodeLine{00121\ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{if}\ (!\_pause)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ update();}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ std::string\ text\ =\ format\_number(get\_horizontal\_scale(),\ get\_guide\_bar\_units(),\ get\_guide\_bar\_unit\_name());}
\DoxyCodeLine{00128\ \ \ \ \ \ \ [\_total\_item\ setTitle:[NSString\ stringWithUTF8String:text.c\_str()]];}
\DoxyCodeLine{00129\ \ \ \ \ \}}
\DoxyCodeLine{00130\ \ \ \}}
\DoxyCodeLine{00131\ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00136\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a48e8f3c978dace158e3711154a9df902}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00137\ \mbox{\hyperlink{classMacStatsFlameGraph_a48e8f3c978dace158e3711154a9df902}{force\_redraw}}()\ \{}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00146\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a010dbbee236514e5ac0ee17c0854366b}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00147\ \mbox{\hyperlink{classMacStatsFlameGraph_a010dbbee236514e5ac0ee17c0854366b}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{classPStatFlameGraph_a364749482f8eb2540c32ff3ada48bed1}{PStatFlameGraph::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00149\ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00156\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a8bb4810b025cac24a389f64af8a72982}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00157\ \mbox{\hyperlink{classMacStatsFlameGraph_a8bb4810b025cac24a389f64af8a72982}{set\_time\_units}}(\textcolor{keywordtype}{int}\ unit\_mask)\ \{}
\DoxyCodeLine{00158\ \ \ \textcolor{keywordtype}{int}\ old\_unit\_mask\ =\ get\_guide\_bar\_units();}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{if}\ ((old\_unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms))\ !=\ 0)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ unit\_mask\ =\ unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms);}
\DoxyCodeLine{00161\ \ \ \ \ unit\_mask\ |=\ (old\_unit\_mask\ \&\ GBU\_show\_units);}
\DoxyCodeLine{00162\ \ \ \ \ set\_guide\_bar\_units(unit\_mask);}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \ \ std::string\ text\ =\ format\_number(get\_horizontal\_scale(),\ get\_guide\_bar\_units(),\ get\_guide\_bar\_unit\_name());}
\DoxyCodeLine{00166\ \ \ \ \ \ \ [\_total\_item\ setTitle:[NSString\ stringWithUTF8String:text.c\_str()]];}
\DoxyCodeLine{00167\ \ \ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{//\_scale\_area.needsDisplay\ =\ YES;}}
\DoxyCodeLine{00170\ \ \ \}}
\DoxyCodeLine{00171\ \}}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00176\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a3b0852773352fdee25461993936e99af}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00177\ \mbox{\hyperlink{classMacStatsFlameGraph_a3b0852773352fdee25461993936e99af}{on\_click\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordtype}{int}\ current\ =\ get\_collector\_index();}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ !=\ current)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_history\_depth()\ ==\ 0)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \_graph\_view\_controller.backToolbarItemVisible\ =\ YES;}
\DoxyCodeLine{00182\ \ \ \ \ \}}
\DoxyCodeLine{00183\ \ \ \ \ push\_collector\_index(collector\_index);}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00186\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \}}
\DoxyCodeLine{00190\ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00195\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a66bd8a157a9365cd06be27e71767e5fb}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00196\ \mbox{\hyperlink{classMacStatsFlameGraph_a66bd8a157a9365cd06be27e71767e5fb}{on\_enter\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ !=\ \_highlighted\_index)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ \_highlighted\_index\ =\ collector\_index;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{if}\ (!get\_average\_mode())\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00202\ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \}}
\DoxyCodeLine{00204\ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00209\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_ae57cc9ddfa637202736f81c0ce329aa7}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00210\ \mbox{\hyperlink{classMacStatsFlameGraph_ae57cc9ddfa637202736f81c0ce329aa7}{on\_leave\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ ==\ \_highlighted\_index\ \&\&\ collector\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{00212\ \ \ \ \ \_highlighted\_index\ =\ -\/1;}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{if}\ (!get\_average\_mode())\ \{}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatFlameGraph_a031c26dac9e2e7257a73d20ff14311eb}{PStatFlameGraph::force\_redraw}}();}
\DoxyCodeLine{00216\ \ \ \ \ \}}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00224\ NSMenu\ *\mbox{\hyperlink{classMacStatsFlameGraph_a0e9e71fedff60c6eabbf28e140ee9b64}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00225\ \mbox{\hyperlink{classMacStatsFlameGraph_a0e9e71fedff60c6eabbf28e140ee9b64}{get\_label\_menu}}(\textcolor{keywordtype}{int}\ collector\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00226\ \ \ NSMenu\ *menu\ =\ [[[NSMenu\ alloc]\ init]\ autorelease];}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ std::string\ label\ =\ get\_label\_tooltip(collector\_index);}
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 14.0,\ *))\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \ \ [menu\ addItem:[NSMenuItem\ sectionHeaderWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]]];}
\DoxyCodeLine{00232\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]\ action:nil\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00234\ \ \ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00235\ \ \ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00236\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00237\ \ \ \ \ \}}
\DoxyCodeLine{00238\ \ \ \}}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \{}
\DoxyCodeLine{00241\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Set\ as\ Focus"{}\ action:@selector(handleSetAsFocus:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00242\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00243\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00244\ \ \ \ \ item.enabled\ =\ (collector\_index\ !=\ 0\ ||\ get\_collector\_index()\ !=\ 0);}
\DoxyCodeLine{00245\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00246\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00247\ \ \ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Open\ Strip\ Chart"{}\ action:@selector(handleOpenStripChart:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00251\ \ \ \ \ item.target\ =\ \_menu\_delegate;}
\DoxyCodeLine{00252\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00253\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00254\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00255\ \ \ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \{}
\DoxyCodeLine{00258\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Open\ Flame\ Graph"{}\ action:@selector(handleOpenFlameGraph:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00259\ \ \ \ \ item.target\ =\ \_menu\_delegate;}
\DoxyCodeLine{00260\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00261\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00262\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ [menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \{}
\DoxyCodeLine{00268\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Change\ Color\(\backslash\)u2026"{}\ action:@selector(handleChangeColor:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00269\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00270\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00271\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00272\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00273\ \ \ \}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Reset\ Color"{}\ action:@selector(handleResetColor:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00277\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00278\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00279\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00280\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{return}\ menu;}
\DoxyCodeLine{00284\ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00289\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_aa2b8c7c86860884693bb5b3c78d9db7b}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00290\ \mbox{\hyperlink{classMacStatsFlameGraph_aa2b8c7c86860884693bb5b3c78d9db7b}{normal\_guide\_bars}}()\ \{}
\DoxyCodeLine{00291\ \ \ \textcolor{comment}{//\ We\ want\ vaguely\ 100\ pixels\ between\ guide\ bars.}}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordtype}{int}\ num\_bars\ =\ get\_xsize()\ /\ 100;}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \_guide\_bars.clear();}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \textcolor{keywordtype}{double}\ dist\ =\ get\_horizontal\_scale()\ /\ num\_bars;}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ num\_bars;\ ++i)\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \_guide\_bars.push\_back(make\_guide\_bar(i\ *\ dist));}
\DoxyCodeLine{00300\ \ \ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \textcolor{comment}{//nassertv\_always(\_scale\_area\ !=\ nullptr);}}
\DoxyCodeLine{00305\ \ \ \textcolor{comment}{//\_scale\_area.needsDisplay\ =\ YES;}}
\DoxyCodeLine{00306\ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00311\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a6cadba229c0ae2a68f0033d1e268c0ca}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00312\ \mbox{\hyperlink{classMacStatsFlameGraph_a6cadba229c0ae2a68f0033d1e268c0ca}{clear\_region}}()\ \{}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00314\ \ \ \ \ CGContextSetFillColorWithColor(\_ctx,\ \_background\_color);}
\DoxyCodeLine{00315\ \ \ \ \ CGContextFillRect(\_ctx,\ CGRectMake(0,\ 0,\ get\_xsize(),\ get\_ysize()));}
\DoxyCodeLine{00316\ \ \ \}}
\DoxyCodeLine{00317\ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00322\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a7a83f347b70611e756af3f3db762aed6}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00323\ \mbox{\hyperlink{classMacStatsFlameGraph_a7a83f347b70611e756af3f3db762aed6}{begin\_draw}}()\ \{}
\DoxyCodeLine{00324\ \ \ \textcolor{keywordflow}{if}\ (!\_ctx)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00326\ \ \ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ clear\_region();}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ isFlipped\ is\ true\ in\ the\ NSView,\ so\ flip\ the\ text\ again}}
\DoxyCodeLine{00331\ \ \ CGContextSetTextMatrix(\_ctx,\ CGAffineTransformMakeScale(1,\ -\/1));}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \textcolor{comment}{//\ Draw\ in\ the\ guide\ bars.}}
\DoxyCodeLine{00334\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ get\_num\_guide\_bars();}
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{GuideBar}}\ \&bar\ =\ get\_guide\_bar(i);}
\DoxyCodeLine{00337\ \ \ \ \ draw\_guide\_bar(\_ctx,\ bar);}
\DoxyCodeLine{00338\ \ \ \ \ draw\_guide\_label(\_ctx,\ bar);}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ \}}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00346\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a83d4d805f455d90e024bd314a3285e42}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00347\ \mbox{\hyperlink{classMacStatsFlameGraph_a83d4d805f455d90e024bd314a3285e42}{draw\_bar}}(\textcolor{keywordtype}{int}\ depth,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x,\ \textcolor{keywordtype}{int}\ collector\_index,\ \textcolor{keywordtype}{int}\ parent\_index)\ \{}
\DoxyCodeLine{00348\ \ \ \textcolor{keywordtype}{double}\ bottom\ =\ get\_ysize()\ -\/\ depth\ *\ 4.000\ *\ 5;}
\DoxyCodeLine{00349\ \ \ \textcolor{keywordtype}{double}\ top\ =\ bottom\ -\/\ 4.000\ *\ 5;}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ top\ +=\ 1;}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \ \ \mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor\ =\ MacStatsGraph::\_monitor;}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ collector\_index\ ==\ \_highlighted\_index;}
\DoxyCodeLine{00356\ \ \ CGContextSetFillColorWithColor(\_ctx,}
\DoxyCodeLine{00357\ \ \ \ \ monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_aee87fc182ec51348b5b0aa496c615092}{get\_collector\_color}}(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ 3)\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \textcolor{comment}{//\ It's\ just\ a\ tiny\ sliver.\ \ This\ is\ a\ more\ reliable\ way\ to\ draw\ it.}}
\DoxyCodeLine{00361\ \ \ \ \ CGRect\ rect\ =\ CGRectMake(from\_x,\ top,\ to\_x\ -\/\ from\_x,\ bottom\ -\/\ top);}
\DoxyCodeLine{00362\ \ \ \ \ CGContextFillRect(\_ctx,\ rect);}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \textcolor{keywordtype}{double}\ radius\ =\ std::min((\textcolor{keywordtype}{double})4.000,\ (to\_x\ -\/\ from\_x)\ /\ 2.0);}
\DoxyCodeLine{00366\ \ \ \ \ CGContextBeginPath(\_ctx);}
\DoxyCodeLine{00367\ \ \ \ \ CGContextAddArc(\_ctx,\ to\_x\ -\/\ radius,\ top\ +\ radius,\ radius,\ -\/0.5\ *\ M\_PI,\ 0.0,\ NO);}
\DoxyCodeLine{00368\ \ \ \ \ CGContextAddArc(\_ctx,\ to\_x\ -\/\ radius,\ bottom\ -\/\ radius,\ radius,\ 0.0,\ 0.5\ *\ M\_PI,\ NO);}
\DoxyCodeLine{00369\ \ \ \ \ CGContextAddArc(\_ctx,\ from\_x\ +\ radius,\ bottom\ -\/\ radius,\ radius,\ 0.5\ *\ M\_PI,\ M\_PI,\ NO);}
\DoxyCodeLine{00370\ \ \ \ \ CGContextAddArc(\_ctx,\ from\_x\ +\ radius,\ top\ +\ radius,\ radius,\ M\_PI,\ 1.5\ *\ M\_PI,\ NO);}
\DoxyCodeLine{00371\ \ \ \ \ CGContextClosePath(\_ctx);}
\DoxyCodeLine{00372\ \ \ \ \ CGContextFillPath(\_ctx);}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{if}\ ((to\_x\ -\/\ from\_x)\ >=\ 4.000\ *\ 4)\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ bother\ drawing\ the\ text\ if\ we've\ got\ some\ space\ to\ draw\ on.}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ left\ =\ std::max(from\_x,\ 0)\ +\ 4.000\ /\ 2;}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ right\ =\ std::min(to\_x,\ get\_xsize())\ -\/\ 4.000\ /\ 2;}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =\ monitor-\/>get\_client\_data();}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&def\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(collector\_index);}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ \ \ \ \ \textcolor{keyword}{const}\ CFStringRef\ keys[]\ =\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ (\_\_bridge\ CFStringRef)NSForegroundColorAttributeName,}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ (\_\_bridge\ CFStringRef)NSFontAttributeName,}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *values[]\ =\ \{}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a6859450fb5ce0c04cb6c94b9dfd88574}{get\_collector\_text\_color}}(collector\_index,\ is\_highlighted),}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ [NSFont\ systemFontOfSize:0.0],}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00390\ \ \ \ \ \ \ CFDictionaryRef\ attribs\ =\ CFDictionaryCreate(kCFAllocatorDefault,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)keys,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)values,\ 2,\ \&kCFTypeDictionaryKeyCallBacks,\ \&kCFTypeDictionaryValueCallBacks);}
\DoxyCodeLine{00391\ }
\DoxyCodeLine{00392\ \ \ \ \ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ def.\_name.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \ \ CTLineRef\ line\ =\ CTLineCreateWithAttributedString(astr);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ CGRect\ bounds\ =\ CTLineGetImageBounds(line,\ \_ctx);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ CFRelease(astr);}
\DoxyCodeLine{00398\ \ \ \ \ \ \ CFRelease(str);}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00400\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bounds.size.width\ <\ right\ -\/\ left)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ room\ for\ more.\ \ Show\ the\ collector's\ actual\ parent,\ if\ it's}}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ different\ than\ the\ block\ it's\ shown\ above.}}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (def.\_parent\_index\ >\ 0\ \&\&\ def.\_parent\_index\ !=\ parent\_index)\ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&parent\_def\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a24e17a5885214596815115a8bb768e2a}{get\_collector\_def}}(def.\_parent\_index);}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ std::string\ long\_name\ =\ parent\_def.\_name\ +\ \textcolor{stringliteral}{"{}:"{}}\ +\ def.\_name;}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ CFStringRef\ long\_str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ long\_name.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ CFAttributedStringRef\ long\_astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ long\_str,\ attribs);}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ CTLineRef\ long\_line\ =\ CTLineCreateWithAttributedString((CFAttributedStringRef)long\_astr);}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ CGRect\ long\_bounds\ =\ CTLineGetImageBounds(long\_line,\ \_ctx);}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (long\_bounds.size.width\ <\ right\ -\/\ left)\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ line\ =\ long\_line;}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ bounds\ =\ long\_bounds;}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ CFRelease(long\_line);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ CFRelease(long\_astr);}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ CFRelease(long\_str);}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ CFStringRef\ token\_str\ =\ CFSTR(\textcolor{stringliteral}{"{}\(\backslash\)u2026"{}});}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ CFAttributedStringRef\ token\_astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ token\_str,\ attribs);}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ CTLineRef\ token\_line\ =\ CTLineCreateWithAttributedString(token\_astr);}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ CTLineRef\ trunc\_line\ =\ CTLineCreateTruncatedLine(line,\ right\ -\/\ left,\ kCTLineTruncationEnd,\ token\_line);}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ CFRelease(token\_astr);}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ CFRelease(token\_line);}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ line\ =\ trunc\_line;}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \ \ \ \ \textcolor{comment}{//\ Center\ the\ text\ vertically\ in\ the\ bar.}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (line\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ CGContextSetTextPosition(\_ctx,\ left,\ top\ +\ (bottom\ -\/\ top\ +\ bounds.size.height)\ /\ 2);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ CTLineDraw(line,\ \_ctx);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ CFRelease(attribs);}
\DoxyCodeLine{00442\ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \}}
\DoxyCodeLine{00444\ \}}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00450\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_abd32e0be86a9e860e05cfc130567b5c6}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00451\ \mbox{\hyperlink{classMacStatsFlameGraph_abd32e0be86a9e860e05cfc130567b5c6}{end\_draw}}()\ \{}
\DoxyCodeLine{00452\ \ \ \_graph\_view.needsDisplay\ =\ YES;}
\DoxyCodeLine{00453\ \}}
\DoxyCodeLine{00454\ }
\DoxyCodeLine{00458\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a505dfc6505485b503d418da7f44d83db}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00459\ \mbox{\hyperlink{classMacStatsFlameGraph_a505dfc6505485b503d418da7f44d83db}{idle}}()\ \{}
\DoxyCodeLine{00460\ \}}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00466\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsFlameGraph_a2523e5e1b8e4e220dbd2882c2783cbf6}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00467\ \mbox{\hyperlink{classMacStatsFlameGraph_a2523e5e1b8e4e220dbd2882c2783cbf6}{animate}}(\textcolor{keywordtype}{double}\ time,\ \textcolor{keywordtype}{double}\ dt)\ \{}
\DoxyCodeLine{00468\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatFlameGraph_a2ff3545c8f2e4d398898e314b813cfeb}{PStatFlameGraph::animate}}(time,\ dt);}
\DoxyCodeLine{00469\ \}}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00474\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsFlameGraph_a57c333c4218d93dd3e0192d910e63c88}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00475\ \mbox{\hyperlink{classMacStatsFlameGraph_a57c333c4218d93dd3e0192d910e63c88}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00477\ \ \ \mbox{\hyperlink{classMacStatsGraph_a524e8aa33f266e1e46227339bb7ac226}{MacStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00479\ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00484\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_aa096d1253c8b6c8a41b126254c2c73e9}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00485\ \mbox{\hyperlink{classMacStatsFlameGraph_aa096d1253c8b6c8a41b126254c2c73e9}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00487\ \ \ \mbox{\hyperlink{classMacStatsGraph_ae85ef8048bce18ca67658bb5e871f445}{MacStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00488\ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00494\ NSMenu\ *\mbox{\hyperlink{classMacStatsFlameGraph_aa333b753bc79008a1aab9e7898b84239}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00495\ \mbox{\hyperlink{classMacStatsFlameGraph_aa333b753bc79008a1aab9e7898b84239}{get\_graph\_menu}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00496\ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_bar\_collector(pixel\_to\_depth(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ !=\ -\/1)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \textcolor{keywordflow}{return}\ get\_label\_menu(collector\_index);}
\DoxyCodeLine{00499\ \ \ \}}
\DoxyCodeLine{00500\ \ \ \textcolor{keywordflow}{return}\ nil;}
\DoxyCodeLine{00501\ \}}
\DoxyCodeLine{00502\ }
\DoxyCodeLine{00507\ std::string\ \mbox{\hyperlink{classMacStatsFlameGraph_a2cb5aa573e814892619b2d4a0fb28d76}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00508\ \mbox{\hyperlink{classMacStatsFlameGraph_a2cb5aa573e814892619b2d4a0fb28d76}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00509\ \ \ \textcolor{keywordflow}{return}\ get\_bar\_tooltip(pixel\_to\_depth(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00510\ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00517\ MacStatsGraph::DragMode\ \mbox{\hyperlink{classMacStatsFlameGraph_aa4071f13b6bfd53f0ebc4fb13fca1534}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00518\ \mbox{\hyperlink{classMacStatsFlameGraph_aa4071f13b6bfd53f0ebc4fb13fca1534}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{if}\ (graph\_y\ >=\ 0\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \textcolor{comment}{//\ See\ if\ the\ mouse\ is\ over\ a\ user-\/defined\ guide\ bar.}}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ graph\_x;}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ 2);}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ 2);}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ find\_user\_guide\_bar(from\_height,\ to\_height);}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_guide\_bar;}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00529\ }
\DoxyCodeLine{00530\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ mouse\ is\ left\ or\ right\ of\ the\ graph;\ maybe\ create\ a\ new\ guide}}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \textcolor{comment}{//\ bar.}}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_new\_guide\_bar;}
\DoxyCodeLine{00534\ \ \ \ \ \}}
\DoxyCodeLine{00535\ \ \ \}}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \textcolor{keywordflow}{return}\ DM\_none;}
\DoxyCodeLine{00538\ \}}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00543\ \textcolor{keywordtype}{bool}\ MacStatsFlameGraph::}
\DoxyCodeLine{00544\ handle\_key(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ pressed,\ UniChar\ c,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ key\_code)\ \{}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordtype}{bool}\ changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \textcolor{keywordflow}{if}\ (pressed)\ \{}
\DoxyCodeLine{00548\ \ \ \ \ \textcolor{keywordflow}{switch}\ (c)\ \{}
\DoxyCodeLine{00549\ \ \ \ \ \textcolor{keywordflow}{case}\ NSLeftArrowFunctionKey:}
\DoxyCodeLine{00550\ \ \ \ \ \ \ changed\ =\ prev\_frame();}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{case}\ NSRightArrowFunctionKey:}
\DoxyCodeLine{00554\ \ \ \ \ \ \ changed\ =\ next\_frame();}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00557\ \ \ \ \ \textcolor{keywordflow}{case}\ NSHomeFunctionKey:}
\DoxyCodeLine{00558\ \ \ \ \ \ \ changed\ =\ first\_frame();}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \textcolor{keywordflow}{case}\ NSEndFunctionKey:}
\DoxyCodeLine{00562\ \ \ \ \ \ \ changed\ =\ last\_frame();}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00564\ \ \ \ \ \}}
\DoxyCodeLine{00565\ \ \ \}}
\DoxyCodeLine{00566\ }
\DoxyCodeLine{00567\ \ \ \textcolor{keywordflow}{if}\ (changed)\ \{}
\DoxyCodeLine{00568\ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00571\ \ \ \ \ \}}
\DoxyCodeLine{00572\ \ \ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \textcolor{keywordflow}{return}\ changed;}
\DoxyCodeLine{00575\ \}}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00580\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a3b9a779df2f046275442ddf5a0aea1dd}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00581\ \mbox{\hyperlink{classMacStatsFlameGraph_a3b9a779df2f046275442ddf5a0aea1dd}{handle\_button\_press}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ double\_click,\ \textcolor{keywordtype}{int}\ button)\ \{}
\DoxyCodeLine{00582\ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keywordtype}{int}\ depth\ =\ pixel\_to\_depth(graph\_y);}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_bar\_collector(depth,\ graph\_x);}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keywordflow}{if}\ (double\_click\ \&\&\ button\ ==\ 0)\ \{}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ will\ zoom\ the\ graph\ into}}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ collector.}}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ on\_click\_label(collector\_index);}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_history\_depth()\ >\ 0)\ \{}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ clear\_history();}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \_graph\_view\_controller.backToolbarItemVisible\ =\ NO;}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ set\_collector\_index(-\/1);}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00603\ \ \ \ \ \}}
\DoxyCodeLine{00604\ \ \ \}}
\DoxyCodeLine{00605\ }
\DoxyCodeLine{00606\ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00607\ \ \ \ \ set\_drag\_mode(DM\_scale);}
\DoxyCodeLine{00608\ \ \ \ \ \_drag\_scale\_start\ =\ pixel\_to\_height(graph\_x);}
\DoxyCodeLine{00609\ \ \ \ \ \textcolor{comment}{//\ SetCapture(\_graph\_window);}}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00611\ \ \ \}}
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_guide\_bar\ \&\&\ \_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00613\ \ \ \ \ set\_drag\_mode(DM\_guide\_bar);}
\DoxyCodeLine{00614\ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{comment}{//\ SetCapture(\_graph\_window);}}
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00617\ \ \ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a85679d6f09f08fbb700a91944568b4d5}{MacStatsGraph::handle\_button\_press}}(graph\_x,\ graph\_y,}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\_click,\ button);}
\DoxyCodeLine{00621\ \}}
\DoxyCodeLine{00622\ }
\DoxyCodeLine{00626\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_aa1a1fcd22c2b04ff88bdca76332fcb3c}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00627\ \mbox{\hyperlink{classMacStatsFlameGraph_aa1a1fcd22c2b04ff88bdca76332fcb3c}{handle\_button\_release}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00628\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_scale)\ \{}
\DoxyCodeLine{00629\ \ \ \ \ set\_drag\_mode(DM\_none);}
\DoxyCodeLine{00630\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{return}\ handle\_motion(graph\_x,\ graph\_y);}
\DoxyCodeLine{00632\ \ \ \}}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00634\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ <\ 0\ ||\ graph\_x\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00635\ \ \ \ \ \ \ remove\_user\_guide\_bar(\_drag\_guide\_bar);}
\DoxyCodeLine{00636\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00637\ \ \ \ \ \ \ move\_user\_guide\_bar(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00638\ \ \ \ \ \}}
\DoxyCodeLine{00639\ \ \ \ \ set\_drag\_mode(DM\_none);}
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00641\ \ \ \ \ \textcolor{keywordflow}{return}\ handle\_motion(graph\_x,\ graph\_y);}
\DoxyCodeLine{00642\ \ \ \}}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a0dd05ee8e330022b32393b3354f880a2}{MacStatsGraph::handle\_button\_release}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00645\ \}}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00650\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a09758842aca13632323e517a28ee4bae}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00651\ \mbox{\hyperlink{classMacStatsFlameGraph_a09758842aca13632323e517a28ee4bae}{handle\_motion}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00652\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none\ \&\&}
\DoxyCodeLine{00653\ \ \ \ \ \ \ graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00654\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00655\ \ \ \ \ \textcolor{keywordtype}{int}\ depth\ =\ pixel\_to\_depth(graph\_y);}
\DoxyCodeLine{00656\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_bar\_collector(depth,\ graph\_x);}
\DoxyCodeLine{00657\ \ \ \ \ on\_enter\_label(collector\_index);}
\DoxyCodeLine{00658\ \ \ \}}
\DoxyCodeLine{00659\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \textcolor{comment}{//\ If\ the\ mouse\ is\ in\ some\ drag\ mode,\ stop\ highlighting.}}
\DoxyCodeLine{00661\ \ \ \ \ \_label\_stack.highlight\_label(-\/1);}
\DoxyCodeLine{00662\ \ \ \ \ on\_leave\_label(\_highlighted\_index);}
\DoxyCodeLine{00663\ \ \ \}}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_new\_guide\_bar)\ \{}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{comment}{//\ We\ haven't\ created\ the\ new\ guide\ bar\ yet;\ we\ won't\ until\ the\ mouse}}
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{comment}{//\ comes\ within\ the\ graph's\ region.}}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00669\ \ \ \ \ \ \ set\_drag\_mode(DM\_guide\_bar);}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ add\_user\_guide\_bar(pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00672\ \ \ \ \ \}}
\DoxyCodeLine{00673\ \ \ \}}
\DoxyCodeLine{00674\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00675\ \ \ \ \ move\_user\_guide\_bar(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00676\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00677\ \ \ \}}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a45e4a7c922f1a1cc97c413af0c9d3bfb}{MacStatsGraph::handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00680\ \}}
\DoxyCodeLine{00681\ }
\DoxyCodeLine{00685\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a75341f80b861f503bd147067372014df}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00686\ \mbox{\hyperlink{classMacStatsFlameGraph_a75341f80b861f503bd147067372014df}{handle\_leave}}()\ \{}
\DoxyCodeLine{00687\ \ \ \_label\_stack.highlight\_label(-\/1);}
\DoxyCodeLine{00688\ \ \ on\_leave\_label(\_highlighted\_index);}
\DoxyCodeLine{00689\ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00690\ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00695\ \textcolor{keywordtype}{void}\ MacStatsFlameGraph::}
\DoxyCodeLine{00696\ handle\_wheel(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy)\ \{}
\DoxyCodeLine{00697\ \ \ \textcolor{keywordflow}{if}\ (dx\ !=\ 0.0)\ \{}
\DoxyCodeLine{00698\ \ \ \ \ \textcolor{keywordflow}{if}\ ((dx\ >\ 0.0)\ ?\ prev\_frame()\ :\ next\_frame())\ \{}
\DoxyCodeLine{00699\ \ \ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00703\ \ \ \ \ \}}
\DoxyCodeLine{00704\ \ \ \}}
\DoxyCodeLine{00705\ \}}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00710\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_ab67eb30f8c867db0e4e5a95dc4c8ece8}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00711\ \mbox{\hyperlink{classMacStatsFlameGraph_ab67eb30f8c867db0e4e5a95dc4c8ece8}{handle\_draw\_graph}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00712\ \ \ \mbox{\hyperlink{classMacStatsGraph_aee19588a72b714ef1d04fae9da4967a9}{MacStatsGraph::handle\_draw\_graph}}(ctx,\ rect);}
\DoxyCodeLine{00713\ }
\DoxyCodeLine{00714\ \ \ CGContextSetTextMatrix(ctx,\ CGAffineTransformMakeScale(1,\ -\/1));}
\DoxyCodeLine{00715\ }
\DoxyCodeLine{00716\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ get\_num\_user\_guide\_bars();}
\DoxyCodeLine{00717\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00718\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{GuideBar}}\ \&bar\ =\ get\_user\_guide\_bar(i);}
\DoxyCodeLine{00719\ \ \ \ \ draw\_guide\_bar(ctx,\ bar);}
\DoxyCodeLine{00720\ \ \ \ \ draw\_guide\_label(ctx,\ bar);}
\DoxyCodeLine{00721\ \ \ \}}
\DoxyCodeLine{00722\ \}}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00727\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a4c9eaf105fbf7100f0b8b61028d7935d}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00728\ \mbox{\hyperlink{classMacStatsFlameGraph_a4c9eaf105fbf7100f0b8b61028d7935d}{handle\_back}}()\ \{}
\DoxyCodeLine{00729\ \ \ \textcolor{keywordflow}{if}\ (pop\_collector\_index())\ \{}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{keywordflow}{if}\ (get\_history\_depth()\ ==\ 0)\ \{}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \_graph\_view\_controller.backToolbarItemVisible\ =\ NO;}
\DoxyCodeLine{00732\ \ \ \ \ \}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \ \ std::string\ window\_title\ =\ get\_title\_text();}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_title\_unknown())\ \{}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00737\ \ \ \ \ \}}
\DoxyCodeLine{00738\ \ \ \}}
\DoxyCodeLine{00739\ \}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00744\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsFlameGraph_a12dd8a9b6c8246d6d0d1095825bbc089}{MacStatsFlameGraph::}}}
\DoxyCodeLine{00745\ \mbox{\hyperlink{classMacStatsFlameGraph_a12dd8a9b6c8246d6d0d1095825bbc089}{handle\_toggle\_average}}(\textcolor{keywordtype}{bool}\ state)\ \{}
\DoxyCodeLine{00746\ \ \ set\_average\_mode(state);}
\DoxyCodeLine{00747\ \ \ \textcolor{keywordflow}{if}\ (state)\ \{}
\DoxyCodeLine{00748\ \ \ \ \ start\_animation();}
\DoxyCodeLine{00749\ \ \ \}}
\DoxyCodeLine{00750\ \}}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00756\ \textcolor{keywordtype}{int}\ MacStatsFlameGraph::}
\DoxyCodeLine{00757\ pixel\_to\_depth(\textcolor{keywordtype}{int}\ y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{return}\ (get\_ysize()\ -\/\ 1\ -\/\ y)\ /\ (4.000\ *\ 5);}
\DoxyCodeLine{00759\ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00764\ \textcolor{keywordtype}{void}\ MacStatsFlameGraph::}
\DoxyCodeLine{00765\ draw\_guide\_bar(CGContextRef\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00766\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00768\ \ \ \textcolor{keywordflow}{if}\ (x\ >\ 0\ \&\&\ x\ <\ get\_xsize()\ -\/\ 1)\ \{}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{comment}{//\ Only\ draw\ it\ if\ it's\ not\ too\ close\ to\ the\ top.}}
\DoxyCodeLine{00770\ \ \ \ \ CGContextSetStrokeColorWithColor(ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00771\ \ \ \ \ \textcolor{comment}{/*switch\ (bar.\_style)\ \{}}
\DoxyCodeLine{00772\ \textcolor{comment}{\ \ \ \ case\ GBS\_target:}}
\DoxyCodeLine{00773\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_light\_gray[0],\ rgb\_light\_gray[1],\ rgb\_light\_gray[2],\ 1.0);}}
\DoxyCodeLine{00774\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00775\ \textcolor{comment}{}}
\DoxyCodeLine{00776\ \textcolor{comment}{\ \ \ \ case\ GBS\_user:}}
\DoxyCodeLine{00777\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_user\_guide\_bar[0],\ rgb\_user\_guide\_bar[1],\ rgb\_user\_guide\_bar[2],\ 1.0);}}
\DoxyCodeLine{00778\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00779\ \textcolor{comment}{}}
\DoxyCodeLine{00780\ \textcolor{comment}{\ \ \ \ default:}}
\DoxyCodeLine{00781\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_dark\_gray[0],\ rgb\_dark\_gray[1],\ rgb\_dark\_gray[2],\ 1.0);}}
\DoxyCodeLine{00782\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00783\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00784\ \ \ \ \ CGContextBeginPath(ctx);}
\DoxyCodeLine{00785\ \ \ \ \ CGContextMoveToPoint(ctx,\ x,\ 0);}
\DoxyCodeLine{00786\ \ \ \ \ CGContextAddLineToPoint(ctx,\ x,\ get\_ysize());}
\DoxyCodeLine{00787\ \ \ \ \ CGContextStrokePath(ctx);}
\DoxyCodeLine{00788\ \ \ \}}
\DoxyCodeLine{00789\ \}}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00794\ \textcolor{keywordtype}{void}\ MacStatsFlameGraph::}
\DoxyCodeLine{00795\ draw\_guide\_labels(CGContextRef\ ctx)\ \{}
\DoxyCodeLine{00796\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ get\_num\_guide\_bars();}
\DoxyCodeLine{00797\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00798\ \ \ \ \ draw\_guide\_label(ctx,\ get\_guide\_bar(i));}
\DoxyCodeLine{00799\ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ get\_num\_user\_guide\_bars();}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00803\ \ \ \ \ draw\_guide\_label(ctx,\ get\_user\_guide\_bar(i));}
\DoxyCodeLine{00804\ \ \ \}}
\DoxyCodeLine{00805\ \}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00810\ \textcolor{keywordtype}{void}\ MacStatsFlameGraph::}
\DoxyCodeLine{00811\ draw\_guide\_label(CGContextRef\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00812\ \ \ NSColor\ *\mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00813\ \ \ \mbox{\hyperlink{structcolor}{color}}\ =\ [NSColor\ tertiaryLabelColor];}
\DoxyCodeLine{00814\ \ \ \textcolor{comment}{/*switch\ (bar.\_style)\ \{}}
\DoxyCodeLine{00815\ \textcolor{comment}{\ \ case\ GBS\_target:}}
\DoxyCodeLine{00816\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_light\_gray[0]\ green:rgb\_light\_gray[1]\ blue:rgb\_light\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00817\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00818\ \textcolor{comment}{}}
\DoxyCodeLine{00819\ \textcolor{comment}{\ \ case\ GBS\_user:}}
\DoxyCodeLine{00820\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_user\_guide\_bar[0]\ green:rgb\_user\_guide\_bar[1]\ blue:rgb\_user\_guide\_bar[2]\ alpha:1.0];}}
\DoxyCodeLine{00821\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00822\ \textcolor{comment}{}}
\DoxyCodeLine{00823\ \textcolor{comment}{\ \ default:}}
\DoxyCodeLine{00824\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_dark\_gray[0]\ green:rgb\_dark\_gray[1]\ blue:rgb\_dark\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00825\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00826\ \textcolor{comment}{\ \ \}*/}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00829\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00830\ }
\DoxyCodeLine{00831\ \ \ \textcolor{keyword}{const}\ CFStringRef\ keys[]\ =\ \{}
\DoxyCodeLine{00832\ \ \ \ \ (\_\_bridge\ CFStringRef)NSForegroundColorAttributeName,}
\DoxyCodeLine{00833\ \ \ \ \ (\_\_bridge\ CFStringRef)NSFontAttributeName,}
\DoxyCodeLine{00834\ \ \ \};}
\DoxyCodeLine{00835\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *values[]\ =\ \{}
\DoxyCodeLine{00836\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}},}
\DoxyCodeLine{00837\ \ \ \ \ [NSFont\ systemFontOfSize:0.0],}
\DoxyCodeLine{00838\ \ \ \};}
\DoxyCodeLine{00839\ \ \ CFDictionaryRef\ attribs\ =\ CFDictionaryCreate(kCFAllocatorDefault,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)keys,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)values,\ 2,\ \&kCFTypeDictionaryKeyCallBacks,\ \&kCFTypeDictionaryValueCallBacks);}
\DoxyCodeLine{00840\ }
\DoxyCodeLine{00841\ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ label.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00842\ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00843\ \ \ CFRelease(attribs);}
\DoxyCodeLine{00844\ \ \ CFRelease(str);}
\DoxyCodeLine{00845\ }
\DoxyCodeLine{00846\ \ \ CTLineRef\ line\ =\ CTLineCreateWithAttributedString(astr);}
\DoxyCodeLine{00847\ \ \ CFRelease(astr);}
\DoxyCodeLine{00848\ \ \ CGRect\ bounds\ =\ CTLineGetImageBounds(line,\ ctx);}
\DoxyCodeLine{00849\ \ \ \textcolor{keywordtype}{int}\ width\ =\ bounds.size.width;}
\DoxyCodeLine{00850\ }
\DoxyCodeLine{00851\ \ \ \textcolor{keywordflow}{if}\ (bar.\_style\ !=\ GBS\_user)\ \{}
\DoxyCodeLine{00852\ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ width);}
\DoxyCodeLine{00853\ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ width);}
\DoxyCodeLine{00854\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatGraph_a27bac34846a7622cab2d7aa247fc570e}{find\_user\_guide\_bar}}(from\_height,\ to\_height)\ >=\ 0)\ \{}
\DoxyCodeLine{00855\ \ \ \ \ \ \ \textcolor{comment}{//\ Omit\ the\ label:\ there's\ a\ user-\/defined\ guide\ bar\ in\ the\ same\ space.}}
\DoxyCodeLine{00856\ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00858\ \ \ \ \ \}}
\DoxyCodeLine{00859\ \ \ \}}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00862\ \ \ \ \ \textcolor{keywordtype}{int}\ y\ =\ bounds.size.height;}
\DoxyCodeLine{00863\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \textcolor{comment}{//\ Account\ for\ underlap\ of\ title\ bar}}
\DoxyCodeLine{00865\ \ \ \ \ \ \ y\ +=\ \_window.frame.size.height\ -\/\ \_window.contentLayoutRect.size.height;}
\DoxyCodeLine{00866\ \ \ \ \ \}}
\DoxyCodeLine{00867\ \ \ \ \ CGContextSetTextPosition(ctx,\ x\ +\ 6,\ y\ +\ 6);}
\DoxyCodeLine{00868\ \ \ \ \ CTLineDraw(line,\ ctx);}
\DoxyCodeLine{00869\ \ \ \}}
\DoxyCodeLine{00870\ }
\DoxyCodeLine{00871\ \ \ CFRelease(line);}
\DoxyCodeLine{00872\ \}}
\DoxyCodeLine{00873\ }
\DoxyCodeLine{00874\ \textcolor{keyword}{@implementation\ }\mbox{\hyperlink{interfaceMacStatsFlameGraphViewController}{MacStatsFlameGraphViewController}}}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ -\/\ (NSArray\ *)toolbarAllowedItemIdentifiers:(NSToolbar\ *)toolbar\ \{}
\DoxyCodeLine{00877\ \ \ \textcolor{keywordflow}{return}\ @[@"{}back"{},\ @"{}average"{},\ @"{}total"{}];}
\DoxyCodeLine{00878\ \}}
\DoxyCodeLine{00879\ }
\DoxyCodeLine{00880\ -\/\ (NSArray\ *)toolbarDefaultItemIdentifiers:(NSToolbar\ *)toolbar\ \{}
\DoxyCodeLine{00881\ \ \ \textcolor{keywordflow}{return}\ @[@"{}average"{},\ @"{}total"{}];}
\DoxyCodeLine{00882\ \}}
\DoxyCodeLine{00883\ }
\DoxyCodeLine{00884\ -\/\ (NSToolbarItem\ *)\ toolbar:(NSToolbar\ *)toolbar}
\DoxyCodeLine{00885\ \ \ \ \ \ \ itemForItemIdentifier:(NSString\ *)ident}
\DoxyCodeLine{00886\ \ \ willBeInsertedIntoToolbar:(BOOL)flag\ \{}
\DoxyCodeLine{00887\ }
\DoxyCodeLine{00888\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00889\ \ \ \ \ \textcolor{keywordflow}{if}\ ([ident\ isEqual:\textcolor{stringliteral}{@"{}average"{}}])\ \{}
\DoxyCodeLine{00890\ \ \ \ \ \ \ NSButton\ *button\ =\ [NSButton\ buttonWithTitle:@"{}Average"{}\ target:self\ action:@selector(handleToggleAverage:)];}
\DoxyCodeLine{00891\ \ \ \ \ \ \ button.image\ =\ [NSImage\ imageWithSystemSymbolName:@"{}sum"{}\ accessibilityDescription:@"{}"{}];}
\DoxyCodeLine{00892\ \ \ \ \ \ \ button.bezelStyle\ =\ NSBezelStyleTexturedRounded;}
\DoxyCodeLine{00893\ \ \ \ \ \ \ button.buttonType\ =\ NSButtonTypePushOnPushOff;}
\DoxyCodeLine{00894\ \ \ \ \ \ \ button.bordered\ =\ YES;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ button.toolTip\ =\ \textcolor{stringliteral}{@"{}Average"{}};}
\DoxyCodeLine{00896\ \ \ \ \ \ \ button.state\ =\ NSOffState;}
\DoxyCodeLine{00897\ \ \ \ \ \ \ NSToolbarItem\ *item\ =\ [[[NSToolbarItem\ alloc]\ initWithItemIdentifier:ident]\ autorelease];}
\DoxyCodeLine{00898\ \ \ \ \ \ \ item.label\ =\ \textcolor{stringliteral}{@"{}Average"{}};}
\DoxyCodeLine{00899\ \ \ \ \ \ \ item.view\ =\ button;}
\DoxyCodeLine{00900\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ item;}
\DoxyCodeLine{00901\ \ \ \ \ \}}
\DoxyCodeLine{00902\ \ \ \ \ \textcolor{keywordflow}{if}\ ([ident\ isEqual:\textcolor{stringliteral}{@"{}total"{}}])\ \{}
\DoxyCodeLine{00903\ \ \ \ \ \ \ NSToolbarItem\ *item\ =\ [[[NSToolbarItem\ alloc]\ initWithItemIdentifier:ident]\ autorelease];}
\DoxyCodeLine{00904\ \ \ \ \ \ \ item.label\ =\ \textcolor{stringliteral}{@"{}Total"{}};}
\DoxyCodeLine{00905\ \ \ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00906\ \ \ \ \ \ \ [item\ setBordered:YES];}
\DoxyCodeLine{00907\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ item;}
\DoxyCodeLine{00908\ \ \ \ \ \}}
\DoxyCodeLine{00909\ \ \ \}}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00911\ \ \ \textcolor{keywordflow}{return}\ [\textcolor{keyword}{super}\ toolbar:toolbar\ itemForItemIdentifier:ident\ willBeInsertedIntoToolbar:flag];}
\DoxyCodeLine{00912\ \}}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ -\/\ (void)handleToggleAverage:(NSButton\ *)button\ \{}
\DoxyCodeLine{00915\ \ \ \mbox{\hyperlink{classMacStatsFlameGraph}{MacStatsFlameGraph}}\ *graph\ =\ (\mbox{\hyperlink{classMacStatsFlameGraph}{MacStatsFlameGraph}}\ *)\_graph;}
\DoxyCodeLine{00916\ \ \ graph-\/>\mbox{\hyperlink{classMacStatsFlameGraph_a12dd8a9b6c8246d6d0d1095825bbc089}{handle\_toggle\_average}}(button.state\ ==\ NSOnState);}
\DoxyCodeLine{00917\ \}}
\DoxyCodeLine{00918\ }
\DoxyCodeLine{00919\ \textcolor{keyword}{@end}}

\end{DoxyCode}
