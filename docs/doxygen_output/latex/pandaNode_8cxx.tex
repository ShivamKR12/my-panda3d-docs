\doxysection{panda/src/pgraph/panda\+Node.cxx File Reference}
\hypertarget{pandaNode_8cxx}{}\label{pandaNode_8cxx}\index{panda/src/pgraph/pandaNode.cxx@{panda/src/pgraph/pandaNode.cxx}}
{\ttfamily \#include "{}panda\+Node.\+h"{}}\newline
{\ttfamily \#include "{}config\+\_\+pgraph.\+h"{}}\newline
{\ttfamily \#include "{}node\+Path\+Component.\+h"{}}\newline
{\ttfamily \#include "{}bam\+Reader.\+h"{}}\newline
{\ttfamily \#include "{}bam\+Writer.\+h"{}}\newline
{\ttfamily \#include "{}indent.\+h"{}}\newline
{\ttfamily \#include "{}geometric\+Bounding\+Volume.\+h"{}}\newline
{\ttfamily \#include "{}scene\+Graph\+Reducer.\+h"{}}\newline
{\ttfamily \#include "{}accumulated\+Attribs.\+h"{}}\newline
{\ttfamily \#include "{}clip\+Plane\+Attrib.\+h"{}}\newline
{\ttfamily \#include "{}bounding\+Sphere.\+h"{}}\newline
{\ttfamily \#include "{}bounding\+Box.\+h"{}}\newline
{\ttfamily \#include "{}p\+Stat\+Timer.\+h"{}}\newline
{\ttfamily \#include "{}config\+\_\+mathutil.\+h"{}}\newline
{\ttfamily \#include "{}light\+Re\+Mutex\+Holder.\+h"{}}\newline
{\ttfamily \#include "{}graphics\+State\+Guardian\+Base.\+h"{}}\newline
{\ttfamily \#include "{}decal\+Effect.\+h"{}}\newline
{\ttfamily \#include "{}show\+Bounds\+Effect.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{pandaNode_8cxx_ac867ca6f3e9694ba95d3f8cdb44dcb5a}\label{pandaNode_8cxx_ac867ca6f3e9694ba95d3f8cdb44dcb5a} 
{\bfseries Notify\+Category\+Decl} (drawmask, EXPCL\+\_\+\+PANDA\+\_\+\+PGRAPH, EXPTP\+\_\+\+PANDA\+\_\+\+PGRAPH)
\item 
\Hypertarget{pandaNode_8cxx_a35878518e8b45964ad859db3808ace85}\label{pandaNode_8cxx_a35878518e8b45964ad859db3808ace85} 
{\bfseries Notify\+Category\+Def} (drawmask, "{}"{})
\item 
\mbox{\hyperlink{pandaNode_8cxx_a52d83486b796157161c94eb9cd42f9b4}{CPT}} (\mbox{\hyperlink{classTransformState}{Transform\+State}}) \mbox{\hyperlink{classPandaNode}{Panda\+Node}}
\item 
\mbox{\hyperlink{pandaNode_8cxx_ad92b83fa9ad2b5959aa7dd3282297b5e}{PT}} (\mbox{\hyperlink{classPandaNode}{Panda\+Node}}) \mbox{\hyperlink{classPandaNode}{Panda\+Node}}
\item 
\mbox{\hyperlink{pandaNode_8cxx_a5027c1e2e50c333c7de2de5b0034d7b6}{CPT}} (\mbox{\hyperlink{classRenderAttrib}{Render\+Attrib}}) \mbox{\hyperlink{classPandaNode}{Panda\+Node}}
\item 
\mbox{\hyperlink{pandaNode_8cxx_a410174b87fe5b8bc3a1de316d273a526}{CPT}} (\mbox{\hyperlink{classBoundingVolume}{Bounding\+Volume}}) \mbox{\hyperlink{classPandaNode}{Panda\+Node}}
\item 
\mbox{\hyperlink{pandaNode_8cxx_a5cdad7e478032f8aafb73f97a1a5e17b}{PT}} (\mbox{\hyperlink{classNodePathComponent}{Node\+Path\+Component}}) \mbox{\hyperlink{classPandaNode}{Panda\+Node}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
PANDA 3D SOFTWARE Copyright (c) Carnegie Mellon University. All rights reserved.

All use of this software is subject to the terms of the revised BSD license. You should have received a copy of this license along with this source code in a file named "{}\+LICENSE."{}

\begin{DoxyAuthor}{Author}
drose 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
2002-\/02-\/20 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\Hypertarget{pandaNode_8cxx_a410174b87fe5b8bc3a1de316d273a526}\label{pandaNode_8cxx_a410174b87fe5b8bc3a1de316d273a526} 
\index{pandaNode.cxx@{pandaNode.cxx}!CPT@{CPT}}
\index{CPT@{CPT}!pandaNode.cxx@{pandaNode.cxx}}
\doxysubsubsection{\texorpdfstring{CPT()}{CPT()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily CPT (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classBoundingVolume}{Bounding\+Volume}}}]{ }\end{DoxyParamCaption})}

Returns the external bounding volume of this node\+: a bounding volume that contains the user bounding volume, the internal bounding volume, and all of the children\textquotesingle{}s bounding volumes. This flavor of get\+\_\+bounds() return the external bounding volume, and also fills in seq with the bounding volume\textquotesingle{}s current sequence number. When this sequence number changes, it indicates that the bounding volume might have changed, e.\+g. because some nested child\textquotesingle{}s bounding volume has changed.

Although this might occasionally increment without changing the bounding volume, the bounding volume will never change without incrementing this counter, so as long as this counter remains unchanged you can be confident the bounding volume is also unchanged. Returns the total number of vertices that will be rendered by this node and all of its descendents.

This is not necessarily an accurate count of vertices that will actually be rendered, since this will include all vertices of all LOD\textquotesingle{}s, and it will also include hidden nodes. It may also omit or only approximate certain kinds of dynamic geometry. However, it will not include stashed nodes. Indicates that the bounding volume, or something that influences the bounding volume (or any of the other things stored in CData, like net\+\_\+collide\+\_\+mask), may have changed for this node, and that it must be recomputed.

With no parameters, this means to iterate through all stages including and upstream of the current pipeline stage.

This method is intended for internal use; usually it is not necessary for a user to call this directly. It will be called automatically by derived classes when appropriate. Should be called by a derived class to mark the internal bounding volume stale, so that compute\+\_\+internal\+\_\+bounds() will be called when the bounding volume is next requested.

With no parameters, this means to iterate through all stages including and upstream of the current pipeline stage.

It is normally not necessary to call this method directly; each node should be responsible for calling it when its internals have changed.

Returns the node\textquotesingle{}s internal bounding volume. This is the bounding volume around the node alone, without including children. Returns the total number of vertices that will be rendered by this particular node alone, not accounting for its children.

This may not include all vertices for certain dynamic effects. This is provided as an alternate way for a node to set its own internal bounds, rather than overloading compute\+\_\+internal\+\_\+bounds(). If this method is called, the internal bounding volume will immediately be set to the indicated pointer. \Hypertarget{pandaNode_8cxx_a5027c1e2e50c333c7de2de5b0034d7b6}\label{pandaNode_8cxx_a5027c1e2e50c333c7de2de5b0034d7b6} 
\index{pandaNode.cxx@{pandaNode.cxx}!CPT@{CPT}}
\index{CPT@{CPT}!pandaNode.cxx@{pandaNode.cxx}}
\doxysubsubsection{\texorpdfstring{CPT()}{CPT()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily CPT (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classRenderAttrib}{Render\+Attrib}}}]{ }\end{DoxyParamCaption})}

Returns a \doxylink{classClipPlaneAttrib}{Clip\+Plane\+Attrib} which represents the union of all of the clip planes that have been turned {\itshape off} at this level and below. Walks through the scene graph beginning at this node, and does whatever initialization is required to render the scene properly with the indicated GSG. It is not strictly necessary to call this, since the GSG will initialize itself when the scene is rendered, but this may take some of the overhead away from that process.

In particular, this will ensure that textures and vertex buffers within the scene are loaded into graphics memory. \Hypertarget{pandaNode_8cxx_a52d83486b796157161c94eb9cd42f9b4}\label{pandaNode_8cxx_a52d83486b796157161c94eb9cd42f9b4} 
\index{pandaNode.cxx@{pandaNode.cxx}!CPT@{CPT}}
\index{CPT@{CPT}!pandaNode.cxx@{pandaNode.cxx}}
\doxysubsubsection{\texorpdfstring{CPT()}{CPT()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily CPT (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classTransformState}{Transform\+State}}}]{ }\end{DoxyParamCaption})}

This is used to support \doxylink{classNodePath_a97522b707f591db1a5781538d477ed97}{Node\+Path\+::calc\+\_\+tight\+\_\+bounds()}. It is not intended to be called directly, and it has nothing to do with the normal Panda bounding-\/volume computation.

If the node contains any geometry, this updates min\+\_\+point and max\+\_\+point to enclose its bounding box. found\+\_\+any is to be set true if the node has any geometry at all, or left alone if it has none. This method may be called over several nodes, so it may enter with min\+\_\+point, max\+\_\+point, and found\+\_\+any already set.

This function is recursive, and the return value is the transform after it has been modified by this node\textquotesingle{}s transform. This function will be called during the cull traversal to perform any additional operations that should be performed at cull time. This may include additional manipulation of render state or additional visible/invisible decisions, or any other arbitrary operation.

Note that this function will {\itshape not} be called unless set\+\_\+cull\+\_\+callback() is called in the constructor of the derived class. It is necessary to call set\+\_\+cull\+\_\+callback() to indicated that we require cull\+\_\+callback() to be called.

By the time this function is called, the node has already passed the bounding-\/volume test for the viewing frustum, and the node\textquotesingle{}s transform and state have already been applied to the indicated \doxylink{classCullTraverserData}{Cull\+Traverser\+Data} object.

The return value is true if this node should be visible, or false if it should be culled. \Hypertarget{pandaNode_8cxx_a5cdad7e478032f8aafb73f97a1a5e17b}\label{pandaNode_8cxx_a5cdad7e478032f8aafb73f97a1a5e17b} 
\index{pandaNode.cxx@{pandaNode.cxx}!PT@{PT}}
\index{PT@{PT}!pandaNode.cxx@{pandaNode.cxx}}
\doxysubsubsection{\texorpdfstring{PT()}{PT()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily PT (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classNodePathComponent}{Node\+Path\+Component}}}]{ }\end{DoxyParamCaption})}

Creates a new parent-\/child relationship, and returns the new \doxylink{classNodePathComponent}{Node\+Path\+Component}. If the child was already attached to the indicated parent, repositions it and returns the original \doxylink{classNodePathComponent}{Node\+Path\+Component}.

This operation is automatically propagated back up to pipeline 0, from the specified pipeline stage.

Returns the \doxylink{classNodePathComponent}{Node\+Path\+Component} based on the indicated child of the given parent, or NULL if there is no such parent-\/child relationship.

Returns a \doxylink{classNodePathComponent}{Node\+Path\+Component} referencing the indicated node as a singleton. It is invalid to call this for a node that has parents, unless you are about to create a new instance (and immediately reconnect the \doxylink{classNodePathComponent}{Node\+Path\+Component} elsewhere).

If force is true, this will always return something, even if it needs to create a new top component; otherwise, if force is false, it will return NULL if there is not already a top component available.

Returns a \doxylink{classNodePathComponent}{Node\+Path\+Component} referencing this node as a path from the root.

Unless accept\+\_\+ambiguity is true, it is only valid to call this if there is an unambiguous path from the root; otherwise, a warning will be issued and one path will be chosen arbitrarily.

The recursive implementation of get\+\_\+generic\+\_\+component, this simply sets the flag when the ambiguity is detected (so we can report the bottom node that started the ambiguous search). \Hypertarget{pandaNode_8cxx_ad92b83fa9ad2b5959aa7dd3282297b5e}\label{pandaNode_8cxx_ad92b83fa9ad2b5959aa7dd3282297b5e} 
\index{pandaNode.cxx@{pandaNode.cxx}!PT@{PT}}
\index{PT@{PT}!pandaNode.cxx@{pandaNode.cxx}}
\doxysubsubsection{\texorpdfstring{PT()}{PT()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily PT (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{classPandaNode}{Panda\+Node}}}]{ }\end{DoxyParamCaption})}

Allocates and returns a complete copy of this \doxylink{classPandaNode}{Panda\+Node} and the entire scene graph rooted at this \doxylink{classPandaNode}{Panda\+Node}. Some data may still be shared from the original (e.\+g. vertex index tables), but nothing that will impede normal use of the \doxylink{classPandaNode}{Panda\+Node}. Returns the number of nodes at and below this level. Adds a new child to the node. The child is added in the relative position indicated by sort; if all children have the same sort index, the child is added at the end.

If the same child is added to a node more than once, the previous instance is first removed.

Reads the bytes created by a previous call to encode\+\_\+to\+\_\+bam\+\_\+stream(), and extracts and returns the single object on those bytes. Returns NULL on error.

This method is intended to replace decode\+\_\+raw\+\_\+from\+\_\+bam\+\_\+stream() when you know the stream in question returns an object of type \doxylink{classPandaNode}{Panda\+Node}, allowing for easier reference count management. Note that the caller is still responsible for maintaining the reference count on the return value.

This is the recursive implementation of copy\+\_\+subgraph(). It returns a copy of the entire subgraph rooted at this node.

Note that it includes the parameter inst\+\_\+map, which is a map type, and is not (and cannot be) exported from PANDA.\+DLL. Thus, any derivative of \doxylink{classPandaNode}{Panda\+Node} that is not also a member of PANDA.\+DLL {\itshape cannot} access this map. This is called by r\+\_\+copy\+\_\+subgraph(); the copy has already been made of this particular node (and this is the copy); this function\textquotesingle{}s job is to copy all of the children from the original.

Note that it includes the parameter inst\+\_\+map, which is a map type, and is not (and cannot be) exported from PANDA.\+DLL. Thus, any derivative of \doxylink{classPandaNode}{Panda\+Node} that is not also a member of PANDA.\+DLL {\itshape cannot} access this map, and probably should not even override this function. 