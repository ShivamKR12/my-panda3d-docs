\doxysection{word\+Wrap\+Stream\+Buf.\+cxx}
\hypertarget{wordWrapStreamBuf_8cxx_source}{}\label{wordWrapStreamBuf_8cxx_source}\index{pandatool/src/progbase/wordWrapStreamBuf.cxx@{pandatool/src/progbase/wordWrapStreamBuf.cxx}}
\mbox{\hyperlink{wordWrapStreamBuf_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{wordWrapStreamBuf_8h}{wordWrapStreamBuf.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{wordWrapStream_8h}{wordWrapStream.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{programBase_8h}{programBase.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnotify_8h}{pnotify.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00023\ WordWrapStreamBuf::}
\DoxyCodeLine{00024\ WordWrapStreamBuf(\mbox{\hyperlink{classWordWrapStream}{WordWrapStream}}\ *owner,\ \mbox{\hyperlink{classProgramBase}{ProgramBase}}\ *program)\ :}
\DoxyCodeLine{00025\ \ \ \_owner(owner),}
\DoxyCodeLine{00026\ \ \ \_program(program)}
\DoxyCodeLine{00027\ \{}
\DoxyCodeLine{00028\ \ \ \_literal\_mode\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00029\ \}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00034\ WordWrapStreamBuf::}
\DoxyCodeLine{00035\ \string~WordWrapStreamBuf()\ \{}
\DoxyCodeLine{00036\ \ \ \mbox{\hyperlink{classWordWrapStreamBuf_a6c9312e9fc47cd651ec2df5f6fbb0bf6}{sync}}();}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00043\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classWordWrapStreamBuf_a6c9312e9fc47cd651ec2df5f6fbb0bf6}{WordWrapStreamBuf::}}}
\DoxyCodeLine{00044\ \mbox{\hyperlink{classWordWrapStreamBuf_a6c9312e9fc47cd651ec2df5f6fbb0bf6}{sync}}()\ \{}
\DoxyCodeLine{00045\ \ \ std::streamsize\ n\ =\ pptr()\ -\/\ pbase();}
\DoxyCodeLine{00046\ \ \ write\_chars(pbase(),\ n);}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{comment}{//\ Send\ all\ the\ data\ out\ now.}}
\DoxyCodeLine{00049\ \ \ flush\_data();}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{return}\ 0;\ \ \textcolor{comment}{//\ EOF\ to\ indicate\ write\ full.}}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00058\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classWordWrapStreamBuf_a272bd3803a42c4ac77ed038854cf6581}{WordWrapStreamBuf::}}}
\DoxyCodeLine{00059\ \mbox{\hyperlink{classWordWrapStreamBuf_a272bd3803a42c4ac77ed038854cf6581}{overflow}}(\textcolor{keywordtype}{int}\ ch)\ \{}
\DoxyCodeLine{00060\ \ \ std::streamsize\ n\ =\ pptr()\ -\/\ pbase();}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \textcolor{keywordflow}{if}\ (n\ !=\ 0\ \&\&\ \mbox{\hyperlink{classWordWrapStreamBuf_a6c9312e9fc47cd651ec2df5f6fbb0bf6}{sync}}()\ !=\ 0)\ \{}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{return}\ EOF;}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{if}\ (ch\ !=\ EOF)\ \{}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{//\ Write\ one\ more\ character.}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{char}\ c\ =\ ch;}
\DoxyCodeLine{00069\ \ \ \ \ write\_chars(\&c,\ 1);}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ pbump(-\/n);\ \ \textcolor{comment}{//\ Reset\ pptr().}}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00074\ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00080\ \textcolor{keywordtype}{void}\ WordWrapStreamBuf::}
\DoxyCodeLine{00081\ write\_chars(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *start,\ \textcolor{keywordtype}{int}\ length)\ \{}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{if}\ (length\ >\ 0)\ \{}
\DoxyCodeLine{00083\ \ \ \ \ set\_literal\_mode((\_owner-\/>flags()\ \&\ \mbox{\hyperlink{classNotify_ad2a5fc12cabf3d7779b199f437236cf9}{Notify::get\_literal\_flag}}())\ !=\ 0);}
\DoxyCodeLine{00084\ \ \ \ \ std::string\ new\_data(start,\ length);}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ newline\ =\ new\_data.find\_first\_of(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)r"{}});}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ p\ =\ 0;}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{while}\ (newline\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ new\ data\ contains\ a\ newline;\ flush\ our\ data\ to\ that\ point.}}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \_data\ +=\ new\_data.substr(p,\ newline\ -\/\ p\ +\ 1);}
\DoxyCodeLine{00090\ \ \ \ \ \ \ flush\_data();}
\DoxyCodeLine{00091\ \ \ \ \ \ \ p\ =\ newline\ +\ 1;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ newline\ =\ new\_data.find\_first\_of(\textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)r"{}},\ p);}
\DoxyCodeLine{00093\ \ \ \ \ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{comment}{//\ Save\ the\ rest\ for\ the\ next\ write.}}
\DoxyCodeLine{00096\ \ \ \ \ \_data\ +=\ new\_data.substr(p);}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00104\ \textcolor{keywordtype}{void}\ WordWrapStreamBuf::}
\DoxyCodeLine{00105\ flush\_data()\ \{}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{if}\ (!\_data.empty())\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_literal\_mode)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ std::cerr\ <<\ \_data;}
\DoxyCodeLine{00109\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \_program-\/>show\_text(\_data);}
\DoxyCodeLine{00111\ \ \ \ \ \}}
\DoxyCodeLine{00112\ \ \ \ \ \_data\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ \}}

\end{DoxyCode}
