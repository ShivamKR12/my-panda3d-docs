\doxysection{gtk\+Stats\+Timeline.\+cxx}
\hypertarget{gtkStatsTimeline_8cxx_source}{}\label{gtkStatsTimeline_8cxx_source}\index{pandatool/src/gtk-\/stats/gtkStatsTimeline.cxx@{pandatool/src/gtk-\/stats/gtkStatsTimeline.cxx}}
\mbox{\hyperlink{gtkStatsTimeline_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gtkStatsTimeline_8h}{gtkStatsTimeline.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gtkStatsMonitor_8h}{gtkStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{numeric__types_8h}{numeric\_types.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{gtkStatsLabelStack_8h}{gtkStatsLabelStack.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_width\ =\ 1000;}
\DoxyCodeLine{00020\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_height\ =\ 300;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00025\ GtkStatsTimeline::}
\DoxyCodeLine{00026\ GtkStatsTimeline(\mbox{\hyperlink{classGtkStatsMonitor}{GtkStatsMonitor}}\ *monitor)\ :}
\DoxyCodeLine{00027\ \ \ \mbox{\hyperlink{classPStatTimeline}{PStatTimeline}}(monitor,\ 0,\ 0),}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classGtkStatsGraph}{GtkStatsGraph}}(monitor,\ false)}
\DoxyCodeLine{00029\ \{}
\DoxyCodeLine{00030\ \ \ \textcolor{comment}{//\ Let's\ show\ the\ units\ on\ the\ guide\ bar\ labels.\ \ There's\ room.}}
\DoxyCodeLine{00031\ \ \ set\_guide\_bar\_units(get\_guide\_bar\_units()\ |\ GBU\_show\_units);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \textcolor{comment}{//\ Add\ a\ DrawingArea\ widget\ on\ top\ of\ the\ graph,\ to\ display\ all\ of\ the\ scale}}
\DoxyCodeLine{00034\ \ \ \textcolor{comment}{//\ units.}}
\DoxyCodeLine{00035\ \ \ \_scale\_area\ =\ gtk\_drawing\_area\_new();}
\DoxyCodeLine{00036\ \ \ g\_signal\_connect(G\_OBJECT(\_scale\_area),\ \textcolor{stringliteral}{"{}draw"{}},}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(scale\_area\_draw\_callback),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00038\ \ \ gtk\_box\_pack\_start(GTK\_BOX(\_graph\_vbox),\ \_scale\_area,\ FALSE,\ FALSE,\ 0);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//\ It\ should\ be\ large\ enough\ to\ display\ the\ labels.}}
\DoxyCodeLine{00041\ \ \ \{}
\DoxyCodeLine{00042\ \ \ \ \ PangoLayout\ *layout\ =\ gtk\_widget\_create\_pango\_layout(\_scale\_area,\ \textcolor{stringliteral}{"{}0123456789\ ms"{}});}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{int}\ width,\ height;}
\DoxyCodeLine{00044\ \ \ \ \ pango\_layout\_get\_pixel\_size(layout,\ \&width,\ \&height);}
\DoxyCodeLine{00045\ \ \ \ \ gtk\_widget\_set\_size\_request(\_scale\_area,\ 0,\ height\ +\ \_pixel\_scale\ /\ 2);}
\DoxyCodeLine{00046\ \ \ \ \ g\_object\_unref(layout);}
\DoxyCodeLine{00047\ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Add\ a\ drawing\ area\ to\ the\ left\ of\ the\ graph\ to\ show\ the\ thread\ labels.}}
\DoxyCodeLine{00050\ \ \ \_thread\_area\ =\ gtk\_drawing\_area\_new();}
\DoxyCodeLine{00051\ \ \ gtk\_box\_pack\_start(GTK\_BOX(\_graph\_hbox),\ \_thread\_area,\ FALSE,\ FALSE,\ 0);}
\DoxyCodeLine{00052\ \ \ gtk\_box\_reorder\_child(GTK\_BOX(\_graph\_hbox),\ \_thread\_area,\ 0);}
\DoxyCodeLine{00053\ \ \ g\_signal\_connect(G\_OBJECT(\_thread\_area),\ \textcolor{stringliteral}{"{}draw"{}},}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(thread\_area\_draw\_callback),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ Listen\ for\ mouse\ wheel\ and\ keyboard\ events.}}
\DoxyCodeLine{00057\ \ \ gtk\_widget\_add\_events(\_graph\_window,\ GDK\_SMOOTH\_SCROLL\_MASK\ |}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GDK\_SCROLL\_MASK\ |}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GDK\_KEY\_PRESS\_MASK\ |}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ GDK\_KEY\_RELEASE\_MASK);}
\DoxyCodeLine{00061\ \ \ gtk\_widget\_set\_can\_focus(\_graph\_window,\ TRUE);}
\DoxyCodeLine{00062\ \ \ g\_signal\_connect(G\_OBJECT(\_graph\_window),\ \textcolor{stringliteral}{"{}scroll\_event"{}},}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(scroll\_callback),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00064\ \ \ g\_signal\_connect(G\_OBJECT(\_graph\_window),\ \textcolor{stringliteral}{"{}key\_press\_event"{}},}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(key\_press\_callback),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00066\ \ \ g\_signal\_connect(G\_OBJECT(\_graph\_window),\ \textcolor{stringliteral}{"{}key\_release\_event"{}},}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(key\_release\_callback),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{comment}{//\ Set\ up\ trackpad\ pinch\ and\ swipe\ gestures.}}
\DoxyCodeLine{00070\ \ \ \_zoom\_gesture\ =\ gtk\_gesture\_zoom\_new(\_graph\_window);}
\DoxyCodeLine{00071\ \ \ g\_signal\_connect(\_zoom\_gesture,\ \textcolor{stringliteral}{"{}begin"{}},}
\DoxyCodeLine{00072\ \ \ \ \ G\_CALLBACK(+[](GtkGestureZoom\ *gesture,\ GdkEventSequence\ *sequence,\ gpointer\ data)\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00074\ \ \ \ \ \ \ self-\/>\_zoom\_scale\ =\ self-\/>get\_horizontal\_scale();}
\DoxyCodeLine{00075\ \ \ \ \ \}),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ g\_signal\_connect(\_zoom\_gesture,\ \textcolor{stringliteral}{"{}scale-\/changed"{}},}
\DoxyCodeLine{00078\ \ \ \ \ G\_CALLBACK((+[](GtkGestureZoom\ *gesture,\ gdouble\ scale,\ gpointer\ data)\ \{}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00080\ \ \ \ \ \ \ gdouble\ x,\ y;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (gtk\_gesture\_get\_point(GTK\_GESTURE(gesture),\ NULL,\ \&x,\ \&y))\ \{}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ graph\_x\ =\ (int)(x\ *\ self-\/>\_cr\_scale);}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ self-\/>zoom\_by(log(scale)\ *\ 0.8,\ self-\/>pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ self-\/>\mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00086\ \ \ \ \ \})),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{keywordtype}{int}\ min\_height\ =\ 0;}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{if}\ (!\_threads.empty())\ \{}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keywordtype}{double}\ height\ =\ row\_to\_pixel(get\_num\_rows())\ +\ \_pixel\_scale\ *\ 2.5;}
\DoxyCodeLine{00091\ \ \ \ \ min\_height\ =\ height\ /\ \_cr\_scale;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{comment}{//\ Never\ make\ the\ window\ taller\ than\ the\ screen.}}
\DoxyCodeLine{00094\ \ \ \ \ GdkScreen\ *screen\ =\ gtk\_window\_get\_screen(GTK\_WINDOW(\_window));}
\DoxyCodeLine{00095\ \ \ \ \ min\_height\ =\ std::min(min\_height,\ gdk\_screen\_get\_height(screen));}
\DoxyCodeLine{00096\ \ \ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ gtk\_widget\_set\_size\_request(\_graph\_window,}
\DoxyCodeLine{00099\ \ \ \ \ default\_timeline\_width\ *\ monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a0ab854d38f5cb9d8c134d11033bffa67}{get\_resolution}}()\ /\ 96,}
\DoxyCodeLine{00100\ \ \ \ \ std::max(min\_height,\ (\textcolor{keywordtype}{int})(default\_timeline\_height\ *\ monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a0ab854d38f5cb9d8c134d11033bffa67}{get\_resolution}}()\ /\ 96)));}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ gtk\_window\_set\_title(GTK\_WINDOW(\_window),\ \textcolor{stringliteral}{"{}Timeline"{}});}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \_grid\_pattern\ =\ cairo\_pattern\_create\_rgb(0xdd\ /\ 255.0,\ 0xdd\ /\ 255.0,\ 0xdd\ /\ 255.0);}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ gtk\_widget\_show\_all(\_window);}
\DoxyCodeLine{00107\ \ \ gtk\_widget\_show(\_window);}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \textcolor{comment}{//\ Allow\ the\ window\ to\ be\ resized\ as\ small\ as\ the\ user\ likes.\ \ We\ have\ to\ do}}
\DoxyCodeLine{00110\ \ \ \textcolor{comment}{//\ this\ after\ the\ window\ has\ been\ shown;\ otherwise,\ it\ will\ affect\ the}}
\DoxyCodeLine{00111\ \ \ \textcolor{comment}{//\ window's\ initial\ size.}}
\DoxyCodeLine{00112\ \ \ gtk\_widget\_set\_size\_request(\_graph\_window,\ 0,\ 0);}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ clear\_region();}
\DoxyCodeLine{00115\ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00120\ GtkStatsTimeline::}
\DoxyCodeLine{00121\ \string~GtkStatsTimeline()\ \{}
\DoxyCodeLine{00122\ \ \ cairo\_pattern\_destroy(\_grid\_pattern);}
\DoxyCodeLine{00123\ \ \ g\_object\_unref(\_zoom\_gesture);}
\DoxyCodeLine{00124\ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00132\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_ae9004fd68053d4c63ea70211d11d650d}{GtkStatsTimeline::}}}
\DoxyCodeLine{00133\ \mbox{\hyperlink{classGtkStatsTimeline_ae9004fd68053d4c63ea70211d11d650d}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00134\ \ \ \mbox{\hyperlink{classPStatTimeline_aebb2abcbcf418ce72ce39cb920abfd20}{PStatTimeline::new\_data}}(thread\_index,\ frame\_number);}
\DoxyCodeLine{00135\ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00140\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a8a188ad87414db8f289c5b6cd27b4461}{GtkStatsTimeline::}}}
\DoxyCodeLine{00141\ \mbox{\hyperlink{classGtkStatsTimeline_a8a188ad87414db8f289c5b6cd27b4461}{force\_redraw}}()\ \{}
\DoxyCodeLine{00142\ \ \ assert(\_cr);}
\DoxyCodeLine{00143\ \ \ \textcolor{keywordflow}{if}\ (\_cr)\ \{}
\DoxyCodeLine{00144\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}();}
\DoxyCodeLine{00145\ \ \ \}}
\DoxyCodeLine{00146\ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00151\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a8656ed9f1995f71ec114647cfeae7453}{GtkStatsTimeline::}}}
\DoxyCodeLine{00152\ \mbox{\hyperlink{classGtkStatsTimeline_a8656ed9f1995f71ec114647cfeae7453}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00153\ \ \ \mbox{\hyperlink{classPStatTimeline_a83ea1b01bb9cc013b99cc5c775516869}{PStatTimeline::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00154\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00159\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a379315de8c94082f664ecf524a98b35d}{GtkStatsTimeline::}}}
\DoxyCodeLine{00160\ \mbox{\hyperlink{classGtkStatsTimeline_a379315de8c94082f664ecf524a98b35d}{clear\_region}}()\ \{}
\DoxyCodeLine{00161\ \ \ cairo\_set\_source\_rgb(\_cr,\ 1.0,\ 1.0,\ 1.0);}
\DoxyCodeLine{00162\ \ \ cairo\_paint(\_cr);}
\DoxyCodeLine{00163\ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00168\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a51db3c90c1ac49f8144400f62ca8b214}{GtkStatsTimeline::}}}
\DoxyCodeLine{00169\ \mbox{\hyperlink{classGtkStatsTimeline_a51db3c90c1ac49f8144400f62ca8b214}{begin\_draw}}()\ \{}
\DoxyCodeLine{00170\ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00175\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a9fa8629dbaad9b3854e3fd9fef11d937}{GtkStatsTimeline::}}}
\DoxyCodeLine{00176\ \mbox{\hyperlink{classGtkStatsTimeline_a9fa8629dbaad9b3854e3fd9fef11d937}{draw\_separator}}(\textcolor{keywordtype}{int}\ row)\ \{}
\DoxyCodeLine{00177\ \ \ cairo\_set\_source(\_cr,\ \_grid\_pattern);}
\DoxyCodeLine{00178\ \ \ cairo\_rectangle(\_cr,\ 0,\ (row\_to\_pixel(row)\ +\ row\_to\_pixel(row\ +\ 1))\ /\ 2.0,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ get\_xsize(),\ \_pixel\_scale\ *\ 1\ /\ 3);}
\DoxyCodeLine{00180\ \ \ cairo\_fill(\_cr);}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00186\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_acc2025890b3ddc0fb4968d01564e61a5}{GtkStatsTimeline::}}}
\DoxyCodeLine{00187\ \mbox{\hyperlink{classGtkStatsTimeline_acc2025890b3ddc0fb4968d01564e61a5}{draw\_guide\_bar}}(\textcolor{keywordtype}{int}\ x,\ GuideBarStyle\ style)\ \{}
\DoxyCodeLine{00188\ \ \ \textcolor{keywordtype}{double}\ width\ =\ \_pixel\_scale\ /\ 3.0;}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{if}\ (style\ ==\ GBS\_frame)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ width\ *=\ 2;}
\DoxyCodeLine{00191\ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ cairo\_set\_source(\_cr,\ \_grid\_pattern);}
\DoxyCodeLine{00194\ \ \ cairo\_rectangle(\_cr,\ x\ -\/\ width\ /\ 2.0,\ 0,\ width,\ get\_ysize());}
\DoxyCodeLine{00195\ \ \ cairo\_fill(\_cr);}
\DoxyCodeLine{00196\ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00202\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a02ca2617c1b3a8f3aad2e825e87ef62f}{GtkStatsTimeline::}}}
\DoxyCodeLine{00203\ \mbox{\hyperlink{classGtkStatsTimeline_a02ca2617c1b3a8f3aad2e825e87ef62f}{draw\_bar}}(\textcolor{keywordtype}{int}\ row,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x,\ \textcolor{keywordtype}{int}\ collector\_index,}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&collector\_name)\ \{}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordtype}{int}\ top\ =\ row\_to\_pixel(row);}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ row\_to\_pixel(row\ +\ 1);}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordtype}{int}\ scale\ =\ \_pixel\_scale;}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ row\ ==\ \_highlighted\_row\ \&\&\ \_highlighted\_x\ >=\ from\_x\ \&\&\ \_highlighted\_x\ <\ to\_x;}
\DoxyCodeLine{00210\ \ \ cairo\_set\_source(\_cr,\ \mbox{\hyperlink{classGtkStatsGraph_a2b81b4929003d42bf4aaf5b4ce450c61}{get\_collector\_pattern}}(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ 1)\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ Too\ tiny\ to\ draw.}}
\DoxyCodeLine{00214\ \ \ \}}
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ scale)\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ It's\ just\ a\ tiny\ sliver.\ \ This\ is\ a\ more\ reliable\ way\ to\ draw\ it.}}
\DoxyCodeLine{00217\ \ \ \ \ cairo\_rectangle(\_cr,\ from\_x,\ top,\ to\_x\ -\/\ from\_x,\ bottom\ -\/\ top);}
\DoxyCodeLine{00218\ \ \ \ \ cairo\_fill(\_cr);}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordtype}{int}\ left\ =\ std::max(from\_x,\ -\/scale\ -\/\ 1);}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordtype}{int}\ right\ =\ std::min(std::max(to\_x,\ from\_x\ +\ 1),\ get\_xsize()\ +\ scale);}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordtype}{double}\ radius\ =\ std::min((\textcolor{keywordtype}{double})scale,\ (right\ -\/\ left)\ /\ 2.0);}
\DoxyCodeLine{00225\ \ \ \ \ cairo\_new\_sub\_path(\_cr);}
\DoxyCodeLine{00226\ \ \ \ \ cairo\_arc(\_cr,\ right\ -\/\ radius,\ top\ +\ radius,\ radius,\ -\/0.5\ *\ M\_PI,\ 0.0);}
\DoxyCodeLine{00227\ \ \ \ \ cairo\_arc(\_cr,\ right\ -\/\ radius,\ bottom\ -\/\ radius,\ radius,\ 0.0,\ 0.5\ *\ M\_PI);}
\DoxyCodeLine{00228\ \ \ \ \ cairo\_arc(\_cr,\ left\ +\ radius,\ bottom\ -\/\ radius,\ radius,\ 0.5\ *\ M\_PI,\ M\_PI);}
\DoxyCodeLine{00229\ \ \ \ \ cairo\_arc(\_cr,\ left\ +\ radius,\ top\ +\ radius,\ radius,\ M\_PI,\ 1.5\ *\ M\_PI);}
\DoxyCodeLine{00230\ \ \ \ \ cairo\_close\_path(\_cr);}
\DoxyCodeLine{00231\ \ \ \ \ cairo\_fill(\_cr);}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{if}\ ((to\_x\ -\/\ from\_x)\ >=\ scale\ *\ 4)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ bother\ drawing\ the\ text\ if\ we've\ got\ some\ space\ to\ draw\ on.}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \textcolor{comment}{//\ Choose\ a\ suitable\ foreground\ color.}}
\DoxyCodeLine{00236\ \ \ \ \ \ \ LRGBColor\ fg\ =\ \mbox{\hyperlink{classGtkStatsGraph_acd24bcbfb78da2dbcf4b4525d1c69189}{get\_collector\_text\_color}}(collector\_index,\ is\_highlighted);}
\DoxyCodeLine{00237\ \ \ \ \ \ \ cairo\_set\_source\_rgb(\_cr,\ fg[0],\ fg[1],\ fg[2]);}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ the\ text\ doesn't\ run\ off\ the\ chart.}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ text\_width,\ text\_height;}
\DoxyCodeLine{00241\ \ \ \ \ \ \ PangoLayout\ *layout\ =\ gtk\_widget\_create\_pango\_layout(\_graph\_window,\ collector\_name.c\_str());}
\DoxyCodeLine{00242\ \ \ \ \ \ \ pango\_layout\_set\_attributes(layout,\ \_pango\_attrs);}
\DoxyCodeLine{00243\ \ \ \ \ \ \ pango\_layout\_set\_height(layout,\ -\/1);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ pango\_layout\_get\_pixel\_size(layout,\ \&text\_width,\ \&text\_height);}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ center\ =\ (from\_x\ +\ to\_x)\ /\ 2.0;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_left\ =\ std::max(from\_x,\ 0)\ +\ scale\ /\ 2.0;}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_right\ =\ std::min(to\_x,\ get\_xsize())\ -\/\ scale\ /\ 2.0;}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_top\ =\ top\ +\ (bottom\ -\/\ top\ -\/\ text\_height)\ /\ 2.0;}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_width\ >=\ text\_right\ -\/\ text\_left)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ c\ =\ collector\_name.rfind(\textcolor{charliteral}{':'});}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_right\ -\/\ text\_left\ <\ scale\ *\ 6)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ a\ really\ tiny\ space.\ \ Draw\ a\ single\ letter.}}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *ch\ =\ collector\_name.data()\ +\ (c\ !=\ std::string::npos\ ?\ c\ +\ 1\ :\ 0);}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ pango\_layout\_set\_alignment(layout,\ PANGO\_ALIGN\_CENTER);}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ pango\_layout\_set\_text(layout,\ ch,\ 1);}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Maybe\ just\ use\ everything\ after\ the\ last\ colon.}}
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ pango\_layout\_set\_text(layout,\ collector\_name.data()\ +\ c\ +\ 1,}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ collector\_name.size()\ -\/\ c\ -\/\ 1);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ pango\_layout\_get\_pixel\_size(layout,\ \&text\_width,\ \&text\_height);}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_width\ >=\ text\_right\ -\/\ text\_left)\ \{}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ going\ to\ be\ tricky\ to\ fit\ it,\ let\ pango\ figure\ it\ out.}}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ pango\_layout\_set\_ellipsize(layout,\ PANGO\_ELLIPSIZE\_END);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ pango\_layout\_set\_width(layout,\ (text\_right\ -\/\ text\_left)\ *\ PANGO\_SCALE);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ cairo\_move\_to(\_cr,\ text\_left,\ text\_top);}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (center\ -\/\ text\_width\ /\ 2.0\ <\ 0.0)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ left-\/most\ edge.}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ cairo\_move\_to(\_cr,\ scale,\ text\_top);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (center\ +\ text\_width\ /\ 2.0\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ right-\/most\ edge.}}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ cairo\_move\_to(\_cr,\ get\_xsize()\ -\/\ scale\ -\/\ text\_width,\ text\_top);}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ fits\ just\ fine,\ center\ it.}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ cairo\_move\_to(\_cr,\ center\ -\/\ text\_width\ /\ 2.0,\ text\_top);}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \ \ pango\_cairo\_show\_layout(\_cr,\ layout);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ g\_object\_unref(layout);}
\DoxyCodeLine{00289\ \ \ \ \ \}}
\DoxyCodeLine{00290\ \ \ \}}
\DoxyCodeLine{00291\ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00297\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a86e156e4c0ced185506750be5be92fcf}{GtkStatsTimeline::}}}
\DoxyCodeLine{00298\ \mbox{\hyperlink{classGtkStatsTimeline_a86e156e4c0ced185506750be5be92fcf}{end\_draw}}()\ \{}
\DoxyCodeLine{00299\ \ \ gtk\_widget\_queue\_draw(\_graph\_window);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{keywordflow}{if}\ (\_threads\_changed)\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{comment}{//\ Calculate\ the\ size\ of\ the\ thread\ area.}}
\DoxyCodeLine{00303\ \ \ \ \ PangoLayout\ *layout\ =\ gtk\_widget\_create\_pango\_layout(\_thread\_area,\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordtype}{int}\ max\_width\ =\ 0;}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatTimeline_1_1ThreadRow}{ThreadRow}}\ \&thread\_row\ :\ \_threads)\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!thread\_row.\_visible)\ \{}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ pango\_layout\_set\_text(layout,\ thread\_row.\_label.c\_str(),\ thread\_row.\_label.size());}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ width,\ height;}
\DoxyCodeLine{00313\ \ \ \ \ \ \ pango\_layout\_get\_pixel\_size(layout,\ \&width,\ \&height);}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (width\ >\ max\_width)\ \{}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ max\_width\ =\ width;}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00318\ \ \ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \ \ gtk\_widget\_set\_size\_request(\_thread\_area,\ max\_width\ +\ \_pixel\_scale\ *\ 2,\ 0);}
\DoxyCodeLine{00321\ \ \ \ \ g\_object\_unref(layout);}
\DoxyCodeLine{00322\ \ \ \ \ gtk\_widget\_queue\_draw(\_thread\_area);}
\DoxyCodeLine{00323\ \ \ \ \ \_threads\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00324\ \ \ \}}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \textcolor{keywordflow}{if}\ (\_guide\_bars\_changed)\ \{}
\DoxyCodeLine{00327\ \ \ \ \ gtk\_widget\_queue\_draw(\_scale\_area);}
\DoxyCodeLine{00328\ \ \ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00329\ \ \ \}}
\DoxyCodeLine{00330\ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00335\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a743ffb921f4f0d4d3c5d1431499c2a96}{GtkStatsTimeline::}}}
\DoxyCodeLine{00336\ \mbox{\hyperlink{classGtkStatsTimeline_a743ffb921f4f0d4d3c5d1431499c2a96}{idle}}()\ \{}
\DoxyCodeLine{00337\ \}}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00343\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGtkStatsTimeline_a61941fb10c685aa50f586ba4ca22a67f}{GtkStatsTimeline::}}}
\DoxyCodeLine{00344\ \mbox{\hyperlink{classGtkStatsTimeline_a61941fb10c685aa50f586ba4ca22a67f}{animate}}(\textcolor{keywordtype}{double}\ time,\ \textcolor{keywordtype}{double}\ dt)\ \{}
\DoxyCodeLine{00345\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_a4bb82d0d67715053beebb23a8dc8589d}{PStatTimeline::animate}}(time,\ dt);}
\DoxyCodeLine{00346\ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00351\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classGtkStatsTimeline_ac76bd9c56897c097d12e61ba5cbee8e8}{GtkStatsTimeline::}}}
\DoxyCodeLine{00352\ \mbox{\hyperlink{classGtkStatsTimeline_ac76bd9c56897c097d12e61ba5cbee8e8}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00354\ \ \ \mbox{\hyperlink{classGtkStatsGraph_a1fd380d910629fce8e84d64524b8aa93}{GtkStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00355\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00356\ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00361\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a8fd42d8e5d4fb8016b3dd84578c74c6e}{GtkStatsTimeline::}}}
\DoxyCodeLine{00362\ \mbox{\hyperlink{classGtkStatsTimeline_a8fd42d8e5d4fb8016b3dd84578c74c6e}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00364\ \ \ \mbox{\hyperlink{classGtkStatsGraph_a3297782d1fe8ebc6375ea52a9f53618d}{GtkStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00365\ \}}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00371\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGtkStatsTimeline_a128421b7fdbdd5cc2ec125484fda726c}{GtkStatsTimeline::}}}
\DoxyCodeLine{00372\ \mbox{\hyperlink{classGtkStatsTimeline_a128421b7fdbdd5cc2ec125484fda726c}{additional\_graph\_window\_paint}}(cairo\_t\ *cr)\ \{}
\DoxyCodeLine{00373\ \}}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00379\ std::string\ \mbox{\hyperlink{classGtkStatsTimeline_a82f6ff02b365fddfa9e338cbb12a7dc0}{GtkStatsTimeline::}}}
\DoxyCodeLine{00380\ \mbox{\hyperlink{classGtkStatsTimeline_a82f6ff02b365fddfa9e338cbb12a7dc0}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00381\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_ab138ad122f3c31ffbe334a65458baf20}{PStatTimeline::get\_bar\_tooltip}}(pixel\_to\_row(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00382\ \}}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00389\ GtkStatsGraph::DragMode\ \mbox{\hyperlink{classGtkStatsTimeline_a000a26706a0d8b5c4a666e4b7b5157e4}{GtkStatsTimeline::}}}
\DoxyCodeLine{00390\ \mbox{\hyperlink{classGtkStatsTimeline_a000a26706a0d8b5c4a666e4b7b5157e4}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsGraph_a00927751e3fa0207c85ff6d08e0c940c}{GtkStatsGraph::consider\_drag\_start}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00392\ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00397\ gboolean\ \mbox{\hyperlink{classGtkStatsTimeline_a467428214cdbd17ba621797a8645e09a}{GtkStatsTimeline::}}}
\DoxyCodeLine{00398\ \mbox{\hyperlink{classGtkStatsTimeline_a467428214cdbd17ba621797a8645e09a}{handle\_button\_press}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ double\_click,\ \textcolor{keywordtype}{int}\ button)\ \{}
\DoxyCodeLine{00399\ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{if}\ (button\ ==\ 3)\ \{}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \textcolor{comment}{//\ Right-\/clicking\ a\ color\ bar\ brings\ up\ a\ context\ menu.}}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_1_1ColorBar}{ColorBar}}\ bar;}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatTimeline_a88c95e4a4620491da72dd2cf551b04b3}{find\_bar}}(row,\ graph\_x,\ bar))\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ GtkWidget\ *menu\ =\ gtk\_menu\_new();}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \_popup\_bar\ =\ bar;}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ std::string\ label\ =\ \mbox{\hyperlink{classPStatTimeline_ab138ad122f3c31ffbe334a65458baf20}{get\_bar\_tooltip}}(row,\ graph\_x);}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(label.c\_str());}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ gtk\_widget\_set\_sensitive(menu\_item,\ FALSE);}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Zoom\ To"{}});}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(+[]\ (GtkWidget\ *widget,\ gpointer\ data)\ \{}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatTimeline_1_1ColorBar}{ColorBar}}\ \&bar\ =\ self-\/>\_popup\_bar;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ width\ =\ bar.\_end\ -\/\ bar.\_start;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self-\/>zoom\_to(width\ *\ 1.5,\ (bar.\_end\ +\ bar.\_start)\ /\ 2.0);}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self-\/>scroll\_to(bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self-\/>\mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \}),}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{this});}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGtkStatsMonitor_1_1MenuDef}{GtkStatsMonitor::MenuDef}}\ *menu\_def\ =\ GtkStatsGraph::\_monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a9e6da0c29b29e7bf376ebdf743968dd6}{add\_menu}}(\{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ GtkStatsMonitor::CT\_strip\_chart,}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ bar.\_thread\_index,\ bar.\_collector\_index,}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00436\ }
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Open\ Strip\ Chart"{}});}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(\mbox{\hyperlink{classGtkStatsMonitor_a35a4d279db316126b4f8f564d7f2fb92}{GtkStatsMonitor::menu\_activate}}),}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *)menu\_def);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00443\ }
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGtkStatsMonitor_1_1MenuDef}{GtkStatsMonitor::MenuDef}}\ *menu\_def\ =\ GtkStatsGraph::\_monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a9e6da0c29b29e7bf376ebdf743968dd6}{add\_menu}}(\{}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ GtkStatsMonitor::CT\_flame\_graph,}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ bar.\_thread\_index,\ bar.\_collector\_index,\ bar.\_frame\_number,}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Open\ Flame\ Graph"{}});}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(\mbox{\hyperlink{classGtkStatsMonitor_a35a4d279db316126b4f8f564d7f2fb92}{GtkStatsMonitor::menu\_activate}}),}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *)menu\_def);}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGtkStatsMonitor_1_1MenuDef}{GtkStatsMonitor::MenuDef}}\ *menu\_def\ =\ GtkStatsGraph::\_monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a9e6da0c29b29e7bf376ebdf743968dd6}{add\_menu}}(\{}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \ \ \ \ \ \ GtkStatsMonitor::CT\_piano\_roll,\ bar.\_thread\_index,\ -\/1,}
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Open\ Piano\ Roll"{}});}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(\mbox{\hyperlink{classGtkStatsMonitor_a35a4d279db316126b4f8f564d7f2fb92}{GtkStatsMonitor::menu\_activate}}),}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *)menu\_def);}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_separator\_menu\_item\_new();}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGtkStatsMonitor_1_1MenuDef}{GtkStatsMonitor::MenuDef}}\ *menu\_def\ =\ GtkStatsGraph::\_monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a9e6da0c29b29e7bf376ebdf743968dd6}{add\_menu}}(\{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \ \ \ \ GtkStatsMonitor::CT\_choose\_color,\ -\/1,\ bar.\_collector\_index,}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Change\ Color..."{}});}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(\mbox{\hyperlink{classGtkStatsMonitor_a35a4d279db316126b4f8f564d7f2fb92}{GtkStatsMonitor::menu\_activate}}),}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *)menu\_def);}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGtkStatsMonitor_1_1MenuDef}{GtkStatsMonitor::MenuDef}}\ *menu\_def\ =\ GtkStatsGraph::\_monitor-\/>\mbox{\hyperlink{classGtkStatsMonitor_a9e6da0c29b29e7bf376ebdf743968dd6}{add\_menu}}(\{}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \ \ \ \ GtkStatsMonitor::CT\_reset\_color,\ -\/1,\ bar.\_collector\_index,}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ GtkWidget\ *menu\_item\ =\ gtk\_menu\_item\_new\_with\_label(\textcolor{stringliteral}{"{}Reset\ Color"{}});}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \ \ gtk\_menu\_shell\_append(GTK\_MENU\_SHELL(menu),\ menu\_item);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ g\_signal\_connect(G\_OBJECT(menu\_item),\ \textcolor{stringliteral}{"{}activate"{}},}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ G\_CALLBACK(\mbox{\hyperlink{classGtkStatsMonitor_a35a4d279db316126b4f8f564d7f2fb92}{GtkStatsMonitor::menu\_activate}}),}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (\textcolor{keywordtype}{void}\ *)menu\_def);}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00497\ }
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ gtk\_widget\_show\_all(menu);}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ gtk\_menu\_popup\_at\_pointer(GTK\_MENU(menu),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FALSE;}
\DoxyCodeLine{00503\ \ \ \ \ \}}
\DoxyCodeLine{00504\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (double\_click\ \&\&\ button\ ==\ 1)\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ will\ zoom\ the\ graph\ into}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ collector.}}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_1_1ColorBar}{ColorBar}}\ bar;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatTimeline_a88c95e4a4620491da72dd2cf551b04b3}{find\_bar}}(row,\ graph\_x,\ bar))\ \{}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ width\ =\ bar.\_end\ -\/\ bar.\_start;}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ zoom\_to(width\ *\ 1.5,\ pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ scroll\_to(bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ the\ white\ area\ zooms\ out.}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \_zoom\_speed\ -\/=\ 100.0;}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00518\ \ \ \ \ \}}
\DoxyCodeLine{00519\ }
\DoxyCodeLine{00520\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_acf477ec8aaef7e698414175536e33199}{set\_drag\_mode}}(DM\_pan);}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \_scroll\_speed\ =\ 0.0;}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(graph\_x);}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00526\ \ \ \ \ \}}
\DoxyCodeLine{00527\ \ \ \}}
\DoxyCodeLine{00528\ }
\DoxyCodeLine{00529\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsGraph_a76128b5582850e6385a9fb4946e0429d}{GtkStatsGraph::handle\_button\_press}}(graph\_x,\ graph\_y,}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\_click,\ button);}
\DoxyCodeLine{00531\ \}}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00536\ gboolean\ \mbox{\hyperlink{classGtkStatsTimeline_ac865b9375664b541c9439687a53f42bc}{GtkStatsTimeline::}}}
\DoxyCodeLine{00537\ \mbox{\hyperlink{classGtkStatsTimeline_ac865b9375664b541c9439687a53f42bc}{handle\_button\_release}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00538\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_scale)\ \{}
\DoxyCodeLine{00539\ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_acf477ec8aaef7e698414175536e33199}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsTimeline_a66e426cb01cb67e6c46cb59df9d9c799}{handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00542\ \ \ \}}
\DoxyCodeLine{00543\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ <\ 0\ ||\ graph\_x\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a7627d5e29b88196713f4ba3cea78ea17}{remove\_user\_guide\_bar}}(\_drag\_guide\_bar);}
\DoxyCodeLine{00546\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a45ecee227793ee5f2059e58f8d844ad8}{move\_user\_guide\_bar}}(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00548\ \ \ \ \ \}}
\DoxyCodeLine{00549\ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_acf477ec8aaef7e698414175536e33199}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00551\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsTimeline_a66e426cb01cb67e6c46cb59df9d9c799}{handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00552\ \ \ \}}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsGraph_a43c79da697920e23e53ea8db754444e8}{GtkStatsGraph::handle\_button\_release}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00555\ \}}
\DoxyCodeLine{00556\ }
\DoxyCodeLine{00560\ gboolean\ \mbox{\hyperlink{classGtkStatsTimeline_a66e426cb01cb67e6c46cb59df9d9c799}{GtkStatsTimeline::}}}
\DoxyCodeLine{00561\ \mbox{\hyperlink{classGtkStatsTimeline_a66e426cb01cb67e6c46cb59df9d9c799}{handle\_motion}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00562\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none\ \&\&}
\DoxyCodeLine{00563\ \ \ \ \ \ \ graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00564\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00566\ \ \ \ \ std::swap(\_highlighted\_x,\ graph\_x);}
\DoxyCodeLine{00567\ \ \ \ \ std::swap(\_highlighted\_row,\ row);}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00569\ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ >=\ 0)\ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ graph\_x,\ graph\_x);}
\DoxyCodeLine{00571\ \ \ \ \ \}}
\DoxyCodeLine{00572\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(\_highlighted\_row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_keys\_held\ \&\ (F\_w\ |\ F\_s))\ !=\ 0)\ \{}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ zoom\ center\ if\ we\ move\ the\ mouse\ while\ zooming\ with\ the}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \textcolor{comment}{//\ keyboard.}}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(graph\_x);}
\DoxyCodeLine{00578\ \ \ \ \ \}}
\DoxyCodeLine{00579\ \ \ \}}
\DoxyCodeLine{00580\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{comment}{//\ If\ the\ mouse\ is\ in\ some\ drag\ mode,\ stop\ highlighting.}}
\DoxyCodeLine{00582\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00586\ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_pan)\ \{}
\DoxyCodeLine{00590\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ \_drag\_start\_x\ -\/\ graph\_x;}
\DoxyCodeLine{00591\ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00592\ \ \ \ \ set\_horizontal\_scroll(get\_horizontal\_scroll()\ +\ pixel\_to\_height(delta));}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00594\ \ \ \}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGtkStatsGraph_a36a7bae6cbad842a6998fcd97ab3e26a}{GtkStatsGraph::handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00597\ \}}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00602\ gboolean\ \mbox{\hyperlink{classGtkStatsTimeline_a5291070cbe96ce28e6c88937bbd53936}{GtkStatsTimeline::}}}
\DoxyCodeLine{00603\ \mbox{\hyperlink{classGtkStatsTimeline_a5291070cbe96ce28e6c88937bbd53936}{handle\_leave}}()\ \{}
\DoxyCodeLine{00604\ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00606\ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00607\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00608\ \ \ \}}
\DoxyCodeLine{00609\ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00610\ \}}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00615\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00616\ handle\_scroll(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy,\ \textcolor{keywordtype}{bool}\ ctrl\_held)\ \{}
\DoxyCodeLine{00617\ \ \ gboolean\ handled\ =\ FALSE;}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \textcolor{keywordflow}{if}\ (dy\ !=\ 0.0)\ \{}
\DoxyCodeLine{00620\ \ \ \ \ handled\ =\ TRUE;}
\DoxyCodeLine{00621\ \ \ \ \ \textcolor{keywordflow}{if}\ (ctrl\_held)\ \{}
\DoxyCodeLine{00622\ \ \ \ \ \ \ zoom\_by(dy,\ pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00624\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ delta\ =\ (int)(dy\ *\ \_pixel\_scale\ *\ 5\ +\ 0.5);}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_scroll\ =\ \_scroll\ -\/\ delta;}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_threads.empty())\ \{}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ new\_scroll\ =\ 0;}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ new\_scroll\ =\ (std::min)(new\_scroll,\ get\_num\_rows()\ *\ \_pixel\_scale\ *\ 5\ +\ \_pixel\_scale\ *\ 2\ -\/\ get\_ysize());}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ new\_scroll\ =\ (std::max)(new\_scroll,\ 0);}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ delta\ =\ new\_scroll\ -\/\ \_scroll;}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ !=\ 0)\ \{}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \_scroll\ =\ new\_scroll;}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ gtk\_widget\_queue\_draw(\_thread\_area);}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsTimeline_a8a188ad87414db8f289c5b6cd27b4461}{force\_redraw}}();}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00639\ \ \ \ \ \}}
\DoxyCodeLine{00640\ \ \ \}}
\DoxyCodeLine{00641\ }
\DoxyCodeLine{00642\ \ \ \textcolor{keywordflow}{if}\ (dx\ !=\ 0.0)\ \{}
\DoxyCodeLine{00643\ \ \ \ \ \_scroll\_speed\ +=\ dx\ *\ 10.0;}
\DoxyCodeLine{00644\ \ \ \ \ handled\ =\ TRUE;}
\DoxyCodeLine{00645\ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00646\ \ \ \}}
\DoxyCodeLine{00647\ }
\DoxyCodeLine{00648\ \ \ \textcolor{keywordflow}{return}\ handled;}
\DoxyCodeLine{00649\ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00654\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00655\ handle\_zoom(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ scale)\ \{}
\DoxyCodeLine{00656\ \ \ zoom\_to(get\_horizontal\_scale()\ /\ scale,\ pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00657\ \ \ \mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00658\ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00659\ \}}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00664\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00665\ handle\_key(\textcolor{keywordtype}{bool}\ pressed,\ guint\ val,\ guint16\ hw\_code)\ \{}
\DoxyCodeLine{00666\ \ \ \textcolor{comment}{//\ Accept\ WASD\ based\ on\ their\ position\ rather\ than\ their\ mapping}}
\DoxyCodeLine{00667\ \ \ \textcolor{keywordtype}{int}\ flag\ =\ 0;}
\DoxyCodeLine{00668\ \ \ \textcolor{keywordflow}{switch}\ (hw\_code)\ \{}
\DoxyCodeLine{00669\ \ \ \textcolor{keywordflow}{case}\ 25:}
\DoxyCodeLine{00670\ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00672\ \ \ \textcolor{keywordflow}{case}\ 38:}
\DoxyCodeLine{00673\ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00675\ \ \ \textcolor{keywordflow}{case}\ 39:}
\DoxyCodeLine{00676\ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00677\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00678\ \ \ \textcolor{keywordflow}{case}\ 40:}
\DoxyCodeLine{00679\ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00681\ \ \ \}}
\DoxyCodeLine{00682\ \ \ \textcolor{keywordflow}{if}\ (flag\ ==\ 0)\ \{}
\DoxyCodeLine{00683\ \ \ \ \ \textcolor{keywordflow}{switch}\ (val)\ \{}
\DoxyCodeLine{00684\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_Left:}
\DoxyCodeLine{00685\ \ \ \ \ \ \ flag\ =\ F\_left;}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00687\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_Right:}
\DoxyCodeLine{00688\ \ \ \ \ \ \ flag\ =\ F\_right;}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_w:}
\DoxyCodeLine{00691\ \ \ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00692\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_a:}
\DoxyCodeLine{00694\ \ \ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00695\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00696\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_s:}
\DoxyCodeLine{00697\ \ \ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00699\ \ \ \ \ \textcolor{keywordflow}{case}\ GDK\_KEY\_d:}
\DoxyCodeLine{00700\ \ \ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00702\ \ \ \ \ \}}
\DoxyCodeLine{00703\ \ \ \}}
\DoxyCodeLine{00704\ \ \ \textcolor{keywordflow}{if}\ (flag\ !=\ 0)\ \{}
\DoxyCodeLine{00705\ \ \ \ \ \textcolor{keywordflow}{if}\ (pressed)\ \{}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ \&\ (F\_w\ |\ F\_s))\ \{}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Pfoo,\ GTK\ sure\ does\ make\ it\ hard\ to\ just\ get\ the\ cursor\ position.}}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ GdkWindow\ *window\ =\ gtk\_widget\_get\_window(\_graph\_window);}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ GdkDisplay\ *display\ =\ gdk\_window\_get\_display(window);}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ GdkDeviceManager\ *device\_manager\ =\ gdk\_display\_get\_device\_manager(display);}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ GdkDevice\ *device\ =\ gdk\_device\_manager\_get\_client\_pointer(device\_manager);}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ gint\ x,\ y;}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ gdk\_window\_get\_device\_position(window,\ device,\ \&x,\ \&y,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(x\ *\ \_cr\_scale);}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_keys\_held\ ==\ 0)\ \{}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGtkStatsGraph_a142007cf89c5da3c41eb2dfc5129ce9f}{start\_animation}}();}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \_keys\_held\ |=\ flag;}
\DoxyCodeLine{00720\ \ \ \ \ \}}
\DoxyCodeLine{00721\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_keys\_held\ !=\ 0)\ \{}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \_keys\_held\ \&=\ \string~flag;}
\DoxyCodeLine{00723\ \ \ \ \ \}}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00725\ \ \ \}}
\DoxyCodeLine{00726\ \ \ \textcolor{keywordflow}{return}\ FALSE;}
\DoxyCodeLine{00727\ \}}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00732\ \textcolor{keywordtype}{void}\ GtkStatsTimeline::}
\DoxyCodeLine{00733\ draw\_guide\_labels(cairo\_t\ *cr)\ \{}
\DoxyCodeLine{00734\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00735\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00736\ \ \ \ \ draw\_guide\_label(cr,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i));}
\DoxyCodeLine{00737\ \ \ \}}
\DoxyCodeLine{00738\ \}}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00743\ \textcolor{keywordtype}{void}\ GtkStatsTimeline::}
\DoxyCodeLine{00744\ draw\_guide\_label(cairo\_t\ *cr,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00745\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00746\ \ \ \textcolor{keywordflow}{if}\ (label.empty())\ \{}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00748\ \ \ \}}
\DoxyCodeLine{00749\ }
\DoxyCodeLine{00750\ \ \ \textcolor{keywordtype}{bool}\ center\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00751\ \ \ \textcolor{keywordflow}{switch}\ (bar.\_style)\ \{}
\DoxyCodeLine{00752\ \ \ \textcolor{keywordflow}{case}\ GBS\_target:}
\DoxyCodeLine{00753\ \ \ \ \ cairo\_set\_source\_rgb(cr,\ rgb\_light\_gray[0],\ rgb\_light\_gray[1],\ rgb\_light\_gray[2]);}
\DoxyCodeLine{00754\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00755\ }
\DoxyCodeLine{00756\ \ \ \textcolor{keywordflow}{case}\ GBS\_user:}
\DoxyCodeLine{00757\ \ \ \ \ cairo\_set\_source\_rgb(cr,\ rgb\_user\_guide\_bar[0],\ rgb\_user\_guide\_bar[1],\ rgb\_user\_guide\_bar[2]);}
\DoxyCodeLine{00758\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \textcolor{keywordflow}{case}\ GBS\_normal:}
\DoxyCodeLine{00761\ \ \ \ \ cairo\_set\_source\_rgb(cr,\ rgb\_light\_gray[0],\ rgb\_light\_gray[1],\ rgb\_light\_gray[2]);}
\DoxyCodeLine{00762\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00763\ }
\DoxyCodeLine{00764\ \ \ \textcolor{keywordflow}{case}\ GBS\_frame:}
\DoxyCodeLine{00765\ \ \ \ \ cairo\_set\_source\_rgb(cr,\ rgb\_dark\_gray[0],\ rgb\_dark\_gray[1],\ rgb\_dark\_gray[2]);}
\DoxyCodeLine{00766\ \ \ \ \ center\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00767\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00768\ \ \ \}}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ \ \ PangoLayout\ *layout\ =\ gtk\_widget\_create\_pango\_layout(\_scale\_area,\ label.c\_str());}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ \textcolor{keywordflow}{if}\ (bar.\_style\ !=\ GBS\_frame)\ \{}
\DoxyCodeLine{00773\ \ \ \ \ \textcolor{comment}{//\ Make\ the\ offsets\ slightly\ smaller.}}
\DoxyCodeLine{00774\ \ \ \ \ PangoAttrList\ *attrs\ =\ pango\_attr\_list\_new();}
\DoxyCodeLine{00775\ \ \ \ \ PangoAttribute\ *attr\ =\ pango\_attr\_scale\_new(0.9);}
\DoxyCodeLine{00776\ \ \ \ \ attr-\/>start\_index\ =\ 0;}
\DoxyCodeLine{00777\ \ \ \ \ attr-\/>end\_index\ =\ -\/1;}
\DoxyCodeLine{00778\ \ \ \ \ pango\_attr\_list\_insert(attrs,\ attr);}
\DoxyCodeLine{00779\ \ \ \ \ pango\_layout\_set\_attributes(layout,\ attrs);}
\DoxyCodeLine{00780\ \ \ \ \ pango\_attr\_list\_unref(attrs);}
\DoxyCodeLine{00781\ \ \ \}}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \textcolor{keywordtype}{int}\ width,\ height;}
\DoxyCodeLine{00784\ \ \ pango\_layout\_get\_pixel\_size(layout,\ \&width,\ \&height);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00787\ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ +\ width\ *\ \_cr\_scale\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{comment}{//\ Now\ convert\ our\ x\ to\ a\ coordinate\ within\ our\ drawing\ area.}}
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{int}\ junk\_y;}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \ \ x\ /=\ \_cr\_scale;}
\DoxyCodeLine{00792\ }
\DoxyCodeLine{00793\ \ \ \ \ \textcolor{comment}{//\ The\ x\ coordinate\ comes\ from\ the\ graph\_window.}}
\DoxyCodeLine{00794\ \ \ \ \ gtk\_widget\_translate\_coordinates(\_graph\_window,\ \_scale\_area,}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x,\ 0,\ \&x,\ \&junk\_y);}
\DoxyCodeLine{00796\ }
\DoxyCodeLine{00797\ \ \ \ \ GtkAllocation\ allocation;}
\DoxyCodeLine{00798\ \ \ \ \ gtk\_widget\_get\_allocation(\_scale\_area,\ \&allocation);}
\DoxyCodeLine{00799\ }
\DoxyCodeLine{00800\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0)\ \{}
\DoxyCodeLine{00801\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ this\_x\ =\ x;}
\DoxyCodeLine{00802\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (center)\ \{}
\DoxyCodeLine{00803\ \ \ \ \ \ \ \ \ this\_x\ -\/=\ width\ /\ 2;}
\DoxyCodeLine{00804\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00805\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (this\_x\ +\ width\ <\ allocation.width)\ \{}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ cairo\_move\_to(cr,\ this\_x,\ allocation.height\ -\/\ height);}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ pango\_cairo\_show\_layout(cr,\ layout);}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00809\ \ \ \ \ \}}
\DoxyCodeLine{00810\ \ \ \}}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ g\_object\_unref(layout);}
\DoxyCodeLine{00813\ \}}
\DoxyCodeLine{00814\ }
\DoxyCodeLine{00818\ \textcolor{keywordtype}{void}\ GtkStatsTimeline::}
\DoxyCodeLine{00819\ draw\_thread\_labels(cairo\_t\ *cr)\ \{}
\DoxyCodeLine{00820\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ ThreadRow\ \&thread\_row\ :\ \_threads)\ \{}
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread\_row.\_visible)\ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ draw\_thread\_label(cr,\ thread\_row);}
\DoxyCodeLine{00823\ \ \ \ \ \}}
\DoxyCodeLine{00824\ \ \ \}}
\DoxyCodeLine{00825\ \}}
\DoxyCodeLine{00826\ }
\DoxyCodeLine{00830\ \textcolor{keywordtype}{void}\ GtkStatsTimeline::}
\DoxyCodeLine{00831\ draw\_thread\_label(cairo\_t\ *cr,\ \textcolor{keyword}{const}\ ThreadRow\ \&thread\_row)\ \{}
\DoxyCodeLine{00832\ \ \ \textcolor{keywordtype}{int}\ top\ =\ row\_to\_pixel(thread\_row.\_row\_offset);}
\DoxyCodeLine{00833\ \ \ \textcolor{keywordflow}{if}\ (top\ <=\ get\_ysize())\ \{}
\DoxyCodeLine{00834\ \ \ \ \ \textcolor{comment}{//\ Now\ convert\ our\ y\ to\ a\ coordinate\ within\ our\ drawing\ area.}}
\DoxyCodeLine{00835\ \ \ \ \ top\ /=\ \_cr\_scale;}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ \ \ \textcolor{comment}{//\ The\ y\ coordinate\ comes\ from\ the\ graph\_window.}}
\DoxyCodeLine{00838\ \ \ \ \ \textcolor{keywordtype}{int}\ junk\_x;}
\DoxyCodeLine{00839\ \ \ \ \ gtk\_widget\_translate\_coordinates(\_graph\_window,\ \_thread\_area,}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0,\ top,\ \&junk\_x,\ \&top);}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \ \ GtkAllocation\ allocation;}
\DoxyCodeLine{00843\ \ \ \ \ gtk\_widget\_get\_allocation(\_thread\_area,\ \&allocation);}
\DoxyCodeLine{00844\ }
\DoxyCodeLine{00845\ \ \ \ \ PangoLayout\ *layout\ =\ gtk\_widget\_create\_pango\_layout(\_thread\_area,\ thread\_row.\_label.c\_str());}
\DoxyCodeLine{00846\ \ \ \ \ pango\_layout\_set\_alignment(layout,\ PANGO\_ALIGN\_RIGHT);}
\DoxyCodeLine{00847\ \ \ \ \ pango\_layout\_set\_ellipsize(layout,\ PANGO\_ELLIPSIZE\_END);}
\DoxyCodeLine{00848\ \ \ \ \ pango\_layout\_set\_width(layout,\ (allocation.width\ -\/\ \_pixel\_scale\ *\ 2)\ *\ PANGO\_SCALE);}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \ \ cairo\_move\_to(cr,\ \_pixel\_scale,\ top);}
\DoxyCodeLine{00851\ \ \ \ \ pango\_cairo\_show\_layout(cr,\ layout);}
\DoxyCodeLine{00852\ \ \ \ \ g\_object\_unref(layout);}
\DoxyCodeLine{00853\ \ \ \}}
\DoxyCodeLine{00854\ \}}
\DoxyCodeLine{00855\ }
\DoxyCodeLine{00859\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00860\ scale\_area\_draw\_callback(GtkWidget\ *widget,\ cairo\_t\ *cr,\ gpointer\ data)\ \{}
\DoxyCodeLine{00861\ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00862\ \ \ self-\/>draw\_guide\_labels(cr);}
\DoxyCodeLine{00863\ }
\DoxyCodeLine{00864\ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00865\ \}}
\DoxyCodeLine{00866\ }
\DoxyCodeLine{00870\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00871\ thread\_area\_draw\_callback(GtkWidget\ *widget,\ cairo\_t\ *cr,\ gpointer\ data)\ \{}
\DoxyCodeLine{00872\ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00873\ \ \ self-\/>draw\_thread\_labels(cr);}
\DoxyCodeLine{00874\ }
\DoxyCodeLine{00875\ \ \ \textcolor{keywordflow}{return}\ TRUE;}
\DoxyCodeLine{00876\ \}}
\DoxyCodeLine{00877\ }
\DoxyCodeLine{00881\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00882\ scroll\_callback(GtkWidget\ *widget,\ GdkEventScroll\ *event,\ gpointer\ data)\ \{}
\DoxyCodeLine{00883\ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00884\ }
\DoxyCodeLine{00885\ \ \ \textcolor{keywordtype}{bool}\ ctrl\_held\ =\ (\textcolor{keyword}{event}-\/>state\ \&\ GDK\_CONTROL\_MASK)\ !=\ 0;}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ \textcolor{keywordtype}{double}\ dx,\ dy;}
\DoxyCodeLine{00888\ \ \ \textcolor{keywordflow}{if}\ (event-\/>direction\ ==\ GDK\_SCROLL\_UP)\ \{}
\DoxyCodeLine{00889\ \ \ \ \ dx\ =\ 0;}
\DoxyCodeLine{00890\ \ \ \ \ dy\ =\ 1;}
\DoxyCodeLine{00891\ \ \ \}}
\DoxyCodeLine{00892\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (event-\/>direction\ ==\ GDK\_SCROLL\_DOWN)\ \{}
\DoxyCodeLine{00893\ \ \ \ \ dx\ =\ 0;}
\DoxyCodeLine{00894\ \ \ \ \ dy\ =\ -\/1;}
\DoxyCodeLine{00895\ \ \ \}}
\DoxyCodeLine{00896\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (event-\/>direction\ ==\ GDK\_SCROLL\_LEFT)\ \{}
\DoxyCodeLine{00897\ \ \ \ \ dx\ =\ 1;}
\DoxyCodeLine{00898\ \ \ \ \ dy\ =\ 0;}
\DoxyCodeLine{00899\ \ \ \}}
\DoxyCodeLine{00900\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (event-\/>direction\ ==\ GDK\_SCROLL\_RIGHT)\ \{}
\DoxyCodeLine{00901\ \ \ \ \ dx\ =\ -\/1;}
\DoxyCodeLine{00902\ \ \ \ \ dy\ =\ 0;}
\DoxyCodeLine{00903\ \ \ \}}
\DoxyCodeLine{00904\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!gdk\_event\_get\_scroll\_deltas((GdkEvent\ *)event,\ \&dx,\ \&dy))\ \{}
\DoxyCodeLine{00905\ \ \ \ \ \textcolor{keywordflow}{return}\ FALSE;}
\DoxyCodeLine{00906\ \ \ \}}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \ \ \textcolor{keywordtype}{int}\ graph\_x\ =\ (int)(event-\/>x\ *\ self-\/>\_cr\_scale);}
\DoxyCodeLine{00909\ \ \ \textcolor{keywordtype}{int}\ graph\_y\ =\ (int)(event-\/>y\ *\ self-\/>\_cr\_scale);}
\DoxyCodeLine{00910\ \ \ \textcolor{keywordflow}{return}\ self-\/>handle\_scroll(graph\_x,\ graph\_y,\ dx,\ dy,\ ctrl\_held);}
\DoxyCodeLine{00911\ \}}
\DoxyCodeLine{00912\ }
\DoxyCodeLine{00916\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00917\ key\_press\_callback(GtkWidget\ *widget,\ GdkEventKey\ *event,\ gpointer\ data)\ \{}
\DoxyCodeLine{00918\ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00919\ \ \ \textcolor{keywordflow}{return}\ self-\/>handle\_key(\textcolor{keyword}{true},\ event-\/>keyval,\ event-\/>hardware\_keycode);}
\DoxyCodeLine{00920\ \}}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00925\ gboolean\ GtkStatsTimeline::}
\DoxyCodeLine{00926\ key\_release\_callback(GtkWidget\ *widget,\ GdkEventKey\ *event,\ gpointer\ data)\ \{}
\DoxyCodeLine{00927\ \ \ \mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classGtkStatsTimeline}{GtkStatsTimeline}}\ *)data;}
\DoxyCodeLine{00928\ \ \ \textcolor{keywordflow}{return}\ self-\/>handle\_key(\textcolor{keyword}{false},\ event-\/>keyval,\ event-\/>hardware\_keycode);}
\DoxyCodeLine{00929\ \}}

\end{DoxyCode}
