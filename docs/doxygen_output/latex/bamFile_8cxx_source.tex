\doxysection{bam\+File.\+cxx}
\hypertarget{bamFile_8cxx_source}{}\label{bamFile_8cxx_source}\index{panda/src/pgraph/bamFile.cxx@{panda/src/pgraph/bamFile.cxx}}
\mbox{\hyperlink{bamFile_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamFile_8h}{bamFile.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bam_8h}{bam.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamCacheRecord_8h}{bamCacheRecord.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__putil_8h}{config\_putil.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{filename_8h}{filename.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__express_8h}{config\_express.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ BamFile::}
\DoxyCodeLine{00033\ BamFile()\ \{}
\DoxyCodeLine{00034\ \ \ \_reader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00035\ \ \ \_writer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00041\ BamFile::}
\DoxyCodeLine{00042\ \string~BamFile()\ \{}
\DoxyCodeLine{00043\ \ \ close();}
\DoxyCodeLine{00044\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00050\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00051\ open\_read(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00052\ \ \ close();}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keywordflow}{if}\ (!\_din.open(bam\_filename))\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00056\ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{return}\ continue\_open\_read(bam\_filename,\ report\_errors);}
\DoxyCodeLine{00059\ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00065\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00066\ open\_read(std::istream\ \&in,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00067\ \ \ close();}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{if}\ (!\_din.open(in))\ \{}
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{return}\ continue\_open\_read(bam\_filename,\ report\_errors);}
\DoxyCodeLine{00074\ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00084\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *BamFile::}
\DoxyCodeLine{00085\ read\_object()\ \{}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00088\ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>\mbox{\hyperlink{classBamReader_aa2745e61d4d3750aae692e72bc02fa3f}{read\_object}}();}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00097\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00098\ is\_eof()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{return}\ \_reader\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ \_reader-\/>is\_eof();}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00109\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00110\ resolve()\ \{}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00113\ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>\mbox{\hyperlink{classBamReader_a79364fc8c51fdf559ea8c8c8aea0fb41}{resolve}}();}
\DoxyCodeLine{00116\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00133\ PT(\mbox{\hyperlink{classPandaNode}{PandaNode}})\ BamFile::}
\DoxyCodeLine{00134\ read\_node(\textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00135\ \ \ PT(\mbox{\hyperlink{classPandaNode}{PandaNode}})\ result;}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\textcolor{keywordtype}{object}\ =\ read\_object();}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{00140\ \ \ \ \ \ \ object-\/>is\_exact\_type(BamCacheRecord::get\_class\_type()))\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ special\ case:\ if\ the\ first\ object\ in\ the\ file\ is\ a}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ BamCacheRecord,\ it's\ really\ a\ cache\ data\ file\ and\ not\ a\ true\ bam\ file;}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ but\ skip\ over\ the\ cache\ data\ record\ and\ let\ the\ user\ treat\ it\ like\ an}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//\ ordinary\ bam\ file.}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordtype}{object}\ =\ read\_object();}
\DoxyCodeLine{00146\ \ \ \}}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{if}\ (\textcolor{keywordtype}{object}\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00150\ \ \ \ \ \ \ loader\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Bam\ file\ "{}}\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\ is\ empty.\(\backslash\)n"{}};}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!object-\/>is\_of\_type(PandaNode::get\_class\_type()))\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ loader\_cat.error()}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Bam\ file\ "{}}\ <<\ \_bam\_filename}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ contains\ a\ "{}}\ <<\ \textcolor{keywordtype}{object}-\/>get\_type()\ <<\ \textcolor{stringliteral}{"{},\ not\ a\ PandaNode.\(\backslash\)n"{}};}
\DoxyCodeLine{00158\ \ \ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00161\ \ \ \ \ result\ =\ DCAST(\mbox{\hyperlink{classPandaNode}{PandaNode}},\ \textcolor{keywordtype}{object});}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ read\_object();}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!is\_eof())\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ loader\_cat.warning()}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Ignoring\ extra\ objects\ in\ "{}}\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (!resolve())\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ loader\_cat.error()}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ resolve\ Bam\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \ \ result\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00178\ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00189\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00190\ open\_write(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00191\ \ \ close();}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00194\ \ \ vfs-\/>delete\_file(bam\_filename);}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordflow}{if}\ (!\_dout.open(bam\_filename))\ \{}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ loader\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ "{}}\ <<\ bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00200\ \ \ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{return}\ continue\_open\_write(bam\_filename,\ report\_errors);}
\DoxyCodeLine{00203\ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00209\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00210\ open\_write(std::ostream\ \&out,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00211\ \ \ close();}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{if}\ (!\_dout.open(out))\ \{}
\DoxyCodeLine{00214\ \ \ \ \ loader\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Could\ not\ write\ bam:\ "{}}\ <<\ bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00216\ \ \ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{return}\ continue\_open\_write(bam\_filename,\ report\_errors);}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00225\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00226\ write\_object(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\textcolor{keywordtype}{object})\ \{}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{if}\ (\_writer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00229\ \ \ \}}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{if}\ (!\_writer-\/>write\_object(\textcolor{keywordtype}{object}))\ \{}
\DoxyCodeLine{00232\ \ \ \ \ close();}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00234\ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00237\ \}}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00242\ \textcolor{keywordtype}{void}\ BamFile::}
\DoxyCodeLine{00243\ close()\ \{}
\DoxyCodeLine{00244\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00245\ \ \ \ \ \textcolor{comment}{//\ resolve();}}
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{keyword}{delete}\ \_reader;}
\DoxyCodeLine{00247\ \ \ \ \ \_reader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00248\ \ \ \}}
\DoxyCodeLine{00249\ \ \ \textcolor{keywordflow}{if}\ (\_writer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keyword}{delete}\ \_writer;}
\DoxyCodeLine{00251\ \ \ \ \ \_writer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00252\ \ \ \}}
\DoxyCodeLine{00253\ \ \ \_din.close();}
\DoxyCodeLine{00254\ \ \ \_dout.close();}
\DoxyCodeLine{00255\ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00263\ \textcolor{keywordtype}{int}\ BamFile::}
\DoxyCodeLine{00264\ get\_file\_major\_ver()\ \{}
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{return}\ \_bam\_major\_ver;}
\DoxyCodeLine{00267\ \ \ \}}
\DoxyCodeLine{00268\ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>get\_file\_major\_ver();}
\DoxyCodeLine{00269\ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00276\ \textcolor{keywordtype}{int}\ BamFile::}
\DoxyCodeLine{00277\ get\_file\_minor\_ver()\ \{}
\DoxyCodeLine{00278\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keywordflow}{return}\ \_bam\_minor\_ver;}
\DoxyCodeLine{00280\ \ \ \}}
\DoxyCodeLine{00281\ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>get\_file\_minor\_ver();}
\DoxyCodeLine{00282\ \}}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00288\ BamFile::BamEndian\ BamFile::}
\DoxyCodeLine{00289\ get\_file\_endian()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00290\ \ \ \textcolor{keywordflow}{if}\ (\_writer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{keywordflow}{return}\ \_writer-\/>get\_file\_endian();}
\DoxyCodeLine{00292\ \ \ \}}
\DoxyCodeLine{00293\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>get\_file\_endian();}
\DoxyCodeLine{00295\ \ \ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{return}\ bam\_endian;}
\DoxyCodeLine{00298\ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00304\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00305\ get\_file\_stdfloat\_double()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00306\ \ \ \textcolor{keywordflow}{if}\ (\_writer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \textcolor{keywordflow}{return}\ \_writer-\/>get\_file\_stdfloat\_double();}
\DoxyCodeLine{00308\ \ \ \}}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordflow}{if}\ (\_reader\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{keywordflow}{return}\ \_reader-\/>get\_file\_stdfloat\_double();}
\DoxyCodeLine{00311\ \ \ \}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{return}\ bam\_stdfloat\_double;}
\DoxyCodeLine{00314\ \}}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00320\ \textcolor{keywordtype}{int}\ BamFile::}
\DoxyCodeLine{00321\ get\_current\_major\_ver()\ \{}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordflow}{return}\ \_bam\_major\_ver;}
\DoxyCodeLine{00323\ \}}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00329\ \textcolor{keywordtype}{int}\ BamFile::}
\DoxyCodeLine{00330\ get\_current\_minor\_ver()\ \{}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordflow}{return}\ \_bam\_minor\_ver;}
\DoxyCodeLine{00332\ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00338\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *BamFile::}
\DoxyCodeLine{00339\ get\_reader()\ \{}
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{return}\ \_reader;}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00347\ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ *BamFile::}
\DoxyCodeLine{00348\ get\_writer()\ \{}
\DoxyCodeLine{00349\ \ \ \textcolor{keywordflow}{return}\ \_writer;}
\DoxyCodeLine{00350\ \}}
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00356\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00357\ continue\_open\_read(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00358\ \ \ \_bam\_filename\ =\ bam\_filename;}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (!\_bam\_filename.empty())\ \{}
\DoxyCodeLine{00361\ \ \ \ \ loader\_cat.info()}
\DoxyCodeLine{00362\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ "{}}\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \textcolor{keywordtype}{string}\ head;}
\DoxyCodeLine{00366\ \ \ \textcolor{keywordflow}{if}\ (!\_din.read\_header(head,\ \_bam\_header.size()))\ \{}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00368\ \ \ \ \ \ \ loader\_cat.error()\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ valid\ BAM\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00369\ \ \ \ \ \}}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00371\ \ \ \}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \textcolor{keywordflow}{if}\ (head\ !=\ \_bam\_header)\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00375\ \ \ \ \ \ \ loader\_cat.error()\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\ is\ not\ a\ valid\ BAM\ file.\(\backslash\)n"{}};}
\DoxyCodeLine{00376\ \ \ \ \ \}}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00378\ \ \ \}}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \_reader\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBamReader}{BamReader}}(\&\_din);}
\DoxyCodeLine{00381\ \ \ \textcolor{keywordflow}{if}\ (!\_reader-\/>\mbox{\hyperlink{classBamReader_a93a91392b652d4096988fd6c093ee128}{init}}())\ \{}
\DoxyCodeLine{00382\ \ \ \ \ close();}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00384\ \ \ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00393\ \textcolor{keywordtype}{bool}\ BamFile::}
\DoxyCodeLine{00394\ continue\_open\_write(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&bam\_filename,\ \textcolor{keywordtype}{bool}\ report\_errors)\ \{}
\DoxyCodeLine{00395\ \ \ \_bam\_filename\ =\ bam\_filename;}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00397\ \ \ \textcolor{keywordflow}{if}\ (!\_bam\_filename.empty())\ \{}
\DoxyCodeLine{00398\ \ \ \ \ loader\_cat.info()\ <<\ \textcolor{stringliteral}{"{}Writing\ "{}}\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00399\ \ \ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{if}\ (!\_dout.write\_header(\_bam\_header))\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{keywordflow}{if}\ (report\_errors)\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \ \ loader\_cat.error()\ <<\ \textcolor{stringliteral}{"{}Unable\ to\ write\ to\ "{}}\ <<\ \_bam\_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00404\ \ \ \ \ \}}
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00406\ \ \ \}}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \_writer\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBamWriter}{BamWriter}}(\&\_dout);}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \textcolor{keywordflow}{if}\ (!\_writer-\/>init())\ \{}
\DoxyCodeLine{00411\ \ \ \ \ close();}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00413\ \ \ \}}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00416\ \}}

\end{DoxyCode}
