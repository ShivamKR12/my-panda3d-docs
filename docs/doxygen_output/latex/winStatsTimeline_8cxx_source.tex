\doxysection{win\+Stats\+Timeline.\+cxx}
\hypertarget{winStatsTimeline_8cxx_source}{}\label{winStatsTimeline_8cxx_source}\index{pandatool/src/win-\/stats/winStatsTimeline.cxx@{pandatool/src/win-\/stats/winStatsTimeline.cxx}}
\mbox{\hyperlink{winStatsTimeline_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsTimeline_8h}{winStatsTimeline.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{winStatsMonitor_8h}{winStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{numeric__types_8h}{numeric\_types.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_width\ =\ 1000;}
\DoxyCodeLine{00019\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_height\ =\ 500;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keywordtype}{bool}\ WinStatsTimeline::\_window\_class\_registered\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00022\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ WinStatsTimeline::\_window\_class\_name\ =\ \textcolor{stringliteral}{"{}timeline"{}};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ WinStatsTimeline::}
\DoxyCodeLine{00028\ WinStatsTimeline(\mbox{\hyperlink{classWinStatsMonitor}{WinStatsMonitor}}\ *monitor)\ :}
\DoxyCodeLine{00029\ \ \ \mbox{\hyperlink{classPStatTimeline}{PStatTimeline}}(monitor,}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ monitor-\/>get\_pixel\_scale()\ *\ default\_timeline\_width\ /\ 4,}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ monitor-\/>get\_pixel\_scale()\ *\ default\_timeline\_height\ /\ 4),}
\DoxyCodeLine{00032\ \ \ \mbox{\hyperlink{classWinStatsGraph}{WinStatsGraph}}(monitor)}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ \_left\_margin\ =\ \_pixel\_scale\ *\ 24;}
\DoxyCodeLine{00035\ \ \ \_right\_margin\ =\ \_pixel\_scale\ *\ 2;}
\DoxyCodeLine{00036\ \ \ \_top\_margin\ =\ \_pixel\_scale\ *\ 5;}
\DoxyCodeLine{00037\ \ \ \_bottom\_margin\ =\ \_pixel\_scale\ *\ 2;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ normal\_guide\_bars();}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ create\_window();}
\DoxyCodeLine{00042\ \ \ clear\_region();}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \_grid\_brush\ =\ CreateSolidBrush(RGB(0xdd,\ 0xdd,\ 0xdd));}
\DoxyCodeLine{00045\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ WinStatsTimeline::}
\DoxyCodeLine{00051\ \string~WinStatsTimeline()\ \{}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00060\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a91760da377825feb50167caceeec4a88}{WinStatsTimeline::}}}
\DoxyCodeLine{00061\ \mbox{\hyperlink{classWinStatsTimeline_a91760da377825feb50167caceeec4a88}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{classPStatTimeline_aebb2abcbcf418ce72ce39cb920abfd20}{PStatTimeline::new\_data}}(thread\_index,\ frame\_number);}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a389ec7fce235a709c886ef1896c960a3}{WinStatsTimeline::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classWinStatsTimeline_a389ec7fce235a709c886ef1896c960a3}{force\_redraw}}()\ \{}
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}();}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00076\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a6ebc500eae08b555223e30d65a9d0d6f}{WinStatsTimeline::}}}
\DoxyCodeLine{00077\ \mbox{\hyperlink{classWinStatsTimeline_a6ebc500eae08b555223e30d65a9d0d6f}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classPStatTimeline_a83ea1b01bb9cc013b99cc5c775516869}{PStatTimeline::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00079\ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00084\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a3ce0d1743e7579985bcbd3cac5dcebe8}{WinStatsTimeline::}}}
\DoxyCodeLine{00085\ \mbox{\hyperlink{classWinStatsTimeline_a3ce0d1743e7579985bcbd3cac5dcebe8}{clear\_region}}()\ \{}
\DoxyCodeLine{00086\ \ \ RECT\ rect\ =\ \{\ 0,\ 0,\ get\_xsize(),\ get\_ysize()\ \};}
\DoxyCodeLine{00087\ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ (HBRUSH)GetStockObject(WHITE\_BRUSH));}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_ac364a9340cd4f8dd8f4ba72c9c9e9bcf}{WinStatsTimeline::}}}
\DoxyCodeLine{00094\ \mbox{\hyperlink{classWinStatsTimeline_ac364a9340cd4f8dd8f4ba72c9c9e9bcf}{begin\_draw}}()\ \{}
\DoxyCodeLine{00095\ \ \ SelectObject(\_bitmap\_dc,\ WinStatsGraph::\_monitor-\/>get\_font());}
\DoxyCodeLine{00096\ \ \ SelectObject(\_bitmap\_dc,\ GetStockObject(NULL\_PEN));}
\DoxyCodeLine{00097\ \ \ SetBkMode(\_bitmap\_dc,\ TRANSPARENT);}
\DoxyCodeLine{00098\ \ \ SetTextAlign(\_bitmap\_dc,\ TA\_LEFT\ |\ TA\_TOP\ |\ TA\_NOUPDATECP);}
\DoxyCodeLine{00099\ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00104\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a26e07e98fdc8cf7e2ffcaaf3d195f803}{WinStatsTimeline::}}}
\DoxyCodeLine{00105\ \mbox{\hyperlink{classWinStatsTimeline_a26e07e98fdc8cf7e2ffcaaf3d195f803}{draw\_separator}}(\textcolor{keywordtype}{int}\ row)\ \{}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{int}\ y\ =\ (row\_to\_pixel(row)\ +\ row\_to\_pixel(row\ +\ 1))\ /\ 2;}
\DoxyCodeLine{00107\ \ \ RECT\ rect\ =\ \{0,\ y,\ get\_xsize(),\ y\ +\ \_pixel\_scale\ /\ 3\};}
\DoxyCodeLine{00108\ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ \_grid\_brush);}
\DoxyCodeLine{00109\ \}}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00114\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a4238510438baa9e98fe017d1c17bbfb8}{WinStatsTimeline::}}}
\DoxyCodeLine{00115\ \mbox{\hyperlink{classWinStatsTimeline_a4238510438baa9e98fe017d1c17bbfb8}{draw\_guide\_bar}}(\textcolor{keywordtype}{int}\ x,\ GuideBarStyle\ style)\ \{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordtype}{int}\ x1\ =\ x\ -\/\ \_pixel\_scale\ /\ 6;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{int}\ x2\ =\ x1\ +\ \_pixel\_scale\ /\ 3;}
\DoxyCodeLine{00118\ \ \ \textcolor{keywordflow}{if}\ (style\ ==\ GBS\_frame)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ ++x2;}
\DoxyCodeLine{00120\ \ \ \}}
\DoxyCodeLine{00121\ \ \ RECT\ rect\ =\ \{x1,\ 0,\ x2,\ get\_ysize()\};}
\DoxyCodeLine{00122\ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ \_grid\_brush);}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00129\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a207508a41055d298e545c7a6459ab1a9}{WinStatsTimeline::}}}
\DoxyCodeLine{00130\ \mbox{\hyperlink{classWinStatsTimeline_a207508a41055d298e545c7a6459ab1a9}{draw\_bar}}(\textcolor{keywordtype}{int}\ row,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x,\ \textcolor{keywordtype}{int}\ collector\_index,}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&collector\_name)\ \{}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordtype}{int}\ top\ =\ row\_to\_pixel(row);}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ row\_to\_pixel(row\ +\ 1);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ row\ ==\ \_highlighted\_row\ \&\&\ \_highlighted\_x\ >=\ from\_x\ \&\&\ \_highlighted\_x\ <\ to\_x;}
\DoxyCodeLine{00137\ \ \ HBRUSH\ brush\ =\ \mbox{\hyperlink{classWinStatsGraph_a6c23dc88d8af5cc9e790ff31a8f74f09}{get\_collector\_brush}}(collector\_index,\ is\_highlighted);}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ 2)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \textcolor{comment}{//\ It's\ just\ a\ tiny\ sliver.\ \ This\ is\ a\ more\ reliable\ way\ to\ draw\ it.}}
\DoxyCodeLine{00141\ \ \ \ \ RECT\ rect\ =\ \{from\_x,\ top\ +\ 1,\ from\_x\ +\ 1,\ bottom\ -\/\ 1\};}
\DoxyCodeLine{00142\ \ \ \ \ FillRect(\_bitmap\_dc,\ \&rect,\ brush);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{comment}{//if\ (to\_x\ <=\ from\_x\ +\ 2)\ \{}}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{comment}{//\ \ //\ Draw\ an\ arrow\ pointing\ to\ it,\ if\ it's\ so\ small.}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{comment}{//\ \ POINT\ vertices[]\ =\ \{\{to\_x,\ bottom\},\ \{to\_x\ -\/\ \_pixel\_scale,\ bottom\ +\ \_pixel\_scale\ *\ 2\},\ \{to\_x\ +\ \_pixel\_scale,\ bottom\ +\ \_pixel\_scale\ *\ 2\}\};}}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{comment}{//\ \ Polygon(\_bitmap\_dc,\ vertices,\ 3);}}
\DoxyCodeLine{00148\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00149\ \ \ \}}
\DoxyCodeLine{00150\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00151\ \ \ \ \ SelectObject(\_bitmap\_dc,\ brush);}
\DoxyCodeLine{00152\ \ \ \ \ RoundRect(\_bitmap\_dc,}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::max(from\_x,\ -\/\_pixel\_scale\ -\/\ 1),}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ top,}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::min(std::max(to\_x,\ from\_x\ +\ 1),\ get\_xsize()\ +\ \_pixel\_scale),}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bottom,}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_pixel\_scale,}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_pixel\_scale);}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keywordflow}{if}\ ((to\_x\ -\/\ from\_x)\ >=\ \_pixel\_scale\ *\ 4)\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ bother\ drawing\ the\ text\ if\ we've\ got\ some\ space\ to\ draw\ on.}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \textcolor{comment}{//\ Choose\ a\ suitable\ foreground\ color.}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ SetTextColor(\_bitmap\_dc,\ \mbox{\hyperlink{classWinStatsGraph_a63439518bdc72a5d963e0eb8f7449b5c}{get\_collector\_text\_color}}(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ the\ text\ doesn't\ run\ off\ the\ chart.}}
\DoxyCodeLine{00166\ \ \ \ \ \ \ SIZE\ size;}
\DoxyCodeLine{00167\ \ \ \ \ \ \ GetTextExtentPoint32(\_bitmap\_dc,\ collector\_name.data(),\ collector\_name.size(),\ \&size);}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ center\ =\ (from\_x\ +\ to\_x)\ /\ 2;}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ left\ =\ std::max(from\_x,\ 0)\ +\ \_pixel\_scale\ /\ 2;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ right\ =\ std::min(to\_x,\ get\_xsize())\ -\/\ \_pixel\_scale\ /\ 2;}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (size.cx\ >=\ right\ -\/\ left)\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (right\ -\/\ left\ <\ \_pixel\_scale\ *\ 6)\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ a\ really\ tiny\ space.\ \ Draw\ a\ single\ letter.}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ RECT\ rect\ =\ \{left,\ top,\ right,\ bottom\};}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \ \ DrawText(\_bitmap\_dc,\ collector\_name.data(),\ 1,}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&rect,\ DT\_CENTER\ |\ DT\_SINGLELINE\ |\ DT\_VCENTER);}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ going\ to\ be\ tricky\ to\ fit\ it,\ let\ Windows\ figure\ it\ out\ via}}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ more\ expensive\ DrawText\ call.}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ RECT\ rect\ =\ \{left,\ top,\ right,\ bottom\};}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ DrawText(\_bitmap\_dc,\ collector\_name.data(),\ collector\_name.size(),}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&rect,\ DT\_CENTER\ |\ DT\_END\_ELLIPSIS\ |\ DT\_SINGLELINE\ |\ DT\_VCENTER);}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ text\_top\ =\ top\ +\ (bottom\ -\/\ top\ -\/\ size.cy)\ /\ 2;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (center\ -\/\ size.cx\ /\ 2\ <\ 0)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ left-\/most\ edge.}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ TextOut(\_bitmap\_dc,\ \_pixel\_scale,\ text\_top,}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ collector\_name.data(),\ collector\_name.length());}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (center\ +\ size.cx\ /\ 2\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ right-\/most\ edge.}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ TextOut(\_bitmap\_dc,\ get\_xsize()\ -\/\ \_pixel\_scale\ -\/\ size.cx,\ text\_top,}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ collector\_name.data(),\ collector\_name.length());}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ fits\ just\ fine,\ center\ it.}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ TextOut(\_bitmap\_dc,\ center\ -\/\ size.cx\ /\ 2,\ text\_top,}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ collector\_name.data(),\ collector\_name.length());}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \}}
\DoxyCodeLine{00205\ \ \ \}}
\DoxyCodeLine{00206\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00212\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_aca516f70392948238ebe4ec2cfe05547}{WinStatsTimeline::}}}
\DoxyCodeLine{00213\ \mbox{\hyperlink{classWinStatsTimeline_aca516f70392948238ebe4ec2cfe05547}{end\_draw}}()\ \{}
\DoxyCodeLine{00214\ \ \ InvalidateRect(\_graph\_window,\ \textcolor{keyword}{nullptr},\ FALSE);}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \textcolor{keywordflow}{if}\ (\_threads\_changed)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ RECT\ rect;}
\DoxyCodeLine{00218\ \ \ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00219\ \ \ \ \ rect.top\ =\ \_top\_margin;}
\DoxyCodeLine{00220\ \ \ \ \ rect.right\ =\ \_left\_margin;}
\DoxyCodeLine{00221\ \ \ \ \ InvalidateRect(\_window,\ \&rect,\ TRUE);}
\DoxyCodeLine{00222\ \ \ \ \ \_threads\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00223\ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordflow}{if}\ (\_guide\_bars\_changed)\ \{}
\DoxyCodeLine{00226\ \ \ \ \ RECT\ rect;}
\DoxyCodeLine{00227\ \ \ \ \ GetClientRect(\_window,\ \&rect);}
\DoxyCodeLine{00228\ \ \ \ \ rect.bottom\ =\ \_top\_margin;}
\DoxyCodeLine{00229\ \ \ \ \ InvalidateRect(\_window,\ \&rect,\ TRUE);}
\DoxyCodeLine{00230\ \ \ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00231\ \ \ \}}
\DoxyCodeLine{00232\ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00237\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a6d79911cc359a953f18abdbb1375bd45}{WinStatsTimeline::}}}
\DoxyCodeLine{00238\ \mbox{\hyperlink{classWinStatsTimeline_a6d79911cc359a953f18abdbb1375bd45}{idle}}()\ \{}
\DoxyCodeLine{00239\ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00245\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsTimeline_a5e82b01bdb1c4431a7f7602b64376e84}{WinStatsTimeline::}}}
\DoxyCodeLine{00246\ \mbox{\hyperlink{classWinStatsTimeline_a5e82b01bdb1c4431a7f7602b64376e84}{animate}}(\textcolor{keywordtype}{double}\ time,\ \textcolor{keywordtype}{double}\ dt)\ \{}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_a4bb82d0d67715053beebb23a8dc8589d}{PStatTimeline::animate}}(time,\ dt);}
\DoxyCodeLine{00248\ \}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00253\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classWinStatsTimeline_a22f43aeb7b3e2e3f7d44a5d8d0a1e94e}{WinStatsTimeline::}}}
\DoxyCodeLine{00254\ \mbox{\hyperlink{classWinStatsTimeline_a22f43aeb7b3e2e3f7d44a5d8d0a1e94e}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{classWinStatsGraph_a09816c5e652ee201e9e4d82b442fffdf}{WinStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00258\ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00263\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_aa41a21e81363d627e9aaed88a6b59e85}{WinStatsTimeline::}}}
\DoxyCodeLine{00264\ \mbox{\hyperlink{classWinStatsTimeline_aa41a21e81363d627e9aaed88a6b59e85}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00266\ \ \ \mbox{\hyperlink{classWinStatsGraph_ac5e136b133729a00045771eb9a1085fe}{WinStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00267\ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00272\ LONG\ WinStatsTimeline::}
\DoxyCodeLine{00273\ window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00274\ \ \ \textcolor{keywordflow}{switch}\ (msg)\ \{}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSELEAVE:}
\DoxyCodeLine{00276\ \ \ \ \ SetFocus(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00277\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00281\ \ \ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classWinStatsGraph_a9c3aa3051d400418232bea75f31872b5}{WinStatsGraph::window\_proc}}(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00284\ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00289\ LONG\ WinStatsTimeline::}
\DoxyCodeLine{00290\ graph\_window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordflow}{switch}\ (msg)\ \{}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONDOWN:}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_pan);}
\DoxyCodeLine{00295\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \_drag\_start\_x\ =\ x;}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \_scroll\_speed\ =\ 0.0;}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(x);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ SetCapture(\_graph\_window);}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00301\ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSEMOVE:}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ we\ can\ accept\ keyboard\ events,\ except\ if\ we're\ inactive.}}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordflow}{if}\ (GetActiveWindow()\ ==\ \_window)\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \ \ SetFocus(hwnd);}
\DoxyCodeLine{00308\ \ \ \ \ \}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y\ =\ HIWORD(lparam);}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ time\ =\ pixel\_to\_timestamp(x);}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(y);}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ !=\ \_highlighted\_row)\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ >=\ 0)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Is\ the\ mouse\ on\ the\ same\ bar?\ \ If\ not,\ clear\ the\ tooltip.}}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ ColorBar\ bar;}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatTimeline_a88c95e4a4620491da72dd2cf551b04b3}{find\_bar}}(row,\ x,\ bar))\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ prev\_time\ =\ pixel\_to\_timestamp(\_highlighted\_x);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (prev\_time\ <\ bar.\_start\ ||\ prev\_time\ >\ bar.\_end)\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \ \ std::swap(\_highlighted\_x,\ x);}
\DoxyCodeLine{00335\ \ \ \ \ \ \ std::swap(\_highlighted\_row,\ row);}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ >=\ 0)\ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ x,\ x);}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(\_highlighted\_row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_keys\_held\ \&\ (F\_w\ |\ F\_s))\ !=\ 0)\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ zoom\ center\ if\ we\ move\ the\ mouse\ while\ zooming\ with\ the}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keyboard.}}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \_zoom\_center\ =\ time;}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ we\ want\ to\ get\ a\ WM\_MOUSELEAVE\ when\ the\ mouse\ leaves\ the\ graph}}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \textcolor{comment}{//\ window.}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ TRACKMOUSEEVENT\ tme\ =\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \textcolor{keyword}{sizeof}(TRACKMOUSEEVENT),}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ TME\_LEAVE,}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \_graph\_window,}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ 0}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00356\ \ \ \ \ \ \ TrackMouseEvent(\&tme);}
\DoxyCodeLine{00357\ \ \ \ \ \}}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ mouse\ is\ in\ some\ drag\ mode,\ stop\ highlighting.}}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_pan)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ \_drag\_start\_x\ -\/\ x;}
\DoxyCodeLine{00371\ \ \ \ \ \ \ set\_horizontal\_scroll(get\_horizontal\_scroll()\ +\ pixel\_to\_height(delta));}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \_drag\_start\_x\ =\ x;}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00374\ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSELEAVE:}
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ leaves\ the\ graph,\ stop\ highlighting.}}
\DoxyCodeLine{00379\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_acc7a6d69229485cc5e6b1a0aaae66ab4}{clear\_graph\_tooltip}}();}
\DoxyCodeLine{00384\ \ \ \ \ \}}
\DoxyCodeLine{00385\ \ \ \ \ SetFocus(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00386\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONUP:}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_pan)\ \{}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_abfaa9f4c7cc277cf347ada58c7db2183}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00391\ \ \ \ \ \ \ ReleaseCapture();}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00393\ \ \ \ \ \}}
\DoxyCodeLine{00394\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00396\ \ \ \textcolor{keywordflow}{case}\ WM\_LBUTTONDBLCLK:}
\DoxyCodeLine{00397\ \ \ \ \ \{}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ will\ zoom\ the\ graph\ into}}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ collector.}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ int16\_t\ x\ =\ LOWORD(lparam);}
\DoxyCodeLine{00401\ \ \ \ \ \ \ int16\_t\ y\ =\ HIWORD(lparam);}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(y);}
\DoxyCodeLine{00403\ \ \ \ \ \ \ ColorBar\ bar;}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatTimeline_a88c95e4a4620491da72dd2cf551b04b3}{find\_bar}}(row,\ x,\ bar))\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ width\ =\ bar.\_end\ -\/\ bar.\_start;}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ zoom\_to(width\ *\ 1.5,\ pixel\_to\_timestamp(x));}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ scroll\_to(bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ the\ white\ area\ zooms\ out.}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \_zoom\_speed\ -\/=\ 100.0;}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00414\ \ \ \ \ \}}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{case}\ WM\_CONTEXTMENU:}
\DoxyCodeLine{00418\ \ \ \ \ \{}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \textcolor{comment}{//\ Right-\/clicking\ a\ color\ bar\ brings\ up\ a\ context\ menu.}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ POINT\ point;}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetCursorPos(\&point))\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ POINT\ graph\_point\ =\ \ point;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ScreenToClient(\_graph\_window,\ \&graph\_point))\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_point.y);}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ ColorBar\ bar;}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatTimeline_a88c95e4a4620491da72dd2cf551b04b3}{find\_bar}}(row,\ graph\_point.x,\ bar))\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \_popup\_bar\ =\ bar;}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ HMENU\ popup\ =\ CreatePopupMenu();}
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ std::string\ label\ =\ \mbox{\hyperlink{classPStatTimeline_ab138ad122f3c31ffbe334a65458baf20}{get\_bar\_tooltip}}(row,\ graph\_point.x);}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING\ |\ MF\_DISABLED,\ 0,\ label.c\_str());}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 101,\ \textcolor{stringliteral}{"{}Zoom\ To"{}});}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 102,\ \textcolor{stringliteral}{"{}Open\ Strip\ Chart"{}});}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 103,\ \textcolor{stringliteral}{"{}Open\ Flame\ Graph"{}});}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 104,\ \textcolor{stringliteral}{"{}Open\ Piano\ Roll"{}});}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING\ |\ MF\_SEPARATOR,\ 0,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 105,\ \textcolor{stringliteral}{"{}Change\ Color..."{}});}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ AppendMenu(popup,\ MF\_STRING,\ 106,\ \textcolor{stringliteral}{"{}Reset\ Color"{}});}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ TrackPopupMenu(popup,\ TPM\_LEFTBUTTON,\ point.x,\ point.y,\ 0,\ \_graph\_window,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00447\ \ \ \ \ \}}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \textcolor{keywordflow}{case}\ WM\_COMMAND:}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{switch}\ (LOWORD(wparam))\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \textcolor{keywordflow}{case}\ 101:}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ width\ =\ \_popup\_bar.\_end\ -\/\ \_popup\_bar.\_start;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ zoom\_to(width\ *\ 1.5,\ (\_popup\_bar.\_end\ +\ \_popup\_bar.\_start)\ /\ 2.0);}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ scroll\_to(\_popup\_bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00460\ }
\DoxyCodeLine{00461\ \ \ \ \ \textcolor{keywordflow}{case}\ 102:}
\DoxyCodeLine{00462\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a2310299c3cc181f2d4f75210c6406747}{open\_strip\_chart}}(\_popup\_bar.\_thread\_index,\ \_popup\_bar.\_collector\_index,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{case}\ 103:}
\DoxyCodeLine{00466\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a19a5f72039f430ce2b33a559c183f5b0}{open\_flame\_graph}}(\_popup\_bar.\_thread\_index,\ \_popup\_bar.\_collector\_index,\ \_popup\_bar.\_frame\_number);}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{case}\ 104:}
\DoxyCodeLine{00470\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a92573dca4aeb9832588518f0193cd143}{open\_piano\_roll}}(\_popup\_bar.\_thread\_index);}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ \ \ \ \ \textcolor{keywordflow}{case}\ 105:}
\DoxyCodeLine{00474\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_aa0bc0a0c7e4117e72da204b54debe60f}{choose\_collector\_color}}(\_popup\_bar.\_collector\_index);}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keywordflow}{case}\ 106:}
\DoxyCodeLine{00478\ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a7d1d9acd32503d2aebd77c86c5ad42b5}{reset\_collector\_color}}(\_popup\_bar.\_collector\_index);}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00480\ \ \ \ \ \}}
\DoxyCodeLine{00481\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00482\ }
\DoxyCodeLine{00483\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSEWHEEL:}
\DoxyCodeLine{00484\ \ \ \ \ \{}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GET\_KEYSTATE\_WPARAM(wparam)\ \&\ MK\_CONTROL)\ \{}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Zoom\ in/out\ around\ the\ cursor\ position.}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ POINT\ point;}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetCursorPos(\&point)\ \&\&\ ScreenToClient(\_graph\_window,\ \&point))\ \{}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ GET\_WHEEL\_DELTA\_WPARAM(wparam);}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ zoom\_by(delta\ /\ 120.0,\ pixel\_to\_timestamp(point.x));}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ GET\_WHEEL\_DELTA\_WPARAM(wparam);}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ delta\ =\ (delta\ *\ \_pixel\_scale\ *\ 5)\ /\ 120;}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ new\_scroll\ =\ \_scroll\ -\/\ delta;}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_threads.empty())\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ new\_scroll\ =\ 0;}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ new\_scroll\ =\ (std::min)(new\_scroll,\ get\_num\_rows()\ *\ \_pixel\_scale\ *\ 5\ +\ \_pixel\_scale\ *\ 2\ -\/\ get\_ysize());}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ new\_scroll\ =\ (std::max)(new\_scroll,\ 0);}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ delta\ =\ new\_scroll\ -\/\ \_scroll;}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (delta\ !=\ 0)\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \_scroll\ =\ new\_scroll;}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \_threads\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}();}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00511\ \ \ \ \ \}}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \textcolor{keywordflow}{case}\ WM\_MOUSEHWHEEL:}
\DoxyCodeLine{00515\ \ \ \ \ \{}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ GET\_WHEEL\_DELTA\_WPARAM(wparam);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \_scroll\_speed\ +=\ delta\ /\ 12.0;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00520\ \ \ \ \ \}}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00522\ }
\DoxyCodeLine{00523\ \ \ \textcolor{keywordflow}{case}\ WM\_KEYDOWN:}
\DoxyCodeLine{00524\ \ \ \textcolor{keywordflow}{case}\ WM\_KEYUP:}
\DoxyCodeLine{00525\ \ \ \ \ \{}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ flag\ =\ 0;}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ vsc\ =\ (lparam\ \&\ 0xff0000)\ >>\ 16;}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((lparam\ \&\ 0x1000000)\ ==\ 0)\ \{}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Accept\ WASD\ based\ on\ their\ position\ rather\ than\ their\ mapping}}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (vsc)\ \{}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 17:}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 30:}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 31:}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 32:}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00544\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00545\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ ==\ 0)\ \{}
\DoxyCodeLine{00546\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (wparam)\ \{}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_LEFT:}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_left;}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ VK\_RIGHT:}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_right;}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'W'}:}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'A'}:}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'S'}:}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'D'}:}
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00565\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00566\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ !=\ 0)\ \{}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (msg\ ==\ WM\_KEYDOWN)\ \{}
\DoxyCodeLine{00569\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ \&\ (F\_w\ |\ F\_s))\ \{}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ POINT\ point;}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (GetCursorPos(\&point)\ \&\&\ ScreenToClient(\_graph\_window,\ \&point))\ \{}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(point.x);}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_zoom\_center\ =\ get\_horizontal\_scroll()\ +\ get\_horizontal\_scale()\ /\ 2.0;}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_keys\_held\ ==\ 0)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classWinStatsGraph_a66d3acee49e839e08f8efc12beb03a54}{start\_animation}}();}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \_keys\_held\ |=\ flag;}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_keys\_held\ !=\ 0)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \_keys\_held\ \&=\ \string~flag;}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \ \ \textcolor{keywordflow}{case}\ WM\_KILLFOCUS:}
\DoxyCodeLine{00590\ \ \ \ \ \_keys\_held\ =\ 0;}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00592\ }
\DoxyCodeLine{00593\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00595\ \ \ \}}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keywordflow}{return}\ WinStatsGraph::graph\_window\_proc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00605\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_af7b8e1a3b2cd585140df413b28b0de3b}{WinStatsTimeline::}}}
\DoxyCodeLine{00606\ \mbox{\hyperlink{classWinStatsTimeline_af7b8e1a3b2cd585140df413b28b0de3b}{additional\_window\_paint}}(HDC\ hdc)\ \{}
\DoxyCodeLine{00607\ \ \ \textcolor{comment}{//\ Draw\ in\ the\ labels\ for\ the\ guide\ bars.}}
\DoxyCodeLine{00608\ \ \ SelectObject(hdc,\ WinStatsGraph::\_monitor-\/>get\_font());}
\DoxyCodeLine{00609\ \ \ SetTextAlign(hdc,\ TA\_LEFT\ |\ TA\_BOTTOM);}
\DoxyCodeLine{00610\ \ \ SetBkMode(hdc,\ TRANSPARENT);}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \textcolor{keywordtype}{int}\ y\ =\ \_top\_margin\ -\/\ 2;}
\DoxyCodeLine{00613\ }
\DoxyCodeLine{00614\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00615\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00616\ \ \ \ \ draw\_guide\_label(hdc,\ y,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i));}
\DoxyCodeLine{00617\ \ \ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ SetTextColor(hdc,\ \_dark\_color);}
\DoxyCodeLine{00620\ \ \ SetTextAlign(hdc,\ TA\_LEFT\ |\ TA\_TOP\ |\ TA\_NOUPDATECP);}
\DoxyCodeLine{00621\ }
\DoxyCodeLine{00622\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatTimeline_1_1ThreadRow}{ThreadRow}}\ \&thread\_row\ :\ \_threads)\ \{}
\DoxyCodeLine{00623\ \ \ \ \ \textcolor{keywordflow}{if}\ (thread\_row.\_visible)\ \{}
\DoxyCodeLine{00624\ \ \ \ \ \ \ draw\_thread\_label(hdc,\ thread\_row);}
\DoxyCodeLine{00625\ \ \ \ \ \}}
\DoxyCodeLine{00626\ \ \ \}}
\DoxyCodeLine{00627\ \}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00634\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classWinStatsTimeline_a781ea41407f8768c13df50d22bed3b9c}{WinStatsTimeline::}}}
\DoxyCodeLine{00635\ \mbox{\hyperlink{classWinStatsTimeline_a781ea41407f8768c13df50d22bed3b9c}{additional\_graph\_window\_paint}}(HDC\ hdc)\ \{}
\DoxyCodeLine{00636\ \}}
\DoxyCodeLine{00637\ }
\DoxyCodeLine{00642\ std::string\ \mbox{\hyperlink{classWinStatsTimeline_abec7d4c1601f8fb6013d068d55516b53}{WinStatsTimeline::}}}
\DoxyCodeLine{00643\ \mbox{\hyperlink{classWinStatsTimeline_abec7d4c1601f8fb6013d068d55516b53}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00644\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_ab138ad122f3c31ffbe334a65458baf20}{PStatTimeline::get\_bar\_tooltip}}(pixel\_to\_row(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00645\ \}}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00652\ WinStatsGraph::DragMode\ \mbox{\hyperlink{classWinStatsTimeline_ae981169b937f9407b479e350dcee28f4}{WinStatsTimeline::}}}
\DoxyCodeLine{00653\ \mbox{\hyperlink{classWinStatsTimeline_ae981169b937f9407b479e350dcee28f4}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{00654\ \ \ DragMode\ mode\ =\ \mbox{\hyperlink{classWinStatsGraph_a6e217fc14d67434560f235087055ccd4}{WinStatsGraph::consider\_drag\_start}}(mouse\_x,\ mouse\_y,\ width,\ height);}
\DoxyCodeLine{00655\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ DM\_right\_margin)\ \{}
\DoxyCodeLine{00656\ \ \ \ \ mode\ =\ DM\_none;}
\DoxyCodeLine{00657\ \ \ \}}
\DoxyCodeLine{00658\ \ \ \textcolor{keywordflow}{return}\ mode;}
\DoxyCodeLine{00659\ \}}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00664\ \textcolor{keywordtype}{void}\ WinStatsTimeline::}
\DoxyCodeLine{00665\ draw\_guide\_label(HDC\ hdc,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00666\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00667\ \ \ \textcolor{keywordflow}{if}\ (label.empty())\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00669\ \ \ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \textcolor{keywordtype}{bool}\ center\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00672\ \ \ \textcolor{keywordflow}{switch}\ (bar.\_style)\ \{}
\DoxyCodeLine{00673\ \ \ \textcolor{keywordflow}{case}\ GBS\_target:}
\DoxyCodeLine{00674\ \ \ \ \ SetTextColor(hdc,\ \_light\_color);}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00677\ \ \ \textcolor{keywordflow}{case}\ GBS\_user:}
\DoxyCodeLine{00678\ \ \ \ \ SetTextColor(hdc,\ \_user\_guide\_bar\_color);}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{case}\ GBS\_normal:}
\DoxyCodeLine{00682\ \ \ \ \ SetTextColor(hdc,\ \_light\_color);}
\DoxyCodeLine{00683\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ \textcolor{keywordflow}{case}\ GBS\_frame:}
\DoxyCodeLine{00686\ \ \ \ \ SetTextColor(hdc,\ \_dark\_color);}
\DoxyCodeLine{00687\ \ \ \ \ center\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00688\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00689\ \ \ \}}
\DoxyCodeLine{00690\ }
\DoxyCodeLine{00691\ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00692\ \ \ SIZE\ size;}
\DoxyCodeLine{00693\ \ \ GetTextExtentPoint32(hdc,\ label.data(),\ label.length(),\ \&size);}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \textcolor{keywordtype}{int}\ this\_x\ =\ \_graph\_left\ +\ x;}
\DoxyCodeLine{00696\ \ \ \textcolor{keywordflow}{if}\ (center)\ \{}
\DoxyCodeLine{00697\ \ \ \ \ this\_x\ -\/=\ size.cx\ /\ 2;}
\DoxyCodeLine{00698\ \ \ \}}
\DoxyCodeLine{00699\ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00700\ \ \ \ \ TextOut(hdc,\ this\_x,\ y,}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ \ \ \ \ label.data(),\ label.length());}
\DoxyCodeLine{00702\ \ \ \}}
\DoxyCodeLine{00703\ \}}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00708\ \textcolor{keywordtype}{void}\ WinStatsTimeline::}
\DoxyCodeLine{00709\ draw\_thread\_label(HDC\ hdc,\ \textcolor{keyword}{const}\ ThreadRow\ \&thread\_row)\ \{}
\DoxyCodeLine{00710\ \ \ \textcolor{keywordtype}{int}\ top\ =\ row\_to\_pixel(thread\_row.\_row\_offset\ +\ 1);}
\DoxyCodeLine{00711\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ row\_to\_pixel(thread\_row.\_row\_offset\ +\ 2);}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ RECT\ rect\ =\ \{\_pixel\_scale\ *\ 2,\ top,\ \_left\_margin\ -\/\ \_pixel\_scale\ *\ 2,\ bottom\};}
\DoxyCodeLine{00714\ \ \ DrawText(hdc,\ thread\_row.\_label.data(),\ thread\_row.\_label.size(),}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \&rect,\ DT\_RIGHT\ |\ DT\_END\_ELLIPSIS\ |\ DT\_SINGLELINE\ |\ DT\_VCENTER);}
\DoxyCodeLine{00716\ \}}
\DoxyCodeLine{00717\ }
\DoxyCodeLine{00721\ \textcolor{keywordtype}{void}\ WinStatsTimeline::}
\DoxyCodeLine{00722\ create\_window()\ \{}
\DoxyCodeLine{00723\ \ \ \textcolor{keywordflow}{if}\ (\_window)\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00725\ \ \ \}}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ HINSTANCE\ application\ =\ GetModuleHandle(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00728\ \ \ register\_window\_class(application);}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00730\ \ \ POINT\ window\_pos\ =\ WinStatsGraph::\_monitor-\/>\mbox{\hyperlink{classWinStatsMonitor_a2f0a1a79cadac41d2e0d9722c80ca0dd}{get\_new\_window\_pos}}();}
\DoxyCodeLine{00731\ }
\DoxyCodeLine{00732\ \ \ RECT\ win\_rect\ =\ \{}
\DoxyCodeLine{00733\ \ \ \ \ 0,\ 0,}
\DoxyCodeLine{00734\ \ \ \ \ \_left\_margin\ +\ get\_xsize()\ +\ \_right\_margin,}
\DoxyCodeLine{00735\ \ \ \ \ \_top\_margin\ +\ get\_ysize()\ +\ \_bottom\_margin}
\DoxyCodeLine{00736\ \ \ \};}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ \textcolor{comment}{//\ compute\ window\ size\ based\ on\ desired\ client\ area\ size}}
\DoxyCodeLine{00739\ \ \ AdjustWindowRect(\&win\_rect,\ graph\_window\_style,\ FALSE);}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \_window\ =}
\DoxyCodeLine{00742\ \ \ \ \ CreateWindowEx(WS\_EX\_DLGMODALFRAME,\ \_window\_class\_name,}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Timeline"{}},\ graph\_window\_style,}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ window\_pos.x,\ window\_pos.y,}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ win\_rect.right\ -\/\ win\_rect.left,}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ win\_rect.bottom\ -\/\ win\_rect.top,}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ WinStatsGraph::\_monitor-\/>get\_window(),\ \textcolor{keyword}{nullptr},\ application,\ 0);}
\DoxyCodeLine{00748\ \ \ \textcolor{keywordflow}{if}\ (!\_window)\ \{}
\DoxyCodeLine{00749\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ create\ timeline\ window!\(\backslash\)n"{}};}
\DoxyCodeLine{00750\ \ \ \ \ exit(1);}
\DoxyCodeLine{00751\ \ \ \}}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00753\ \ \ SetWindowLongPtr(\_window,\ 0,\ (LONG\_PTR)\textcolor{keyword}{this});}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \textcolor{comment}{//\ Ensure\ that\ the\ window\ is\ on\ top\ of\ the\ stack.}}
\DoxyCodeLine{00756\ \ \ SetWindowPos(\_window,\ HWND\_TOP,\ 0,\ 0,\ 0,\ 0,}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SWP\_NOMOVE\ |\ SWP\_NOSIZE\ |\ SWP\_SHOWWINDOW);}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \ \ SetFocus(\_window);}
\DoxyCodeLine{00760\ \}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00766\ \textcolor{keywordtype}{void}\ WinStatsTimeline::}
\DoxyCodeLine{00767\ register\_window\_class(HINSTANCE\ application)\ \{}
\DoxyCodeLine{00768\ \ \ \textcolor{keywordflow}{if}\ (\_window\_class\_registered)\ \{}
\DoxyCodeLine{00769\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00770\ \ \ \}}
\DoxyCodeLine{00771\ }
\DoxyCodeLine{00772\ \ \ WNDCLASS\ wc;}
\DoxyCodeLine{00773\ }
\DoxyCodeLine{00774\ \ \ ZeroMemory(\&wc,\ \textcolor{keyword}{sizeof}(WNDCLASS));}
\DoxyCodeLine{00775\ \ \ wc.style\ =\ 0;}
\DoxyCodeLine{00776\ \ \ wc.lpfnWndProc\ =\ (WNDPROC)static\_window\_proc;}
\DoxyCodeLine{00777\ \ \ wc.hInstance\ =\ application;}
\DoxyCodeLine{00778\ \ \ wc.hCursor\ =\ LoadCursor(\textcolor{keyword}{nullptr},\ IDC\_ARROW);}
\DoxyCodeLine{00779\ \ \ wc.hbrBackground\ =\ (HBRUSH)COLOR\_WINDOW;}
\DoxyCodeLine{00780\ \ \ wc.lpszMenuName\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00781\ \ \ wc.lpszClassName\ =\ \_window\_class\_name;}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \textcolor{comment}{//\ Reserve\ space\ to\ associate\ the\ this\ pointer\ with\ the\ window.}}
\DoxyCodeLine{00784\ \ \ wc.cbWndExtra\ =\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{classWinStatsTimeline}{WinStatsTimeline}}\ *);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ \textcolor{keywordflow}{if}\ (!RegisterClass(\&wc))\ \{}
\DoxyCodeLine{00787\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Could\ not\ register\ Timeline\ window\ class!\(\backslash\)n"{}};}
\DoxyCodeLine{00788\ \ \ \ \ exit(1);}
\DoxyCodeLine{00789\ \ \ \}}
\DoxyCodeLine{00790\ }
\DoxyCodeLine{00791\ \ \ \_window\_class\_registered\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00792\ \}}
\DoxyCodeLine{00793\ }
\DoxyCodeLine{00797\ LONG\ WINAPI\ WinStatsTimeline::}
\DoxyCodeLine{00798\ static\_window\_proc(HWND\ hwnd,\ UINT\ msg,\ WPARAM\ wparam,\ LPARAM\ lparam)\ \{}
\DoxyCodeLine{00799\ \ \ \mbox{\hyperlink{classWinStatsTimeline}{WinStatsTimeline}}\ *self\ =\ (\mbox{\hyperlink{classWinStatsTimeline}{WinStatsTimeline}}\ *)GetWindowLongPtr(hwnd,\ 0);}
\DoxyCodeLine{00800\ \ \ \textcolor{keywordflow}{if}\ (self\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ self-\/>\_window\ ==\ hwnd)\ \{}
\DoxyCodeLine{00801\ \ \ \ \ \textcolor{keywordflow}{return}\ self-\/>window\_proc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00802\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00803\ \ \ \ \ \textcolor{keywordflow}{return}\ DefWindowProc(hwnd,\ msg,\ wparam,\ lparam);}
\DoxyCodeLine{00804\ \ \ \}}
\DoxyCodeLine{00805\ \}}

\end{DoxyCode}
