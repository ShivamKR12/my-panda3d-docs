\doxysection{geom\+Triangles\+Adjacency.\+cxx}
\hypertarget{geomTrianglesAdjacency_8cxx_source}{}\label{geomTrianglesAdjacency_8cxx_source}\index{panda/src/gobj/geomTrianglesAdjacency.cxx@{panda/src/gobj/geomTrianglesAdjacency.cxx}}
\mbox{\hyperlink{geomTrianglesAdjacency_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTrianglesAdjacency_8h}{geomTrianglesAdjacency.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexRewriter_8h}{geomVertexRewriter.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatTimer_8h}{pStatTimer.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsStateGuardianBase_8h}{graphicsStateGuardianBase.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ GeomTrianglesAdjacency::\_type\_handle;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00027\ GeomTrianglesAdjacency(GeomTrianglesAdjacency::UsageHint\ usage\_hint)\ :}
\DoxyCodeLine{00028\ \ \ \mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}}(usage\_hint)}
\DoxyCodeLine{00029\ \{}
\DoxyCodeLine{00030\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00036\ GeomTrianglesAdjacency(\textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ \&copy)\ :}
\DoxyCodeLine{00037\ \ \ \mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}}(copy)}
\DoxyCodeLine{00038\ \{}
\DoxyCodeLine{00039\ \}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00044\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00045\ \string~GeomTrianglesAdjacency()\ \{}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ PT(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}})\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00052\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00054\ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00064\ GeomPrimitive::PrimitiveType\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00065\ get\_primitive\_type()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{return}\ PT\_polygons;}
\DoxyCodeLine{00067\ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00073\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classGeomTrianglesAdjacency_af62c7413cf28db615bc16532d55861b0}{GeomTrianglesAdjacency::}}}
\DoxyCodeLine{00074\ \mbox{\hyperlink{classGeomTrianglesAdjacency_af62c7413cf28db615bc16532d55861b0}{get\_geom\_rendering}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classGeomPrimitive_a1653451707b6bad7d72714613ec8f727}{GeomPrimitive::get\_geom\_rendering}}()\ |\ GR\_adjacency;}
\DoxyCodeLine{00076\ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classGeomTrianglesAdjacency_a7be8fe6d3f7c203f718ab018ce240f54}{GeomTrianglesAdjacency::}}}
\DoxyCodeLine{00086\ \mbox{\hyperlink{classGeomTrianglesAdjacency_a7be8fe6d3f7c203f718ab018ce240f54}{get\_num\_vertices\_per\_primitive}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{return}\ 6;}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{bool}\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00094\ draw(\mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ *reader,}
\DoxyCodeLine{00095\ \ \ \ \ \ \textcolor{keywordtype}{bool}\ force)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00096\ \ \ \textcolor{keywordflow}{return}\ gsg-\/>draw\_triangles\_adj(reader,\ force);}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00102\ CPT(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}})\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00103\ doubleside\_impl()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{00105\ \ \ PT(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}})\ reversed\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \ \ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ from(\textcolor{keyword}{this},\ current\_thread);}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \textcolor{comment}{//\ This\ is\ like\ reverse(),\ except\ we\ don't\ clear\ the\ vertices\ first.\ \ That}}
\DoxyCodeLine{00110\ \ \ \textcolor{comment}{//\ way\ we\ double\ the\ vertices\ up.}}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \textcolor{comment}{//\ First,\ rotate\ the\ original\ copy,\ if\ necessary,\ so\ the\ flat-\/firstflat-\/last}}
\DoxyCodeLine{00113\ \ \ \textcolor{comment}{//\ nature\ of\ the\ vertices\ is\ consistent\ throughout\ the\ primitive.}}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{bool}\ needs\_rotate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{switch}\ (from.get\_shade\_model())\ \{}
\DoxyCodeLine{00116\ \ \ \textcolor{keywordflow}{case}\ SM\_flat\_first\_vertex:}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{case}\ SM\_flat\_last\_vertex:}
\DoxyCodeLine{00118\ \ \ \ \ reversed\ =\ (\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ *)DCAST(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}},\ reversed-\/>rotate());}
\DoxyCodeLine{00119\ \ \ \ \ needs\_rotate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00123\ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{comment}{//\ Now\ append\ all\ the\ new\ vertices,\ in\ reverse\ order.}}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ from.get\_num\_vertices()\ -\/\ 1;\ i\ >=\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ reversed-\/>add\_vertex(from.get\_vertex(i));}
\DoxyCodeLine{00128\ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \textcolor{comment}{//\ Finally,\ re-\/rotate\ the\ whole\ thing\ to\ get\ back\ to\ the\ original\ shade}}
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ model.}}
\DoxyCodeLine{00132\ \ \ \textcolor{keywordflow}{if}\ (needs\_rotate)\ \{}
\DoxyCodeLine{00133\ \ \ \ \ reversed\ =\ (\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ *)DCAST(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}},\ reversed-\/>rotate());}
\DoxyCodeLine{00134\ \ \ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \textcolor{keywordflow}{return}\ reversed;}
\DoxyCodeLine{00137\ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00142\ CPT(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}})\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00143\ reverse\_impl()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00144\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{00145\ \ \ PT(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}})\ reversed\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{classGeomPrimitivePipelineReader}{GeomPrimitivePipelineReader}}\ from(\textcolor{keyword}{this},\ current\_thread);}
\DoxyCodeLine{00148\ \ \ reversed-\/>clear\_vertices();}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ from.get\_num\_vertices()\ -\/\ 1;\ i\ >=\ 0;\ -\/-\/i)\ \{}
\DoxyCodeLine{00151\ \ \ \ \ reversed-\/>add\_vertex(from.get\_vertex(i));}
\DoxyCodeLine{00152\ \ \ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{switch}\ (from.get\_shade\_model())\ \{}
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{case}\ SM\_flat\_first\_vertex:}
\DoxyCodeLine{00156\ \ \ \ \ reversed-\/>set\_shade\_model(SM\_flat\_last\_vertex);}
\DoxyCodeLine{00157\ \ \ \ \ reversed\ =\ (\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ *)DCAST(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}},\ reversed-\/>rotate());}
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \textcolor{keywordflow}{case}\ SM\_flat\_last\_vertex:}
\DoxyCodeLine{00161\ \ \ \ \ reversed-\/>set\_shade\_model(SM\_flat\_first\_vertex);}
\DoxyCodeLine{00162\ \ \ \ \ reversed\ =\ (\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ *)DCAST(\mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}},\ reversed-\/>rotate());}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00167\ \ \ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \textcolor{keywordflow}{return}\ reversed;}
\DoxyCodeLine{00170\ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00175\ \textcolor{keywordtype}{void}\ GeomTrianglesAdjacency::}
\DoxyCodeLine{00176\ register\_with\_read\_factory()\ \{}
\DoxyCodeLine{00177\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classGeomTrianglesAdjacency_af2d33ba182060dfcb7bdf05abefa77e8}{make\_from\_bam}});}
\DoxyCodeLine{00178\ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00185\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classGeomTrianglesAdjacency_af2d33ba182060dfcb7bdf05abefa77e8}{GeomTrianglesAdjacency::}}}
\DoxyCodeLine{00186\ \mbox{\hyperlink{classGeomTrianglesAdjacency_af2d33ba182060dfcb7bdf05abefa77e8}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00187\ \ \ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}\ *\textcolor{keywordtype}{object}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTrianglesAdjacency}{GeomTrianglesAdjacency}}(UH\_unspecified);}
\DoxyCodeLine{00188\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00189\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordtype}{object}-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \textcolor{keywordflow}{return}\ object;}
\DoxyCodeLine{00195\ \}}

\end{DoxyCode}
