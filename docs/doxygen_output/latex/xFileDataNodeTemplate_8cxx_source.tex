\doxysection{x\+File\+Data\+Node\+Template.\+cxx}
\hypertarget{xFileDataNodeTemplate_8cxx_source}{}\label{xFileDataNodeTemplate_8cxx_source}\index{pandatool/src/xfile/xFileDataNodeTemplate.cxx@{pandatool/src/xfile/xFileDataNodeTemplate.cxx}}
\mbox{\hyperlink{xFileDataNodeTemplate_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileDataNodeTemplate_8h}{xFileDataNodeTemplate.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xFileParseData_8h}{xFileParseData.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{xLexerDefs_8h}{xLexerDefs.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__xfile_8h}{config\_xfile.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ XFileDataNodeTemplate::\_type\_handle;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ XFileDataNodeTemplate::}
\DoxyCodeLine{00028\ XFileDataNodeTemplate(\mbox{\hyperlink{classXFile}{XFile}}\ *x\_file,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classXFileTemplate}{XFileTemplate}}\ *xtemplate)\ :}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classXFileDataNode}{XFileDataNode}}(x\_file,\ name,\ xtemplate)}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00037\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_ab8171c4d0b245509ff39cc9f1a7eb35f}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00038\ \mbox{\hyperlink{classXFileDataNodeTemplate_ab8171c4d0b245509ff39cc9f1a7eb35f}{zero\_fill}}()\ \{}
\DoxyCodeLine{00039\ \ \ \_template-\/>\mbox{\hyperlink{classXFileNode_af0c9c6d01539e1f996c3a57800fff03b}{fill\_zero\_data}}(\textcolor{keyword}{this});}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00046\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileDataNodeTemplate_ac91798b72e65e8c69359eb230676e3d9}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00047\ \mbox{\hyperlink{classXFileDataNodeTemplate_ac91798b72e65e8c69359eb230676e3d9}{is\_complex\_object}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00049\ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00055\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a298b20c1b162819f02a09064e42b3756}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00056\ \mbox{\hyperlink{classXFileDataNodeTemplate_a298b20c1b162819f02a09064e42b3756}{add\_parse\_double}}(\mbox{\hyperlink{classPointerToArray}{PTA\_double}}\ double\_list)\ \{}
\DoxyCodeLine{00057\ \ \ \mbox{\hyperlink{classXFileParseData}{XFileParseData}}\ pdata;}
\DoxyCodeLine{00058\ \ \ pdata.\_double\_list\ =\ double\_list;}
\DoxyCodeLine{00059\ \ \ pdata.\_parse\_flags\ =\ XFileParseData::PF\_double;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \_parse\_data\_list.\_list.push\_back(pdata);}
\DoxyCodeLine{00062\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_ad4d373554f0a10bee081100ae3b67b18}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classXFileDataNodeTemplate_ad4d373554f0a10bee081100ae3b67b18}{add\_parse\_int}}(\mbox{\hyperlink{classPointerToArray}{PTA\_int}}\ int\_list)\ \{}
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{classXFileParseData}{XFileParseData}}\ pdata;}
\DoxyCodeLine{00071\ \ \ pdata.\_int\_list\ =\ int\_list;}
\DoxyCodeLine{00072\ \ \ pdata.\_parse\_flags\ =\ XFileParseData::PF\_int;}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \_parse\_data\_list.\_list.push\_back(pdata);}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00081\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_ae92446e9fb24c1c7232782e25e92a8ac}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00082\ \mbox{\hyperlink{classXFileDataNodeTemplate_ae92446e9fb24c1c7232782e25e92a8ac}{add\_parse\_string}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&str)\ \{}
\DoxyCodeLine{00083\ \ \ \mbox{\hyperlink{classXFileParseData}{XFileParseData}}\ pdata;}
\DoxyCodeLine{00084\ \ \ pdata.\_string\ =\ str;}
\DoxyCodeLine{00085\ \ \ pdata.\_parse\_flags\ =\ XFileParseData::PF\_string;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ \_parse\_data\_list.\_list.push\_back(pdata);}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00096\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a0b5aa3a2d089c65f8be8893fbd67b19f}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00097\ \mbox{\hyperlink{classXFileDataNodeTemplate_a0b5aa3a2d089c65f8be8893fbd67b19f}{finalize\_parse\_data}}()\ \{}
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ Recursively\ walk\ through\ our\ template\ definition,\ while\ simultaneously}}
\DoxyCodeLine{00099\ \ \ \textcolor{comment}{//\ walking\ through\ the\ list\ of\ parse\ data\ elements\ we\ encountered,\ and\ re-\/}}
\DoxyCodeLine{00100\ \ \ \textcolor{comment}{//\ pack\ them\ as\ actual\ nested\ elements.}}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{classpmap}{PrevData}}\ prev\_data;}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{size\_t}\ index\ =\ 0;}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{size\_t}\ sub\_index\ =\ 0;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordflow}{if}\ (!\_template-\/>repack\_data(\textcolor{keyword}{this},\ \_parse\_data\_list,}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ prev\_data,\ index,\ sub\_index))\ \{}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00108\ \ \ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{if}\ (index\ !=\ \_parse\_data\_list.\_list.size())\ \{}
\DoxyCodeLine{00111\ \ \ \ \ xyywarning(\textcolor{stringliteral}{"{}Too\ many\ data\ elements\ in\ structure."{}});}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00115\ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a8cbb861e5a66d7c705b74deda0b1eab0}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00123\ \mbox{\hyperlink{classXFileDataNodeTemplate_a8cbb861e5a66d7c705b74deda0b1eab0}{add\_element}}(\mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ *element)\ \{}
\DoxyCodeLine{00124\ \ \ \_nested\_elements.push\_back(element);}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00126\ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00131\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_ada2dccd54ecb2d3a32d7e2f07ed7f85a}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00132\ \mbox{\hyperlink{classXFileDataNodeTemplate_ada2dccd54ecb2d3a32d7e2f07ed7f85a}{write\_text}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00134\ \ \ \ \ <<\ \_template-\/>get\_name();}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (has\_name())\ \{}
\DoxyCodeLine{00136\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ get\_name();}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \{\(\backslash\)n"{}};}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00140\ \ \ NestedElements::const\_iterator\ ni;}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{for}\ (ni\ =\ \_nested\_elements.begin();\ ni\ !=\ \_nested\_elements.end();\ ++ni)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ (*ni)-\/>write\_data(out,\ indent\_level\ +\ 2,\ \textcolor{stringliteral}{"{};"{}});}
\DoxyCodeLine{00143\ \ \ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \mbox{\hyperlink{classXFileNode_a16e953b2134005d98634d0ce5c258031}{XFileNode::write\_text}}(out,\ indent\_level\ +\ 2);}
\DoxyCodeLine{00146\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00147\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\}\(\backslash\)n"{}};}
\DoxyCodeLine{00148\ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00153\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a0ab5aeeeb9a919e7dd898f89ab2636cf}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00154\ \mbox{\hyperlink{classXFileDataNodeTemplate_a0ab5aeeeb9a919e7dd898f89ab2636cf}{write\_data}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *separator)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{if}\ (!\_nested\_elements.empty())\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{keywordtype}{bool}\ indented\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_nested\_elements.size()\ -\/\ 1;\ i++)\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ *\textcolor{keywordtype}{object}\ =\ \_nested\_elements[i];}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (object-\/>is\_complex\_object())\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ we\ have\ a\ "{}complex"{}\ nested\ object,\ output\ it\ on\ its\ own\ line.}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (indented)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ indented\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{object}-\/>write\_data(out,\ indent\_level,\ \textcolor{stringliteral}{"{};"{}});}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00167\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ output\ them\ all\ on\ the\ same\ line.}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!indented)\ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ indented\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ out\ <<\ *\textcolor{keywordtype}{object}\ <<\ \textcolor{stringliteral}{"{};\ "{}};}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{comment}{//\ The\ last\ object\ is\ the\ set\ is\ different,\ because\ it\ gets\ separator}}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{comment}{//\ appended\ to\ it,\ and\ it\ always\ gets\ a\ newline.}}
\DoxyCodeLine{00179\ \ \ \ \ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ *\textcolor{keywordtype}{object}\ =\ \_nested\_elements.back();}
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{if}\ (object-\/>is\_complex\_object())\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (indented)\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ combined\_separator\ =\ string(\textcolor{stringliteral}{"{};"{}})\ +\ string(separator);}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordtype}{object}-\/>write\_data(out,\ indent\_level,\ combined\_separator.c\_str());}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!indented)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level);}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ out\ <<\ *\textcolor{keywordtype}{object}\ <<\ \textcolor{stringliteral}{"{};"{}}\ <<\ separator\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00192\ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \}}
\DoxyCodeLine{00194\ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00200\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a35df57bc885d3a5ddd75447b0572cbff}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00201\ \mbox{\hyperlink{classXFileDataNodeTemplate_a35df57bc885d3a5ddd75447b0572cbff}{get\_num\_elements}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordflow}{return}\ \_nested\_elements.size();}
\DoxyCodeLine{00203\ \}}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00208\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ *\mbox{\hyperlink{classXFileDataNodeTemplate_a65d199a4d52521edb6d0b9e6601aa991}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00209\ \mbox{\hyperlink{classXFileDataNodeTemplate_a65d199a4d52521edb6d0b9e6601aa991}{get\_element}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{00210\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_nested\_elements.size(),\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{return}\ \_nested\_elements[n];}
\DoxyCodeLine{00212\ \}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00218\ \mbox{\hyperlink{classXFileDataObject}{XFileDataObject}}\ *\mbox{\hyperlink{classXFileDataNodeTemplate_a65d199a4d52521edb6d0b9e6601aa991}{XFileDataNodeTemplate::}}}
\DoxyCodeLine{00219\ \mbox{\hyperlink{classXFileDataNodeTemplate_a65d199a4d52521edb6d0b9e6601aa991}{get\_element}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ \{}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordtype}{int}\ child\_index\ =\ \_template-\/>find\_child\_index(name);}
\DoxyCodeLine{00221\ \ \ \textcolor{keywordflow}{if}\ (child\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classXFileDataNodeTemplate_a65d199a4d52521edb6d0b9e6601aa991}{get\_element}}(child\_index);}
\DoxyCodeLine{00223\ \ \ \}}
\DoxyCodeLine{00224\ \ \ xfile\_cat.warning()}
\DoxyCodeLine{00225\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ name\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ not\ a\ member\ of\ "{}}\ <<\ \_template-\/>get\_name()}
\DoxyCodeLine{00226\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00227\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00228\ \}}

\end{DoxyCode}
