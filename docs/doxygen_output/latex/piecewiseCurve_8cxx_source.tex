\doxysection{piecewise\+Curve.\+cxx}
\hypertarget{piecewiseCurve_8cxx_source}{}\label{piecewiseCurve_8cxx_source}\index{panda/src/parametrics/piecewiseCurve.cxx@{panda/src/parametrics/piecewiseCurve.cxx}}
\mbox{\hyperlink{piecewiseCurve_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{piecewiseCurve_8h}{piecewiseCurve.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cubicCurveseg_8h}{cubicCurveseg.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__parametrics_8h}{config\_parametrics.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{using\ }std::cerr;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ PiecewiseCurve::\_type\_handle;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ PiecewiseCurve::}
\DoxyCodeLine{00031\ PiecewiseCurve()\ \{}
\DoxyCodeLine{00032\ \ \ \_last\_ti\ =\ 0;}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00038\ PiecewiseCurve::}
\DoxyCodeLine{00039\ \string~PiecewiseCurve()\ \{}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classPiecewiseCurve_a2285addec97b2b502823c468746a1bcf}{remove\_all\_curvesegs}}();}
\DoxyCodeLine{00041\ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00048\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a512ddf84e4693032262e79c825a6aa53}{PiecewiseCurve::}}}
\DoxyCodeLine{00049\ \mbox{\hyperlink{classPiecewiseCurve_a512ddf84e4693032262e79c825a6aa53}{is\_valid}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{return}\ !\_segs.empty();}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00057\ PN\_stdfloat\ \mbox{\hyperlink{classPiecewiseCurve_a954382fd918abed1e826002e1a852688}{PiecewiseCurve::}}}
\DoxyCodeLine{00058\ \mbox{\hyperlink{classPiecewiseCurve_a954382fd918abed1e826002e1a852688}{get\_max\_t}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \_segs.empty()\ ?\ 0.0f\ :\ \_segs.back().\_tend;}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00069\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a6396b8bc47ee27c1f58ea27b3a105b92}{PiecewiseCurve::}}}
\DoxyCodeLine{00070\ \mbox{\hyperlink{classPiecewiseCurve_a6396b8bc47ee27c1f58ea27b3a105b92}{get\_point}}(PN\_stdfloat\ t,\ LVecBase3\ \&point)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00071\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{if}\ (curve\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00075\ \ \ \}}
\DoxyCodeLine{00076\ \ \ \textcolor{comment}{//\ We\ use\ |\ instead\ of\ ||\ so\ we\ won't\ short-\/circuit\ this\ calculation.}}
\DoxyCodeLine{00077\ \ \ \textcolor{keywordflow}{return}\ result\ |\ curve-\/>get\_point(t,\ point);}
\DoxyCodeLine{00078\ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00084\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a58dcf70b723fe3886739fa9a9a2d1fc5}{PiecewiseCurve::}}}
\DoxyCodeLine{00085\ \mbox{\hyperlink{classPiecewiseCurve_a58dcf70b723fe3886739fa9a9a2d1fc5}{get\_tangent}}(PN\_stdfloat\ t,\ LVecBase3\ \&tangent)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00086\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{if}\ (curve\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ \ \ \textcolor{comment}{//\ We\ use\ |\ instead\ of\ ||\ so\ we\ won't\ short-\/circuit\ this\ calculation.}}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{return}\ result\ |\ curve-\/>get\_tangent(t,\ tangent);}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00099\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_ab819db8e93c6044764631be61f1c9f21}{PiecewiseCurve::}}}
\DoxyCodeLine{00100\ \mbox{\hyperlink{classPiecewiseCurve_ab819db8e93c6044764631be61f1c9f21}{get\_2ndtangent}}(PN\_stdfloat\ t,\ LVecBase3\ \&tangent2)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00101\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordflow}{if}\ (curve\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00105\ \ \ \}}
\DoxyCodeLine{00106\ \ \ \textcolor{comment}{//\ We\ use\ |\ instead\ of\ ||\ so\ we\ won't\ short-\/circuit\ this\ calculation.}}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{return}\ result\ |\ curve-\/>get\_2ndtangent(t,\ tangent2);}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00114\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_ae04fede5fe5fed62163a5ae906a192c0}{PiecewiseCurve::}}}
\DoxyCodeLine{00115\ \mbox{\hyperlink{classPiecewiseCurve_ae04fede5fe5fed62163a5ae906a192c0}{adjust\_point}}(PN\_stdfloat\ t,}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ px,\ PN\_stdfloat\ py,\ PN\_stdfloat\ pz)\ \{}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{if}\ (parametrics\_cat.is\_debug())\ \{}
\DoxyCodeLine{00118\ \ \ \ \ parametrics\_cat.debug()}
\DoxyCodeLine{00119\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Adjusting\ point\ at\ "{}}\ <<\ t\ <<\ \textcolor{stringliteral}{"{}\ to\ "{}}\ <<\ px\ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ py\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ <<\ pz\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00121\ \ \ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{if}\ (!result)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}No\ curve\ segment\ at\ t\ =\ "{}}\ <<\ t\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{classPiecewiseCurve_aa9aa64f0ca05db94251f8bc9375cf9a5}{rebuild\_curveseg}}(RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4(),}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_POINT,\ t,\ LVecBase4(px,\ py,\ pz,\ 1.0f),}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_TANGENT\ |\ RT\_KEEP\_ORIG,\ t,\ LVecBase4(),}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4());}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00142\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a9f462e70ac3f6641960ef90437a6918e}{PiecewiseCurve::}}}
\DoxyCodeLine{00143\ \mbox{\hyperlink{classPiecewiseCurve_a9f462e70ac3f6641960ef90437a6918e}{adjust\_tangent}}(PN\_stdfloat\ t,}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ tx,\ PN\_stdfloat\ ty,\ PN\_stdfloat\ tz)\ \{}
\DoxyCodeLine{00145\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ \textcolor{keywordflow}{if}\ (!result)\ \{}
\DoxyCodeLine{00149\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}No\ curve\ segment\ at\ t\ =\ "{}}\ <<\ t\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00151\ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \mbox{\hyperlink{classPiecewiseCurve_aa9aa64f0ca05db94251f8bc9375cf9a5}{rebuild\_curveseg}}(RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4(),}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_POINT\ |\ RT\_KEEP\_ORIG,\ t,\ LVecBase4(),}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_TANGENT,\ t,\ LVecBase4(tx,\ ty,\ tz,\ 0.0f),}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4());}
\DoxyCodeLine{00157\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00158\ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00164\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a102a9d12be9302370f4e7b54e2719b9e}{PiecewiseCurve::}}}
\DoxyCodeLine{00165\ \mbox{\hyperlink{classPiecewiseCurve_a102a9d12be9302370f4e7b54e2719b9e}{adjust\_pt}}(PN\_stdfloat\ t,}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ px,\ PN\_stdfloat\ py,\ PN\_stdfloat\ pz,}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ PN\_stdfloat\ tx,\ PN\_stdfloat\ ty,\ PN\_stdfloat\ tz)\ \{}
\DoxyCodeLine{00168\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (!result)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}No\ curve\ segment\ at\ t\ =\ "{}}\ <<\ t\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \mbox{\hyperlink{classPiecewiseCurve_aa9aa64f0ca05db94251f8bc9375cf9a5}{rebuild\_curveseg}}(RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4(),}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_POINT,\ t,\ LVecBase4(px,\ py,\ pz,\ 1.0f),}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_TANGENT,\ t,\ LVecBase4(tx,\ ty,\ tz,\ 0.0f),}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RT\_CV\ |\ RT\_KEEP\_ORIG,\ 0.0f,\ LVecBase4());}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00188\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_acda8c1d4bdb4c7d4c4e3bfd0086bf8db}{PiecewiseCurve::}}}
\DoxyCodeLine{00189\ \mbox{\hyperlink{classPiecewiseCurve_acda8c1d4bdb4c7d4c4e3bfd0086bf8db}{get\_pt}}(PN\_stdfloat\ t,\ LVecBase3\ \&point,\ LVecBase3\ \&tangent)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00190\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *curve;}
\DoxyCodeLine{00191\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(curve,\ t);}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{if}\ (curve\ ==\ \textcolor{keyword}{nullptr})\{}
\DoxyCodeLine{00193\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00194\ \ \ \}}
\DoxyCodeLine{00195\ \ \ \textcolor{comment}{//\ We\ use\ |\ instead\ of\ ||\ so\ we\ won't\ short-\/circuit\ this\ calculation.}}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordflow}{return}\ result\ |\ curve-\/>get\_pt(t,\ point,\ tangent);}
\DoxyCodeLine{00197\ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPiecewiseCurve_abc81107fd1e28740785e4c77c49b6bc1}{PiecewiseCurve::}}}
\DoxyCodeLine{00204\ \mbox{\hyperlink{classPiecewiseCurve_abc81107fd1e28740785e4c77c49b6bc1}{get\_num\_segs}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{return}\ \_segs.size();}
\DoxyCodeLine{00206\ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00211\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *\mbox{\hyperlink{classPiecewiseCurve_a295235b3b110e82b4db17e4d3259fd3e}{PiecewiseCurve::}}}
\DoxyCodeLine{00212\ \mbox{\hyperlink{classPiecewiseCurve_a295235b3b110e82b4db17e4d3259fd3e}{get\_curveseg}}(\textcolor{keywordtype}{int}\ ti)\ \{}
\DoxyCodeLine{00213\ \ \ assert(ti\ >=\ 0\ \&\&\ ti\ <\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00214\ \ \ \textcolor{keywordflow}{return}\ \_segs[ti].\_curve;}
\DoxyCodeLine{00215\ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00227\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a48baebb91ee706378a45a3dd07b15aa7}{PiecewiseCurve::}}}
\DoxyCodeLine{00228\ \mbox{\hyperlink{classPiecewiseCurve_a48baebb91ee706378a45a3dd07b15aa7}{insert\_curveseg}}(\textcolor{keywordtype}{int}\ ti,\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *seg,\ PN\_stdfloat\ tlength)\ \{}
\DoxyCodeLine{00229\ \ \ \textcolor{keywordflow}{if}\ (ti\ <\ 0\ ||\ ti\ >\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00231\ \ \ \}}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{if}\ (ti\ ==\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \_segs.push\_back(\mbox{\hyperlink{classPiecewiseCurve_1_1Curveseg}{Curveseg}}(seg,\ \mbox{\hyperlink{classPiecewiseCurve_a954382fd918abed1e826002e1a852688}{get\_max\_t}}()\ +\ tlength));}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ti==0)\ \{}
\DoxyCodeLine{00237\ \ \ \ \ \_segs.insert(\_segs.begin(),}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPiecewiseCurve_1_1Curveseg}{Curveseg}}(seg,\ tlength));}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00241\ \ \ \ \ \_segs.insert(\_segs.begin()\ +\ ti,}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPiecewiseCurve_1_1Curveseg}{Curveseg}}(seg,\ \_segs[ti-\/1].\_tend\ +\ tlength));}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00246\ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00253\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_ab67e3e94dbe13f57327280c475b76374}{PiecewiseCurve::}}}
\DoxyCodeLine{00254\ \mbox{\hyperlink{classPiecewiseCurve_ab67e3e94dbe13f57327280c475b76374}{remove\_curveseg}}(\textcolor{keywordtype}{int}\ ti)\ \{}
\DoxyCodeLine{00255\ \ \ \textcolor{keywordflow}{if}\ (ti\ <\ 0\ ||\ ti\ >=\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00256\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00257\ \ \ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ PN\_stdfloat\ tlength\ =\ \mbox{\hyperlink{classPiecewiseCurve_a5fd9c4e6d0b795e2ba53710345f18108}{get\_tlength}}(ti);}
\DoxyCodeLine{00260\ \ \ \_segs.erase(\_segs.begin()\ +\ ti);}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{comment}{//\ Now\ update\ the\ \_tend\ figures\ for\ everything\ after\ the\ one\ we\ removed.}}
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{while}\ (ti\ <\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \_segs[ti].\_tend\ -\/=\ tlength;}
\DoxyCodeLine{00265\ \ \ \ \ ti++;}
\DoxyCodeLine{00266\ \ \ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \_last\_ti\ =\ 0;}
\DoxyCodeLine{00269\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00270\ \}}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00275\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPiecewiseCurve_a2285addec97b2b502823c468746a1bcf}{PiecewiseCurve::}}}
\DoxyCodeLine{00276\ \mbox{\hyperlink{classPiecewiseCurve_a2285addec97b2b502823c468746a1bcf}{remove\_all\_curvesegs}}()\ \{}
\DoxyCodeLine{00277\ \ \ \_segs.erase(\_segs.begin(),\ \_segs.end());}
\DoxyCodeLine{00278\ \ \ \_last\_ti\ =\ 0;}
\DoxyCodeLine{00279\ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00284\ PN\_stdfloat\ \mbox{\hyperlink{classPiecewiseCurve_a5fd9c4e6d0b795e2ba53710345f18108}{PiecewiseCurve::}}}
\DoxyCodeLine{00285\ \mbox{\hyperlink{classPiecewiseCurve_a5fd9c4e6d0b795e2ba53710345f18108}{get\_tlength}}(\textcolor{keywordtype}{int}\ ti)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00286\ \ \ assert(ti\ >=\ 0\ \&\&\ ti\ <\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{return}\ (ti==0)\ ?\ \_segs[ti].\_tend\ :\ \_segs[ti].\_tend\ -\/\ \_segs[ti-\/1].\_tend;}
\DoxyCodeLine{00288\ \}}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00293\ PN\_stdfloat\ \mbox{\hyperlink{classPiecewiseCurve_ab7cdf50dd96e3023a8e898a415050d83}{PiecewiseCurve::}}}
\DoxyCodeLine{00294\ \mbox{\hyperlink{classPiecewiseCurve_ab7cdf50dd96e3023a8e898a415050d83}{get\_tstart}}(\textcolor{keywordtype}{int}\ ti)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00295\ \ \ assert(ti\ >=\ 0\ \&\&\ ti\ <=\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{return}\ (ti==0)\ ?\ 0.0f\ :\ \_segs[ti-\/1].\_tend;}
\DoxyCodeLine{00297\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00302\ PN\_stdfloat\ \mbox{\hyperlink{classPiecewiseCurve_a400c32ffe31333632c4e4abb698ab2d7}{PiecewiseCurve::}}}
\DoxyCodeLine{00303\ \mbox{\hyperlink{classPiecewiseCurve_a400c32ffe31333632c4e4abb698ab2d7}{get\_tend}}(\textcolor{keywordtype}{int}\ ti)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00304\ \ \ assert(ti\ >=\ 0\ \&\&\ ti\ <\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00305\ \ \ \textcolor{keywordflow}{return}\ \_segs[ti].\_tend;}
\DoxyCodeLine{00306\ \}}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00314\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a89f4448cf0484743ca8358ce88bf5aa7}{PiecewiseCurve::}}}
\DoxyCodeLine{00315\ \mbox{\hyperlink{classPiecewiseCurve_a89f4448cf0484743ca8358ce88bf5aa7}{set\_tlength}}(\textcolor{keywordtype}{int}\ ti,\ PN\_stdfloat\ tlength)\ \{}
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{if}\ (ti\ <\ 0\ ||\ ti\ >=\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00318\ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \_segs[ti].\_tend\ +=\ tlength\ -\/\ \mbox{\hyperlink{classPiecewiseCurve_a5fd9c4e6d0b795e2ba53710345f18108}{get\_tlength}}(ti);}
\DoxyCodeLine{00321\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00322\ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00335\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPiecewiseCurve_ac20ef329059386bd843d84af3abae412}{PiecewiseCurve::}}}
\DoxyCodeLine{00336\ \mbox{\hyperlink{classPiecewiseCurve_ac20ef329059386bd843d84af3abae412}{make\_nurbs}}(\textcolor{keywordtype}{int}\ order,\ \textcolor{keywordtype}{int}\ num\_cvs,}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PN\_stdfloat\ knots[],\ \textcolor{keyword}{const}\ LVecBase4\ cvs[])\ \{}
\DoxyCodeLine{00338\ \ \ \mbox{\hyperlink{classPiecewiseCurve_a2285addec97b2b502823c468746a1bcf}{remove\_all\_curvesegs}}();}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;\ i<num\_cvs\ -\/\ order\ +\ 1;\ i++)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordflow}{if}\ (knots[i+order]\ >\ knots[i+order-\/1])\ \{}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ ti\ =\ \mbox{\hyperlink{classPiecewiseCurve_abc81107fd1e28740785e4c77c49b6bc1}{get\_num\_segs}}();}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ result\ =}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPiecewiseCurve_a48baebb91ee706378a45a3dd07b15aa7}{insert\_curveseg}}(ti,\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classCubicCurveseg}{CubicCurveseg}}(order,\ knots+i,\ cvs+i),}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ knots[i+order]\ -\/\ knots[i+order-\/1]);}
\DoxyCodeLine{00346\ \ \ \ \ \ \ assert(result);}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ \ \ \}}
\DoxyCodeLine{00349\ \}}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00357\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a77c93e2528f951046cf74de964a3449e}{PiecewiseCurve::}}}
\DoxyCodeLine{00358\ \mbox{\hyperlink{classPiecewiseCurve_a77c93e2528f951046cf74de964a3449e}{get\_bezier\_segs}}(\mbox{\hyperlink{classpvector}{BezierSegs}}\ \&bz\_segs)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00359\ \ \ bz\_segs.erase(bz\_segs.begin(),\ bz\_segs.end());}
\DoxyCodeLine{00360\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00361\ \ \ \mbox{\hyperlink{structParametricCurve_1_1BezierSeg}{BezierSeg}}\ seg;}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ (int)\_segs.size();\ i++)\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_segs[i].\_curve-\/>get\_bezier\_seg(seg))\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00365\ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ seg.\_t\ =\ \_segs[i].\_tend;}
\DoxyCodeLine{00367\ \ \ \ \ bz\_segs.push\_back(seg);}
\DoxyCodeLine{00368\ \ \ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00371\ \}}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00379\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_aa9aa64f0ca05db94251f8bc9375cf9a5}{PiecewiseCurve::}}}
\DoxyCodeLine{00380\ \mbox{\hyperlink{classPiecewiseCurve_aa9aa64f0ca05db94251f8bc9375cf9a5}{rebuild\_curveseg}}(\textcolor{keywordtype}{int},\ PN\_stdfloat,\ \textcolor{keyword}{const}\ LVecBase4\ \&,}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int},\ PN\_stdfloat,\ \textcolor{keyword}{const}\ LVecBase4\ \&,}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int},\ PN\_stdfloat,\ \textcolor{keyword}{const}\ LVecBase4\ \&,}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int},\ PN\_stdfloat,\ \textcolor{keyword}{const}\ LVecBase4\ \&)\ \{}
\DoxyCodeLine{00384\ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}rebuild\_curveseg\ not\ implemented\ for\ this\ curve\ type.\(\backslash\)n"{}};}
\DoxyCodeLine{00385\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00386\ \}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00395\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{PiecewiseCurve::}}}
\DoxyCodeLine{00396\ \mbox{\hyperlink{classPiecewiseCurve_a1dc3e24890f49c5e85ae749f4ab4991f}{find\_curve}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classParametricCurve}{ParametricCurve}}\ *\&curve,\ PN\_stdfloat\ \&t)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00397\ \ \ \textcolor{comment}{//\ Check\ the\ index\ computed\ by\ the\ last\ call\ to\ find\_curve().\ \ If\ it's\ still}}
\DoxyCodeLine{00398\ \ \ \textcolor{comment}{//\ a\ reasonable\ starting\ value,\ start\ searching\ from\ there.\ \ This\ way,\ we}}
\DoxyCodeLine{00399\ \ \ \textcolor{comment}{//\ take\ advantage\ of\ locality\ of\ reference:\ the\ search\ is\ trivial\ it\ is\ the}}
\DoxyCodeLine{00400\ \ \ \textcolor{comment}{//\ same\ segment\ as\ last\ time,\ or\ the\ next\ segment\ after\ the\ last\ one.}}
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{if}\ (\_last\_ti>0\ \&\&\ \_segs[\_last\_ti-\/1].\_tend>=t)\ \{}
\DoxyCodeLine{00402\ \ \ \ \ \textcolor{comment}{//\ However,\ if\ the\ new\ t\ value\ precedes\ that\ of\ last\ time,\ we'll\ have\ to}}
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{comment}{//\ start\ over.}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \textcolor{comment}{//\ We\ do\ some\ messy\ casting\ so\ we\ can\ get\ away\ with\ assigning\ a\ value\ to\ a}}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{comment}{//\ member\ within\ a\ const\ function.\ \ This\ assignment\ doesn't\ really\ count}}
\DoxyCodeLine{00407\ \ \ \ \ \textcolor{comment}{//\ as\ a\ const\ violation\ since\ we're\ just\ updating\ a\ cached\ value,\ not}}
\DoxyCodeLine{00408\ \ \ \ \ \textcolor{comment}{//\ changing\ any\ real\ data\ of\ the\ class.}}
\DoxyCodeLine{00409\ \ \ \ \ ((\mbox{\hyperlink{classPiecewiseCurve}{PiecewiseCurve}}\ *)\textcolor{keyword}{this})-\/>\_last\_ti\ =\ 0;}
\DoxyCodeLine{00410\ \ \ \}}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \textcolor{keywordtype}{int}\ ti;}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_last\_ti;\ ti\ <\ (int)\_segs.size();\ ti++)\ \{}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_segs[ti].\_tend+0.00001f\ >\ t)\ \{}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00416\ \ \ \ \ \}}
\DoxyCodeLine{00417\ \ \ \}}
\DoxyCodeLine{00418\ }
\DoxyCodeLine{00419\ \ \ \textcolor{keywordflow}{if}\ (ti\ <\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ Adjust\ t\ to\ the\ range\ [0,1).}}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{if}\ (ti\ >\ 0)\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ t\ =\ (t\ -\/\ \_segs[ti-\/1].\_tend)\ /\ (\_segs[ti].\_tend\ -\/\ \_segs[ti-\/1].\_tend);}
\DoxyCodeLine{00423\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00424\ \ \ \ \ \ \ t\ /=\ \_segs[0].\_tend;}
\DoxyCodeLine{00425\ \ \ \ \ \}}
\DoxyCodeLine{00426\ \ \ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{if}\ (t\ <\ 0)\ \{}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{comment}{//\ Oops.}}
\DoxyCodeLine{00430\ \ \ \ \ curve\ =\ \_segs[0].\_curve;}
\DoxyCodeLine{00431\ \ \ \ \ t\ =\ 0.0f;}
\DoxyCodeLine{00432\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00433\ \ \ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{if}\ (ti\ >=\ (\textcolor{keywordtype}{int})\_segs.size()\ ||\ !\_segs[ti].\_curve-\/>is\_valid())\ \{}
\DoxyCodeLine{00436\ \ \ \ \ assert(ti\ <=\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ out\ of\ bounds,\ or\ the\ curve\ is\ undefined,\ we're\ probably}}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{comment}{//\ screwed.\ \ There's\ one\ exception:\ if\ we\ were\ right\ on\ a\ border\ between}}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{comment}{//\ curves,\ try\ the\ curve\ before.}}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \ \ \textcolor{keywordflow}{if}\ (ti\ >\ 0\ \&\&\ t\ <\ \_segs[ti-\/1].\_tend+0.0001f)\ \{}
\DoxyCodeLine{00443\ \ \ \ \ \ \ ti-\/-\/;}
\DoxyCodeLine{00444\ \ \ \ \ \ \ t\ =\ 1.0f;}
\DoxyCodeLine{00445\ \ \ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keywordflow}{if}\ (ti\ >=\ (\textcolor{keywordtype}{int})\_segs.size())\ \{}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_segs.empty())\ \{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ curve\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ t\ =\ 0.0f;}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ curve\ =\ \_segs.back().\_curve;}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ t\ =\ 1.0f;}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00457\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!\_segs[ti].\_curve-\/>is\_valid())\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \ \ curve\ =\ \_segs[ti].\_curve;}
\DoxyCodeLine{00459\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00460\ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \textcolor{comment}{//\ Again,\ some\ messy\ casting\ so\ we\ can\ get\ away\ with\ updating\ the\ cached}}
\DoxyCodeLine{00464\ \ \ \textcolor{comment}{//\ index\ value\ for\ next\ time.}}
\DoxyCodeLine{00465\ \ \ ((\mbox{\hyperlink{classPiecewiseCurve}{PiecewiseCurve}}\ *)\textcolor{keyword}{this})-\/>\_last\_ti\ =\ ti;}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \textcolor{comment}{//\ Now\ scale\ t\ back\ into\ the\ curve's\ own\ valid\ range.}}
\DoxyCodeLine{00468\ \ \ t\ *=\ \_segs[ti].\_curve-\/>get\_max\_t();}
\DoxyCodeLine{00469\ \ \ curve\ =\ \_segs[ti].\_curve;}
\DoxyCodeLine{00470\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00471\ \}}
\DoxyCodeLine{00472\ }
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00484\ PN\_stdfloat\ \mbox{\hyperlink{classPiecewiseCurve_af638d57c43cb17d880d149e13ca19f35}{PiecewiseCurve::}}}
\DoxyCodeLine{00485\ \mbox{\hyperlink{classPiecewiseCurve_af638d57c43cb17d880d149e13ca19f35}{current\_seg\_range}}(PN\_stdfloat\ t)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordtype}{int}\ ti\ =\ \_last\_ti;}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ assert(ti\ <\ (\textcolor{keywordtype}{int})\_segs.size());}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \ \ \textcolor{comment}{//\ Adjust\ t\ to\ the\ range\ [0,1).}}
\DoxyCodeLine{00491\ \ \ \textcolor{keywordflow}{if}\ (ti\ >\ 0)\ \{}
\DoxyCodeLine{00492\ \ \ \ \ t\ =\ (t\ -\/\ \_segs[ti-\/1].\_tend)\ /\ (\_segs[ti].\_tend\ -\/\ \_segs[ti-\/1].\_tend);}
\DoxyCodeLine{00493\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00494\ \ \ \ \ t\ /=\ \_segs[0].\_tend;}
\DoxyCodeLine{00495\ \ \ \}}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{return}\ t;}
\DoxyCodeLine{00498\ \}}
\DoxyCodeLine{00499\ }
\DoxyCodeLine{00504\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPiecewiseCurve_adc473c7e21b8bf4ec3799e428fe1f406}{PiecewiseCurve::}}}
\DoxyCodeLine{00505\ \mbox{\hyperlink{classPiecewiseCurve_adc473c7e21b8bf4ec3799e428fe1f406}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&me)\ \{}
\DoxyCodeLine{00506\ \ \ \mbox{\hyperlink{classParametricCurve_ad9e07d824908e0ed361c8db20fbe54ce}{ParametricCurve::write\_datagram}}(manager,\ me);}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ me.add\_uint32(\_segs.size());}
\DoxyCodeLine{00509\ \ \ \textcolor{keywordtype}{size\_t}\ i;}
\DoxyCodeLine{00510\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \_segs.size();\ i++)\ \{}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPiecewiseCurve_1_1Curveseg}{Curveseg}}\ \&seg\ =\ \_segs[i];}
\DoxyCodeLine{00512\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(me,\ seg.\_curve);}
\DoxyCodeLine{00513\ \ \ \ \ me.add\_float64(seg.\_tend);}
\DoxyCodeLine{00514\ \ \ \}}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00516\ \ \ \_last\_ti\ =\ 0;}
\DoxyCodeLine{00517\ \}}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00524\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPiecewiseCurve_a4a6852ec6877326f4ee99dc6a222d2fb}{PiecewiseCurve::}}}
\DoxyCodeLine{00525\ \mbox{\hyperlink{classPiecewiseCurve_a4a6852ec6877326f4ee99dc6a222d2fb}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00526\ \ \ \mbox{\hyperlink{classParametricCurve_aa51af67f91e4da4d0a9ba3b4a86eddad}{ParametricCurve::fillin}}(scan,\ manager);}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \textcolor{keywordtype}{size\_t}\ num\_segs\ =\ scan.get\_uint32();}
\DoxyCodeLine{00529\ \ \ \_segs.reserve(num\_segs);}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordtype}{size\_t}\ i;}
\DoxyCodeLine{00531\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_segs;\ i++)\ \{}
\DoxyCodeLine{00532\ \ \ \ \ \mbox{\hyperlink{classPiecewiseCurve_1_1Curveseg}{Curveseg}}\ seg;}
\DoxyCodeLine{00533\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);}
\DoxyCodeLine{00534\ \ \ \ \ seg.\_curve\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00535\ \ \ \ \ seg.\_tend\ =\ scan.get\_float64();}
\DoxyCodeLine{00536\ \ \ \ \ \_segs.push\_back(seg);}
\DoxyCodeLine{00537\ \ \ \}}
\DoxyCodeLine{00538\ \}}
\DoxyCodeLine{00539\ }
\DoxyCodeLine{00544\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPiecewiseCurve_aa3c86ae0c2074836ddbd0ed6ea5c4c92}{PiecewiseCurve::}}}
\DoxyCodeLine{00545\ \mbox{\hyperlink{classPiecewiseCurve_aa3c86ae0c2074836ddbd0ed6ea5c4c92}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00546\ \ \ \textcolor{keywordtype}{int}\ used\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{ParametricCurve::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \textcolor{keywordtype}{size\_t}\ i;}
\DoxyCodeLine{00549\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ \_segs.size();\ i++)\ \{}
\DoxyCodeLine{00550\ \ \ \ \ \_segs[i].\_curve\ =\ DCAST(\mbox{\hyperlink{classParametricCurve}{ParametricCurve}},\ p\_list[used\ +\ i]);}
\DoxyCodeLine{00551\ \ \ \}}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \textcolor{keywordflow}{return}\ used\ +\ \_segs.size();}
\DoxyCodeLine{00554\ \}}

\end{DoxyCode}
