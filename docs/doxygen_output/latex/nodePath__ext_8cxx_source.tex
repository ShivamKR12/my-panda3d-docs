\doxysection{node\+Path\+\_\+ext.\+cxx}
\hypertarget{nodePath__ext_8cxx_source}{}\label{nodePath__ext_8cxx_source}\index{panda/src/pgraph/nodePath\_ext.cxx@{panda/src/pgraph/nodePath\_ext.cxx}}
\mbox{\hyperlink{nodePath__ext_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nodePath__ext_8h}{nodePath\_ext.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{typedWritable__ext_8h}{typedWritable\_ext.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shaderInput__ext_8h}{shaderInput\_ext.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{shaderAttrib_8h}{shaderAttrib.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{collisionNode_8h}{collisionNode.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#ifdef\ HAVE\_PYTHON}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#ifndef\ CPPPARSER}}
\DoxyCodeLine{00023\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_BamWriter;}
\DoxyCodeLine{00024\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_BamReader;}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#ifdef\ STDFLOAT\_DOUBLE}}
\DoxyCodeLine{00026\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_LPoint3d;}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00028\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_LPoint3f;}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00030\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_NodePath;}
\DoxyCodeLine{00031\ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_PandaNode;}
\DoxyCodeLine{00032\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ CPPPARSER}}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00039\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00040\ \mbox{\hyperlink{classExtension}{\_\_copy\_\_}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00041\ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>is\_empty())\ \{}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ Invoke\ the\ copy\ constructor\ if\ we\ have\ no\ node.}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{return}\ *\_this;}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ If\ we\ do\ have\ a\ node,\ duplicate\ it,\ and\ wrap\ it\ in\ a\ new\ NodePath.}}
\DoxyCodeLine{00047\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classNodePath}{NodePath}}(\mbox{\hyperlink{extension_8h_a529cfb9a4ffc54461b6562c168c11824}{invoke\_extension}}(\_this-\/>node()).\_\_copy\_\_());}
\DoxyCodeLine{00048\ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00055\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00056\ \mbox{\hyperlink{classExtension}{\_\_deepcopy\_\_}}(PyObject\ *self,\ PyObject\ *memo)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{extern}\ \textcolor{keyword}{struct\ }Dtool\_PyTypedObject\ Dtool\_NodePath;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \textcolor{comment}{//\ Borrowed\ reference.}}
\DoxyCodeLine{00060\ \ \ PyObject\ *dupe;}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordflow}{if}\ (PyDict\_GetItemRef(memo,\ self,\ \&dupe)\ >\ 0)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{comment}{//\ Already\ in\ the\ memo\ dictionary.}}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{return}\ dupe;}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ *np\_dupe;}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>is\_empty())\ \{}
\DoxyCodeLine{00068\ \ \ \ \ np\_dupe\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classNodePath}{NodePath}}(*\_this);}
\DoxyCodeLine{00069\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00070\ \ \ \ \ np\_dupe\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classNodePath}{NodePath}}(\_this-\/>copy\_to(\mbox{\hyperlink{classNodePath}{NodePath}}()));}
\DoxyCodeLine{00071\ \ \ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ dupe\ =\ DTool\_CreatePyInstance((\textcolor{keywordtype}{void}\ *)np\_dupe,\ Dtool\_NodePath,}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00075\ \ \ \textcolor{keywordflow}{if}\ (PyDict\_SetItem(memo,\ self,\ dupe)\ !=\ 0)\ \{}
\DoxyCodeLine{00076\ \ \ \ \ Py\_DECREF(dupe);}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00078\ \ \ \}}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \textcolor{keywordflow}{return}\ dupe;}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00090\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00091\ \mbox{\hyperlink{classExtension}{\_\_reduce\_\_}}(PyObject\ *self)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00092\ \ \ \textcolor{keywordflow}{return}\ \_\_reduce\_persist\_\_(self,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00104\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00105\ \mbox{\hyperlink{classExtension}{\_\_reduce\_persist\_\_}}(PyObject\ *self,\ PyObject\ *pickler)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00106\ \ \ \textcolor{comment}{//\ We\ should\ return\ at\ least\ a\ 2-\/tuple,\ (Class,\ (args)):\ the\ necessary\ class}}
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{//\ object\ whose\ constructor\ we\ should\ call\ (e.g.\ \ this),\ and\ the\ arguments}}
\DoxyCodeLine{00108\ \ \ \textcolor{comment}{//\ necessary\ to\ reconstruct\ this\ object.}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \mbox{\hyperlink{classBamWriter}{BamWriter}}\ *writer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{if}\ (pickler\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00112\ \ \ \ \ PyObject\ *py\_writer\ =\ PyObject\_GetAttrString(pickler,\ \textcolor{stringliteral}{"{}bamWriter"{}});}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordflow}{if}\ (py\_writer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ OK\ if\ there's\ no\ bamWriter.}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ PyErr\_Clear();}
\DoxyCodeLine{00116\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00117\ \ \ \ \ \ \ DtoolInstance\_GetPointer(py\_writer,\ writer,\ Dtool\_BamWriter);}
\DoxyCodeLine{00118\ \ \ \ \ \ \ Py\_DECREF(py\_writer);}
\DoxyCodeLine{00119\ \ \ \ \ \}}
\DoxyCodeLine{00120\ \ \ \}}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{comment}{//\ We\ have\ a\ non-\/empty\ NodePath.}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ vector\_uchar\ bam\_stream;}
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{if}\ (!\_this-\/>encode\_to\_bam\_stream(bam\_stream,\ writer))\ \{}
\DoxyCodeLine{00126\ \ \ \ \ \mbox{\hyperlink{classstd_1_1ostringstream}{std::ostringstream}}\ stream;}
\DoxyCodeLine{00127\ \ \ \ \ stream\ <<\ \textcolor{stringliteral}{"{}Could\ not\ bamify\ "{}}\ <<\ \_this;}
\DoxyCodeLine{00128\ \ \ \ \ std::string\ message\ =\ stream.str();}
\DoxyCodeLine{00129\ \ \ \ \ PyErr\_SetString(PyExc\_TypeError,\ message.c\_str());}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{comment}{//\ Start\ by\ getting\ this\ class\ object.}}
\DoxyCodeLine{00134\ \ \ PyObject\ *this\_class\ =\ (PyObject\ *)Py\_TYPE(self);}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (this\_class\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ PyObject\ *func;}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordflow}{if}\ (writer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{comment}{//\ The\ modified\ pickle\ support:\ call\ the\ "{}persistent"{}\ version\ of\ this}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ function,\ which\ receives\ the\ unpickler\ itself\ as\ an\ additional}}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{comment}{//\ parameter.}}
\DoxyCodeLine{00144\ \ \ \ \ func\ =\ \mbox{\hyperlink{classExtension}{Extension<TypedWritable>::find\_global\_decode}}(this\_class,\ \textcolor{stringliteral}{"{}py\_decode\_NodePath\_from\_bam\_stream\_persist"{}});}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{if}\ (func\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ PyErr\_SetString(PyExc\_TypeError,\ \textcolor{stringliteral}{"{}Couldn't\ find\ py\_decode\_NodePath\_from\_bam\_stream\_persist()"{}});}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00148\ \ \ \ \ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ The\ traditional\ pickle\ support:\ call\ the\ non-\/persistent\ version\ of\ this}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ function.}}
\DoxyCodeLine{00153\ \ \ \ \ func\ =\ \mbox{\hyperlink{classExtension}{Extension<TypedWritable>::find\_global\_decode}}(this\_class,\ \textcolor{stringliteral}{"{}py\_decode\_NodePath\_from\_bam\_stream"{}});}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{keywordflow}{if}\ (func\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00155\ \ \ \ \ \ \ PyErr\_SetString(PyExc\_TypeError,\ \textcolor{stringliteral}{"{}Couldn't\ find\ py\_decode\_NodePath\_from\_bam\_stream()"{}});}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00157\ \ \ \ \ \}}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \textcolor{comment}{//\ PyTuple\_SET\_ITEM\ conveniently\ borrows\ the\ reference\ it\ is\ passed.}}
\DoxyCodeLine{00161\ \ \ PyObject\ *args\ =\ PyTuple\_New(1);}
\DoxyCodeLine{00162\ \ \ PyTuple\_SET\_ITEM(args,\ 0,\ Dtool\_WrapValue(bam\_stream));}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \ \ PyObject\ *tuple\ =\ PyTuple\_New(2);}
\DoxyCodeLine{00165\ \ \ PyTuple\_SET\_ITEM(tuple,\ 0,\ func);}
\DoxyCodeLine{00166\ \ \ PyTuple\_SET\_ITEM(tuple,\ 1,\ args);}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{return}\ tuple;}
\DoxyCodeLine{00168\ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00173\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00174\ \mbox{\hyperlink{classExtension}{get\_tags}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00175\ \ \ \textcolor{comment}{//\ An\ empty\ NodePath\ returns\ None}}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>is\_empty())\ \{}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{return}\ Py\_NewRef(Py\_None);}
\DoxyCodeLine{00178\ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{comment}{//\ Just\ call\ PandaNode.tags\ rather\ than\ defining\ a\ whole\ new\ interface.}}
\DoxyCodeLine{00181\ \ \ PT(\mbox{\hyperlink{classPandaNode}{PandaNode}})\ node\ =\ \_this-\/>node();}
\DoxyCodeLine{00182\ \ \ PyObject\ *py\_node\ =\ DTool\_CreatePyInstanceTyped}
\DoxyCodeLine{00183\ \ \ \ \ ((\textcolor{keywordtype}{void}\ *)node.p(),\ Dtool\_PandaNode,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false},\ node-\/>get\_type\_index());}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \textcolor{comment}{//\ DTool\_CreatePyInstanceTyped()\ steals\ a\ C++\ reference.}}
\DoxyCodeLine{00186\ \ \ node.cheat()\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ PyObject\ *result\ =\ PyObject\_GetAttrString(py\_node,\ \textcolor{stringliteral}{"{}tags"{}});}
\DoxyCodeLine{00189\ \ \ Py\_DECREF(py\_node);}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00191\ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00198\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00199\ \mbox{\hyperlink{classExtension}{find\_net\_python\_tag}}(PyObject\ *key)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00200\ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>is\_empty())\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{return}\ NodePath::not\_found();}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ \ \ \textcolor{keywordflow}{if}\ (has\_python\_tag(key))\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{keywordflow}{return}\ *\_this;}
\DoxyCodeLine{00205\ \ \ \}}
\DoxyCodeLine{00206\ \ \ \mbox{\hyperlink{classNodePath}{NodePath}}\ parent\ =\ \_this-\/>get\_parent();}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{extension_8h_a529cfb9a4ffc54461b6562c168c11824}{invoke\_extension}}(\&parent).find\_net\_python\_tag(key);}
\DoxyCodeLine{00208\ \}}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00213\ \mbox{\hyperlink{classNodePath}{NodePath}}}
\DoxyCodeLine{00214\ py\_decode\_NodePath\_from\_bam\_stream(vector\_uchar\ data)\ \{}
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{return}\ py\_decode\_NodePath\_from\_bam\_stream\_persist(\textcolor{keyword}{nullptr},\ std::move(data));}
\DoxyCodeLine{00216\ \}}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00221\ \mbox{\hyperlink{classNodePath}{NodePath}}}
\DoxyCodeLine{00222\ py\_decode\_NodePath\_from\_bam\_stream\_persist(PyObject\ *unpickler,\ vector\_uchar\ data)\ \{}
\DoxyCodeLine{00223\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *reader\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{if}\ (unpickler\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00225\ \ \ \ \ PyObject\ *py\_reader\ =\ PyObject\_GetAttrString(unpickler,\ \textcolor{stringliteral}{"{}bamReader"{}});}
\DoxyCodeLine{00226\ \ \ \ \ \textcolor{keywordflow}{if}\ (py\_reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ OK\ if\ there's\ no\ bamReader.}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ PyErr\_Clear();}
\DoxyCodeLine{00229\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00230\ \ \ \ \ \ \ DtoolInstance\_GetPointer(py\_reader,\ reader,\ Dtool\_BamReader);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ Py\_DECREF(py\_reader);}
\DoxyCodeLine{00232\ \ \ \ \ \}}
\DoxyCodeLine{00233\ \ \ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classNodePath_ab0621ac710c5d46b05839ae3ac98dd28}{NodePath::decode\_from\_bam\_stream}}(std::move(data),\ reader);}
\DoxyCodeLine{00236\ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00241\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00242\ \mbox{\hyperlink{classExtension}{set\_shader\_input}}(\mbox{\hyperlink{classCPT__InternalName}{CPT\_InternalName}}\ name,\ PyObject\ *value,\ \textcolor{keywordtype}{int}\ priority)\ \{}
\DoxyCodeLine{00243\ \ \ PT(\mbox{\hyperlink{classPandaNode}{PandaNode}})\ node\ =\ \_this-\/>node();}
\DoxyCodeLine{00244\ \ \ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ prev\_attrib\ =\ node-\/>get\_attrib(ShaderAttrib::get\_class\_slot());}
\DoxyCodeLine{00245\ \ \ PT(\mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}})\ attrib;}
\DoxyCodeLine{00246\ \ \ \textcolor{keywordflow}{if}\ (prev\_attrib\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00247\ \ \ \ \ attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}();}
\DoxyCodeLine{00248\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00249\ \ \ \ \ attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}(*(\textcolor{keyword}{const}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}\ *)prev\_attrib.p());}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{classShaderInput}{ShaderInput}}\ \&input\ =\ attrib-\/>\_inputs[name];}
\DoxyCodeLine{00253\ \ \ \mbox{\hyperlink{extension_8h_a529cfb9a4ffc54461b6562c168c11824}{invoke\_extension}}(\&input).\_\_init\_\_(std::move(name),\ value,\ priority);}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00255\ \ \ \textcolor{keywordflow}{if}\ (!PyErr\_Occurred())\ \{}
\DoxyCodeLine{00256\ \ \ \ \ node-\/>set\_attrib(ShaderAttrib::return\_new(attrib));}
\DoxyCodeLine{00257\ \ \ \}}
\DoxyCodeLine{00258\ \}}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00264\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00265\ \mbox{\hyperlink{classExtension}{set\_shader\_inputs}}(PyObject\ *args,\ PyObject\ *kwargs)\ \{}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordflow}{if}\ (PyObject\_Size(args)\ >\ 0)\ \{}
\DoxyCodeLine{00267\ \ \ \ \ Dtool\_Raise\_TypeError(\textcolor{stringliteral}{"{}NodePath.set\_shader\_inputs\ takes\ only\ keyword\ arguments"{}});}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00269\ \ \ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ PT(\mbox{\hyperlink{classPandaNode}{PandaNode}})\ node\ =\ \_this-\/>node();}
\DoxyCodeLine{00272\ \ \ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ prev\_attrib\ =\ node-\/>get\_attrib(ShaderAttrib::get\_class\_slot());}
\DoxyCodeLine{00273\ \ \ PT(\mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}})\ attrib;}
\DoxyCodeLine{00274\ \ \ \textcolor{keywordflow}{if}\ (prev\_attrib\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00275\ \ \ \ \ attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}();}
\DoxyCodeLine{00276\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00277\ \ \ \ \ attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}(*(\textcolor{keyword}{const}\ \mbox{\hyperlink{classShaderAttrib}{ShaderAttrib}}\ *)prev\_attrib.p());}
\DoxyCodeLine{00278\ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ PyObject\ *key,\ *value;}
\DoxyCodeLine{00281\ \ \ Py\_ssize\_t\ pos\ =\ 0;}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ Py\_BEGIN\_CRITICAL\_SECTION(kwargs);}
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{while}\ (PyDict\_Next(kwargs,\ \&pos,\ \&key,\ \&value))\ \{}
\DoxyCodeLine{00285\ \ \ \ \ \textcolor{keywordtype}{char}\ *buffer;}
\DoxyCodeLine{00286\ \ \ \ \ Py\_ssize\_t\ length;}
\DoxyCodeLine{00287\ \ \ \ \ buffer\ =\ (\textcolor{keywordtype}{char}\ *)PyUnicode\_AsUTF8AndSize(key,\ \&length);}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{if}\ (buffer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00289\ \ \ \ \ \ \ Dtool\_Raise\_TypeError(\textcolor{stringliteral}{"{}NodePath.set\_shader\_inputs\ accepts\ only\ string\ keywords"{}});}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00291\ \ \ \ \ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \mbox{\hyperlink{classCPT__InternalName}{CPT\_InternalName}}\ name(std::string(buffer,\ length));}
\DoxyCodeLine{00294\ \ \ \ \ \mbox{\hyperlink{classShaderInput}{ShaderInput}}\ \&input\ =\ attrib-\/>\_inputs[name];}
\DoxyCodeLine{00295\ \ \ \ \ \mbox{\hyperlink{extension_8h_a529cfb9a4ffc54461b6562c168c11824}{invoke\_extension}}(\&input).\_\_init\_\_(std::move(name),\ value);}
\DoxyCodeLine{00296\ \ \ \}}
\DoxyCodeLine{00297\ \ \ Py\_END\_CRITICAL\_SECTION();}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00299\ \ \ \textcolor{keywordflow}{if}\ (!PyErr\_Occurred())\ \{}
\DoxyCodeLine{00300\ \ \ \ \ node-\/>set\_attrib(ShaderAttrib::return\_new(attrib));}
\DoxyCodeLine{00301\ \ \ \}}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00311\ PyObject\ *\mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00312\ \mbox{\hyperlink{classExtension}{get\_tight\_bounds}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classNodePath}{NodePath}}\ \&other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00313\ \ \ LPoint3\ *min\_point\ =\ \textcolor{keyword}{new}\ LPoint3;}
\DoxyCodeLine{00314\ \ \ LPoint3\ *max\_point\ =\ \textcolor{keyword}{new}\ LPoint3;}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \textcolor{keywordflow}{if}\ (\_this-\/>calc\_tight\_bounds(*min\_point,\ *max\_point,\ other))\ \{}
\DoxyCodeLine{00317\ \textcolor{preprocessor}{\#ifdef\ STDFLOAT\_DOUBLE}}
\DoxyCodeLine{00318\ \ \ \ \ PyObject\ *min\_inst\ =\ DTool\_CreatePyInstance((\textcolor{keywordtype}{void}*)\ min\_point,\ Dtool\_LPoint3d,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00319\ \ \ \ \ PyObject\ *max\_inst\ =\ DTool\_CreatePyInstance((\textcolor{keywordtype}{void}*)\ max\_point,\ Dtool\_LPoint3d,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00320\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00321\ \ \ \ \ PyObject\ *min\_inst\ =\ DTool\_CreatePyInstance((\textcolor{keywordtype}{void}*)\ min\_point,\ Dtool\_LPoint3f,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00322\ \ \ \ \ PyObject\ *max\_inst\ =\ DTool\_CreatePyInstance((\textcolor{keywordtype}{void}*)\ max\_point,\ Dtool\_LPoint3f,\ \textcolor{keyword}{true},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00323\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{return}\ Py\_BuildValue(\textcolor{stringliteral}{"{}NN"{}},\ min\_inst,\ max\_inst);}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \textcolor{keywordflow}{return}\ Py\_NewRef(Py\_None);}
\DoxyCodeLine{00328\ \ \ \}}
\DoxyCodeLine{00329\ \}}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00340\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00341\ \mbox{\hyperlink{classExtension}{set\_collide\_owner}}(PyObject\ *owner)\ \{}
\DoxyCodeLine{00342\ \ \ \textcolor{keywordflow}{if}\ (owner\ !=\ Py\_None)\ \{}
\DoxyCodeLine{00343\ \ \ \ \ PyObject\ *ref\ =\ PyWeakref\_NewRef(owner,\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00344\ \ \ \ \ \textcolor{keywordflow}{if}\ (ref\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ r\_set\_collide\_owner(\_this-\/>node(),\ ref);}
\DoxyCodeLine{00346\ \ \ \ \ \ \ Py\_DECREF(ref);}
\DoxyCodeLine{00347\ \ \ \ \ \}}
\DoxyCodeLine{00348\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00349\ \ \ \ \ r\_clear\_collide\_owner(\_this-\/>node());}
\DoxyCodeLine{00350\ \ \ \}}
\DoxyCodeLine{00351\ \}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00357\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00358\ \mbox{\hyperlink{classExtension}{r\_set\_collide\_owner}}(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *node,\ PyObject\ *weakref)\ \{}
\DoxyCodeLine{00359\ \ \ \textcolor{keywordflow}{if}\ (node-\/>\mbox{\hyperlink{classPandaNode_ab86095d2dc71d5bdfbd7685fc5f062e0}{is\_collision\_node}}())\ \{}
\DoxyCodeLine{00360\ \ \ \ \ \mbox{\hyperlink{classCollisionNode}{CollisionNode}}\ *cnode\ =\ (\mbox{\hyperlink{classCollisionNode}{CollisionNode}}\ *)node;}
\DoxyCodeLine{00361\ \ \ \ \ cnode-\/>set\_owner(Py\_NewRef(weakref),}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [](\textcolor{keywordtype}{void}\ *obj)\ \{\ Py\_DECREF((PyObject\ *)obj);\ \});}
\DoxyCodeLine{00363\ \ \ \}}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ PandaNode::Children\ cr\ =\ node-\/>get\_children();}
\DoxyCodeLine{00366\ \ \ \textcolor{keywordtype}{int}\ num\_children\ =\ cr.get\_num\_children();}
\DoxyCodeLine{00367\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_children;\ i++)\ \{}
\DoxyCodeLine{00368\ \ \ \ \ r\_set\_collide\_owner(cr.get\_child(i),\ weakref);}
\DoxyCodeLine{00369\ \ \ \}}
\DoxyCodeLine{00370\ \}}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00375\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classExtension}{Extension<NodePath>::}}}
\DoxyCodeLine{00376\ \mbox{\hyperlink{classExtension}{r\_clear\_collide\_owner}}(\mbox{\hyperlink{classPandaNode}{PandaNode}}\ *node)\ \{}
\DoxyCodeLine{00377\ \ \ \textcolor{keywordflow}{if}\ (node-\/>\mbox{\hyperlink{classPandaNode_ab86095d2dc71d5bdfbd7685fc5f062e0}{is\_collision\_node}}())\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \mbox{\hyperlink{classCollisionNode}{CollisionNode}}\ *cnode\ =\ (\mbox{\hyperlink{classCollisionNode}{CollisionNode}}\ *)node;}
\DoxyCodeLine{00379\ \ \ \ \ cnode-\/>\mbox{\hyperlink{classCollisionNode_ad40d01150a501e51af757624758b6318}{clear\_owner}}();}
\DoxyCodeLine{00380\ \ \ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \ \ PandaNode::Children\ cr\ =\ node-\/>get\_children();}
\DoxyCodeLine{00383\ \ \ \textcolor{keywordtype}{int}\ num\_children\ =\ cr.get\_num\_children();}
\DoxyCodeLine{00384\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_children;\ i++)\ \{}
\DoxyCodeLine{00385\ \ \ \ \ r\_clear\_collide\_owner(cr.get\_child(i));}
\DoxyCodeLine{00386\ \ \ \}}
\DoxyCodeLine{00387\ \}}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_PYTHON}}

\end{DoxyCode}
