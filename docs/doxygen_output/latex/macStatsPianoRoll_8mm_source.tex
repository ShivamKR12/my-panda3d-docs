\doxysection{mac\+Stats\+Piano\+Roll.\+mm}
\hypertarget{macStatsPianoRoll_8mm_source}{}\label{macStatsPianoRoll_8mm_source}\index{pandatool/src/mac-\/stats/macStatsPianoRoll.mm@{pandatool/src/mac-\/stats/macStatsPianoRoll.mm}}
\mbox{\hyperlink{macStatsPianoRoll_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsPianoRoll_8h}{macStatsPianoRoll.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsMonitor_8h}{macStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsLabelStack_8h}{macStatsLabelStack.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsScaleArea_8h}{macStatsScaleArea.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_piano\_roll\_width\ =\ 800;}
\DoxyCodeLine{00020\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_piano\_roll\_height\ =\ 400;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ minimum\_piano\_roll\_sidebar\_width\ =\ 68;}
\DoxyCodeLine{00023\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_piano\_roll\_sidebar\_width\ =\ 200;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ MacStatsPianoRoll::}
\DoxyCodeLine{00029\ MacStatsPianoRoll(\mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor,\ \textcolor{keywordtype}{int}\ thread\_index)\ :}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classPStatPianoRoll}{PStatPianoRoll}}(monitor,\ thread\_index,\ 0,\ 0),}
\DoxyCodeLine{00031\ \ \ \mbox{\hyperlink{classMacStatsGraph}{MacStatsGraph}}(monitor,\ [\mbox{\hyperlink{interfaceMacStatsScrollableGraphViewController}{MacStatsScrollableGraphViewController}}\ alloc])}
\DoxyCodeLine{00032\ \{}
\DoxyCodeLine{00033\ \ \ \textcolor{comment}{//\ Used\ for\ popup\ menus.}}
\DoxyCodeLine{00034\ \ \ \_menu\_delegate\ =\ [[\mbox{\hyperlink{interfaceMacStatsChartMenuDelegate}{MacStatsChartMenuDelegate}}\ alloc]\ initWithMonitor:monitor\ threadIndex:thread\_index];}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ Let's\ show\ the\ units\ on\ the\ guide\ bar\ labels.\ \ There's\ room.}}
\DoxyCodeLine{00037\ \ \ set\_guide\_bar\_units(get\_guide\_bar\_units()\ |\ GBU\_show\_units);}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatClientData}{PStatClientData}}\ *client\_data\ =}
\DoxyCodeLine{00040\ \ \ \ \ MacStatsGraph::\_monitor-\/>get\_client\_data();}
\DoxyCodeLine{00041\ \ \ std::string\ thread\_name\ =\ client\_data-\/>\mbox{\hyperlink{classPStatClientData_a5b905293fa940d70742612a4ec5a87f6}{get\_thread\_name}}(\_thread\_index);}
\DoxyCodeLine{00042\ \ \ std::string\ window\_title\ =\ thread\_name\ +\ \textcolor{stringliteral}{"{}\ thread\ piano\ roll"{}};}
\DoxyCodeLine{00043\ \ \ \_window.title\ =\ [NSString\ stringWithUTF8String:window\_title.c\_str()];}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \_window.titleVisibility\ =\ NSWindowTitleHidden;}
\DoxyCodeLine{00047\ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Set\ the\ initial\ size\ of\ the\ graph.}}
\DoxyCodeLine{00050\ \ \ \_graph\_view.frame\ =\ NSMakeRect(0,\ 0,\ default\_piano\_roll\_width,\ default\_piano\_roll\_height);}
\DoxyCodeLine{00051\ \ \ \_graph\_view\_controller.view.frame\ =\ NSMakeRect(0,\ 0,\ default\_piano\_roll\_width,\ default\_piano\_roll\_height);}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \textcolor{comment}{//\ It's\ put\ inside\ a\ scroll\ view\ that\ tracks\ the\ main\ scroll\ view.}}
\DoxyCodeLine{00054\ \ \ NSScrollView\ *scroll\_view\ =\ [[NSScrollView\ alloc]\ initWithFrame:NSMakeRect(0,\ 0,\ default\_piano\_roll\_sidebar\_width,\ 0)];}
\DoxyCodeLine{00055\ \ \ scroll\_view.documentView\ =\ \_label\_stack.get\_view();}
\DoxyCodeLine{00056\ \ \ scroll\_view.drawsBackground\ =\ NO;}
\DoxyCodeLine{00057\ \ \ scroll\_view.automaticallyAdjustsContentInsets\ =\ YES;}
\DoxyCodeLine{00058\ \ \ \textcolor{comment}{//scroll\_view.translatesAutoresizingMaskIntoConstraints\ =\ NO;}}
\DoxyCodeLine{00059\ \ \ scroll\_view.hasHorizontalScroller\ =\ NO;}
\DoxyCodeLine{00060\ \ \ scroll\_view.hasVerticalScroller\ =\ NO;}
\DoxyCodeLine{00061\ \ \ \_sidebar\_scroll\_view\ =\ scroll\_view;}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ NSNotificationCenter\ *center\ =\ [NSNotificationCenter\ defaultCenter];}
\DoxyCodeLine{00064\ \ \ [center\ addObserver:\_graph\_view\_controller}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ selector:\textcolor{keyword}{@selector}(handleSideScroll:)}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name:NSScrollViewDidLiveScrollNotification}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ object:scroll\_view];}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ NSViewController\ *sidebar\_controller\ =\ [[NSViewController\ alloc]\ init];}
\DoxyCodeLine{00070\ \ \ sidebar\_controller.view\ =\ scroll\_view;}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ NSSplitViewController\ *svc\ =\ [[NSSplitViewController\ alloc]\ init];}
\DoxyCodeLine{00073\ \ \ [svc\ addSplitViewItem:[NSSplitViewItem\ sidebarWithViewController:sidebar\_controller]];}
\DoxyCodeLine{00074\ \ \ [svc\ addSplitViewItem:[NSSplitViewItem\ splitViewItemWithViewController:\_graph\_view\_controller]];}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ svc.splitViewItems[0].minimumThickness\ =\ minimum\_piano\_roll\_sidebar\_width;}
\DoxyCodeLine{00077\ \ \ svc.splitViewItems[0].canCollapse\ =\ NO;}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ NSSplitView\ *split\_view\ =\ svc.splitView;}
\DoxyCodeLine{00080\ \ \ split\_view.vertical\ =\ YES;}
\DoxyCodeLine{00081\ \ \ split\_view.dividerStyle\ =\ NSSplitViewDividerStyleThin;}
\DoxyCodeLine{00082\ \ \ split\_view.autoresizingMask\ =\ NSViewWidthSizable\ |\ NSViewHeightSizable;}
\DoxyCodeLine{00083\ \ \ \_split\_view\ =\ split\_view;}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \_window.contentViewController\ =\ svc;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ [svc\ release];}
\DoxyCodeLine{00088\ \ \ [sidebar\_controller\ release];}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \textcolor{comment}{//\ Scale\ area\ goes\ on\ top,\ as\ a\ titlebar\ accessory\ view.}}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{interfaceMacStatsScaleAreaController}{MacStatsScaleAreaController}}\ *scale\_area\_controller\ =\ [[\mbox{\hyperlink{interfaceMacStatsScaleAreaController}{MacStatsScaleAreaController}}\ alloc]\ initWithGraph:\textcolor{keyword}{this}];}
\DoxyCodeLine{00092\ \ \ scale\_area\_controller.fullScreenMinHeight\ =\ 20;}
\DoxyCodeLine{00093\ \ \ scale\_area\_controller.layoutAttribute\ =\ NSLayoutAttributeRight;}
\DoxyCodeLine{00094\ \ \ \_scale\_area\ =\ scale\_area\_controller.view;}
\DoxyCodeLine{00095\ \ \ [\_window\ addTitlebarAccessoryViewController:scale\_area\_controller];}
\DoxyCodeLine{00096\ \ \ [scale\_area\_controller\ release];}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ [\_label\_stack.get\_view().widthAnchor\ constraintEqualToAnchor:scroll\_view.widthAnchor].active\ =\ YES;}
\DoxyCodeLine{00099\ \ \ [\_label\_stack.get\_view().heightAnchor\ constraintEqualToAnchor:\_graph\_view.heightAnchor].active\ =\ YES;}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ idle();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ [\_window\ makeKeyAndOrderFront:nil];}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00109\ MacStatsPianoRoll::}
\DoxyCodeLine{00110\ \string~MacStatsPianoRoll()\ \{}
\DoxyCodeLine{00111\ \ \ [\_sidebar\_scroll\_view\ release];}
\DoxyCodeLine{00112\ \ \ [\_menu\_delegate\ release];}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00121\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_af00d1c7c0325ea615deb8bce040b3a8e}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00122\ \mbox{\hyperlink{classMacStatsPianoRoll_af00d1c7c0325ea615deb8bce040b3a8e}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{if}\ (!\_pause)\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{classPStatPianoRoll_a59d660ffcd92e9e39f2d125e488ae61d}{update}}();}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ \}}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00131\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a7bf4a9cb636c8b9ad944f1c7fddfbdfd}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00132\ \mbox{\hyperlink{classMacStatsPianoRoll_a7bf4a9cb636c8b9ad944f1c7fddfbdfd}{force\_redraw}}()\ \{}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \mbox{\hyperlink{classPStatPianoRoll_a842d7ad73ea599746245b485caef6948}{PStatPianoRoll::force\_redraw}}();}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00141\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a5bc028a23bcdb14cf3cb7f585e731c1b}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00142\ \mbox{\hyperlink{classMacStatsPianoRoll_a5bc028a23bcdb14cf3cb7f585e731c1b}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00143\ \ \ \mbox{\hyperlink{classPStatPianoRoll_a66d2cc2ef8fb156af9978b09e81b1593}{PStatPianoRoll::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00144\ \}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00151\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_aa2843b8522247fdccc39184df422e64f}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00152\ \mbox{\hyperlink{classMacStatsPianoRoll_aa2843b8522247fdccc39184df422e64f}{set\_time\_units}}(\textcolor{keywordtype}{int}\ unit\_mask)\ \{}
\DoxyCodeLine{00153\ \ \ \textcolor{keywordtype}{int}\ old\_unit\_mask\ =\ get\_guide\_bar\_units();}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{if}\ ((old\_unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms))\ !=\ 0)\ \{}
\DoxyCodeLine{00155\ \ \ \ \ unit\_mask\ =\ unit\_mask\ \&\ (GBU\_hz\ |\ GBU\_ms);}
\DoxyCodeLine{00156\ \ \ \ \ unit\_mask\ |=\ (old\_unit\_mask\ \&\ GBU\_show\_units);}
\DoxyCodeLine{00157\ \ \ \ \ set\_guide\_bar\_units(unit\_mask);}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00164\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a82f6e8a5231f260fd32b234ba98434ce}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00165\ \mbox{\hyperlink{classMacStatsPianoRoll_a82f6e8a5231f260fd32b234ba98434ce}{on\_click\_label}}(\textcolor{keywordtype}{int}\ collector\_index)\ \{}
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00167\ \ \ \ \ MacStatsGraph::\_monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a94878306e9bedcf47dfda78cb9b2f1df}{open\_strip\_chart}}(\_thread\_index,\ collector\_index,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ \}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00175\ NSMenu\ *\mbox{\hyperlink{classMacStatsPianoRoll_abe1a593a7d17ec9c7735b345ef8fefe9}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00176\ \mbox{\hyperlink{classMacStatsPianoRoll_abe1a593a7d17ec9c7735b345ef8fefe9}{get\_label\_menu}}(\textcolor{keywordtype}{int}\ collector\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00177\ \ \ NSMenu\ *menu\ =\ [[[NSMenu\ alloc]\ init]\ autorelease];}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ std::string\ label\ =\ \mbox{\hyperlink{classMacStatsPianoRoll_a47045d511b1dc1dfd9d6ef60daf80e83}{get\_label\_tooltip}}(collector\_index);}
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 14.0,\ *))\ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ [menu\ addItem:[NSMenuItem\ sectionHeaderWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]]];}
\DoxyCodeLine{00183\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]\ action:nil\ keyEquivalent:\textcolor{stringliteral}{@"{}"{}}];}
\DoxyCodeLine{00185\ \ \ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00187\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00188\ \ \ \ \ \}}
\DoxyCodeLine{00189\ \ \ \}}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \{}
\DoxyCodeLine{00192\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:\textcolor{stringliteral}{@"{}Open\ Strip\ Chart"{}}\ action:\textcolor{keyword}{@selector}(handleOpenStripChart:)\ keyEquivalent:\textcolor{stringliteral}{@"{}"{}}];}
\DoxyCodeLine{00193\ \ \ \ \ item.target\ =\ \_menu\_delegate;}
\DoxyCodeLine{00194\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00195\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00196\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:\textcolor{stringliteral}{@"{}Open\ Flame\ Graph"{}}\ action:\textcolor{keyword}{@selector}(handleOpenFlameGraph:)\ keyEquivalent:\textcolor{stringliteral}{@"{}"{}}];}
\DoxyCodeLine{00201\ \ \ \ \ item.target\ =\ \_menu\_delegate;}
\DoxyCodeLine{00202\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00203\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00204\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00205\ \ \ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ [menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \{}
\DoxyCodeLine{00210\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:\textcolor{stringliteral}{@"{}Change\ Color\(\backslash\)u2026"{}}\ action:\textcolor{keyword}{@selector}(handleChangeColor:)\ keyEquivalent:\textcolor{stringliteral}{@"{}"{}}];}
\DoxyCodeLine{00211\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00212\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00213\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00214\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00215\ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \{}
\DoxyCodeLine{00218\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:\textcolor{stringliteral}{@"{}Reset\ Color"{}}\ action:\textcolor{keyword}{@selector}(handleResetColor:)\ keyEquivalent:\textcolor{stringliteral}{@"{}"{}}];}
\DoxyCodeLine{00219\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00220\ \ \ \ \ item.tag\ =\ collector\_index;}
\DoxyCodeLine{00221\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00222\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00223\ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordflow}{return}\ menu;}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00232\ std::string\ \mbox{\hyperlink{classMacStatsPianoRoll_a47045d511b1dc1dfd9d6ef60daf80e83}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00233\ \mbox{\hyperlink{classMacStatsPianoRoll_a47045d511b1dc1dfd9d6ef60daf80e83}{get\_label\_tooltip}}(\textcolor{keywordtype}{int}\ collector\_index)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatPianoRoll_ae65de5ce271954065ce5f257c1d55845}{PStatPianoRoll::get\_label\_tooltip}}(collector\_index);}
\DoxyCodeLine{00235\ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00241\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_ada9e3af9221b1f678c0bb289199122fb}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00242\ \mbox{\hyperlink{classMacStatsPianoRoll_ada9e3af9221b1f678c0bb289199122fb}{set\_horizontal\_scale}}(\textcolor{keywordtype}{double}\ time\_width)\ \{}
\DoxyCodeLine{00243\ \ \ PStatPianoRoll::set\_horizontal\_scale(time\_width);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \_graph\_view.needsDisplay\ =\ YES;}
\DoxyCodeLine{00246\ \}}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00251\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_ab63684da6fa1785345780a8a92e706cb}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00252\ \mbox{\hyperlink{classMacStatsPianoRoll_ab63684da6fa1785345780a8a92e706cb}{clear\_region}}()\ \{}
\DoxyCodeLine{00253\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ CGContextSetFillColorWithColor(\_ctx,\ \_background\_color);}
\DoxyCodeLine{00255\ \ \ \ \ CGContextFillRect(\_ctx,\ CGRectMake(0,\ 0,\ get\_xsize(),\ get\_ysize()));}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00262\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_ae3e851432844d2ee31eead810a4fe968}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00263\ \mbox{\hyperlink{classMacStatsPianoRoll_ae3e851432844d2ee31eead810a4fe968}{begin\_draw}}()\ \{}
\DoxyCodeLine{00264\ \ \ \mbox{\hyperlink{classMacStatsPianoRoll_ab63684da6fa1785345780a8a92e706cb}{clear\_region}}();}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{comment}{//\ Draw\ in\ the\ guide\ bars.}}
\DoxyCodeLine{00267\ \ \ CGContextSetStrokeColorWithColor(\_ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00268\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00269\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00270\ \ \ \ \ draw\_guide\_bar(\_ctx,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i),\ 0,\ get\_ysize());}
\DoxyCodeLine{00271\ \ \ \}}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00279\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a93efe711fc0210d791115cbc9564a947}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00280\ \mbox{\hyperlink{classMacStatsPianoRoll_a93efe711fc0210d791115cbc9564a947}{begin\_row}}(\textcolor{keywordtype}{int}\ row)\ \{}
\DoxyCodeLine{00281\ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_label\_collector(row);}
\DoxyCodeLine{00282\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ collector\_index\ ==\ \_highlighted\_index;}
\DoxyCodeLine{00283\ \ \ CGContextSetFillColorWithColor(\_ctx,}
\DoxyCodeLine{00284\ \ \ \ \ MacStatsGraph::\_monitor-\/>get\_collector\_color(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00285\ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00290\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a629f61c75465f1645b8b3435101cd0f3}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00291\ \mbox{\hyperlink{classMacStatsPianoRoll_a629f61c75465f1645b8b3435101cd0f3}{draw\_bar}}(\textcolor{keywordtype}{int}\ row,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x)\ \{}
\DoxyCodeLine{00292\ \ \ \textcolor{keywordflow}{if}\ (row\ >=\ 0\ \&\&\ row\ <\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a5e65e940be86dd012f99b3cf359eaef6}{get\_num\_labels}}())\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \textcolor{keywordtype}{int}\ y\ =\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_afdc015747b71c9c1a895c0ca206df378}{get\_label\_y}}(row,\ \_graph\_view);}
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{keywordtype}{int}\ height\ =\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_ab8a8ea9471e2255f7911e93dc6bdc13d}{get\_label\_height}}(row);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \ \ CGContextFillRect(\_ctx,\ CGRectMake(from\_x,\ (y\ -\/\ height\ +\ 2),\ to\_x\ -\/\ from\_x,\ (height\ -\/\ 4)));}
\DoxyCodeLine{00297\ \ \ \}}
\DoxyCodeLine{00298\ \}}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00304\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_ad76b98f071aaeea75b3f75d16cbe3100}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00305\ \mbox{\hyperlink{classMacStatsPianoRoll_ad76b98f071aaeea75b3f75d16cbe3100}{end\_draw}}()\ \{}
\DoxyCodeLine{00306\ \ \ \_graph\_view.needsDisplay\ =\ YES;}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ \textcolor{keywordflow}{if}\ (\_guide\_bars\_changed)\ \{}
\DoxyCodeLine{00309\ \ \ \ \ \_scale\_area.needsDisplay\ =\ YES;}
\DoxyCodeLine{00310\ \ \ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00311\ \ \ \}}
\DoxyCodeLine{00312\ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00317\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a4478f96eed4fd0068eeddce1bbea8d64}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00318\ \mbox{\hyperlink{classMacStatsPianoRoll_a4478f96eed4fd0068eeddce1bbea8d64}{idle}}()\ \{}
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{if}\ (\_labels\_changed)\ \{}
\DoxyCodeLine{00320\ \ \ \ \ update\_labels();}
\DoxyCodeLine{00321\ \ \ \}}
\DoxyCodeLine{00322\ \}}
\DoxyCodeLine{00323\ }
\DoxyCodeLine{00327\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsPianoRoll_ac55846052ccda96b0188f0e44b19dc00}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00328\ \mbox{\hyperlink{classMacStatsPianoRoll_ac55846052ccda96b0188f0e44b19dc00}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00330\ \ \ \mbox{\hyperlink{classMacStatsGraph_a524e8aa33f266e1e46227339bb7ac226}{MacStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00331\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00332\ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00337\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_ae1ddf2359d2823e9ab437bc2525491e2}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00338\ \mbox{\hyperlink{classMacStatsPianoRoll_ae1ddf2359d2823e9ab437bc2525491e2}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00340\ \ \ \mbox{\hyperlink{classMacStatsGraph_ae85ef8048bce18ca67658bb5e871f445}{MacStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00341\ \}}
\DoxyCodeLine{00342\ }
\DoxyCodeLine{00347\ NSMenu\ *\mbox{\hyperlink{classMacStatsPianoRoll_a40cbf76352aaed6ee1e739d8147b9d15}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00348\ \mbox{\hyperlink{classMacStatsPianoRoll_a40cbf76352aaed6ee1e739d8147b9d15}{get\_graph\_menu}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00349\ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_collector\_under\_pixel(mouse\_x,\ mouse\_y);}
\DoxyCodeLine{00350\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsPianoRoll_abe1a593a7d17ec9c7735b345ef8fefe9}{get\_label\_menu}}(collector\_index);}
\DoxyCodeLine{00352\ \ \ \}}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordflow}{return}\ nil;}
\DoxyCodeLine{00354\ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00360\ std::string\ \mbox{\hyperlink{classMacStatsPianoRoll_a53c1167180b2f9e10dfae96c3f889ae5}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00361\ \mbox{\hyperlink{classMacStatsPianoRoll_a53c1167180b2f9e10dfae96c3f889ae5}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00362\ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_collector\_under\_pixel(mouse\_x,\ mouse\_y);}
\DoxyCodeLine{00363\ \ \ \textcolor{keywordflow}{if}\ (collector\_index\ >=\ 0)\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsPianoRoll_a47045d511b1dc1dfd9d6ef60daf80e83}{get\_label\_tooltip}}(collector\_index);}
\DoxyCodeLine{00365\ \ \ \}}
\DoxyCodeLine{00366\ \ \ \textcolor{keywordflow}{return}\ std::string();}
\DoxyCodeLine{00367\ \}}
\DoxyCodeLine{00368\ }
\DoxyCodeLine{00374\ MacStatsGraph::DragMode\ \mbox{\hyperlink{classMacStatsPianoRoll_a19552fd948de8e07c7182b0c4556c0cc}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00375\ \mbox{\hyperlink{classMacStatsPianoRoll_a19552fd948de8e07c7182b0c4556c0cc}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00376\ \ \ \textcolor{keywordflow}{if}\ (graph\_y\ >=\ 0\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \textcolor{comment}{//\ See\ if\ the\ mouse\ is\ over\ a\ user-\/defined\ guide\ bar.}}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ graph\_x;}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ 2);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ 2);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ \mbox{\hyperlink{classPStatGraph_a27bac34846a7622cab2d7aa247fc570e}{find\_user\_guide\_bar}}(from\_height,\ to\_height);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_guide\_bar;}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ mouse\ is\ left\ or\ right\ of\ the\ graph;\ maybe\ create\ a\ new\ guide}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \textcolor{comment}{//\ bar.}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ DM\_new\_guide\_bar;}
\DoxyCodeLine{00391\ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_aa537e931eb258abdaa4134c05f96ec82}{MacStatsGraph::consider\_drag\_start}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00395\ \}}
\DoxyCodeLine{00396\ }
\DoxyCodeLine{00400\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a1732429f23490333c63b3e3cd09d79fc}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00401\ \mbox{\hyperlink{classMacStatsPianoRoll_a1732429f23490333c63b3e3cd09d79fc}{handle\_button\_press}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ double\_click,\ \textcolor{keywordtype}{int}\ button)\ \{}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00403\ \ \ \ \ \textcolor{keywordflow}{if}\ (double\_click\ \&\&\ button\ ==\ 1)\ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ is\ the\ same\ as\ double-\/}}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{comment}{//\ clicking\ on\ the\ corresponding\ label.}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \mbox{\hyperlink{classMacStatsPianoRoll_a82f6e8a5231f260fd32b234ba98434ce}{on\_click\_label}}(get\_collector\_under\_pixel(graph\_x,\ graph\_y));}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00408\ \ \ \ \ \}}
\DoxyCodeLine{00409\ \ \ \}}
\DoxyCodeLine{00410\ }
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_ae1afe8a971ae7386cdb1f7532044806f}{set\_drag\_mode}}(DM\_scale);}
\DoxyCodeLine{00413\ \ \ \ \ \_drag\_scale\_start\ =\ pixel\_to\_height(graph\_x);}
\DoxyCodeLine{00414\ \ \ \ \ \textcolor{comment}{//\ SetCapture(\_graph\_window);}}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00417\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_guide\_bar\ \&\&\ \_drag\_guide\_bar\ >=\ 0)\ \{}
\DoxyCodeLine{00418\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_ae1afe8a971ae7386cdb1f7532044806f}{set\_drag\_mode}}(DM\_guide\_bar);}
\DoxyCodeLine{00419\ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ SetCapture(\_graph\_window);}}
\DoxyCodeLine{00421\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00422\ \ \ \}}
\DoxyCodeLine{00423\ }
\DoxyCodeLine{00424\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a85679d6f09f08fbb700a91944568b4d5}{MacStatsGraph::handle\_button\_press}}(graph\_x,\ graph\_y,}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\_click,\ button);}
\DoxyCodeLine{00426\ \}}
\DoxyCodeLine{00427\ }
\DoxyCodeLine{00431\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a0e6cc0401d5c1b582dd7449ca4b0ecef}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00432\ \mbox{\hyperlink{classMacStatsPianoRoll_a0e6cc0401d5c1b582dd7449ca4b0ecef}{handle\_button\_release}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_scale)\ \{}
\DoxyCodeLine{00434\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_ae1afe8a971ae7386cdb1f7532044806f}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00435\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsPianoRoll_a2199ecdc455ec362c069bc6b094f9458}{handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00437\ \ \ \}}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ <\ 0\ ||\ graph\_x\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a7627d5e29b88196713f4ba3cea78ea17}{remove\_user\_guide\_bar}}(\_drag\_guide\_bar);}
\DoxyCodeLine{00441\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a45ecee227793ee5f2059e58f8d844ad8}{move\_user\_guide\_bar}}(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00443\ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_ae1afe8a971ae7386cdb1f7532044806f}{set\_drag\_mode}}(DM\_none);}
\DoxyCodeLine{00445\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsPianoRoll_a2199ecdc455ec362c069bc6b094f9458}{handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00447\ \ \ \}}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a0dd05ee8e330022b32393b3354f880a2}{MacStatsGraph::handle\_button\_release}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00450\ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00455\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a2199ecdc455ec362c069bc6b094f9458}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00456\ \mbox{\hyperlink{classMacStatsPianoRoll_a2199ecdc455ec362c069bc6b094f9458}{handle\_motion}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00458\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00459\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ get\_collector\_under\_pixel(graph\_x,\ graph\_y);}
\DoxyCodeLine{00460\ \ \ \ \ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a8197f33bd443942a356a08ccf6c1cb7e}{highlight\_label}}(collector\_index);}
\DoxyCodeLine{00461\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_a3538a83458f224131e7185c2bd73d123}{on\_enter\_label}}(collector\_index);}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00464\ \textcolor{comment}{\ \ \ \ //\ Now\ we\ want\ to\ get\ a\ WM\_MOUSELEAVE\ when\ the\ mouse\ leaves\ the\ graph}}
\DoxyCodeLine{00465\ \textcolor{comment}{\ \ \ \ //\ window.}}
\DoxyCodeLine{00466\ \textcolor{comment}{\ \ \ \ TRACKMOUSEEVENT\ tme\ =\ \{}}
\DoxyCodeLine{00467\ \textcolor{comment}{\ \ \ \ \ \ sizeof(TRACKMOUSEEVENT),}}
\DoxyCodeLine{00468\ \textcolor{comment}{\ \ \ \ \ \ TME\_LEAVE,}}
\DoxyCodeLine{00469\ \textcolor{comment}{\ \ \ \ \ \ \_graph\_window,}}
\DoxyCodeLine{00470\ \textcolor{comment}{\ \ \ \ \ \ 0}}
\DoxyCodeLine{00471\ \textcolor{comment}{\ \ \ \ \};}}
\DoxyCodeLine{00472\ \textcolor{comment}{\ \ \ \ TrackMouseEvent(\&tme);}}
\DoxyCodeLine{00473\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00474\ \ \ \}}
\DoxyCodeLine{00475\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \textcolor{comment}{//\ If\ the\ mouse\ is\ in\ some\ drag\ mode,\ stop\ highlighting.}}
\DoxyCodeLine{00477\ \ \ \ \ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a8197f33bd443942a356a08ccf6c1cb7e}{highlight\_label}}(-\/1);}
\DoxyCodeLine{00478\ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_aab45b9fe792e702b144a7fe8a5539e32}{on\_leave\_label}}(\_highlighted\_index);}
\DoxyCodeLine{00479\ \ \ \}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_scale)\ \{}
\DoxyCodeLine{00482\ \ \ \ \ \textcolor{keywordtype}{double}\ ratio\ =\ (double)graph\_x\ /\ (\textcolor{keywordtype}{double})get\_xsize();}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{if}\ (ratio\ >\ 0.0f)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \mbox{\hyperlink{classMacStatsPianoRoll_ada9e3af9221b1f678c0bb289199122fb}{set\_horizontal\_scale}}(\_drag\_scale\_start\ /\ ratio);}
\DoxyCodeLine{00485\ \ \ \ \ \}}
\DoxyCodeLine{00486\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00487\ \ \ \}}
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_new\_guide\_bar)\ \{}
\DoxyCodeLine{00489\ \ \ \ \ \textcolor{comment}{//\ We\ haven't\ created\ the\ new\ guide\ bar\ yet;\ we\ won't\ until\ the\ mouse}}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{comment}{//\ comes\ within\ the\ graph's\ region.}}
\DoxyCodeLine{00491\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00492\ \ \ \ \ \ \ \mbox{\hyperlink{classMacStatsGraph_ae1afe8a971ae7386cdb1f7532044806f}{set\_drag\_mode}}(DM\_guide\_bar);}
\DoxyCodeLine{00493\ \ \ \ \ \ \ \_drag\_guide\_bar\ =\ \mbox{\hyperlink{classPStatGraph_a3a7fc8b8eb05e7ff7a6f044ebee7035a}{add\_user\_guide\_bar}}(pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00495\ \ \ \ \ \}}
\DoxyCodeLine{00496\ }
\DoxyCodeLine{00497\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \mbox{\hyperlink{classPStatGraph_a45ecee227793ee5f2059e58f8d844ad8}{move\_user\_guide\_bar}}(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00500\ \ \ \}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a45e4a7c922f1a1cc97c413af0c9d3bfb}{MacStatsGraph::handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00503\ \}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00508\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a3d82016f4750a36b8661517c5ed8ff8c}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00509\ \mbox{\hyperlink{classMacStatsPianoRoll_a3d82016f4750a36b8661517c5ed8ff8c}{handle\_leave}}()\ \{}
\DoxyCodeLine{00510\ \ \ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a8197f33bd443942a356a08ccf6c1cb7e}{highlight\_label}}(-\/1);}
\DoxyCodeLine{00511\ \ \ \mbox{\hyperlink{classMacStatsGraph_aab45b9fe792e702b144a7fe8a5539e32}{on\_leave\_label}}(\_highlighted\_index);}
\DoxyCodeLine{00512\ \}}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00517\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_aa4910bb856019ca8e0905ea2194d33f4}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00518\ \mbox{\hyperlink{classMacStatsPianoRoll_aa4910bb856019ca8e0905ea2194d33f4}{handle\_scroll}}()\ \{}
\DoxyCodeLine{00519\ \ \ \textcolor{comment}{//\ Graph\ view\ is\ flipped,\ side\ bar\ isn't,\ so\ we\ need\ to\ convert\ coordinates}}
\DoxyCodeLine{00520\ \ \ NSPoint\ point;}
\DoxyCodeLine{00521\ \ \ point.x\ =\ 0;}
\DoxyCodeLine{00522\ \ \ point.y\ =\ \_graph\_view.frame.size.height\ -\/\ (((NSScrollView\ *)\_graph\_view\_controller.view).documentVisibleRect.size.height\ +\ ((NSScrollView\ *)\_graph\_view\_controller.view).documentVisibleRect.origin.y);}
\DoxyCodeLine{00523\ \ \ [\_sidebar\_scroll\_view.contentView\ scrollToPoint:point];}
\DoxyCodeLine{00524\ \ \ [\_sidebar\_scroll\_view\ reflectScrolledClipView:\_sidebar\_scroll\_view.contentView];}
\DoxyCodeLine{00525\ \}}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00530\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00531\ handle\_magnify(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ scale)\ \{}
\DoxyCodeLine{00532\ \ \ \mbox{\hyperlink{classMacStatsPianoRoll_ada9e3af9221b1f678c0bb289199122fb}{set\_horizontal\_scale}}(get\_horizontal\_scale()\ *\ (1.0\ -\/\ scale));}
\DoxyCodeLine{00533\ \}}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00538\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a882115ffffb941d7d00c9f929a7f4e5d}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00539\ \mbox{\hyperlink{classMacStatsPianoRoll_a882115ffffb941d7d00c9f929a7f4e5d}{handle\_draw\_graph}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00540\ \textcolor{preprocessor}{\#if\ \_\_MAC\_OS\_X\_VERSION\_MAX\_ALLOWED\ >=\ 140000}}
\DoxyCodeLine{00541\ \ \ draw\_guide\_bars(ctx,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00542\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00543\ }
\DoxyCodeLine{00544\ \ \ \textcolor{comment}{//\ Copy\ the\ drawn\ bars\ into\ the\ graph.}}
\DoxyCodeLine{00545\ \ \ \mbox{\hyperlink{classMacStatsGraph_aee19588a72b714ef1d04fae9da4967a9}{MacStatsGraph::handle\_draw\_graph}}(ctx,\ rect);}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \ \ \textcolor{comment}{//\ Draw\ the\ scale\ area.}}
\DoxyCodeLine{00548\ \textcolor{comment}{/*}}
\DoxyCodeLine{00549\ \textcolor{comment}{\ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_dark\_gray[0],\ rgb\_dark\_gray[1],\ rgb\_dark\_gray[2],\ 1.0);}}
\DoxyCodeLine{00550\ \textcolor{comment}{\ \ CGContextSetStrokeColor(ctx,\ rgb\_dark\_gray);}}
\DoxyCodeLine{00551\ \textcolor{comment}{\ \ CGContextBeginPath(ctx);}}
\DoxyCodeLine{00552\ \textcolor{comment}{\ \ CGContextMoveToPoint(ctx,\ 0,\ header\_height);}}
\DoxyCodeLine{00553\ \textcolor{comment}{\ \ CGContextAddLineToPoint(ctx,\ get\_xsize(),\ header\_height);}}
\DoxyCodeLine{00554\ \textcolor{comment}{\ \ CGContextStrokePath(ctx);*/}}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a2817d0202ae60465812dfff807245561}{get\_num\_user\_guide\_bars}}();}
\DoxyCodeLine{00557\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ draw\_guide\_bar(ctx,\ \mbox{\hyperlink{classPStatGraph_a065acd03e0e9d4da1b575fe8feb77909}{get\_user\_guide\_bar}}(i),\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00559\ \ \ \}}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ NSRect\ scale\_frame\ =\ \_scale\_area.frame;}
\DoxyCodeLine{00562\ \ \ NSRect\ graph\_frame\ =\ \_graph\_view.frame;}
\DoxyCodeLine{00563\ \ \ \textcolor{keywordflow}{if}\ (scale\_frame.size.width\ !=\ graph\_frame.size.width)\ \{}
\DoxyCodeLine{00564\ \ \ \ \ scale\_frame.size.width\ =\ graph\_frame.size.width;}
\DoxyCodeLine{00565\ \ \ \ \ \_scale\_area.frame\ =\ scale\_frame;}
\DoxyCodeLine{00566\ \ \ \}}
\DoxyCodeLine{00567\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00573\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a2c86411da09d2eafab76bb93f470166b}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00574\ \mbox{\hyperlink{classMacStatsPianoRoll_a2c86411da09d2eafab76bb93f470166b}{handle\_draw\_graph\_overhang}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00575\ \ \ CGContextSetFillColorWithColor(ctx,\ \_background\_color);}
\DoxyCodeLine{00576\ \ \ CGContextFillRect(ctx,\ rect);}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ draw\_guide\_bars(ctx,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00579\ \}}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00584\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsPianoRoll_a8fec63fab0426a2d6790ba50cb8f4025}{MacStatsPianoRoll::}}}
\DoxyCodeLine{00585\ \mbox{\hyperlink{classMacStatsPianoRoll_a8fec63fab0426a2d6790ba50cb8f4025}{handle\_draw\_scale\_area}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00586\ \textcolor{comment}{/*}}
\DoxyCodeLine{00587\ \textcolor{comment}{\ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_dark\_gray[0],\ rgb\_dark\_gray[1],\ rgb\_dark\_gray[2],\ 1.0);}}
\DoxyCodeLine{00588\ \textcolor{comment}{\ \ CGContextSetStrokeColor(ctx,\ rgb\_dark\_gray);}}
\DoxyCodeLine{00589\ \textcolor{comment}{\ \ CGContextBeginPath(ctx);}}
\DoxyCodeLine{00590\ \textcolor{comment}{\ \ CGContextMoveToPoint(ctx,\ 0,\ header\_height);}}
\DoxyCodeLine{00591\ \textcolor{comment}{\ \ CGContextAddLineToPoint(ctx,\ get\_xsize(),\ header\_height);}}
\DoxyCodeLine{00592\ \textcolor{comment}{\ \ CGContextStrokePath(ctx);*/}}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ draw\_guide\_bars(ctx,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00595\ \ \ draw\_guide\_labels(ctx);}
\DoxyCodeLine{00596\ \}}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00602\ \textcolor{keywordtype}{int}\ MacStatsPianoRoll::}
\DoxyCodeLine{00603\ get\_collector\_under\_pixel(\textcolor{keywordtype}{int}\ xpoint,\ \textcolor{keywordtype}{int}\ ypoint)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00604\ \ \ \textcolor{keywordflow}{if}\ (\_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a5e65e940be86dd012f99b3cf359eaef6}{get\_num\_labels}}()\ ==\ 0)\ \{}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00606\ \ \ \}}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \textcolor{comment}{//\ Assume\ all\ of\ the\ labels\ are\ the\ same\ height.}}
\DoxyCodeLine{00609\ \ \ \textcolor{keywordtype}{int}\ origin\ =\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_afdc015747b71c9c1a895c0ca206df378}{get\_label\_y}}(0,\ \_graph\_view);}
\DoxyCodeLine{00610\ \ \ \textcolor{keywordtype}{int}\ height\ =\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_ab8a8ea9471e2255f7911e93dc6bdc13d}{get\_label\_height}}(0);}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordtype}{int}\ row\ =\ (origin\ -\/\ ypoint)\ /\ height;}
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{if}\ (row\ >=\ 0\ \&\&\ row\ <\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a5e65e940be86dd012f99b3cf359eaef6}{get\_num\_labels}}())\ \{}
\DoxyCodeLine{00613\ \ \ \ \ \textcolor{keywordflow}{return}\ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_ade69e3483730e4a2a3b28cef3c7bde50}{get\_label\_collector\_index}}(row);}
\DoxyCodeLine{00614\ \ \ \}\ \textcolor{keywordflow}{else}\ \ \{}
\DoxyCodeLine{00615\ \ \ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00616\ \ \ \}}
\DoxyCodeLine{00617\ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00622\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00623\ update\_labels()\ \{}
\DoxyCodeLine{00624\ \ \ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_ae0ff343201fd5f0cad0f405e64ec9984}{clear\_labels}}();}
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ get\_num\_labels();\ ++i)\ \{}
\DoxyCodeLine{00626\ \ \ \ \ \_label\_stack.\mbox{\hyperlink{classMacStatsLabelStack_a64f56365d5cf951fb2c81da7bb57c16b}{add\_label}}(MacStatsGraph::\_monitor,\ \textcolor{keyword}{this},}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \_thread\_index,}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ get\_label\_collector(i),\ \textcolor{keyword}{true});}
\DoxyCodeLine{00629\ \ \ \}}
\DoxyCodeLine{00630\ \ \ \_labels\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00631\ \}}
\DoxyCodeLine{00632\ }
\DoxyCodeLine{00636\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00637\ draw\_guide\_bars(CGContextRef\ ctx,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{00638\ \ \ CGContextSetStrokeColorWithColor(ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00639\ }
\DoxyCodeLine{00640\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00641\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00642\ \ \ \ \ draw\_guide\_bar(ctx,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i),\ y,\ height);}
\DoxyCodeLine{00643\ \ \ \}}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a2817d0202ae60465812dfff807245561}{get\_num\_user\_guide\_bars}}();}
\DoxyCodeLine{00646\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00647\ \ \ \ \ draw\_guide\_bar(ctx,\ \mbox{\hyperlink{classPStatGraph_a065acd03e0e9d4da1b575fe8feb77909}{get\_user\_guide\_bar}}(i),\ y,\ height);}
\DoxyCodeLine{00648\ \ \ \}}
\DoxyCodeLine{00649\ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00654\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00655\ draw\_guide\_bar(CGContextRef\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar,}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00658\ }
\DoxyCodeLine{00659\ \ \ \textcolor{keywordflow}{if}\ (x\ >\ 0\ \&\&\ x\ <\ get\_xsize()\ -\/\ 1)\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \textcolor{comment}{//\ Only\ draw\ it\ if\ it's\ not\ too\ close\ to\ the\ top.}}
\DoxyCodeLine{00661\ \ \ \ \ \textcolor{comment}{/*switch\ (bar.\_style)\ \{}}
\DoxyCodeLine{00662\ \textcolor{comment}{\ \ \ \ case\ GBS\_target:}}
\DoxyCodeLine{00663\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_light\_gray[0],\ rgb\_light\_gray[1],\ rgb\_light\_gray[2],\ 1.0);}}
\DoxyCodeLine{00664\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00665\ \textcolor{comment}{}}
\DoxyCodeLine{00666\ \textcolor{comment}{\ \ \ \ case\ GBS\_user:}}
\DoxyCodeLine{00667\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_user\_guide\_bar[0],\ rgb\_user\_guide\_bar[1],\ rgb\_user\_guide\_bar[2],\ 1.0);}}
\DoxyCodeLine{00668\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00669\ \textcolor{comment}{}}
\DoxyCodeLine{00670\ \textcolor{comment}{\ \ \ \ default:}}
\DoxyCodeLine{00671\ \textcolor{comment}{\ \ \ \ \ \ CGContextSetRGBStrokeColor(ctx,\ rgb\_dark\_gray[0],\ rgb\_dark\_gray[1],\ rgb\_dark\_gray[2],\ 1.0);}}
\DoxyCodeLine{00672\ \textcolor{comment}{\ \ \ \ \ \ break;}}
\DoxyCodeLine{00673\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{00674\ \ \ \ \ CGContextBeginPath(ctx);}
\DoxyCodeLine{00675\ \ \ \ \ CGContextMoveToPoint(ctx,\ x,\ y);}
\DoxyCodeLine{00676\ \ \ \ \ CGContextAddLineToPoint(ctx,\ x,\ y\ +\ height);}
\DoxyCodeLine{00677\ \ \ \ \ CGContextStrokePath(ctx);}
\DoxyCodeLine{00678\ \ \ \}}
\DoxyCodeLine{00679\ \}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00684\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00685\ draw\_guide\_labels(CGContextRef\ ctx)\ \{}
\DoxyCodeLine{00686\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00687\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a96e40e4ab86f48d9c72c36067b9e5be2}{get\_num\_guide\_bars}}();}
\DoxyCodeLine{00688\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00689\ \ \ \ \ draw\_guide\_label(ctx,\ \mbox{\hyperlink{classPStatGraph_ae15abb62d95fe941e8bfa2c42a38b284}{get\_guide\_bar}}(i));}
\DoxyCodeLine{00690\ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \textcolor{keywordtype}{int}\ num\_user\_guide\_bars\ =\ \mbox{\hyperlink{classPStatGraph_a2817d0202ae60465812dfff807245561}{get\_num\_user\_guide\_bars}}();}
\DoxyCodeLine{00693\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_user\_guide\_bars;\ ++i)\ \{}
\DoxyCodeLine{00694\ \ \ \ \ draw\_guide\_label(ctx,\ \mbox{\hyperlink{classPStatGraph_a065acd03e0e9d4da1b575fe8feb77909}{get\_user\_guide\_bar}}(i));}
\DoxyCodeLine{00695\ \ \ \}}
\DoxyCodeLine{00696\ \}}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00701\ \textcolor{keywordtype}{void}\ MacStatsPianoRoll::}
\DoxyCodeLine{00702\ draw\_guide\_label(CGContextRef\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00703\ \ \ NSColor\ *\mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00704\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00705\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ =\ [NSColor\ tertiaryLabelColor];}
\DoxyCodeLine{00706\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00707\ \ \ \ \ \textcolor{comment}{//\ Otherwise\ it's\ hard\ to\ see\ on\ the\ dark\ titlebars}}
\DoxyCodeLine{00708\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ =\ [NSColor\ windowFrameTextColor];}
\DoxyCodeLine{00709\ \ \ \}}
\DoxyCodeLine{00710\ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00711\ \textcolor{comment}{\ \ switch\ (bar.\_style)\ \{}}
\DoxyCodeLine{00712\ \textcolor{comment}{\ \ case\ GBS\_target:}}
\DoxyCodeLine{00713\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_light\_gray[0]\ green:rgb\_light\_gray[1]\ blue:rgb\_light\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00714\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00715\ \textcolor{comment}{}}
\DoxyCodeLine{00716\ \textcolor{comment}{\ \ case\ GBS\_user:}}
\DoxyCodeLine{00717\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_user\_guide\_bar[0]\ green:rgb\_user\_guide\_bar[1]\ blue:rgb\_user\_guide\_bar[2]\ alpha:1.0];}}
\DoxyCodeLine{00718\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00719\ \textcolor{comment}{}}
\DoxyCodeLine{00720\ \textcolor{comment}{\ \ default:}}
\DoxyCodeLine{00721\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_dark\_gray[0]\ green:rgb\_dark\_gray[1]\ blue:rgb\_dark\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00722\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00723\ \textcolor{comment}{\ \ \}*/}}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \ \ \textcolor{keywordtype}{int}\ x\ =\ height\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00726\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \textcolor{keyword}{const}\ CFStringRef\ keys[]\ =\ \{}
\DoxyCodeLine{00729\ \ \ \ \ (\_\_bridge\ CFStringRef)NSForegroundColorAttributeName,}
\DoxyCodeLine{00730\ \ \ \ \ (\_\_bridge\ CFStringRef)NSFontAttributeName,}
\DoxyCodeLine{00731\ \ \ \};}
\DoxyCodeLine{00732\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *values[]\ =\ \{}
\DoxyCodeLine{00733\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}},}
\DoxyCodeLine{00734\ \ \ \ \ [NSFont\ systemFontOfSize:0.0],}
\DoxyCodeLine{00735\ \ \ \};}
\DoxyCodeLine{00736\ \ \ CFDictionaryRef\ attribs\ =\ CFDictionaryCreate(kCFAllocatorDefault,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)keys,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)values,\ 2,\ \&kCFTypeDictionaryKeyCallBacks,\ \&kCFTypeDictionaryValueCallBacks);}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00738\ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ label.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00739\ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00740\ \ \ CFRelease(attribs);}
\DoxyCodeLine{00741\ \ \ CFRelease(str);}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ CTLineRef\ line\ =\ CTLineCreateWithAttributedString(astr);}
\DoxyCodeLine{00744\ \ \ CFRelease(astr);}
\DoxyCodeLine{00745\ \ \ CGRect\ bounds\ =\ CTLineGetImageBounds(line,\ ctx);}
\DoxyCodeLine{00746\ \ \ \textcolor{keywordtype}{int}\ width\ =\ bounds.size.width;}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \textcolor{keywordflow}{if}\ (bar.\_style\ !=\ GBS\_user)\ \{}
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{keywordtype}{double}\ from\_height\ =\ pixel\_to\_height(x\ -\/\ width);}
\DoxyCodeLine{00750\ \ \ \ \ \textcolor{keywordtype}{double}\ to\_height\ =\ pixel\_to\_height(x\ +\ width);}
\DoxyCodeLine{00751\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPStatGraph_a27bac34846a7622cab2d7aa247fc570e}{find\_user\_guide\_bar}}(from\_height,\ to\_height)\ >=\ 0)\ \{}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \textcolor{comment}{//\ Omit\ the\ label:\ there's\ a\ user-\/defined\ guide\ bar\ in\ the\ same\ space.}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00755\ \ \ \ \ \}}
\DoxyCodeLine{00756\ \ \ \}}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{if}\ (x\ >=\ 0\ \&\&\ x\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00759\ \ \ \ \ CGContextSetTextPosition(ctx,\ x\ +\ 6,\ 6);}
\DoxyCodeLine{00760\ \ \ \ \ CTLineDraw(line,\ ctx);}
\DoxyCodeLine{00761\ \ \ \}}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \ \ CFRelease(line);}
\DoxyCodeLine{00764\ \}}

\end{DoxyCode}
