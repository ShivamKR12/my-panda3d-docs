\doxysection{p\+Stat\+View.\+cxx}
\hypertarget{pStatView_8cxx_source}{}\label{pStatView_8cxx_source}\index{pandatool/src/pstatserver/pStatView.cxx@{pandatool/src/pstatserver/pStatView.cxx}}
\mbox{\hyperlink{pStatView_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatView_8h}{pStatView.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatFrameData_8h}{pStatFrameData.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatCollectorDef_8h}{pStatCollectorDef.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classFrameSample}{FrameSample}}\ \{}
\DoxyCodeLine{00028\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordtype}{void}\ start(\textcolor{keywordtype}{double}\ time,\ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *started)\ \{}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//\ Keep\ track\ of\ nested\ start/stop\ pairs.\ \ We\ only\ consider\ the\ outer\ one.}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_started++\ >\ 0)\ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00033\ \ \ \ \ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ nassertv(!\_pushed);}
\DoxyCodeLine{00036\ \ \ \ \ \_net\_time\ -\/=\ time;}
\DoxyCodeLine{00037\ \ \ \ \ push\_all(time,\ started);}
\DoxyCodeLine{00038\ \ \ \ \ nassertv(\_next\ ==\ \textcolor{keyword}{nullptr}\ \&\&\ \_prev\ ==\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00039\ \ \ \ \ \_prev\ =\ started-\/>\_prev;}
\DoxyCodeLine{00040\ \ \ \ \ \_next\ =\ started;}
\DoxyCodeLine{00041\ \ \ \ \ \_prev-\/>\_next\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{00042\ \ \ \ \ started-\/>\_prev\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{00043\ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordtype}{void}\ stop(\textcolor{keywordtype}{double}\ time,\ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *started)\ \{}
\DoxyCodeLine{00046\ \ \ \ \ nassertv(\_started\ >\ 0);}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordflow}{if}\ (-\/-\/\_started\ >\ 0)\ \{}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00049\ \ \ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ nassertv(\_next\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ \_prev\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_pushed)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \_prev-\/>\_next\ =\ \_next;}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \_next-\/>\_prev\ =\ \_prev;}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \_next\ =\ \_prev\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00057\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \_net\_time\ +=\ time;}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \_prev-\/>\_next\ =\ \_next;}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \_next-\/>\_prev\ =\ \_prev;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \_next\ =\ \_prev\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00062\ \ \ \ \ \ \ pop\_one(time,\ started);}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00067\ \ \ \textcolor{keywordtype}{void}\ push(\textcolor{keywordtype}{double}\ time)\ \{}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_pushed)\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \_pushed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_started\ >\ 0)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \_net\_time\ +=\ time;}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{void}\ pop(\textcolor{keywordtype}{double}\ time)\ \{}
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_pushed)\ \{}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \_pushed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_started\ >\ 0)\ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \_net\_time\ -\/=\ time;}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \textcolor{keywordtype}{void}\ push\_all(\textcolor{keywordtype}{double}\ time,\ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *started)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classFrameSample}{FrameSample}}\ *sample\ =\ started-\/>\_next;}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ sample\ !=\ started;\ sample\ =\ sample-\/>\_next)\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \ \ sample-\/>push(time);}
\DoxyCodeLine{00089\ \ \ \ \ \}}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \textcolor{keywordtype}{void}\ pop\_one(\textcolor{keywordtype}{double}\ time,\ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *started)\ \{}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{for}\ (\mbox{\hyperlink{classFrameSample}{FrameSample}}\ *sample\ =\ started-\/>\_prev;}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ sample\ !=\ started;\ sample\ =\ sample-\/>\_prev)\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (sample-\/>\_pushed)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ sample-\/>pop(time);}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \}}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00103\ \ \ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *\_next\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ *\_prev\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{double}\ \_net\_time\ =\ 0.0;}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordtype}{int}\ \_started\ =\ 0;}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordtype}{int}\ \_count\ =\ 0;}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{bool}\ \_pushed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordtype}{bool}\ \_is\_new\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00110\ \};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00115\ PStatView::}
\DoxyCodeLine{00116\ PStatView()\ \{}
\DoxyCodeLine{00117\ \ \ \_constraint\ =\ 0;}
\DoxyCodeLine{00118\ \ \ \_show\_level\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00119\ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00120\ \ \ \_level\_index\ =\ 0;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00126\ PStatView::}
\DoxyCodeLine{00127\ \string~PStatView()\ \{}
\DoxyCodeLine{00128\ \ \ clear\_levels();}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00147\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatView_a6303d28ab7c14bf0d8e7d67bf5d63ba3}{PStatView::}}}
\DoxyCodeLine{00148\ \mbox{\hyperlink{classPStatView_a6303d28ab7c14bf0d8e7d67bf5d63ba3}{constrain}}(\textcolor{keywordtype}{int}\ collector,\ \textcolor{keywordtype}{bool}\ show\_level)\ \{}
\DoxyCodeLine{00149\ \ \ \_constraint\ =\ collector;}
\DoxyCodeLine{00150\ \ \ \_show\_level\ =\ show\_level;}
\DoxyCodeLine{00151\ \ \ clear\_levels();}
\DoxyCodeLine{00152\ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatView_a5afe9525eda8b6b8c037ab22358a5ccc}{PStatView::}}}
\DoxyCodeLine{00159\ \mbox{\hyperlink{classPStatView_a5afe9525eda8b6b8c037ab22358a5ccc}{unconstrain}}()\ \{}
\DoxyCodeLine{00160\ \ \ \mbox{\hyperlink{classPStatView_a6303d28ab7c14bf0d8e7d67bf5d63ba3}{constrain}}(0,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00161\ \}}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00166\ \textcolor{keywordtype}{void}\ PStatView::}
\DoxyCodeLine{00167\ set\_thread\_data(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatThreadData}{PStatThreadData}}\ *thread\_data)\ \{}
\DoxyCodeLine{00168\ \ \ \_thread\_data\ =\ thread\_data;}
\DoxyCodeLine{00169\ \ \ \_client\_data\ =\ thread\_data-\/>get\_client\_data();}
\DoxyCodeLine{00170\ \ \ clear\_levels();}
\DoxyCodeLine{00171\ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00184\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPStatView_a58673e539f32b9df52b690e82a8fddbb}{PStatView::}}}
\DoxyCodeLine{00185\ \mbox{\hyperlink{classPStatView_a58673e539f32b9df52b690e82a8fddbb}{set\_to\_frame}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ \&frame\_data)\ \{}
\DoxyCodeLine{00186\ \ \ nassertv(!\_thread\_data.is\_null());}
\DoxyCodeLine{00187\ \ \ nassertv(!\_client\_data.is\_null());}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{if}\ (\_show\_level)\ \{}
\DoxyCodeLine{00190\ \ \ \ \ update\_level\_data(frame\_data);}
\DoxyCodeLine{00191\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00192\ \ \ \ \ update\_time\_data(frame\_data);}
\DoxyCodeLine{00193\ \ \ \}}
\DoxyCodeLine{00194\ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00202\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatView_ab3a69808d875ab7bd79840828a8b5945}{PStatView::}}}
\DoxyCodeLine{00203\ \mbox{\hyperlink{classPStatView_ab3a69808d875ab7bd79840828a8b5945}{all\_collectors\_known}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00204\ \ \ \textcolor{keywordflow}{return}\ \_all\_collectors\_known;}
\DoxyCodeLine{00205\ \}}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00212\ \textcolor{keywordtype}{double}\ \mbox{\hyperlink{classPStatView_a2dcc2465a2515c85d8993b34c80e00ef}{PStatView::}}}
\DoxyCodeLine{00213\ \mbox{\hyperlink{classPStatView_a2dcc2465a2515c85d8993b34c80e00ef}{get\_net\_value}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00214\ \ \ \textcolor{keywordtype}{double}\ net\ =\ 0.0;}
\DoxyCodeLine{00215\ \ \ Levels::const\_iterator\ li;}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordflow}{for}\ (li\ =\ \_levels.begin();\ li\ !=\ \_levels.end();\ ++li)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ net\ +=\ (*li).second-\/>\_value\_alone;}
\DoxyCodeLine{00218\ \ \ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{return}\ net;}
\DoxyCodeLine{00221\ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00229\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *\mbox{\hyperlink{classPStatView_a51f7c68f54e4bbec06ef911dac40e3a1}{PStatView::}}}
\DoxyCodeLine{00230\ \mbox{\hyperlink{classPStatView_a51f7c68f54e4bbec06ef911dac40e3a1}{get\_top\_level}}()\ \{}
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(\_constraint);}
\DoxyCodeLine{00232\ \}}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00238\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPStatView_aeb9ef13c977d470931a20c79cf28cd08}{PStatView::}}}
\DoxyCodeLine{00239\ \mbox{\hyperlink{classPStatView_aeb9ef13c977d470931a20c79cf28cd08}{has\_level}}(\textcolor{keywordtype}{int}\ collector)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00240\ \ \ Levels::const\_iterator\ li;}
\DoxyCodeLine{00241\ \ \ li\ =\ \_levels.find(collector);}
\DoxyCodeLine{00242\ \ \ \textcolor{keywordflow}{return}\ (li\ !=\ \_levels.end());}
\DoxyCodeLine{00243\ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00250\ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *\mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{PStatView::}}}
\DoxyCodeLine{00251\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(\textcolor{keywordtype}{int}\ collector)\ \{}
\DoxyCodeLine{00252\ \ \ Levels::const\_iterator\ li;}
\DoxyCodeLine{00253\ \ \ li\ =\ \_levels.find(collector);}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordflow}{if}\ (li\ !=\ \_levels.end())\ \{}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{return}\ (*li).second;}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}};}
\DoxyCodeLine{00259\ \ \ level-\/>\_collector\ =\ collector;}
\DoxyCodeLine{00260\ \ \ level-\/>\_parent\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00261\ \ \ \_levels[collector]\ =\ level;}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ reset\_level(level);}
\DoxyCodeLine{00264\ \ \ \textcolor{keywordflow}{return}\ level;}
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00270\ \textcolor{keywordtype}{void}\ PStatView::}
\DoxyCodeLine{00271\ update\_time\_data(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ \&frame\_data)\ \{}
\DoxyCodeLine{00272\ \ \ \textcolor{keywordtype}{int}\ num\_events\ =\ frame\_data.get\_num\_events();}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordtype}{int}\ num\_collectors\ =\ \_client\_data-\/>get\_num\_collectors();}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \textcolor{keyword}{typedef}\ std::vector<FrameSample>\ Samples;}
\DoxyCodeLine{00276\ \ \ Samples\ samples(num\_collectors);}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{comment}{//\ Keep\ a\ linked\ list\ of\ started\ samples.}}
\DoxyCodeLine{00279\ \ \ \mbox{\hyperlink{classFrameSample}{FrameSample}}\ started;}
\DoxyCodeLine{00280\ \ \ started.\_next\ =\ \&started;}
\DoxyCodeLine{00281\ \ \ started.\_prev\ =\ \&started;}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \textcolor{keywordtype}{int}\ new\_collectors\ =\ 0;}
\DoxyCodeLine{00286\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_events;\ i++)\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ frame\_data.get\_time\_collector(i);}
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordtype}{bool}\ is\_start\ =\ frame\_data.is\_start(i);}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_client\_data-\/>has\_collector(collector\_index))\ \{}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \ \ nassertv(collector\_index\ >=\ 0\ \&\&\ collector\_index\ <\ num\_collectors);}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_client\_data-\/>get\_child\_distance(\_constraint,\ collector\_index)\ >=\ 0)\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Here's\ a\ data\ point\ we\ care\ about:\ anything\ at\ constraint\ level\ or}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ below.}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_start)\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ samples[collector\_index].start(frame\_data.get\_time(i),\ \&started);}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ samples[collector\_index].\_count++;}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ A\ "{}stop"{}\ in\ the\ middle\ of\ a\ frame\ implies\ a\ "{}start"{}\ since\ time}}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ 0\ (that\ is,\ since\ the\ first\ data\ point\ in\ the\ frame).}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (samples[collector\_index].\_started\ ==\ 0)\ \{}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ samples[collector\_index].start(frame\_data.get\_time(0),\ \&started);}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ samples[collector\_index].stop(frame\_data.get\_time(i),\ \&started);}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!samples[collector\_index].\_is\_new)\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ samples[collector\_index].\_is\_new\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ ++new\_collectors;}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00317\ \ \ \ \ \}}
\DoxyCodeLine{00318\ \ \ \}}
\DoxyCodeLine{00319\ }
\DoxyCodeLine{00320\ \ \ \textcolor{comment}{//\ Make\ sure\ everything\ is\ stopped.}}
\DoxyCodeLine{00321\ \ \ Samples::iterator\ si;}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0,\ si\ =\ samples.begin();\ si\ !=\ samples.end();\ ++i,\ ++si)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*si).\_started\ >\ 0)\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ (*si).stop(frame\_data.get\_end(),\ \&started);}
\DoxyCodeLine{00325\ \ \ \ \ \}}
\DoxyCodeLine{00326\ \ \ \}}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ nassertv(started.\_next\ ==\ \&started\ \&\&\ started.\_prev\ ==\ \&started);}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{keywordtype}{bool}\ any\_new\_levels\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{comment}{//\ Now\ match\ these\ samples\ we\ got\ up\ with\ those\ we\ already\ had\ in\ the}}
\DoxyCodeLine{00333\ \ \ \textcolor{comment}{//\ levels.}}
\DoxyCodeLine{00334\ \ \ Levels::iterator\ li,\ lnext;}
\DoxyCodeLine{00335\ \ \ li\ =\ \_levels.begin();}
\DoxyCodeLine{00336\ \ \ \textcolor{keywordflow}{while}\ (li\ !=\ \_levels.end())\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{comment}{//\ Be\ careful\ while\ traversing\ a\ container\ and\ calling\ functions\ that}}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{comment}{//\ could\ modify\ that\ container.}}
\DoxyCodeLine{00339\ \ \ \ \ lnext\ =\ li;}
\DoxyCodeLine{00340\ \ \ \ \ ++lnext;}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level\ =\ (*li).second;}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{if}\ (reset\_level(level))\ \{}
\DoxyCodeLine{00344\ \ \ \ \ \ \ any\_new\_levels\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00345\ \ \ \ \ \}}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ level-\/>\_collector;}
\DoxyCodeLine{00348\ \ \ \ \ \textcolor{keywordflow}{if}\ (samples[collector\_index].\_is\_new)\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ level-\/>\_value\_alone\ =\ samples[collector\_index].\_net\_time;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ level-\/>\_count\ =\ samples[collector\_index].\_count;}
\DoxyCodeLine{00351\ \ \ \ \ \ \ samples[collector\_index].\_is\_new\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00352\ \ \ \ \ \ \ -\/-\/new\_collectors;}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ li\ =\ lnext;}
\DoxyCodeLine{00356\ \ \ \}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ \textcolor{comment}{//\ Finally,\ any\ samples\ left\ over\ in\ the\ got\_samples\ set\ are\ new\ collectors}}
\DoxyCodeLine{00359\ \ \ \textcolor{comment}{//\ that\ we\ need\ to\ add\ to\ the\ Levels\ list.}}
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (new\_collectors\ >\ 0)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ any\_new\_levels\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ collector\_index\ =\ 0;\ collector\_index\ <\ num\_collectors;\ ++collector\_index)\ \{}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (samples[collector\_index].\_is\_new)\ \{}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level\ =\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(collector\_index);}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ level-\/>\_value\_alone\ =\ samples[collector\_index].\_net\_time;}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ level-\/>\_count\ =\ samples[collector\_index].\_count;}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00369\ \ \ \ \ \}}
\DoxyCodeLine{00370\ \ \ \}}
\DoxyCodeLine{00371\ }
\DoxyCodeLine{00372\ \ \ \textcolor{keywordflow}{if}\ (any\_new\_levels)\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \_level\_index++;}
\DoxyCodeLine{00374\ \ \ \}}
\DoxyCodeLine{00375\ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00380\ \textcolor{keywordtype}{void}\ PStatView::}
\DoxyCodeLine{00381\ update\_level\_data(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatFrameData}{PStatFrameData}}\ \&frame\_data)\ \{}
\DoxyCodeLine{00382\ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00383\ }
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \textcolor{comment}{//\ This\ tracks\ the\ set\ of\ level\ values\ we\ got.}}
\DoxyCodeLine{00386\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{classpmap}{pmap<int,\ double>}}\ GotValues;}
\DoxyCodeLine{00387\ \ \ GotValues\ net\_values;}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00390\ \ \ \textcolor{keywordtype}{int}\ num\_levels\ =\ frame\_data.get\_num\_levels();}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordflow}{for}\ (i\ =\ 0;\ i\ <\ num\_levels;\ i++)\ \{}
\DoxyCodeLine{00392\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ frame\_data.get\_level\_collector(i);}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordtype}{double}\ value\ =\ frame\_data.get\_level(i);}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_client\_data-\/>has\_collector(collector\_index))\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \_all\_collectors\_known\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_client\_data-\/>get\_child\_distance(\_constraint,\ collector\_index)\ >=\ 0)\ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ net\_values[collector\_index]\ =\ value;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00402\ \ \ \ \ \}}
\DoxyCodeLine{00403\ \ \ \}}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \textcolor{comment}{//\ Now\ that\ we've\ counted\ up\ the\ net\ level\ for\ each\ collector,\ compute\ the}}
\DoxyCodeLine{00406\ \ \ \textcolor{comment}{//\ level\ for\ each\ collector\ alone\ by\ subtracting\ out\ each\ child\ from\ its}}
\DoxyCodeLine{00407\ \ \ \textcolor{comment}{//\ parents.\ \ If\ a\ parent\ has\ no\ data,\ nothing\ is\ subtracted.}}
\DoxyCodeLine{00408\ \ \ GotValues\ alone\_values\ =\ net\_values;}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ GotValues::iterator\ gi;}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ net\_values.begin();\ gi\ !=\ net\_values.end();\ ++gi)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ (*gi).first;}
\DoxyCodeLine{00413\ \ \ \ \ \textcolor{keywordtype}{double}\ value\ =\ (*gi).second;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{comment}{//\ Walk\ up\ to\ the\ top,\ but\ stop\ when\ we\ find\ a\ parent\ with\ actual\ data.}}
\DoxyCodeLine{00416\ \ \ \ \ \textcolor{keywordflow}{while}\ (collector\_index\ !=\ 0\ \&\&\ collector\_index\ !=\ \_constraint)\ \{}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatCollectorDef}{PStatCollectorDef}}\ \&def\ =}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \_client\_data-\/>get\_collector\_def(collector\_index);}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ parent\_index\ =\ def.\_parent\_index;}
\DoxyCodeLine{00420\ \ \ \ \ \ \ GotValues::iterator\ pi\ =\ alone\_values.find(parent\_index);}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pi\ !=\ alone\_values.end())\ \{}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ parent\ has\ data;\ subtract\ it.}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ (*pi).second\ -\/=\ value;}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00426\ \ \ \ \ \ \ collector\_index\ =\ parent\_index;}
\DoxyCodeLine{00427\ \ \ \ \ \}}
\DoxyCodeLine{00428\ \ \ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ }
\DoxyCodeLine{00431\ \ \ \textcolor{keywordtype}{bool}\ any\_new\_levels\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \textcolor{comment}{//\ Now\ match\ these\ samples\ we\ got\ up\ with\ those\ we\ already\ had\ in\ the}}
\DoxyCodeLine{00434\ \ \ \textcolor{comment}{//\ levels.}}
\DoxyCodeLine{00435\ \ \ Levels::iterator\ li,\ lnext;}
\DoxyCodeLine{00436\ \ \ li\ =\ \_levels.begin();}
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{while}\ (li\ !=\ \_levels.end())\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \textcolor{comment}{//\ Be\ careful\ while\ traversing\ a\ container\ and\ calling\ functions\ that}}
\DoxyCodeLine{00439\ \ \ \ \ \textcolor{comment}{//\ could\ modify\ that\ container.}}
\DoxyCodeLine{00440\ \ \ \ \ lnext\ =\ li;}
\DoxyCodeLine{00441\ \ \ \ \ ++lnext;}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level\ =\ (*li).second;}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{if}\ (reset\_level(level))\ \{}
\DoxyCodeLine{00445\ \ \ \ \ \ \ any\_new\_levels\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00446\ \ \ \ \ \}}
\DoxyCodeLine{00447\ }
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ level-\/>\_collector;}
\DoxyCodeLine{00449\ \ \ \ \ GotValues::iterator\ gi;}
\DoxyCodeLine{00450\ \ \ \ \ gi\ =\ alone\_values.find(collector\_index);}
\DoxyCodeLine{00451\ \ \ \ \ \textcolor{keywordflow}{if}\ (gi\ !=\ alone\_values.end())\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ level-\/>\_value\_alone\ =\ (*gi).second;}
\DoxyCodeLine{00453\ \ \ \ \ \ \ alone\_values.erase(gi);}
\DoxyCodeLine{00454\ \ \ \ \ \}}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ li\ =\ lnext;}
\DoxyCodeLine{00457\ \ \ \}}
\DoxyCodeLine{00458\ }
\DoxyCodeLine{00459\ \ \ \textcolor{comment}{//\ Finally,\ any\ values\ left\ over\ in\ the\ alone\_values\ set\ are\ new\ collectors}}
\DoxyCodeLine{00460\ \ \ \textcolor{comment}{//\ that\ we\ need\ to\ add\ to\ the\ Levels\ list.}}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{if}\ (!alone\_values.empty())\ \{}
\DoxyCodeLine{00462\ \ \ \ \ any\_new\_levels\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00463\ }
\DoxyCodeLine{00464\ \ \ \ \ GotValues::const\_iterator\ gi;}
\DoxyCodeLine{00465\ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ alone\_values.begin();\ gi\ !=\ alone\_values.end();\ ++gi)\ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ collector\_index\ =\ (*gi).first;}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level\ =\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(collector\_index);}
\DoxyCodeLine{00468\ \ \ \ \ \ \ level-\/>\_value\_alone\ =\ (*gi).second;}
\DoxyCodeLine{00469\ \ \ \ \ \}}
\DoxyCodeLine{00470\ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{if}\ (any\_new\_levels)\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \_level\_index++;}
\DoxyCodeLine{00474\ \ \ \}}
\DoxyCodeLine{00475\ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00480\ \textcolor{keywordtype}{void}\ PStatView::}
\DoxyCodeLine{00481\ clear\_levels()\ \{}
\DoxyCodeLine{00482\ \ \ Levels::iterator\ li;}
\DoxyCodeLine{00483\ \ \ \textcolor{keywordflow}{for}\ (li\ =\ \_levels.begin();\ li\ !=\ \_levels.end();\ ++li)\ \{}
\DoxyCodeLine{00484\ \ \ \ \ \textcolor{keyword}{delete}\ (*li).second;}
\DoxyCodeLine{00485\ \ \ \}}
\DoxyCodeLine{00486\ \ \ \_levels.clear();}
\DoxyCodeLine{00487\ \}}
\DoxyCodeLine{00488\ }
\DoxyCodeLine{00498\ \textcolor{keywordtype}{bool}\ PStatView::}
\DoxyCodeLine{00499\ reset\_level(\mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *level)\ \{}
\DoxyCodeLine{00500\ \ \ \textcolor{keywordtype}{bool}\ any\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00501\ \ \ level-\/>\_value\_alone\ =\ 0.0;}
\DoxyCodeLine{00502\ \ \ level-\/>\_count\ =\ 0;}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{if}\ (level-\/>\_collector\ ==\ \_constraint)\ \{}
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00506\ \ \ \}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \ \ \textcolor{keywordflow}{if}\ (\_client\_data-\/>has\_collector(level-\/>\_collector))\ \{}
\DoxyCodeLine{00509\ \ \ \ \ \textcolor{keywordtype}{int}\ parent\_index\ =}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \_client\_data-\/>get\_collector\_def(level-\/>\_collector).\_parent\_index;}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keywordflow}{if}\ (level-\/>\_parent\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ level\ didn't\ know\ its\ parent\ before,\ but\ now\ it\ does.}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (level-\/>\_collector\ !=\ 0\ ||\ parent\_index\ !=\ 0)\ \{}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *parent\_level\ =\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(parent\_index);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ nassertr(parent\_level\ !=\ level,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ level-\/>\_parent\ =\ parent\_level;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ parent\_level-\/>\_children.push\_back(level);}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ parent\_level-\/>\mbox{\hyperlink{classPStatViewLevel_aa575bcd0ed8686697d88da1bda4ffbea}{sort\_children}}(\_client\_data);}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ any\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00522\ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (level-\/>\_parent-\/>\_collector\ !=\ parent\_index)\ \{}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ level\ knew\ about\ its\ parent,\ but\ now\ it's\ something\ different.}}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *old\_parent\_level\ =\ level-\/>\_parent;}
\DoxyCodeLine{00526\ \ \ \ \ \ \ nassertr(old\_parent\_level\ !=\ level,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00527\ }
\DoxyCodeLine{00528\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (parent\_index\ !=\ 0)\ \{}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classPStatViewLevel}{PStatViewLevel}}\ *new\_parent\_level\ =\ \mbox{\hyperlink{classPStatView_af3deba6eb7bb9997142ee6f353fdeec8}{get\_level}}(parent\_index);}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ nassertr(new\_parent\_level\ !=\ level,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ level-\/>\_parent\ =\ new\_parent\_level;}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ new\_parent\_level-\/>\_children.push\_back(level);}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ new\_parent\_level-\/>\mbox{\hyperlink{classPStatViewLevel_aa575bcd0ed8686697d88da1bda4ffbea}{sort\_children}}(\_client\_data);}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ level-\/>\_parent\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ PStatViewLevel::Children::iterator\ ci\ =}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ find(old\_parent\_level-\/>\_children.begin(),}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ old\_parent\_level-\/>\_children.end(),}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ level);}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \ \ \ \ nassertr(ci\ !=\ old\_parent\_level-\/>\_children.end(),\ \textcolor{keyword}{true});}
\DoxyCodeLine{00544\ \ \ \ \ \ \ old\_parent\_level-\/>\_children.erase(ci);}
\DoxyCodeLine{00545\ \ \ \ \ \ \ any\_changed\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00546\ \ \ \ \ \}}
\DoxyCodeLine{00547\ \ \ \}}
\DoxyCodeLine{00548\ }
\DoxyCodeLine{00549\ \ \ \textcolor{keywordflow}{return}\ any\_changed;}
\DoxyCodeLine{00550\ \}}

\end{DoxyCode}
