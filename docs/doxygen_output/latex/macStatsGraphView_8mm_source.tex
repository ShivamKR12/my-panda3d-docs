\doxysection{mac\+Stats\+Graph\+View.\+mm}
\hypertarget{macStatsGraphView_8mm_source}{}\label{macStatsGraphView_8mm_source}\index{pandatool/src/mac-\/stats/macStatsGraphView.mm@{pandatool/src/mac-\/stats/macStatsGraphView.mm}}
\mbox{\hyperlink{macStatsGraphView_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsGraphView_8h}{macStatsGraphView.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsGraph_8h}{macStatsGraph.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsStripChart_8h}{macStatsStripChart.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsFlameGraph_8h}{macStatsFlameGraph.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsTimeline_8h}{macStatsTimeline.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsScaleArea_8h}{macStatsScaleArea.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{@implementation\ }\mbox{\hyperlink{interfaceMacStatsGraphView}{MacStatsGraphView}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ -\/\ (id)initWithGraph:(\mbox{\hyperlink{classMacStatsGraph}{MacStatsGraph}}\ *)graph\ \{}
\DoxyCodeLine{00024\ \ \ \textcolor{keywordflow}{if}\ (self\ =\ [super\ init])\ \{}
\DoxyCodeLine{00025\ \ \ \ \ \_graph\ =\ graph;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ self.translatesAutoresizingMaskIntoConstraints\ =\ NO;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ NSTrackingArea\ *area\ =\ [[NSTrackingArea\ alloc]\ initWithRect:NSZeroRect\ options:(NSTrackingMouseEnteredAndExited\ |\ NSTrackingMouseMoved\ |\ NSTrackingActiveInKeyWindow\ |\ NSTrackingInVisibleRect)\ owner:self\ userInfo:nil];}
\DoxyCodeLine{00030\ \ \ \ \ [\textcolor{keyword}{self}\ addTrackingArea:area];}
\DoxyCodeLine{00031\ \ \ \ \ [area\ release];}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ [\textcolor{keyword}{self}\ addToolTipRect:NSMakeRect(0,\ 0,\ 1000,\ 1000)\ owner:self\ userData:nil];}
\DoxyCodeLine{00034\ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{return}\ self;}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ -\/\ (BOOL)isFlipped\ \{}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{return}\ YES;}
\DoxyCodeLine{00041\ \}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ -\/\ (BOOL)acceptsFirstResponder\ \{}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{return}\ YES;}
\DoxyCodeLine{00045\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ -\/\ (void)keyDown:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00048\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00049\ \ \ UniChar\ c\ =\ 0;}
\DoxyCodeLine{00050\ \ \ NSString\ *str\ =\ [event\ charactersIgnoringModifiers];}
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{if}\ (str\ !=\ nil\ \&\&\ str.length\ ==\ 1)\ \{}
\DoxyCodeLine{00052\ \ \ \ \ c\ =\ [str\ characterAtIndex:0];}
\DoxyCodeLine{00053\ \ \ \}}
\DoxyCodeLine{00054\ \ \ \_graph-\/>handle\_key(pos.x,\ pos.y,\ \textcolor{keyword}{true},\ c,\ event.keyCode);}
\DoxyCodeLine{00055\ \}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ -\/\ (void)keyUp:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00058\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00059\ \ \ UniChar\ c\ =\ 0;}
\DoxyCodeLine{00060\ \ \ NSString\ *str\ =\ [event\ charactersIgnoringModifiers];}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordflow}{if}\ (str\ !=\ nil\ \&\&\ str.length\ ==\ 1)\ \{}
\DoxyCodeLine{00062\ \ \ \ \ c\ =\ [str\ characterAtIndex:0];}
\DoxyCodeLine{00063\ \ \ \}}
\DoxyCodeLine{00064\ \ \ \_graph-\/>handle\_key(pos.x,\ pos.y,\ \textcolor{keyword}{false},\ c,\ event.keyCode);}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ -\/\ (void)mouseDown:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00068\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00069\ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a85679d6f09f08fbb700a91944568b4d5}{handle\_button\_press}}(pos.x,\ pos.y,\ event.clickCount\ >\ 1,\ event.buttonNumber);}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ -\/\ (void)mouseUp:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00073\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00074\ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a0dd05ee8e330022b32393b3354f880a2}{handle\_button\_release}}(pos.x,\ pos.y);}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ -\/\ (void)mouseDragged:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00078\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00079\ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a45e4a7c922f1a1cc97c413af0c9d3bfb}{handle\_motion}}(pos.x,\ pos.y);}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ -\/\ (void)mouseMoved:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00083\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00084\ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a45e4a7c922f1a1cc97c413af0c9d3bfb}{handle\_motion}}(pos.x,\ pos.y);}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ -\/\ (void)mouseExited:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00088\ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_acfad811cb03fd198c8ef554e82fca3e0}{handle\_leave}}();}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ -\/\ (void)scrollWheel:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00092\ \ \ [\textcolor{keyword}{super}\ scrollWheel:event];}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{if}\ (event.deltaX\ !=\ 0)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00095\ \ \ \ \ \_graph-\/>handle\_wheel(pos.x,\ pos.y,\ event.deltaX,\ event.deltaY);}
\DoxyCodeLine{00096\ \ \ \}}
\DoxyCodeLine{00097\ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ -\/\ (void)magnifyWithEvent:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00100\ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00101\ \ \ \_graph-\/>handle\_magnify(pos.x,\ pos.y,\ event.magnification);}
\DoxyCodeLine{00102\ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ -\/\ (void)handleTimer:(NSTimer\ *)timer\ \{}
\DoxyCodeLine{00105\ \ \ \_graph-\/>handle\_timer();}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00108\ -\/\ (void)viewDidChangeEffectiveAppearance\ \{}
\DoxyCodeLine{00109\ \ \ \textcolor{keywordflow}{if}\ (\_graph\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{comment}{//\ Don't\ call\ this\ initially}}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{if}\ (self.window\ !=\ nil)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ [NSAppearance\ setCurrentAppearance:self.effectiveAppearance];}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \_graph-\/>force\_redraw();}
\DoxyCodeLine{00114\ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \}}
\DoxyCodeLine{00116\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ -\/\ (void)drawRect:(NSRect)dirtyRect\ \{}
\DoxyCodeLine{00119\ \ \ \textcolor{keywordflow}{if}\ (\_graph\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00120\ \ \ \ \ CGContextRef\ ctx\ =\ [NSGraphicsContext\ currentContext].CGContext;}
\DoxyCodeLine{00121\ \ \ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_aee19588a72b714ef1d04fae9da4967a9}{handle\_draw\_graph}}(ctx,\ dirtyRect);}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \textcolor{comment}{//\ Not\ called\ when\ building\ with\ macOS\ 14\ SDK\ due\ to\ change\ in\ clipsToBounds}}
\DoxyCodeLine{00126\ \textcolor{comment}{//\ (but\ there\ it\ simply\ calls\ drawRect\ with\ the\ overhang\ region)}}
\DoxyCodeLine{00127\ \textcolor{preprocessor}{\#if\ \_\_MAC\_OS\_X\_VERSION\_MAX\_ALLOWED\ <\ 140000}}
\DoxyCodeLine{00128\ -\/\ (void)drawBackgroundOverhangInRect:(NSRect)dirtyRect\ \{}
\DoxyCodeLine{00129\ \ \ \textcolor{keywordflow}{if}\ (\_graph\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00130\ \ \ \ \ CGContextRef\ ctx\ =\ [NSGraphicsContext\ currentContext].CGContext;}
\DoxyCodeLine{00131\ \ \ \ \ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a975810eec4c8bdfbd4a8c645feea3537}{handle\_draw\_graph\_overhang}}(ctx,\ dirtyRect);}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ \}}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ -\/\ (NSMenu\ *)menuForEvent:(NSEvent\ *)event\ \{}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{if}\ (\_graph\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00138\ \ \ \ \ NSPoint\ pos\ =\ [\textcolor{keyword}{self}\ convertPoint:event.locationInWindow\ fromView:nil];}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordflow}{return}\ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_ab212bb88540399dd3dd0ead08653f8ec}{get\_graph\_menu}}(pos.x,\ pos.y);}
\DoxyCodeLine{00140\ \ \ \}}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{return}\ nil;}
\DoxyCodeLine{00142\ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ -\/\ (NSString\ *)view:(NSView\ *)view}
\DoxyCodeLine{00145\ \ \ stringForToolTip:(NSToolTipTag)tag}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ \ point:(NSPoint)point}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ userData:(\textcolor{keywordtype}{void}\ *)data\ \{}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{if}\ (\_graph\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00150\ \ \ \ \ std::string\ text\ =\ \_graph-\/>\mbox{\hyperlink{classMacStatsGraph_a2c60be1ba65e072aea796a8a08cd7b64}{get\_graph\_tooltip}}(point.x,\ point.y);}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordflow}{return}\ [NSString\ stringWithUTF8String:text.c\_str()];}
\DoxyCodeLine{00152\ \ \ \}}
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{@"{}"{}};}
\DoxyCodeLine{00154\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \textcolor{keyword}{@end}}

\end{DoxyCode}
