\doxysection{egg\+Writer.\+cxx}
\hypertarget{eggWriter_8cxx_source}{}\label{eggWriter_8cxx_source}\index{pandatool/src/eggbase/eggWriter.cxx@{pandatool/src/eggbase/eggWriter.cxx}}
\mbox{\hyperlink{eggWriter_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{eggWriter_8h}{eggWriter.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{compose__matrix_8h}{compose\_matrix.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{globPattern_8h}{globPattern.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00033\ \mbox{\hyperlink{classEggWriter_aa4851dc046c885a061f25d76ce40764c}{EggWriter::}}}
\DoxyCodeLine{00034\ \mbox{\hyperlink{classEggWriter_aa4851dc046c885a061f25d76ce40764c}{EggWriter}}(\textcolor{keywordtype}{bool}\ allow\_last\_param,\ \textcolor{keywordtype}{bool}\ allow\_stdout)\ :}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classWithOutputFile}{WithOutputFile}}(allow\_last\_param,\ allow\_stdout,\ false)}
\DoxyCodeLine{00036\ \{}
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ Indicate\ the\ extension\ name\ we\ expect\ the\ user\ to\ supply\ for\ output}}
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ files.}}
\DoxyCodeLine{00039\ \ \ \_preferred\_extension\ =\ \textcolor{stringliteral}{"{}.egg"{}};}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \mbox{\hyperlink{classProgramBase_aa3fb7f284b32cce7d8f4f1f3841b4c42}{clear\_runlines}}();}
\DoxyCodeLine{00042\ \ \ \textcolor{keywordflow}{if}\ (\_allow\_last\_param)\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \mbox{\hyperlink{classProgramBase_abc009d8bf32295f3e0b6e922b8281183}{add\_runline}}(\textcolor{stringliteral}{"{}[opts]\ output.egg"{}});}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{classProgramBase_abc009d8bf32295f3e0b6e922b8281183}{add\_runline}}(\textcolor{stringliteral}{"{}[opts]\ -\/o\ output.egg"{}});}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{if}\ (\_allow\_stdout)\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{classProgramBase_abc009d8bf32295f3e0b6e922b8281183}{add\_runline}}(\textcolor{stringliteral}{"{}[opts]\ >output.egg"{}});}
\DoxyCodeLine{00048\ \ \ \}}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ std::string\ o\_description;}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{if}\ (\_allow\_stdout)\ \{}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_allow\_last\_param)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ \ \ o\_description\ =}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ filename\ to\ which\ the\ resulting\ egg\ file\ will\ be\ written.\ \ "{}}}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}If\ this\ option\ is\ omitted,\ the\ last\ parameter\ name\ is\ taken\ to\ be\ the\ "{}}}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}name\ of\ the\ output\ file,\ or\ standard\ output\ is\ used\ if\ there\ are\ no\ "{}}}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}other\ parameters."{}};}
\DoxyCodeLine{00059\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ o\_description\ =}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ filename\ to\ which\ the\ resulting\ egg\ file\ will\ be\ written.\ \ "{}}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}If\ this\ option\ is\ omitted,\ the\ egg\ file\ is\ written\ to\ standard\ output."{}};}
\DoxyCodeLine{00063\ \ \ \ \ \}}
\DoxyCodeLine{00064\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_allow\_last\_param)\ \{}
\DoxyCodeLine{00066\ \ \ \ \ \ \ o\_description\ =}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ filename\ to\ which\ the\ resulting\ egg\ file\ will\ be\ written.\ \ "{}}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}If\ this\ option\ is\ omitted,\ the\ last\ parameter\ name\ is\ taken\ to\ be\ the\ "{}}}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}name\ of\ the\ output\ file."{}};}
\DoxyCodeLine{00070\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \ \ o\_description\ =}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ filename\ to\ which\ the\ resulting\ egg\ file\ will\ be\ written."{}};}
\DoxyCodeLine{00073\ \ \ \ \ \}}
\DoxyCodeLine{00074\ \ \ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \mbox{\hyperlink{classProgramBase_a8be57a7c862cd8c30b5950e9ee9e037b}{add\_option}}}
\DoxyCodeLine{00077\ \ \ \ \ (\textcolor{stringliteral}{"{}o"{}},\ \textcolor{stringliteral}{"{}filename"{}},\ 50,\ o\_description,}
\DoxyCodeLine{00078\ \ \ \ \ \ \&\mbox{\hyperlink{classProgramBase_a3d5344afb7e01865dfff79390cc343de}{EggWriter::dispatch\_filename}},\ \&\_got\_output\_filename,\ \&\_output\_filename);}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \mbox{\hyperlink{classProgramBase_a6a8ff7f3421c451cf71615e2451b9bb0}{redescribe\_option}}}
\DoxyCodeLine{00081\ \ \ \ \ (\textcolor{stringliteral}{"{}cs"{}},}
\DoxyCodeLine{00082\ \ \ \ \ \ \textcolor{stringliteral}{"{}Specify\ the\ coordinate\ system\ of\ the\ resulting\ egg\ file.\ \ This\ may\ be\ "{}}}
\DoxyCodeLine{00083\ \ \ \ \ \ \textcolor{stringliteral}{"{}one\ of\ 'y-\/up',\ 'z-\/up',\ 'y-\/up-\/left',\ or\ 'z-\/up-\/left'.\ \ The\ default\ is\ "{}}}
\DoxyCodeLine{00084\ \ \ \ \ \ \textcolor{stringliteral}{"{}y-\/up."{}});}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00097\ \mbox{\hyperlink{classEggWriter}{EggWriter}}\ *\mbox{\hyperlink{classEggWriter_ab0b50f644b760af48d71075359a2454d}{EggWriter::}}}
\DoxyCodeLine{00098\ \mbox{\hyperlink{classEggWriter_ab0b50f644b760af48d71075359a2454d}{as\_writer}}()\ \{}
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00100\ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00111\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggWriter_aa3e0e902d2c228a49b5a2679c252cfff}{EggWriter::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classEggWriter_aa3e0e902d2c228a49b5a2679c252cfff}{post\_process\_egg\_file}}()\ \{}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{if}\ (\_got\_transform)\ \{}
\DoxyCodeLine{00114\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Applying\ transform\ matrix:\(\backslash\)n"{}};}
\DoxyCodeLine{00115\ \ \ \ \ \_transform.write(nout,\ 2);}
\DoxyCodeLine{00116\ \ \ \ \ LVecBase3d\ scale,\ hpr,\ translate;}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{compose__matrix__src_8cxx_a499c787e84555f9a09c93f526b7dbc0d}{decompose\_matrix}}(\_transform,\ scale,\ hpr,\ translate,}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_data-\/>get\_coordinate\_system()))\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}(scale\ "{}}\ <<\ scale\ <<\ \textcolor{stringliteral}{"{},\ hpr\ "{}}\ <<\ hpr\ <<\ \textcolor{stringliteral}{"{},\ translate\ "{}}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ <<\ translate\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00121\ \ \ \ \ \}}
\DoxyCodeLine{00122\ \ \ \ \ \_data-\/>transform(\_transform);}
\DoxyCodeLine{00123\ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \textcolor{keywordflow}{if}\ (\_make\_points)\ \{}
\DoxyCodeLine{00126\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Making\ points\(\backslash\)n"{}};}
\DoxyCodeLine{00127\ \ \ \ \ \_data-\/>make\_point\_primitives();}
\DoxyCodeLine{00128\ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \textcolor{keywordtype}{bool}\ needs\_remove\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \textcolor{keywordflow}{switch}\ (\_normals\_mode)\ \{}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{case}\ NM\_strip:}
\DoxyCodeLine{00134\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Stripping\ normals.\(\backslash\)n"{}};}
\DoxyCodeLine{00135\ \ \ \ \ \_data-\/>strip\_normals();}
\DoxyCodeLine{00136\ \ \ \ \ needs\_remove\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{case}\ NM\_polygon:}
\DoxyCodeLine{00140\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Recomputing\ polygon\ normals.\(\backslash\)n"{}};}
\DoxyCodeLine{00141\ \ \ \ \ \_data-\/>recompute\_polygon\_normals();}
\DoxyCodeLine{00142\ \ \ \ \ needs\_remove\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{case}\ NM\_vertex:}
\DoxyCodeLine{00146\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Recomputing\ vertex\ normals.\(\backslash\)n"{}};}
\DoxyCodeLine{00147\ \ \ \ \ \_data-\/>recompute\_vertex\_normals(\_normals\_threshold);}
\DoxyCodeLine{00148\ \ \ \ \ needs\_remove\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \textcolor{keywordflow}{case}\ NM\_preserve:}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{comment}{//\ Do\ nothing.}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00154\ \ \ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{if}\ (\_got\_tbnall)\ \{}
\DoxyCodeLine{00157\ \ \ \ \ needs\_remove\ |=\ \_data-\/>recompute\_tangent\_binormal(\mbox{\hyperlink{classGlobPattern}{GlobPattern}}(\textcolor{stringliteral}{"{}*"{}}));}
\DoxyCodeLine{00158\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_got\_tbnauto)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \ \ needs\_remove\ |=\ \_data-\/>recompute\_tangent\_binormal\_auto();}
\DoxyCodeLine{00161\ \ \ \ \ \}}
\DoxyCodeLine{00162\ \ \ \ \ needs\_remove\ |=\ \_data-\/>recompute\_tangent\_binormal(\_tbn\_names);}
\DoxyCodeLine{00163\ \ \ \}}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{if}\ (needs\_remove)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \_data-\/>remove\_unused\_vertices(\textcolor{keyword}{true});}
\DoxyCodeLine{00167\ \ \ \}}
\DoxyCodeLine{00168\ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00176\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classEggWriter_ac385926a8508df70ecd2470031a668a0}{EggWriter::}}}
\DoxyCodeLine{00177\ \mbox{\hyperlink{classEggWriter_ac385926a8508df70ecd2470031a668a0}{write\_egg\_file}}()\ \{}
\DoxyCodeLine{00178\ \ \ \mbox{\hyperlink{classEggWriter_aa3e0e902d2c228a49b5a2679c252cfff}{post\_process\_egg\_file}}();}
\DoxyCodeLine{00179\ \ \ \_data-\/>write\_egg(\mbox{\hyperlink{classWithOutputFile_ad21e9bc43bef4f2742d6ef3992ff22a4}{get\_output}}());}
\DoxyCodeLine{00180\ \}}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00187\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggWriter_a6e8fab71df5d5a062287fe9f84c2f769}{EggWriter::}}}
\DoxyCodeLine{00188\ \mbox{\hyperlink{classEggWriter_a6e8fab71df5d5a062287fe9f84c2f769}{handle\_args}}(\mbox{\hyperlink{classpdeque}{ProgramBase::Args}}\ \&args)\ \{}
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classWithOutputFile_a07b4c8a2c6e7396013440633ba7ffa78}{check\_last\_arg}}(args,\ 0))\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00191\ \ \ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{if}\ (!args.empty())\ \{}
\DoxyCodeLine{00194\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}Unexpected\ arguments\ on\ command\ line:\(\backslash\)n"{}};}
\DoxyCodeLine{00195\ \ \ \ \ Args::const\_iterator\ ai;}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ args.begin();\ ai\ !=\ args.end();\ ++ai)\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ nout\ <<\ (*ai)\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{00198\ \ \ \ \ \}}
\DoxyCodeLine{00199\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)r"{}};}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00201\ \ \ \}}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \textcolor{keywordflow}{if}\ (!\_got\_path\_directory\ \&\&\ \_got\_output\_filename)\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \textcolor{comment}{//\ Put\ in\ the\ name\ of\ the\ output\ directory.}}
\DoxyCodeLine{00205\ \ \ \ \ \_path\_replace-\/>\_path\_directory\ =\ \_output\_filename.get\_dirname();}
\DoxyCodeLine{00206\ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00209\ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00214\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classEggWriter_aea2898c85542141a08ddbdda381a62af}{EggWriter::}}}
\DoxyCodeLine{00215\ \mbox{\hyperlink{classEggWriter_aea2898c85542141a08ddbdda381a62af}{post\_command\_line}}()\ \{}
\DoxyCodeLine{00216\ \ \ \textcolor{keywordflow}{if}\ (!\_allow\_stdout\ \&\&\ !\_got\_output\_filename)\ \{}
\DoxyCodeLine{00217\ \ \ \ \ nout\ <<\ \textcolor{stringliteral}{"{}You\ must\ specify\ the\ filename\ to\ write\ with\ -\/o.\(\backslash\)n"{}};}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{classEggBase_a2f150df5babcf501334c6ce59a91d9f3}{append\_command\_comment}}(\_data);}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classEggSingleBase_a1c83b23f4a6c3daf2251c87942f8d5c6}{EggSingleBase::post\_command\_line}}();}
\DoxyCodeLine{00224\ \}}

\end{DoxyCode}
