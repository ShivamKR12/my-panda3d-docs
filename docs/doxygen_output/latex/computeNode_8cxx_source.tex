\doxysection{compute\+Node.\+cxx}
\hypertarget{computeNode_8cxx_source}{}\label{computeNode_8cxx_source}\index{panda/src/pgraphnodes/computeNode.cxx@{panda/src/pgraphnodes/computeNode.cxx}}
\mbox{\hyperlink{computeNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{computeNode_8h}{computeNode.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverser_8h}{cullTraverser.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullableObject_8h}{cullableObject.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullHandler_8h}{cullHandler.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomDrawCallbackData_8h}{geomDrawCallbackData.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{omniBoundingVolume_8h}{omniBoundingVolume.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ ComputeNode::\_type\_handle;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00029\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode::}}}
\DoxyCodeLine{00030\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode}}(\textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00031\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(name),}
\DoxyCodeLine{00032\ \ \ \_dispatcher(new\ \mbox{\hyperlink{classComputeNode}{ComputeNode}}::\mbox{\hyperlink{classComputeNode_1_1Dispatcher}{Dispatcher}})}
\DoxyCodeLine{00033\ \{}
\DoxyCodeLine{00034\ \ \ set\_internal\_bounds(\textcolor{keyword}{new}\ \mbox{\hyperlink{classOmniBoundingVolume}{OmniBoundingVolume}});}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classPandaNode_acab0226d40fa5acd75f33cfb5657833f}{set\_renderable}}();}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00041\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode::}}}
\DoxyCodeLine{00042\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classComputeNode}{ComputeNode}}\ \&copy)\ :}
\DoxyCodeLine{00043\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(copy),}
\DoxyCodeLine{00044\ \ \ \_dispatcher(new\ \mbox{\hyperlink{classComputeNode}{ComputeNode}}::Dispatcher(*copy.\_dispatcher))}
\DoxyCodeLine{00045\ \{}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00053\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classComputeNode_a3b3f82edf2dd7735fda97c6ca7b0b32f}{ComputeNode::}}}
\DoxyCodeLine{00054\ \mbox{\hyperlink{classComputeNode_a3b3f82edf2dd7735fda97c6ca7b0b32f}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00064\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classComputeNode_a994083600d18b214e813e66f82ba6d6e}{ComputeNode::}}}
\DoxyCodeLine{00065\ \mbox{\hyperlink{classComputeNode_a994083600d18b214e813e66f82ba6d6e}{safe\_to\_combine}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00066\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00067\ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00074\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_a1f1b4b711b591f2a2245a6296e43cc16}{ComputeNode::}}}
\DoxyCodeLine{00075\ \mbox{\hyperlink{classComputeNode_a1f1b4b711b591f2a2245a6296e43cc16}{add\_for\_draw}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{if}\ (pgraph\_cat.is\_spam())\ \{}
\DoxyCodeLine{00077\ \ \ \ \ pgraph\_cat.spam()}
\DoxyCodeLine{00078\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Found\ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\ in\ state\ "{}}\ <<\ *data.\_state}
\DoxyCodeLine{00079\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ draw\_mask\ =\ "{}}\ <<\ data.\_draw\_mask\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00080\ \ \ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{comment}{//\ OK,\ render\ this\ node.\ \ Rendering\ this\ node\ means\ creating\ a}}
\DoxyCodeLine{00083\ \ \ \textcolor{comment}{//\ CullableObject\ for\ the\ Dispatcher.\ \ We\ don't\ need\ to\ pass\ any\ Geoms,}}
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ however.}}
\DoxyCodeLine{00085\ \ \ \mbox{\hyperlink{classCullableObject}{CullableObject}}\ object(\textcolor{keyword}{nullptr},\ data.\_state,}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.get\_internal\_transform(trav));}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordtype}{object}.set\_draw\_callback(\_dispatcher);}
\DoxyCodeLine{00088\ \ \ trav-\/>get\_cull\_handler()-\/>\mbox{\hyperlink{classCullHandler_a35e3215f1c647c0ce091d234a9afa57c}{record\_object}}(std::move(\textcolor{keywordtype}{object}),\ trav);}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00096\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_aa32ea4a55c8742f30273b3e35eaa90d3}{ComputeNode::}}}
\DoxyCodeLine{00097\ \mbox{\hyperlink{classComputeNode_aa32ea4a55c8742f30273b3e35eaa90d3}{output}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00098\ \ \ PandaNode::output(out);}
\DoxyCodeLine{00099\ \}}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00104\ ComputeNode::Dispatcher::}
\DoxyCodeLine{00105\ Dispatcher()\ \{}
\DoxyCodeLine{00106\ \}}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00111\ ComputeNode::Dispatcher::}
\DoxyCodeLine{00112\ Dispatcher(\textcolor{keyword}{const}\ Dispatcher\ \&copy)\ :}
\DoxyCodeLine{00113\ \ \ \_cycler(copy.\_cycler)}
\DoxyCodeLine{00114\ \{}
\DoxyCodeLine{00115\ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00120\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_ae3646dabbe694632c6f1ccfc855ba6c9}{ComputeNode::Dispatcher::}}}
\DoxyCodeLine{00121\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_ae3646dabbe694632c6f1ccfc855ba6c9}{do\_callback}}(\mbox{\hyperlink{classCallbackData}{CallbackData}}\ *cbdata)\ \{}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{classGeomDrawCallbackData}{GeomDrawCallbackData}}\ *data\ =\ (\mbox{\hyperlink{classGeomDrawCallbackData}{GeomDrawCallbackData}}\ *)cbdata;}
\DoxyCodeLine{00123\ \ \ \mbox{\hyperlink{classGraphicsStateGuardianBase}{GraphicsStateGuardianBase}}\ *gsg\ =\ data-\/>\mbox{\hyperlink{classGraphicsStateGuardianBase_aa5cb7468a2b7974197fca2c5dbe654fe}{get\_gsg}}();}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \mbox{\hyperlink{classCycleDataReader}{CDReader}}\ cdata(\_cycler);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ LVecBase3i\ \&dispatch\ :\ cdata-\/>\_dispatches)\ \{}
\DoxyCodeLine{00128\ \ \ \ \ gsg-\/>dispatch\_compute(dispatch[0],\ dispatch[1],\ dispatch[2]);}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{comment}{//\ No\ need\ to\ upcall;\ we\ don't\ have\ any\ geometry,\ after\ all.}}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_a542c7d0be4a3f8a091be7086a046e1fd}{ComputeNode::}}}
\DoxyCodeLine{00138\ \mbox{\hyperlink{classComputeNode_a542c7d0be4a3f8a091be7086a046e1fd}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00139\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classComputeNode_a68664c2aa6e255a58fe4d0a84f2812d8}{make\_from\_bam}});}
\DoxyCodeLine{00140\ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00146\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_ae4d24964f4192bf015b1a201b4fc049b}{ComputeNode::}}}
\DoxyCodeLine{00147\ \mbox{\hyperlink{classComputeNode_ae4d24964f4192bf015b1a201b4fc049b}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{classPandaNode_ae9b3055297ade9bbf4a3b4dfc77e4506}{PandaNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00149\ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a4a957fdbd6f508ee3029a41a794030cd}{write\_cdata}}(dg,\ \_dispatcher-\/>\_cycler);}
\DoxyCodeLine{00150\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00157\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classComputeNode_a68664c2aa6e255a58fe4d0a84f2812d8}{ComputeNode::}}}
\DoxyCodeLine{00158\ \mbox{\hyperlink{classComputeNode_a68664c2aa6e255a58fe4d0a84f2812d8}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{classComputeNode}{ComputeNode}}\ *node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classComputeNode_a2d42070c13faa0cf86222b48546b5d59}{ComputeNode}}(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00160\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00164\ \ \ node-\/>\mbox{\hyperlink{classComputeNode_a82a69260b8b9aed8fb02262da494ca38}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{return}\ node;}
\DoxyCodeLine{00167\ \}}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00173\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_a82a69260b8b9aed8fb02262da494ca38}{ComputeNode::}}}
\DoxyCodeLine{00174\ \mbox{\hyperlink{classComputeNode_a82a69260b8b9aed8fb02262da494ca38}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classPandaNode_a924d7f721627231f4504db71809ad2c2}{PandaNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00176\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ae63d90cd5d2c87fe3159f6b5d6d9fe10}{read\_cdata}}(scan,\ \_dispatcher-\/>\_cycler);}
\DoxyCodeLine{00177\ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00182\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *ComputeNode::Dispatcher::CData::}
\DoxyCodeLine{00183\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{00185\ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00191\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_1_1CData_ab1683e56fc317c2700755b20a37ad9b7}{ComputeNode::Dispatcher::CData::}}}
\DoxyCodeLine{00192\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_1_1CData_ab1683e56fc317c2700755b20a37ad9b7}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00193\ \ \ dg.add\_uint16(\_dispatches.size());}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ LVecBase3i\ \&dispatch\ :\ \_dispatches)\ \{}
\DoxyCodeLine{00196\ \ \ \ \ generic\_write\_datagram(dg,\ dispatch);}
\DoxyCodeLine{00197\ \ \ \}}
\DoxyCodeLine{00198\ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00204\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_1_1CData_a5d7d6f9eb33ec3d10b746d8eed82d2c6}{ComputeNode::Dispatcher::CData::}}}
\DoxyCodeLine{00205\ \mbox{\hyperlink{classComputeNode_1_1Dispatcher_1_1CData_a5d7d6f9eb33ec3d10b746d8eed82d2c6}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordtype}{int}\ num\_dispatches\ =\ scan.get\_uint16();}
\DoxyCodeLine{00207\ \ \ \_dispatches.resize(num\_dispatches);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_dispatches;\ ++i)\ \{}
\DoxyCodeLine{00210\ \ \ \ \ generic\_read\_datagram(\_dispatches[i],\ scan);}
\DoxyCodeLine{00211\ \ \ \}}
\DoxyCodeLine{00212\ \}}

\end{DoxyCode}
