\doxysection{dcast.\+h}
\hypertarget{dcast_8h_source}{}\label{dcast_8h_source}\index{panda/src/express/dcast.h@{panda/src/express/dcast.h}}
\mbox{\hyperlink{dcast_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ DCAST\_H}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ DCAST\_H}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{typeHandle_8h}{typeHandle.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{typedObject_8h}{typedObject.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__express_8h}{config\_express.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{//\ The\ DCAST\ (downcast)\ macro\ is\ defined\ as\ a\ convenience\ for\ downcasting\ from}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ some\ TypedObject\ pointer\ (or\ a\ PointerTo).\ \ It's\ just\ a\ normal\ C++-\/style}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ downcast,\ except\ it\ first\ checks\ get\_type()\ to\ make\ sure\ the\ downcasting\ is}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ safe.\ \ If\ you\ compile\ with\ NDEBUG,\ or\ set\ verify-\/dcast\ to\ \#f,\ this\ check\ is}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ removed.}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{comment}{//\ DCAST\ will\ return\ NULL\ if\ the\ downcasting\ is\ unsafe.\ \ If\ you'd\ rather\ it}}
\DoxyCodeLine{00030\ \textcolor{comment}{//\ abort\ out\ of\ the\ function\ (a\ la\ nassertvnassertr),\ then\ see\ DCAST\_INTO\_V}}
\DoxyCodeLine{00031\ \textcolor{comment}{//\ and\ DCAST\_INTO\_R,\ below.}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ WantType>}
\DoxyCodeLine{00034\ INLINE\ WantType\ *\_dcast(WantType\ *,\ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *ptr);}
\DoxyCodeLine{00035\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ WantType>}
\DoxyCodeLine{00036\ INLINE\ \textcolor{keyword}{const}\ WantType\ *\_dcast(WantType\ *,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *ptr);}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{comment}{//\ Note:\ it\ is\ important\ that\ DCAST\ not\ repeat\ the\ pointer\ parameter,\ since}}
\DoxyCodeLine{00039\ \textcolor{comment}{//\ many\ users\ of\ DCAST\ may\ want\ to\ use\ the\ result\ of\ a\ function\ as\ the\ pointer}}
\DoxyCodeLine{00040\ \textcolor{comment}{//\ parameter,\ and\ it\ could\ be\ terribly\ confusing\ and\ difficult\ to\ trace\ if\ the}}
\DoxyCodeLine{00041\ \textcolor{comment}{//\ function\ were\ inadvertently\ executed\ twice.\ \ This\ happened!}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#define\ DCAST(want\_type,\ pointer)\ \_dcast((want\_type*)0,\ pointer)}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{comment}{//\ DCAST\_INTO\_V\ and\ DCAST\_INTO\_R\ are\ similar\ in\ purpose\ to\ DCAST,\ except\ they:}}
\DoxyCodeLine{00045\ \textcolor{comment}{//\ (a)\ automatically\ assign\ a\ variable\ instead\ of\ returning\ the\ downcasted}}
\DoxyCodeLine{00046\ \textcolor{comment}{//\ pointer,\ and\ (b)\ they\ immediately\ return\ out\ of\ the\ function\ if\ the}}
\DoxyCodeLine{00047\ \textcolor{comment}{//\ downcasting\ fails.\ \ DCAST\_INTO\_V\ is\ for\ use\ in\ a\ void\ function\ and\ returns}}
\DoxyCodeLine{00048\ \textcolor{comment}{//\ nothing;\ DCAST\_INTO\_R\ is\ for\ use\ in\ a\ non-\/void\ function\ and\ returns\ the}}
\DoxyCodeLine{00049\ \textcolor{comment}{//\ indicated\ value.}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{comment}{//\ Both\ DCAST\_INTO\_V\ and\ DCAST\_INTO\_R\ accept\ as\ the\ first\ parameter\ a\ variable}}
\DoxyCodeLine{00052\ \textcolor{comment}{//\ of\ type\ (want\_type\ *)\ or\ (const\ want\_type\ *),\ instead\ of\ the\ name\ of\ the}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ type.\ \ This\ variable\ will\ be\ filled\ with\ the\ new\ pointer.}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \textcolor{comment}{//\ \_dcast\_ref\ is\ used\ to\ implement\ DCAST\_INTO\_V\ and\ DCAST\_INTO\_R.\ \ Its}}
\DoxyCodeLine{00057\ \textcolor{comment}{//\ difference\ from\ \_dcast\ is\ that\ it\ takes\ a\ reference\ to\ a\ pointer\ as\ a\ first}}
\DoxyCodeLine{00058\ \textcolor{comment}{//\ parameter.\ \ The\ main\ point\ of\ this\ is\ to\ shut\ up\ the\ compiler\ about}}
\DoxyCodeLine{00059\ \textcolor{comment}{//\ pointers\ used\ before\ their\ value\ is\ assigned.}}
\DoxyCodeLine{00060\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ WantType>}
\DoxyCodeLine{00061\ INLINE\ WantType\ *\_dcast\_ref(WantType\ *\&,\ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *ptr);}
\DoxyCodeLine{00062\ \textcolor{keyword}{template}<\textcolor{keyword}{class}\ WantType>}
\DoxyCodeLine{00063\ INLINE\ \textcolor{keyword}{const}\ WantType\ *\_dcast\_ref(WantType\ *\&,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *ptr);}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \textcolor{comment}{//\ \_dcast\_verify\ performs\ the\ actual\ verification.\ \ This\ is\ an\ empty\ function}}
\DoxyCodeLine{00066\ \textcolor{comment}{//\ when\ DO\_DCAST\ is\ not\ set,\ but\ we\ still\ need\ to\ define\ it\ for\ ABI}}
\DoxyCodeLine{00067\ \textcolor{comment}{//\ compatibility\ reasons.}}
\DoxyCodeLine{00068\ EXPCL\_PANDA\_EXPRESS\ \textcolor{keywordtype}{bool}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{dcast_8h_a3f259c0f153d80c11b288659ecba5448}{\_dcast\_verify}}(\mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ want\_handle,\ \textcolor{keywordtype}{size\_t}\ want\_size,}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classTypedObject}{TypedObject}}\ *ptr);}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#define\ DCAST\_INTO\_V(to\_pointer,\ from\_pointer)\ \(\backslash\)}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\ \ \{\ \(\backslash\)}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\ \ \ \ (to\_pointer)\ =\ \_dcast\_ref(to\_pointer,\ from\_pointer);\ \(\backslash\)}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\ \ \ \ nassertv((void\ *)(to\_pointer)\ !=\ nullptr);\ \(\backslash\)}}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\ \ \}}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#define\ DCAST\_INTO\_R(to\_pointer,\ from\_pointer,\ return\_value)\ \(\backslash\)}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\ \ \{\ \(\backslash\)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ \ \ (to\_pointer)\ =\ \_dcast\_ref(to\_pointer,\ from\_pointer);\ \(\backslash\)}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\ \ \ \ nassertr((void\ *)(to\_pointer)\ !=\ nullptr,\ return\_value);\ \(\backslash\)}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\ \ \}}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#include\ "{}dcast.T"{}}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
