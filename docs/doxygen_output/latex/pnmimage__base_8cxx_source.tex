\doxysection{pnmimage\+\_\+base.\+cxx}
\hypertarget{pnmimage__base_8cxx_source}{}\label{pnmimage__base_8cxx_source}\index{panda/src/pnmimage/pnmimage\_base.cxx@{panda/src/pnmimage/pnmimage\_base.cxx}}
\mbox{\hyperlink{pnmimage__base_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmimage__base_8h}{pnmimage\_base.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{streamReader_8h}{streamReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{streamWriter_8h}{streamWriter.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pnmimage_8h}{config\_pnmimage.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <stdarg.h>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <stdio.h>}\ \ \ \textcolor{comment}{//\ for\ sprintf()}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00023\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00029\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00030\ \mbox{\hyperlink{pnmimage__base_8cxx_ad068a2eb73e7fdeb9c4bf9bfb3dfb05c}{pm\_message}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *format,\ ...)\ \{}
\DoxyCodeLine{00031\ \ \ va\_list\ ap;}
\DoxyCodeLine{00032\ \ \ va\_start(ap,\ format);}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ buffer\_size\ =\ 1024;}
\DoxyCodeLine{00035\ \ \ \textcolor{keywordtype}{char}\ buffer[buffer\_size];}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \ \ vsnprintf(buffer,\ buffer\_size,\ format,\ ap);}
\DoxyCodeLine{00038\ \ \ va\_end(ap);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ nassertv(strlen(buffer)\ <\ buffer\_size);}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ pnmimage\_cat.info()\ <<\ buffer\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00043\ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00049\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00050\ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *format,\ ...)\ \{}
\DoxyCodeLine{00051\ \ \ va\_list\ ap;}
\DoxyCodeLine{00052\ \ \ va\_start(ap,\ format);}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ buffer\_size\ =\ 1024;}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{char}\ buffer[buffer\_size\ +\ 1];}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ vsnprintf(buffer,\ buffer\_size,\ format,\ ap);}
\DoxyCodeLine{00058\ \ \ buffer[buffer\_size]\ =\ 0;}
\DoxyCodeLine{00059\ \ \ va\_end(ap);}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ pnmimage\_cat.error()\ <<\ buffer\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{comment}{//\ Now\ we're\ supposed\ to\ exit.\ \ Inconvenient\ if\ we\ were\ running\ Panda}}
\DoxyCodeLine{00064\ \ \ \textcolor{comment}{//\ interactively,\ but\ that's\ the\ way\ it\ is.}}
\DoxyCodeLine{00065\ \ \ exit(1);}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00071\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00072\ \mbox{\hyperlink{pnmimage__base_8cxx_a1bf8e23f6b57553095e12e7cd3dd827b}{pm\_maxvaltobits}}(\textcolor{keywordtype}{int}\ maxval)\ \{}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordtype}{int}\ bits\ =\ 1;}
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{while}\ (maxval\ >\ \mbox{\hyperlink{pnmimage__base_8cxx_a41a6d3019e037c222144c545201f0416}{pm\_bitstomaxval}}(bits))\ \{}
\DoxyCodeLine{00075\ \ \ \ \ bits++;}
\DoxyCodeLine{00076\ \ \ \ \ nassertr(bits\ !=\ 0,\ 16);}
\DoxyCodeLine{00077\ \ \ \}}
\DoxyCodeLine{00078\ \ \ \textcolor{keywordflow}{return}\ bits;}
\DoxyCodeLine{00079\ \}}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00086\ \mbox{\hyperlink{pnmimage__base_8cxx_a41a6d3019e037c222144c545201f0416}{pm\_bitstomaxval}}(\textcolor{keywordtype}{int}\ bits)\ \{}
\DoxyCodeLine{00087\ \ \ \textcolor{keywordflow}{return}\ (\ 1\ <<\ bits\ )\ -\/\ 1;}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{char}\ *}
\DoxyCodeLine{00094\ \mbox{\hyperlink{pnmimage__base_8cxx_a25394444a98c0d706f0b1d3ff528ebcb}{pm\_allocrow}}(\textcolor{keywordtype}{int}\ cols,\ \textcolor{keywordtype}{int}\ size)\ \{}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{char}\ *)PANDA\_MALLOC\_ARRAY(cols\ *\ size);}
\DoxyCodeLine{00096\ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00101\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00102\ \mbox{\hyperlink{pnmimage__base_8cxx_a76da6b18632c647228fbd452db5d0825}{pm\_freerow}}(\textcolor{keywordtype}{char}\ *itrow)\ \{}
\DoxyCodeLine{00103\ \ \ PANDA\_FREE\_ARRAY(itrow);}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{comment}{/*\ Endian\ I/O.}}
\DoxyCodeLine{00108\ \textcolor{comment}{*/}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00111\ pm\_readbigshort(istream\ *in,\ \textcolor{keywordtype}{short}\ *sP)\ \{}
\DoxyCodeLine{00112\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ reader(in,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00113\ \ \ *sP\ =\ reader.get\_be\_int16();}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{return}\ (!in-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00115\ \}}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00118\ pm\_writebigshort(ostream\ *out,\ \textcolor{keywordtype}{short}\ s)\ \{}
\DoxyCodeLine{00119\ \ \ \mbox{\hyperlink{classStreamWriter}{StreamWriter}}\ writer(out,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00120\ \ \ writer.add\_be\_int16(s);}
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{return}\ (!out-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00122\ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00125\ pm\_readbiglong(istream\ *in,\ \textcolor{keywordtype}{long}\ *lP)\ \{}
\DoxyCodeLine{00126\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ reader(in,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00127\ \ \ *lP\ =\ reader.get\_be\_int32();}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{return}\ (!in-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00132\ pm\_writebiglong(ostream\ *out,\ \textcolor{keywordtype}{long}\ l)\ \{}
\DoxyCodeLine{00133\ \ \ \mbox{\hyperlink{classStreamWriter}{StreamWriter}}\ writer(out,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00134\ \ \ writer.add\_be\_int32(l);}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{return}\ (!out-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00136\ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00139\ pm\_readlittleshort(istream\ *in,\ \textcolor{keywordtype}{short}\ *sP)\ \{}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ reader(in,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00141\ \ \ *sP\ =\ reader.get\_int16();}
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{return}\ (!in-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00143\ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00146\ pm\_writelittleshort(ostream\ *out,\ \textcolor{keywordtype}{short}\ s)\ \{}
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{classStreamWriter}{StreamWriter}}\ writer(out,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00148\ \ \ writer.add\_int16(s);}
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{return}\ (!out-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00150\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00153\ pm\_readlittlelong(istream\ *in,\ \textcolor{keywordtype}{long}\ *lP)\ \{}
\DoxyCodeLine{00154\ \ \ \mbox{\hyperlink{classStreamReader}{StreamReader}}\ reader(in,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00155\ \ \ *lP\ =\ reader.get\_int32();}
\DoxyCodeLine{00156\ \ \ \textcolor{keywordflow}{return}\ (!in-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00160\ pm\_writelittlelong(ostream\ *out,\ \textcolor{keywordtype}{long}\ l)\ \{}
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{classStreamWriter}{StreamWriter}}\ writer(out,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00162\ \ \ writer.add\_int32(l);}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordflow}{return}\ (!out-\/>fail())\ ?\ 0\ :\ -\/1;}
\DoxyCodeLine{00164\ \}}

\end{DoxyCode}
