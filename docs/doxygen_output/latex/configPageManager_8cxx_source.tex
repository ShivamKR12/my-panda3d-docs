\doxysection{config\+Page\+Manager.\+cxx}
\hypertarget{configPageManager_8cxx_source}{}\label{configPageManager_8cxx_source}\index{dtool/src/prc/configPageManager.cxx@{dtool/src/prc/configPageManager.cxx}}
\mbox{\hyperlink{configPageManager_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configPageManager_8h}{configPageManager.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configDeclaration_8h}{configDeclaration.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableBool_8h}{configVariableBool.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableString_8h}{configVariableString.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configPage_8h}{configPage.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{prcKeyRegistry_8h}{prcKeyRegistry.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dSearchPath_8h}{dSearchPath.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{executionEnvironment_8h}{executionEnvironment.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__prc_8h}{config\_prc.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pfstream_8h}{pfstream.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandaSystem_8h}{pandaSystem.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textEncoder_8h}{textEncoder.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stringDecoder_8h}{stringDecoder.h}}"{}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{comment}{//\ This\ file\ is\ generated\ by\ ppremake.}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}prc\_parameters.h"{}}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{comment}{//\ Pick\ up\ the\ public\ key\ definitions.}}
\DoxyCodeLine{00034\ \textcolor{preprocessor}{\#ifdef\ PRC\_PUBLIC\_KEYS\_INCLUDE}}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ PRC\_PUBLIC\_KEYS\_INCLUDE}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <algorithm>}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ <ctype.h>}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#ifndef\ \_WIN32}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ <dlfcn.h>}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \mbox{\hyperlink{classConfigPageManager}{ConfigPageManager}}\ *ConfigPageManager::\_global\_ptr\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00054\ \mbox{\hyperlink{classConfigPageManager_adf5c1aa9ce9014fdb385281bda582fee}{ConfigPageManager::}}}
\DoxyCodeLine{00055\ \mbox{\hyperlink{classConfigPageManager_adf5c1aa9ce9014fdb385281bda582fee}{ConfigPageManager}}()\ \{}
\DoxyCodeLine{00056\ \ \ \_next\_page\_seq\ =\ 1;}
\DoxyCodeLine{00057\ \ \ \_loaded\_implicit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00058\ \ \ \_currently\_loading\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00059\ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#ifdef\ PRC\_PUBLIC\_KEYS\_INCLUDE}}
\DoxyCodeLine{00062\ \ \ \textcolor{comment}{//\ Record\ the\ public\ keys\ in\ the\ registry\ at\ startup\ time.}}
\DoxyCodeLine{00063\ \ \ PrcKeyRegistry::get\_global\_ptr()-\/>record\_keys(prc\_pubkeys,\ num\_prc\_pubkeys);}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_PUBLIC\_KEYS\_INCLUDE}}
\DoxyCodeLine{00065\ \}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00071\ \mbox{\hyperlink{classConfigPageManager_ae585cc8f68a16c13eef5f3bc2efcaf7d}{ConfigPageManager::}}}
\DoxyCodeLine{00072\ \mbox{\hyperlink{classConfigPageManager_ae585cc8f68a16c13eef5f3bc2efcaf7d}{\string~ConfigPageManager}}()\ \{}
\DoxyCodeLine{00073\ \ \ prc\_cat-\/>error()}
\DoxyCodeLine{00074\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Internal\ error-\/-\/ConfigPageManager\ destructor\ called!\(\backslash\)n"{}};}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00084\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classConfigPageManager_acff7bc5d4a2abc84f8cabfa54e55ee1b}{ConfigPageManager::}}}
\DoxyCodeLine{00085\ \mbox{\hyperlink{classConfigPageManager_acff7bc5d4a2abc84f8cabfa54e55ee1b}{reload\_implicit\_pages}}()\ \{}
\DoxyCodeLine{00086\ \ \ \textcolor{keywordflow}{if}\ (\_currently\_loading)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ recursion\ protector.\ \ We\ can\ get\ recursion\ feedback\ between}}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//\ config\ and\ notify,\ as\ each\ tries\ to\ use\ the\ other\ at\ construction.}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00090\ \ \ \}}
\DoxyCodeLine{00091\ \ \ \_currently\_loading\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \textcolor{comment}{//\ First,\ remove\ all\ the\ previously-\/loaded\ pages.}}
\DoxyCodeLine{00094\ \ \ Pages::iterator\ pi;}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{for}\ (pi\ =\ \_implicit\_pages.begin();\ pi\ !=\ \_implicit\_pages.end();\ ++pi)\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{delete}\ (*pi);}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \ \ \_implicit\_pages.clear();}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#ifndef\ ANDROID}}
\DoxyCodeLine{00101\ \ \ \textcolor{comment}{//\ If\ we\ are\ running\ inside\ a\ deployed\ application,\ see\ if\ it\ exposes}}
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ information\ about\ how\ the\ PRC\ data\ should\ be\ initialized.}}
\DoxyCodeLine{00103\ \ \ \textcolor{keyword}{struct\ }BlobInfo\ \{}
\DoxyCodeLine{00104\ \ \ \ \ uint64\_t\ blob\_offset;}
\DoxyCodeLine{00105\ \ \ \ \ uint64\_t\ blob\_size;}
\DoxyCodeLine{00106\ \ \ \ \ uint16\_t\ version;}
\DoxyCodeLine{00107\ \ \ \ \ uint16\_t\ num\_pointers;}
\DoxyCodeLine{00108\ \ \ \ \ uint16\_t\ codepage;}
\DoxyCodeLine{00109\ \ \ \ \ uint16\_t\ flags;}
\DoxyCodeLine{00110\ \ \ \ \ uint64\_t\ reserved;}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *module\_table;}
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_data;}
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *default\_prc\_dir;}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_dir\_envvars;}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_path\_envvars;}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_patterns;}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_encrypted\_patterns;}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_encryption\_key;}
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_executable\_patterns;}
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *prc\_executable\_args\_envvar;}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *main\_dir;}
\DoxyCodeLine{00122\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *log\_filename;}
\DoxyCodeLine{00123\ \ \ \};}
\DoxyCodeLine{00124\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00125\ \ \ \textcolor{keyword}{const}\ BlobInfo\ *blobinfo\ =\ (\textcolor{keyword}{const}\ BlobInfo\ *)GetProcAddress(GetModuleHandle(\textcolor{keyword}{nullptr}),\ \textcolor{stringliteral}{"{}blobinfo"{}});}
\DoxyCodeLine{00126\ \textcolor{preprocessor}{\#elif\ defined(RTLD\_MAIN\_ONLY)}}
\DoxyCodeLine{00127\ \ \ \textcolor{keyword}{const}\ BlobInfo\ *blobinfo\ =\ (\textcolor{keyword}{const}\ BlobInfo\ *)dlsym(RTLD\_MAIN\_ONLY,\ \textcolor{stringliteral}{"{}blobinfo"{}});}
\DoxyCodeLine{00128\ \textcolor{comment}{//\#elif\ defined(RTLD\_SELF)}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ \ const\ BlobInfo\ *blobinfo\ =\ (const\ BlobInfo\ *)dlsym(RTLD\_SELF,\ "{}blobinfo"{});}}
\DoxyCodeLine{00130\ \textcolor{preprocessor}{\#elif\ defined(\_\_EMSCRIPTEN\_\_)}}
\DoxyCodeLine{00131\ \ \ \textcolor{keyword}{const}\ BlobInfo\ *blobinfo\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00132\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00133\ \ \ \textcolor{keyword}{const}\ BlobInfo\ *blobinfo\ =\ (\textcolor{keyword}{const}\ BlobInfo\ *)dlsym(dlopen(\textcolor{keyword}{nullptr},\ RTLD\_NOW),\ \textcolor{stringliteral}{"{}blobinfo"{}});}
\DoxyCodeLine{00134\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00136\ \textcolor{preprocessor}{\#if\ !defined(\_WIN32)\ \&\&\ !defined(\_\_EMSCRIPTEN\_\_)}}
\DoxyCodeLine{00137\ \ \ \ \ \textcolor{comment}{//\ Clear\ the\ error\ flag.}}
\DoxyCodeLine{00138\ \ \ \ \ dlerror();}
\DoxyCodeLine{00139\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00140\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (blobinfo-\/>version\ ==\ 0\ ||\ blobinfo-\/>num\_pointers\ <\ 10)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ blobinfo\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{if}\ (blobinfo-\/>num\_pointers\ >=\ 11\ \&\&\ blobinfo-\/>main\_dir\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \ \ ExecutionEnvironment::set\_environment\_variable(\textcolor{stringliteral}{"{}MAIN\_DIR"{}},\ blobinfo-\/>main\_dir);}
\DoxyCodeLine{00147\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ that\ py\_panda.cxx\ won't\ override\ MAIN\_DIR.}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ ExecutionEnvironment::set\_environment\_variable(\textcolor{stringliteral}{"{}MAIN\_DIR"{}},}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ ExecutionEnvironment::get\_environment\_variable(\textcolor{stringliteral}{"{}MAIN\_DIR"{}}));}
\DoxyCodeLine{00151\ \ \ \ \ \}}
\DoxyCodeLine{00152\ \ \ \}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \textcolor{comment}{//\ PRC\_PATTERNS\ lists\ one\ or\ more\ filename\ templates\ separated\ by\ spaces.}}
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ Pull\ them\ out\ and\ store\ them\ in\ \_prc\_patterns.}}
\DoxyCodeLine{00156\ \ \ \_prc\_patterns.clear();}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \textcolor{preprocessor}{\#ifdef\ PRC\_PATTERNS}}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordtype}{string}\ prc\_patterns\ =\ PRC\_PATTERNS;}
\DoxyCodeLine{00160\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_patterns\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00161\ \ \ \ \ prc\_patterns\ =\ blobinfo-\/>prc\_patterns;}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ \ \ \textcolor{keywordflow}{if}\ (!prc\_patterns.empty())\ \{}
\DoxyCodeLine{00164\ \ \ \ \ vector\_string\ pat\_list;}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_patterns,\ pat\_list);}
\DoxyCodeLine{00166\ \ \ \ \ \_prc\_patterns.reserve(pat\_list.size());}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ pat\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \mbox{\hyperlink{classGlobPattern}{GlobPattern}}\ glob(pat\_list[i]);}
\DoxyCodeLine{00169\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{comment}{//\ On\ windows,\ the\ file\ system\ is\ case-\/insensitive,\ so\ the\ pattern}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \textcolor{comment}{//\ should\ be\ too.}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ glob.set\_case\_sensitive(\textcolor{keyword}{false});}
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ WIN32}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \_prc\_patterns.push\_back(glob);}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ \ \ \}}
\DoxyCodeLine{00177\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_PATTERNS}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{comment}{//\ Similarly\ for\ PRC\_ENCRYPTED\_PATTERNS.}}
\DoxyCodeLine{00180\ \ \ \_prc\_encrypted\_patterns.clear();}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \textcolor{preprocessor}{\#ifdef\ PRC\_ENCRYPTED\_PATTERNS}}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordtype}{string}\ prc\_encrypted\_patterns\ =\ PRC\_ENCRYPTED\_PATTERNS;}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_encrypted\_patterns\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00185\ \ \ \ \ prc\_encrypted\_patterns\ =\ blobinfo-\/>prc\_encrypted\_patterns;}
\DoxyCodeLine{00186\ \ \ \}}
\DoxyCodeLine{00187\ \ \ \textcolor{keywordflow}{if}\ (!prc\_encrypted\_patterns.empty())\ \{}
\DoxyCodeLine{00188\ \ \ \ \ vector\_string\ pat\_list;}
\DoxyCodeLine{00189\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_encrypted\_patterns,\ pat\_list);}
\DoxyCodeLine{00190\ \ \ \ \ \_prc\_encrypted\_patterns.reserve(pat\_list.size());}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ pat\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \mbox{\hyperlink{classGlobPattern}{GlobPattern}}\ glob(pat\_list[i]);}
\DoxyCodeLine{00193\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ glob.set\_case\_sensitive(\textcolor{keyword}{false});}
\DoxyCodeLine{00195\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ WIN32}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \_prc\_encrypted\_patterns.push\_back(glob);}
\DoxyCodeLine{00197\ \ \ \ \ \}}
\DoxyCodeLine{00198\ \ \ \}}
\DoxyCodeLine{00199\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_ENCRYPTED\_PATTERNS}}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{comment}{//\ And\ again\ for\ PRC\_EXECUTABLE\_PATTERNS.}}
\DoxyCodeLine{00202\ \ \ \_prc\_executable\_patterns.clear();}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \textcolor{preprocessor}{\#ifdef\ PRC\_EXECUTABLE\_PATTERNS}}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordtype}{string}\ prc\_executable\_patterns\ =\ PRC\_EXECUTABLE\_PATTERNS;}
\DoxyCodeLine{00206\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_executable\_patterns\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00207\ \ \ \ \ prc\_executable\_patterns\ =\ blobinfo-\/>prc\_executable\_patterns;}
\DoxyCodeLine{00208\ \ \ \}}
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{if}\ (!prc\_executable\_patterns.empty())\ \{}
\DoxyCodeLine{00210\ \ \ \ \ vector\_string\ pat\_list;}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_executable\_patterns,\ pat\_list);}
\DoxyCodeLine{00212\ \ \ \ \ \_prc\_executable\_patterns.reserve(pat\_list.size());}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ pat\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \mbox{\hyperlink{classGlobPattern}{GlobPattern}}\ glob(pat\_list[i]);}
\DoxyCodeLine{00215\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ glob.set\_case\_sensitive(\textcolor{keyword}{false});}
\DoxyCodeLine{00217\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ WIN32}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \_prc\_executable\_patterns.push\_back(glob);}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \}}
\DoxyCodeLine{00221\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_EXECUTABLE\_PATTERNS}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{comment}{//\ Now\ build\ up\ the\ search\ path\ for\ .prc\ files.}}
\DoxyCodeLine{00224\ \ \ \_search\_path.clear();}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \textcolor{preprocessor}{\#ifdef\ PRC\_DIR\_ENVVARS}}
\DoxyCodeLine{00227\ \ \ \textcolor{comment}{//\ PRC\_DIR\_ENVVARS\ lists\ one\ or\ more\ environment\ variables\ separated\ by}}
\DoxyCodeLine{00228\ \ \ \textcolor{comment}{//\ spaces.\ \ Pull\ them\ out,\ and\ each\ of\ those\ contains\ the\ name\ of\ a\ single}}
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ directory\ to\ search.\ \ Add\ it\ to\ the\ search\ path.}}
\DoxyCodeLine{00230\ \ \ \textcolor{keywordtype}{string}\ prc\_dir\_envvars\ =\ PRC\_DIR\_ENVVARS;}
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_dir\_envvars\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00232\ \ \ \ \ prc\_dir\_envvars\ =\ blobinfo-\/>prc\_dir\_envvars;}
\DoxyCodeLine{00233\ \ \ \}}
\DoxyCodeLine{00234\ \ \ \textcolor{keywordflow}{if}\ (!prc\_dir\_envvars.empty())\ \{}
\DoxyCodeLine{00235\ \ \ \ \ vector\_string\ prc\_dir\_envvar\_list;}
\DoxyCodeLine{00236\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_dir\_envvars,\ prc\_dir\_envvar\_list);}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ prc\_dir\_envvar\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ prc\_dir\ =\ ExecutionEnvironment::get\_environment\_variable(prc\_dir\_envvar\_list[i]);}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!prc\_dir.empty())\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ prc\_dir\_filename\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(prc\_dir);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ prc\_dir\_filename.\mbox{\hyperlink{classFilename_aa37b95cb83d8f58f2caf0b8d8ff9d628}{make\_true\_case}}();}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_auto\_prc\_dir(prc\_dir\_filename))\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \_search\_path.append\_directory(prc\_dir\_filename);}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \}}
\DoxyCodeLine{00248\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_DIR\_ENVVARS}}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \textcolor{preprocessor}{\#ifdef\ PRC\_PATH\_ENVVARS}}
\DoxyCodeLine{00251\ \ \ \textcolor{comment}{//\ PRC\_PATH\_ENVVARS\ lists\ one\ or\ more\ environment\ variables\ separated\ by}}
\DoxyCodeLine{00252\ \ \ \textcolor{comment}{//\ spaces.\ \ Pull\ them\ out,\ and\ then\ each\ one\ of\ those\ contains\ a\ list\ of}}
\DoxyCodeLine{00253\ \ \ \textcolor{comment}{//\ directories\ to\ search.\ \ Add\ each\ of\ those\ to\ the\ search\ path.}}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordtype}{string}\ prc\_path\_envvars\ =\ PRC\_PATH\_ENVVARS;}
\DoxyCodeLine{00255\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_path\_envvars\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00256\ \ \ \ \ prc\_path\_envvars\ =\ blobinfo-\/>prc\_path\_envvars;}
\DoxyCodeLine{00257\ \ \ \}}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordflow}{if}\ (!prc\_path\_envvars.empty())\ \{}
\DoxyCodeLine{00259\ \ \ \ \ vector\_string\ prc\_path\_envvar\_list;}
\DoxyCodeLine{00260\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_path\_envvars,\ prc\_path\_envvar\_list);}
\DoxyCodeLine{00261\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ prc\_path\_envvar\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ path\ =\ ExecutionEnvironment::get\_environment\_variable(prc\_path\_envvar\_list[i]);}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ p\ =\ 0;}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (p\ <\ path.length())\ \{}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ q\ =\ path.find\_first\_of(DEFAULT\_PATHSEP,\ p);}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (q\ ==\ string::npos)\ \{}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ q\ =\ path.length();}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ prc\_dir\_filename\ =\ \mbox{\hyperlink{classFilename_ab17a80adaab942d6570d114d6f0675c3}{Filename::from\_os\_specific}}(path.substr(p,\ q\ -\/\ p));}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ prc\_dir\_filename.\mbox{\hyperlink{classFilename_aa37b95cb83d8f58f2caf0b8d8ff9d628}{make\_true\_case}}();}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_auto\_prc\_dir(prc\_dir\_filename))\ \{}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \_search\_path.append\_directory(prc\_dir\_filename);}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ p\ =\ q\ +\ 1;}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00276\ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \}}
\DoxyCodeLine{00278\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_PATH\_ENVVARS}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \textcolor{preprocessor}{\#ifdef\ PRC\_PATH2\_ENVVARS}}
\DoxyCodeLine{00281\ \textcolor{comment}{/*}}
\DoxyCodeLine{00282\ \textcolor{comment}{\ *\ PRC\_PATH2\_ENVVARS\ is\ a\ special\ variable\ that\ is\ rarely\ used;\ it\ exists}}
\DoxyCodeLine{00283\ \textcolor{comment}{\ *\ primarily\ to\ support\ the\ Cygwin-\/based\ "{}ctattach"{}\ tools\ used\ by\ the\ Walt}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ *\ Disney\ VR\ Studio.\ \ This\ defines\ a\ set\ of\ environment\ variable(s)\ that}}
\DoxyCodeLine{00285\ \textcolor{comment}{\ *\ define\ a\ search\ path,\ as\ above;\ except\ that\ the\ directory\ names\ on\ these}}
\DoxyCodeLine{00286\ \textcolor{comment}{\ *\ search\ paths\ are\ Panda-\/style\ filenames,\ not\ Windows-\/style\ filenames;\ and}}
\DoxyCodeLine{00287\ \textcolor{comment}{\ *\ the\ path\ separator\ is\ always\ a\ space\ character,\ regardless\ of}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ *\ DEFAULT\_PATHSEP.}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00290\ \ \ \textcolor{keywordtype}{string}\ prc\_path2\_envvars\ =\ PRC\_PATH2\_ENVVARS;}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordflow}{if}\ (!prc\_path2\_envvars.empty()\ \&\&\ blobinfo\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00292\ \ \ \ \ vector\_string\ prc\_path\_envvar\_list;}
\DoxyCodeLine{00293\ \ \ \ \ \mbox{\hyperlink{classConfigDeclaration_ac202d281434daac704b2630b1d4bec41}{ConfigDeclaration::extract\_words}}(prc\_path2\_envvars,\ prc\_path\_envvar\_list);}
\DoxyCodeLine{00294\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ prc\_path\_envvar\_list.size();\ ++i)\ \{}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ path\ =\ ExecutionEnvironment::get\_environment\_variable(prc\_path\_envvar\_list[i]);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ p\ =\ 0;}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (p\ <\ path.length())\ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ q\ =\ path.find\_first\_of(\textcolor{charliteral}{'\ '},\ p);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (q\ ==\ string::npos)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ q\ =\ path.length();}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ prc\_dir\_filename\ =\ path.substr(p,\ q\ -\/\ p);}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_auto\_prc\_dir(prc\_dir\_filename))\ \{}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \_search\_path.append\_directory(prc\_dir\_filename);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ p\ =\ q\ +\ 1;}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ \}}
\DoxyCodeLine{00309\ \ \ \}}
\DoxyCodeLine{00310\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ PRC\_PATH2\_ENVVARS}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \textcolor{preprocessor}{\#ifdef\ DEFAULT\_PRC\_DIR}}
\DoxyCodeLine{00313\ \ \ \textcolor{keywordflow}{if}\ (\_search\_path.is\_empty())\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \textcolor{comment}{//\ If\ nothing's\ on\ the\ search\ path\ (PRC\_DIR\ and\ PRC\_PATH\ were\ not}}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{//\ defined),\ then\ use\ the\ DEFAULT\_PRC\_DIR.}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordtype}{string}\ default\_prc\_dir\ =\ DEFAULT\_PRC\_DIR;}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>default\_prc\_dir\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00318\ \ \ \ \ \ \ default\_prc\_dir\ =\ blobinfo-\/>default\_prc\_dir;}
\DoxyCodeLine{00319\ \ \ \ \ \}}
\DoxyCodeLine{00320\ \ \ \ \ \textcolor{keywordflow}{if}\ (!default\_prc\_dir.empty())\ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ already\ from-\/os-\/specific\ by\ ppremake.}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ prc\_dir\_filename\ =\ default\_prc\_dir;}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_auto\_prc\_dir(prc\_dir\_filename))\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \_search\_path.append\_directory(prc\_dir\_filename);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00326\ \ \ \ \ \}}
\DoxyCodeLine{00327\ \ \ \}}
\DoxyCodeLine{00328\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ DEFAULT\_PRC\_DIR}}
\DoxyCodeLine{00329\ }
\DoxyCodeLine{00330\ \ \ \textcolor{comment}{//\ Now\ find\ all\ of\ the\ *.prc\ files\ (or\ whatever\ matches\ PRC\_PATTERNS)\ on\ the}}
\DoxyCodeLine{00331\ \ \ \textcolor{comment}{//\ path.}}
\DoxyCodeLine{00332\ \ \ ConfigFiles\ config\_files;}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \textcolor{comment}{//\ Use\ a\ set\ to\ ensure\ that\ we\ only\ visit\ each\ directory\ once,\ even\ if\ it}}
\DoxyCodeLine{00335\ \ \ \textcolor{comment}{//\ appears\ multiple\ times\ (under\ different\ aliases!)\ in\ the\ path.}}
\DoxyCodeLine{00336\ \ \ std::set<Filename>\ unique\_dirnames;}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00338\ \ \ \textcolor{comment}{//\ We\ walk\ through\ the\ list\ of\ directories\ in\ forward\ order,\ so\ that\ the}}
\DoxyCodeLine{00339\ \ \ \textcolor{comment}{//\ most\ important\ directories\ are\ visited\ first.}}
\DoxyCodeLine{00340\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ di\ =\ 0;\ di\ <\ \_search\_path.get\_num\_directories();\ ++di)\ \{}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&directory\ =\ \_search\_path.get\_directory(di);}
\DoxyCodeLine{00342\ \ \ \ \ \textcolor{keywordflow}{if}\ (directory.\mbox{\hyperlink{classFilename_abfff9d5225dcef51e5fa15655156d6cb}{is\_directory}}())\ \{}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ canonical(directory,\ \textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{00344\ \ \ \ \ \ \ canonical.\mbox{\hyperlink{classFilename_aae0841e487db8763ec578db102d87bc6}{make\_canonical}}();}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (unique\_dirnames.insert(canonical).second)\ \{}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ vector\_string\ files;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ directory.\mbox{\hyperlink{classFilename_a21596ceda8f522703e44e75b98b1b248}{scan\_directory}}(files);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ walk\ through\ the\ directory's\ list\ of\ files\ in\ reverse}}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ alphabetical\ order,\ because\ for\ historical\ reasons,\ the\ most}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ important\ file\ within\ a\ directory\ is\ the\ alphabetically\ last\ file}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ of\ that\ directory,\ and\ we\ still\ want\ to\ visit\ the\ most\ important}}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ files\ first.}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ vector\_string::reverse\_iterator\ fi;}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ files.rbegin();\ fi\ !=\ files.rend();\ ++fi)\ \{}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ file\_flags\ =\ 0;}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ Globs::const\_iterator\ gi;}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_prc\_patterns.begin();}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gi\ !=\ \_prc\_patterns.end();}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++gi)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*gi).matches(*fi))\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ file\_flags\ |=\ FF\_read;}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_prc\_encrypted\_patterns.begin();}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gi\ !=\ \_prc\_encrypted\_patterns.end();}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++gi)\ \{}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*gi).matches(*fi))\ \{}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ file\_flags\ |=\ FF\_read\ |\ FF\_decrypt;}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_prc\_executable\_patterns.begin();}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gi\ !=\ \_prc\_executable\_patterns.end();}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++gi)\ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*gi).matches(*fi))\ \{}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ file\_flags\ |=\ FF\_execute;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (file\_flags\ !=\ 0)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ ConfigFile\ file;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ file.\_file\_flags\ =\ file\_flags;}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ file.\_filename\ =\ \mbox{\hyperlink{classFilename}{Filename}}(directory,\ (*fi));}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ config\_files.push\_back(file);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \}}
\DoxyCodeLine{00391\ \ \ \}}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \textcolor{keywordtype}{int}\ i\ =\ 1;}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{comment}{//\ If\ prc\_data\ is\ predefined,\ we\ load\ it\ as\ an\ implicit\ page.}}
\DoxyCodeLine{00396\ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_data\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00397\ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}(\textcolor{stringliteral}{"{}builtin"{}},\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00398\ \ \ \ \ ++i;}
\DoxyCodeLine{00399\ \ \ \ \ \_implicit\_pages.push\_back(page);}
\DoxyCodeLine{00400\ \ \ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \ \ \mbox{\hyperlink{classstd_1_1istringstream}{std::istringstream}}\ in(blobinfo-\/>prc\_data);}
\DoxyCodeLine{00403\ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ad3eab34c400243c656886c3be3f95b60}{read\_prc}}(in);}
\DoxyCodeLine{00404\ \ \ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{comment}{//\ Now\ we\ have\ a\ list\ of\ filenames\ in\ order\ from\ most\ important\ to\ least}}
\DoxyCodeLine{00407\ \ \ \textcolor{comment}{//\ important.\ \ Walk\ through\ the\ list\ in\ reverse\ order\ to\ load\ their}}
\DoxyCodeLine{00408\ \ \ \textcolor{comment}{//\ contents,\ because\ we\ want\ the\ first\ file\ in\ the\ list\ (the\ most\ important)}}
\DoxyCodeLine{00409\ \ \ \textcolor{comment}{//\ to\ be\ on\ the\ top\ of\ the\ stack.}}
\DoxyCodeLine{00410\ \ \ ConfigFiles::reverse\_iterator\ ci;}
\DoxyCodeLine{00411\ \ \ \textcolor{keywordflow}{for}\ (ci\ =\ config\_files.rbegin();\ ci\ !=\ config\_files.rend();\ ++ci)\ \{}
\DoxyCodeLine{00412\ \ \ \ \ \textcolor{keyword}{const}\ ConfigFile\ \&file\ =\ (*ci);}
\DoxyCodeLine{00413\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ file.\_filename;}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{if}\ ((file.\_file\_flags\ \&\ FF\_execute)\ !=\ 0\ \&\&}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ filename.\mbox{\hyperlink{classFilename_a476e19612a9c05670b9ac10881c31f01}{is\_executable}}())\ \{}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \textcolor{preprocessor}{\#ifdef\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{00419\ \ \ \ \ \ \ prc\_cat.error()}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Executable\ config\ files\ are\ not\ supported\ with\ Emscripten.\(\backslash\)n"{}};}
\DoxyCodeLine{00421\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \textcolor{comment}{//\ Attempt\ to\ execute\ the\ file\ as\ a\ command.}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ command\ =\ filename.\mbox{\hyperlink{classFilename_a5965a823b0fda63742c59103e8b447dd}{to\_os\_specific}}();}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ envvar\ =\ PRC\_EXECUTABLE\_ARGS\_ENVVAR;}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_executable\_args\_envvar\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ envvar\ =\ blobinfo-\/>prc\_executable\_args\_envvar;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!envvar.empty())\ \{}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ args\ =\ ExecutionEnvironment::get\_environment\_variable(envvar);}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!args.empty())\ \{}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ command\ +=\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ command\ +=\ args;}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \mbox{\hyperlink{classIPipeStream}{IPipeStream}}\ ifs(command);}
\DoxyCodeLine{00437\ }
\DoxyCodeLine{00438\ \ \ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}(filename,\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ ++i;}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \_implicit\_pages.push\_back(page);}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00442\ }
\DoxyCodeLine{00443\ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ad3eab34c400243c656886c3be3f95b60}{read\_prc}}(ifs);}
\DoxyCodeLine{00444\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \_\_EMSCRIPTEN\_\_}}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((file.\_file\_flags\ \&\ FF\_decrypt)\ !=\ 0)\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \textcolor{comment}{//\ Read\ and\ decrypt\ the\ file.}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ filename.set\_binary();}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \ \ \ \ pifstream\ in;}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!filename.\mbox{\hyperlink{classFilename_a5b46ff925e027d0949aa23afc20f55a9}{open\_read}}(in))\ \{}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ prc\_cat.error()}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ read\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}(filename,\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ ++i;}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \_implicit\_pages.push\_back(page);}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (blobinfo\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ blobinfo-\/>prc\_encryption\_key\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_a44874d4dcc92c556aa41ee10db246dd7}{read\_encrypted\_prc}}(in,\ blobinfo-\/>prc\_encryption\_key);}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_a44874d4dcc92c556aa41ee10db246dd7}{read\_encrypted\_prc}}(in,\ PRC\_ENCRYPTION\_KEY);}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00466\ }
\DoxyCodeLine{00467\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((file.\_file\_flags\ \&\ FF\_read)\ !=\ 0)\ \{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \textcolor{comment}{//\ Just\ read\ the\ file.}}
\DoxyCodeLine{00469\ \ \ \ \ \ \ filename.set\_text();}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \ \ \ \ pifstream\ in;}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!filename.\mbox{\hyperlink{classFilename_a5b46ff925e027d0949aa23afc20f55a9}{open\_read}}(in))\ \{}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ prc\_cat.error()}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ read\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}(filename,\ \textcolor{keyword}{true},\ i);}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ ++i;}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ \_implicit\_pages.push\_back(page);}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ad3eab34c400243c656886c3be3f95b60}{read\_prc}}(in);}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \}}
\DoxyCodeLine{00484\ \ \ \}}
\DoxyCodeLine{00485\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ ANDROID}}
\DoxyCodeLine{00486\ }
\DoxyCodeLine{00487\ \ \ \textcolor{keywordflow}{if}\ (!\_loaded\_implicit)\ \{}
\DoxyCodeLine{00488\ \ \ \ \ config\_initialized();}
\DoxyCodeLine{00489\ \ \ \ \ \_loaded\_implicit\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00490\ \ \ \}}
\DoxyCodeLine{00491\ }
\DoxyCodeLine{00492\ \ \ \_currently\_loading\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00493\ \ \ invalidate\_cache();}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \textcolor{preprocessor}{\#ifdef\ USE\_PANDAFILESTREAM}}
\DoxyCodeLine{00496\ \ \ \textcolor{comment}{//\ Update\ this\ very\ low-\/level\ config\ variable\ here,\ for\ lack\ of\ any\ better}}
\DoxyCodeLine{00497\ \ \ \textcolor{comment}{//\ place.}}
\DoxyCodeLine{00498\ \ \ \mbox{\hyperlink{classConfigVariableEnum}{ConfigVariableEnum<PandaFileStreamBuf::NewlineMode>}}\ newline\_mode}
\DoxyCodeLine{00499\ \ \ \ \ (\textcolor{stringliteral}{"{}newline-\/mode"{}},\ PandaFileStreamBuf::NM\_native,}
\DoxyCodeLine{00500\ \ \ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}Controls\ how\ newlines\ are\ written\ by\ Panda\ applications\ writing\ "{}}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}to\ a\ text\ file.\ \ The\ default,\ \(\backslash\)"{}native\(\backslash\)"{},\ means\ to\ write\ newlines\ "{}}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}appropriate\ to\ the\ current\ platform.\ \ You\ may\ also\ specify\ \(\backslash\)"{}binary\(\backslash\)"{},\ "{}}}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}to\ avoid\ molesting\ the\ file\ data,\ or\ one\ of\ \(\backslash\)"{}msdos\(\backslash\)"{},\ \(\backslash\)"{}unix\(\backslash\)"{},\ "{}}}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}or\ \(\backslash\)"{}mac\(\backslash\)"{}."{}}));}
\DoxyCodeLine{00505\ \ \ PandaFileStreamBuf::\_newline\_mode\ =\ newline\_mode;}
\DoxyCodeLine{00506\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ USE\_PANDAFILESTREAM}}
\DoxyCodeLine{00507\ }
\DoxyCodeLine{00508\ \textcolor{preprocessor}{\#ifdef\ \_WIN32}}
\DoxyCodeLine{00509\ \ \ \textcolor{comment}{//\ We\ don't\ necessarily\ want\ an\ error\ dialog\ when\ we\ fail\ to\ load\ a\ .dll}}
\DoxyCodeLine{00510\ \ \ \textcolor{comment}{//\ file.\ \ But\ sometimes\ it\ is\ useful\ for\ debugging.}}
\DoxyCodeLine{00511\ \ \ \mbox{\hyperlink{classConfigVariableBool}{ConfigVariableBool}}\ show\_dll\_error\_dialog}
\DoxyCodeLine{00512\ \ \ \ \ (\textcolor{stringliteral}{"{}show-\/dll-\/error-\/dialog"{}},\ \textcolor{keyword}{false},}
\DoxyCodeLine{00513\ \ \ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}Set\ this\ true\ to\ enable\ the\ Windows\ system\ dialog\ that\ pops\ "{}}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}up\ when\ a\ DLL\ fails\ to\ load,\ or\ false\ to\ disable\ it.\ \ It\ is\ "{}}}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}normally\ false,\ but\ it\ may\ be\ useful\ to\ set\ it\ true\ to\ debug\ "{}}}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}why\ a\ DLL\ is\ not\ loading.\ \ (Note\ that\ this\ actually\ disables\ "{}}}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}*all*\ critical\ error\ messages,\ and\ that\ it's\ a\ global\ setting\ "{}}}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}that\ some\ other\ libraries\ might\ un-\/set.)"{}}));}
\DoxyCodeLine{00519\ \ \ \textcolor{keywordflow}{if}\ (show\_dll\_error\_dialog)\ \{}
\DoxyCodeLine{00520\ \ \ \ \ SetErrorMode(0);}
\DoxyCodeLine{00521\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00522\ \ \ \ \ SetErrorMode(SEM\_FAILCRITICALERRORS);}
\DoxyCodeLine{00523\ \ \ \}}
\DoxyCodeLine{00524\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00525\ \}}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00532\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *\mbox{\hyperlink{classConfigPageManager_a6c50ed2c431e6be5a4cfc10d88f15d1a}{ConfigPageManager::}}}
\DoxyCodeLine{00533\ \mbox{\hyperlink{classConfigPageManager_a6c50ed2c431e6be5a4cfc10d88f15d1a}{make\_explicit\_page}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name)\ \{}
\DoxyCodeLine{00534\ \ \ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}(name,\ \textcolor{keyword}{false},\ \_next\_page\_seq);}
\DoxyCodeLine{00535\ \ \ ++\_next\_page\_seq;}
\DoxyCodeLine{00536\ \ \ \_explicit\_pages.push\_back(page);}
\DoxyCodeLine{00537\ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00538\ \ \ invalidate\_cache();}
\DoxyCodeLine{00539\ \ \ \textcolor{keywordflow}{return}\ page;}
\DoxyCodeLine{00540\ \}}
\DoxyCodeLine{00541\ }
\DoxyCodeLine{00549\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classConfigPageManager_a119f38a41f22d8ddbbc27710f71ba084}{ConfigPageManager::}}}
\DoxyCodeLine{00550\ \mbox{\hyperlink{classConfigPageManager_a119f38a41f22d8ddbbc27710f71ba084}{delete\_explicit\_page}}(\mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page)\ \{}
\DoxyCodeLine{00551\ \ \ Pages::iterator\ pi;}
\DoxyCodeLine{00552\ \ \ \textcolor{keywordflow}{for}\ (pi\ =\ \_explicit\_pages.begin();\ pi\ !=\ \_explicit\_pages.end();\ ++pi)\ \{}
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*pi)\ ==\ page)\ \{}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \_explicit\_pages.erase(pi);}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ page;}
\DoxyCodeLine{00556\ \ \ \ \ \ \ invalidate\_cache();}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00558\ \ \ \ \ \}}
\DoxyCodeLine{00559\ \ \ \}}
\DoxyCodeLine{00560\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00561\ \}}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00566\ \textcolor{keywordtype}{void}\ ConfigPageManager::}
\DoxyCodeLine{00567\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00568\ \ \ out\ <<\ \textcolor{stringliteral}{"{}ConfigPageManager,\ "{}}}
\DoxyCodeLine{00569\ \ \ \ \ \ \ <<\ \_explicit\_pages.size()\ +\ \_implicit\_pages.size()}
\DoxyCodeLine{00570\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ pages."{}};}
\DoxyCodeLine{00571\ \}}
\DoxyCodeLine{00572\ }
\DoxyCodeLine{00576\ \textcolor{keywordtype}{void}\ ConfigPageManager::}
\DoxyCodeLine{00577\ write(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00578\ \ \ check\_sort\_pages();}
\DoxyCodeLine{00579\ \ \ out\ <<\ \_explicit\_pages.size()\ <<\ \textcolor{stringliteral}{"{}\ explicit\ pages:\(\backslash\)n"{}};}
\DoxyCodeLine{00580\ }
\DoxyCodeLine{00581\ \ \ Pages::const\_iterator\ pi;}
\DoxyCodeLine{00582\ \ \ \textcolor{keywordflow}{for}\ (pi\ =\ \_explicit\_pages.begin();\ pi\ !=\ \_explicit\_pages.end();\ ++pi)\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ (*pi);}
\DoxyCodeLine{00584\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ page-\/>get\_name();}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keywordflow}{if}\ (page-\/>get\_trust\_level()\ >\ 0)\ \{}
\DoxyCodeLine{00586\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ (signed\ "{}}\ <<\ page-\/>get\_trust\_level()\ <<\ \textcolor{stringliteral}{"{}:\ "{}};}
\DoxyCodeLine{00587\ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ae85b872849e9091e2ff5f1be2c494def}{output\_brief\_signature}}(out);}
\DoxyCodeLine{00588\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00589\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!page-\/>get\_signature().empty())\ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ (invalid\ signature:\ "{}};}
\DoxyCodeLine{00591\ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ae85b872849e9091e2ff5f1be2c494def}{output\_brief\_signature}}(out);}
\DoxyCodeLine{00592\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00593\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00595\ \ \ \ \ \}}
\DoxyCodeLine{00596\ \ \ \}}
\DoxyCodeLine{00597\ }
\DoxyCodeLine{00598\ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ \_implicit\_pages.size()\ <<\ \textcolor{stringliteral}{"{}\ implicit\ pages:\(\backslash\)n"{}};}
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{for}\ (pi\ =\ \_implicit\_pages.begin();\ pi\ !=\ \_implicit\_pages.end();\ ++pi)\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *page\ =\ (*pi);}
\DoxyCodeLine{00601\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ "{}}\ <<\ page-\/>get\_name();}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordflow}{if}\ (page-\/>get\_trust\_level()\ >\ 0)\ \{}
\DoxyCodeLine{00603\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ (signed\ "{}}\ <<\ page-\/>get\_trust\_level()\ <<\ \textcolor{stringliteral}{"{}:\ "{}};}
\DoxyCodeLine{00604\ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ae85b872849e9091e2ff5f1be2c494def}{output\_brief\_signature}}(out);}
\DoxyCodeLine{00605\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00606\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!page-\/>get\_signature().empty())\ \{}
\DoxyCodeLine{00607\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\ \ (invalid\ signature:\ "{}};}
\DoxyCodeLine{00608\ \ \ \ \ \ \ page-\/>\mbox{\hyperlink{classConfigPage_ae85b872849e9091e2ff5f1be2c494def}{output\_brief\_signature}}(out);}
\DoxyCodeLine{00609\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00610\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00611\ \ \ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00612\ \ \ \ \ \}}
\DoxyCodeLine{00613\ \ \ \}}
\DoxyCodeLine{00614\ \}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00619\ \mbox{\hyperlink{classConfigPageManager}{ConfigPageManager}}\ *ConfigPageManager::}
\DoxyCodeLine{00620\ get\_global\_ptr()\ \{}
\DoxyCodeLine{00621\ \ \ \textcolor{keywordflow}{if}\ (\_global\_ptr\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00622\ \ \ \ \ \_global\_ptr\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classConfigPageManager_adf5c1aa9ce9014fdb385281bda582fee}{ConfigPageManager}};}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ \ \ \textcolor{keywordflow}{return}\ \_global\_ptr;}
\DoxyCodeLine{00625\ \}}
\DoxyCodeLine{00626\ }
\DoxyCodeLine{00627\ \textcolor{comment}{//\ This\ class\ is\ used\ in\ sort\_pages,\ below.}}
\DoxyCodeLine{00628\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classCompareConfigPages}{CompareConfigPages}}\ \{}
\DoxyCodeLine{00629\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00630\ \ \ \textcolor{keywordtype}{bool}\ operator\ ()\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *a,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classConfigPage}{ConfigPage}}\ *b)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00631\ \ \ \ \ \textcolor{keywordflow}{return}\ (*a)\ <\ (*b);}
\DoxyCodeLine{00632\ \ \ \}}
\DoxyCodeLine{00633\ \};}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00639\ \textcolor{keywordtype}{void}\ ConfigPageManager::}
\DoxyCodeLine{00640\ sort\_pages()\ \{}
\DoxyCodeLine{00641\ \ \ sort(\_implicit\_pages.begin(),\ \_implicit\_pages.end(),\ \mbox{\hyperlink{classCompareConfigPages}{CompareConfigPages}}());}
\DoxyCodeLine{00642\ \ \ sort(\_explicit\_pages.begin(),\ \_explicit\_pages.end(),\ \mbox{\hyperlink{classCompareConfigPages}{CompareConfigPages}}());}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \_pages\_sorted\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00645\ \}}
\DoxyCodeLine{00646\ }
\DoxyCodeLine{00657\ \textcolor{keywordtype}{bool}\ ConfigPageManager::}
\DoxyCodeLine{00658\ scan\_auto\_prc\_dir(\mbox{\hyperlink{classFilename}{Filename}}\ \&prc\_dir)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00659\ \ \ \textcolor{keywordtype}{string}\ prc\_dir\_string\ =\ prc\_dir;}
\DoxyCodeLine{00660\ \ \ \textcolor{keywordflow}{if}\ (prc\_dir\_string.substr(0,\ 6)\ ==\ \textcolor{stringliteral}{"{}<auto>"{}})\ \{}
\DoxyCodeLine{00661\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ suffix\ =\ prc\_dir\_string.substr(6);}
\DoxyCodeLine{00662\ }
\DoxyCodeLine{00663\ \ \ \ \ \textcolor{comment}{//\ Start\ at\ the\ dtool\ directory.}}
\DoxyCodeLine{00664\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ dtool\ =\ ExecutionEnvironment::get\_dtool\_name();}
\DoxyCodeLine{00665\ \ \ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ dir\ =\ dtool.get\_dirname();}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_up\_from(prc\_dir,\ dir,\ suffix))\ \{}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00669\ \ \ \ \ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \ \ \textcolor{comment}{//\ Try\ the\ program's\ directory.}}
\DoxyCodeLine{00672\ \ \ \ \ dir\ =\ ExecutionEnvironment::get\_environment\_variable(\textcolor{stringliteral}{"{}MAIN\_DIR"{}});}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keywordflow}{if}\ (scan\_up\_from(prc\_dir,\ dir,\ suffix))\ \{}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00675\ \ \ \ \ \}}
\DoxyCodeLine{00676\ }
\DoxyCodeLine{00677\ \ \ \ \ \textcolor{comment}{//\ Didn't\ find\ it;\ too\ bad.}}
\DoxyCodeLine{00678\ \ \ \ \ std::cerr\ <<\ \textcolor{stringliteral}{"{}Warning:\ unable\ to\ auto-\/locate\ config\ files\ in\ directory\ named\ by\ \(\backslash\)"{}"{}}}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ \ <<\ prc\_dir\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}.\(\backslash\)n"{}};}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00681\ \ \ \}}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \textcolor{comment}{//\ The\ filename\ did\ not\ begin\ with\ "{}<auto>"{},\ so\ it\ stands\ unchanged.}}
\DoxyCodeLine{00684\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00685\ \}}
\DoxyCodeLine{00686\ }
\DoxyCodeLine{00695\ \textcolor{keywordtype}{bool}\ ConfigPageManager::}
\DoxyCodeLine{00696\ scan\_up\_from(\mbox{\hyperlink{classFilename}{Filename}}\ \&result,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&dir,}
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&suffix)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00698\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ consider(dir,\ suffix);}
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \ \ vector\_string\ files;}
\DoxyCodeLine{00701\ \ \ \textcolor{keywordflow}{if}\ (consider.is\_directory())\ \{}
\DoxyCodeLine{00702\ \ \ \ \ \textcolor{keywordflow}{if}\ (consider.scan\_directory(files))\ \{}
\DoxyCodeLine{00703\ \ \ \ \ \ \ vector\_string::const\_iterator\ fi;}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (fi\ =\ files.begin();\ fi\ !=\ files.end();\ ++fi)\ \{}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ Globs::const\_iterator\ gi;}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_prc\_patterns.begin();}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \ \ \ \ \ gi\ !=\ \_prc\_patterns.end();}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++gi)\ \{}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*gi).matches(*fi))\ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ consider;}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00714\ }
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (gi\ =\ \_prc\_executable\_patterns.begin();}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \ \ \ gi\ !=\ \_prc\_executable\_patterns.end();}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ \ ++gi)\ \{}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((*gi).matches(*fi))\ \{}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \ \ result\ =\ consider;}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00724\ \ \ \ \ \}}
\DoxyCodeLine{00725\ \ \ \}}
\DoxyCodeLine{00726\ }
\DoxyCodeLine{00727\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ parent\ =\ dir.get\_dirname();}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \textcolor{keywordflow}{if}\ (dir\ ==\ parent)\ \{}
\DoxyCodeLine{00730\ \ \ \ \ \textcolor{comment}{//\ Too\ bad;\ couldn't\ find\ a\ match.}}
\DoxyCodeLine{00731\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00732\ \ \ \}}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \textcolor{comment}{//\ Recursively\ try\ again\ on\ the\ parent.}}
\DoxyCodeLine{00735\ \ \ \textcolor{keywordflow}{return}\ scan\_up\_from(result,\ parent,\ suffix);}
\DoxyCodeLine{00736\ \}}
\DoxyCodeLine{00737\ }
\DoxyCodeLine{00744\ \textcolor{keywordtype}{void}\ ConfigPageManager::}
\DoxyCodeLine{00745\ config\_initialized()\ \{}
\DoxyCodeLine{00746\ \ \ \mbox{\hyperlink{classNotify_a56acae241b250f0bf1680cec8373a824}{Notify::config\_initialized}}();}
\DoxyCodeLine{00747\ }
\DoxyCodeLine{00748\ \ \ \textcolor{comment}{//\ Also\ set\ up\ some\ other\ low-\/level\ things.}}
\DoxyCodeLine{00749\ \ \ \mbox{\hyperlink{classConfigVariableEnum}{ConfigVariableEnum<TextEncoder::Encoding>}}\ text\_encoding}
\DoxyCodeLine{00750\ \ \ \ \ (\textcolor{stringliteral}{"{}text-\/encoding"{}},\ TextEncoder::E\_utf8,}
\DoxyCodeLine{00751\ \ \ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}Specifies\ how\ international\ characters\ are\ represented\ in\ strings\ "{}}}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}of\ 8-\/byte\ characters\ presented\ to\ Panda.\ \ See\ TextEncoder::set\_encoding()."{}}));}
\DoxyCodeLine{00753\ \ \ TextEncoder::set\_default\_encoding(text\_encoding);}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \mbox{\hyperlink{classConfigVariableEnum}{ConfigVariableEnum<TextEncoder::Encoding>}}\ filesystem\_encoding}
\DoxyCodeLine{00756\ \ \ \ \ (\textcolor{stringliteral}{"{}filesystem-\/encoding"{}},\ TextEncoder::E\_utf8,}
\DoxyCodeLine{00757\ \ \ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}Specifies\ the\ default\ encoding\ used\ for\ wide-\/character\ filenames."{}}));}
\DoxyCodeLine{00758\ \ \ Filename::set\_filesystem\_encoding(filesystem\_encoding);}
\DoxyCodeLine{00759\ }
\DoxyCodeLine{00760\ \ \ \mbox{\hyperlink{classStringDecoder_a47b132655242964b2fd0f005e6db8683}{StringDecoder::set\_notify\_ptr}}(\&Notify::out());}
\DoxyCodeLine{00761\ \}}

\end{DoxyCode}
