\doxysection{anim\+Preload\+Table.\+cxx}
\hypertarget{animPreloadTable_8cxx_source}{}\label{animPreloadTable_8cxx_source}\index{panda/src/chan/animPreloadTable.cxx@{panda/src/chan/animPreloadTable.cxx}}
\mbox{\hyperlink{animPreloadTable_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{animPreloadTable_8h}{animPreloadTable.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ AnimPreloadTable::\_type\_handle;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00027\ PT(\mbox{\hyperlink{classCopyOnWriteObject}{CopyOnWriteObject}})\ AnimPreloadTable::}
\DoxyCodeLine{00028\ make\_cow\_copy()\ \{}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAnimPreloadTable}{AnimPreloadTable}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00030\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ AnimPreloadTable::}
\DoxyCodeLine{00036\ AnimPreloadTable()\ \{}
\DoxyCodeLine{00037\ \ \ \_needs\_sort\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00038\ \}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00043\ AnimPreloadTable::}
\DoxyCodeLine{00044\ \string~AnimPreloadTable()\ \{}
\DoxyCodeLine{00045\ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00050\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classAnimPreloadTable_a5344207cdeba8ee3485f5df046d5004e}{AnimPreloadTable::}}}
\DoxyCodeLine{00051\ \mbox{\hyperlink{classAnimPreloadTable_a5344207cdeba8ee3485f5df046d5004e}{get\_num\_anims}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00052\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\_anims.size();}
\DoxyCodeLine{00053\ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00062\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classAnimPreloadTable_a8b3b80b1caf7f9a982016defce4ae64e}{AnimPreloadTable::}}}
\DoxyCodeLine{00063\ \mbox{\hyperlink{classAnimPreloadTable_a8b3b80b1caf7f9a982016defce4ae64e}{find\_anim}}(\textcolor{keyword}{const}\ std::string\ \&basename)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00064\ \ \ consider\_sort();}
\DoxyCodeLine{00065\ \ \ \mbox{\hyperlink{classAnimPreloadTable_1_1AnimRecord}{AnimRecord}}\ record;}
\DoxyCodeLine{00066\ \ \ record.\_basename\ =\ basename;}
\DoxyCodeLine{00067\ \ \ Anims::const\_iterator\ ai\ =\ \_anims.find(record);}
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{if}\ (ai\ !=\ \_anims.end())\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordflow}{return}\ int(ai\ -\/\ \_anims.begin());}
\DoxyCodeLine{00070\ \ \ \}}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{return}\ -\/1;}
\DoxyCodeLine{00072\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_a0caf989f68bef58a3b15bc8ee9ae03c7}{AnimPreloadTable::}}}
\DoxyCodeLine{00078\ \mbox{\hyperlink{classAnimPreloadTable_a0caf989f68bef58a3b15bc8ee9ae03c7}{clear\_anims}}()\ \{}
\DoxyCodeLine{00079\ \ \ \_anims.clear();}
\DoxyCodeLine{00080\ \ \ \_needs\_sort\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00081\ \}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00087\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_aa4825b50662af1d85ec52c4a2b7b699f}{AnimPreloadTable::}}}
\DoxyCodeLine{00088\ \mbox{\hyperlink{classAnimPreloadTable_aa4825b50662af1d85ec52c4a2b7b699f}{remove\_anim}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{00089\ \ \ nassertv(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_anims.size());}
\DoxyCodeLine{00090\ \ \ \_anims.erase(\_anims.begin()\ +\ n);}
\DoxyCodeLine{00091\ \}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00098\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_a028e24051150521657b332ecfe26bde9}{AnimPreloadTable::}}}
\DoxyCodeLine{00099\ \mbox{\hyperlink{classAnimPreloadTable_a028e24051150521657b332ecfe26bde9}{add\_anim}}(\textcolor{keyword}{const}\ std::string\ \&basename,\ PN\_stdfloat\ base\_frame\_rate,\ \textcolor{keywordtype}{int}\ num\_frames)\ \{}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{classAnimPreloadTable_1_1AnimRecord}{AnimRecord}}\ record;}
\DoxyCodeLine{00101\ \ \ record.\_basename\ =\ basename;}
\DoxyCodeLine{00102\ \ \ record.\_base\_frame\_rate\ =\ base\_frame\_rate;}
\DoxyCodeLine{00103\ \ \ record.\_num\_frames\ =\ num\_frames;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \_anims.push\_back(record);}
\DoxyCodeLine{00106\ \ \ \_needs\_sort\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00113\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_aeb587a2ecb79a9c9de6a0fec2d0e4bb0}{AnimPreloadTable::}}}
\DoxyCodeLine{00114\ \mbox{\hyperlink{classAnimPreloadTable_aeb587a2ecb79a9c9de6a0fec2d0e4bb0}{add\_anims\_from}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classAnimPreloadTable}{AnimPreloadTable}}\ *other)\ \{}
\DoxyCodeLine{00115\ \ \ \_anims.reserve(\_anims.size()\ +\ other-\/>\_anims.size());}
\DoxyCodeLine{00116\ \ \ Anims::const\_iterator\ ai;}
\DoxyCodeLine{00117\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ other-\/>\_anims.begin();\ ai\ !=\ other-\/>\_anims.end();\ ++ai)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \_anims.push\_back(*ai);}
\DoxyCodeLine{00119\ \ \ \}}
\DoxyCodeLine{00120\ \ \ \_needs\_sort\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00126\ \textcolor{keywordtype}{void}\ AnimPreloadTable::}
\DoxyCodeLine{00127\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00128\ \ \ consider\_sort();}
\DoxyCodeLine{00129\ \ \ out\ <<\ \textcolor{stringliteral}{"{}AnimPreloadTable,\ "{}}\ <<\ \_anims.size()\ <<\ \textcolor{stringliteral}{"{}\ animation\ records."{}};}
\DoxyCodeLine{00130\ \}}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00135\ \textcolor{keywordtype}{void}\ AnimPreloadTable::}
\DoxyCodeLine{00136\ write(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00137\ \ \ consider\_sort();}
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)}
\DoxyCodeLine{00139\ \ \ \ \ <<\ \textcolor{stringliteral}{"{}AnimPreloadTable,\ "{}}\ <<\ \_anims.size()\ <<\ \textcolor{stringliteral}{"{}\ animation\ records:\(\backslash\)n"{}};}
\DoxyCodeLine{00140\ \ \ Anims::const\_iterator\ ai;}
\DoxyCodeLine{00141\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_anims.begin();\ ai\ !=\ \_anims.end();\ ++ai)\ \{}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keyword}{const}\ AnimRecord\ \&record\ =\ (*ai);}
\DoxyCodeLine{00143\ \ \ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level\ +\ 2)}
\DoxyCodeLine{00144\ \ \ \ \ \ \ <<\ record.\_basename\ <<\ \textcolor{stringliteral}{"{}:\ "{}}\ <<\ record.\_num\_frames\ <<\ \textcolor{stringliteral}{"{}\ frames\ at\ "{}}}
\DoxyCodeLine{00145\ \ \ \ \ \ \ <<\ record.\_base\_frame\_rate\ <<\ \textcolor{stringliteral}{"{}\ fps\(\backslash\)n"{}};}
\DoxyCodeLine{00146\ \ \ \}}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00152\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_a5abdb78db7ce0afef4bafdae9587f663}{AnimPreloadTable::}}}
\DoxyCodeLine{00153\ \mbox{\hyperlink{classAnimPreloadTable_a5abdb78db7ce0afef4bafdae9587f663}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00154\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classAnimPreloadTable_ad7449281a426b6abd20374cea28db430}{make\_from\_bam}});}
\DoxyCodeLine{00155\ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00161\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_aa04db3d55517bb242890635392485f9e}{AnimPreloadTable::}}}
\DoxyCodeLine{00162\ \mbox{\hyperlink{classAnimPreloadTable_aa04db3d55517bb242890635392485f9e}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00163\ \ \ consider\_sort();}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ dg.add\_uint16(\_anims.size());}
\DoxyCodeLine{00166\ \ \ Anims::const\_iterator\ ai;}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{for}\ (ai\ =\ \_anims.begin();\ ai\ !=\ \_anims.end();\ ++ai)\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAnimPreloadTable_1_1AnimRecord}{AnimRecord}}\ \&record\ =\ (*ai);}
\DoxyCodeLine{00169\ \ \ \ \ dg.add\_string(record.\_basename);}
\DoxyCodeLine{00170\ \ \ \ \ dg.add\_stdfloat(record.\_base\_frame\_rate);}
\DoxyCodeLine{00171\ \ \ \ \ dg.add\_int32(record.\_num\_frames);}
\DoxyCodeLine{00172\ \ \ \}}
\DoxyCodeLine{00173\ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00178\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classAnimPreloadTable_ad7449281a426b6abd20374cea28db430}{AnimPreloadTable::}}}
\DoxyCodeLine{00179\ \mbox{\hyperlink{classAnimPreloadTable_ad7449281a426b6abd20374cea28db430}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00180\ \ \ \mbox{\hyperlink{classAnimPreloadTable}{AnimPreloadTable}}\ *me\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAnimPreloadTable}{AnimPreloadTable}};}
\DoxyCodeLine{00181\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00185\ \ \ me-\/>\mbox{\hyperlink{classAnimPreloadTable_ac847994b566e1b98a60245b8def285ed}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00186\ \ \ \textcolor{keywordflow}{return}\ me;}
\DoxyCodeLine{00187\ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00194\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAnimPreloadTable_ac847994b566e1b98a60245b8def285ed}{AnimPreloadTable::}}}
\DoxyCodeLine{00195\ \mbox{\hyperlink{classAnimPreloadTable_ac847994b566e1b98a60245b8def285ed}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordtype}{int}\ num\_anims\ =\ scan.get\_uint16();}
\DoxyCodeLine{00197\ \ \ \_anims.reserve(num\_anims);}
\DoxyCodeLine{00198\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_anims;\ ++i)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \mbox{\hyperlink{classAnimPreloadTable_1_1AnimRecord}{AnimRecord}}\ record;}
\DoxyCodeLine{00200\ \ \ \ \ record.\_basename\ =\ scan.\mbox{\hyperlink{classDatagramIterator_aa5b2810c1b772f83e744fed70bb313ea}{get\_string}}();}
\DoxyCodeLine{00201\ \ \ \ \ record.\_base\_frame\_rate\ =\ scan.get\_stdfloat();}
\DoxyCodeLine{00202\ \ \ \ \ record.\_num\_frames\ =\ scan.get\_int32();}
\DoxyCodeLine{00203\ \ \ \ \ \_anims.push\_back(record);}
\DoxyCodeLine{00204\ \ \ \}}
\DoxyCodeLine{00205\ \}}

\end{DoxyCode}
