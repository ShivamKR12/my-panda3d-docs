\doxysection{pfm\+File.\+cxx}
\hypertarget{pfmFile_8cxx_source}{}\label{pfmFile_8cxx_source}\index{panda/src/pnmimage/pfmFile.cxx@{panda/src/pnmimage/pfmFile.cxx}}
\mbox{\hyperlink{pfmFile_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pnmimage_8h}{config\_pnmimage.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pfmFile_8h}{pfmFile.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandaFileStream_8h}{pandaFileStream.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{littleEndian_8h}{littleEndian.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bigEndian_8h}{bigEndian.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cmath_8h}{cmath.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmImage_8h}{pnmImage.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmReader_8h}{pnmReader.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmWriter_8h}{pnmWriter.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{look__at_8h}{look\_at.h}}"{}}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00028\ \textcolor{keyword}{using\ }std::max;}
\DoxyCodeLine{00029\ \textcolor{keyword}{using\ }std::min;}
\DoxyCodeLine{00030\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ PfmFile::}
\DoxyCodeLine{00036\ PfmFile()\ \{}
\DoxyCodeLine{00037\ \ \ \_has\_no\_data\_value\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00038\ \ \ \_has\_no\_data\_threshold\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00039\ \ \ \_no\_data\_value\ =\ LPoint4f::zero();}
\DoxyCodeLine{00040\ \ \ \_has\_point\ =\ has\_point\_noop;}
\DoxyCodeLine{00041\ \ \ clear();}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00047\ PfmFile::}
\DoxyCodeLine{00048\ PfmFile(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy)\ :}
\DoxyCodeLine{00049\ \ \ \mbox{\hyperlink{classPNMImageHeader}{PNMImageHeader}}(copy),}
\DoxyCodeLine{00050\ \ \ \_table(copy.\_table),}
\DoxyCodeLine{00051\ \ \ \_scale(copy.\_scale),}
\DoxyCodeLine{00052\ \ \ \_has\_no\_data\_value(copy.\_has\_no\_data\_value),}
\DoxyCodeLine{00053\ \ \ \_has\_no\_data\_threshold(copy.\_has\_no\_data\_threshold),}
\DoxyCodeLine{00054\ \ \ \_no\_data\_value(copy.\_no\_data\_value),}
\DoxyCodeLine{00055\ \ \ \_has\_point(copy.\_has\_point)}
\DoxyCodeLine{00056\ \{}
\DoxyCodeLine{00057\ \}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00062\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00063\ operator\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy)\ \{}
\DoxyCodeLine{00064\ \ \ PNMImageHeader::operator\ =\ (copy);}
\DoxyCodeLine{00065\ \ \ \_table\ =\ copy.\_table;}
\DoxyCodeLine{00066\ \ \ \_scale\ =\ copy.\_scale;}
\DoxyCodeLine{00067\ \ \ \_has\_no\_data\_value\ =\ copy.\_has\_no\_data\_value;}
\DoxyCodeLine{00068\ \ \ \_has\_no\_data\_threshold\ =\ copy.\_has\_no\_data\_threshold;}
\DoxyCodeLine{00069\ \ \ \_no\_data\_value\ =\ copy.\_no\_data\_value;}
\DoxyCodeLine{00070\ \ \ \_has\_point\ =\ copy.\_has\_point;}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00076\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00077\ clear()\ \{}
\DoxyCodeLine{00078\ \ \ \_x\_size\ =\ 0;}
\DoxyCodeLine{00079\ \ \ \_y\_size\ =\ 0;}
\DoxyCodeLine{00080\ \ \ \_scale\ =\ 1.0;}
\DoxyCodeLine{00081\ \ \ \_num\_channels\ =\ 0;}
\DoxyCodeLine{00082\ \ \ \_table.clear();}
\DoxyCodeLine{00083\ \ \ clear\_no\_data\_value();}
\DoxyCodeLine{00084\ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00091\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00092\ clear(\textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,\ \textcolor{keywordtype}{int}\ num\_channels)\ \{}
\DoxyCodeLine{00093\ \ \ nassertv(x\_size\ >=\ 0\ \&\&\ y\_size\ >=\ 0);}
\DoxyCodeLine{00094\ \ \ nassertv((num\_channels\ >\ 0\ \&\&\ num\_channels\ <=\ 4)\ ||}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ (x\_size\ ==\ 0\ \&\&\ y\_size\ ==\ 0\ \&\&\ num\_channels\ ==\ 0));}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \_x\_size\ =\ x\_size;}
\DoxyCodeLine{00098\ \ \ \_y\_size\ =\ y\_size;}
\DoxyCodeLine{00099\ \ \ \_scale\ =\ 1.0;}
\DoxyCodeLine{00100\ \ \ \_num\_channels\ =\ num\_channels;}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \_table.clear();}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordtype}{int}\ size\ =\ \_x\_size\ *\ \_y\_size\ *\ \_num\_channels;}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \textcolor{comment}{//\ We\ allocate\ a\ little\ bit\ bigger\ to\ allow\ safe\ overflow:\ you\ can\ call}}
\DoxyCodeLine{00106\ \ \ \textcolor{comment}{//\ get\_point3()\ or\ get\_point4()\ on\ the\ last\ point\ of\ a\ 1-\/\ or\ 3-\/channel}}
\DoxyCodeLine{00107\ \ \ \textcolor{comment}{//\ image.}}
\DoxyCodeLine{00108\ \ \ \_table.insert(\_table.end(),\ size\ +\ 4,\ (PN\_float32)0.0);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ clear\_no\_data\_value();}
\DoxyCodeLine{00111\ \}}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00120\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00121\ read(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\ \{}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{00125\ \ \ PT(\mbox{\hyperlink{classVirtualFile}{VirtualFile}})\ file\ =\ vfs-\/>get\_file(filename);}
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{if}\ (file\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \textcolor{comment}{//\ No\ such\ file.}}
\DoxyCodeLine{00128\ \ \ \ \ pnmimage\_cat.error()}
\DoxyCodeLine{00129\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Could\ not\ find\ "{}}\ <<\ fullpath\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}\ (pnmimage\_cat.is\_debug())\ \{}
\DoxyCodeLine{00134\ \ \ \ \ pnmimage\_cat.debug()}
\DoxyCodeLine{00135\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ PFM\ file\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00136\ \ \ \}}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ istream\ *in\ =\ file-\/>open\_read\_file(\textcolor{keyword}{true});}
\DoxyCodeLine{00139\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ read(*in,\ fullpath);}
\DoxyCodeLine{00140\ \ \ vfs-\/>close\_read\_file(in);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00143\ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00152\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00153\ read(istream\ \&in,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\ \{}
\DoxyCodeLine{00154\ \ \ \mbox{\hyperlink{classPNMReader}{PNMReader}}\ *reader\ =\ make\_reader(\&in,\ \textcolor{keyword}{false},\ fullpath);}
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{if}\ (reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00156\ \ \ \ \ clear();}
\DoxyCodeLine{00157\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00158\ \ \ \}}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{return}\ read(reader);}
\DoxyCodeLine{00160\ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00167\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00168\ read(\mbox{\hyperlink{classPNMReader}{PNMReader}}\ *reader)\ \{}
\DoxyCodeLine{00169\ \ \ clear();}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (reader\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \textcolor{keywordflow}{if}\ (!reader-\/>is\_valid())\ \{}
\DoxyCodeLine{00176\ \ \ \ \ \textcolor{keyword}{delete}\ reader;}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00178\ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{if}\ (!reader-\/>\mbox{\hyperlink{classPNMReader_a34acf9a526d3ffe9f6be1fc4617757ae}{is\_floating\_point}}())\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \textcolor{comment}{//\ Not\ a\ floating-\/point\ file.\ \ Quietly\ convert\ it.}}
\DoxyCodeLine{00182\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ pnm;}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordflow}{if}\ (!pnm.read(reader))\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00185\ \ \ \ \ \}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{return}\ load(pnm);}
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ reader-\/>\mbox{\hyperlink{classPNMReader_ae743bce38d7eb6a951a6291ecfa84269}{read\_pfm}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00191\ \ \ \textcolor{keyword}{delete}\ reader;}
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00193\ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00203\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00204\ write(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\ \{}
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00206\ \ \ \ \ pnmimage\_cat.error()}
\DoxyCodeLine{00207\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}PFM\ file\ is\ invalid.\(\backslash\)n"{}};}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00209\ \ \ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename\ =\ Filename::binary\_filename(fullpath);}
\DoxyCodeLine{00212\ \ \ pofstream\ out;}
\DoxyCodeLine{00213\ \ \ \textcolor{keywordflow}{if}\ (!filename.\mbox{\hyperlink{classFilename_ad37a9d52c837218b01076de184dc5f4d}{open\_write}}(out))\ \{}
\DoxyCodeLine{00214\ \ \ \ \ pnmimage\_cat.error()}
\DoxyCodeLine{00215\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Unable\ to\ open\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{if}\ (pnmimage\_cat.is\_debug())\ \{}
\DoxyCodeLine{00220\ \ \ \ \ pnmimage\_cat.debug()}
\DoxyCodeLine{00221\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Writing\ PFM\ file\ "{}}\ <<\ filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00222\ \ \ \}}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \textcolor{keywordflow}{return}\ write(out,\ fullpath);}
\DoxyCodeLine{00225\ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00231\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00232\ write(ostream\ \&out,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFilename}{Filename}}\ \&fullpath)\ \{}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00235\ \ \ \}}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \mbox{\hyperlink{classPNMWriter}{PNMWriter}}\ *writer\ =\ make\_writer(\&out,\ \textcolor{keyword}{false},\ fullpath);}
\DoxyCodeLine{00238\ \ \ \textcolor{keywordflow}{if}\ (writer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00240\ \ \ \}}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \textcolor{keywordflow}{return}\ write(writer);}
\DoxyCodeLine{00243\ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00250\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00251\ write(\mbox{\hyperlink{classPNMWriter}{PNMWriter}}\ *writer)\ \{}
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{if}\ (writer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00257\ \ \ \ \ \textcolor{keyword}{delete}\ writer;}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00259\ \ \ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ writer-\/>copy\_header\_from(*\textcolor{keyword}{this});}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \textcolor{keywordflow}{if}\ (!writer-\/>\mbox{\hyperlink{classPNMWriter_ad3bfccea9f44d009760ed749bf437d79}{supports\_floating\_point}}())\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{comment}{//\ Hmm,\ it's\ an\ integer\ file\ type.\ \ Convert\ it\ from\ the\ floating-\/point}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{comment}{//\ data\ we\ have.}}
\DoxyCodeLine{00266\ \ \ \ \ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ pnmimage;}
\DoxyCodeLine{00267\ \ \ \ \ \textcolor{keywordflow}{if}\ (!store(pnmimage))\ \{}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ writer;}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00270\ \ \ \ \ \}}
\DoxyCodeLine{00271\ \ \ \ \ writer-\/>copy\_header\_from(pnmimage);}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordtype}{bool}\ success\ =\ (writer-\/>\mbox{\hyperlink{classPNMWriter_a3c55c68ce59dfceb35e1c19862d0b5d5}{write\_data}}(pnmimage.get\_array(),\ pnmimage.get\_alpha\_array())\ !=\ 0);}
\DoxyCodeLine{00273\ \ \ \ \ \textcolor{keyword}{delete}\ writer;}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00275\ \ \ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00277\ \ \ \textcolor{keywordtype}{bool}\ success\ =\ writer-\/>\mbox{\hyperlink{classPNMWriter_a6ea6d27b3bad22d109ecd3bc45f444c9}{write\_pfm}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{delete}\ writer;}
\DoxyCodeLine{00279\ \ \ \textcolor{keywordflow}{return}\ success;}
\DoxyCodeLine{00280\ \}}
\DoxyCodeLine{00281\ }
\DoxyCodeLine{00286\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00287\ load(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage)\ \{}
\DoxyCodeLine{00288\ \ \ \textcolor{keywordflow}{if}\ (!pnmimage.is\_valid())\ \{}
\DoxyCodeLine{00289\ \ \ \ \ clear();}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00291\ \ \ \}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \textcolor{keywordtype}{int}\ num\_channels\ =\ pnmimage.get\_num\_channels();}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ clear(pnmimage.get\_x\_size(),\ pnmimage.get\_y\_size(),\ num\_channels);}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{switch}\ (num\_channels)\ \{}
\DoxyCodeLine{00297\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00298\ \ \ \ \ \{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ pnmimage.get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ pnmimage.get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \_table[yi\ *\ \_x\_size\ +\ xi]\ =\ pnmimage.get\_gray(xi,\ yi);}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00304\ \ \ \ \ \}}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00308\ \ \ \ \ \{}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ pnmimage.get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ pnmimage.get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ PN\_float32\ *point\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ point[0]\ =\ pnmimage.get\_gray(xi,\ yi);}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ point[1]\ =\ pnmimage.get\_alpha(xi,\ yi);}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00316\ \ \ \ \ \}}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00320\ \ \ \ \ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ pnmimage.get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ pnmimage.get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ PN\_float32\ *point\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ LRGBColorf\ \mbox{\hyperlink{structpixel}{xel}}\ =\ pnmimage.get\_xel(xi,\ yi);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ point[0]\ =\ \mbox{\hyperlink{structpixel}{xel}}[0];}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ point[1]\ =\ \mbox{\hyperlink{structpixel}{xel}}[1];}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ point[2]\ =\ \mbox{\hyperlink{structpixel}{xel}}[2];}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00330\ \ \ \ \ \}}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00334\ \ \ \ \ \{}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ pnmimage.get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ pnmimage.get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ PN\_float32\ *point\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ LColorf\ \mbox{\hyperlink{structpixel}{xel}}\ =\ pnmimage.get\_xel\_a(xi,\ yi);}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ point[0]\ =\ \mbox{\hyperlink{structpixel}{xel}}[0];}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ point[1]\ =\ \mbox{\hyperlink{structpixel}{xel}}[1];}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ point[2]\ =\ \mbox{\hyperlink{structpixel}{xel}}[2];}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ point[3]\ =\ \mbox{\hyperlink{structpixel}{xel}}[3];}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00345\ \ \ \ \ \}}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00349\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00351\ \ \ \}}
\DoxyCodeLine{00352\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00353\ \}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00359\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00360\ store(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00361\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00362\ \ \ \ \ pnmimage.clear();}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \textcolor{keywordtype}{int}\ num\_channels\ =\ get\_num\_channels();}
\DoxyCodeLine{00367\ \ \ pnmimage.clear(get\_x\_size(),\ get\_y\_size(),\ num\_channels,\ PGM\_MAXMAXVAL);}
\DoxyCodeLine{00368\ \ \ \textcolor{keywordflow}{switch}\ (num\_channels)\ \{}
\DoxyCodeLine{00369\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00370\ \ \ \ \ \{}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_gray(xi,\ yi,\ \_table[yi\ *\ \_x\_size\ +\ xi]);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00376\ \ \ \ \ \}}
\DoxyCodeLine{00377\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00380\ \ \ \ \ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint2f\ \&point\ =\ get\_point2(xi,\ yi);}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_gray(xi,\ yi,\ point[0]);}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_alpha(xi,\ yi,\ point[1]);}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00390\ }
\DoxyCodeLine{00391\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00392\ \ \ \ \ \{}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&point\ =\ get\_point3(xi,\ yi);}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_xel(xi,\ yi,\ point[0],\ point[1],\ point[2]);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00399\ \ \ \ \ \}}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00403\ \ \ \ \ \{}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint4f\ \&point\ =\ get\_point4(xi,\ yi);}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ pnmimage.set\_xel\_a(xi,\ yi,\ point[0],\ point[1],\ point[2],\ point[3]);}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \}}
\DoxyCodeLine{00411\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00414\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{00415\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00416\ \ \ \}}
\DoxyCodeLine{00417\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00418\ \}}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00425\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00426\ store\_mask(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00427\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00428\ \ \ \ \ pnmimage.clear();}
\DoxyCodeLine{00429\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00430\ \ \ \}}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \ \ pnmimage.clear(get\_x\_size(),\ get\_y\_size(),\ 1,\ 255);}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00434\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00435\ \ \ \ \ \ \ pnmimage.set\_gray(xi,\ yi,\ has\_point(xi,\ yi));}
\DoxyCodeLine{00436\ \ \ \ \ \}}
\DoxyCodeLine{00437\ \ \ \}}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00439\ \}}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00451\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00452\ store\_mask(\mbox{\hyperlink{classPNMImage}{PNMImage}}\ \&pnmimage,\ \textcolor{keyword}{const}\ LVecBase4f\ \&min\_point,\ \textcolor{keyword}{const}\ LVecBase4f\ \&max\_point)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00454\ \ \ \ \ pnmimage.clear();}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00456\ \ \ \}}
\DoxyCodeLine{00457\ }
\DoxyCodeLine{00458\ \ \ pnmimage.clear(get\_x\_size(),\ get\_y\_size(),\ 1,\ 255);}
\DoxyCodeLine{00459\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ pnmimage.set\_gray(xi,\ yi,\ 0);}
\DoxyCodeLine{00463\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *value\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ in\_range\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ \_num\_channels;\ ++ci)\ \{}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (value[ci]\ <\ min\_point[ci]\ ||\ value[ci]\ >\ max\_point[ci])\ \{}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ \ \ \ \ in\_range\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ pnmimage.set\_gray(xi,\ yi,\ (\textcolor{keywordtype}{float})in\_range);}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \}}
\DoxyCodeLine{00475\ \ \ \}}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00477\ \}}
\DoxyCodeLine{00478\ }
\DoxyCodeLine{00482\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00483\ fill(\textcolor{keyword}{const}\ LPoint4f\ \&value)\ \{}
\DoxyCodeLine{00484\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00486\ \ \ \ \ \{}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \_table[(yi\ *\ \_x\_size\ +\ xi)]\ =\ value[0];}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00492\ \ \ \ \ \}}
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00494\ }
\DoxyCodeLine{00495\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00496\ \ \ \ \ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ (*(LPoint2f\ *)\&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels]).set(value[0],\ value[1]);}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ \}}
\DoxyCodeLine{00503\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00506\ \ \ \ \ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ (*(LPoint3f\ *)\&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels]).set(value[0],\ value[1],\ value[2]);}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00512\ \ \ \ \ \}}
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00514\ }
\DoxyCodeLine{00515\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00516\ \ \ \ \ \{}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \ \ *(LPoint4f\ *)\&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels]\ =\ value;}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00521\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00522\ \ \ \ \ \}}
\DoxyCodeLine{00523\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00524\ \ \ \}}
\DoxyCodeLine{00525\ \}}
\DoxyCodeLine{00526\ }
\DoxyCodeLine{00530\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00531\ fill\_nan()\ \{}
\DoxyCodeLine{00532\ \ \ PN\_float32\ nan\ =\ make\_nan((PN\_float32)0.0);}
\DoxyCodeLine{00533\ \ \ LPoint4f\ nan4(nan,\ nan,\ nan,\ nan);}
\DoxyCodeLine{00534\ \ \ fill(nan4);}
\DoxyCodeLine{00535\ \}}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00540\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00541\ fill\_no\_data\_value()\ \{}
\DoxyCodeLine{00542\ \ \ fill(\_no\_data\_value);}
\DoxyCodeLine{00543\ \}}
\DoxyCodeLine{00544\ }
\DoxyCodeLine{00549\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00550\ fill\_channel(\textcolor{keywordtype}{int}\ channel,\ PN\_float32\ value)\ \{}
\DoxyCodeLine{00551\ \ \ nassertv(channel\ >=\ 0\ \&\&\ channel\ <\ \_num\_channels);}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels\ +\ channel]\ =\ value;}
\DoxyCodeLine{00556\ \ \ \ \ \}}
\DoxyCodeLine{00557\ \ \ \}}
\DoxyCodeLine{00558\ \}}
\DoxyCodeLine{00559\ }
\DoxyCodeLine{00563\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00564\ fill\_channel\_nan(\textcolor{keywordtype}{int}\ channel)\ \{}
\DoxyCodeLine{00565\ \ \ PN\_float32\ nan\ =\ make\_nan((PN\_float32)0.0);}
\DoxyCodeLine{00566\ \ \ fill\_channel(channel,\ nan);}
\DoxyCodeLine{00567\ \}}
\DoxyCodeLine{00568\ }
\DoxyCodeLine{00573\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00574\ fill\_channel\_masked(\textcolor{keywordtype}{int}\ channel,\ PN\_float32\ value)\ \{}
\DoxyCodeLine{00575\ \ \ nassertv(channel\ >=\ 0\ \&\&\ channel\ <\ \_num\_channels);}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ fill\_channel(channel,\ value);}
\DoxyCodeLine{00579\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00580\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \ \ \_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels\ +\ channel]\ =\ value;}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \}}
\DoxyCodeLine{00587\ \ \ \}}
\DoxyCodeLine{00588\ \}}
\DoxyCodeLine{00589\ }
\DoxyCodeLine{00594\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00595\ fill\_channel\_masked\_nan(\textcolor{keywordtype}{int}\ channel)\ \{}
\DoxyCodeLine{00596\ \ \ PN\_float32\ nan\ =\ make\_nan((PN\_float32)0.0);}
\DoxyCodeLine{00597\ \ \ fill\_channel\_masked(channel,\ nan);}
\DoxyCodeLine{00598\ \}}
\DoxyCodeLine{00599\ }
\DoxyCodeLine{00606\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00607\ calc\_average\_point(LPoint3f\ \&result,\ PN\_float32\ x,\ PN\_float32\ y,\ PN\_float32\ radius)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00608\ \ \ result\ =\ LPoint3f::zero();}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \textcolor{keywordtype}{int}\ min\_x\ =\ int(ceil(x\ -\/\ radius));}
\DoxyCodeLine{00611\ \ \ \textcolor{keywordtype}{int}\ min\_y\ =\ int(ceil(y\ -\/\ radius));}
\DoxyCodeLine{00612\ \ \ \textcolor{keywordtype}{int}\ max\_x\ =\ int(floor(x\ +\ radius));}
\DoxyCodeLine{00613\ \ \ \textcolor{keywordtype}{int}\ max\_y\ =\ int(floor(y\ +\ radius));}
\DoxyCodeLine{00614\ }
\DoxyCodeLine{00615\ \ \ \textcolor{comment}{//\ We\ first\ construct\ a\ mini-\/grid\ of\ x\_size\ by\ y\_size\ integer\ values\ to}}
\DoxyCodeLine{00616\ \ \ \textcolor{comment}{//\ index\ into\ the\ main\ table.\ \ This\ indirection\ allows\ us\ to\ fill\ in\ the}}
\DoxyCodeLine{00617\ \ \ \textcolor{comment}{//\ holes\ in\ the\ mini-\/grid\ with\ the\ nearest\ known\ values\ before\ we\ compute}}
\DoxyCodeLine{00618\ \ \ \textcolor{comment}{//\ the\ average.}}
\DoxyCodeLine{00619\ \ \ \textcolor{keywordtype}{int}\ x\_size\ =\ max\_x\ -\/\ min\_x\ +\ 1;}
\DoxyCodeLine{00620\ \ \ \textcolor{keywordtype}{int}\ y\_size\ =\ max\_y\ -\/\ min\_y\ +\ 1;}
\DoxyCodeLine{00621\ \ \ \textcolor{keywordtype}{int}\ size\ =\ x\_size\ *\ y\_size;}
\DoxyCodeLine{00622\ \ \ \textcolor{keywordflow}{if}\ (size\ ==\ 0)\ \{}
\DoxyCodeLine{00623\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00624\ \ \ \}}
\DoxyCodeLine{00625\ }
\DoxyCodeLine{00626\ \ \ \mbox{\hyperlink{classpvector}{pvector<MiniGridCell>}}\ mini\_grid;}
\DoxyCodeLine{00627\ \ \ mini\_grid.insert(mini\_grid.end(),\ size,\ MiniGridCell());}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \ \ \textcolor{comment}{//\ Now\ collect\ the\ known\ data\ points\ and\ apply\ them\ to\ the\ mini-\/grid.}}
\DoxyCodeLine{00630\ \ \ min\_x\ =\ max(min\_x,\ 0);}
\DoxyCodeLine{00631\ \ \ min\_y\ =\ max(min\_y,\ 0);}
\DoxyCodeLine{00632\ \ \ max\_x\ =\ min(max\_x,\ \_x\_size\ -\/\ 1);}
\DoxyCodeLine{00633\ \ \ max\_y\ =\ min(max\_y,\ \_y\_size\ -\/\ 1);}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \ \ \textcolor{keywordtype}{bool}\ got\_any\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00636\ \ \ \textcolor{keywordtype}{int}\ xi,\ yi;}
\DoxyCodeLine{00637\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ min\_y;\ yi\ <=\ max\_y;\ ++yi)\ \{}
\DoxyCodeLine{00638\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ min\_x;\ xi\ <=\ max\_x;\ ++xi)\ \{}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00642\ }
\DoxyCodeLine{00643\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ gi\ =\ (yi\ -\/\ min\_y)\ *\ y\_size\ +\ (xi\ -\/\ min\_x);}
\DoxyCodeLine{00644\ \ \ \ \ \ \ nassertr(gi\ >=\ 0\ \&\&\ gi\ <\ size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00645\ \ \ \ \ \ \ mini\_grid[gi].\_sxi\ =\ xi;}
\DoxyCodeLine{00646\ \ \ \ \ \ \ mini\_grid[gi].\_syi\ =\ yi;}
\DoxyCodeLine{00647\ \ \ \ \ \ \ mini\_grid[gi].\_dist\ =\ 0;}
\DoxyCodeLine{00648\ \ \ \ \ \ \ got\_any\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00649\ \ \ \ \ \}}
\DoxyCodeLine{00650\ \ \ \}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \ \ \textcolor{keywordflow}{if}\ (!got\_any)\ \{}
\DoxyCodeLine{00653\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00654\ \ \ \}}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ \textcolor{comment}{//\ Now\ recursively\ fill\ in\ any\ missing\ holes\ in\ the\ mini-\/grid.}}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{for}\ (yi\ =\ 0;\ yi\ <\ y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00658\ \ \ \ \ \textcolor{keywordflow}{for}\ (xi\ =\ 0;\ xi\ <\ x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00659\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ gi\ =\ yi\ *\ x\_size\ +\ xi;}
\DoxyCodeLine{00660\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (mini\_grid[gi].\_dist\ ==\ 0)\ \{}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ sxi\ =\ mini\_grid[gi].\_sxi;}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ syi\ =\ mini\_grid[gi].\_syi;}
\DoxyCodeLine{00663\ \ \ \ \ \ \ \ \ fill\_mini\_grid(\&mini\_grid[0],\ x\_size,\ y\_size,\ xi\ +\ 1,\ yi,\ 1,\ sxi,\ syi);}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ fill\_mini\_grid(\&mini\_grid[0],\ x\_size,\ y\_size,\ xi\ -\/\ 1,\ yi,\ 1,\ sxi,\ syi);}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ fill\_mini\_grid(\&mini\_grid[0],\ x\_size,\ y\_size,\ xi,\ yi\ +\ 1,\ 1,\ sxi,\ syi);}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \ \ fill\_mini\_grid(\&mini\_grid[0],\ x\_size,\ y\_size,\ xi,\ yi\ -\/\ 1,\ 1,\ sxi,\ syi);}
\DoxyCodeLine{00667\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00668\ \ \ \ \ \}}
\DoxyCodeLine{00669\ \ \ \}}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ \textcolor{comment}{//\ Now\ the\ mini-\/grid\ is\ completely\ filled,\ so\ we\ can\ compute\ the\ average.}}
\DoxyCodeLine{00672\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ gi\ =\ 0;\ gi\ <\ size;\ ++gi)\ \{}
\DoxyCodeLine{00673\ \ \ \ \ \textcolor{keywordtype}{int}\ sxi\ =\ mini\_grid[gi].\_sxi;}
\DoxyCodeLine{00674\ \ \ \ \ \textcolor{keywordtype}{int}\ syi\ =\ mini\_grid[gi].\_syi;}
\DoxyCodeLine{00675\ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&p\ =\ get\_point(sxi,\ syi);}
\DoxyCodeLine{00676\ \ \ \ \ result\ +=\ p;}
\DoxyCodeLine{00677\ \ \ \}}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ result\ /=\ PN\_float32(size);}
\DoxyCodeLine{00680\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00681\ \}}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00688\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00689\ calc\_bilinear\_point(LPoint3f\ \&result,\ PN\_float32\ x,\ PN\_float32\ y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00690\ \ \ result\ =\ LPoint3f::zero();}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ x\ =\ (x\ *\ \_x\_size\ -\/\ 0.5);}
\DoxyCodeLine{00693\ \ \ y\ =\ (y\ *\ \_y\_size\ -\/\ 0.5);}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ \textcolor{keywordtype}{int}\ min\_x\ =\ int(floor(x));}
\DoxyCodeLine{00696\ \ \ \textcolor{keywordtype}{int}\ min\_y\ =\ int(floor(y));}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ \ \ PN\_float32\ frac\_x\ =\ x\ -\/\ min\_x;}
\DoxyCodeLine{00699\ \ \ PN\_float32\ frac\_y\ =\ y\ -\/\ min\_y;}
\DoxyCodeLine{00700\ }
\DoxyCodeLine{00701\ \ \ LPoint3f\ p00(LPoint3f::zero()),\ p01(LPoint3f::zero()),\ p10(LPoint3f::zero()),\ p11(LPoint3f::zero());}
\DoxyCodeLine{00702\ \ \ PN\_float32\ w00\ =\ 0.0,\ w01\ =\ 0.0,\ w10\ =\ 0.0,\ w11\ =\ 0.0;}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \textcolor{keywordflow}{if}\ (has\_point(min\_x,\ min\_y))\ \{}
\DoxyCodeLine{00705\ \ \ \ \ w00\ =\ (1.0\ -\/\ frac\_y)\ *\ (1.0\ -\/\ frac\_x);}
\DoxyCodeLine{00706\ \ \ \ \ p00\ =\ get\_point(min\_x,\ min\_y);}
\DoxyCodeLine{00707\ \ \ \}}
\DoxyCodeLine{00708\ \ \ \textcolor{keywordflow}{if}\ (has\_point(min\_x\ +\ 1,\ min\_y))\ \{}
\DoxyCodeLine{00709\ \ \ \ \ w10\ =\ (1.0\ -\/\ frac\_y)\ *\ frac\_x;}
\DoxyCodeLine{00710\ \ \ \ \ p10\ =\ get\_point(min\_x\ +\ 1,\ min\_y);}
\DoxyCodeLine{00711\ \ \ \}}
\DoxyCodeLine{00712\ \ \ \textcolor{keywordflow}{if}\ (has\_point(min\_x,\ min\_y\ +\ 1))\ \{}
\DoxyCodeLine{00713\ \ \ \ \ w01\ =\ frac\_y\ *\ (1.0\ -\/\ frac\_x);}
\DoxyCodeLine{00714\ \ \ \ \ p01\ =\ get\_point(min\_x,\ min\_y\ +\ 1);}
\DoxyCodeLine{00715\ \ \ \}}
\DoxyCodeLine{00716\ \ \ \textcolor{keywordflow}{if}\ (has\_point(min\_x\ +\ 1,\ min\_y\ +\ 1))\ \{}
\DoxyCodeLine{00717\ \ \ \ \ w11\ =\ frac\_y\ *\ frac\_x;}
\DoxyCodeLine{00718\ \ \ \ \ p11\ =\ get\_point(min\_x\ +\ 1,\ min\_y\ +\ 1);}
\DoxyCodeLine{00719\ \ \ \}}
\DoxyCodeLine{00720\ }
\DoxyCodeLine{00721\ \ \ PN\_float32\ net\_w\ =\ w00\ +\ w01\ +\ w10\ +\ w11;}
\DoxyCodeLine{00722\ \ \ \textcolor{keywordflow}{if}\ (net\_w\ ==\ 0.0)\ \{}
\DoxyCodeLine{00723\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00724\ \ \ \}}
\DoxyCodeLine{00725\ }
\DoxyCodeLine{00726\ \ \ result\ =\ (p00\ *\ w00\ +\ p01\ *\ w01\ +\ p10\ *\ w10\ +\ p11\ *\ w11)\ /\ net\_w;}
\DoxyCodeLine{00727\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00728\ \}}
\DoxyCodeLine{00729\ }
\DoxyCodeLine{00736\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00737\ calc\_min\_max(LVecBase3f\ \&min\_depth,\ LVecBase3f\ \&max\_depth)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00738\ \ \ \textcolor{keywordtype}{bool}\ any\_points\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00740\ \ \ min\_depth\ =\ LVecBase3f::zero();}
\DoxyCodeLine{00741\ \ \ max\_depth\ =\ LVecBase3f::zero();}
\DoxyCodeLine{00742\ }
\DoxyCodeLine{00743\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00748\ }
\DoxyCodeLine{00749\ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&p\ =\ get\_point(xi,\ yi);}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!any\_points)\ \{}
\DoxyCodeLine{00751\ \ \ \ \ \ \ \ \ min\_depth\ =\ p;}
\DoxyCodeLine{00752\ \ \ \ \ \ \ \ \ max\_depth\ =\ p;}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ any\_points\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ min\_depth[0]\ =\ min(min\_depth[0],\ p[0]);}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ min\_depth[1]\ =\ min(min\_depth[1],\ p[1]);}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ min\_depth[2]\ =\ min(min\_depth[2],\ p[2]);}
\DoxyCodeLine{00758\ \ \ \ \ \ \ \ \ max\_depth[0]\ =\ max(max\_depth[0],\ p[0]);}
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ max\_depth[1]\ =\ max(max\_depth[1],\ p[1]);}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ max\_depth[2]\ =\ max(max\_depth[2],\ p[2]);}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00762\ \ \ \ \ \}}
\DoxyCodeLine{00763\ \ \ \}}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ \textcolor{keywordflow}{return}\ any\_points;}
\DoxyCodeLine{00766\ \}}
\DoxyCodeLine{00767\ }
\DoxyCodeLine{00774\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00775\ calc\_autocrop(\textcolor{keywordtype}{int}\ \&x\_begin,\ \textcolor{keywordtype}{int}\ \&x\_end,\ \textcolor{keywordtype}{int}\ \&y\_begin,\ \textcolor{keywordtype}{int}\ \&y\_end)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00776\ \ \ y\_begin\ =\ 0;}
\DoxyCodeLine{00777\ \ \ \textcolor{keywordflow}{while}\ (is\_row\_empty(y\_begin,\ 0,\ \_x\_size))\ \{}
\DoxyCodeLine{00778\ \ \ \ \ ++y\_begin;}
\DoxyCodeLine{00779\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_begin\ >=\ \_y\_size)\ \{}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \textcolor{comment}{//\ We've\ reached\ the\ end;\ the\ entire\ grid\ is\ empty.}}
\DoxyCodeLine{00781\ \ \ \ \ \ \ x\_begin\ =\ x\_end\ =\ y\_begin\ =\ y\_end\ =\ 0;}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00783\ \ \ \ \ \}}
\DoxyCodeLine{00784\ \ \ \}}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ y\_end\ =\ \_y\_size;}
\DoxyCodeLine{00787\ \ \ \textcolor{keywordflow}{while}\ (is\_row\_empty(y\_end\ -\/\ 1,\ 0,\ \_x\_size))\ \{}
\DoxyCodeLine{00788\ \ \ \ \ -\/-\/y\_end;}
\DoxyCodeLine{00789\ \ \ \ \ nassertr(y\_end\ >\ y\_begin,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00790\ \ \ \}}
\DoxyCodeLine{00791\ }
\DoxyCodeLine{00792\ \ \ \textcolor{comment}{//\ Now\ we've\ got\ the\ top\ and\ bottom\ bounds.}}
\DoxyCodeLine{00793\ \ \ x\_begin\ =\ 0;}
\DoxyCodeLine{00794\ \ \ \textcolor{keywordflow}{while}\ (is\_column\_empty(x\_begin,\ y\_begin,\ y\_end))\ \{}
\DoxyCodeLine{00795\ \ \ \ \ ++x\_begin;}
\DoxyCodeLine{00796\ \ \ \ \ nassertr(x\_begin\ <\ \_x\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00797\ \ \ \}}
\DoxyCodeLine{00798\ }
\DoxyCodeLine{00799\ \ \ x\_end\ =\ \_x\_size;}
\DoxyCodeLine{00800\ \ \ \textcolor{keywordflow}{while}\ (is\_column\_empty(x\_end\ -\/\ 1,\ y\_begin,\ y\_end))\ \{}
\DoxyCodeLine{00801\ \ \ \ \ -\/-\/x\_end;}
\DoxyCodeLine{00802\ \ \ \ \ nassertr(x\_end\ >\ x\_begin,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00803\ \ \ \}}
\DoxyCodeLine{00804\ }
\DoxyCodeLine{00805\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00806\ \}}
\DoxyCodeLine{00807\ }
\DoxyCodeLine{00812\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00813\ is\_row\_empty(\textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ x\_begin,\ \textcolor{keywordtype}{int}\ x\_end)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00814\ \ \ nassertr(y\ >=\ 0\ \&\&\ y\ <\ \_y\_size\ \&\&}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ \ \ \ x\_begin\ >=\ 0\ \&\&\ x\_begin\ <=\ x\_end\ \&\&\ x\_end\ <=\ \_x\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00816\ }
\DoxyCodeLine{00817\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{00818\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00819\ \ \ \}}
\DoxyCodeLine{00820\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ x\_begin;\ x\ <\ x\_end;\ ++x)\ \{}
\DoxyCodeLine{00821\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00823\ \ \ \ \ \}}
\DoxyCodeLine{00824\ \ \ \}}
\DoxyCodeLine{00825\ }
\DoxyCodeLine{00826\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00827\ \}}
\DoxyCodeLine{00828\ }
\DoxyCodeLine{00833\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{00834\ is\_column\_empty(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y\_begin,\ \textcolor{keywordtype}{int}\ y\_end)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00835\ \ \ nassertr(x\ >=\ 0\ \&\&\ x\ <\ \_x\_size\ \&\&}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ \ \ \ y\_begin\ >=\ 0\ \&\&\ y\_begin\ <=\ y\_end\ \&\&\ y\_end\ <=\ \_y\_size,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00837\ }
\DoxyCodeLine{00838\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{00839\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00840\ \ \ \}}
\DoxyCodeLine{00841\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ y\_begin;\ y\ <\ y\_end;\ ++y)\ \{}
\DoxyCodeLine{00842\ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{00843\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00844\ \ \ \ \ \}}
\DoxyCodeLine{00845\ \ \ \}}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00848\ \}}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00857\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00858\ set\_no\_data\_nan(\textcolor{keywordtype}{int}\ num\_channels)\ \{}
\DoxyCodeLine{00859\ \ \ \textcolor{keywordflow}{if}\ (num\_channels\ >\ 0)\ \{}
\DoxyCodeLine{00860\ \ \ \ \ num\_channels\ =\ min(num\_channels,\ \_num\_channels);}
\DoxyCodeLine{00861\ \ \ \ \ \_has\_no\_data\_value\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00862\ \ \ \ \ \_has\_no\_data\_threshold\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00863\ \ \ \ \ \_no\_data\_value\ =\ LPoint4f::zero();}
\DoxyCodeLine{00864\ \ \ \ \ PN\_float32\ nan\ =\ make\_nan((PN\_float32)0.0);}
\DoxyCodeLine{00865\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_channels;\ ++i)\ \{}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \_no\_data\_value[i]\ =\ nan;}
\DoxyCodeLine{00867\ \ \ \ \ \}}
\DoxyCodeLine{00868\ \ \ \ \ \textcolor{keywordflow}{switch}\ (num\_channels)\ \{}
\DoxyCodeLine{00869\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \_has\_point\ =\ has\_point\_nan\_1;}
\DoxyCodeLine{00871\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00872\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \_has\_point\ =\ has\_point\_nan\_2;}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00875\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \_has\_point\ =\ has\_point\_nan\_3;}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00878\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00879\ \ \ \ \ \ \ \_has\_point\ =\ has\_point\_nan\_4;}
\DoxyCodeLine{00880\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00881\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00882\ \ \ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00884\ \ \ \ \ \}}
\DoxyCodeLine{00885\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00886\ \ \ \ \ clear\_no\_data\_value();}
\DoxyCodeLine{00887\ \ \ \}}
\DoxyCodeLine{00888\ \}}
\DoxyCodeLine{00889\ }
\DoxyCodeLine{00894\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00895\ set\_no\_data\_value(\textcolor{keyword}{const}\ LPoint4f\ \&no\_data\_value)\ \{}
\DoxyCodeLine{00896\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{00897\ }
\DoxyCodeLine{00898\ \ \ \_has\_no\_data\_value\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00899\ \ \ \_has\_no\_data\_threshold\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00900\ \ \ \_no\_data\_value\ =\ no\_data\_value;}
\DoxyCodeLine{00901\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{00902\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00903\ \ \ \ \ \_has\_point\ =\ has\_point\_1;}
\DoxyCodeLine{00904\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00905\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00906\ \ \ \ \ \_has\_point\ =\ has\_point\_2;}
\DoxyCodeLine{00907\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00908\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00909\ \ \ \ \ \_has\_point\ =\ has\_point\_3;}
\DoxyCodeLine{00910\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00911\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00912\ \ \ \ \ \_has\_point\ =\ has\_point\_4;}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00914\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00915\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{00916\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00917\ \ \ \}}
\DoxyCodeLine{00918\ \}}
\DoxyCodeLine{00919\ }
\DoxyCodeLine{00924\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00925\ set\_no\_data\_threshold(\textcolor{keyword}{const}\ LPoint4f\ \&no\_data\_value)\ \{}
\DoxyCodeLine{00926\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \_has\_no\_data\_value\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00929\ \ \ \_has\_no\_data\_threshold\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00930\ \ \ \_no\_data\_value\ =\ no\_data\_value;}
\DoxyCodeLine{00931\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{00932\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00933\ \ \ \ \ \_has\_point\ =\ has\_point\_threshold\_1;}
\DoxyCodeLine{00934\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00935\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00936\ \ \ \ \ \_has\_point\ =\ has\_point\_threshold\_2;}
\DoxyCodeLine{00937\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00938\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{00939\ \ \ \ \ \_has\_point\ =\ has\_point\_threshold\_3;}
\DoxyCodeLine{00940\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00941\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{00942\ \ \ \ \ \_has\_point\ =\ has\_point\_threshold\_4;}
\DoxyCodeLine{00943\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00944\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00945\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{00946\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00947\ \ \ \}}
\DoxyCodeLine{00948\ \}}
\DoxyCodeLine{00949\ }
\DoxyCodeLine{00955\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00956\ resize(\textcolor{keywordtype}{int}\ new\_x\_size,\ \textcolor{keywordtype}{int}\ new\_y\_size)\ \{}
\DoxyCodeLine{00957\ \ \ \textcolor{keywordflow}{if}\ (\_x\_size\ ==\ 0\ ||\ \_y\_size\ ==\ 0\ ||\ new\_x\_size\ ==\ 0\ ||\ new\_y\_size\ ==\ 0)\ \{}
\DoxyCodeLine{00958\ \ \ \ \ clear(new\_x\_size,\ new\_y\_size,\ \_num\_channels);}
\DoxyCodeLine{00959\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00960\ \ \ \}}
\DoxyCodeLine{00961\ }
\DoxyCodeLine{00962\ \ \ \textcolor{keywordflow}{if}\ (new\_x\_size\ ==\ \_x\_size\ \&\&\ new\_y\_size\ ==\ \_y\_size)\ \{}
\DoxyCodeLine{00963\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00964\ \ \ \}}
\DoxyCodeLine{00965\ }
\DoxyCodeLine{00966\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ result;}
\DoxyCodeLine{00967\ \ \ result.clear(new\_x\_size,\ new\_y\_size,\ \_num\_channels);}
\DoxyCodeLine{00968\ \ \ \textcolor{keywordflow}{if}\ (\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{00969\ \ \ \ \ result.fill(\_no\_data\_value);}
\DoxyCodeLine{00970\ \ \ \}}
\DoxyCodeLine{00971\ }
\DoxyCodeLine{00972\ \ \ \textcolor{keywordflow}{if}\ (pfm\_resize\_quick\ \&\&\ new\_x\_size\ <=\ \_x\_size\ \&\&\ new\_y\_size\ <=\ \_y\_size)\ \{}
\DoxyCodeLine{00973\ \ \ \ \ \textcolor{comment}{//\ If\ we're\ downscaling,\ we\ can\ use\ quick\_filter,\ which\ is\ faster.}}
\DoxyCodeLine{00974\ \ \ \ \ result.quick\_filter\_from(*\textcolor{keyword}{this});}
\DoxyCodeLine{00975\ }
\DoxyCodeLine{00976\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00977\ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ we\ should\ use\ box\_filter()\ or\ gaussian\_filter,\ which\ are}}
\DoxyCodeLine{00978\ \ \ \ \ \textcolor{comment}{//\ more\ general.}}
\DoxyCodeLine{00979\ \ \ \ \ \textcolor{keywordflow}{if}\ (pfm\_resize\_gaussian)\ \{}
\DoxyCodeLine{00980\ \ \ \ \ \ \ result.gaussian\_filter\_from(pfm\_resize\_radius,\ *\textcolor{keyword}{this});}
\DoxyCodeLine{00981\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00982\ \ \ \ \ \ \ result.box\_filter\_from(pfm\_resize\_radius,\ *\textcolor{keyword}{this});}
\DoxyCodeLine{00983\ \ \ \ \ \}}
\DoxyCodeLine{00984\ \ \ \}}
\DoxyCodeLine{00985\ }
\DoxyCodeLine{00986\ \ \ \_table.swap(result.\_table);}
\DoxyCodeLine{00987\ \ \ \_x\_size\ =\ new\_x\_size;}
\DoxyCodeLine{00988\ \ \ \_y\_size\ =\ new\_y\_size;}
\DoxyCodeLine{00989\ \}}
\DoxyCodeLine{00990\ }
\DoxyCodeLine{00997\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{00998\ quick\_filter\_from(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&from)\ \{}
\DoxyCodeLine{00999\ \ \ \textcolor{keywordflow}{if}\ (\_x\_size\ ==\ 0\ ||\ \_y\_size\ ==\ 0)\ \{}
\DoxyCodeLine{01000\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01001\ \ \ \}}
\DoxyCodeLine{01002\ }
\DoxyCodeLine{01003\ \ \ Table\ new\_data;}
\DoxyCodeLine{01004\ \ \ new\_data.reserve(\_table.size());}
\DoxyCodeLine{01005\ }
\DoxyCodeLine{01006\ \ \ PN\_float32\ from\_x0,\ from\_x1,\ from\_y0,\ from\_y1;}
\DoxyCodeLine{01007\ }
\DoxyCodeLine{01008\ \ \ \textcolor{keywordtype}{int}\ orig\_x\_size\ =\ from.get\_x\_size();}
\DoxyCodeLine{01009\ \ \ \textcolor{keywordtype}{int}\ orig\_y\_size\ =\ from.get\_y\_size();}
\DoxyCodeLine{01010\ }
\DoxyCodeLine{01011\ \ \ PN\_float32\ x\_scale\ =\ 1.0;}
\DoxyCodeLine{01012\ \ \ PN\_float32\ y\_scale\ =\ 1.0;}
\DoxyCodeLine{01013\ }
\DoxyCodeLine{01014\ \ \ \textcolor{keywordflow}{if}\ (\_x\_size\ >\ 1)\ \{}
\DoxyCodeLine{01015\ \ \ \ \ x\_scale\ =\ (PN\_float32)orig\_x\_size\ /\ (PN\_float32)\_x\_size;}
\DoxyCodeLine{01016\ \ \ \}}
\DoxyCodeLine{01017\ \ \ \textcolor{keywordflow}{if}\ (\_y\_size\ >\ 1)\ \{}
\DoxyCodeLine{01018\ \ \ \ \ y\_scale\ =\ (PN\_float32)orig\_y\_size\ /\ (PN\_float32)\_y\_size;}
\DoxyCodeLine{01019\ \ \ \}}
\DoxyCodeLine{01020\ }
\DoxyCodeLine{01021\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{01022\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01023\ \ \ \ \ \{}
\DoxyCodeLine{01024\ \ \ \ \ \ \ from\_y0\ =\ 0.0;}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_y\ =\ 0;\ to\_y\ <\ \_y\_size;\ ++to\_y)\ \{}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ from\_y1\ =\ (to\_y\ +\ 1.0)\ *\ y\_scale;}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ from\_y1\ =\ min(from\_y1,\ (PN\_float32)orig\_y\_size);}
\DoxyCodeLine{01028\ }
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ from\_x0\ =\ 0.0;}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_x\ =\ 0;\ to\_x\ <\ \_x\_size;\ ++to\_x)\ \{}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ (to\_x\ +\ 1.0)\ *\ x\_scale;}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ min(from\_x1,\ (PN\_float32)orig\_x\_size);}
\DoxyCodeLine{01033\ }
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ the\ box\ from\ (from\_x0,\ from\_y0)\ -\/\ (from\_x1,\ from\_y1)\ but\ not}}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ including\ (from\_x1,\ from\_y1)\ maps\ to\ the\ pixel\ (to\_x,\ to\_y).}}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ PN\_float32\ result;}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ from.box\_filter\_region(result,\ from\_x0,\ from\_y0,\ from\_x1,\ from\_y1);}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result);}
\DoxyCodeLine{01039\ }
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ from\_x0\ =\ from\_x1;}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ from\_y0\ =\ from\_y1;}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01044\ \ \ \ \ \}}
\DoxyCodeLine{01045\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01046\ }
\DoxyCodeLine{01047\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{01048\ \ \ \ \ \{}
\DoxyCodeLine{01049\ \ \ \ \ \ \ from\_y0\ =\ 0.0;}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_y\ =\ 0;\ to\_y\ <\ \_y\_size;\ ++to\_y)\ \{}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ from\_y1\ =\ (to\_y\ +\ 1.0)\ *\ y\_scale;}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ from\_y1\ =\ min(from\_y1,\ (PN\_float32)orig\_y\_size);}
\DoxyCodeLine{01053\ }
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ from\_x0\ =\ 0.0;}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_x\ =\ 0;\ to\_x\ <\ \_x\_size;\ ++to\_x)\ \{}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ (to\_x\ +\ 1.0)\ *\ x\_scale;}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ min(from\_x1,\ (PN\_float32)orig\_x\_size);}
\DoxyCodeLine{01058\ }
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ the\ box\ from\ (from\_x0,\ from\_y0)\ -\/\ (from\_x1,\ from\_y1)\ but\ not}}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ including\ (from\_x1,\ from\_y1)\ maps\ to\ the\ pixel\ (to\_x,\ to\_y).}}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ LPoint2f\ result;}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ from.box\_filter\_region(result,\ from\_x0,\ from\_y0,\ from\_x1,\ from\_y1);}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[0]);}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[1]);}
\DoxyCodeLine{01065\ }
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \ \ from\_x0\ =\ from\_x1;}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ from\_y0\ =\ from\_y1;}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01070\ \ \ \ \ \}}
\DoxyCodeLine{01071\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01072\ }
\DoxyCodeLine{01073\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{01074\ \ \ \ \ \{}
\DoxyCodeLine{01075\ \ \ \ \ \ \ from\_y0\ =\ 0.0;}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_y\ =\ 0;\ to\_y\ <\ \_y\_size;\ ++to\_y)\ \{}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ from\_y1\ =\ (to\_y\ +\ 1.0)\ *\ y\_scale;}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ from\_y1\ =\ min(from\_y1,\ (PN\_float32)orig\_y\_size);}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ from\_x0\ =\ 0.0;}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_x\ =\ 0;\ to\_x\ <\ \_x\_size;\ ++to\_x)\ \{}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ (to\_x\ +\ 1.0)\ *\ x\_scale;}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ min(from\_x1,\ (PN\_float32)orig\_x\_size);}
\DoxyCodeLine{01084\ }
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ the\ box\ from\ (from\_x0,\ from\_y0)\ -\/\ (from\_x1,\ from\_y1)\ but\ not}}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ including\ (from\_x1,\ from\_y1)\ maps\ to\ the\ pixel\ (to\_x,\ to\_y).}}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \ \ LPoint3f\ result;}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \ \ from.box\_filter\_region(result,\ from\_x0,\ from\_y0,\ from\_x1,\ from\_y1);}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[0]);}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[1]);}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[2]);}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ from\_x0\ =\ from\_x1;}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ from\_y0\ =\ from\_y1;}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01097\ \ \ \ \ \}}
\DoxyCodeLine{01098\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01099\ }
\DoxyCodeLine{01100\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{01101\ \ \ \ \ \{}
\DoxyCodeLine{01102\ \ \ \ \ \ \ from\_y0\ =\ 0.0;}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_y\ =\ 0;\ to\_y\ <\ \_y\_size;\ ++to\_y)\ \{}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ from\_y1\ =\ (to\_y\ +\ 1.0)\ *\ y\_scale;}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ from\_y1\ =\ min(from\_y1,\ (PN\_float32)orig\_y\_size);}
\DoxyCodeLine{01106\ }
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ from\_x0\ =\ 0.0;}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ to\_x\ =\ 0;\ to\_x\ <\ \_x\_size;\ ++to\_x)\ \{}
\DoxyCodeLine{01109\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ (to\_x\ +\ 1.0)\ *\ x\_scale;}
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ from\_x1\ =\ min(from\_x1,\ (PN\_float32)orig\_x\_size);}
\DoxyCodeLine{01111\ }
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ the\ box\ from\ (from\_x0,\ from\_y0)\ -\/\ (from\_x1,\ from\_y1)\ but\ not}}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ including\ (from\_x1,\ from\_y1)\ maps\ to\ the\ pixel\ (to\_x,\ to\_y).}}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \ \ LPoint4f\ result;}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ from.box\_filter\_region(result,\ from\_x0,\ from\_y0,\ from\_x1,\ from\_y1);}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[0]);}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[1]);}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[2]);}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ new\_data.push\_back(result[3]);}
\DoxyCodeLine{01120\ }
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \ \ from\_x0\ =\ from\_x1;}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ from\_y0\ =\ from\_y1;}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01125\ \ \ \ \ \}}
\DoxyCodeLine{01126\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01128\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01129\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{01130\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01131\ \ \ \}}
\DoxyCodeLine{01132\ }
\DoxyCodeLine{01133\ \ \ new\_data.push\_back(0.0);}
\DoxyCodeLine{01134\ \ \ new\_data.push\_back(0.0);}
\DoxyCodeLine{01135\ \ \ new\_data.push\_back(0.0);}
\DoxyCodeLine{01136\ \ \ new\_data.push\_back(0.0);}
\DoxyCodeLine{01137\ }
\DoxyCodeLine{01138\ \ \ nassertv(new\_data.size()\ ==\ \_table.size());}
\DoxyCodeLine{01139\ \ \ \_table.swap(new\_data);}
\DoxyCodeLine{01140\ \}}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01145\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01146\ reverse\_rows()\ \{}
\DoxyCodeLine{01147\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{01148\ }
\DoxyCodeLine{01149\ \ \ Table\ reversed;}
\DoxyCodeLine{01150\ \ \ reversed.reserve(\_table.size());}
\DoxyCodeLine{01151\ \ \ \textcolor{keywordtype}{int}\ row\_size\ =\ \_x\_size\ *\ \_num\_channels;}
\DoxyCodeLine{01152\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01153\ \ \ \ \ \textcolor{keywordtype}{int}\ source\_yi\ =\ \_y\_size\ -\/\ 1\ -\/\ yi;}
\DoxyCodeLine{01154\ \ \ \ \ \textcolor{keywordtype}{int}\ start\ =\ source\_yi\ *\ row\_size;}
\DoxyCodeLine{01155\ \ \ \ \ reversed.insert(reversed.end(),}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_table.begin()\ +\ start,\ \_table.begin()\ +\ start\ +\ row\_size);}
\DoxyCodeLine{01157\ \ \ \}}
\DoxyCodeLine{01158\ }
\DoxyCodeLine{01159\ \ \ nassertv(reversed.size()\ <=\ \_table.size());}
\DoxyCodeLine{01160\ \ \ \textcolor{comment}{//\ Also\ add\ in\ the\ extra\ buffer\ at\ the\ end.}}
\DoxyCodeLine{01161\ \ \ reversed.insert(reversed.end(),\ \_table.size()\ -\/\ reversed.size(),\ (PN\_float32)0.0);}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01163\ \ \ \_table.swap(reversed);}
\DoxyCodeLine{01164\ \}}
\DoxyCodeLine{01165\ }
\DoxyCodeLine{01173\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01174\ flip(\textcolor{keywordtype}{bool}\ flip\_x,\ \textcolor{keywordtype}{bool}\ flip\_y,\ \textcolor{keywordtype}{bool}\ transpose)\ \{}
\DoxyCodeLine{01175\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{01176\ }
\DoxyCodeLine{01177\ \ \ Table\ flipped;}
\DoxyCodeLine{01178\ \ \ flipped.reserve(\_table.size());}
\DoxyCodeLine{01179\ }
\DoxyCodeLine{01180\ \ \ \textcolor{keywordflow}{if}\ (transpose)\ \{}
\DoxyCodeLine{01181\ \ \ \ \ \textcolor{comment}{//\ Transposed\ case.\ \ X\ becomes\ Y,\ Y\ becomes\ X.}}
\DoxyCodeLine{01182\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ source\_xi\ =\ !flip\_x\ ?\ xi\ :\ \_x\_size\ -\/\ 1\ -\/\ xi;}
\DoxyCodeLine{01184\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ source\_yi\ =\ !flip\_y\ ?\ yi\ :\ \_y\_size\ -\/\ 1\ -\/\ yi;}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PN\_float32\ *p\ =\ \&\_table[(source\_yi\ *\ \_x\_size\ +\ source\_xi)\ *\ \_num\_channels];}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ \_num\_channels;\ ++ci)\ \{}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \ \ flipped.push\_back(p[ci]);}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01191\ \ \ \ \ \}}
\DoxyCodeLine{01192\ }
\DoxyCodeLine{01193\ \ \ \ \ \textcolor{keywordtype}{int}\ t\ =\ \_x\_size;}
\DoxyCodeLine{01194\ \ \ \ \ \_x\_size\ =\ \_y\_size;}
\DoxyCodeLine{01195\ \ \ \ \ \_y\_size\ =\ t;}
\DoxyCodeLine{01196\ }
\DoxyCodeLine{01197\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01198\ \ \ \ \ \textcolor{comment}{//\ Non-\/transposed.\ \ X\ is\ X,\ Y\ is\ Y.}}
\DoxyCodeLine{01199\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ source\_yi\ =\ !flip\_y\ ?\ yi\ :\ \_y\_size\ -\/\ 1\ -\/\ yi;}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ source\_xi\ =\ !flip\_x\ ?\ xi\ :\ \_x\_size\ -\/\ 1\ -\/\ xi;}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ PN\_float32\ *p\ =\ \&\_table[(source\_yi\ *\ \_x\_size\ +\ source\_xi)\ *\ \_num\_channels];}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ \_num\_channels;\ ++ci)\ \{}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \ \ flipped.push\_back(p[ci]);}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01208\ \ \ \ \ \}}
\DoxyCodeLine{01209\ \ \ \}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ nassertv(flipped.size()\ <=\ \_table.size());}
\DoxyCodeLine{01212\ \ \ \textcolor{comment}{//\ Also\ add\ in\ the\ extra\ buffer\ at\ the\ end.}}
\DoxyCodeLine{01213\ \ \ flipped.insert(flipped.end(),\ \_table.size()\ -\/\ flipped.size(),\ (PN\_float32)0.0);}
\DoxyCodeLine{01214\ }
\DoxyCodeLine{01215\ \ \ \_table.swap(flipped);}
\DoxyCodeLine{01216\ \}}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01221\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01222\ xform(\textcolor{keyword}{const}\ LMatrix4f\ \&transform)\ \{}
\DoxyCodeLine{01223\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01225\ \ \ \textcolor{keywordtype}{int}\ num\_channels\ =\ get\_num\_channels();}
\DoxyCodeLine{01226\ \ \ \textcolor{keywordflow}{switch}\ (num\_channels)\ \{}
\DoxyCodeLine{01227\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01228\ \ \ \ \ \{}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ \ \ PN\_float32\ pi\ =\ get\_point1(xi,\ yi);}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ \ \ LPoint3f\ po\ =\ transform.xform\_point(LPoint3f(pi,\ 0.0,\ 0.0));}
\DoxyCodeLine{01236\ \ \ \ \ \ \ \ \ \ \ set\_point1(xi,\ yi,\ po[0]);}
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01239\ \ \ \ \ \}}
\DoxyCodeLine{01240\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{01243\ \ \ \ \ \{}
\DoxyCodeLine{01244\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01247\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ \ \ LPoint2f\ pi\ =\ get\_point2(xi,\ yi);}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ \ \ LPoint3f\ po\ =\ transform.xform\_point(LPoint3f(pi[0],\ pi[1],\ 0.0));}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ \ \ set\_point2(xi,\ yi,\ LPoint2f(po[0],\ po[1]));}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01253\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01254\ \ \ \ \ \}}
\DoxyCodeLine{01255\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01256\ }
\DoxyCodeLine{01257\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{01258\ \ \ \ \ \{}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01261\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01262\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01263\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \ \ LPoint3f\ \&p\ =\ modify\_point3(xi,\ yi);}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ transform.xform\_point\_general\_in\_place(p);}
\DoxyCodeLine{01266\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01267\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01268\ \ \ \ \ \}}
\DoxyCodeLine{01269\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01270\ }
\DoxyCodeLine{01271\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{01272\ \ \ \ \ \{}
\DoxyCodeLine{01273\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01275\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01277\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ LPoint4f\ \&p\ =\ modify\_point4(xi,\ yi);}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ transform.xform\_in\_place(p);}
\DoxyCodeLine{01280\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01281\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01282\ \ \ \ \ \}}
\DoxyCodeLine{01283\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01284\ \ \ \}}
\DoxyCodeLine{01285\ \}}
\DoxyCodeLine{01286\ }
\DoxyCodeLine{01304\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01305\ forward\_distort(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&dist,\ PN\_float32\ scale\_factor)\ \{}
\DoxyCodeLine{01306\ \ \ \textcolor{keywordtype}{int}\ working\_x\_size\ =\ (int)cceil(\_x\_size\ *\ scale\_factor);}
\DoxyCodeLine{01307\ \ \ \textcolor{keywordtype}{int}\ working\_y\_size\ =\ (int)cceil(\_y\_size\ *\ scale\_factor);}
\DoxyCodeLine{01308\ }
\DoxyCodeLine{01309\ \ \ working\_x\_size\ =\ max(working\_x\_size,\ dist.get\_x\_size());}
\DoxyCodeLine{01310\ \ \ working\_y\_size\ =\ max(working\_y\_size,\ dist.get\_y\_size());}
\DoxyCodeLine{01311\ }
\DoxyCodeLine{01312\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *source\_p\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01313\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ scaled\_source;}
\DoxyCodeLine{01314\ \ \ \textcolor{keywordflow}{if}\ ((*this).get\_x\_size()\ !=\ working\_x\_size\ ||\ (*this).get\_y\_size()\ !=\ working\_y\_size)\ \{}
\DoxyCodeLine{01315\ \ \ \ \ \textcolor{comment}{//\ Rescale\ the\ source\ file\ as\ needed.}}
\DoxyCodeLine{01316\ \ \ \ \ scaled\_source\ =\ (*this);}
\DoxyCodeLine{01317\ \ \ \ \ scaled\_source.resize(working\_x\_size,\ working\_y\_size);}
\DoxyCodeLine{01318\ \ \ \ \ source\_p\ =\ \&scaled\_source;}
\DoxyCodeLine{01319\ \ \ \}}
\DoxyCodeLine{01320\ }
\DoxyCodeLine{01321\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *dist\_p\ =\ \&dist;}
\DoxyCodeLine{01322\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ scaled\_dist;}
\DoxyCodeLine{01323\ \ \ \textcolor{keywordflow}{if}\ (dist.get\_x\_size()\ !=\ working\_x\_size\ ||\ dist.get\_y\_size()\ !=\ working\_y\_size)\ \{}
\DoxyCodeLine{01324\ \ \ \ \ \textcolor{comment}{//\ Rescale\ the\ dist\ file\ as\ needed.}}
\DoxyCodeLine{01325\ \ \ \ \ scaled\_dist\ =\ dist;}
\DoxyCodeLine{01326\ \ \ \ \ scaled\_dist.resize(working\_x\_size,\ working\_y\_size);}
\DoxyCodeLine{01327\ \ \ \ \ dist\_p\ =\ \&scaled\_dist;}
\DoxyCodeLine{01328\ \ \ \}}
\DoxyCodeLine{01329\ }
\DoxyCodeLine{01330\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ result;}
\DoxyCodeLine{01331\ \ \ result.clear(working\_x\_size,\ working\_y\_size,\ \_num\_channels);}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \ \ \textcolor{keywordflow}{if}\ (\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{01334\ \ \ \ \ result.set\_no\_data\_value(\_no\_data\_value);}
\DoxyCodeLine{01335\ \ \ \ \ result.fill(\_no\_data\_value);}
\DoxyCodeLine{01336\ \ \ \}}
\DoxyCodeLine{01337\ }
\DoxyCodeLine{01338\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ working\_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01339\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ working\_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01340\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!dist\_p-\/>has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01342\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01343\ \ \ \ \ \ \ LPoint2f\ uv\ =\ dist\_p-\/>get\_point2(xi,\ yi);}
\DoxyCodeLine{01344\ \ \ \ \ \ \ LPoint3f\ p;}
\DoxyCodeLine{01345\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!source\_p-\/>calc\_bilinear\_point(p,\ uv[0],\ 1.0\ -\/\ uv[1]))\ \{}
\DoxyCodeLine{01346\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01347\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01348\ \ \ \ \ \ \ nassertv(!p.is\_nan());}
\DoxyCodeLine{01349\ \ \ \ \ \ \ result.set\_point(xi,\ working\_y\_size\ -\/\ 1\ -\/\ yi,\ p);}
\DoxyCodeLine{01350\ \ \ \ \ \}}
\DoxyCodeLine{01351\ \ \ \}}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \textcolor{comment}{//\ Resize\ to\ the\ target\ size\ for\ completion.}}
\DoxyCodeLine{01354\ \ \ result.resize(\_x\_size,\ \_y\_size);}
\DoxyCodeLine{01355\ }
\DoxyCodeLine{01356\ \ \ nassertv(result.\_table.size()\ ==\ \_table.size());}
\DoxyCodeLine{01357\ \ \ \_table.swap(result.\_table);}
\DoxyCodeLine{01358\ \}}
\DoxyCodeLine{01359\ }
\DoxyCodeLine{01377\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01378\ reverse\_distort(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&dist,\ PN\_float32\ scale\_factor)\ \{}
\DoxyCodeLine{01379\ \ \ \textcolor{keywordtype}{int}\ working\_x\_size\ =\ (int)cceil(\_x\_size\ *\ scale\_factor);}
\DoxyCodeLine{01380\ \ \ \textcolor{keywordtype}{int}\ working\_y\_size\ =\ (int)cceil(\_y\_size\ *\ scale\_factor);}
\DoxyCodeLine{01381\ }
\DoxyCodeLine{01382\ \ \ working\_x\_size\ =\ max(working\_x\_size,\ dist.get\_x\_size());}
\DoxyCodeLine{01383\ \ \ working\_y\_size\ =\ max(working\_y\_size,\ dist.get\_y\_size());}
\DoxyCodeLine{01384\ }
\DoxyCodeLine{01385\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *source\_p\ =\ \textcolor{keyword}{this};}
\DoxyCodeLine{01386\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ scaled\_source;}
\DoxyCodeLine{01387\ \ \ \textcolor{keywordflow}{if}\ ((*this).get\_x\_size()\ !=\ working\_x\_size\ ||\ (*this).get\_y\_size()\ !=\ working\_y\_size)\ \{}
\DoxyCodeLine{01388\ \ \ \ \ \textcolor{comment}{//\ Rescale\ the\ source\ file\ as\ needed.}}
\DoxyCodeLine{01389\ \ \ \ \ scaled\_source\ =\ (*this);}
\DoxyCodeLine{01390\ \ \ \ \ scaled\_source.resize(working\_x\_size,\ working\_y\_size);}
\DoxyCodeLine{01391\ \ \ \ \ source\_p\ =\ \&scaled\_source;}
\DoxyCodeLine{01392\ \ \ \}}
\DoxyCodeLine{01393\ }
\DoxyCodeLine{01394\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *dist\_p\ =\ \&dist;}
\DoxyCodeLine{01395\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ scaled\_dist;}
\DoxyCodeLine{01396\ \ \ \textcolor{keywordflow}{if}\ (dist.get\_x\_size()\ !=\ working\_x\_size\ ||\ dist.get\_y\_size()\ !=\ working\_y\_size)\ \{}
\DoxyCodeLine{01397\ \ \ \ \ \textcolor{comment}{//\ Rescale\ the\ dist\ file\ as\ needed.}}
\DoxyCodeLine{01398\ \ \ \ \ scaled\_dist\ =\ dist;}
\DoxyCodeLine{01399\ \ \ \ \ scaled\_dist.resize(working\_x\_size,\ working\_y\_size);}
\DoxyCodeLine{01400\ \ \ \ \ dist\_p\ =\ \&scaled\_dist;}
\DoxyCodeLine{01401\ \ \ \}}
\DoxyCodeLine{01402\ }
\DoxyCodeLine{01403\ \ \ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ result;}
\DoxyCodeLine{01404\ \ \ result.clear(working\_x\_size,\ working\_y\_size,\ \_num\_channels);}
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \ \ \textcolor{keywordflow}{if}\ (\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{01407\ \ \ \ \ result.set\_no\_data\_value(\_no\_data\_value);}
\DoxyCodeLine{01408\ \ \ \ \ result.fill(\_no\_data\_value);}
\DoxyCodeLine{01409\ \ \ \}}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ working\_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01412\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ working\_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01413\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!source\_p-\/>has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01415\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01416\ \ \ \ \ \ \ LPoint2f\ uv\ =\ source\_p-\/>get\_point2(xi,\ yi);}
\DoxyCodeLine{01417\ \ \ \ \ \ \ LPoint3f\ p;}
\DoxyCodeLine{01418\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!dist\_p-\/>calc\_bilinear\_point(p,\ uv[0],\ 1.0\ -\/\ uv[1]))\ \{}
\DoxyCodeLine{01419\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01420\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01421\ \ \ \ \ \ \ result.set\_point(xi,\ yi,\ LPoint3f(p[0],\ 1.0\ -\/\ p[1],\ p[2]));}
\DoxyCodeLine{01422\ \ \ \ \ \}}
\DoxyCodeLine{01423\ \ \ \}}
\DoxyCodeLine{01424\ }
\DoxyCodeLine{01425\ \ \ \textcolor{comment}{//\ Resize\ to\ the\ target\ size\ for\ completion.}}
\DoxyCodeLine{01426\ \ \ result.resize(\_x\_size,\ \_y\_size);}
\DoxyCodeLine{01427\ }
\DoxyCodeLine{01428\ \ \ nassertv(result.\_table.size()\ ==\ \_table.size());}
\DoxyCodeLine{01429\ \ \ \_table.swap(result.\_table);}
\DoxyCodeLine{01430\ \}}
\DoxyCodeLine{01431\ }
\DoxyCodeLine{01437\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01438\ apply\_1d\_lut(\textcolor{keywordtype}{int}\ channel,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&lut,\ PN\_float32\ x\_scale)\ \{}
\DoxyCodeLine{01439\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01440\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01444\ }
\DoxyCodeLine{01445\ \ \ \ \ \ \ PN\_float32\ v\ =\ get\_channel(xi,\ yi,\ channel);}
\DoxyCodeLine{01446\ \ \ \ \ \ \ LPoint3f\ p;}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!lut.calc\_bilinear\_point(p,\ v\ *\ x\_scale,\ 0.5))\ \{}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01450\ \ \ \ \ \ \ set\_channel(xi,\ yi,\ channel,\ p[0]);}
\DoxyCodeLine{01451\ \ \ \ \ \}}
\DoxyCodeLine{01452\ \ \ \}}
\DoxyCodeLine{01453\ \}}
\DoxyCodeLine{01454\ }
\DoxyCodeLine{01460\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01461\ merge(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&other)\ \{}
\DoxyCodeLine{01462\ \ \ nassertv(is\_valid()\ \&\&\ other.is\_valid());}
\DoxyCodeLine{01463\ \ \ nassertv(other.\_x\_size\ ==\ \_x\_size\ \&\&\ other.\_y\_size\ ==\ \_y\_size\ \&\&\ other.\_num\_channels\ ==\ \_num\_channels);}
\DoxyCodeLine{01464\ }
\DoxyCodeLine{01465\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{01466\ \ \ \ \ \textcolor{comment}{//\ Trivial\ no-\/op.}}
\DoxyCodeLine{01467\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01468\ \ \ \}}
\DoxyCodeLine{01469\ }
\DoxyCodeLine{01470\ \ \ \textcolor{keywordtype}{size\_t}\ point\_size\ =\ \_num\_channels\ *\ \textcolor{keyword}{sizeof}(PN\_float32);}
\DoxyCodeLine{01471\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{01472\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \_x\_size;\ ++x)\ \{}
\DoxyCodeLine{01473\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(x,\ y)\ \&\&\ other.has\_point(x,\ y))\ \{}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ memcpy(\&\_table[(y\ *\ \_x\_size\ +\ x)\ *\ \_num\_channels],}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&other.\_table[(y\ *\ \_x\_size\ +\ x)\ *\ \_num\_channels],}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ point\_size);}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01478\ \ \ \ \ \}}
\DoxyCodeLine{01479\ \ \ \}}
\DoxyCodeLine{01480\ \}}
\DoxyCodeLine{01481\ }
\DoxyCodeLine{01489\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01490\ apply\_mask(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&other)\ \{}
\DoxyCodeLine{01491\ \ \ nassertv(is\_valid()\ \&\&\ other.is\_valid());}
\DoxyCodeLine{01492\ \ \ nassertv(other.\_x\_size\ ==\ \_x\_size\ \&\&\ other.\_y\_size\ ==\ \_y\_size);}
\DoxyCodeLine{01493\ }
\DoxyCodeLine{01494\ \ \ \textcolor{keywordflow}{if}\ (!other.\_has\_no\_data\_value\ ||\ !\_has\_no\_data\_value)\ \{}
\DoxyCodeLine{01495\ \ \ \ \ \textcolor{comment}{//\ Trivial\ no-\/op.}}
\DoxyCodeLine{01496\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01497\ \ \ \}}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01500\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!other.has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ set\_point4(xi,\ yi,\ \_no\_data\_value);}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01504\ \ \ \ \ \}}
\DoxyCodeLine{01505\ \ \ \}}
\DoxyCodeLine{01506\ \}}
\DoxyCodeLine{01507\ }
\DoxyCodeLine{01512\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01513\ copy\_channel(\textcolor{keywordtype}{int}\ to\_channel,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&other,\ \textcolor{keywordtype}{int}\ from\_channel)\ \{}
\DoxyCodeLine{01514\ \ \ nassertv(is\_valid()\ \&\&\ other.is\_valid());}
\DoxyCodeLine{01515\ \ \ nassertv(other.\_x\_size\ ==\ \_x\_size\ \&\&\ other.\_y\_size\ ==\ \_y\_size);}
\DoxyCodeLine{01516\ \ \ nassertv(to\_channel\ >=\ 0\ \&\&\ to\_channel\ <\ get\_num\_channels()\ \&\&}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ from\_channel\ >=\ 0\ \&\&\ from\_channel\ <\ other.get\_num\_channels());}
\DoxyCodeLine{01518\ }
\DoxyCodeLine{01519\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01520\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01521\ \ \ \ \ \ \ set\_channel(xi,\ yi,\ to\_channel,\ other.get\_channel(xi,\ yi,\ from\_channel));}
\DoxyCodeLine{01522\ \ \ \ \ \}}
\DoxyCodeLine{01523\ \ \ \}}
\DoxyCodeLine{01524\ \}}
\DoxyCodeLine{01525\ }
\DoxyCodeLine{01530\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01531\ copy\_channel\_masked(\textcolor{keywordtype}{int}\ to\_channel,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&other,\ \textcolor{keywordtype}{int}\ from\_channel)\ \{}
\DoxyCodeLine{01532\ \ \ nassertv(is\_valid()\ \&\&\ other.is\_valid());}
\DoxyCodeLine{01533\ \ \ nassertv(other.\_x\_size\ ==\ \_x\_size\ \&\&\ other.\_y\_size\ ==\ \_y\_size);}
\DoxyCodeLine{01534\ \ \ nassertv(to\_channel\ >=\ 0\ \&\&\ to\_channel\ <\ get\_num\_channels()\ \&\&}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \ \ \ from\_channel\ >=\ 0\ \&\&\ from\_channel\ <\ other.get\_num\_channels());}
\DoxyCodeLine{01536\ }
\DoxyCodeLine{01537\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01538\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (other.has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ set\_channel(xi,\ yi,\ to\_channel,\ other.get\_channel(xi,\ yi,\ from\_channel));}
\DoxyCodeLine{01541\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01542\ \ \ \ \ \}}
\DoxyCodeLine{01543\ \ \ \}}
\DoxyCodeLine{01544\ \}}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01550\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01551\ apply\_crop(\textcolor{keywordtype}{int}\ x\_begin,\ \textcolor{keywordtype}{int}\ x\_end,\ \textcolor{keywordtype}{int}\ y\_begin,\ \textcolor{keywordtype}{int}\ y\_end)\ \{}
\DoxyCodeLine{01552\ \ \ nassertv(x\_begin\ >=\ 0\ \&\&\ x\_begin\ <=\ x\_end\ \&\&\ x\_end\ <=\ \_x\_size);}
\DoxyCodeLine{01553\ \ \ nassertv(y\_begin\ >=\ 0\ \&\&\ y\_begin\ <=\ y\_end\ \&\&\ y\_end\ <=\ \_y\_size);}
\DoxyCodeLine{01554\ }
\DoxyCodeLine{01555\ \ \ \textcolor{keywordtype}{int}\ new\_x\_size\ =\ x\_end\ -\/\ x\_begin;}
\DoxyCodeLine{01556\ \ \ \textcolor{keywordtype}{int}\ new\_y\_size\ =\ y\_end\ -\/\ y\_begin;}
\DoxyCodeLine{01557\ \ \ Table\ new\_table;}
\DoxyCodeLine{01558\ \ \ \textcolor{keywordtype}{size\_t}\ new\_size\ =\ (size\_t)new\_x\_size\ *\ (\textcolor{keywordtype}{size\_t})new\_y\_size\ *\ (size\_t)\_num\_channels;}
\DoxyCodeLine{01559\ }
\DoxyCodeLine{01560\ \ \ \textcolor{comment}{//\ We\ allocate\ a\ little\ bit\ bigger\ to\ allow\ safe\ overflow:\ you\ can\ call}}
\DoxyCodeLine{01561\ \ \ \textcolor{comment}{//\ get\_point3()\ or\ get\_point4()\ on\ the\ last\ point\ of\ a\ 1-\/\ or\ 3-\/channel}}
\DoxyCodeLine{01562\ \ \ \textcolor{comment}{//\ image.}}
\DoxyCodeLine{01563\ \ \ new\_table.insert(new\_table.end(),\ new\_size\ +\ 4,\ (PN\_float32)0.0);}
\DoxyCodeLine{01564\ }
\DoxyCodeLine{01565\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ new\_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01566\ \ \ \ \ memcpy(\&new\_table[(yi\ *\ new\_x\_size)\ *\ \_num\_channels],}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ \ \ \ \&\_table[((yi\ +\ y\_begin)\ *\ \_x\_size\ +\ x\_begin)\ *\ \_num\_channels],}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ \ \ \ new\_x\_size\ *\ \textcolor{keyword}{sizeof}(PN\_float32)\ *\ \_num\_channels);}
\DoxyCodeLine{01569\ \ \ \}}
\DoxyCodeLine{01570\ }
\DoxyCodeLine{01571\ \ \ nassertv(new\_table.size()\ ==\ new\_size\ +\ 4);}
\DoxyCodeLine{01572\ \ \ \_table.swap(new\_table);}
\DoxyCodeLine{01573\ \ \ \_x\_size\ =\ new\_x\_size;}
\DoxyCodeLine{01574\ \ \ \_y\_size\ =\ new\_y\_size;}
\DoxyCodeLine{01575\ \}}
\DoxyCodeLine{01576\ }
\DoxyCodeLine{01581\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01582\ clear\_to\_texcoords(\textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{01583\ \ \ clear(x\_size,\ y\_size,\ 3);}
\DoxyCodeLine{01584\ }
\DoxyCodeLine{01585\ \ \ LPoint2f\ uv\_scale(1.0,\ 1.0);}
\DoxyCodeLine{01586\ \ \ \textcolor{keywordflow}{if}\ (\_x\_size\ >\ 0)\ \{}
\DoxyCodeLine{01587\ \ \ \ \ uv\_scale[0]\ =\ 1.0f\ /\ PN\_float32(\_x\_size);}
\DoxyCodeLine{01588\ \ \ \}}
\DoxyCodeLine{01589\ \ \ \textcolor{keywordflow}{if}\ (\_y\_size\ >\ 0)\ \{}
\DoxyCodeLine{01590\ \ \ \ \ uv\_scale[1]\ =\ 1.0f\ /\ PN\_float32(\_y\_size);}
\DoxyCodeLine{01591\ \ \ \}}
\DoxyCodeLine{01592\ }
\DoxyCodeLine{01593\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01594\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01595\ \ \ \ \ \ \ LPoint3f\ uv((PN\_float32(xi)\ +\ 0.5)\ *\ uv\_scale[0],}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_float32(yi)\ +\ 0.5)\ *\ uv\_scale[1],}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ 0.0f);}
\DoxyCodeLine{01598\ \ \ \ \ \ \ set\_point(xi,\ yi,\ uv);}
\DoxyCodeLine{01599\ \ \ \ \ \}}
\DoxyCodeLine{01600\ \ \ \}}
\DoxyCodeLine{01601\ \}}
\DoxyCodeLine{01602\ }
\DoxyCodeLine{01609\ \textcolor{keywordtype}{int}\ PfmFile::}
\DoxyCodeLine{01610\ pull\_spot(\textcolor{keyword}{const}\ LPoint4f\ \&delta,\ \textcolor{keywordtype}{float}\ xc,\ \textcolor{keywordtype}{float}\ yc,}
\DoxyCodeLine{01611\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ xr,\ \textcolor{keywordtype}{float}\ yr,\ \textcolor{keywordtype}{float}\ exponent)\ \{}
\DoxyCodeLine{01612\ \ \ \textcolor{keywordtype}{int}\ minx\ =\ max((\textcolor{keywordtype}{int})cceil(xc\ -\/\ xr),\ 0);}
\DoxyCodeLine{01613\ \ \ \textcolor{keywordtype}{int}\ maxx\ =\ min((\textcolor{keywordtype}{int})cfloor(xc\ +\ xr),\ \_x\_size\ -\/\ 1);}
\DoxyCodeLine{01614\ \ \ \textcolor{keywordtype}{int}\ miny\ =\ max((\textcolor{keywordtype}{int})cceil(yc\ -\/\ yr),\ 0);}
\DoxyCodeLine{01615\ \ \ \textcolor{keywordtype}{int}\ maxy\ =\ min((\textcolor{keywordtype}{int})cfloor(yc\ +\ yr),\ \_y\_size\ -\/\ 1);}
\DoxyCodeLine{01616\ }
\DoxyCodeLine{01617\ \ \ \textcolor{keywordtype}{int}\ count\ =\ 0;}
\DoxyCodeLine{01618\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ miny;\ yi\ <=\ maxy;\ ++yi)\ \{}
\DoxyCodeLine{01619\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ minx;\ xi\ <=\ maxx;\ ++xi)\ \{}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ xd\ =\ ((float)xi\ -\/\ xc)\ /\ xr;}
\DoxyCodeLine{01621\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ yd\ =\ ((float)yi\ -\/\ yc)\ /\ yr;}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ r2\ =\ xd\ *\ xd\ +\ yd\ *\ yd;}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (r2\ >=\ 1.0f)\ \{}
\DoxyCodeLine{01624\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01625\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01626\ \ \ \ \ \ \ PN\_float32\ t\ =\ (PN\_float32)cpow(1.0f\ -\/\ csqrt(r2),\ exponent);}
\DoxyCodeLine{01627\ }
\DoxyCodeLine{01628\ \ \ \ \ \ \ PN\_float32\ *f\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{01629\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ ci\ =\ 0;\ ci\ <\ \_num\_channels;\ ++ci)\ \{}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ f[ci]\ +=\ delta[ci]\ *\ t;}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01632\ \ \ \ \ \ \ ++count;}
\DoxyCodeLine{01633\ \ \ \ \ \}}
\DoxyCodeLine{01634\ \ \ \}}
\DoxyCodeLine{01635\ }
\DoxyCodeLine{01636\ \ \ \textcolor{keywordflow}{return}\ count;}
\DoxyCodeLine{01637\ \}}
\DoxyCodeLine{01638\ }
\DoxyCodeLine{01645\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{01646\ calc\_tight\_bounds(LPoint3f\ \&min\_point,\ LPoint3f\ \&max\_point)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01647\ \ \ min\_point.set(0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{01648\ \ \ max\_point.set(0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{01649\ }
\DoxyCodeLine{01650\ \ \ \textcolor{keywordtype}{bool}\ found\_any\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01651\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01652\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01656\ }
\DoxyCodeLine{01657\ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&point\ =\ get\_point(xi,\ yi);}
\DoxyCodeLine{01658\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!found\_any)\ \{}
\DoxyCodeLine{01659\ \ \ \ \ \ \ \ \ min\_point\ =\ point;}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ max\_point\ =\ point;}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ found\_any\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ min\_point.set(min(min\_point[0],\ point[0]),}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min(min\_point[1],\ point[1]),}
\DoxyCodeLine{01665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ min(min\_point[2],\ point[2]));}
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ max\_point.set(max(max\_point[0],\ point[0]),}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max(max\_point[1],\ point[1]),}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ max(max\_point[2],\ point[2]));}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01670\ \ \ \ \ \}}
\DoxyCodeLine{01671\ \ \ \}}
\DoxyCodeLine{01672\ }
\DoxyCodeLine{01673\ \ \ \textcolor{keywordflow}{return}\ found\_any;}
\DoxyCodeLine{01674\ \}}
\DoxyCodeLine{01675\ }
\DoxyCodeLine{01690\ PT(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}})\ PfmFile::}
\DoxyCodeLine{01691\ compute\_planar\_bounds(\textcolor{keyword}{const}\ LPoint2f\ \&center,\ PN\_float32\ point\_dist,\ PN\_float32\ sample\_radius,\ \textcolor{keywordtype}{bool}\ points\_only)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01692\ \ \ LPoint3f\ p0,\ p1,\ p2,\ p3;}
\DoxyCodeLine{01693\ \ \ compute\_sample\_point(p0,\ center[0]\ +\ point\_dist,\ center[1]\ -\/\ point\_dist,\ sample\_radius);}
\DoxyCodeLine{01694\ \ \ compute\_sample\_point(p1,\ center[0]\ +\ point\_dist,\ center[1]\ +\ point\_dist,\ sample\_radius);}
\DoxyCodeLine{01695\ \ \ compute\_sample\_point(p2,\ center[0]\ -\/\ point\_dist,\ center[1]\ +\ point\_dist,\ sample\_radius);}
\DoxyCodeLine{01696\ \ \ compute\_sample\_point(p3,\ center[0]\ -\/\ point\_dist,\ center[1]\ -\/\ point\_dist,\ sample\_radius);}
\DoxyCodeLine{01697\ }
\DoxyCodeLine{01698\ \ \ LPoint3f\ normal;}
\DoxyCodeLine{01699\ }
\DoxyCodeLine{01700\ \ \ normal[0]\ =\ p0[1]\ *\ p1[2]\ -\/\ p0[2]\ *\ p1[1];}
\DoxyCodeLine{01701\ \ \ normal[1]\ =\ p0[2]\ *\ p1[0]\ -\/\ p0[0]\ *\ p1[2];}
\DoxyCodeLine{01702\ \ \ normal[2]\ =\ p0[0]\ *\ p1[1]\ -\/\ p0[1]\ *\ p1[0];}
\DoxyCodeLine{01703\ }
\DoxyCodeLine{01704\ \ \ normal[0]\ +=\ p1[1]\ *\ p2[2]\ -\/\ p1[2]\ *\ p2[1];}
\DoxyCodeLine{01705\ \ \ normal[1]\ +=\ p1[2]\ *\ p2[0]\ -\/\ p1[0]\ *\ p2[2];}
\DoxyCodeLine{01706\ \ \ normal[2]\ +=\ p1[0]\ *\ p2[1]\ -\/\ p1[1]\ *\ p2[0];}
\DoxyCodeLine{01707\ }
\DoxyCodeLine{01708\ \ \ normal[0]\ +=\ p2[1]\ *\ p3[2]\ -\/\ p2[2]\ *\ p3[1];}
\DoxyCodeLine{01709\ \ \ normal[1]\ +=\ p2[2]\ *\ p3[0]\ -\/\ p2[0]\ *\ p3[2];}
\DoxyCodeLine{01710\ \ \ normal[2]\ +=\ p2[0]\ *\ p3[1]\ -\/\ p2[1]\ *\ p3[0];}
\DoxyCodeLine{01711\ }
\DoxyCodeLine{01712\ \ \ normal[0]\ +=\ p3[1]\ *\ p0[2]\ -\/\ p3[2]\ *\ p0[1];}
\DoxyCodeLine{01713\ \ \ normal[1]\ +=\ p3[2]\ *\ p0[0]\ -\/\ p3[0]\ *\ p0[2];}
\DoxyCodeLine{01714\ \ \ normal[2]\ +=\ p3[0]\ *\ p0[1]\ -\/\ p3[1]\ *\ p0[0];}
\DoxyCodeLine{01715\ }
\DoxyCodeLine{01716\ \ \ normal.normalize();}
\DoxyCodeLine{01717\ }
\DoxyCodeLine{01718\ \ \ LVector3f\ up\ =\ (p1\ -\/\ p0)\ +\ (p2\ -\/\ p3);}
\DoxyCodeLine{01719\ \ \ LPoint3f\ pcenter\ =\ ((p0\ +\ p1\ +\ p2\ +\ p3)\ *\ 0.25);}
\DoxyCodeLine{01720\ }
\DoxyCodeLine{01721\ \ \ \textcolor{comment}{//\ Compute\ the\ transform\ necessary\ to\ rotate\ all\ of\ the\ points\ into\ the\ Y\ =}}
\DoxyCodeLine{01722\ \ \ \textcolor{comment}{//\ 0\ plane.}}
\DoxyCodeLine{01723\ \ \ LMatrix4f\ rotate;}
\DoxyCodeLine{01724\ \ \ \mbox{\hyperlink{look__at__src_8cxx_a4e167e03dc5f1fd42ee705272d9a47a9}{look\_at}}(rotate,\ normal,\ up);}
\DoxyCodeLine{01725\ }
\DoxyCodeLine{01726\ \ \ LMatrix4f\ rinv;}
\DoxyCodeLine{01727\ \ \ rinv.invert\_from(rotate);}
\DoxyCodeLine{01728\ }
\DoxyCodeLine{01729\ \ \ LPoint3f\ trans\ =\ pcenter\ *\ rinv;}
\DoxyCodeLine{01730\ \ \ rinv.set\_row(3,\ -\/trans);}
\DoxyCodeLine{01731\ \ \ rotate.invert\_from(rinv);}
\DoxyCodeLine{01732\ }
\DoxyCodeLine{01733\ \ \ \textcolor{comment}{//\ Now\ determine\ the\ minmax.}}
\DoxyCodeLine{01734\ \ \ PN\_float32\ min\_x,\ min\_y,\ min\_z,\ max\_x,\ max\_y,\ max\_z;}
\DoxyCodeLine{01735\ \ \ \textcolor{keywordflow}{if}\ (points\_only)\ \{}
\DoxyCodeLine{01736\ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ points[4]\ =\ \{}
\DoxyCodeLine{01737\ \ \ \ \ \ \ p0\ *\ rinv,}
\DoxyCodeLine{01738\ \ \ \ \ \ \ p1\ *\ rinv,}
\DoxyCodeLine{01739\ \ \ \ \ \ \ p2\ *\ rinv,}
\DoxyCodeLine{01740\ \ \ \ \ \ \ p3\ *\ rinv,}
\DoxyCodeLine{01741\ \ \ \ \ \};}
\DoxyCodeLine{01742\ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&point\ =\ points[0];}
\DoxyCodeLine{01743\ \ \ \ \ min\_x\ =\ point[0];}
\DoxyCodeLine{01744\ \ \ \ \ min\_y\ =\ point[1];}
\DoxyCodeLine{01745\ \ \ \ \ min\_z\ =\ point[2];}
\DoxyCodeLine{01746\ \ \ \ \ max\_x\ =\ point[0];}
\DoxyCodeLine{01747\ \ \ \ \ max\_y\ =\ point[1];}
\DoxyCodeLine{01748\ \ \ \ \ max\_z\ =\ point[2];}
\DoxyCodeLine{01749\ }
\DoxyCodeLine{01750\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 1;\ i\ <\ 4;\ ++i)\ \{}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&point\ =\ points[i];}
\DoxyCodeLine{01752\ \ \ \ \ \ \ min\_x\ =\ min(min\_x,\ point[0]);}
\DoxyCodeLine{01753\ \ \ \ \ \ \ min\_y\ =\ min(min\_y,\ point[1]);}
\DoxyCodeLine{01754\ \ \ \ \ \ \ min\_z\ =\ min(min\_z,\ point[2]);}
\DoxyCodeLine{01755\ \ \ \ \ \ \ max\_x\ =\ max(max\_x,\ point[0]);}
\DoxyCodeLine{01756\ \ \ \ \ \ \ max\_y\ =\ max(max\_y,\ point[1]);}
\DoxyCodeLine{01757\ \ \ \ \ \ \ max\_z\ =\ max(max\_z,\ point[2]);}
\DoxyCodeLine{01758\ \ \ \ \ \}}
\DoxyCodeLine{01759\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01760\ \ \ \ \ \textcolor{keywordtype}{bool}\ got\_point\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01761\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{01762\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{01763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!has\_point(xi,\ yi))\ \{}
\DoxyCodeLine{01764\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01766\ }
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ LPoint3f\ point\ =\ get\_point(xi,\ yi)\ *\ rinv;}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!got\_point)\ \{}
\DoxyCodeLine{01769\ \ \ \ \ \ \ \ \ \ \ min\_x\ =\ point[0];}
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ \ \ min\_y\ =\ point[1];}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ min\_z\ =\ point[2];}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ max\_x\ =\ point[0];}
\DoxyCodeLine{01773\ \ \ \ \ \ \ \ \ \ \ max\_y\ =\ point[1];}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ max\_z\ =\ point[2];}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ got\_point\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01777\ \ \ \ \ \ \ \ \ \ \ min\_x\ =\ min(min\_x,\ point[0]);}
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ \ \ min\_y\ =\ min(min\_y,\ point[1]);}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ \ \ min\_z\ =\ min(min\_z,\ point[2]);}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ \ \ max\_x\ =\ max(max\_x,\ point[0]);}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ \ \ max\_y\ =\ max(max\_y,\ point[1]);}
\DoxyCodeLine{01782\ \ \ \ \ \ \ \ \ \ \ max\_z\ =\ max(max\_z,\ point[2]);}
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01784\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01785\ \ \ \ \ \}}
\DoxyCodeLine{01786\ \ \ \ \ \textcolor{keywordflow}{if}\ (!got\_point)\ \{}
\DoxyCodeLine{01787\ \ \ \ \ \ \ min\_x\ =\ 0.0f;}
\DoxyCodeLine{01788\ \ \ \ \ \ \ min\_y\ =\ 0.0f;}
\DoxyCodeLine{01789\ \ \ \ \ \ \ min\_z\ =\ 0.0f;}
\DoxyCodeLine{01790\ \ \ \ \ \ \ max\_x\ =\ 0.0f;}
\DoxyCodeLine{01791\ \ \ \ \ \ \ max\_y\ =\ 0.0f;}
\DoxyCodeLine{01792\ \ \ \ \ \ \ max\_z\ =\ 0.0f;}
\DoxyCodeLine{01793\ \ \ \ \ \}}
\DoxyCodeLine{01794\ \ \ \}}
\DoxyCodeLine{01795\ }
\DoxyCodeLine{01796\ \ \ PT(\mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}})\ bounds;}
\DoxyCodeLine{01797\ }
\DoxyCodeLine{01798\ \ \ \textcolor{comment}{//\ We\ create\ a\ BoundingHexahedron\ with\ the\ points\ in\ a\ particular\ well-\/}}
\DoxyCodeLine{01799\ \ \ \textcolor{comment}{//\ defined\ order,\ based\ on\ the\ current\ coordinate\ system.}}
\DoxyCodeLine{01800\ \ \ CoordinateSystem\ cs\ =\ get\_default\_coordinate\_system();}
\DoxyCodeLine{01801\ \ \ \textcolor{keywordflow}{switch}\ (cs)\ \{}
\DoxyCodeLine{01802\ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_right:}
\DoxyCodeLine{01803\ \ \ \ \ bounds\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}}}
\DoxyCodeLine{01804\ \ \ \ \ \ \ (LPoint3(min\_x,\ min\_y,\ min\_z),\ LPoint3(max\_x,\ min\_y,\ min\_z),}
\DoxyCodeLine{01805\ \ \ \ \ \ \ \ LPoint3(min\_x,\ max\_y,\ min\_z),\ LPoint3(max\_x,\ max\_y,\ min\_z),}
\DoxyCodeLine{01806\ \ \ \ \ \ \ \ LPoint3(min\_x,\ min\_y,\ max\_z),\ LPoint3(max\_x,\ min\_y,\ max\_z),}
\DoxyCodeLine{01807\ \ \ \ \ \ \ \ LPoint3(min\_x,\ max\_y,\ max\_z),\ LPoint3(max\_x,\ max\_y,\ max\_z));}
\DoxyCodeLine{01808\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01809\ }
\DoxyCodeLine{01810\ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_right:}
\DoxyCodeLine{01811\ \ \ \ \ bounds\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}}}
\DoxyCodeLine{01812\ \ \ \ \ \ \ (LPoint3(min\_x,\ min\_y,\ min\_z),\ LPoint3(max\_x,\ min\_y,\ min\_z),}
\DoxyCodeLine{01813\ \ \ \ \ \ \ \ LPoint3(min\_x,\ min\_y,\ max\_z),\ LPoint3(max\_x,\ min\_y,\ max\_z),}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \ LPoint3(min\_x,\ max\_y,\ min\_z),\ LPoint3(max\_x,\ max\_y,\ min\_z),}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ LPoint3(min\_x,\ max\_y,\ max\_z),\ LPoint3(max\_x,\ max\_y,\ max\_z));}
\DoxyCodeLine{01816\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01817\ }
\DoxyCodeLine{01818\ \ \ \textcolor{keywordflow}{case}\ CS\_yup\_left:}
\DoxyCodeLine{01819\ \ \ \ \ bounds\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}}}
\DoxyCodeLine{01820\ \ \ \ \ \ \ (LPoint3(max\_x,\ min\_y,\ max\_z),\ LPoint3(min\_x,\ min\_y,\ max\_z),}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ LPoint3(max\_x,\ max\_y,\ max\_z),\ LPoint3(min\_x,\ max\_y,\ max\_z),}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \ LPoint3(max\_x,\ min\_y,\ min\_z),\ LPoint3(min\_x,\ min\_y,\ min\_z),}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ LPoint3(max\_x,\ max\_y,\ min\_z),\ LPoint3(min\_x,\ max\_y,\ min\_z));}
\DoxyCodeLine{01824\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01825\ }
\DoxyCodeLine{01826\ \ \ \textcolor{keywordflow}{case}\ CS\_zup\_left:}
\DoxyCodeLine{01827\ \ \ \ \ bounds\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBoundingHexahedron}{BoundingHexahedron}}}
\DoxyCodeLine{01828\ \ \ \ \ \ \ (LPoint3(max\_x,\ max\_y,\ min\_z),\ LPoint3(min\_x,\ max\_y,\ min\_z),}
\DoxyCodeLine{01829\ \ \ \ \ \ \ \ LPoint3(max\_x,\ max\_y,\ max\_z),\ LPoint3(min\_x,\ max\_y,\ max\_z),}
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ LPoint3(max\_x,\ min\_y,\ min\_z),\ LPoint3(min\_x,\ min\_y,\ min\_z),}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \ LPoint3(max\_x,\ min\_y,\ max\_z),\ LPoint3(min\_x,\ min\_y,\ max\_z));}
\DoxyCodeLine{01832\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01833\ }
\DoxyCodeLine{01834\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01835\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}invalid\ coordinate\ system"{}});}
\DoxyCodeLine{01836\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01837\ \ \ \}}
\DoxyCodeLine{01838\ }
\DoxyCodeLine{01839\ \ \ \textcolor{comment}{//\ Rotate\ the\ bounding\ volume\ back\ into\ the\ original\ space\ of\ the\ screen.}}
\DoxyCodeLine{01840\ \ \ bounds-\/>xform(LCAST(PN\_stdfloat,\ rotate));}
\DoxyCodeLine{01841\ }
\DoxyCodeLine{01842\ \ \ \textcolor{keywordflow}{return}\ bounds;}
\DoxyCodeLine{01843\ \}}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01851\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01852\ compute\_sample\_point(LPoint3f\ \&result,}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x,\ PN\_float32\ y,\ PN\_float32\ sample\_radius)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01854\ \ \ x\ *=\ \_x\_size;}
\DoxyCodeLine{01855\ \ \ y\ *=\ \_y\_size;}
\DoxyCodeLine{01856\ \ \ PN\_float32\ xr\ =\ sample\_radius\ *\ \_x\_size;}
\DoxyCodeLine{01857\ \ \ PN\_float32\ yr\ =\ sample\_radius\ *\ \_y\_size;}
\DoxyCodeLine{01858\ }
\DoxyCodeLine{01859\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{01860\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01861\ \ \ \ \ \{}
\DoxyCodeLine{01862\ \ \ \ \ \ \ PN\_float32\ result1;}
\DoxyCodeLine{01863\ \ \ \ \ \ \ box\_filter\_region(result1,\ x\ -\/\ xr,\ y\ -\/\ yr,\ x\ +\ xr,\ y\ +\ yr);}
\DoxyCodeLine{01864\ \ \ \ \ \ \ result.set(result1,\ 0.0,\ 0.0);}
\DoxyCodeLine{01865\ \ \ \ \ \}}
\DoxyCodeLine{01866\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01867\ }
\DoxyCodeLine{01868\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{01869\ \ \ \ \ \{}
\DoxyCodeLine{01870\ \ \ \ \ \ \ LPoint2f\ result2;}
\DoxyCodeLine{01871\ \ \ \ \ \ \ box\_filter\_region(result2,\ x\ -\/\ xr,\ y\ -\/\ yr,\ x\ +\ xr,\ y\ +\ yr);}
\DoxyCodeLine{01872\ \ \ \ \ \ \ result.set(result2[0],\ result2[1],\ 0.0);}
\DoxyCodeLine{01873\ \ \ \ \ \}}
\DoxyCodeLine{01874\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01875\ }
\DoxyCodeLine{01876\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{01877\ \ \ \ \ box\_filter\_region(result,\ x\ -\/\ xr,\ y\ -\/\ yr,\ x\ +\ xr,\ y\ +\ yr);}
\DoxyCodeLine{01878\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01879\ }
\DoxyCodeLine{01880\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{01881\ \ \ \ \ \{}
\DoxyCodeLine{01882\ \ \ \ \ \ \ LPoint4f\ result4;}
\DoxyCodeLine{01883\ \ \ \ \ \ \ box\_filter\_region(result4,\ x\ -\/\ xr,\ y\ -\/\ yr,\ x\ +\ xr,\ y\ +\ yr);}
\DoxyCodeLine{01884\ \ \ \ \ \ \ result.set(result4[0],\ result4[1],\ result4[2]);}
\DoxyCodeLine{01885\ \ \ \ \ \}}
\DoxyCodeLine{01886\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01887\ }
\DoxyCodeLine{01888\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01889\ \ \ \ \ nassert\_raise(\textcolor{stringliteral}{"{}unexpected\ channel\ count"{}});}
\DoxyCodeLine{01890\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01891\ \ \ \}}
\DoxyCodeLine{01892\ \}}
\DoxyCodeLine{01893\ }
\DoxyCodeLine{01901\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01902\ copy\_sub\_image(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy,\ \textcolor{keywordtype}{int}\ xto,\ \textcolor{keywordtype}{int}\ yto,}
\DoxyCodeLine{01903\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xfrom,\ \textcolor{keywordtype}{int}\ yfrom,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{01904\ \ \ \textcolor{keywordtype}{int}\ xmin,\ ymin,\ xmax,\ ymax;}
\DoxyCodeLine{01905\ \ \ setup\_sub\_image(copy,\ xto,\ yto,\ xfrom,\ yfrom,\ x\_size,\ y\_size,}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xmin,\ ymin,\ xmax,\ ymax);}
\DoxyCodeLine{01907\ }
\DoxyCodeLine{01908\ \ \ \textcolor{keywordtype}{int}\ x,\ y;}
\DoxyCodeLine{01909\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{01910\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01911\ \ \ \ \ \{}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point1(x,\ y,\ copy.get\_point1(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom));}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01917\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01918\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01919\ \ \ \ \ \}}
\DoxyCodeLine{01920\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01921\ }
\DoxyCodeLine{01922\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{01923\ \ \ \ \ \{}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01927\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point2(x,\ y,\ copy.get\_point2(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom));}
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01931\ \ \ \ \ \}}
\DoxyCodeLine{01932\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{01935\ \ \ \ \ \{}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point(x,\ y,\ copy.get\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom));}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01943\ \ \ \ \ \}}
\DoxyCodeLine{01944\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01945\ }
\DoxyCodeLine{01946\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{01947\ \ \ \ \ \{}
\DoxyCodeLine{01948\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01949\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01951\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point4(x,\ y,\ copy.get\_point4(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom));}
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01954\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01955\ \ \ \ \ \}}
\DoxyCodeLine{01956\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01957\ \ \ \}}
\DoxyCodeLine{01958\ \}}
\DoxyCodeLine{01959\ }
\DoxyCodeLine{01964\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{01965\ add\_sub\_image(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy,\ \textcolor{keywordtype}{int}\ xto,\ \textcolor{keywordtype}{int}\ yto,}
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xfrom,\ \textcolor{keywordtype}{int}\ yfrom,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ pixel\_scale)\ \{}
\DoxyCodeLine{01968\ \ \ \textcolor{keywordtype}{int}\ xmin,\ ymin,\ xmax,\ ymax;}
\DoxyCodeLine{01969\ \ \ setup\_sub\_image(copy,\ xto,\ yto,\ xfrom,\ yfrom,\ x\_size,\ y\_size,}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xmin,\ ymin,\ xmax,\ ymax);}
\DoxyCodeLine{01971\ }
\DoxyCodeLine{01972\ \ \ \textcolor{keywordtype}{int}\ x,\ y;}
\DoxyCodeLine{01973\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{01974\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{01975\ \ \ \ \ \{}
\DoxyCodeLine{01976\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01977\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01979\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point1(x,\ y,\ get\_point1(x,\ y)\ +\ copy.get\_point1(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01983\ \ \ \ \ \}}
\DoxyCodeLine{01984\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01985\ }
\DoxyCodeLine{01986\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{01987\ \ \ \ \ \{}
\DoxyCodeLine{01988\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{01989\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point2(x,\ y,\ get\_point2(x,\ y)\ +\ copy.get\_point2(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01994\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01995\ \ \ \ \ \}}
\DoxyCodeLine{01996\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01997\ }
\DoxyCodeLine{01998\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{01999\ \ \ \ \ \{}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02001\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02003\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point3(x,\ y,\ get\_point3(x,\ y)\ +\ copy.get\_point3(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{02004\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02005\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02007\ \ \ \ \ \}}
\DoxyCodeLine{02008\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02009\ }
\DoxyCodeLine{02010\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02011\ \ \ \ \ \{}
\DoxyCodeLine{02012\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02013\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02014\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02015\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point4(x,\ y,\ get\_point4(x,\ y)\ +\ copy.get\_point4(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02017\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02018\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02019\ \ \ \ \ \}}
\DoxyCodeLine{02020\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02021\ \ \ \}}
\DoxyCodeLine{02022\ \}}
\DoxyCodeLine{02023\ }
\DoxyCodeLine{02028\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02029\ mult\_sub\_image(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy,\ \textcolor{keywordtype}{int}\ xto,\ \textcolor{keywordtype}{int}\ yto,}
\DoxyCodeLine{02030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xfrom,\ \textcolor{keywordtype}{int}\ yfrom,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{02031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ pixel\_scale)\ \{}
\DoxyCodeLine{02032\ \ \ \textcolor{keywordtype}{int}\ xmin,\ ymin,\ xmax,\ ymax;}
\DoxyCodeLine{02033\ \ \ setup\_sub\_image(copy,\ xto,\ yto,\ xfrom,\ yfrom,\ x\_size,\ y\_size,}
\DoxyCodeLine{02034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xmin,\ ymin,\ xmax,\ ymax);}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \ \textcolor{keywordtype}{int}\ x,\ y;}
\DoxyCodeLine{02037\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{02038\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{02039\ \ \ \ \ \{}
\DoxyCodeLine{02040\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02042\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point1(x,\ y,\ get\_point1(x,\ y)\ *\ (copy.get\_point1(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale));}
\DoxyCodeLine{02044\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02045\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02046\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02047\ \ \ \ \ \}}
\DoxyCodeLine{02048\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02049\ }
\DoxyCodeLine{02050\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{02051\ \ \ \ \ \{}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ \ \ \ \ modify\_point2(x,\ y).componentwise\_mult(copy.get\_point2(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02058\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02059\ \ \ \ \ \}}
\DoxyCodeLine{02060\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02061\ }
\DoxyCodeLine{02062\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{02063\ \ \ \ \ \{}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02067\ \ \ \ \ \ \ \ \ \ \ \ \ modify\_point3(x,\ y).componentwise\_mult(copy.get\_point3(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{02068\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02069\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02071\ \ \ \ \ \}}
\DoxyCodeLine{02072\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02073\ }
\DoxyCodeLine{02074\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02075\ \ \ \ \ \{}
\DoxyCodeLine{02076\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \ \ \ \ modify\_point4(x,\ y).componentwise\_mult(copy.get\_point4(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale);}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02083\ \ \ \ \ \}}
\DoxyCodeLine{02084\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02085\ \ \ \}}
\DoxyCodeLine{02086\ \}}
\DoxyCodeLine{02087\ }
\DoxyCodeLine{02093\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02094\ divide\_sub\_image(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&copy,\ \textcolor{keywordtype}{int}\ xto,\ \textcolor{keywordtype}{int}\ yto,}
\DoxyCodeLine{02095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xfrom,\ \textcolor{keywordtype}{int}\ yfrom,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{02096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ pixel\_scale)\ \{}
\DoxyCodeLine{02097\ \ \ \textcolor{keywordtype}{int}\ xmin,\ ymin,\ xmax,\ ymax;}
\DoxyCodeLine{02098\ \ \ setup\_sub\_image(copy,\ xto,\ yto,\ xfrom,\ yfrom,\ x\_size,\ y\_size,}
\DoxyCodeLine{02099\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xmin,\ ymin,\ xmax,\ ymax);}
\DoxyCodeLine{02100\ }
\DoxyCodeLine{02101\ \ \ \textcolor{keywordtype}{int}\ x,\ y;}
\DoxyCodeLine{02102\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{02103\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{02104\ \ \ \ \ \{}
\DoxyCodeLine{02105\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02106\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02107\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ val\ =\ get\_point1(x,\ y)\ /\ copy.get\_point1(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale;}
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cnan(val))\ \{}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ val\ =\ 0.0f;}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point1(x,\ y,\ val);}
\DoxyCodeLine{02113\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02116\ \ \ \ \ \}}
\DoxyCodeLine{02117\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02118\ }
\DoxyCodeLine{02119\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{02120\ \ \ \ \ \{}
\DoxyCodeLine{02121\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint2f\ p\ =\ copy.get\_point2(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale;}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint2f\ \&t\ =\ modify\_point2(x,\ y);}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ /=\ p[0];}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ /=\ p[1];}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02131\ \ \ \ \ \}}
\DoxyCodeLine{02132\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02133\ }
\DoxyCodeLine{02134\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{02135\ \ \ \ \ \{}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint3f\ p\ =\ copy.get\_point3(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale;}
\DoxyCodeLine{02140\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint3f\ \&t\ =\ modify\_point3(x,\ y);}
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ /=\ p[0];}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ /=\ p[1];}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ /=\ p[2];}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02147\ \ \ \ \ \}}
\DoxyCodeLine{02148\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02149\ }
\DoxyCodeLine{02150\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02151\ \ \ \ \ \{}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ ymin;\ y\ <\ ymax;\ y++)\ \{}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (x\ =\ xmin;\ x\ <\ xmax;\ x++)\ \{}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y)\ \&\&\ copy.has\_point(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom))\ \{}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint4f\ p\ =\ copy.get\_point4(x\ -\/\ xmin\ +\ xfrom,\ y\ -\/\ ymin\ +\ yfrom)\ *\ pixel\_scale;}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint4f\ \&t\ =\ modify\_point4(x,\ y);}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ t[0]\ /=\ p[0];}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \ \ t[1]\ /=\ p[1];}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \ \ t[2]\ /=\ p[2];}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \ \ \ \ t[3]\ /=\ p[3];}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02164\ \ \ \ \ \}}
\DoxyCodeLine{02165\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02166\ \ \ \}}
\DoxyCodeLine{02167\ \}}
\DoxyCodeLine{02168\ }
\DoxyCodeLine{02173\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02174\ operator\ *=\ (\textcolor{keywordtype}{float}\ multiplier)\ \{}
\DoxyCodeLine{02175\ \ \ nassertv(is\_valid());}
\DoxyCodeLine{02176\ }
\DoxyCodeLine{02177\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{02178\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{02179\ \ \ \ \ \{}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \_x\_size;\ ++x)\ \{}
\DoxyCodeLine{02182\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ p\ =\ get\_point1(x,\ y);}
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \ \ \ \ p\ *=\ multiplier;}
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ \ \ \ \ set\_point1(x,\ y,\ p);}
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02188\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02189\ \ \ \ \ \}}
\DoxyCodeLine{02190\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02191\ }
\DoxyCodeLine{02192\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{02193\ \ \ \ \ \{}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \_x\_size;\ ++x)\ \{}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint2f\ \&p\ =\ modify\_point2(x,\ y);}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ \ \ p\ *=\ multiplier;}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02202\ \ \ \ \ \}}
\DoxyCodeLine{02203\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02204\ }
\DoxyCodeLine{02205\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{02206\ \ \ \ \ \{}
\DoxyCodeLine{02207\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \_x\_size;\ ++x)\ \{}
\DoxyCodeLine{02209\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{02210\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint3f\ \&p\ =\ modify\_point3(x,\ y);}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \ \ \ \ p\ *=\ multiplier;}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02215\ \ \ \ \ \}}
\DoxyCodeLine{02216\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02217\ }
\DoxyCodeLine{02218\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02219\ \ \ \ \ \{}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ \_x\_size;\ ++x)\ \{}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_point(x,\ y))\ \{}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \ \ \ \ LPoint4f\ \&p\ =\ modify\_point4(x,\ y);}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \ \ p\ *=\ multiplier;}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02228\ \ \ \ \ \}}
\DoxyCodeLine{02229\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02230\ \ \ \}}
\DoxyCodeLine{02231\ \}}
\DoxyCodeLine{02232\ }
\DoxyCodeLine{02248\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02249\ indirect\_1d\_lookup(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&index\_image,\ \textcolor{keywordtype}{int}\ channel,}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pixel\_values)\ \{}
\DoxyCodeLine{02251\ \ \ clear(index\_image.get\_x\_size(),\ index\_image.get\_y\_size(),}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ pixel\_values.get\_num\_channels());}
\DoxyCodeLine{02253\ }
\DoxyCodeLine{02254\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ get\_y\_size();\ ++yi)\ \{}
\DoxyCodeLine{02255\ \ \ \ \ \textcolor{keywordflow}{switch}\ (get\_num\_channels())\ \{}
\DoxyCodeLine{02256\ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ int(index\_image.get\_channel(xi,\ yi,\ channel)\ *\ (pixel\_values.get\_x\_size()\ -\/\ 1)\ +\ 0.5);}
\DoxyCodeLine{02259\ \ \ \ \ \ \ \ \ nassertv(v\ >=\ 0\ \&\&\ v\ <\ pixel\_values.get\_x\_size());}
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ set\_point1(xi,\ yi,\ pixel\_values.get\_point1(v,\ 0));}
\DoxyCodeLine{02261\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02262\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02263\ }
\DoxyCodeLine{02264\ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{02265\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ int(index\_image.get\_channel(xi,\ yi,\ channel)\ *\ (pixel\_values.get\_x\_size()\ -\/\ 1)\ +\ 0.5);}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ nassertv(v\ >=\ 0\ \&\&\ v\ <\ pixel\_values.get\_x\_size());}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ set\_point2(xi,\ yi,\ pixel\_values.get\_point2(v,\ 0));}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02271\ }
\DoxyCodeLine{02272\ \ \ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{02273\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{02274\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ int(index\_image.get\_channel(xi,\ yi,\ channel)\ *\ (pixel\_values.get\_x\_size()\ -\/\ 1)\ +\ 0.5);}
\DoxyCodeLine{02275\ \ \ \ \ \ \ \ \ nassertv(v\ >=\ 0\ \&\&\ v\ <\ pixel\_values.get\_x\_size());}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ set\_point3(xi,\ yi,\ pixel\_values.get\_point3(v,\ 0));}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02279\ }
\DoxyCodeLine{02280\ \ \ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02281\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ get\_x\_size();\ ++xi)\ \{}
\DoxyCodeLine{02282\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ v\ =\ int(index\_image.get\_channel(xi,\ yi,\ channel)\ *\ (pixel\_values.get\_x\_size()\ -\/\ 1)\ +\ 0.5);}
\DoxyCodeLine{02283\ \ \ \ \ \ \ \ \ nassertv(v\ >=\ 0\ \&\&\ v\ <\ pixel\_values.get\_x\_size());}
\DoxyCodeLine{02284\ \ \ \ \ \ \ \ \ set\_point4(xi,\ yi,\ pixel\_values.get\_point4(v,\ 0));}
\DoxyCodeLine{02285\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02286\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02287\ \ \ \ \ \}}
\DoxyCodeLine{02288\ \ \ \}}
\DoxyCodeLine{02289\ \}}
\DoxyCodeLine{02290\ }
\DoxyCodeLine{02295\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02296\ apply\_exponent(\textcolor{keywordtype}{float}\ c0\_exponent,\ \textcolor{keywordtype}{float}\ c1\_exponent,\ \textcolor{keywordtype}{float}\ c2\_exponent,}
\DoxyCodeLine{02297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ c3\_exponent)\ \{}
\DoxyCodeLine{02298\ \ \ \textcolor{keywordflow}{switch}\ (\_num\_channels)\ \{}
\DoxyCodeLine{02299\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{02300\ \ \ \ \ \{}
\DoxyCodeLine{02301\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{02302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{02303\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *val\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)];}
\DoxyCodeLine{02304\ \ \ \ \ \ \ \ \ \ \ val[0]\ =\ cpow(val[0],\ c0\_exponent);}
\DoxyCodeLine{02305\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02306\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02307\ \ \ \ \ \}}
\DoxyCodeLine{02308\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02309\ }
\DoxyCodeLine{02310\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{02311\ \ \ \ \ \{}
\DoxyCodeLine{02312\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{02313\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{02314\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *val\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{02315\ \ \ \ \ \ \ \ \ \ \ val[0]\ =\ cpow(val[0],\ c0\_exponent);}
\DoxyCodeLine{02316\ \ \ \ \ \ \ \ \ \ \ val[1]\ =\ cpow(val[1],\ c1\_exponent);}
\DoxyCodeLine{02317\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02318\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02319\ \ \ \ \ \}}
\DoxyCodeLine{02320\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02321\ }
\DoxyCodeLine{02322\ \ \ \textcolor{keywordflow}{case}\ 3:}
\DoxyCodeLine{02323\ \ \ \ \ \{}
\DoxyCodeLine{02324\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{02325\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{02326\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *val\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ \ \ val[0]\ =\ cpow(val[0],\ c0\_exponent);}
\DoxyCodeLine{02328\ \ \ \ \ \ \ \ \ \ \ val[1]\ =\ cpow(val[1],\ c1\_exponent);}
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ \ \ val[2]\ =\ cpow(val[2],\ c2\_exponent);}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02332\ \ \ \ \ \}}
\DoxyCodeLine{02333\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02334\ }
\DoxyCodeLine{02335\ \ \ \textcolor{keywordflow}{case}\ 4:}
\DoxyCodeLine{02336\ \ \ \ \ \{}
\DoxyCodeLine{02337\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ \_y\_size;\ ++yi)\ \{}
\DoxyCodeLine{02338\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ \_x\_size;\ ++xi)\ \{}
\DoxyCodeLine{02339\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ *val\ =\ \&\_table[(yi\ *\ \_x\_size\ +\ xi)\ *\ \_num\_channels];}
\DoxyCodeLine{02340\ \ \ \ \ \ \ \ \ \ \ val[0]\ =\ cpow(val[0],\ c0\_exponent);}
\DoxyCodeLine{02341\ \ \ \ \ \ \ \ \ \ \ val[1]\ =\ cpow(val[1],\ c1\_exponent);}
\DoxyCodeLine{02342\ \ \ \ \ \ \ \ \ \ \ val[2]\ =\ cpow(val[2],\ c2\_exponent);}
\DoxyCodeLine{02343\ \ \ \ \ \ \ \ \ \ \ val[3]\ =\ cpow(val[3],\ c3\_exponent);}
\DoxyCodeLine{02344\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02345\ \ \ \ \ \ \ \}}
\DoxyCodeLine{02346\ \ \ \ \ \}}
\DoxyCodeLine{02347\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{02348\ \ \ \}}
\DoxyCodeLine{02349\ \}}
\DoxyCodeLine{02350\ }
\DoxyCodeLine{02354\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02355\ output(ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02356\ \ \ out\ <<\ \textcolor{stringliteral}{"{}floating-\/point\ image:\ "{}}\ <<\ \_x\_size\ <<\ \textcolor{stringliteral}{"{}\ by\ "{}}\ <<\ \_y\_size\ <<\ \textcolor{stringliteral}{"{}\ pixels,\ "{}}}
\DoxyCodeLine{02357\ \ \ \ \ \ \ <<\ \_num\_channels\ <<\ \textcolor{stringliteral}{"{}\ channels."{}};}
\DoxyCodeLine{02358\ \}}
\DoxyCodeLine{02359\ }
\DoxyCodeLine{02365\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02366\ box\_filter\_region(PN\_float32\ \&result,}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ PN\_float32\ y0,\ PN\_float32\ x1,\ PN\_float32\ y1)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02368\ \ \ result\ =\ 0.0;}
\DoxyCodeLine{02369\ \ \ PN\_float32\ coverage\ =\ 0.0;}
\DoxyCodeLine{02370\ }
\DoxyCodeLine{02371\ \ \ \textcolor{keywordflow}{if}\ (x1\ <\ x0\ ||\ y1\ <\ y0)\ \{}
\DoxyCodeLine{02372\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02373\ \ \ \}}
\DoxyCodeLine{02374\ \ \ nassertv(y0\ >=\ 0.0\ \&\&\ y1\ >=\ 0.0);}
\DoxyCodeLine{02375\ }
\DoxyCodeLine{02376\ \ \ \textcolor{keywordtype}{int}\ y\ =\ (int)y0;}
\DoxyCodeLine{02377\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ row}}
\DoxyCodeLine{02378\ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ (PN\_float32)(y+1)-\/y0);}
\DoxyCodeLine{02379\ }
\DoxyCodeLine{02380\ \ \ \textcolor{keywordtype}{int}\ y\_last\ =\ (int)y1;}
\DoxyCodeLine{02381\ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02382\ \ \ \ \ y++;}
\DoxyCodeLine{02383\ \ \ \ \ \textcolor{keywordflow}{while}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02384\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ row}}
\DoxyCodeLine{02385\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ 1.0);}
\DoxyCodeLine{02386\ \ \ \ \ \ \ y++;}
\DoxyCodeLine{02387\ \ \ \ \ \}}
\DoxyCodeLine{02388\ }
\DoxyCodeLine{02389\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ row}}
\DoxyCodeLine{02390\ \ \ \ \ PN\_float32\ y\_contrib\ =\ y1\ -\/\ (PN\_float32)y\_last;}
\DoxyCodeLine{02391\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02392\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ y\_contrib);}
\DoxyCodeLine{02393\ \ \ \ \ \}}
\DoxyCodeLine{02394\ \ \ \}}
\DoxyCodeLine{02395\ }
\DoxyCodeLine{02396\ \ \ \textcolor{keywordflow}{if}\ (coverage\ !=\ 0.0)\ \{}
\DoxyCodeLine{02397\ \ \ \ \ result\ /=\ coverage;}
\DoxyCodeLine{02398\ \ \ \}}
\DoxyCodeLine{02399\ \}}
\DoxyCodeLine{02400\ }
\DoxyCodeLine{02406\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02407\ box\_filter\_region(LPoint2f\ \&result,}
\DoxyCodeLine{02408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ PN\_float32\ y0,\ PN\_float32\ x1,\ PN\_float32\ y1)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02409\ \ \ result\ =\ LPoint2f::zero();}
\DoxyCodeLine{02410\ \ \ PN\_float32\ coverage\ =\ 0.0;}
\DoxyCodeLine{02411\ }
\DoxyCodeLine{02412\ \ \ \textcolor{keywordflow}{if}\ (x1\ <\ x0\ ||\ y1\ <\ y0)\ \{}
\DoxyCodeLine{02413\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02414\ \ \ \}}
\DoxyCodeLine{02415\ \ \ nassertv(y0\ >=\ 0.0\ \&\&\ y1\ >=\ 0.0);}
\DoxyCodeLine{02416\ }
\DoxyCodeLine{02417\ \ \ \textcolor{keywordtype}{int}\ y\ =\ (int)y0;}
\DoxyCodeLine{02418\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ row}}
\DoxyCodeLine{02419\ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ (PN\_float32)(y+1)-\/y0);}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \ \ \textcolor{keywordtype}{int}\ y\_last\ =\ (int)y1;}
\DoxyCodeLine{02422\ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02423\ \ \ \ \ y++;}
\DoxyCodeLine{02424\ \ \ \ \ \textcolor{keywordflow}{while}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ row}}
\DoxyCodeLine{02426\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ 1.0);}
\DoxyCodeLine{02427\ \ \ \ \ \ \ y++;}
\DoxyCodeLine{02428\ \ \ \ \ \}}
\DoxyCodeLine{02429\ }
\DoxyCodeLine{02430\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ row}}
\DoxyCodeLine{02431\ \ \ \ \ PN\_float32\ y\_contrib\ =\ y1\ -\/\ (PN\_float32)y\_last;}
\DoxyCodeLine{02432\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02433\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ y\_contrib);}
\DoxyCodeLine{02434\ \ \ \ \ \}}
\DoxyCodeLine{02435\ \ \ \}}
\DoxyCodeLine{02436\ }
\DoxyCodeLine{02437\ \ \ \textcolor{keywordflow}{if}\ (coverage\ !=\ 0.0)\ \{}
\DoxyCodeLine{02438\ \ \ \ \ result\ /=\ coverage;}
\DoxyCodeLine{02439\ \ \ \}}
\DoxyCodeLine{02440\ \}}
\DoxyCodeLine{02441\ }
\DoxyCodeLine{02447\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02448\ box\_filter\_region(LPoint3f\ \&result,}
\DoxyCodeLine{02449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ PN\_float32\ y0,\ PN\_float32\ x1,\ PN\_float32\ y1)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02450\ \ \ result\ =\ LPoint3f::zero();}
\DoxyCodeLine{02451\ \ \ PN\_float32\ coverage\ =\ 0.0;}
\DoxyCodeLine{02452\ }
\DoxyCodeLine{02453\ \ \ \textcolor{keywordflow}{if}\ (x1\ <\ x0\ ||\ y1\ <\ y0)\ \{}
\DoxyCodeLine{02454\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02455\ \ \ \}}
\DoxyCodeLine{02456\ \ \ nassertv(y0\ >=\ 0.0\ \&\&\ y1\ >=\ 0.0);}
\DoxyCodeLine{02457\ }
\DoxyCodeLine{02458\ \ \ \textcolor{keywordtype}{int}\ y\ =\ (int)y0;}
\DoxyCodeLine{02459\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ row}}
\DoxyCodeLine{02460\ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ (PN\_float32)(y+1)-\/y0);}
\DoxyCodeLine{02461\ }
\DoxyCodeLine{02462\ \ \ \textcolor{keywordtype}{int}\ y\_last\ =\ (int)y1;}
\DoxyCodeLine{02463\ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02464\ \ \ \ \ y++;}
\DoxyCodeLine{02465\ \ \ \ \ \textcolor{keywordflow}{while}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ row}}
\DoxyCodeLine{02467\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ 1.0);}
\DoxyCodeLine{02468\ \ \ \ \ \ \ y++;}
\DoxyCodeLine{02469\ \ \ \ \ \}}
\DoxyCodeLine{02470\ }
\DoxyCodeLine{02471\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ row}}
\DoxyCodeLine{02472\ \ \ \ \ PN\_float32\ y\_contrib\ =\ y1\ -\/\ (PN\_float32)y\_last;}
\DoxyCodeLine{02473\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02474\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ y\_contrib);}
\DoxyCodeLine{02475\ \ \ \ \ \}}
\DoxyCodeLine{02476\ \ \ \}}
\DoxyCodeLine{02477\ }
\DoxyCodeLine{02478\ \ \ \textcolor{keywordflow}{if}\ (coverage\ !=\ 0.0)\ \{}
\DoxyCodeLine{02479\ \ \ \ \ result\ /=\ coverage;}
\DoxyCodeLine{02480\ \ \ \}}
\DoxyCodeLine{02481\ \}}
\DoxyCodeLine{02482\ }
\DoxyCodeLine{02488\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02489\ box\_filter\_region(LPoint4f\ \&result,}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ PN\_float32\ y0,\ PN\_float32\ x1,\ PN\_float32\ y1)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02491\ \ \ result\ =\ LPoint4f::zero();}
\DoxyCodeLine{02492\ \ \ PN\_float32\ coverage\ =\ 0.0;}
\DoxyCodeLine{02493\ }
\DoxyCodeLine{02494\ \ \ \textcolor{keywordflow}{if}\ (x1\ <\ x0\ ||\ y1\ <\ y0)\ \{}
\DoxyCodeLine{02495\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02496\ \ \ \}}
\DoxyCodeLine{02497\ \ \ nassertv(y0\ >=\ 0.0\ \&\&\ y1\ >=\ 0.0);}
\DoxyCodeLine{02498\ }
\DoxyCodeLine{02499\ \ \ \textcolor{keywordtype}{int}\ y\ =\ (int)y0;}
\DoxyCodeLine{02500\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ row}}
\DoxyCodeLine{02501\ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ (PN\_float32)(y+1)-\/y0);}
\DoxyCodeLine{02502\ }
\DoxyCodeLine{02503\ \ \ \textcolor{keywordtype}{int}\ y\_last\ =\ (int)y1;}
\DoxyCodeLine{02504\ \ \ \textcolor{keywordflow}{if}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02505\ \ \ \ \ y++;}
\DoxyCodeLine{02506\ \ \ \ \ \textcolor{keywordflow}{while}\ (y\ <\ y\_last)\ \{}
\DoxyCodeLine{02507\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ row}}
\DoxyCodeLine{02508\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ 1.0);}
\DoxyCodeLine{02509\ \ \ \ \ \ \ y++;}
\DoxyCodeLine{02510\ \ \ \ \ \}}
\DoxyCodeLine{02511\ }
\DoxyCodeLine{02512\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ row}}
\DoxyCodeLine{02513\ \ \ \ \ PN\_float32\ y\_contrib\ =\ y1\ -\/\ (PN\_float32)y\_last;}
\DoxyCodeLine{02514\ \ \ \ \ \textcolor{keywordflow}{if}\ (y\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02515\ \ \ \ \ \ \ box\_filter\_line(result,\ coverage,\ x0,\ y,\ x1,\ y\_contrib);}
\DoxyCodeLine{02516\ \ \ \ \ \}}
\DoxyCodeLine{02517\ \ \ \}}
\DoxyCodeLine{02518\ }
\DoxyCodeLine{02519\ \ \ \textcolor{keywordflow}{if}\ (coverage\ !=\ 0.0)\ \{}
\DoxyCodeLine{02520\ \ \ \ \ result\ /=\ coverage;}
\DoxyCodeLine{02521\ \ \ \}}
\DoxyCodeLine{02522\ \}}
\DoxyCodeLine{02523\ }
\DoxyCodeLine{02527\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02528\ box\_filter\_line(PN\_float32\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x1,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02530\ \ \ \textcolor{keywordtype}{int}\ x\ =\ (int)x0;}
\DoxyCodeLine{02531\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ xel}}
\DoxyCodeLine{02532\ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ (PN\_float32)(x+1)-\/x0,\ y\_contrib);}
\DoxyCodeLine{02533\ }
\DoxyCodeLine{02534\ \ \ \textcolor{keywordtype}{int}\ x\_last\ =\ (int)x1;}
\DoxyCodeLine{02535\ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02536\ \ \ \ \ x++;}
\DoxyCodeLine{02537\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02538\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ xel}}
\DoxyCodeLine{02539\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ 1.0,\ y\_contrib);}
\DoxyCodeLine{02540\ \ \ \ \ \ \ x++;}
\DoxyCodeLine{02541\ \ \ \ \ \}}
\DoxyCodeLine{02542\ }
\DoxyCodeLine{02543\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ xel}}
\DoxyCodeLine{02544\ \ \ \ \ PN\_float32\ x\_contrib\ =\ x1\ -\/\ (PN\_float32)x\_last;}
\DoxyCodeLine{02545\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02546\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ x\_contrib,\ y\_contrib);}
\DoxyCodeLine{02547\ \ \ \ \ \}}
\DoxyCodeLine{02548\ \ \ \}}
\DoxyCodeLine{02549\ \}}
\DoxyCodeLine{02550\ }
\DoxyCodeLine{02554\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02555\ box\_filter\_line(LPoint2f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x1,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02557\ \ \ \textcolor{keywordtype}{int}\ x\ =\ (int)x0;}
\DoxyCodeLine{02558\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ xel}}
\DoxyCodeLine{02559\ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ (PN\_float32)(x+1)-\/x0,\ y\_contrib);}
\DoxyCodeLine{02560\ }
\DoxyCodeLine{02561\ \ \ \textcolor{keywordtype}{int}\ x\_last\ =\ (int)x1;}
\DoxyCodeLine{02562\ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02563\ \ \ \ \ x++;}
\DoxyCodeLine{02564\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ xel}}
\DoxyCodeLine{02566\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ 1.0,\ y\_contrib);}
\DoxyCodeLine{02567\ \ \ \ \ \ \ x++;}
\DoxyCodeLine{02568\ \ \ \ \ \}}
\DoxyCodeLine{02569\ }
\DoxyCodeLine{02570\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ xel}}
\DoxyCodeLine{02571\ \ \ \ \ PN\_float32\ x\_contrib\ =\ x1\ -\/\ (PN\_float32)x\_last;}
\DoxyCodeLine{02572\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02573\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ x\_contrib,\ y\_contrib);}
\DoxyCodeLine{02574\ \ \ \ \ \}}
\DoxyCodeLine{02575\ \ \ \}}
\DoxyCodeLine{02576\ \}}
\DoxyCodeLine{02577\ }
\DoxyCodeLine{02581\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02582\ box\_filter\_line(LPoint3f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x1,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02584\ \ \ \textcolor{keywordtype}{int}\ x\ =\ (int)x0;}
\DoxyCodeLine{02585\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ xel}}
\DoxyCodeLine{02586\ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ (PN\_float32)(x+1)-\/x0,\ y\_contrib);}
\DoxyCodeLine{02587\ }
\DoxyCodeLine{02588\ \ \ \textcolor{keywordtype}{int}\ x\_last\ =\ (int)x1;}
\DoxyCodeLine{02589\ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02590\ \ \ \ \ x++;}
\DoxyCodeLine{02591\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02592\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ xel}}
\DoxyCodeLine{02593\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ 1.0,\ y\_contrib);}
\DoxyCodeLine{02594\ \ \ \ \ \ \ x++;}
\DoxyCodeLine{02595\ \ \ \ \ \}}
\DoxyCodeLine{02596\ }
\DoxyCodeLine{02597\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ xel}}
\DoxyCodeLine{02598\ \ \ \ \ PN\_float32\ x\_contrib\ =\ x1\ -\/\ (PN\_float32)x\_last;}
\DoxyCodeLine{02599\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02600\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ x\_contrib,\ y\_contrib);}
\DoxyCodeLine{02601\ \ \ \ \ \}}
\DoxyCodeLine{02602\ \ \ \}}
\DoxyCodeLine{02603\ \}}
\DoxyCodeLine{02604\ }
\DoxyCodeLine{02608\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02609\ box\_filter\_line(LPoint4f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PN\_float32\ x0,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x1,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02611\ \ \ \textcolor{keywordtype}{int}\ x\ =\ (int)x0;}
\DoxyCodeLine{02612\ \ \ \textcolor{comment}{//\ Get\ the\ first\ (partial)\ xel}}
\DoxyCodeLine{02613\ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ (PN\_float32)(x+1)-\/x0,\ y\_contrib);}
\DoxyCodeLine{02614\ }
\DoxyCodeLine{02615\ \ \ \textcolor{keywordtype}{int}\ x\_last\ =\ (int)x1;}
\DoxyCodeLine{02616\ \ \ \textcolor{keywordflow}{if}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02617\ \ \ \ \ x++;}
\DoxyCodeLine{02618\ \ \ \ \ \textcolor{keywordflow}{while}\ (x\ <\ x\_last)\ \{}
\DoxyCodeLine{02619\ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ each\ consecutive\ (complete)\ xel}}
\DoxyCodeLine{02620\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ 1.0,\ y\_contrib);}
\DoxyCodeLine{02621\ \ \ \ \ \ \ x++;}
\DoxyCodeLine{02622\ \ \ \ \ \}}
\DoxyCodeLine{02623\ }
\DoxyCodeLine{02624\ \ \ \ \ \textcolor{comment}{//\ Get\ the\ final\ (partial)\ xel}}
\DoxyCodeLine{02625\ \ \ \ \ PN\_float32\ x\_contrib\ =\ x1\ -\/\ (PN\_float32)x\_last;}
\DoxyCodeLine{02626\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\_contrib\ >\ 0.0001)\ \{}
\DoxyCodeLine{02627\ \ \ \ \ \ \ box\_filter\_point(result,\ coverage,\ x,\ y,\ x\_contrib,\ y\_contrib);}
\DoxyCodeLine{02628\ \ \ \ \ \}}
\DoxyCodeLine{02629\ \ \ \}}
\DoxyCodeLine{02630\ \}}
\DoxyCodeLine{02631\ }
\DoxyCodeLine{02635\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02636\ box\_filter\_point(PN\_float32\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x\_contrib,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02638\ \ \ \textcolor{keywordflow}{if}\ (!has\_point(x,\ y))\ \{}
\DoxyCodeLine{02639\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02640\ \ \ \}}
\DoxyCodeLine{02641\ \ \ PN\_float32\ point\ =\ get\_point1(x,\ y);}
\DoxyCodeLine{02642\ }
\DoxyCodeLine{02643\ \ \ PN\_float32\ contrib\ =\ x\_contrib\ *\ y\_contrib;}
\DoxyCodeLine{02644\ \ \ result\ +=\ point\ *\ contrib;}
\DoxyCodeLine{02645\ \ \ coverage\ +=\ contrib;}
\DoxyCodeLine{02646\ \}}
\DoxyCodeLine{02647\ }
\DoxyCodeLine{02651\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02652\ box\_filter\_point(LPoint2f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x\_contrib,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02654\ \ \ \textcolor{keywordflow}{if}\ (!has\_point(x,\ y))\ \{}
\DoxyCodeLine{02655\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02656\ \ \ \}}
\DoxyCodeLine{02657\ \ \ \textcolor{keyword}{const}\ LPoint2f\ \&point\ =\ get\_point2(x,\ y);}
\DoxyCodeLine{02658\ }
\DoxyCodeLine{02659\ \ \ PN\_float32\ contrib\ =\ x\_contrib\ *\ y\_contrib;}
\DoxyCodeLine{02660\ \ \ result\ +=\ point\ *\ contrib;}
\DoxyCodeLine{02661\ \ \ coverage\ +=\ contrib;}
\DoxyCodeLine{02662\ \}}
\DoxyCodeLine{02663\ }
\DoxyCodeLine{02667\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02668\ box\_filter\_point(LPoint3f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x\_contrib,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02670\ \ \ \textcolor{keywordflow}{if}\ (!has\_point(x,\ y))\ \{}
\DoxyCodeLine{02671\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02672\ \ \ \}}
\DoxyCodeLine{02673\ \ \ \textcolor{keyword}{const}\ LPoint3f\ \&point\ =\ get\_point3(x,\ y);}
\DoxyCodeLine{02674\ }
\DoxyCodeLine{02675\ \ \ PN\_float32\ contrib\ =\ x\_contrib\ *\ y\_contrib;}
\DoxyCodeLine{02676\ \ \ result\ +=\ point\ *\ contrib;}
\DoxyCodeLine{02677\ \ \ coverage\ +=\ contrib;}
\DoxyCodeLine{02678\ \}}
\DoxyCodeLine{02679\ }
\DoxyCodeLine{02683\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02684\ box\_filter\_point(LPoint4f\ \&result,\ PN\_float32\ \&coverage,}
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ PN\_float32\ x\_contrib,\ PN\_float32\ y\_contrib)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02686\ \ \ \textcolor{keywordflow}{if}\ (!has\_point(x,\ y))\ \{}
\DoxyCodeLine{02687\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02688\ \ \ \}}
\DoxyCodeLine{02689\ \ \ \textcolor{keyword}{const}\ LPoint4f\ \&point\ =\ get\_point4(x,\ y);}
\DoxyCodeLine{02690\ }
\DoxyCodeLine{02691\ \ \ PN\_float32\ contrib\ =\ x\_contrib\ *\ y\_contrib;}
\DoxyCodeLine{02692\ \ \ result\ +=\ point\ *\ contrib;}
\DoxyCodeLine{02693\ \ \ coverage\ +=\ contrib;}
\DoxyCodeLine{02694\ \}}
\DoxyCodeLine{02695\ }
\DoxyCodeLine{02700\ \textcolor{keywordtype}{void}\ PfmFile::}
\DoxyCodeLine{02701\ fill\_mini\_grid(MiniGridCell\ *mini\_grid,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size,}
\DoxyCodeLine{02702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ xi,\ \textcolor{keywordtype}{int}\ yi,\ \textcolor{keywordtype}{int}\ dist,\ \textcolor{keywordtype}{int}\ sxi,\ \textcolor{keywordtype}{int}\ syi)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{02703\ \ \ \textcolor{keywordflow}{if}\ (xi\ <\ 0\ ||\ xi\ >=\ x\_size\ ||\ yi\ <\ 0\ ||\ yi\ >=\ y\_size)\ \{}
\DoxyCodeLine{02704\ \ \ \ \ \textcolor{comment}{//\ Out\ of\ bounds.}}
\DoxyCodeLine{02705\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02706\ \ \ \}}
\DoxyCodeLine{02707\ }
\DoxyCodeLine{02708\ \ \ \textcolor{keywordtype}{int}\ gi\ =\ yi\ *\ x\_size\ +\ xi;}
\DoxyCodeLine{02709\ \ \ \textcolor{keywordflow}{if}\ (mini\_grid[gi].\_dist\ ==\ -\/1\ ||\ mini\_grid[gi].\_dist\ >\ dist)\ \{}
\DoxyCodeLine{02710\ \ \ \ \ \textcolor{comment}{//\ Here's\ an\ undefined\ value\ that\ we\ need\ to\ populate.}}
\DoxyCodeLine{02711\ \ \ \ \ mini\_grid[gi].\_dist\ =\ dist;}
\DoxyCodeLine{02712\ \ \ \ \ mini\_grid[gi].\_sxi\ =\ sxi;}
\DoxyCodeLine{02713\ \ \ \ \ mini\_grid[gi].\_syi\ =\ syi;}
\DoxyCodeLine{02714\ \ \ \ \ fill\_mini\_grid(mini\_grid,\ x\_size,\ y\_size,\ xi\ +\ 1,\ yi,\ dist\ +\ 1,\ sxi,\ syi);}
\DoxyCodeLine{02715\ \ \ \ \ fill\_mini\_grid(mini\_grid,\ x\_size,\ y\_size,\ xi\ -\/\ 1,\ yi,\ dist\ +\ 1,\ sxi,\ syi);}
\DoxyCodeLine{02716\ \ \ \ \ fill\_mini\_grid(mini\_grid,\ x\_size,\ y\_size,\ xi,\ yi\ +\ 1,\ dist\ +\ 1,\ sxi,\ syi);}
\DoxyCodeLine{02717\ \ \ \ \ fill\_mini\_grid(mini\_grid,\ x\_size,\ y\_size,\ xi,\ yi\ -\/\ 1,\ dist\ +\ 1,\ sxi,\ syi);}
\DoxyCodeLine{02718\ \ \ \}}
\DoxyCodeLine{02719\ \}}
\DoxyCodeLine{02720\ }
\DoxyCodeLine{02724\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02725\ has\_point\_noop(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02726\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02727\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02728\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02729\ \ \ \}}
\DoxyCodeLine{02730\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02731\ \}}
\DoxyCodeLine{02732\ }
\DoxyCodeLine{02737\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02738\ has\_point\_1(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02739\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02740\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02741\ \ \ \ \ \textcolor{keywordflow}{return}\ self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)]\ !=\ self-\/>\_no\_data\_value[0];}
\DoxyCodeLine{02742\ \ \ \}}
\DoxyCodeLine{02743\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02744\ \}}
\DoxyCodeLine{02745\ }
\DoxyCodeLine{02750\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02751\ has\_point\_2(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02752\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02753\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02754\ \ \ \ \ \textcolor{keywordflow}{return}\ *(LPoint2f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 2]\ !=\ *(LPoint2f\ *)\&self-\/>\_no\_data\_value;}
\DoxyCodeLine{02755\ \ \ \}}
\DoxyCodeLine{02756\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02757\ \}}
\DoxyCodeLine{02758\ }
\DoxyCodeLine{02763\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02764\ has\_point\_3(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02765\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02766\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02767\ \ \ \ \ \textcolor{keywordflow}{return}\ *(LPoint3f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 3]\ !=\ *(LPoint3f\ *)\&self-\/>\_no\_data\_value;}
\DoxyCodeLine{02768\ \ \ \}}
\DoxyCodeLine{02769\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02770\ \}}
\DoxyCodeLine{02771\ }
\DoxyCodeLine{02776\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02777\ has\_point\_4(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02778\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02779\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02780\ \ \ \ \ \textcolor{keywordflow}{return}\ *(LPoint4f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 4]\ !=\ *(LPoint4f\ *)\&self-\/>\_no\_data\_value;}
\DoxyCodeLine{02781\ \ \ \}}
\DoxyCodeLine{02782\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02783\ \}}
\DoxyCodeLine{02784\ }
\DoxyCodeLine{02789\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02790\ has\_point\_threshold\_1(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02791\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02792\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02793\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *table\ =\ \&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)];}
\DoxyCodeLine{02794\ \ \ \ \ \textcolor{keywordflow}{return}\ table[0]\ >=\ self-\/>\_no\_data\_value[0];}
\DoxyCodeLine{02795\ \ \ \}}
\DoxyCodeLine{02796\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02797\ \}}
\DoxyCodeLine{02798\ }
\DoxyCodeLine{02803\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02804\ has\_point\_threshold\_2(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02805\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02806\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02807\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *table\ =\ \&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 2];}
\DoxyCodeLine{02808\ \ \ \ \ \textcolor{keywordflow}{return}\ (table[0]\ >=\ self-\/>\_no\_data\_value[0]\ ||}
\DoxyCodeLine{02809\ \ \ \ \ \ \ \ \ \ \ \ \ table[1]\ >=\ self-\/>\_no\_data\_value[1]);}
\DoxyCodeLine{02810\ \ \ \}}
\DoxyCodeLine{02811\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02812\ \}}
\DoxyCodeLine{02813\ }
\DoxyCodeLine{02818\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02819\ has\_point\_threshold\_3(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02820\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02821\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02822\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *table\ =\ \&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 3];}
\DoxyCodeLine{02823\ \ \ \ \ \textcolor{keywordflow}{return}\ (table[0]\ >=\ self-\/>\_no\_data\_value[0]\ ||}
\DoxyCodeLine{02824\ \ \ \ \ \ \ \ \ \ \ \ \ table[1]\ >=\ self-\/>\_no\_data\_value[1]\ ||}
\DoxyCodeLine{02825\ \ \ \ \ \ \ \ \ \ \ \ \ table[2]\ >=\ self-\/>\_no\_data\_value[2]);}
\DoxyCodeLine{02826\ \ \ \}}
\DoxyCodeLine{02827\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02828\ \}}
\DoxyCodeLine{02829\ }
\DoxyCodeLine{02834\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02835\ has\_point\_threshold\_4(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02836\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02837\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02838\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{float}\ *table\ =\ \&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 4];}
\DoxyCodeLine{02839\ \ \ \ \ \textcolor{keywordflow}{return}\ (table[0]\ >=\ self-\/>\_no\_data\_value[0]\ ||}
\DoxyCodeLine{02840\ \ \ \ \ \ \ \ \ \ \ \ \ table[1]\ >=\ self-\/>\_no\_data\_value[1]\ ||}
\DoxyCodeLine{02841\ \ \ \ \ \ \ \ \ \ \ \ \ table[2]\ >=\ self-\/>\_no\_data\_value[2]\ ||}
\DoxyCodeLine{02842\ \ \ \ \ \ \ \ \ \ \ \ \ table[3]\ >=\ self-\/>\_no\_data\_value[3]);}
\DoxyCodeLine{02843\ \ \ \}}
\DoxyCodeLine{02844\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02845\ \}}
\DoxyCodeLine{02846\ }
\DoxyCodeLine{02852\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02853\ has\_point\_chan4(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02854\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02855\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02856\ \ \ \ \ \textcolor{keywordflow}{return}\ self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ 4\ +\ 3]\ >=\ 0.0;}
\DoxyCodeLine{02857\ \ \ \}}
\DoxyCodeLine{02858\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02859\ \}}
\DoxyCodeLine{02860\ }
\DoxyCodeLine{02865\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02866\ has\_point\_nan\_1(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02867\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02868\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02869\ \ \ \ \ \textcolor{keywordflow}{return}\ !cnan(self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ self-\/>\_num\_channels]);}
\DoxyCodeLine{02870\ \ \ \}}
\DoxyCodeLine{02871\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02872\ \}}
\DoxyCodeLine{02873\ }
\DoxyCodeLine{02878\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02879\ has\_point\_nan\_2(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02880\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02881\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02882\ \ \ \ \ \textcolor{keywordflow}{return}\ !((LVecBase2f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ self-\/>\_num\_channels])-\/>is\_nan();}
\DoxyCodeLine{02883\ \ \ \}}
\DoxyCodeLine{02884\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02885\ \}}
\DoxyCodeLine{02886\ }
\DoxyCodeLine{02891\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02892\ has\_point\_nan\_3(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02893\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02894\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02895\ \ \ \ \ \textcolor{keywordflow}{return}\ !((LVecBase3f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ self-\/>\_num\_channels])-\/>is\_nan();}
\DoxyCodeLine{02896\ \ \ \}}
\DoxyCodeLine{02897\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02898\ \}}
\DoxyCodeLine{02899\ }
\DoxyCodeLine{02904\ \textcolor{keywordtype}{bool}\ PfmFile::}
\DoxyCodeLine{02905\ has\_point\_nan\_4(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPfmFile}{PfmFile}}\ *self,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y)\ \{}
\DoxyCodeLine{02906\ \ \ \textcolor{keywordflow}{if}\ ((x\ >=\ 0\ \&\&\ x\ <\ self-\/>\_x\_size)\ \&\&}
\DoxyCodeLine{02907\ \ \ \ \ \ \ (y\ >=\ 0\ \&\&\ y\ <\ self-\/>\_y\_size))\ \{}
\DoxyCodeLine{02908\ \ \ \ \ \textcolor{keywordflow}{return}\ !((LVecBase4f\ *)\&self-\/>\_table[(y\ *\ self-\/>\_x\_size\ +\ x)\ *\ self-\/>\_num\_channels])-\/>is\_nan();}
\DoxyCodeLine{02909\ \ \ \}}
\DoxyCodeLine{02910\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02911\ \}}

\end{DoxyCode}
