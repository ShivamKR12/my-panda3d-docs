\doxysection{callback\+Node.\+cxx}
\hypertarget{callbackNode_8cxx_source}{}\label{callbackNode_8cxx_source}\index{panda/src/pgraphnodes/callbackNode.cxx@{panda/src/pgraphnodes/callbackNode.cxx}}
\mbox{\hyperlink{callbackNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pandabase_8h}{pandabase.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{callbackNode_8h}{callbackNode.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverser_8h}{cullTraverser.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nodeCullCallbackData_8h}{nodeCullCallbackData.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullableObject_8h}{cullableObject.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullHandler_8h}{cullHandler.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{omniBoundingVolume_8h}{omniBoundingVolume.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ CallbackNode::\_type\_handle;}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00028\ CallbackNode::}
\DoxyCodeLine{00029\ CallbackNode(\textcolor{keyword}{const}\ std::string\ \&name)\ :}
\DoxyCodeLine{00030\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(name)}
\DoxyCodeLine{00031\ \{}
\DoxyCodeLine{00032\ \ \ \mbox{\hyperlink{classPandaNode_a7d1a687dc24b5882b0da4a2908018ec3}{PandaNode::set\_cull\_callback}}();}
\DoxyCodeLine{00033\ \ \ \mbox{\hyperlink{classPandaNode_acab0226d40fa5acd75f33cfb5657833f}{PandaNode::set\_renderable}}();}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//\ Set\ up\ a\ default,\ infinite\ bounding\ volume,\ unless\ the\ user\ tells\ us}}
\DoxyCodeLine{00036\ \ \ \textcolor{comment}{//\ otherwise.\ \ Not\ sure\ if\ this\ is\ a\ great\ idea,\ because\ it\ means\ a\ naive}}
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ user\ will\ never\ set\ the\ bounding\ volume\ and\ always\ trigger\ the\ callback-\/-\/}}
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ but\ that's\ not\ altogether\ a\ bad\ default\ behavior.}}
\DoxyCodeLine{00039\ \ \ set\_internal\_bounds(\textcolor{keyword}{new}\ \mbox{\hyperlink{classOmniBoundingVolume}{OmniBoundingVolume}});}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00045\ CallbackNode::}
\DoxyCodeLine{00046\ CallbackNode(\textcolor{keyword}{const}\ \mbox{\hyperlink{classCallbackNode}{CallbackNode}}\ \&copy)\ :}
\DoxyCodeLine{00047\ \ \ \mbox{\hyperlink{classPandaNode}{PandaNode}}(copy),}
\DoxyCodeLine{00048\ \ \ \_cycler(copy.\_cycler)}
\DoxyCodeLine{00049\ \{}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00057\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *\mbox{\hyperlink{classCallbackNode_a8b5e6ada1d7e38db14d29fe711ab64ec}{CallbackNode::}}}
\DoxyCodeLine{00058\ \mbox{\hyperlink{classCallbackNode_a8b5e6ada1d7e38db14d29fe711ab64ec}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classCallbackNode}{CallbackNode}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classCallbackNode_a5ead3e0824706ed9436d7dd62c5b8e63}{CallbackNode::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classCallbackNode_a5ead3e0824706ed9436d7dd62c5b8e63}{safe\_to\_combine}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00071\ \}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00091\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classCallbackNode_aa0af5a4da2446a3764504ffe1404145e}{CallbackNode::}}}
\DoxyCodeLine{00092\ \mbox{\hyperlink{classCallbackNode_aa0af5a4da2446a3764504ffe1404145e}{cull\_callback}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00093\ \ \ \mbox{\hyperlink{classCallbackObject}{CallbackObject}}\ *cbobj\ =\ get\_cull\_callback();}
\DoxyCodeLine{00094\ \ \ \textcolor{keywordflow}{if}\ (cbobj\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00095\ \ \ \ \ \mbox{\hyperlink{classNodeCullCallbackData}{NodeCullCallbackData}}\ cbdata(trav,\ data);}
\DoxyCodeLine{00096\ \ \ \ \ cbobj-\/>\mbox{\hyperlink{classCallbackObject_a373ebcf6f5fd83bbb5f578f309b61717}{do\_callback}}(\&cbdata);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{//\ No\ further\ cull:\ the\ callback\ takes\ care\ of\ all\ of\ it.}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00100\ \ \ \}}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{comment}{//\ Recurse\ onto\ the\ node's\ children.}}
\DoxyCodeLine{00103\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00111\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCallbackNode_ac3065be916369015f18131aabc631547}{CallbackNode::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classCallbackNode_ac3065be916369015f18131aabc631547}{add\_for\_draw}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00113\ \ \ \textcolor{keywordflow}{if}\ (pgraph\_cat.is\_spam())\ \{}
\DoxyCodeLine{00114\ \ \ \ \ pgraph\_cat.spam()}
\DoxyCodeLine{00115\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Found\ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\ in\ state\ "{}}\ <<\ *data.\_state}
\DoxyCodeLine{00116\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ draw\_mask\ =\ "{}}\ <<\ data.\_draw\_mask\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \textcolor{comment}{//\ OK,\ render\ this\ node.\ \ Rendering\ this\ node\ means\ creating\ a}}
\DoxyCodeLine{00120\ \ \ \textcolor{comment}{//\ CullableObject\ for\ the\ draw\_callback,\ if\ any.\ \ We\ don't\ need\ to\ pass\ any}}
\DoxyCodeLine{00121\ \ \ \textcolor{comment}{//\ Geoms,\ however.}}
\DoxyCodeLine{00122\ \ \ \mbox{\hyperlink{classCallbackObject}{CallbackObject}}\ *cbobj\ =\ get\_draw\_callback();}
\DoxyCodeLine{00123\ \ \ \textcolor{keywordflow}{if}\ (cbobj\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{classCullableObject}{CullableObject}}\ object(\textcolor{keyword}{nullptr},\ data.\_state,}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ data.get\_internal\_transform(trav));}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordtype}{object}.set\_draw\_callback(cbobj);}
\DoxyCodeLine{00127\ \ \ \ \ trav-\/>get\_cull\_handler()-\/>\mbox{\hyperlink{classCullHandler_a35e3215f1c647c0ce091d234a9afa57c}{record\_object}}(std::move(\textcolor{keywordtype}{object}),\ trav);}
\DoxyCodeLine{00128\ \ \ \}}
\DoxyCodeLine{00129\ \}}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00136\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCallbackNode_acfa76f84b60ff3a95c98d51a9f953e07}{CallbackNode::}}}
\DoxyCodeLine{00137\ \mbox{\hyperlink{classCallbackNode_acfa76f84b60ff3a95c98d51a9f953e07}{output}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00138\ \ \ PandaNode::output(out);}
\DoxyCodeLine{00139\ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00144\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCallbackNode_a83238b6f6f57c9bfd1ba084c911d9939}{CallbackNode::}}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{classCallbackNode_a83238b6f6f57c9bfd1ba084c911d9939}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00146\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classCallbackNode_ae89f8fdc9e77d9c9e1bb5182c0a1da6e}{make\_from\_bam}});}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00153\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCallbackNode_a21bdba9603130b15aacc4b91257b2a2d}{CallbackNode::}}}
\DoxyCodeLine{00154\ \mbox{\hyperlink{classCallbackNode_a21bdba9603130b15aacc4b91257b2a2d}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00155\ \ \ \mbox{\hyperlink{classPandaNode_ae9b3055297ade9bbf4a3b4dfc77e4506}{PandaNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00156\ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a4a957fdbd6f508ee3029a41a794030cd}{write\_cdata}}(dg,\ \_cycler);}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00164\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classCallbackNode_ae89f8fdc9e77d9c9e1bb5182c0a1da6e}{CallbackNode::}}}
\DoxyCodeLine{00165\ \mbox{\hyperlink{classCallbackNode_ae89f8fdc9e77d9c9e1bb5182c0a1da6e}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{classCallbackNode}{CallbackNode}}\ *node\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classCallbackNode}{CallbackNode}}(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{00167\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00168\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00171\ \ \ node-\/>\mbox{\hyperlink{classCallbackNode_a059ccb023bdb71aa1c9d3c544a4431cb}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordflow}{return}\ node;}
\DoxyCodeLine{00174\ \}}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00180\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classCallbackNode_a059ccb023bdb71aa1c9d3c544a4431cb}{CallbackNode::}}}
\DoxyCodeLine{00181\ \mbox{\hyperlink{classCallbackNode_a059ccb023bdb71aa1c9d3c544a4431cb}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{classPandaNode_a924d7f721627231f4504db71809ad2c2}{PandaNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00183\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ae63d90cd5d2c87fe3159f6b5d6d9fe10}{read\_cdata}}(scan,\ \_cycler);}
\DoxyCodeLine{00184\ \}}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00189\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *CallbackNode::CData::}
\DoxyCodeLine{00190\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00191\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{00192\ \}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00198\ \textcolor{keywordtype}{void}\ CallbackNode::CData::}
\DoxyCodeLine{00199\ write\_datagram(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00200\ \}}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00206\ \textcolor{keywordtype}{void}\ CallbackNode::CData::}
\DoxyCodeLine{00207\ fillin(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00208\ \}}

\end{DoxyCode}
