\doxysection{bullet\+Debug\+Node.\+cxx}
\hypertarget{bulletDebugNode_8cxx_source}{}\label{bulletDebugNode_8cxx_source}\index{panda/src/bullet/bulletDebugNode.cxx@{panda/src/bullet/bulletDebugNode.cxx}}
\mbox{\hyperlink{bulletDebugNode_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletDebugNode_8h}{bulletDebugNode.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__bullet_8h}{config\_bullet.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bulletWorld_8h}{bulletWorld.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullHandler_8h}{cullHandler.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullTraverser_8h}{cullTraverser.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{cullableObject_8h}{cullableObject.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomLines_8h}{geomLines.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexData_8h}{geomVertexData.h}}"{}}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomTriangles_8h}{geomTriangles.h}}"{}}}
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexFormat_8h}{geomVertexFormat.h}}"{}}}
\DoxyCodeLine{00027\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{geomVertexWriter_8h}{geomVertexWriter.h}}"{}}}
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{omniBoundingVolume_8h}{omniBoundingVolume.h}}"{}}}
\DoxyCodeLine{00029\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatTimer_8h}{pStatTimer.h}}"{}}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ BulletDebugNode::\_type\_handle;}
\DoxyCodeLine{00032\ \mbox{\hyperlink{classPStatCollector}{PStatCollector}}\ BulletDebugNode::\_pstat\_debug(\textcolor{stringliteral}{"{}App:Bullet:DoPhysics:Debug"{}});}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00037\ BulletDebugNode::}
\DoxyCodeLine{00038\ BulletDebugNode(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *name)\ :\ \mbox{\hyperlink{classPandaNode}{PandaNode}}(name)\ \{}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \_debug\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00041\ \ \ \_debug\_world\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00042\ \ \ \_wireframe\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00043\ \ \ \_constraints\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00044\ \ \ \_bounds\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00045\ \ \ \_drawer.\_normals\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ CPT\ (\mbox{\hyperlink{classBoundingVolume}{BoundingVolume}})\ bounds\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classOmniBoundingVolume}{OmniBoundingVolume}}();}
\DoxyCodeLine{00048\ \ \ set\_bounds(bounds);}
\DoxyCodeLine{00049\ \ \ set\_final(\textcolor{keyword}{true});}
\DoxyCodeLine{00050\ \ \ set\_overall\_hidden(\textcolor{keyword}{true});}
\DoxyCodeLine{00051\ \ \ set\_renderable();}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00060\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_a44c60a0dd2cf4704c70d7004dd469224}{BulletDebugNode::}}}
\DoxyCodeLine{00061\ \mbox{\hyperlink{classBulletDebugNode_a44c60a0dd2cf4704c70d7004dd469224}{safe\_to\_flatten}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00064\ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00071\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_ad39b6409a424e178fbcc8c94a494489e}{BulletDebugNode::}}}
\DoxyCodeLine{00072\ \mbox{\hyperlink{classBulletDebugNode_ad39b6409a424e178fbcc8c94a494489e}{safe\_to\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_ad97e4b7434319da84a182abbe5e53f31}{BulletDebugNode::}}}
\DoxyCodeLine{00086\ \mbox{\hyperlink{classBulletDebugNode_ad97e4b7434319da84a182abbe5e53f31}{safe\_to\_modify\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00089\ \}}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00097\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_a1b4183f81c66805b295352bba8f41678}{BulletDebugNode::}}}
\DoxyCodeLine{00098\ \mbox{\hyperlink{classBulletDebugNode_a1b4183f81c66805b295352bba8f41678}{safe\_to\_combine}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00101\ \}}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00108\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_ac6dced0fb78b54bc4a7793f527922aed}{BulletDebugNode::}}}
\DoxyCodeLine{00109\ \mbox{\hyperlink{classBulletDebugNode_ac6dced0fb78b54bc4a7793f527922aed}{safe\_to\_combine\_children}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00112\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00118\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classBulletDebugNode_a9ce73d558b3076ceeadcc76a44006811}{BulletDebugNode::}}}
\DoxyCodeLine{00119\ \mbox{\hyperlink{classBulletDebugNode_a9ce73d558b3076ceeadcc76a44006811}{safe\_to\_flatten\_below}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00122\ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{void}\ BulletDebugNode::}
\DoxyCodeLine{00128\ draw\_mask\_changed()\ \{}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \textcolor{keywordflow}{if}\ (is\_overall\_hidden())\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \_drawer.setDebugMode(DebugDraw::DBG\_NoDebug);}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00134\ \ \ \ \ \textcolor{keywordtype}{int}\ mode\ =\ DebugDraw::DBG\_DrawText\ |}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DebugDraw::DBG\_DrawFeaturesText\ |}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ DebugDraw::DBG\_DrawContactPoints;}
\DoxyCodeLine{00137\ }
\DoxyCodeLine{00138\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_wireframe)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \ \ mode\ |=\ DebugDraw::DBG\_DrawWireframe;}
\DoxyCodeLine{00140\ \ \ \ \ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_constraints)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \ \ mode\ |=\ DebugDraw::DBG\_DrawConstraints;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ mode\ |=\ DebugDraw::DBG\_DrawConstraintLimits;}
\DoxyCodeLine{00145\ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_bounds)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ mode\ |=\ DebugDraw::DBG\_DrawAabb;}
\DoxyCodeLine{00149\ \ \ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \_drawer.setDebugMode(mode);}
\DoxyCodeLine{00152\ \ \ \}}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00160\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletDebugNode_a0812cc908f49cde637b0d1e617b0da77}{BulletDebugNode::}}}
\DoxyCodeLine{00161\ \mbox{\hyperlink{classBulletDebugNode_a0812cc908f49cde637b0d1e617b0da77}{add\_for\_draw}}(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *trav,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&data)\ \{}
\DoxyCodeLine{00162\ \ \ PT(\mbox{\hyperlink{classGeom}{Geom}})\ debug\_lines;}
\DoxyCodeLine{00163\ \ \ PT(\mbox{\hyperlink{classGeom}{Geom}})\ debug\_triangles;}
\DoxyCodeLine{00164\ }
\DoxyCodeLine{00165\ \ \ \{}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{classLightMutexHolder}{LightMutexHolder}}\ holder(BulletWorld::get\_global\_lock());}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_debug\_world\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00169\ \ \ \ \ \}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_debug\_stale)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ nassertv(\_debug\_world\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimer}{PStatTimer}}\ timer(\_pstat\_debug);}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{comment}{//\ Collect\ debug\ geometry\ data}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \_drawer.\_lines.clear();}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \_drawer.\_triangles.clear();}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \_debug\_world-\/>debugDrawWorld();}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \ \ \textcolor{comment}{//\ Render\ lines}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classGeomVertexData}{GeomVertexData}})\ vdata\ =}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomVertexData}{GeomVertexData}}(\textcolor{stringliteral}{"{}"{}},\ GeomVertexFormat::get\_v3c4(),\ Geom::UH\_stream);}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ vdata-\/>unclean\_set\_num\_rows(\_drawer.\_lines.size()\ *\ 2);}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ vwriter(vdata,\ InternalName::get\_vertex());}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ cwriter(vdata,\ InternalName::get\_color());}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<Line>::const\_iterator}}\ lit;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (lit\ =\ \_drawer.\_lines.begin();\ lit\ !=\ \_drawer.\_lines.end();\ lit++)\ \{}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Line\ \&line\ =\ *lit;}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ vwriter.set\_data3(line.\_p0);}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ vwriter.set\_data3(line.\_p1);}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ cwriter.set\_data4(LVecBase4(line.\_color));}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ cwriter.set\_data4(LVecBase4(line.\_color));}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}})\ prim\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomLines}{GeomLines}}(Geom::UH\_stream);}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ prim-\/>set\_shade\_model(Geom::SM\_uniform);}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ prim-\/>add\_next\_vertices(\_drawer.\_lines.size()\ *\ 2);}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ debug\_lines\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeom}{Geom}}(vdata);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ debug\_lines-\/>add\_primitive(prim);}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \_debug\_lines\ =\ debug\_lines;}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{comment}{//\ Render\ triangles}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classGeomVertexData}{GeomVertexData}})\ vdata\ =}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomVertexData}{GeomVertexData}}(\textcolor{stringliteral}{"{}"{}},\ GeomVertexFormat::get\_v3c4(),\ Geom::UH\_stream);}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ vdata-\/>unclean\_set\_num\_rows(\_drawer.\_triangles.size()\ *\ 3);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ vwriter(vdata,\ InternalName::get\_vertex());}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGeomVertexWriter}{GeomVertexWriter}}\ cwriter(vdata,\ InternalName::get\_color());}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classpvector}{pvector<Triangle>::const\_iterator}}\ tit;}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (tit\ =\ \_drawer.\_triangles.begin();\ tit\ !=\ \_drawer.\_triangles.end();\ tit++)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Triangle\ \&tri\ =\ *tit;}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ vwriter.set\_data3(tri.\_p0);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ vwriter.set\_data3(tri.\_p1);}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ vwriter.set\_data3(tri.\_p2);}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ cwriter.set\_data4(LVecBase4(tri.\_color));}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ cwriter.set\_data4(LVecBase4(tri.\_color));}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ cwriter.set\_data4(LVecBase4(tri.\_color));}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ PT(\mbox{\hyperlink{classGeomPrimitive}{GeomPrimitive}})\ prim\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeomTriangles}{GeomTriangles}}(Geom::UH\_stream);}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ prim-\/>set\_shade\_model(Geom::SM\_uniform);}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ prim-\/>add\_next\_vertices(\_drawer.\_triangles.size()\ *\ 3);}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ debug\_triangles\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classGeom}{Geom}}(vdata);}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ debug\_triangles-\/>add\_primitive(prim);}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \_debug\_triangles\ =\ debug\_triangles;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \textcolor{comment}{//\ Clear\ collected\ data.}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \_drawer.\_lines.clear();}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \_drawer.\_triangles.clear();}
\DoxyCodeLine{00241\ }
\DoxyCodeLine{00242\ \ \ \ \ \ \ \_debug\_stale\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00243\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ debug\_lines\ =\ \_debug\_lines;}
\DoxyCodeLine{00245\ \ \ \ \ \ \ debug\_triangles\ =\ \_debug\_triangles;}
\DoxyCodeLine{00246\ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \ \textcolor{comment}{//\ Record\ them\ without\ any\ state\ or\ transform.}}
\DoxyCodeLine{00250\ \ \ trav-\/>\_geoms\_pcollector.add\_level(2);}
\DoxyCodeLine{00251\ \ \ trav-\/>get\_cull\_handler()-\/>\mbox{\hyperlink{classCullHandler_a35e3215f1c647c0ce091d234a9afa57c}{record\_object}}(\mbox{\hyperlink{classCullableObject}{CullableObject}}(std::move(debug\_lines),\ RenderState::make\_empty(),\ trav-\/>get\_scene()-\/>get\_cs\_world\_transform()),\ trav);}
\DoxyCodeLine{00252\ \ \ trav-\/>get\_cull\_handler()-\/>\mbox{\hyperlink{classCullHandler_a35e3215f1c647c0ce091d234a9afa57c}{record\_object}}(\mbox{\hyperlink{classCullableObject}{CullableObject}}(std::move(debug\_triangles),\ RenderState::make\_empty(),\ trav-\/>get\_scene()-\/>get\_cs\_world\_transform()),\ trav);}
\DoxyCodeLine{00253\ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00258\ \textcolor{keywordtype}{void}\ BulletDebugNode::}
\DoxyCodeLine{00259\ do\_sync\_b2p(btDynamicsWorld\ *world)\ \{}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \_debug\_world\ =\ world;}
\DoxyCodeLine{00262\ \ \ \_debug\_stale\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00263\ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00268\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00269\ setDebugMode(\textcolor{keywordtype}{int}\ mode)\ \{}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \_mode\ =\ mode;}
\DoxyCodeLine{00272\ \}}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00277\ \textcolor{keywordtype}{int}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00278\ getDebugMode()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{return}\ \_mode;}
\DoxyCodeLine{00281\ \}}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00286\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00287\ reportErrorWarning(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *warning)\ \{}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ bullet\_cat.error()\ <<\ warning\ <<\ std::endl;}
\DoxyCodeLine{00290\ \}}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00295\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00296\ drawLine(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&from,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&to,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&\mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ PN\_stdfloat\ r\ =\ \mbox{\hyperlink{structcolor}{color}}.getX();}
\DoxyCodeLine{00299\ \ \ PN\_stdfloat\ g\ =\ \mbox{\hyperlink{structcolor}{color}}.getY();}
\DoxyCodeLine{00300\ \ \ PN\_stdfloat\ b\ =\ \mbox{\hyperlink{structcolor}{color}}.getZ();}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00302\ \ \ \textcolor{comment}{//\ Hack\ to\ get\ rid\ of\ triangle\ normals.\ \ The\ hack\ is\ based\ on\ the\ assumption}}
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{//\ that\ only\ normals\ are\ drawn\ in\ yellow.}}
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{if}\ (\_normals==\textcolor{keyword}{false}\ \&\&\ r==1.0f\ \&\&\ g==1.0f\ \&\&\ b==0.0f)\ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ Line\ line;}
\DoxyCodeLine{00307\ }
\DoxyCodeLine{00308\ \ \ line.\_p0\ =\ LVecBase3((PN\_stdfloat)from.getX(),}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)from.getY(),}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)from.getZ());}
\DoxyCodeLine{00311\ \ \ line.\_p1\ =\ LVecBase3((PN\_stdfloat)to.getX(),}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)to.getY(),}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)to.getZ());}
\DoxyCodeLine{00314\ \ \ line.\_color\ =\ UnalignedLVecBase4((PN\_stdfloat)r,}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)g,}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)b,\ 1.0f);}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \_lines.push\_back(line);}
\DoxyCodeLine{00319\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00324\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00325\ drawTriangle(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v2,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&\mbox{\hyperlink{structcolor}{color}},\ btScalar)\ \{}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ btScalar\ r\ =\ \mbox{\hyperlink{structcolor}{color}}.getX();}
\DoxyCodeLine{00328\ \ \ btScalar\ g\ =\ \mbox{\hyperlink{structcolor}{color}}.getY();}
\DoxyCodeLine{00329\ \ \ btScalar\ b\ =\ \mbox{\hyperlink{structcolor}{color}}.getZ();}
\DoxyCodeLine{00330\ }
\DoxyCodeLine{00331\ \ \ Triangle\ tri;}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ tri.\_p0\ =\ LVecBase3((PN\_stdfloat)v0.getX(),}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v0.getY(),}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v0.getZ());}
\DoxyCodeLine{00336\ }
\DoxyCodeLine{00337\ \ \ tri.\_p1\ =\ LVecBase3((PN\_stdfloat)v1.getX(),}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v1.getY(),}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v1.getZ());}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ tri.\_p2\ =\ LVecBase3((PN\_stdfloat)v2.getX(),}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v2.getY(),}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)v2.getZ());}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ tri.\_color\ =\ UnalignedLVecBase4((PN\_stdfloat)r,}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)g,}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (PN\_stdfloat)b,\ 1.0f);}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \_triangles.push\_back(tri);}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ }
\DoxyCodeLine{00352\ \ \ \textcolor{comment}{//\ Draw\ the\ triangle's\ normal}}
\DoxyCodeLine{00353\ \textcolor{comment}{/*}}
\DoxyCodeLine{00354\ \textcolor{comment}{\ \ btVector3\ x1\ =\ v1\ -\/\ v0;}}
\DoxyCodeLine{00355\ \textcolor{comment}{\ \ btVector3\ x2\ =\ v2\ -\/\ v0;}}
\DoxyCodeLine{00356\ \textcolor{comment}{\ \ btVector3\ normal\ =\ v1.cross(v2).normalize();}}
\DoxyCodeLine{00357\ \textcolor{comment}{}}
\DoxyCodeLine{00358\ \textcolor{comment}{\ \ btVector3\ from\ =\ (v0\ +\ v1\ +\ v2)\ *\ 0.3333;}}
\DoxyCodeLine{00359\ \textcolor{comment}{\ \ btVector3\ to\ =\ from\ +\ normal;}}
\DoxyCodeLine{00360\ \textcolor{comment}{\ \ drawLine(from,\ to,\ color);}}
\DoxyCodeLine{00361\ \textcolor{comment}{*/}}
\DoxyCodeLine{00362\ \}}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00367\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00368\ drawTriangle(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&v2,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&n0,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&n1,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&n2,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&\mbox{\hyperlink{structcolor}{color}},\ btScalar\ alpha)\ \{}
\DoxyCodeLine{00369\ \ \ \textcolor{keywordflow}{if}\ (bullet\_cat.is\_debug())\ \{}
\DoxyCodeLine{00370\ \ \ \ \ bullet\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}drawTriangle(2)\ -\/\ not\ yet\ implemented!"{}}\ <<\ std::endl;}
\DoxyCodeLine{00371\ \ \ \}}
\DoxyCodeLine{00372\ \}}
\DoxyCodeLine{00373\ }
\DoxyCodeLine{00377\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00378\ drawContactPoint(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&point,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&normal,\ btScalar\ distance,\ \textcolor{keywordtype}{int}\ lifetime,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&\mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ to\ =\ point\ +\ normal\ *\ distance;}
\DoxyCodeLine{00381\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&from\ =\ point;}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ drawLine(from,\ to,\ \mbox{\hyperlink{structcolor}{color}});}
\DoxyCodeLine{00384\ \}}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00389\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00390\ draw3dText(\textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&location,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *text)\ \{}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordflow}{if}\ (bullet\_cat.is\_debug())\ \{}
\DoxyCodeLine{00392\ \ \ \ \ bullet\_cat.debug()\ <<\ \textcolor{stringliteral}{"{}draw3dText\ -\/\ not\ yet\ implemented!"{}}\ <<\ std::endl;}
\DoxyCodeLine{00393\ \ \ \}}
\DoxyCodeLine{00394\ \}}
\DoxyCodeLine{00395\ }
\DoxyCodeLine{00399\ \textcolor{keywordtype}{void}\ BulletDebugNode::DebugDraw::}
\DoxyCodeLine{00400\ drawSphere(btScalar\ radius,\ \textcolor{keyword}{const}\ btTransform\ \&transform,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ \&\mbox{\hyperlink{structcolor}{color}})\ \{}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ \ \ \mbox{\hyperlink{structbtVector3}{btVector3}}\ center\ =\ transform.getOrigin();}
\DoxyCodeLine{00403\ }
\DoxyCodeLine{00404\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ xoffs\ =\ transform.getBasis()\ *\ \mbox{\hyperlink{structbtVector3}{btVector3}}(1,\ 0,\ 0);}
\DoxyCodeLine{00405\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ yoffs\ =\ transform.getBasis()\ *\ \mbox{\hyperlink{structbtVector3}{btVector3}}(0,\ 1,\ 0);}
\DoxyCodeLine{00406\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structbtVector3}{btVector3}}\ zoffs\ =\ transform.getBasis()\ *\ \mbox{\hyperlink{structbtVector3}{btVector3}}(0,\ 0,\ 1);}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ drawArc(center,\ xoffs,\ yoffs,\ radius,\ radius,\ 0,\ SIMD\_2\_PI,\ \mbox{\hyperlink{structcolor}{color}},\ \textcolor{keyword}{false},\ 10.0);}
\DoxyCodeLine{00409\ \ \ drawArc(center,\ yoffs,\ zoffs,\ radius,\ radius,\ 0,\ SIMD\_2\_PI,\ \mbox{\hyperlink{structcolor}{color}},\ \textcolor{keyword}{false},\ 10.0);}
\DoxyCodeLine{00410\ \ \ drawArc(center,\ zoffs,\ xoffs,\ radius,\ radius,\ 0,\ SIMD\_2\_PI,\ \mbox{\hyperlink{structcolor}{color}},\ \textcolor{keyword}{false},\ 10.0);}
\DoxyCodeLine{00411\ \}}
\DoxyCodeLine{00412\ }
\DoxyCodeLine{00416\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletDebugNode_a2c2528449515d33bd6bd08237d52934b}{BulletDebugNode::}}}
\DoxyCodeLine{00417\ \mbox{\hyperlink{classBulletDebugNode_a2c2528449515d33bd6bd08237d52934b}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00418\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classBulletDebugNode_a423438f501543e2a4fd46c997fac48cb}{make\_from\_bam}});}
\DoxyCodeLine{00419\ \}}
\DoxyCodeLine{00420\ }
\DoxyCodeLine{00425\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletDebugNode_a316732312bfd93053079f9a0a6a9f317}{BulletDebugNode::}}}
\DoxyCodeLine{00426\ \mbox{\hyperlink{classBulletDebugNode_a316732312bfd93053079f9a0a6a9f317}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00427\ \ \ \mbox{\hyperlink{classPandaNode_ae9b3055297ade9bbf4a3b4dfc77e4506}{PandaNode::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00428\ }
\DoxyCodeLine{00429\ \ \ dg.add\_bool(\_wireframe);}
\DoxyCodeLine{00430\ \ \ dg.add\_bool(\_constraints);}
\DoxyCodeLine{00431\ \ \ dg.add\_bool(\_bounds);}
\DoxyCodeLine{00432\ \ \ dg.add\_bool(\_drawer.\_normals);}
\DoxyCodeLine{00433\ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00440\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classBulletDebugNode_a423438f501543e2a4fd46c997fac48cb}{BulletDebugNode::}}}
\DoxyCodeLine{00441\ \mbox{\hyperlink{classBulletDebugNode_a423438f501543e2a4fd46c997fac48cb}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{classBulletDebugNode}{BulletDebugNode}}\ *param\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classBulletDebugNode}{BulletDebugNode}};}
\DoxyCodeLine{00443\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00444\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00447\ \ \ param-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{return}\ param;}
\DoxyCodeLine{00450\ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00456\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classBulletDebugNode_a298c80926978b84db383e2e5525cc73d}{BulletDebugNode::}}}
\DoxyCodeLine{00457\ \mbox{\hyperlink{classBulletDebugNode_a298c80926978b84db383e2e5525cc73d}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00458\ \ \ \mbox{\hyperlink{classPandaNode_a924d7f721627231f4504db71809ad2c2}{PandaNode::fillin}}(scan,\ manager);}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \_wireframe\ =\ scan.get\_bool();}
\DoxyCodeLine{00461\ \ \ \_constraints\ =\ scan.get\_bool();}
\DoxyCodeLine{00462\ \ \ \_bounds\ =\ scan.get\_bool();}
\DoxyCodeLine{00463\ \ \ \_drawer.\_normals\ =\ scan.get\_bool();}
\DoxyCodeLine{00464\ \}}

\end{DoxyCode}
