\doxysection{transform\+Table.\+cxx}
\hypertarget{transformTable_8cxx_source}{}\label{transformTable_8cxx_source}\index{panda/src/gobj/transformTable.cxx@{panda/src/gobj/transformTable.cxx}}
\mbox{\hyperlink{transformTable_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{transformTable_8h}{transformTable.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ TransformTable::\_type\_handle;}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00023\ TransformTable::}
\DoxyCodeLine{00024\ TransformTable()\ :}
\DoxyCodeLine{00025\ \ \ \_is\_registered(false)}
\DoxyCodeLine{00026\ \{}
\DoxyCodeLine{00027\ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ TransformTable::}
\DoxyCodeLine{00033\ TransformTable(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformTable}{TransformTable}}\ \&copy)\ :}
\DoxyCodeLine{00034\ \ \ \_is\_registered(false),}
\DoxyCodeLine{00035\ \ \ \_transforms(copy.\_transforms)}
\DoxyCodeLine{00036\ \{}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00042\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00043\ operator\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformTable}{TransformTable}}\ \&copy)\ \{}
\DoxyCodeLine{00044\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00045\ \ \ \_transforms\ =\ copy.\_transforms;}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ TransformTable::}
\DoxyCodeLine{00052\ \string~TransformTable()\ \{}
\DoxyCodeLine{00053\ \ \ \textcolor{keywordflow}{if}\ (\_is\_registered)\ \{}
\DoxyCodeLine{00054\ \ \ \ \ do\_unregister();}
\DoxyCodeLine{00055\ \ \ \}}
\DoxyCodeLine{00056\ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00061\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00062\ set\_transform(\textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *transform)\ \{}
\DoxyCodeLine{00063\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00064\ \ \ nassertv(n\ <\ \_transforms.size());}
\DoxyCodeLine{00065\ \ \ \_transforms[n]\ =\ transform;}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00076\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00077\ insert\_transform(\textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *transform)\ \{}
\DoxyCodeLine{00078\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{if}\ (n\ >\ \_transforms.size())\ \{}
\DoxyCodeLine{00080\ \ \ \ \ n\ =\ \_transforms.size();}
\DoxyCodeLine{00081\ \ \ \}}
\DoxyCodeLine{00082\ \ \ \_transforms.insert(\_transforms.begin()\ +\ n,\ transform);}
\DoxyCodeLine{00083\ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00088\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00089\ remove\_transform(\textcolor{keywordtype}{size\_t}\ n)\ \{}
\DoxyCodeLine{00090\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00091\ \ \ nassertv(n\ <\ \_transforms.size());}
\DoxyCodeLine{00092\ \ \ \_transforms.erase(\_transforms.begin()\ +\ n);}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00102\ \textcolor{keywordtype}{size\_t}\ TransformTable::}
\DoxyCodeLine{00103\ add\_transform(\textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *transform)\ \{}
\DoxyCodeLine{00104\ \ \ nassertr(!\_is\_registered,\ -\/1);}
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{size\_t}\ new\_index\ =\ \_transforms.size();}
\DoxyCodeLine{00106\ \ \ \_transforms.push\_back(transform);}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{return}\ new\_index;}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00113\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00114\ write(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_transforms.size();\ ++i)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ out\ <<\ i\ <<\ \textcolor{stringliteral}{"{}.\ "{}}\ <<\ *\_transforms[i]\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00117\ \ \ \}}
\DoxyCodeLine{00118\ \}}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00123\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00124\ do\_register()\ \{}
\DoxyCodeLine{00125\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ Transforms::iterator\ ti;}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_transforms.begin();\ ti\ !=\ \_transforms.end();\ ++ti)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ \mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *transform\ =\ (\mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *)(*ti).p();}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{bool}\ inserted\ =\ transform-\/>\_tables.insert(\textcolor{keyword}{this}).second;}
\DoxyCodeLine{00131\ \ \ \ \ nassertv(inserted);}
\DoxyCodeLine{00132\ \ \ \}}
\DoxyCodeLine{00133\ \ \ \_is\_registered\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00134\ \}}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00140\ \textcolor{keywordtype}{void}\ TransformTable::}
\DoxyCodeLine{00141\ do\_unregister()\ \{}
\DoxyCodeLine{00142\ \ \ nassertv(\_is\_registered);}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ Transforms::iterator\ ti;}
\DoxyCodeLine{00145\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_transforms.begin();\ ti\ !=\ \_transforms.end();\ ++ti)\ \{}
\DoxyCodeLine{00146\ \ \ \ \ \mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *transform\ =\ (\mbox{\hyperlink{classVertexTransform}{VertexTransform}}\ *)(*ti).p();}
\DoxyCodeLine{00147\ \ \ \ \ transform-\/>\_tables.erase(\textcolor{keyword}{this});}
\DoxyCodeLine{00148\ \ \ \}}
\DoxyCodeLine{00149\ \ \ \_is\_registered\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00150\ \}}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00155\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTransformTable_a873fd21b1ecb44bc0b8d38c9eccd9962}{TransformTable::}}}
\DoxyCodeLine{00156\ \mbox{\hyperlink{classTransformTable_a873fd21b1ecb44bc0b8d38c9eccd9962}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00157\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classTransformTable_a0b4277b79046bcc67ca1139d575e4610}{make\_from\_bam}});}
\DoxyCodeLine{00158\ \}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00164\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTransformTable_a04f5a433fa9921a9965883fa2ff75122}{TransformTable::}}}
\DoxyCodeLine{00165\ \mbox{\hyperlink{classTransformTable_a04f5a433fa9921a9965883fa2ff75122}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00166\ \ \ TypedWritableReferenceCount::write\_datagram(manager,\ dg);}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ dg.add\_uint16(\_transforms.size());}
\DoxyCodeLine{00169\ \ \ \textcolor{keywordflow}{for}\ (Transforms::const\_iterator\ ti\ =\ \_transforms.begin();}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ ti\ !=\ \_transforms.end();}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ ++ti)\ \{}
\DoxyCodeLine{00172\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(dg,\ *ti);}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a4a957fdbd6f508ee3029a41a794030cd}{write\_cdata}}(dg,\ \_cycler);}
\DoxyCodeLine{00176\ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00182\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classTransformTable_a4d96e4f319528ff44d17f7b2313ec85c}{TransformTable::}}}
\DoxyCodeLine{00183\ \mbox{\hyperlink{classTransformTable_a4d96e4f319528ff44d17f7b2313ec85c}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordtype}{int}\ pi\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{TypedWritableReferenceCount::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{00185\ }
\DoxyCodeLine{00186\ \ \ \textcolor{keywordflow}{for}\ (Transforms::iterator\ ti\ =\ \_transforms.begin();}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ ti\ !=\ \_transforms.end();}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ ++ti)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ (*ti)\ =\ DCAST(\mbox{\hyperlink{classVertexTransform}{VertexTransform}},\ p\_list[pi++]);}
\DoxyCodeLine{00190\ \ \ \}}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{return}\ pi;}
\DoxyCodeLine{00193\ \}}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00200\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classTransformTable_a0b4277b79046bcc67ca1139d575e4610}{TransformTable::}}}
\DoxyCodeLine{00201\ \mbox{\hyperlink{classTransformTable_a0b4277b79046bcc67ca1139d575e4610}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00202\ \ \ \mbox{\hyperlink{classTransformTable}{TransformTable}}\ *\textcolor{keywordtype}{object}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTransformTable}{TransformTable}};}
\DoxyCodeLine{00203\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00204\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordtype}{object}-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{return}\ object;}
\DoxyCodeLine{00210\ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00216\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTransformTable_a5bc2f9dde9eea08d4ca6a4a3cc23b5a9}{TransformTable::}}}
\DoxyCodeLine{00217\ \mbox{\hyperlink{classTransformTable_a5bc2f9dde9eea08d4ca6a4a3cc23b5a9}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00218\ \ \ \mbox{\hyperlink{classTypedWritable_a3ad6cc1cd23bc3783d83edb3302bb43c}{TypedWritableReferenceCount::fillin}}(scan,\ manager);}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \textcolor{keywordtype}{size\_t}\ num\_transforms\ =\ scan.get\_uint16();}
\DoxyCodeLine{00221\ \ \ \_transforms.reserve(num\_transforms);}
\DoxyCodeLine{00222\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_transforms;\ ++i)\ \{}
\DoxyCodeLine{00223\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);}
\DoxyCodeLine{00224\ \ \ \ \ \_transforms.push\_back(\textcolor{keyword}{nullptr});}
\DoxyCodeLine{00225\ \ \ \}}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ae63d90cd5d2c87fe3159f6b5d6d9fe10}{read\_cdata}}(scan,\ \_cycler);}
\DoxyCodeLine{00228\ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00233\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *TransformTable::CData::}
\DoxyCodeLine{00234\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00235\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{00236\ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00242\ \textcolor{keywordtype}{void}\ TransformTable::CData::}
\DoxyCodeLine{00243\ write\_datagram(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00244\ \}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00250\ \textcolor{keywordtype}{void}\ TransformTable::CData::}
\DoxyCodeLine{00251\ fillin(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00252\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{00253\ \ \ \_modified\ =\ VertexTransform::get\_next\_modified(current\_thread);}
\DoxyCodeLine{00254\ \}}

\end{DoxyCode}
