\doxysection{render\+Effect.\+cxx}
\hypertarget{renderEffect_8cxx_source}{}\label{renderEffect_8cxx_source}\index{panda/src/pgraph/renderEffect.cxx@{panda/src/pgraph/renderEffect.cxx}}
\mbox{\hyperlink{renderEffect_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{renderEffect_8h}{renderEffect.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{indent_8h}{indent.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \mbox{\hyperlink{classpset}{RenderEffect::Effects}}\ *RenderEffect::\_effects\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00020\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ RenderEffect::\_type\_handle;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00025\ RenderEffect::}
\DoxyCodeLine{00026\ RenderEffect()\ \{}
\DoxyCodeLine{00027\ \ \ \textcolor{keywordflow}{if}\ (\_effects\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//\ Make\ sure\ the\ global\ \_effects\ map\ is\ allocated.\ \ This\ only\ has\ to\ be}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{comment}{//\ done\ once.\ \ We\ could\ make\ this\ map\ static,\ but\ then\ we\ run\ into}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//\ problems\ if\ anyone\ creates\ a\ RenderState\ object\ at\ static\ init\ time;\ it}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{comment}{//\ also\ seems\ to\ cause\ problems\ when\ the\ Panda\ shared\ library\ is\ unloaded}}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{comment}{//\ at\ application\ exit\ time.}}
\DoxyCodeLine{00033\ \ \ \ \ \_effects\ =\ \textcolor{keyword}{new}\ Effects;}
\DoxyCodeLine{00034\ \ \ \}}
\DoxyCodeLine{00035\ \ \ \_saved\_entry\ =\ \_effects-\/>end();}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00042\ \mbox{\hyperlink{classRenderEffect_a5c2dcb7e46c21f71dec35f02a1d57666}{RenderEffect::}}}
\DoxyCodeLine{00043\ \mbox{\hyperlink{classRenderEffect_a5c2dcb7e46c21f71dec35f02a1d57666}{\string~RenderEffect}}()\ \{}
\DoxyCodeLine{00044\ \ \ \textcolor{keywordflow}{if}\ (\_saved\_entry\ !=\ \_effects-\/>end())\ \{}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{//\ We\ cannot\ make\ this\ assertion,\ because\ the\ RenderEffect\ has\ already}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{//\ partially\ destructed-\/-\/this\ means\ we\ cannot\ look\ up\ the\ object\ in\ the}}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{//\ map.\ \ In\ fact,\ the\ map\ is\ temporarily\ invalid\ until\ we\ finish}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ destructing,\ since\ we\ screwed\ up\ the\ ordering\ when\ we\ changed\ the}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{//\ return\ value\ of\ get\_type().\ nassertv(\_effects-\/>find(this)\ ==}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{//\ \_saved\_entry);}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{//\ Note:\ this\ isn't\ thread-\/safe,\ because\ once\ the\ derived\ class\ destructor}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{//\ exits\ and\ before\ this\ destructor\ completes,\ the\ map\ is\ invalid,\ and}}
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{comment}{//\ other\ threads\ may\ inadvertently\ attempt\ to\ read\ the\ invalid\ map.\ \ To}}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ make\ it\ thread-\/safe,\ we\ need\ to\ move\ this\ functionality\ to\ a\ separate}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{//\ method,\ that\ is\ to\ be\ called\ from\ *each*\ derived\ class's\ destructor}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{//\ (and\ then\ we\ can\ put\ the\ above\ assert\ back\ in).}}
\DoxyCodeLine{00058\ \ \ \ \ \_effects-\/>erase(\_saved\_entry);}
\DoxyCodeLine{00059\ \ \ \ \ \_saved\_entry\ =\ \_effects-\/>end();}
\DoxyCodeLine{00060\ \ \ \}}
\DoxyCodeLine{00061\ \}}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classRenderEffect_a8886e8efb3b402f6cb7800f494463b29}{RenderEffect::}}}
\DoxyCodeLine{00068\ \mbox{\hyperlink{classRenderEffect_a8886e8efb3b402f6cb7800f494463b29}{safe\_to\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ RenderEffect::}
\DoxyCodeLine{00078\ prepare\_flatten\_transform(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTransformState}{TransformState}}\ *net\_transform)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ net\_transform;}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00087\ \textcolor{keywordtype}{bool}\ RenderEffect::}
\DoxyCodeLine{00088\ safe\_to\_combine()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00089\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ CPT(\mbox{\hyperlink{classRenderEffect}{RenderEffect}})\ RenderEffect::}
\DoxyCodeLine{00096\ xform(\textcolor{keyword}{const}\ LMatrix4\ \&)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00097\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{this};}
\DoxyCodeLine{00098\ \}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00105\ \textcolor{keywordtype}{bool}\ RenderEffect::}
\DoxyCodeLine{00106\ has\_cull\_callback()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00108\ \}}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ RenderEffect::}
\DoxyCodeLine{00123\ cull\_callback(\mbox{\hyperlink{classCullTraverser}{CullTraverser}}\ *,\ \mbox{\hyperlink{classCullTraverserData}{CullTraverserData}}\ \&,}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ \&,\ CPT(\mbox{\hyperlink{classRenderState}{RenderState}})\ \&)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00125\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00132\ \textcolor{keywordtype}{bool}\ RenderEffect::}
\DoxyCodeLine{00133\ has\_adjust\_transform()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00135\ \}}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00145\ \textcolor{keywordtype}{void}\ RenderEffect::}
\DoxyCodeLine{00146\ adjust\_transform(CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ \&,\ CPT(\mbox{\hyperlink{classTransformState}{TransformState}})\ \&,}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPandaNode}{PandaNode}}\ *)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00148\ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00153\ \textcolor{keywordtype}{void}\ RenderEffect::}
\DoxyCodeLine{00154\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00155\ \ \ out\ <<\ get\_type();}
\DoxyCodeLine{00156\ \}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00161\ \textcolor{keywordtype}{void}\ RenderEffect::}
\DoxyCodeLine{00162\ write(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ indent\_level)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00163\ \ \ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}(out,\ indent\_level)\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00170\ \textcolor{keywordtype}{int}\ RenderEffect::}
\DoxyCodeLine{00171\ get\_num\_effects()\ \{}
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{if}\ (\_effects\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00174\ \ \ \}}
\DoxyCodeLine{00175\ \ \ \textcolor{keywordflow}{return}\ \_effects-\/>size();}
\DoxyCodeLine{00176\ \}}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00183\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRenderEffect_a195ee7a66857f5c9480b7f166241380b}{RenderEffect::}}}
\DoxyCodeLine{00184\ \mbox{\hyperlink{classRenderEffect_a195ee7a66857f5c9480b7f166241380b}{list\_effects}}(std::ostream\ \&out)\ \{}
\DoxyCodeLine{00185\ \ \ out\ <<\ \_effects-\/>size()\ <<\ \textcolor{stringliteral}{"{}\ effects:\(\backslash\)n"{}};}
\DoxyCodeLine{00186\ \ \ Effects::const\_iterator\ si;}
\DoxyCodeLine{00187\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_effects-\/>begin();\ si\ !=\ \_effects-\/>end();\ ++si)\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderEffect}{RenderEffect}}\ *effect\ =\ (*si);}
\DoxyCodeLine{00189\ \ \ \ \ effect-\/>write(out,\ 2);}
\DoxyCodeLine{00190\ \ \ \}}
\DoxyCodeLine{00191\ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00198\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classRenderEffect_afea2d3e9c7d3849a668c6e526bb1ae42}{RenderEffect::}}}
\DoxyCodeLine{00199\ \mbox{\hyperlink{classRenderEffect_afea2d3e9c7d3849a668c6e526bb1ae42}{validate\_effects}}()\ \{}
\DoxyCodeLine{00200\ \ \ \textcolor{keywordflow}{if}\ (\_effects-\/>empty())\ \{}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00202\ \ \ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ Effects::const\_iterator\ si\ =\ \_effects-\/>begin();}
\DoxyCodeLine{00205\ \ \ Effects::const\_iterator\ snext\ =\ si;}
\DoxyCodeLine{00206\ \ \ ++snext;}
\DoxyCodeLine{00207\ \ \ \textcolor{keywordflow}{while}\ (snext\ !=\ \_effects-\/>end())\ \{}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*si)-\/>compare\_to(*(*snext))\ >=\ 0)\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}RenderEffects\ out\ of\ order!\(\backslash\)n"{}};}
\DoxyCodeLine{00211\ \ \ \ \ \ \ (*si)-\/>write(pgraph\_cat.error(\textcolor{keyword}{false}),\ 2);}
\DoxyCodeLine{00212\ \ \ \ \ \ \ (*snext)-\/>write(pgraph\_cat.error(\textcolor{keyword}{false}),\ 2);}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00214\ \ \ \ \ \}}
\DoxyCodeLine{00215\ \ \ \ \ si\ =\ snext;}
\DoxyCodeLine{00216\ \ \ \ \ ++snext;}
\DoxyCodeLine{00217\ \ \ \}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00220\ \}}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00232\ CPT(\mbox{\hyperlink{classRenderEffect}{RenderEffect}})\ RenderEffect::}
\DoxyCodeLine{00233\ return\_new(\mbox{\hyperlink{classRenderEffect}{RenderEffect}}\ *effect)\ \{}
\DoxyCodeLine{00234\ \ \ nassertr(effect\ !=\ \textcolor{keyword}{nullptr},\ effect);}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \textcolor{comment}{//\ This\ should\ be\ a\ newly\ allocated\ pointer,\ not\ one\ that\ was\ used\ for}}
\DoxyCodeLine{00237\ \ \ \textcolor{comment}{//\ anything\ else.}}
\DoxyCodeLine{00238\ \ \ nassertr(effect-\/>\_saved\_entry\ ==\ \_effects-\/>end(),\ effect);}
\DoxyCodeLine{00239\ }
\DoxyCodeLine{00240\ \textcolor{preprocessor}{\#ifndef\ NDEBUG}}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{if}\ (paranoid\_const)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ nassertr(\mbox{\hyperlink{classRenderEffect_afea2d3e9c7d3849a668c6e526bb1ae42}{validate\_effects}}(),\ effect);}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \textcolor{comment}{//\ Save\ the\ effect\ in\ a\ local\ PointerTo\ so\ that\ it\ will\ be\ freed\ at\ the\ end}}
\DoxyCodeLine{00247\ \ \ \textcolor{comment}{//\ of\ this\ function\ if\ no\ one\ else\ uses\ it.}}
\DoxyCodeLine{00248\ \ \ CPT(\mbox{\hyperlink{classRenderEffect}{RenderEffect}})\ pt\_effect\ =\ effect;}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ std::pair<Effects::iterator,\ bool>\ result\ =\ \_effects-\/>insert(effect);}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{if}\ (result.second)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//\ The\ effect\ was\ inserted;\ save\ the\ iterator\ and\ return\ the\ input\ effect.}}
\DoxyCodeLine{00253\ \ \ \ \ effect-\/>\_saved\_entry\ =\ result.first;}
\DoxyCodeLine{00254\ \ \ \ \ \textcolor{keywordflow}{return}\ pt\_effect;}
\DoxyCodeLine{00255\ \ \ \}}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \textcolor{comment}{//\ The\ effect\ was\ not\ inserted;\ there\ must\ be\ an\ equivalent\ one\ already\ in}}
\DoxyCodeLine{00258\ \ \ \textcolor{comment}{//\ the\ set.\ \ Return\ that\ one.}}
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{return}\ *(result.first);}
\DoxyCodeLine{00260\ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00273\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classRenderEffect_a6c7da08cb465c000260da61c8eff7202}{RenderEffect::}}}
\DoxyCodeLine{00274\ \mbox{\hyperlink{classRenderEffect_a6c7da08cb465c000260da61c8eff7202}{compare\_to\_impl}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderEffect}{RenderEffect}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00275\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00276\ \}}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00282\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRenderEffect_adfcb8f46697627c2144df4aa93dfa62c}{RenderEffect::}}}
\DoxyCodeLine{00283\ \mbox{\hyperlink{classRenderEffect_adfcb8f46697627c2144df4aa93dfa62c}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00284\ \ \ TypedWritable::write\_datagram(manager,\ dg);}
\DoxyCodeLine{00285\ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00295\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classRenderEffect_aed5c741ab97790ff47ac14215776a84e}{RenderEffect::}}}
\DoxyCodeLine{00296\ \mbox{\hyperlink{classRenderEffect_aed5c741ab97790ff47ac14215776a84e}{change\_this}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *old\_ptr,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00297\ \ \ \textcolor{comment}{//\ First,\ uniquify\ the\ pointer.}}
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{classRenderEffect}{RenderEffect}}\ *effect\ =\ DCAST(\mbox{\hyperlink{classRenderEffect}{RenderEffect}},\ old\_ptr);}
\DoxyCodeLine{00299\ \ \ CPT(\mbox{\hyperlink{classRenderEffect}{RenderEffect}})\ pointer\ =\ return\_new(effect);}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \textcolor{comment}{//\ But\ now\ we\ have\ a\ problem,\ since\ we\ have\ to\ hold\ the\ reference\ count\ and}}
\DoxyCodeLine{00302\ \ \ \textcolor{comment}{//\ there's\ no\ way\ to\ return\ a\ TypedWritable\ while\ still\ holding\ the}}
\DoxyCodeLine{00303\ \ \ \textcolor{comment}{//\ reference\ count!\ \ We\ work\ around\ this\ by\ explicitly\ upping\ the\ count,\ and}}
\DoxyCodeLine{00304\ \ \ \textcolor{comment}{//\ also\ setting\ a\ finalize()\ callback\ to\ down\ it\ later.}}
\DoxyCodeLine{00305\ \ \ \textcolor{keywordflow}{if}\ (pointer\ ==\ effect)\ \{}
\DoxyCodeLine{00306\ \ \ \ \ pointer-\/>ref();}
\DoxyCodeLine{00307\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_a0c2e8dc5a794a4263139116b5b8dcb2d}{register\_finalize}}(effect);}
\DoxyCodeLine{00308\ \ \ \}}
\DoxyCodeLine{00309\ }
\DoxyCodeLine{00310\ \ \ \textcolor{comment}{//\ We\ have\ to\ cast\ the\ pointer\ back\ to\ non-\/const,\ because\ the\ bam\ reader}}
\DoxyCodeLine{00311\ \ \ \textcolor{comment}{//\ expects\ that.}}
\DoxyCodeLine{00312\ \ \ \textcolor{keywordflow}{return}\ (\mbox{\hyperlink{classRenderEffect}{RenderEffect}}\ *)pointer.p();}
\DoxyCodeLine{00313\ \}}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00320\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRenderEffect_a9297ef068793572ef93a4baa1d35b085}{RenderEffect::}}}
\DoxyCodeLine{00321\ \mbox{\hyperlink{classRenderEffect_a9297ef068793572ef93a4baa1d35b085}{finalize}}(\mbox{\hyperlink{classBamReader}{BamReader}}\ *)\ \{}
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//\ Unref\ the\ pointer\ that\ we\ explicitly\ reffed\ in\ change\_this().}}
\DoxyCodeLine{00323\ \ \ unref();}
\DoxyCodeLine{00324\ }
\DoxyCodeLine{00325\ \ \ \textcolor{comment}{//\ We\ should\ never\ get\ back\ to\ zero\ after\ unreffing\ our\ own\ count,\ because}}
\DoxyCodeLine{00326\ \ \ \textcolor{comment}{//\ we\ expect\ to\ have\ been\ stored\ in\ a\ pointer\ somewhere.\ \ If\ we\ do\ get\ to}}
\DoxyCodeLine{00327\ \ \ \textcolor{comment}{//\ zero,\ it's\ a\ memory\ leak;\ the\ way\ to\ avoid\ this\ is\ to\ call\ unref\_delete()}}
\DoxyCodeLine{00328\ \ \ \textcolor{comment}{//\ above\ instead\ of\ unref(),\ but\ this\ is\ dangerous\ to\ do\ from\ within\ a}}
\DoxyCodeLine{00329\ \ \ \textcolor{comment}{//\ virtual\ function.}}
\DoxyCodeLine{00330\ \ \ nassertv(get\_ref\_count()\ !=\ 0);}
\DoxyCodeLine{00331\ \}}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00337\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRenderEffect_a5176dd32b3b8a868bd68bf4aa77944bf}{RenderEffect::}}}
\DoxyCodeLine{00338\ \mbox{\hyperlink{classRenderEffect_a5176dd32b3b8a868bd68bf4aa77944bf}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00339\ \ \ \mbox{\hyperlink{classTypedWritable_a3ad6cc1cd23bc3783d83edb3302bb43c}{TypedWritable::fillin}}(scan,\ manager);}
\DoxyCodeLine{00340\ \}}

\end{DoxyCode}
