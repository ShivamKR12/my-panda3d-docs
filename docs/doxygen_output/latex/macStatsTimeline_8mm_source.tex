\doxysection{mac\+Stats\+Timeline.\+mm}
\hypertarget{macStatsTimeline_8mm_source}{}\label{macStatsTimeline_8mm_source}\index{pandatool/src/mac-\/stats/macStatsTimeline.mm@{pandatool/src/mac-\/stats/macStatsTimeline.mm}}
\mbox{\hyperlink{macStatsTimeline_8mm}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsTimeline_8h}{macStatsTimeline.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsMonitor_8h}{macStatsMonitor.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsLabelStack_8h}{macStatsLabelStack.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{macStatsScaleArea_8h}{macStatsScaleArea.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pStatCollectorDef_8h}{pStatCollectorDef.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{keyword}{@interface\ }\mbox{\hyperlink{interfaceMacStatsTimelineViewController}{MacStatsTimelineViewController}}\ :\ \mbox{\hyperlink{interfaceMacStatsScrollableGraphViewController}{MacStatsScrollableGraphViewController}}}
\DoxyCodeLine{00021\ \textcolor{keyword}{@end}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_width\ =\ 1000;}
\DoxyCodeLine{00024\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_height\ =\ 300;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ minimum\_timeline\_sidebar\_width\ =\ 68;}
\DoxyCodeLine{00027\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ default\_timeline\_sidebar\_width\ =\ 100;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00032\ MacStatsTimeline::}
\DoxyCodeLine{00033\ MacStatsTimeline(\mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor)\ :}
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{classPStatTimeline}{PStatTimeline}}(monitor,\ 0,\ 0),}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{classMacStatsGraph}{MacStatsGraph}}(monitor,\ [\mbox{\hyperlink{interfaceMacStatsTimelineViewController}{MacStatsTimelineViewController}}\ alloc])}
\DoxyCodeLine{00036\ \{}
\DoxyCodeLine{00037\ \ \ \textcolor{comment}{//\ Let's\ show\ the\ units\ on\ the\ guide\ bar\ labels.\ \ There's\ room.}}
\DoxyCodeLine{00038\ \ \ set\_guide\_bar\_units(get\_guide\_bar\_units()\ |\ GBU\_show\_units);}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \_window.title\ =\ \textcolor{stringliteral}{@"{}Timeline"{}};}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00043\ \ \ \ \ \_window.titleVisibility\ =\ NSWindowTitleHidden;}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ Set\ the\ initial\ size\ of\ the\ graph.}}
\DoxyCodeLine{00047\ \ \ \textcolor{keyword}{const}\ ThreadRow\ \&last\_thread\_row\ =\ \_threads.back();}
\DoxyCodeLine{00048\ \ \ \textcolor{keywordtype}{int}\ height\ =\ row\_to\_pixel(last\_thread\_row.\_row\_offset\ +\ last\_thread\_row.\_rows.size());}
\DoxyCodeLine{00049\ \ \ \textcolor{keywordflow}{if}\ (height\ <\ default\_timeline\_height)\ \{}
\DoxyCodeLine{00050\ \ \ \ \ height\ =\ default\_timeline\_height;}
\DoxyCodeLine{00051\ \ \ \}}
\DoxyCodeLine{00052\ \ \ height\ +=\ \_window.frame.size.height\ -\/\ \_window.contentLayoutRect.size.height;}
\DoxyCodeLine{00053\ \ \ \_graph\_view.frame\ =\ NSMakeRect(0,\ 0,\ default\_timeline\_width,\ height);}
\DoxyCodeLine{00054\ \ \ \_graph\_view\_controller.view.frame\ =\ NSMakeRect(0,\ 0,\ default\_timeline\_width,\ height);}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \textcolor{comment}{//\ Add\ a\ drawing\ area\ to\ the\ left\ of\ the\ graph\ to\ show\ the\ thread\ labels.}}
\DoxyCodeLine{00057\ \ \ \_thread\_area\ =\ [[NSView\ alloc]\ initWithFrame:NSMakeRect(0,\ 0,\ default\_timeline\_sidebar\_width,\ 0)];}
\DoxyCodeLine{00058\ \ \ \_thread\_area.autoresizingMask\ =\ NSViewWidthSizable\ |\ NSViewHeightSizable;}
\DoxyCodeLine{00059\ \ \ \_thread\_area.translatesAutoresizingMaskIntoConstraints\ =\ NO;}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \textcolor{comment}{//\ It's\ put\ inside\ a\ scroll\ view\ that\ tracks\ the\ main\ scroll\ view.}}
\DoxyCodeLine{00062\ \ \ NSScrollView\ *scroll\_view\ =\ [[NSScrollView\ alloc]\ initWithFrame:NSMakeRect(0,\ 0,\ default\_timeline\_sidebar\_width,\ 0)];}
\DoxyCodeLine{00063\ \ \ scroll\_view.documentView\ =\ \_thread\_area;}
\DoxyCodeLine{00064\ \ \ scroll\_view.drawsBackground\ =\ NO;}
\DoxyCodeLine{00065\ \ \ scroll\_view.automaticallyAdjustsContentInsets\ =\ YES;}
\DoxyCodeLine{00066\ \ \ \textcolor{comment}{//scroll\_view.translatesAutoresizingMaskIntoConstraints\ =\ NO;}}
\DoxyCodeLine{00067\ \ \ scroll\_view.hasHorizontalScroller\ =\ NO;}
\DoxyCodeLine{00068\ \ \ scroll\_view.hasVerticalScroller\ =\ NO;}
\DoxyCodeLine{00069\ \ \ \_sidebar\_scroll\_view\ =\ scroll\_view;}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ NSNotificationCenter\ *center\ =\ [NSNotificationCenter\ defaultCenter];}
\DoxyCodeLine{00072\ \ \ [center\ addObserver:\_graph\_view\_controller}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \ selector:@selector(handleSideScroll:)}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ name:NSScrollViewDidLiveScrollNotification}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ object:scroll\_view];}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ NSViewController\ *sidebar\_controller\ =\ [[NSViewController\ alloc]\ init];}
\DoxyCodeLine{00078\ \ \ sidebar\_controller.view\ =\ scroll\_view;}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ NSSplitViewController\ *svc\ =\ [[NSSplitViewController\ alloc]\ init];}
\DoxyCodeLine{00081\ \ \ [svc\ addSplitViewItem:[NSSplitViewItem\ sidebarWithViewController:sidebar\_controller]];}
\DoxyCodeLine{00082\ \ \ [svc\ addSplitViewItem:[NSSplitViewItem\ splitViewItemWithViewController:\_graph\_view\_controller]];}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ svc.splitViewItems[0].minimumThickness\ =\ minimum\_timeline\_sidebar\_width;}
\DoxyCodeLine{00085\ \ \ svc.splitViewItems[0].canCollapse\ =\ NO;}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ \ \ NSSplitView\ *split\_view\ =\ svc.splitView;}
\DoxyCodeLine{00088\ \ \ split\_view.vertical\ =\ YES;}
\DoxyCodeLine{00089\ \ \ split\_view.dividerStyle\ =\ NSSplitViewDividerStyleThin;}
\DoxyCodeLine{00090\ \ \ split\_view.autoresizingMask\ =\ NSViewWidthSizable\ |\ NSViewHeightSizable;}
\DoxyCodeLine{00091\ \ \ \_split\_view\ =\ split\_view;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \_window.contentViewController\ =\ svc;}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ [svc\ release];}
\DoxyCodeLine{00096\ \ \ [sidebar\_controller\ release];}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \textcolor{comment}{//\ Scale\ area\ goes\ on\ top,\ as\ a\ titlebar\ accessory\ view.}}
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{interfaceMacStatsScaleAreaController}{MacStatsScaleAreaController}}\ *scale\_area\_controller\ =\ [[\mbox{\hyperlink{interfaceMacStatsScaleAreaController}{MacStatsScaleAreaController}}\ alloc]\ initWithGraph:this];}
\DoxyCodeLine{00100\ \ \ scale\_area\_controller.fullScreenMinHeight\ =\ 20;}
\DoxyCodeLine{00101\ \ \ scale\_area\_controller.layoutAttribute\ =\ NSLayoutAttributeRight;}
\DoxyCodeLine{00102\ \ \ \_scale\_area\ =\ scale\_area\_controller.view;}
\DoxyCodeLine{00103\ \ \ [\_window\ addTitlebarAccessoryViewController:scale\_area\_controller];}
\DoxyCodeLine{00104\ \ \ [scale\_area\_controller\ release];}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ [\_thread\_area.widthAnchor\ constraintEqualToAnchor:scroll\_view.widthAnchor].active\ =\ YES;}
\DoxyCodeLine{00107\ \ \ [\_thread\_area.heightAnchor\ constraintEqualToAnchor:\_graph\_view.heightAnchor].active\ =\ YES;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \_graph\_height\_constraint\ =\ [\_graph\_view.heightAnchor\ constraintGreaterThanOrEqualToConstant:0];}
\DoxyCodeLine{00110\ \ \ \_graph\_height\_constraint.active\ =\ YES;}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ [\_window\ makeKeyAndOrderFront:nil];}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00118\ MacStatsTimeline::}
\DoxyCodeLine{00119\ \string~MacStatsTimeline()\ \{}
\DoxyCodeLine{00120\ \ \ [\_thread\_area\ release];}
\DoxyCodeLine{00121\ \ \ [\_sidebar\_scroll\_view\ release];}
\DoxyCodeLine{00122\ \}}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00130\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a1135e90c7baef9d89e487cc6be5723bb}{MacStatsTimeline::}}}
\DoxyCodeLine{00131\ \mbox{\hyperlink{classMacStatsTimeline_a1135e90c7baef9d89e487cc6be5723bb}{new\_data}}(\textcolor{keywordtype}{int}\ thread\_index,\ \textcolor{keywordtype}{int}\ frame\_number)\ \{}
\DoxyCodeLine{00132\ \ \ \mbox{\hyperlink{classPStatTimeline_aebb2abcbcf418ce72ce39cb920abfd20}{PStatTimeline::new\_data}}(thread\_index,\ frame\_number);}
\DoxyCodeLine{00133\ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00138\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a8b41ac127653cecba622c04299718486}{MacStatsTimeline::}}}
\DoxyCodeLine{00139\ \mbox{\hyperlink{classMacStatsTimeline_a8b41ac127653cecba622c04299718486}{force\_redraw}}()\ \{}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00141\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}();}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00148\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a8e0e98bc3407472aad086fbf690fa0e8}{MacStatsTimeline::}}}
\DoxyCodeLine{00149\ \mbox{\hyperlink{classMacStatsTimeline_a8e0e98bc3407472aad086fbf690fa0e8}{changed\_graph\_size}}(\textcolor{keywordtype}{int}\ graph\_xsize,\ \textcolor{keywordtype}{int}\ graph\_ysize)\ \{}
\DoxyCodeLine{00150\ \ \ \mbox{\hyperlink{classPStatTimeline_a83ea1b01bb9cc013b99cc5c775516869}{PStatTimeline::changed\_size}}(graph\_xsize,\ graph\_ysize);}
\DoxyCodeLine{00151\ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00156\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a50e204fad8544df5500745f764d6d86f}{MacStatsTimeline::}}}
\DoxyCodeLine{00157\ \mbox{\hyperlink{classMacStatsTimeline_a50e204fad8544df5500745f764d6d86f}{clear\_region}}()\ \{}
\DoxyCodeLine{00158\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00159\ \ \ \ \ CGContextSetFillColorWithColor(\_ctx,\ \_background\_color);}
\DoxyCodeLine{00160\ \ \ \ \ CGContextFillRect(\_ctx,\ CGRectMake(0,\ 0,\ get\_xsize(),\ get\_ysize()));}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \ \ CGContextSetTextMatrix(\_ctx,\ CGAffineTransformMakeScale(1,\ -\/1));}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//draw\_guide\_labels(\_ctx);}}
\DoxyCodeLine{00164\ \ \ \}}
\DoxyCodeLine{00165\ \}}
\DoxyCodeLine{00166\ }
\DoxyCodeLine{00170\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_ad1a84d44a8f4894428bcd00cd325fb03}{MacStatsTimeline::}}}
\DoxyCodeLine{00171\ \mbox{\hyperlink{classMacStatsTimeline_ad1a84d44a8f4894428bcd00cd325fb03}{begin\_draw}}()\ \{}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00177\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a566771f9429d15462ecdfca4b273ac8a}{MacStatsTimeline::}}}
\DoxyCodeLine{00178\ \mbox{\hyperlink{classMacStatsTimeline_a566771f9429d15462ecdfca4b273ac8a}{draw\_separator}}(\textcolor{keywordtype}{int}\ row)\ \{}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordflow}{if}\ (\_ctx)\ \{}
\DoxyCodeLine{00180\ \ \ \ \ CGContextSetFillColorWithColor(\_ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00181\ \ \ \ \ CGContextFillRect(\_ctx,\ CGRectMake(0,\ (row\_to\_pixel(row)\ +\ row\_to\_pixel(row\ +\ 1))\ /\ 2.0,\ get\_xsize(),\ 4.0\ /\ 3.0));}
\DoxyCodeLine{00182\ \ \ \}}
\DoxyCodeLine{00183\ \}}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00188\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a95f9ad6c250933989527e40dd7b72a94}{MacStatsTimeline::}}}
\DoxyCodeLine{00189\ \mbox{\hyperlink{classMacStatsTimeline_a95f9ad6c250933989527e40dd7b72a94}{draw\_guide\_bar}}(\textcolor{keywordtype}{int}\ x,\ GuideBarStyle\ style)\ \{}
\DoxyCodeLine{00190\ \ \ draw\_guide\_bar(\_ctx,\ style,\ x,\ 0,\ get\_ysize());}
\DoxyCodeLine{00191\ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00197\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_abbbc974f7b5c7ad74652b6f39416d544}{MacStatsTimeline::}}}
\DoxyCodeLine{00198\ \mbox{\hyperlink{classMacStatsTimeline_abbbc974f7b5c7ad74652b6f39416d544}{draw\_bar}}(\textcolor{keywordtype}{int}\ row,\ \textcolor{keywordtype}{int}\ from\_x,\ \textcolor{keywordtype}{int}\ to\_x,\ \textcolor{keywordtype}{int}\ collector\_index,}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\ \&collector\_name)\ \{}
\DoxyCodeLine{00200\ \ \ \textcolor{keywordtype}{int}\ top\ =\ row\_to\_pixel(row);}
\DoxyCodeLine{00201\ \ \ \textcolor{keywordtype}{int}\ bottom\ =\ row\_to\_pixel(row\ +\ 1);}
\DoxyCodeLine{00202\ \ \ \textcolor{keywordtype}{int}\ scale\ =\ 4;}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \ \ top\ +=\ 1;}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \mbox{\hyperlink{classMacStatsMonitor}{MacStatsMonitor}}\ *monitor\ =\ MacStatsGraph::\_monitor;}
\DoxyCodeLine{00207\ }
\DoxyCodeLine{00208\ \ \ \textcolor{keywordtype}{bool}\ is\_highlighted\ =\ row\ ==\ \_highlighted\_row\ \&\&\ \_highlighted\_x\ >=\ from\_x\ \&\&\ \_highlighted\_x\ <\ to\_x;}
\DoxyCodeLine{00209\ \ \ CGContextSetFillColorWithColor(\_ctx,}
\DoxyCodeLine{00210\ \ \ \ \ monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_aee87fc182ec51348b5b0aa496c615092}{get\_collector\_color}}(collector\_index,\ is\_highlighted));}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ 1)\ \{}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{comment}{//\ Too\ tiny\ to\ draw.}}
\DoxyCodeLine{00214\ \ \ \}}
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (to\_x\ <\ from\_x\ +\ scale)\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{comment}{//\ It's\ just\ a\ tiny\ sliver.\ \ This\ is\ a\ more\ reliable\ way\ to\ draw\ it.}}
\DoxyCodeLine{00217\ \ \ \ \ CGRect\ rect\ =\ CGRectMake(from\_x,\ top,\ to\_x\ -\/\ from\_x,\ bottom\ -\/\ top);}
\DoxyCodeLine{00218\ \ \ \ \ CGContextFillRect(\_ctx,\ rect);}
\DoxyCodeLine{00219\ \ \ \}}
\DoxyCodeLine{00220\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordtype}{int}\ left\ =\ std::max(from\_x,\ -\/scale\ -\/\ 1);}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordtype}{int}\ right\ =\ std::min(std::max(to\_x,\ from\_x\ +\ 1),\ get\_xsize()\ +\ scale);}
\DoxyCodeLine{00223\ }
\DoxyCodeLine{00224\ \ \ \ \ \textcolor{keywordtype}{double}\ radius\ =\ std::min((\textcolor{keywordtype}{double})scale,\ (right\ -\/\ left)\ /\ 2.0);}
\DoxyCodeLine{00225\ \ \ \ \ CGContextBeginPath(\_ctx);}
\DoxyCodeLine{00226\ \ \ \ \ CGContextAddArc(\_ctx,\ right\ -\/\ radius\ -\/\ 0.5,\ top\ +\ radius,\ radius,\ -\/0.5\ *\ M\_PI,\ 0.0,\ NO);}
\DoxyCodeLine{00227\ \ \ \ \ CGContextAddArc(\_ctx,\ right\ -\/\ radius\ -\/\ 0.5,\ bottom\ -\/\ radius,\ radius,\ 0.0,\ 0.5\ *\ M\_PI,\ NO);}
\DoxyCodeLine{00228\ \ \ \ \ CGContextAddArc(\_ctx,\ left\ +\ radius,\ bottom\ -\/\ radius,\ radius,\ 0.5\ *\ M\_PI,\ M\_PI,\ NO);}
\DoxyCodeLine{00229\ \ \ \ \ CGContextAddArc(\_ctx,\ left\ +\ radius,\ top\ +\ radius,\ radius,\ M\_PI,\ 1.5\ *\ M\_PI,\ NO);}
\DoxyCodeLine{00230\ \ \ \ \ CGContextClosePath(\_ctx);}
\DoxyCodeLine{00231\ \ \ \ \ CGContextFillPath(\_ctx);}
\DoxyCodeLine{00232\ }
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{if}\ ((to\_x\ -\/\ from\_x)\ >=\ scale\ *\ 4)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{comment}{//\ Only\ bother\ drawing\ the\ text\ if\ we've\ got\ some\ space\ to\ draw\ on.}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \textcolor{keyword}{const}\ CFStringRef\ keys[]\ =\ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ (\_\_bridge\ CFStringRef)NSForegroundColorAttributeName,}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ (\_\_bridge\ CFStringRef)NSFontAttributeName,}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *values[]\ =\ \{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a6859450fb5ce0c04cb6c94b9dfd88574}{get\_collector\_text\_color}}(collector\_index,\ is\_highlighted),}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ [NSFont\ systemFontOfSize:0.0],}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ CFDictionaryRef\ attribs\ =\ CFDictionaryCreate(kCFAllocatorDefault,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)keys,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)values,\ 2,\ \&kCFTypeDictionaryKeyCallBacks,\ \&kCFTypeDictionaryValueCallBacks);}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \ \ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ collector\_name.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00246\ \ \ \ \ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ \ \ \ \ CTLineRef\ line\ =\ CTLineCreateWithAttributedString(astr);}
\DoxyCodeLine{00249\ \ \ \ \ \ \ CGRect\ bounds\ =\ CTLineGetImageBounds(line,\ \_ctx);}
\DoxyCodeLine{00250\ \ \ \ \ \ \ CFRelease(astr);}
\DoxyCodeLine{00251\ \ \ \ \ \ \ CFRelease(str);}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ text\_width\ =\ bounds.size.width;}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ text\_height\ =\ bounds.size.height;}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ center\ =\ (from\_x\ +\ to\_x)\ /\ 2.0;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_left\ =\ std::max(from\_x,\ 0)\ +\ scale\ /\ 2.0;}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_right\ =\ std::min(to\_x,\ get\_xsize())\ -\/\ scale\ /\ 2.0;}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ text\_top\ =\ top\ +\ (bottom\ -\/\ top\ -\/\ text\_height)\ /\ 2.0\ +\ text\_height;}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_width\ >=\ text\_right\ -\/\ text\_left)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ c\ =\ collector\_name.rfind(\textcolor{charliteral}{':'});}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_right\ -\/\ text\_left\ <\ scale\ *\ 6)\ \{}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It's\ a\ really\ tiny\ space.\ \ Draw\ a\ single\ letter.}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ UniChar\ ch\ =\ *(collector\_name.data()\ +\ (c\ !=\ std::string::npos\ ?\ c\ +\ 1\ :\ 0));}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ CFStringRef\ str\ =\ CFStringCreateWithCharacters(kCFAllocatorDefault,\ \&ch,\ 1);}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00269\ }
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ CTLineRef\ new\_line\ =\ CTLineCreateWithAttributedString((CFAttributedStringRef)astr);}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ bounds\ =\ CTLineGetImageBounds(new\_line,\ \_ctx);}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ text\_width\ =\ bounds.size.width;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ CFRelease(astr);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ CFRelease(str);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ line\ =\ new\_line;}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Maybe\ just\ use\ everything\ after\ the\ last\ colon.}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (c\ !=\ std::string::npos)\ \{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *short\_name\ =\ collector\_name.data()\ +\ c\ +\ 1;}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ short\_name,\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ CTLineRef\ new\_line\ =\ CTLineCreateWithAttributedString((CFAttributedStringRef)astr);}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ bounds\ =\ CTLineGetImageBounds(new\_line,\ \_ctx);}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ text\_width\ =\ bounds.size.width;}
\DoxyCodeLine{00289\ }
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ CFRelease(astr);}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ CFRelease(str);}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ line\ =\ new\_line;}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (text\_width\ >=\ text\_right\ -\/\ text\_left)\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Have\ CoreText\ truncate\ to\ the\ correct\ length.}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ CFStringRef\ token\_str\ =\ CFSTR(\textcolor{stringliteral}{"{}\(\backslash\)u2026"{}});}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ CFAttributedStringRef\ token\_astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ token\_str,\ attribs);}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ CTLineRef\ token\_line\ =\ CTLineCreateWithAttributedString(token\_astr);}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ CTLineRef\ trunc\_line\ =\ CTLineCreateTruncatedLine(line,\ text\_right\ -\/\ text\_left,\ kCTLineTruncationEnd,\ token\_line);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ CFRelease(token\_astr);}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ CFRelease(token\_line);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ line\ =\ trunc\_line;}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ CGContextSetTextPosition(\_ctx,\ text\_left,\ text\_top);}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (center\ -\/\ text\_width\ /\ 2.0\ <\ 0.0)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ left-\/most\ edge.}}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ CGContextSetTextPosition(\_ctx,\ scale,\ text\_top);}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (center\ +\ text\_width\ /\ 2.0\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Put\ it\ against\ the\ right-\/most\ edge.}}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ CGContextSetTextPosition(\_ctx,\ get\_xsize()\ -\/\ scale\ -\/\ text\_width,\ text\_top);}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ It\ fits\ just\ fine,\ center\ it.}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ CGContextSetTextPosition(\_ctx,\ center\ -\/\ text\_width\ /\ 2.0,\ text\_top);}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00322\ }
\DoxyCodeLine{00323\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (line\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ CTLineDraw(line,\ \_ctx);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ CFRelease(line);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00327\ \ \ \ \ \ \ CFRelease(attribs);}
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \}}
\DoxyCodeLine{00330\ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00336\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a1c18fc30996bedf4ca317ef278f8d525}{MacStatsTimeline::}}}
\DoxyCodeLine{00337\ \mbox{\hyperlink{classMacStatsTimeline_a1c18fc30996bedf4ca317ef278f8d525}{end\_draw}}()\ \{}
\DoxyCodeLine{00338\ \ \ \textcolor{comment}{//\ Recalculate\ the\ size\ of\ the\ graph.}}
\DoxyCodeLine{00339\ \ \ \textcolor{keywordflow}{if}\ (!\_threads.empty())\ \{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatTimeline_1_1ThreadRow}{ThreadRow}}\ \&last\_thread\_row\ =\ \_threads.back();}
\DoxyCodeLine{00341\ \ \ \ \ \textcolor{keywordtype}{int}\ new\_height\ =\ row\_to\_pixel(last\_thread\_row.\_row\_offset\ +\ last\_thread\_row.\_rows.size());}
\DoxyCodeLine{00342\ \ \ \ \ \_graph\_height\_constraint.constant\ =\ new\_height;}
\DoxyCodeLine{00343\ \ \ \}}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \_graph\_view.needsDisplay\ =\ YES;}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \textcolor{comment}{//\ If\ we\ scroll\ sideways\ while\ we're\ also\ scrolling\ vertically\ such\ that\ the}}
\DoxyCodeLine{00348\ \ \ \textcolor{comment}{//\ overhang\ becomes\ visible\ due\ to\ elasticity,\ the\ overhang\ doesn't\ update.}}
\DoxyCodeLine{00349\ \ \ \textcolor{comment}{//\ I\ could\ only\ find\ this\ private\ method\ for\ fixing\ this\ problem.}}
\DoxyCodeLine{00350\ \ \ \textcolor{comment}{//\ Not\ needed\ as\ of\ macOS\ 14\ and\ up,\ since\ the\ normal\ drawRect\ DTRT\ there.}}
\DoxyCodeLine{00351\ \textcolor{preprocessor}{\#if\ \_\_MAC\_OS\_X\_VERSION\_MAX\_ALLOWED\ <\ 140000}}
\DoxyCodeLine{00352\ \ \ NSClipView\ *clip\_view\ =\ ((\mbox{\hyperlink{interfaceMacStatsScrollableGraphViewController}{MacStatsScrollableGraphViewController}}\ *)\_graph\_view\_controller).clipView;}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordflow}{if}\ ([clip\_view\ respondsToSelector:\textcolor{keyword}{@selector}(\_setNeedsDisplayInOverhang:)])\ \{}
\DoxyCodeLine{00354\ \textcolor{preprocessor}{\#pragma\ clang\ diagnostic\ push}}
\DoxyCodeLine{00355\ \textcolor{preprocessor}{\#pragma\ clang\ diagnostic\ ignored\ "{}-\/Wobjc-\/method-\/access"{}}}
\DoxyCodeLine{00356\ \ \ \ \ [clip\_view\ \_setNeedsDisplayInOverhang:YES];}
\DoxyCodeLine{00357\ \textcolor{preprocessor}{\#pragma\ clang\ diagnostic\ pop}}
\DoxyCodeLine{00358\ \ \ \}}
\DoxyCodeLine{00359\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \textcolor{keywordflow}{if}\ (\_threads\_changed)\ \{}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordflow}{while}\ (\_thread\_labels.size()\ <\ \_threads.size())\ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ NSTextField\ *label\ =\ [NSTextField\ labelWithString:@"{}Thread"{}];}
\DoxyCodeLine{00364\ \ \ \ \ \ \ label.translatesAutoresizingMaskIntoConstraints\ =\ NO;}
\DoxyCodeLine{00365\ \ \ \ \ \ \ [\_thread\_area\ addSubview:label];}
\DoxyCodeLine{00366\ }
\DoxyCodeLine{00367\ \ \ \ \ \ \ [label.rightAnchor\ constraintEqualToAnchor:\_thread\_area.rightAnchor\ constant:-\/8].active\ =\ YES;}
\DoxyCodeLine{00368\ \ \ \ \ \ \ [\_thread\_area.widthAnchor\ constraintGreaterThanOrEqualToAnchor:label.widthAnchor\ constant:16].active\ =\ YES;}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00370\ \ \ \ \ \ \ NSLayoutConstraint\ *constraint;}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ constraint\ =\ [label.topAnchor\ constraintEqualToAnchor:\_thread\_area.topAnchor];}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ constraint\ =\ [label.topAnchor\ constraintEqualToAnchor:\_thread\_area.topAnchor];}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ constraint.active\ =\ YES;}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \_thread\_labels.push\_back(std::make\_pair(label,\ constraint));}
\DoxyCodeLine{00379\ \ \ \ \ \}}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_threads.size();\ ++i)\ \{}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatTimeline_1_1ThreadRow}{ThreadRow}}\ \&thread\_row\ =\ \_threads[i];}
\DoxyCodeLine{00383\ \ \ \ \ \ \ NSTextField\ *label\ =\ \_thread\_labels[i].first;}
\DoxyCodeLine{00384\ \ \ \ \ \ \ NSLayoutConstraint\ *label\_constraint\ =\ \_thread\_labels[i].second;}
\DoxyCodeLine{00385\ }
\DoxyCodeLine{00386\ \ \ \ \ \ \ label.stringValue\ =\ [NSString\ stringWithUTF8String:thread\_row.\_label.c\_str()];}
\DoxyCodeLine{00387\ \ \ \ \ \ \ label\_constraint.constant\ =\ row\_to\_pixel(thread\_row.\_row\_offset);}
\DoxyCodeLine{00388\ \ \ \ \ \}}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \ \ \_thread\_area.needsDisplay\ =\ YES;}
\DoxyCodeLine{00391\ \ \ \ \ \_threads\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00392\ \ \ \}}
\DoxyCodeLine{00393\ }
\DoxyCodeLine{00394\ \ \ \textcolor{keywordflow}{if}\ (\_guide\_bars\_changed)\ \{}
\DoxyCodeLine{00395\ \ \ \ \ \_scale\_area.needsDisplay\ =\ YES;}
\DoxyCodeLine{00396\ \ \ \ \ \_guide\_bars\_changed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00397\ \ \ \}}
\DoxyCodeLine{00398\ \}}
\DoxyCodeLine{00399\ }
\DoxyCodeLine{00403\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a565f510ee037146edf63ab518bc5a202}{MacStatsTimeline::}}}
\DoxyCodeLine{00404\ \mbox{\hyperlink{classMacStatsTimeline_a565f510ee037146edf63ab518bc5a202}{idle}}()\ \{}
\DoxyCodeLine{00405\ \}}
\DoxyCodeLine{00406\ }
\DoxyCodeLine{00411\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsTimeline_a07e2f555f0cf1701daee80c96ae5f128}{MacStatsTimeline::}}}
\DoxyCodeLine{00412\ \mbox{\hyperlink{classMacStatsTimeline_a07e2f555f0cf1701daee80c96ae5f128}{animate}}(\textcolor{keywordtype}{double}\ time,\ \textcolor{keywordtype}{double}\ dt)\ \{}
\DoxyCodeLine{00413\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_a4bb82d0d67715053beebb23a8dc8589d}{PStatTimeline::animate}}(time,\ dt);}
\DoxyCodeLine{00414\ \}}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00419\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classMacStatsTimeline_a9dade102e020829cc338bde4be006b04}{MacStatsTimeline::}}}
\DoxyCodeLine{00420\ \mbox{\hyperlink{classMacStatsTimeline_a9dade102e020829cc338bde4be006b04}{get\_window\_state}}(\textcolor{keywordtype}{int}\ \&x,\ \textcolor{keywordtype}{int}\ \&y,\ \textcolor{keywordtype}{int}\ \&width,\ \textcolor{keywordtype}{int}\ \&height,}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ \&maximized,\ \textcolor{keywordtype}{bool}\ \&minimized)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00422\ \ \ \mbox{\hyperlink{classMacStatsGraph_a524e8aa33f266e1e46227339bb7ac226}{MacStatsGraph::get\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00423\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00424\ \}}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00429\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a5f4782449aaf1d6846d0d03eb7e5ccf4}{MacStatsTimeline::}}}
\DoxyCodeLine{00430\ \mbox{\hyperlink{classMacStatsTimeline_a5f4782449aaf1d6846d0d03eb7e5ccf4}{set\_window\_state}}(\textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ width,\ \textcolor{keywordtype}{int}\ height,}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ maximized,\ \textcolor{keywordtype}{bool}\ minimized)\ \{}
\DoxyCodeLine{00432\ \ \ \mbox{\hyperlink{classMacStatsGraph_ae85ef8048bce18ca67658bb5e871f445}{MacStatsGraph::set\_window\_state}}(x,\ y,\ width,\ height,\ maximized,\ minimized);}
\DoxyCodeLine{00433\ \}}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00439\ NSMenu\ *\mbox{\hyperlink{classMacStatsTimeline_ad3f93796d4cf5a2c2178c8132d3d7522}{MacStatsTimeline::}}}
\DoxyCodeLine{00440\ \mbox{\hyperlink{classMacStatsTimeline_ad3f93796d4cf5a2c2178c8132d3d7522}{get\_graph\_menu}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00442\ \ \ \mbox{\hyperlink{classPStatTimeline_1_1ColorBar}{ColorBar}}\ bar;}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{if}\ (!find\_bar(row,\ graph\_x,\ bar))\ \{}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{return}\ nil;}
\DoxyCodeLine{00445\ \ \ \}}
\DoxyCodeLine{00446\ }
\DoxyCodeLine{00447\ \ \ \_popup\_bar\ =\ bar;}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ NSMenu\ *menu\ =\ [[[NSMenu\ alloc]\ init]\ autorelease];}
\DoxyCodeLine{00450\ }
\DoxyCodeLine{00451\ \ \ std::string\ label\ =\ get\_bar\_tooltip(row,\ graph\_x);}
\DoxyCodeLine{00452\ \ \ \textcolor{keywordflow}{if}\ (!label.empty())\ \{}
\DoxyCodeLine{00453\ \ \ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 14.0,\ *))\ \{}
\DoxyCodeLine{00454\ \ \ \ \ \ \ [menu\ addItem:[NSMenuItem\ sectionHeaderWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]]];}
\DoxyCodeLine{00455\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00456\ \ \ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:[NSString\ stringWithUTF8String:label.c\_str()]\ action:nil\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00457\ \ \ \ \ \ \ item.enabled\ =\ NO;}
\DoxyCodeLine{00458\ \ \ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00459\ \ \ \ \ \ \ [item\ release];}
\DoxyCodeLine{00460\ \ \ \ \ \}}
\DoxyCodeLine{00461\ \ \ \}}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \{}
\DoxyCodeLine{00464\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Zoom\ To"{}\ action:@selector(handleZoomTo:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00465\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00466\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00467\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00468\ \ \ \}}
\DoxyCodeLine{00469\ }
\DoxyCodeLine{00470\ \ \ \{}
\DoxyCodeLine{00471\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Open\ Strip\ Chart"{}\ action:@selector(handleOpenStripChart:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00472\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00473\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00474\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00475\ \ \ \}}
\DoxyCodeLine{00476\ }
\DoxyCodeLine{00477\ \ \ \{}
\DoxyCodeLine{00478\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Open\ Flame\ Graph"{}\ action:@selector(handleOpenFlameGraph:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00479\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00480\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00481\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00482\ \ \ \}}
\DoxyCodeLine{00483\ }
\DoxyCodeLine{00484\ \ \ \{}
\DoxyCodeLine{00485\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Open\ Piano\ Roll"{}\ action:@selector(handleOpenPianoRoll:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00486\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00487\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00488\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00489\ \ \ \}}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ [menu\ addItem:[NSMenuItem\ separatorItem]];}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \{}
\DoxyCodeLine{00494\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Change\ Color\(\backslash\)u2026"{}\ action:@selector(handleChangeColor:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00495\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00496\ \ \ \ \ item.tag\ =\ bar.\_collector\_index;}
\DoxyCodeLine{00497\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00498\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00499\ \ \ \}}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \{}
\DoxyCodeLine{00502\ \ \ \ \ NSMenuItem\ *item\ =\ [[NSMenuItem\ alloc]\ initWithTitle:@"{}Reset\ Color"{}\ action:@selector(handleResetColor:)\ keyEquivalent:@"{}"{}];}
\DoxyCodeLine{00503\ \ \ \ \ item.target\ =\ \_graph\_view\_controller;}
\DoxyCodeLine{00504\ \ \ \ \ item.tag\ =\ bar.\_collector\_index;}
\DoxyCodeLine{00505\ \ \ \ \ [menu\ addItem:item];}
\DoxyCodeLine{00506\ \ \ \ \ [item\ release];}
\DoxyCodeLine{00507\ \ \ \}}
\DoxyCodeLine{00508\ }
\DoxyCodeLine{00509\ \ \ \textcolor{keywordflow}{return}\ menu;}
\DoxyCodeLine{00510\ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00516\ std::string\ \mbox{\hyperlink{classMacStatsTimeline_af4f72354cc1efec0ffa17608c033efba}{MacStatsTimeline::}}}
\DoxyCodeLine{00517\ \mbox{\hyperlink{classMacStatsTimeline_af4f72354cc1efec0ffa17608c033efba}{get\_graph\_tooltip}}(\textcolor{keywordtype}{int}\ mouse\_x,\ \textcolor{keywordtype}{int}\ mouse\_y)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00518\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPStatTimeline_ab138ad122f3c31ffbe334a65458baf20}{PStatTimeline::get\_bar\_tooltip}}(pixel\_to\_row(mouse\_y),\ mouse\_x);}
\DoxyCodeLine{00519\ \}}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00526\ MacStatsGraph::DragMode\ \mbox{\hyperlink{classMacStatsTimeline_a04d99dedeccef569e8c90fe9f2e0a4f6}{MacStatsTimeline::}}}
\DoxyCodeLine{00527\ \mbox{\hyperlink{classMacStatsTimeline_a04d99dedeccef569e8c90fe9f2e0a4f6}{consider\_drag\_start}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00528\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_aa537e931eb258abdaa4134c05f96ec82}{MacStatsGraph::consider\_drag\_start}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00529\ \}}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00534\ \textcolor{keywordtype}{bool}\ MacStatsTimeline::}
\DoxyCodeLine{00535\ handle\_key(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ pressed,\ UniChar\ c,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ key\_code)\ \{}
\DoxyCodeLine{00536\ \ \ \textcolor{comment}{//\ Accept\ WASD\ based\ on\ their\ position\ rather\ than\ their\ mapping}}
\DoxyCodeLine{00537\ \ \ \textcolor{keywordtype}{int}\ flag\ =\ 0;}
\DoxyCodeLine{00538\ \ \ \textcolor{keywordflow}{switch}\ (key\_code)\ \{}
\DoxyCodeLine{00539\ \ \ \textcolor{keywordflow}{case}\ 13:}
\DoxyCodeLine{00540\ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00542\ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00543\ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00544\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00545\ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00546\ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00547\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00548\ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00549\ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00550\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00551\ \ \ \}}
\DoxyCodeLine{00552\ \ \ \textcolor{keywordflow}{if}\ (flag\ ==\ 0)\ \{}
\DoxyCodeLine{00553\ \ \ \ \ \textcolor{keywordflow}{switch}\ (c)\ \{}
\DoxyCodeLine{00554\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x1c:}
\DoxyCodeLine{00555\ \ \ \ \ \textcolor{keywordflow}{case}\ NSLeftArrowFunctionKey:}
\DoxyCodeLine{00556\ \ \ \ \ \ \ flag\ =\ F\_left;}
\DoxyCodeLine{00557\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00558\ \ \ \ \ \textcolor{keywordflow}{case}\ 0x1d:}
\DoxyCodeLine{00559\ \ \ \ \ \textcolor{keywordflow}{case}\ NSRightArrowFunctionKey:}
\DoxyCodeLine{00560\ \ \ \ \ \ \ flag\ =\ F\_right;}
\DoxyCodeLine{00561\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'w'}:}
\DoxyCodeLine{00563\ \ \ \ \ \ \ flag\ =\ F\_w;}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00565\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'a'}:}
\DoxyCodeLine{00566\ \ \ \ \ \ \ flag\ =\ F\_a;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00568\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'s'}:}
\DoxyCodeLine{00569\ \ \ \ \ \ \ flag\ =\ F\_s;}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00571\ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{charliteral}{'d'}:}
\DoxyCodeLine{00572\ \ \ \ \ \ \ flag\ =\ F\_d;}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00574\ \ \ \ \ \}}
\DoxyCodeLine{00575\ \ \ \}}
\DoxyCodeLine{00576\ \ \ \textcolor{keywordflow}{if}\ (flag\ !=\ 0)\ \{}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keywordflow}{if}\ (pressed)\ \{}
\DoxyCodeLine{00578\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (flag\ \&\ (F\_w\ |\ F\_s))\ \{}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(graph\_x);}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_keys\_held\ ==\ 0)\ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ start\_animation();}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \_keys\_held\ |=\ flag;}
\DoxyCodeLine{00585\ \ \ \ \ \}}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_keys\_held\ !=\ 0)\ \{}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \_keys\_held\ \&=\ \string~flag;}
\DoxyCodeLine{00588\ \ \ \ \ \}}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00590\ \ \ \}}
\DoxyCodeLine{00591\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00592\ \}}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00597\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_adf6a8aa7ce49432fd6c1c6f6fc49125a}{MacStatsTimeline::}}}
\DoxyCodeLine{00598\ \mbox{\hyperlink{classMacStatsTimeline_adf6a8aa7ce49432fd6c1c6f6fc49125a}{handle\_button\_press}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{bool}\ double\_click,\ \textcolor{keywordtype}{int}\ button)\ \{}
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keywordflow}{if}\ (double\_click\ \&\&\ button\ ==\ 0)\ \{}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ on\ a\ color\ bar\ in\ the\ graph\ will\ zoom\ the\ graph\ into}}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \textcolor{comment}{//\ that\ collector.}}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_1_1ColorBar}{ColorBar}}\ bar;}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (find\_bar(row,\ graph\_x,\ bar))\ \{}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ width\ =\ bar.\_end\ -\/\ bar.\_start;}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ zoom\_to(width\ *\ 1.5,\ pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ scroll\_to(bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Double-\/clicking\ the\ white\ area\ zooms\ out.}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \_zoom\_speed\ -\/=\ 100.0;}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00613\ \ \ \ \ \ \ start\_animation();}
\DoxyCodeLine{00614\ \ \ \ \ \}}
\DoxyCodeLine{00615\ }
\DoxyCodeLine{00616\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_potential\_drag\_mode\ ==\ DM\_none)\ \{}
\DoxyCodeLine{00617\ \ \ \ \ \ \ set\_drag\_mode(DM\_pan);}
\DoxyCodeLine{00618\ \ \ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \_scroll\_speed\ =\ 0.0;}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(graph\_x);}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00622\ \ \ \ \ \}}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a85679d6f09f08fbb700a91944568b4d5}{MacStatsGraph::handle\_button\_press}}(graph\_x,\ graph\_y,}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ double\_click,\ button);}
\DoxyCodeLine{00627\ \}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00632\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_ab3a7ade0f972077b26ea82967c39bc0d}{MacStatsTimeline::}}}
\DoxyCodeLine{00633\ \mbox{\hyperlink{classMacStatsTimeline_ab3a7ade0f972077b26ea82967c39bc0d}{handle\_button\_release}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00634\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_scale)\ \{}
\DoxyCodeLine{00635\ \ \ \ \ set\_drag\_mode(DM\_none);}
\DoxyCodeLine{00636\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00637\ \ \ \ \ \textcolor{keywordflow}{return}\ handle\_motion(graph\_x,\ graph\_y);}
\DoxyCodeLine{00638\ \ \ \}}
\DoxyCodeLine{00639\ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_guide\_bar)\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \textcolor{keywordflow}{if}\ (graph\_x\ <\ 0\ ||\ graph\_x\ >=\ get\_xsize())\ \{}
\DoxyCodeLine{00641\ \ \ \ \ \ \ remove\_user\_guide\_bar(\_drag\_guide\_bar);}
\DoxyCodeLine{00642\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00643\ \ \ \ \ \ \ move\_user\_guide\_bar(\_drag\_guide\_bar,\ pixel\_to\_height(graph\_x));}
\DoxyCodeLine{00644\ \ \ \ \ \}}
\DoxyCodeLine{00645\ \ \ \ \ set\_drag\_mode(DM\_none);}
\DoxyCodeLine{00646\ \ \ \ \ \textcolor{comment}{//\ ReleaseCapture();}}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keywordflow}{return}\ handle\_motion(graph\_x,\ graph\_y);}
\DoxyCodeLine{00648\ \ \ \}}
\DoxyCodeLine{00649\ }
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a0dd05ee8e330022b32393b3354f880a2}{MacStatsGraph::handle\_button\_release}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00651\ \}}
\DoxyCodeLine{00652\ }
\DoxyCodeLine{00656\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_ac3750514d6a2df675dea55b11cea2297}{MacStatsTimeline::}}}
\DoxyCodeLine{00657\ \mbox{\hyperlink{classMacStatsTimeline_ac3750514d6a2df675dea55b11cea2297}{handle\_motion}}(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y)\ \{}
\DoxyCodeLine{00658\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_none\ \&\&\ \_potential\_drag\_mode\ ==\ DM\_none\ \&\&}
\DoxyCodeLine{00659\ \ \ \ \ \ \ graph\_x\ >=\ 0\ \&\&\ graph\_y\ >=\ 0\ \&\&\ graph\_x\ <\ get\_xsize()\ \&\&\ graph\_y\ <\ get\_ysize())\ \{}
\DoxyCodeLine{00660\ \ \ \ \ \textcolor{comment}{//\ When\ the\ mouse\ is\ over\ a\ color\ bar,\ highlight\ it.}}
\DoxyCodeLine{00661\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ pixel\_to\_row(graph\_y);}
\DoxyCodeLine{00662\ \ \ \ \ std::swap(\_highlighted\_x,\ graph\_x);}
\DoxyCodeLine{00663\ \ \ \ \ std::swap(\_highlighted\_row,\ row);}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \ \ \ \ \textcolor{keywordflow}{if}\ (row\ >=\ 0)\ \{}
\DoxyCodeLine{00666\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ graph\_x,\ graph\_x);}
\DoxyCodeLine{00667\ \ \ \ \ \}}
\DoxyCodeLine{00668\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(\_highlighted\_row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00669\ }
\DoxyCodeLine{00670\ \ \ \ \ \textcolor{keywordflow}{if}\ ((\_keys\_held\ \&\ (F\_w\ |\ F\_s))\ !=\ 0)\ \{}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \textcolor{comment}{//\ Update\ the\ zoom\ center\ if\ we\ move\ the\ mouse\ while\ zooming\ with\ the}}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \textcolor{comment}{//\ keyboard.}}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \_zoom\_center\ =\ pixel\_to\_timestamp(graph\_x);}
\DoxyCodeLine{00674\ \ \ \ \ \}}
\DoxyCodeLine{00675\ \ \ \}}
\DoxyCodeLine{00676\ \ \ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00677\ \ \ \ \ \textcolor{comment}{//\ If\ the\ mouse\ is\ in\ some\ drag\ mode,\ stop\ highlighting.}}
\DoxyCodeLine{00678\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00679\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00682\ \ \ \ \ \}}
\DoxyCodeLine{00683\ \ \ \}}
\DoxyCodeLine{00684\ }
\DoxyCodeLine{00685\ \ \ \textcolor{keywordflow}{if}\ (\_drag\_mode\ ==\ DM\_pan)\ \{}
\DoxyCodeLine{00686\ \ \ \ \ \textcolor{keywordtype}{int}\ delta\ =\ \_drag\_start\_x\ -\/\ graph\_x;}
\DoxyCodeLine{00687\ \ \ \ \ \_drag\_start\_x\ =\ graph\_x;}
\DoxyCodeLine{00688\ \ \ \ \ set\_horizontal\_scroll(get\_horizontal\_scroll()\ +\ pixel\_to\_height(delta));}
\DoxyCodeLine{00689\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00690\ \ \ \}}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classMacStatsGraph_a45e4a7c922f1a1cc97c413af0c9d3bfb}{MacStatsGraph::handle\_motion}}(graph\_x,\ graph\_y);}
\DoxyCodeLine{00693\ \}}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00698\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a642569791ce2b6f3718cfdce82bcaf49}{MacStatsTimeline::}}}
\DoxyCodeLine{00699\ \mbox{\hyperlink{classMacStatsTimeline_a642569791ce2b6f3718cfdce82bcaf49}{handle\_leave}}()\ \{}
\DoxyCodeLine{00700\ \ \ \textcolor{keywordflow}{if}\ (\_highlighted\_row\ !=\ -\/1)\ \{}
\DoxyCodeLine{00701\ \ \ \ \ \textcolor{keywordtype}{int}\ row\ =\ \_highlighted\_row;}
\DoxyCodeLine{00702\ \ \ \ \ \_highlighted\_row\ =\ -\/1;}
\DoxyCodeLine{00703\ \ \ \ \ \mbox{\hyperlink{classPStatTimeline_a13943da3c863d75c1806c3dd7696c08e}{PStatTimeline::force\_redraw}}(row,\ \_highlighted\_x,\ \_highlighted\_x);}
\DoxyCodeLine{00704\ \ \ \}}
\DoxyCodeLine{00705\ \}}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00710\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a81b109e53ad3a792f6ef65fa4232993b}{MacStatsTimeline::}}}
\DoxyCodeLine{00711\ \mbox{\hyperlink{classMacStatsTimeline_a81b109e53ad3a792f6ef65fa4232993b}{handle\_scroll}}()\ \{}
\DoxyCodeLine{00712\ \ \ \textcolor{comment}{//\ Graph\ view\ is\ flipped,\ side\ bar\ isn't,\ so\ we\ need\ to\ convert\ coordinates}}
\DoxyCodeLine{00713\ \ \ NSPoint\ point;}
\DoxyCodeLine{00714\ \ \ point.x\ =\ 0;}
\DoxyCodeLine{00715\ \ \ point.y\ =\ \_graph\_view.frame.size.height\ -\/\ (((NSScrollView\ *)\_graph\_view\_controller.view).documentVisibleRect.size.height\ +\ ((NSScrollView\ *)\_graph\_view\_controller.view).documentVisibleRect.origin.y);}
\DoxyCodeLine{00716\ \ \ [\_sidebar\_scroll\_view.contentView\ scrollToPoint:point];}
\DoxyCodeLine{00717\ \ \ [\_sidebar\_scroll\_view\ reflectScrolledClipView:\_sidebar\_scroll\_view.contentView];}
\DoxyCodeLine{00718\ \}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00723\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00724\ handle\_wheel(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ dx,\ \textcolor{keywordtype}{double}\ dy)\ \{}
\DoxyCodeLine{00725\ \ \ \textcolor{keywordflow}{if}\ (dx\ !=\ 0.0)\ \{}
\DoxyCodeLine{00726\ \ \ \ \ \_scroll\_speed\ -\/=\ dx;}
\DoxyCodeLine{00727\ \ \ \ \ start\_animation();}
\DoxyCodeLine{00728\ \ \ \}}
\DoxyCodeLine{00729\ \}}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00734\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00735\ handle\_magnify(\textcolor{keywordtype}{int}\ graph\_x,\ \textcolor{keywordtype}{int}\ graph\_y,\ \textcolor{keywordtype}{double}\ scale)\ \{}
\DoxyCodeLine{00736\ \ \ zoom\_by(scale\ *\ 4.0,\ pixel\_to\_timestamp(graph\_x));}
\DoxyCodeLine{00737\ \ \ start\_animation();}
\DoxyCodeLine{00738\ \}}
\DoxyCodeLine{00739\ }
\DoxyCodeLine{00743\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a14576ae73977c52f36d62c0edf76cd1e}{MacStatsTimeline::}}}
\DoxyCodeLine{00744\ \mbox{\hyperlink{classMacStatsTimeline_a14576ae73977c52f36d62c0edf76cd1e}{handle\_draw\_graph}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00745\ \textcolor{preprocessor}{\#if\ \_\_MAC\_OS\_X\_VERSION\_MAX\_ALLOWED\ >=\ 140000}}
\DoxyCodeLine{00746\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{GuideBar}}\ \&bar\ :\ \_guide\_bars)\ \{}
\DoxyCodeLine{00747\ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00748\ \ \ \ \ draw\_guide\_bar(ctx,\ bar.\_style,\ x,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00749\ \ \ \}}
\DoxyCodeLine{00750\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00751\ }
\DoxyCodeLine{00752\ \ \ \mbox{\hyperlink{classMacStatsGraph_aee19588a72b714ef1d04fae9da4967a9}{MacStatsGraph::handle\_draw\_graph}}(ctx,\ rect);}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \ \ NSRect\ scale\_frame\ =\ \_scale\_area.frame;}
\DoxyCodeLine{00755\ \ \ NSRect\ graph\_frame\ =\ \_graph\_view.frame;}
\DoxyCodeLine{00756\ \ \ \textcolor{keywordflow}{if}\ (scale\_frame.size.width\ !=\ graph\_frame.size.width)\ \{}
\DoxyCodeLine{00757\ \ \ \ \ scale\_frame.size.width\ =\ graph\_frame.size.width;}
\DoxyCodeLine{00758\ \ \ \ \ \_scale\_area.frame\ =\ scale\_frame;}
\DoxyCodeLine{00759\ \ \ \}}
\DoxyCodeLine{00760\ \}}
\DoxyCodeLine{00761\ }
\DoxyCodeLine{00766\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_ac7ec4d44e055c76911fbf504efb8d708}{MacStatsTimeline::}}}
\DoxyCodeLine{00767\ \mbox{\hyperlink{classMacStatsTimeline_ac7ec4d44e055c76911fbf504efb8d708}{handle\_draw\_graph\_overhang}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00768\ \ \ CGContextSetFillColorWithColor(ctx,\ \_background\_color);}
\DoxyCodeLine{00769\ \ \ CGContextFillRect(ctx,\ rect);}
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00771\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{GuideBar}}\ \&bar\ :\ \_guide\_bars)\ \{}
\DoxyCodeLine{00772\ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00773\ \ \ \ \ draw\_guide\_bar(ctx,\ bar.\_style,\ x,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00774\ \ \ \}}
\DoxyCodeLine{00775\ \}}
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00780\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a9ed76575749d90e30bfe274fbb3c0ac6}{MacStatsTimeline::}}}
\DoxyCodeLine{00781\ \mbox{\hyperlink{classMacStatsTimeline_a9ed76575749d90e30bfe274fbb3c0ac6}{handle\_draw\_scale\_area}}(CGContextRef\ ctx,\ NSRect\ rect)\ \{}
\DoxyCodeLine{00782\ \ \ \mbox{\hyperlink{classMacStatsGraph_aa94fc746dc83dcb53d851444151a0ae8}{MacStatsGraph::handle\_draw\_scale\_area}}(ctx,\ rect);}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ draw\_guide\_labels(ctx);}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ CGContextSetFillColorWithColor(ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00788\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{GuideBar}}\ \&bar\ :\ \_guide\_bars)\ \{}
\DoxyCodeLine{00789\ \ \ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00790\ \ \ \ \ x\ =\ [\_scale\_area\ convertPoint:NSMakePoint(x,\ 0)\ fromView:\_graph\_view].x;}
\DoxyCodeLine{00791\ \ \ \ \ draw\_guide\_bar(ctx,\ bar.\_style,\ x,\ rect.origin.y,\ rect.size.height);}
\DoxyCodeLine{00792\ \ \ \}}
\DoxyCodeLine{00793\ \}}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00798\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00799\ handle\_zoom\_to()\ \{}
\DoxyCodeLine{00800\ \ \ \textcolor{keyword}{const}\ ColorBar\ \&bar\ =\ \_popup\_bar;}
\DoxyCodeLine{00801\ \ \ \textcolor{keywordtype}{double}\ width\ =\ bar.\_end\ -\/\ bar.\_start;}
\DoxyCodeLine{00802\ \ \ zoom\_to(width\ *\ 1.5,\ (bar.\_end\ +\ bar.\_start)\ /\ 2.0);}
\DoxyCodeLine{00803\ \ \ scroll\_to(bar.\_start\ -\/\ width\ /\ 4.0);}
\DoxyCodeLine{00804\ \ \ start\_animation();}
\DoxyCodeLine{00805\ \}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00810\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00811\ handle\_open\_strip\_chart()\ \{}
\DoxyCodeLine{00812\ \ \ \textcolor{keyword}{const}\ ColorBar\ \&bar\ =\ \_popup\_bar;}
\DoxyCodeLine{00813\ \ \ MacStatsGraph::\_monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a94878306e9bedcf47dfda78cb9b2f1df}{open\_strip\_chart}}(bar.\_thread\_index,\ bar.\_collector\_index,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00814\ \}}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00819\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00820\ handle\_open\_flame\_graph()\ \{}
\DoxyCodeLine{00821\ \ \ \textcolor{keyword}{const}\ ColorBar\ \&bar\ =\ \_popup\_bar;}
\DoxyCodeLine{00822\ \ \ MacStatsGraph::\_monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a080816c417c413c20b3e2f3fb7c5460f}{open\_flame\_graph}}(bar.\_thread\_index,\ bar.\_collector\_index,\ bar.\_frame\_number);}
\DoxyCodeLine{00823\ \}}
\DoxyCodeLine{00824\ }
\DoxyCodeLine{00828\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00829\ handle\_open\_piano\_roll()\ \{}
\DoxyCodeLine{00830\ \ \ \textcolor{keyword}{const}\ ColorBar\ \&bar\ =\ \_popup\_bar;}
\DoxyCodeLine{00831\ \ \ MacStatsGraph::\_monitor-\/>\mbox{\hyperlink{classMacStatsMonitor_a137e8d4bf515f56d6aefa6ada27e7b8e}{open\_piano\_roll}}(bar.\_thread\_index);}
\DoxyCodeLine{00832\ \}}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00837\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classMacStatsTimeline_a95f9ad6c250933989527e40dd7b72a94}{MacStatsTimeline::}}}
\DoxyCodeLine{00838\ \mbox{\hyperlink{classMacStatsTimeline_a95f9ad6c250933989527e40dd7b72a94}{draw\_guide\_bar}}(CGContextRef\ ctx,\ GuideBarStyle\ style,\ \textcolor{keywordtype}{int}\ x,\ \textcolor{keywordtype}{int}\ y,\ \textcolor{keywordtype}{int}\ height)\ \{}
\DoxyCodeLine{00839\ \ \ \textcolor{keywordtype}{double}\ width\ =\ 1.0;}
\DoxyCodeLine{00840\ \ \ \textcolor{keywordflow}{if}\ (style\ ==\ GBS\_frame)\ \{}
\DoxyCodeLine{00841\ \ \ \ \ width\ *=\ 2;}
\DoxyCodeLine{00842\ \ \ \}}
\DoxyCodeLine{00843\ }
\DoxyCodeLine{00844\ \ \ CGContextSetFillColorWithColor(ctx,\ [NSColor\ gridColor].CGColor);}
\DoxyCodeLine{00845\ \ \ CGContextFillRect(ctx,\ CGRectMake(x\ -\/\ width\ /\ 2.0,\ y,\ width,\ height));}
\DoxyCodeLine{00846\ \}}
\DoxyCodeLine{00847\ }
\DoxyCodeLine{00851\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00852\ draw\_guide\_labels(CGContextRef\ ctx)\ \{}
\DoxyCodeLine{00853\ \ \ \textcolor{keywordtype}{int}\ num\_guide\_bars\ =\ get\_num\_guide\_bars();}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ num\_guide\_bars;\ i++)\ \{}
\DoxyCodeLine{00855\ \ \ \ \ draw\_guide\_label(ctx,\ get\_guide\_bar(i));}
\DoxyCodeLine{00856\ \ \ \}}
\DoxyCodeLine{00857\ \}}
\DoxyCodeLine{00858\ }
\DoxyCodeLine{00862\ \textcolor{keywordtype}{void}\ MacStatsTimeline::}
\DoxyCodeLine{00863\ draw\_guide\_label(CGContextRef\ ctx,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPStatGraph_1_1GuideBar}{PStatGraph::GuideBar}}\ \&bar)\ \{}
\DoxyCodeLine{00864\ \ \ \textcolor{keyword}{const}\ std::string\ \&label\ =\ bar.\_label;}
\DoxyCodeLine{00865\ \ \ \textcolor{keywordflow}{if}\ (label.empty())\ \{}
\DoxyCodeLine{00866\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00867\ \ \ \}}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ NSColor\ *\mbox{\hyperlink{structcolor}{color}};}
\DoxyCodeLine{00870\ \ \ \textcolor{keywordflow}{if}\ (@available(macOS\ 11.0,\ *))\ \{}
\DoxyCodeLine{00871\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ =\ [NSColor\ tertiaryLabelColor];}
\DoxyCodeLine{00872\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00873\ \ \ \ \ \textcolor{comment}{//\ Otherwise\ it's\ hard\ to\ see\ on\ the\ dark\ titlebars}}
\DoxyCodeLine{00874\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}}\ =\ [NSColor\ windowFrameTextColor];}
\DoxyCodeLine{00875\ \ \ \}}
\DoxyCodeLine{00876\ \ \ \textcolor{comment}{/*switch\ (bar.\_style)\ \{}}
\DoxyCodeLine{00877\ \textcolor{comment}{\ \ case\ GBS\_target:}}
\DoxyCodeLine{00878\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_light\_gray[0]\ green:rgb\_light\_gray[1]\ blue:rgb\_light\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00879\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00880\ \textcolor{comment}{}}
\DoxyCodeLine{00881\ \textcolor{comment}{\ \ case\ GBS\_user:}}
\DoxyCodeLine{00882\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_user\_guide\_bar[0]\ green:rgb\_user\_guide\_bar[1]\ blue:rgb\_user\_guide\_bar[2]\ alpha:1.0];}}
\DoxyCodeLine{00883\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00884\ \textcolor{comment}{}}
\DoxyCodeLine{00885\ \textcolor{comment}{\ \ case\ GBS\_normal:}}
\DoxyCodeLine{00886\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_light\_gray[0]\ green:rgb\_light\_gray[1]\ blue:rgb\_light\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00887\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00888\ \textcolor{comment}{}}
\DoxyCodeLine{00889\ \textcolor{comment}{\ \ case\ GBS\_frame:}}
\DoxyCodeLine{00890\ \textcolor{comment}{\ \ \ \ color\ =\ [NSColor\ colorWithDeviceRed:rgb\_dark\_gray[0]\ green:rgb\_dark\_gray[1]\ blue:rgb\_dark\_gray[2]\ alpha:1.0];}}
\DoxyCodeLine{00891\ \textcolor{comment}{\ \ \ \ break;}}
\DoxyCodeLine{00892\ \textcolor{comment}{\ \ \}*/}}
\DoxyCodeLine{00893\ }
\DoxyCodeLine{00894\ \ \ \textcolor{keyword}{const}\ CFStringRef\ keys[]\ =\ \{}
\DoxyCodeLine{00895\ \ \ \ \ (\_\_bridge\ CFStringRef)NSForegroundColorAttributeName,}
\DoxyCodeLine{00896\ \ \ \ \ (\_\_bridge\ CFStringRef)NSFontAttributeName,}
\DoxyCodeLine{00897\ \ \ \};}
\DoxyCodeLine{00898\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *values[]\ =\ \{}
\DoxyCodeLine{00899\ \ \ \ \ \mbox{\hyperlink{structcolor}{color}},}
\DoxyCodeLine{00900\ \ \ \ \ [NSFont\ systemFontOfSize:0.0],}
\DoxyCodeLine{00901\ \ \ \};}
\DoxyCodeLine{00902\ \ \ CFDictionaryRef\ attribs\ =\ CFDictionaryCreate(kCFAllocatorDefault,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)keys,\ (\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ **)values,\ 2,\ \&kCFTypeDictionaryKeyCallBacks,\ \&kCFTypeDictionaryValueCallBacks);}
\DoxyCodeLine{00903\ }
\DoxyCodeLine{00904\ \ \ CFStringRef\ str\ =\ CFStringCreateWithCString(kCFAllocatorDefault,\ label.c\_str(),\ kCFStringEncodingUTF8);}
\DoxyCodeLine{00905\ \ \ CFAttributedStringRef\ astr\ =\ CFAttributedStringCreate(kCFAllocatorDefault,\ str,\ attribs);}
\DoxyCodeLine{00906\ \ \ CFRelease(attribs);}
\DoxyCodeLine{00907\ \ \ CFRelease(str);}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ CTLineRef\ line\ =\ CTLineCreateWithAttributedString(astr);}
\DoxyCodeLine{00910\ \ \ CFRelease(astr);}
\DoxyCodeLine{00911\ \ \ CGRect\ bounds\ =\ CTLineGetImageBounds(line,\ ctx);}
\DoxyCodeLine{00912\ \ \ \textcolor{comment}{//int\ height\ =\ bounds.size.height;}}
\DoxyCodeLine{00913\ \ \ \textcolor{keywordtype}{int}\ width\ =\ bounds.size.width;}
\DoxyCodeLine{00914\ }
\DoxyCodeLine{00915\ \ \ NSRect\ graph\_bounds\ =\ \_graph\_view.bounds;}
\DoxyCodeLine{00916\ }
\DoxyCodeLine{00917\ \ \ \textcolor{keywordtype}{int}\ x\ =\ timestamp\_to\_pixel(bar.\_height);}
\DoxyCodeLine{00918\ \ \ x\ =\ [\_scale\_area\ convertPoint:NSMakePoint(x,\ 0)\ fromView:\_graph\_view].x;}
\DoxyCodeLine{00919\ }
\DoxyCodeLine{00920\ \ \ \textcolor{keywordflow}{if}\ (x\ +\ width\ >=\ 0\ \&\&\ x\ +\ width\ <\ get\_xsize())\ \{}
\DoxyCodeLine{00921\ \ \ \ \ \textcolor{keywordflow}{if}\ (x\ +\ width\ <\ graph\_bounds.size.width)\ \{}
\DoxyCodeLine{00922\ \ \ \ \ \ \ CGContextSetTextPosition(ctx,\ x\ +\ 6,\ 6);}
\DoxyCodeLine{00923\ \ \ \ \ \ \ CTLineDraw(line,\ ctx);}
\DoxyCodeLine{00924\ \ \ \ \ \}}
\DoxyCodeLine{00925\ \ \ \}}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ CFRelease(line);}
\DoxyCodeLine{00928\ \}}
\DoxyCodeLine{00929\ }
\DoxyCodeLine{00930\ \textcolor{keyword}{@implementation\ }\mbox{\hyperlink{interfaceMacStatsTimelineViewController}{MacStatsTimelineViewController}}}
\DoxyCodeLine{00931\ }
\DoxyCodeLine{00932\ -\/\ (void)handleZoomTo:(NSMenuItem\ *)item\ \{}
\DoxyCodeLine{00933\ \ \ ((\mbox{\hyperlink{classMacStatsTimeline}{MacStatsTimeline}}\ *)\_graph)-\/>handle\_zoom\_to();}
\DoxyCodeLine{00934\ \}}
\DoxyCodeLine{00935\ }
\DoxyCodeLine{00936\ -\/\ (void)handleOpenStripChart:(NSMenuItem\ *)item\ \{}
\DoxyCodeLine{00937\ \ \ ((\mbox{\hyperlink{classMacStatsTimeline}{MacStatsTimeline}}\ *)\_graph)-\/>handle\_open\_strip\_chart();}
\DoxyCodeLine{00938\ \}}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ -\/\ (void)handleOpenFlameGraph:(NSMenuItem\ *)item\ \{}
\DoxyCodeLine{00941\ \ \ ((\mbox{\hyperlink{classMacStatsTimeline}{MacStatsTimeline}}\ *)\_graph)-\/>handle\_open\_flame\_graph();}
\DoxyCodeLine{00942\ \}}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ -\/\ (void)handleOpenPianoRoll:(NSMenuItem\ *)item\ \{}
\DoxyCodeLine{00945\ \ \ ((\mbox{\hyperlink{classMacStatsTimeline}{MacStatsTimeline}}\ *)\_graph)-\/>handle\_open\_piano\_roll();}
\DoxyCodeLine{00946\ \}}
\DoxyCodeLine{00947\ }
\DoxyCodeLine{00948\ \textcolor{keyword}{@end}}
\DoxyCodeLine{00949\ }

\end{DoxyCode}
