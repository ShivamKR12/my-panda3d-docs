\doxysection{slider\+Table.\+cxx}
\hypertarget{sliderTable_8cxx_source}{}\label{sliderTable_8cxx_source}\index{panda/src/gobj/sliderTable.cxx@{panda/src/gobj/sliderTable.cxx}}
\mbox{\hyperlink{sliderTable_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{sliderTable_8h}{sliderTable.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{vertexTransform_8h}{vertexTransform.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ SliderTable::\_empty\_array;}
\DoxyCodeLine{00020\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ SliderTable::\_type\_handle;}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00025\ SliderTable::}
\DoxyCodeLine{00026\ SliderTable()\ :}
\DoxyCodeLine{00027\ \ \ \_is\_registered(false)}
\DoxyCodeLine{00028\ \{}
\DoxyCodeLine{00029\ \}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00034\ SliderTable::}
\DoxyCodeLine{00035\ SliderTable(\textcolor{keyword}{const}\ \mbox{\hyperlink{classSliderTable}{SliderTable}}\ \&copy)\ :}
\DoxyCodeLine{00036\ \ \ \_is\_registered(false),}
\DoxyCodeLine{00037\ \ \ \_sliders(copy.\_sliders),}
\DoxyCodeLine{00038\ \ \ \_sliders\_by\_name(copy.\_sliders\_by\_name)}
\DoxyCodeLine{00039\ \{}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00045\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00046\ operator\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classSliderTable}{SliderTable}}\ \&copy)\ \{}
\DoxyCodeLine{00047\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00048\ \ \ \_sliders\ =\ copy.\_sliders;}
\DoxyCodeLine{00049\ \ \ \_sliders\_by\_name\ =\ copy.\_sliders\_by\_name;}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00055\ SliderTable::}
\DoxyCodeLine{00056\ \string~SliderTable()\ \{}
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{if}\ (\_is\_registered)\ \{}
\DoxyCodeLine{00058\ \ \ \ \ do\_unregister();}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00065\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00066\ set\_slider(\textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *slider)\ \{}
\DoxyCodeLine{00067\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00068\ \ \ nassertv(n\ <\ \_sliders.size());}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{if}\ (\_sliders[n].\_slider-\/>get\_name()\ !=\ slider-\/>get\_name())\ \{}
\DoxyCodeLine{00071\ \ \ \ \ \_sliders\_by\_name[\_sliders[n].\_slider-\/>get\_name()].clear\_bit(n);}
\DoxyCodeLine{00072\ \ \ \ \ \_sliders\_by\_name[slider-\/>get\_name()].set\_bit(n);}
\DoxyCodeLine{00073\ \ \ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \_sliders[n].\_slider\ =\ slider;}
\DoxyCodeLine{00076\ \}}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00082\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00083\ set\_slider\_rows(\textcolor{keywordtype}{size\_t}\ n,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ \&rows)\ \{}
\DoxyCodeLine{00084\ \ \ \textcolor{comment}{//\ We\ don't\ actually\ enforce\ the\ registration\ requirement,\ since\ gee,\ it}}
\DoxyCodeLine{00085\ \ \ \textcolor{comment}{//\ doesn't\ actually\ matter\ here;\ and\ the\ GeomVertexData\ needs\ to\ be\ able\ to}}
\DoxyCodeLine{00086\ \ \ \textcolor{comment}{//\ change\ the\ SparseArrays\ in\ the\ bam\ reader.\ \ nassertv(!\_is\_registered);}}
\DoxyCodeLine{00087\ \ \ nassertv(n\ <\ \_sliders.size());}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \_sliders[n].\_rows\ =\ rows;}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00095\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00096\ remove\_slider(\textcolor{keywordtype}{size\_t}\ n)\ \{}
\DoxyCodeLine{00097\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00098\ \ \ nassertv(n\ <\ \_sliders.size());}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \_sliders\_by\_name[\_sliders[n].\_slider-\/>get\_name()].clear\_bit(n);}
\DoxyCodeLine{00101\ \ \ \_sliders.erase(\_sliders.begin()\ +\ n);}
\DoxyCodeLine{00102\ \}}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00108\ \textcolor{keywordtype}{size\_t}\ SliderTable::}
\DoxyCodeLine{00109\ add\_slider(\textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *slider,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classSparseArray}{SparseArray}}\ \&rows)\ \{}
\DoxyCodeLine{00110\ \ \ nassertr(!\_is\_registered,\ 0);}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00112\ \ \ \textcolor{keywordtype}{size\_t}\ new\_index\ =\ \_sliders.size();}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ SliderDef\ slider\_def;}
\DoxyCodeLine{00115\ \ \ slider\_def.\_slider\ =\ slider;}
\DoxyCodeLine{00116\ \ \ slider\_def.\_rows\ =\ rows;}
\DoxyCodeLine{00117\ \ \ \_sliders.push\_back(slider\_def);}
\DoxyCodeLine{00118\ \ \ \_sliders\_by\_name[slider-\/>get\_name()].set\_bit(new\_index);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{return}\ new\_index;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00126\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00127\ write(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00128\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ \_sliders.size();\ ++i)\ \{}
\DoxyCodeLine{00129\ \ \ \ \ out\ <<\ i\ <<\ \textcolor{stringliteral}{"{}.\ "{}}\ <<\ *\_sliders[i].\_slider\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ <<\ \_sliders[i].\_rows\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00138\ do\_register()\ \{}
\DoxyCodeLine{00139\ \ \ nassertv(!\_is\_registered);}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ Sliders::iterator\ si;}
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_sliders.begin();\ si\ !=\ \_sliders.end();\ ++si)\ \{}
\DoxyCodeLine{00143\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *slider\ =\ (*si).\_slider;}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordtype}{bool}\ inserted\ =\ ((\mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *)slider)-\/>\_tables.insert(\textcolor{keyword}{this}).second;}
\DoxyCodeLine{00145\ \ \ \ \ nassertv(inserted);}
\DoxyCodeLine{00146\ \ \ \}}
\DoxyCodeLine{00147\ \ \ \_is\_registered\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00148\ \}}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00154\ \textcolor{keywordtype}{void}\ SliderTable::}
\DoxyCodeLine{00155\ do\_unregister()\ \{}
\DoxyCodeLine{00156\ \ \ nassertv(\_is\_registered);}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ Sliders::iterator\ si;}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_sliders.begin();\ si\ !=\ \_sliders.end();\ ++si)\ \{}
\DoxyCodeLine{00160\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *slider\ =\ (*si).\_slider;}
\DoxyCodeLine{00161\ \ \ \ \ ((\mbox{\hyperlink{classVertexSlider}{VertexSlider}}\ *)slider)-\/>\_tables.erase(\textcolor{keyword}{this});}
\DoxyCodeLine{00162\ \ \ \}}
\DoxyCodeLine{00163\ \ \ \_is\_registered\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00164\ \}}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00169\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSliderTable_a0d4de34faedcabd3ef55f0a54b80da5b}{SliderTable::}}}
\DoxyCodeLine{00170\ \mbox{\hyperlink{classSliderTable_a0d4de34faedcabd3ef55f0a54b80da5b}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00171\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classSliderTable_a3b811d923b15fae85cb273a92ef70c1b}{make\_from\_bam}});}
\DoxyCodeLine{00172\ \}}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00178\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSliderTable_a2d38b85ec73643eb8f4978ff2b221567}{SliderTable::}}}
\DoxyCodeLine{00179\ \mbox{\hyperlink{classSliderTable_a2d38b85ec73643eb8f4978ff2b221567}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00180\ \ \ TypedWritable::write\_datagram(manager,\ dg);}
\DoxyCodeLine{00181\ }
\DoxyCodeLine{00182\ \ \ dg.add\_uint16(\_sliders.size());}
\DoxyCodeLine{00183\ \ \ Sliders::const\_iterator\ si;}
\DoxyCodeLine{00184\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_sliders.begin();\ si\ !=\ \_sliders.end();\ ++si)\ \{}
\DoxyCodeLine{00185\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(dg,\ (*si).\_slider-\/>get\_name());}
\DoxyCodeLine{00186\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(dg,\ (*si).\_slider);}
\DoxyCodeLine{00187\ \ \ \ \ (*si).\_rows.write\_datagram(manager,\ dg);}
\DoxyCodeLine{00188\ \ \ \}}
\DoxyCodeLine{00189\ }
\DoxyCodeLine{00190\ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a4a957fdbd6f508ee3029a41a794030cd}{write\_cdata}}(dg,\ \_cycler);}
\DoxyCodeLine{00191\ \}}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00197\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classSliderTable_acbb02e27f14864f5e3e804644c995874}{SliderTable::}}}
\DoxyCodeLine{00198\ \mbox{\hyperlink{classSliderTable_acbb02e27f14864f5e3e804644c995874}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00199\ \ \ \textcolor{keywordtype}{int}\ pi\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{TypedWritableReferenceCount::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ n\ =\ 0;\ n\ <\ \_sliders.size();\ ++n)\ \{}
\DoxyCodeLine{00202\ \ \ \ \ CPT(\mbox{\hyperlink{classInternalName}{InternalName}})\ name\ =\ DCAST(\mbox{\hyperlink{classInternalName}{InternalName}},\ p\_list[pi++]);}
\DoxyCodeLine{00203\ \ \ \ \ PT(\mbox{\hyperlink{classVertexSlider}{VertexSlider}})\ slider\ =\ DCAST(\mbox{\hyperlink{classVertexSlider}{VertexSlider}},\ p\_list[pi++]);}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \_sliders[n].\_slider\ =\ slider;}
\DoxyCodeLine{00206\ \ \ \ \ \_sliders\_by\_name[name].set\_bit(n);}
\DoxyCodeLine{00207\ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{return}\ pi;}
\DoxyCodeLine{00210\ \}}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00217\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classSliderTable_a3b811d923b15fae85cb273a92ef70c1b}{SliderTable::}}}
\DoxyCodeLine{00218\ \mbox{\hyperlink{classSliderTable_a3b811d923b15fae85cb273a92ef70c1b}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00219\ \ \ \mbox{\hyperlink{classSliderTable}{SliderTable}}\ *\textcolor{keywordtype}{object}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classSliderTable}{SliderTable}};}
\DoxyCodeLine{00220\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00221\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00224\ \ \ \textcolor{keywordtype}{object}-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \textcolor{keywordflow}{return}\ object;}
\DoxyCodeLine{00227\ \}}
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00233\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classSliderTable_a79d630ab2f81cfc3e30c9852c88fffab}{SliderTable::}}}
\DoxyCodeLine{00234\ \mbox{\hyperlink{classSliderTable_a79d630ab2f81cfc3e30c9852c88fffab}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00235\ \ \ \mbox{\hyperlink{classTypedWritable_a3ad6cc1cd23bc3783d83edb3302bb43c}{TypedWritable::fillin}}(scan,\ manager);}
\DoxyCodeLine{00236\ }
\DoxyCodeLine{00237\ \ \ \textcolor{keywordtype}{size\_t}\ num\_sliders\ =\ scan.get\_uint16();}
\DoxyCodeLine{00238\ \ \ \_sliders.reserve(num\_sliders);}
\DoxyCodeLine{00239\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ num\_sliders;\ ++i)\ \{}
\DoxyCodeLine{00240\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);}
\DoxyCodeLine{00241\ \ \ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);}
\DoxyCodeLine{00242\ \ \ \ \ \_sliders.push\_back(SliderDef());}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{keywordflow}{if}\ (manager-\/>get\_file\_minor\_ver()\ >=\ 7)\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \_sliders[i].\_rows.read\_datagram(scan,\ manager);}
\DoxyCodeLine{00245\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \textcolor{comment}{//\ In\ this\ case,\ for\ bam\ files\ prior\ to\ 6.7,\ we\ must\ define\ the}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \textcolor{comment}{//\ SparseArray\ with\ the\ full\ number\ of\ vertices.\ \ This\ is\ done\ in}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{comment}{//\ GeomVertexData::complete\_pointers().}}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ae63d90cd5d2c87fe3159f6b5d6d9fe10}{read\_cdata}}(scan,\ \_cycler);}
\DoxyCodeLine{00253\ \}}
\DoxyCodeLine{00254\ }
\DoxyCodeLine{00258\ \mbox{\hyperlink{classCycleData}{CycleData}}\ *SliderTable::CData::}
\DoxyCodeLine{00259\ make\_copy()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00260\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ CData(*\textcolor{keyword}{this});}
\DoxyCodeLine{00261\ \}}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00267\ \textcolor{keywordtype}{void}\ SliderTable::CData::}
\DoxyCodeLine{00268\ write\_datagram(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00269\ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00275\ \textcolor{keywordtype}{void}\ SliderTable::CData::}
\DoxyCodeLine{00276\ fillin(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00277\ \ \ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread\ =\ Thread::get\_current\_thread();}
\DoxyCodeLine{00278\ \ \ \_modified\ =\ VertexTransform::get\_next\_modified(current\_thread);}
\DoxyCodeLine{00279\ \}}

\end{DoxyCode}
