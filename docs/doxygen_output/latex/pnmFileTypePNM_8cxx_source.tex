\doxysection{pnm\+File\+Type\+PNM.\+cxx}
\hypertarget{pnmFileTypePNM_8cxx_source}{}\label{pnmFileTypePNM_8cxx_source}\index{panda/src/pnmimagetypes/pnmFileTypePNM.cxx@{panda/src/pnmimagetypes/pnmFileTypePNM.cxx}}
\mbox{\hyperlink{pnmFileTypePNM_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmFileTypePNM_8h}{pnmFileTypePNM.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifdef\ HAVE\_PNM}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pnmimagetypes_8h}{config\_pnmimagetypes.h}}"{}}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmFileTypeRegistry_8h}{pnmFileTypeRegistry.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00024\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00025\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ extensions\_PNM[]\ =\ \{}
\DoxyCodeLine{00028\ \ \ \textcolor{stringliteral}{"{}pbm"{}},\ \textcolor{stringliteral}{"{}pgm"{}},\ \textcolor{stringliteral}{"{}ppm"{}},\ \textcolor{stringliteral}{"{}pnm"{}}}
\DoxyCodeLine{00029\ \};}
\DoxyCodeLine{00030\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ num\_extensions\_PNM\ =\ \textcolor{keyword}{sizeof}(extensions\_PNM)\ /\ \textcolor{keyword}{sizeof}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *);}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ PNMFileTypePNM::\_type\_handle;}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \textcolor{comment}{//\ Some\ macros\ lifted\ from\ the\ original\ Netpbm\ sources.}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#define\ PBM\_MAGIC1\ 'P'}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#define\ PBM\_MAGIC2\ '1'}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#define\ RPBM\_MAGIC2\ '4'}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#define\ PBM\_FORMAT\ (PBM\_MAGIC1\ *\ 256\ +\ PBM\_MAGIC2)}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#define\ RPBM\_FORMAT\ (PBM\_MAGIC1\ *\ 256\ +\ RPBM\_MAGIC2)}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#define\ PBM\_TYPE\ PBM\_FORMAT}}
\DoxyCodeLine{00042\ }
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#define\ PBM\_FORMAT\_TYPE(f)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\ \ ((f)\ ==\ PBM\_FORMAT\ ||\ (f)\ ==\ RPBM\_FORMAT\ ?\ PBM\_TYPE\ :\ -\/1)}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#define\ PGM\_OVERALLMAXVAL\ 65535}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{preprocessor}{\#define\ PGM\_MAGIC1\ 'P'}}
\DoxyCodeLine{00049\ \textcolor{preprocessor}{\#define\ PGM\_MAGIC2\ '2'}}
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ RPGM\_MAGIC2\ '5'}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\#define\ PGM\_FORMAT\ (PGM\_MAGIC1\ *\ 256\ +\ PGM\_MAGIC2)}}
\DoxyCodeLine{00052\ \textcolor{preprocessor}{\#define\ RPGM\_FORMAT\ (PGM\_MAGIC1\ *\ 256\ +\ RPGM\_MAGIC2)}}
\DoxyCodeLine{00053\ \textcolor{preprocessor}{\#define\ PGM\_TYPE\ PGM\_FORMAT}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \textcolor{preprocessor}{\#define\ PGM\_FORMAT\_TYPE(f)\ ((f)\ ==\ PGM\_FORMAT\ ||\ (f)\ ==\ RPGM\_FORMAT\ ?\ PGM\_TYPE\ :\ PBM\_FORMAT\_TYPE(f))}}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#define\ PPM\_OVERALLMAXVAL\ PGM\_OVERALLMAXVAL}}
\DoxyCodeLine{00058\ \textcolor{preprocessor}{\#define\ PPM\_MAXMAXVAL\ PGM\_MAXMAXVAL}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{preprocessor}{\#define\ PPM\_MAGIC1\ 'P'}}
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#define\ PPM\_MAGIC2\ '3'}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#define\ RPPM\_MAGIC2\ '6'}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ PPM\_FORMAT\ (PPM\_MAGIC1\ *\ 256\ +\ PPM\_MAGIC2)}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#define\ RPPM\_FORMAT\ (PPM\_MAGIC1\ *\ 256\ +\ RPPM\_MAGIC2)}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ PPM\_TYPE\ PPM\_FORMAT}}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#define\ PPM\_FORMAT\_TYPE(f)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\ \ ((f)\ ==\ PPM\_FORMAT\ ||\ (f)\ ==\ RPPM\_FORMAT\ ?\ PPM\_TYPE\ :\ PGM\_FORMAT\_TYPE(f))}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#define\ PNM\_OVERALLMAXVAL\ PPM\_OVERALLMAXVAL}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ PNM\_GET1(x)\ PPM\_GETB(x)}}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#define\ PNM\_FORMAT\_TYPE(f)\ PPM\_FORMAT\_TYPE(f)}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{keyword}{typedef}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ bit;}
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#define\ PBM\_WHITE\ 0}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#define\ PBM\_BLACK\ 1}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#define\ pbm\_allocarray(cols,\ rows)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ ((bit**)\ pm\_allocarray(cols,\ rows,\ sizeof(bit)))}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#define\ pbm\_allocrow(cols)\ ((bit*)\ pm\_allocrow(cols,\ sizeof(bit)))}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\#define\ pbm\_freearray(bits,\ rows)\ pm\_freearray((char**)\ bits,\ rows)}}
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#define\ pbm\_freerow(bitrow)\ pm\_freerow((char*)\ bitrow)}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#define\ pbm\_packed\_bytes(cols)\ (((cols)+7)/8)}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#define\ pbm\_allocrow\_packed(cols)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\ \ ((unsigned\ char\ *)\ pm\_allocrow(pbm\_packed\_bytes(cols),\ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sizeof(unsigned\ char)))}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#define\ pbm\_freerow\_packed(packed\_bits)\ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\ \ pm\_freerow((char\ *)\ packed\_bits)}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\#define\ pbm\_allocarray\_packed(cols,\ rows)\ ((unsigned\ char\ **)\ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pm\_allocarray(pbm\_packed\_bytes(cols),\ rows,\ sizeof(unsigned\ char)))}}
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#define\ pbm\_freearray\_packed(packed\_bits,\ rows)\ \(\backslash\)}}
\DoxyCodeLine{00093\ \textcolor{preprocessor}{\ \ pm\_freearray((char\ **)\ packed\_bits,\ rows)}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{preprocessor}{\#define\ pgm\_allocarray(\ cols,\ rows\ )\ ((gray**)\ pm\_allocarray(\ cols,\ rows,\ sizeof(gray)\ ))}}
\DoxyCodeLine{00096\ \textcolor{preprocessor}{\#define\ pgm\_allocrow(\ cols\ )\ ((gray*)\ pm\_allocrow(\ cols,\ sizeof(gray)\ ))}}
\DoxyCodeLine{00097\ \textcolor{preprocessor}{\#define\ pgm\_freearray(\ grays,\ rows\ )\ pm\_freearray(\ (char**)\ grays,\ rows\ )}}
\DoxyCodeLine{00098\ \textcolor{preprocessor}{\#define\ pgm\_freerow(\ grayrow\ )\ pm\_freerow(\ (char*)\ grayrow\ )}}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \textcolor{preprocessor}{\#define\ ppm\_allocarray(\ cols,\ rows\ )\ ((pixel**)\ pm\_allocarray(\ cols,\ rows,\ sizeof(pixel)\ ))}}
\DoxyCodeLine{00101\ \textcolor{preprocessor}{\#define\ ppm\_allocrow(\ cols\ )\ ((pixel*)\ pm\_allocrow(\ cols,\ sizeof(pixel)\ ))}}
\DoxyCodeLine{00102\ \textcolor{preprocessor}{\#define\ ppm\_freearray(\ pixels,\ rows\ )\ pm\_freearray(\ (char**)\ pixels,\ rows\ )}}
\DoxyCodeLine{00103\ \textcolor{preprocessor}{\#define\ ppm\_freerow(\ pixelrow\ )\ pm\_freerow(\ (char*)\ pixelrow\ )}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ pm\_plain\_output\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00107\ \textcolor{comment}{//\ Some\ functions\ lifted\ from\ Netpbm\ and\ adapted\ to\ use\ C++\ iostreams.}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{char}**}
\DoxyCodeLine{00111\ pm\_allocarray(\textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ cols,\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ rows,\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ size\ )\ \ \{}
\DoxyCodeLine{00112\ \ \ \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00113\ \textcolor{comment}{\ \ \ \ Allocate\ an\ array\ of\ 'rows'\ rows\ of\ 'cols'\ columns\ each,\ with\ each}}
\DoxyCodeLine{00114\ \textcolor{comment}{\ \ \ \ element\ 'size'\ bytes.}}
\DoxyCodeLine{00115\ \textcolor{comment}{}}
\DoxyCodeLine{00116\ \textcolor{comment}{\ \ \ \ We\ use\ a\ special\ format\ where\ we\ tack\ on\ an\ extra\ element\ to\ the\ row}}
\DoxyCodeLine{00117\ \textcolor{comment}{\ \ \ \ index\ to\ indicate\ the\ format\ of\ the\ array.}}
\DoxyCodeLine{00118\ \textcolor{comment}{}}
\DoxyCodeLine{00119\ \textcolor{comment}{\ \ \ \ We\ have\ two\ ways\ of\ allocating\ the\ space:\ fragmented\ and}}
\DoxyCodeLine{00120\ \textcolor{comment}{\ \ \ \ unfragmented.\ \ In\ both,\ the\ row\ index\ (plus\ the\ extra\ element)\ is}}
\DoxyCodeLine{00121\ \textcolor{comment}{\ \ \ \ in\ one\ block\ of\ memory.\ \ In\ the\ fragmented\ format,\ each\ row\ is}}
\DoxyCodeLine{00122\ \textcolor{comment}{\ \ \ \ also\ in\ an\ independent\ memory\ block,\ and\ the\ extra\ row\ pointer\ is}}
\DoxyCodeLine{00123\ \textcolor{comment}{\ \ \ \ NULL.\ \ In\ the\ unfragmented\ format,\ all\ the\ rows\ are\ in\ a\ single}}
\DoxyCodeLine{00124\ \textcolor{comment}{\ \ \ \ block\ of\ memory\ called\ the\ row\ heap\ and\ the\ extra\ row\ pointer\ is}}
\DoxyCodeLine{00125\ \textcolor{comment}{\ \ \ \ the\ address\ of\ that\ block.}}
\DoxyCodeLine{00126\ \textcolor{comment}{}}
\DoxyCodeLine{00127\ \textcolor{comment}{\ \ \ \ We\ use\ unfragmented\ format\ if\ possible,\ but\ if\ the\ allocation\ of\ the}}
\DoxyCodeLine{00128\ \textcolor{comment}{\ \ \ \ row\ heap\ fails,\ we\ fall\ back\ to\ fragmented.}}
\DoxyCodeLine{00129\ \textcolor{comment}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00130\ \ \ \textcolor{keywordtype}{char}**\ rowIndex;}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordtype}{char}\ *\ rowheap;}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ rowIndex\ =\ (\textcolor{keywordtype}{char}\ **)PANDA\_MALLOC\_ARRAY((rows\ +\ 1)\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}\ *));}
\DoxyCodeLine{00134\ \ \ \textcolor{keywordflow}{if}\ (\ rowIndex\ ==\ \textcolor{keyword}{nullptr}\ )}
\DoxyCodeLine{00135\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}out\ of\ memory\ allocating\ row\ index\ (\%u\ rows)\ for\ an\ array"{}},}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ rows);}
\DoxyCodeLine{00137\ \ \ rowheap\ =\ (\textcolor{keywordtype}{char}\ *)PANDA\_MALLOC\_ARRAY(\ rows\ *\ cols\ *\ size\ );}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{if}\ (\ rowheap\ ==\ \textcolor{keyword}{nullptr}\ )\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{comment}{/*\ We\ couldn't\ get\ the\ whole\ heap\ in\ one\ block,\ so\ try\ fragmented}}
\DoxyCodeLine{00140\ \textcolor{comment}{\ \ \ \ \ \ \ format.}}
\DoxyCodeLine{00141\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{keywordtype}{int}\ row;}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \ \ rowIndex[rows]\ =\ \textcolor{keyword}{nullptr};\ \ \ \textcolor{comment}{/*\ Declare\ it\ fragmented\ format\ */}}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{for}\ (row\ =\ 0;\ row\ <\ rows;\ ++row)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ rowIndex[row]\ =\ \mbox{\hyperlink{pnmimage__base_8cxx_a25394444a98c0d706f0b1d3ff528ebcb}{pm\_allocrow}}(cols,\ size);}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (rowIndex[row]\ ==\ \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}out\ of\ memory\ allocating\ Row\ \%u\ "{}}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(\%u\ columns,\ \%u\ bytes\ per\ tuple)\ "{}}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}of\ an\ array"{}},\ row,\ cols,\ size);}
\DoxyCodeLine{00152\ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00154\ \ \ \ \ \textcolor{comment}{/*\ It's\ unfragmented\ format\ */}}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordtype}{int}\ row;}
\DoxyCodeLine{00156\ \ \ \ \ rowIndex[rows]\ =\ rowheap;\ \ \textcolor{comment}{/*\ Declare\ it\ unfragmented\ format\ */}}
\DoxyCodeLine{00157\ }
\DoxyCodeLine{00158\ \ \ \ \ \textcolor{keywordflow}{for}\ (row\ =\ 0;\ row\ <\ rows;\ ++row)}
\DoxyCodeLine{00159\ \ \ \ \ \ \ rowIndex[row]\ =\ \&(rowheap[row\ *\ cols\ *\ size]);}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ \ \ \textcolor{keywordflow}{return}\ rowIndex;}
\DoxyCodeLine{00162\ \}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00165\ pm\_freearray(\textcolor{keywordtype}{char}\ **\ \textcolor{keyword}{const}\ rowIndex,}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \textcolor{keyword}{const}\ rows)\ \{}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00168\ \ \ \textcolor{keywordtype}{void}\ *\ \textcolor{keyword}{const}\ rowheap\ =\ rowIndex[rows];}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{if}\ (rowheap\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00171\ \ \ \ \ PANDA\_FREE\_ARRAY(rowheap);}
\DoxyCodeLine{00172\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00173\ \ \ \ \ \textcolor{keywordtype}{int}\ row;}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordflow}{for}\ (row\ =\ 0;\ row\ <\ rows;\ ++row)\ \{}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a76da6b18632c647228fbd452db5d0825}{pm\_freerow}}(rowIndex[row]);}
\DoxyCodeLine{00176\ \ \ \ \ \}}
\DoxyCodeLine{00177\ \ \ \}}
\DoxyCodeLine{00178\ \ \ PANDA\_FREE\_ARRAY(rowIndex);}
\DoxyCodeLine{00179\ \}}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}}
\DoxyCodeLine{00182\ pm\_getuint(istream\ *\ \textcolor{keyword}{const}\ ifP)\ \{}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00184\ \textcolor{comment}{\ \ \ \ Read\ an\ unsigned\ integer\ in\ ASCII\ decimal\ from\ the\ file\ stream}}
\DoxyCodeLine{00185\ \textcolor{comment}{\ \ \ \ represented\ by\ 'ifP'\ and\ return\ its\ value.}}
\DoxyCodeLine{00186\ \textcolor{comment}{}}
\DoxyCodeLine{00187\ \textcolor{comment}{\ \ \ \ If\ there\ is\ nothing\ at\ the\ current\ position\ in\ the\ file\ stream\ that}}
\DoxyCodeLine{00188\ \textcolor{comment}{\ \ \ \ can\ be\ interpreted\ as\ an\ unsigned\ integer,\ issue\ an\ error\ message}}
\DoxyCodeLine{00189\ \textcolor{comment}{\ \ \ \ to\ stderr\ and\ abort\ the\ program.}}
\DoxyCodeLine{00190\ \textcolor{comment}{}}
\DoxyCodeLine{00191\ \textcolor{comment}{\ \ \ \ If\ the\ number\ at\ the\ current\ position\ in\ the\ file\ stream\ is\ too}}
\DoxyCodeLine{00192\ \textcolor{comment}{\ \ \ \ great\ to\ be\ represented\ by\ an\ 'int'\ (Yes,\ I\ said\ 'int',\ not}}
\DoxyCodeLine{00193\ \textcolor{comment}{\ \ \ \ 'unsigned\ int'),\ issue\ an\ error\ message\ to\ stderr\ and\ abort\ the}}
\DoxyCodeLine{00194\ \textcolor{comment}{\ \ \ \ program.}}
\DoxyCodeLine{00195\ \textcolor{comment}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00196\ \ \ \textcolor{keywordtype}{int}\ ch;}
\DoxyCodeLine{00197\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ i;}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\ skip\ whitespace}}
\DoxyCodeLine{00200\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00201\ \ \ \ \ ch\ =\ ifP-\/>get();}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ ==\ \textcolor{charliteral}{'\#'})\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{comment}{//\ Skip\ a\ comment}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ ch\ =\ ifP-\/>get();}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{while}\ (ch\ !=\ EOF\ \&\&\ ch\ !=\ \textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{00208\ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \}\ \textcolor{keywordflow}{while}\ (ch\ ==\ \textcolor{charliteral}{'\ '}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)t'}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)n'}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)r'});}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \textcolor{keywordflow}{if}\ (ch\ <\ \textcolor{charliteral}{'0'}\ ||\ ch\ >\ \textcolor{charliteral}{'9'})}
\DoxyCodeLine{00212\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}junk\ in\ file\ where\ an\ unsigned\ integer\ should\ be"{}});}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ i\ =\ 0;}
\DoxyCodeLine{00215\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00216\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ digitVal\ =\ ch\ -\/\ \textcolor{charliteral}{'0'};}
\DoxyCodeLine{00217\ }
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ >\ INT\_MAX/10\ -\/\ digitVal)}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}ASCII\ decimal\ integer\ in\ file\ is\ "{}}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}too\ large\ to\ be\ processed.\ \ "{}});}
\DoxyCodeLine{00221\ \ \ \ \ i\ =\ i\ *\ 10\ +\ digitVal;}
\DoxyCodeLine{00222\ \ \ \ \ ch\ =\ ifP-\/>get();}
\DoxyCodeLine{00223\ \ \ \}\ \textcolor{keywordflow}{while}\ (ch\ >=\ \textcolor{charliteral}{'0'}\ \&\&\ ch\ <=\ \textcolor{charliteral}{'9'});}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordflow}{return}\ i;}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00229\ ppm\_readppminitrest(istream\ *\ \ \ \textcolor{keyword}{const}\ file,}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ \ \ \ \textcolor{keyword}{const}\ colsP,}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ \ \ \ \textcolor{keyword}{const}\ rowsP,}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixval\ *\ \textcolor{keyword}{const}\ maxvalP)\ \{}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ maxval;}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \textcolor{comment}{/*\ Read\ size.\ */}}
\DoxyCodeLine{00236\ \ \ *colsP\ =\ (int)pm\_getuint(file);}
\DoxyCodeLine{00237\ \ \ *rowsP\ =\ (int)pm\_getuint(file);}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \textcolor{comment}{/*\ Read\ maxval.\ */}}
\DoxyCodeLine{00240\ \ \ maxval\ =\ pm\_getuint(file);}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{if}\ (maxval\ >\ PPM\_OVERALLMAXVAL)}
\DoxyCodeLine{00242\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}maxval\ of\ input\ image\ (\%u)\ is\ too\ large.\ \ "{}}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ maximum\ allowed\ by\ the\ PPM\ is\ \%u."{}},}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ maxval,\ PPM\_OVERALLMAXVAL);}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{if}\ (maxval\ ==\ 0)}
\DoxyCodeLine{00246\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}maxval\ of\ input\ image\ is\ zero."{}});}
\DoxyCodeLine{00247\ }
\DoxyCodeLine{00248\ \ \ *maxvalP\ =\ maxval;}
\DoxyCodeLine{00249\ \}}
\DoxyCodeLine{00250\ }
\DoxyCodeLine{00251\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00252\ pgm\_readpgminitrest(istream\ *\ \textcolor{keyword}{const}\ file,}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ \ \textcolor{keyword}{const}\ colsP,}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ \ \textcolor{keyword}{const}\ rowsP,}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray\ *\ \textcolor{keyword}{const}\ maxvalP)\ \{}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ gray\ maxval;}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{comment}{/*\ Read\ size.\ */}}
\DoxyCodeLine{00260\ \ \ *colsP\ =\ (int)pm\_getuint(file);}
\DoxyCodeLine{00261\ \ \ *rowsP\ =\ (int)pm\_getuint(file);}
\DoxyCodeLine{00262\ }
\DoxyCodeLine{00263\ \ \ \textcolor{comment}{/*\ Read\ maxval.\ */}}
\DoxyCodeLine{00264\ \ \ maxval\ =\ pm\_getuint(file);}
\DoxyCodeLine{00265\ \ \ \textcolor{keywordflow}{if}\ (maxval\ >\ PGM\_OVERALLMAXVAL)}
\DoxyCodeLine{00266\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}maxval\ of\ input\ image\ (\%u)\ is\ too\ large.\ \ "{}}}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ maximum\ allowed\ by\ PGM\ is\ \%u."{}},}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ maxval,\ PGM\_OVERALLMAXVAL);}
\DoxyCodeLine{00269\ \ \ \textcolor{keywordflow}{if}\ (maxval\ ==\ 0)}
\DoxyCodeLine{00270\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}maxval\ of\ input\ image\ is\ zero."{}});}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ *maxvalP\ =\ maxval;}
\DoxyCodeLine{00273\ \}}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00276\ pbm\_readpbminitrest(istream*\ file,}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}*\ colsP,}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}*\ rowsP)\ \{}
\DoxyCodeLine{00279\ \ \ \textcolor{comment}{/*\ Read\ size.\ */}}
\DoxyCodeLine{00280\ \ \ *colsP\ =\ (int)pm\_getuint(\ file\ );}
\DoxyCodeLine{00281\ \ \ *rowsP\ =\ (int)pm\_getuint(\ file\ );}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \textcolor{comment}{/*\ *colsP\ and\ *rowsP\ really\ should\ be\ unsigned\ int,\ but\ they\ come}}
\DoxyCodeLine{00284\ \textcolor{comment}{\ \ \ \ \ from\ the\ time\ before\ unsigned\ ints\ (or\ at\ least\ from\ a\ person}}
\DoxyCodeLine{00285\ \textcolor{comment}{\ \ \ \ \ trained\ in\ that\ tradition),\ so\ they\ are\ int.\ \ We\ could\ simply}}
\DoxyCodeLine{00286\ \textcolor{comment}{\ \ \ \ \ consider\ negative\ numbers\ to\ mean\ values\ >\ INT\_MAX/2\ and\ much}}
\DoxyCodeLine{00287\ \textcolor{comment}{\ \ \ \ \ code\ would\ just\ automatically\ work.\ \ But\ some\ code\ would\ fail}}
\DoxyCodeLine{00288\ \textcolor{comment}{\ \ \ \ \ miserably.\ \ So\ we\ consider\ values\ that\ won't\ fit\ in\ an\ int\ to}}
\DoxyCodeLine{00289\ \textcolor{comment}{\ \ \ \ \ be\ unprocessable.}}
\DoxyCodeLine{00290\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00291\ \ \ \textcolor{keywordflow}{if}\ (*colsP\ <\ 0)}
\DoxyCodeLine{00292\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}Number\ of\ columns\ in\ header\ is\ too\ large."{}});}
\DoxyCodeLine{00293\ \ \ \textcolor{keywordflow}{if}\ (*rowsP\ <\ 0)}
\DoxyCodeLine{00294\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}Number\ of\ columns\ in\ header\ is\ too\ large."{}});}
\DoxyCodeLine{00295\ \}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}}
\DoxyCodeLine{00298\ pm\_getrawbyte(istream\ *\ \textcolor{keyword}{const}\ file)\ \{}
\DoxyCodeLine{00299\ \ \ \textcolor{keywordtype}{int}\ iby;}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ iby\ =\ file-\/>get();}
\DoxyCodeLine{00302\ \ \ \textcolor{keywordflow}{if}\ (iby\ ==\ EOF)}
\DoxyCodeLine{00303\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}EOF\ /\ read\ error\ reading\ a\ one-\/byte\ sample"{}});}
\DoxyCodeLine{00304\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\ iby;}
\DoxyCodeLine{00305\ \}}
\DoxyCodeLine{00306\ }
\DoxyCodeLine{00307\ \textcolor{keyword}{static}\ bit}
\DoxyCodeLine{00308\ getbit\ (istream\ *\ \textcolor{keyword}{const}\ file)\ \{}
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{char}\ ch;}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{00312\ \ \ \ \ ch\ =\ file-\/>get();}
\DoxyCodeLine{00313\ \ \ \}\ \textcolor{keywordflow}{while}\ (\ ch\ ==\ \textcolor{charliteral}{'\ '}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)t'}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)n'}\ ||\ ch\ ==\ \textcolor{charliteral}{'\(\backslash\)r'}\ );}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \textcolor{keywordflow}{if}\ (\ ch\ !=\ \textcolor{charliteral}{'0'}\ \&\&\ ch\ !=\ \textcolor{charliteral}{'1'}\ )}
\DoxyCodeLine{00316\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}junk\ in\ file\ where\ bits\ should\ be"{}}\ );}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \textcolor{keywordflow}{return}\ (\ ch\ ==\ \textcolor{charliteral}{'1'}\ )\ ?\ 1\ :\ 0;}
\DoxyCodeLine{00319\ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00322\ pbm\_readpbmrow(\ istream\ *file,\ bit\ *bitrow,\ \textcolor{keywordtype}{int}\ cols,\ \textcolor{keywordtype}{int}\ format\ )\ \{}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordtype}{int}\ col,\ bitshift;}
\DoxyCodeLine{00324\ \ \ bit*\ bP;}
\DoxyCodeLine{00325\ }
\DoxyCodeLine{00326\ \ \ \textcolor{keywordflow}{switch}\ (\ format\ )}
\DoxyCodeLine{00327\ \ \ \ \ \{}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordflow}{case}\ PBM\_FORMAT:}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0,\ bP\ =\ bitrow;\ col\ <\ cols;\ ++col,\ ++bP\ )}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ *bP\ =\ getbit(\ file\ );}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00332\ }
\DoxyCodeLine{00333\ \ \ \ \ \textcolor{keywordflow}{case}\ RPBM\_FORMAT:\ \{}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ item;}
\DoxyCodeLine{00335\ \ \ \ \ \ \ bitshift\ =\ -\/1;\ \ item\ =\ 0;\ \ \textcolor{comment}{/*\ item's\ value\ is\ meaningless\ here\ */}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0,\ bP\ =\ bitrow;\ col\ <\ cols;\ ++col,\ ++bP\ )}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ bitshift\ ==\ -\/1\ )}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ item\ =\ pm\_getrawbyte(\ file\ );}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bitshift\ =\ 7;}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ *bP\ =\ (\ item\ >>\ bitshift\ )\ \&\ 1;}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ -\/-\/bitshift;}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00346\ \ \ \ \ \}}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}can't\ happen"{}}\ );}
\DoxyCodeLine{00351\ \ \ \ \ \}}
\DoxyCodeLine{00352\ \}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \textcolor{keyword}{static}\ gray}
\DoxyCodeLine{00355\ pgm\_getrawsample(istream\ *\ \textcolor{keyword}{const}\ file,\ gray\ \textcolor{keyword}{const}\ maxval)\ \{}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \textcolor{keywordflow}{if}\ (maxval\ <\ 256)\ \{}
\DoxyCodeLine{00358\ \ \ \ \ \textcolor{comment}{/*\ The\ sample\ is\ just\ one\ byte.\ \ Read\ it.\ */}}
\DoxyCodeLine{00359\ \ \ \ \ \textcolor{keywordflow}{return}(pm\_getrawbyte(file));}
\DoxyCodeLine{00360\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{comment}{/*\ The\ sample\ is\ two\ bytes.\ \ Read\ both.\ */}}
\DoxyCodeLine{00362\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ byte\_pair[2];}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ pairs\_read;}
\DoxyCodeLine{00364\ }
\DoxyCodeLine{00365\ \ \ \ \ file-\/>read((\textcolor{keywordtype}{char}\ *)byte\_pair,\ 2);}
\DoxyCodeLine{00366\ \ \ \ \ pairs\_read\ =\ file-\/>gcount();}
\DoxyCodeLine{00367\ \ \ \ \ \textcolor{keywordflow}{if}\ (pairs\_read\ ==\ 0)}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}EOF\ /read\ error\ while\ reading\ a\ long\ sample"{}});}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{comment}{/*\ This\ could\ be\ a\ few\ instructions\ faster\ if\ exploited\ the\ internal}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ \ \ \ \ \ format\ (i.e.\ endianness)\ of\ a\ pixval.\ \ Then\ we\ might\ be\ able\ to}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ \ \ \ \ skip\ the\ shifting\ and\ oring.}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00373\ \ \ \ \ \textcolor{keywordflow}{return}((byte\_pair[0]<<8)\ |\ byte\_pair[1]);}
\DoxyCodeLine{00374\ \ \ \}}
\DoxyCodeLine{00375\ \}}
\DoxyCodeLine{00376\ }
\DoxyCodeLine{00377\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00378\ pgm\_readpgmrow(istream*\ \textcolor{keyword}{const}\ file,\ gray*\ \textcolor{keyword}{const}\ grayrow,}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ cols,\ gray\ \textcolor{keyword}{const}\ maxval,\ \textcolor{keywordtype}{int}\ \textcolor{keyword}{const}\ format)\ \{}
\DoxyCodeLine{00380\ }
\DoxyCodeLine{00381\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{case}\ PGM\_FORMAT:\ \{}
\DoxyCodeLine{00383\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00385\ \ \ \ \ \ \ grayrow[col]\ =\ pm\_getuint(file);}
\DoxyCodeLine{00386\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grayrow[col]\ >\ maxval)}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grayrow[col],\ maxval\ );}
\DoxyCodeLine{00390\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00391\ \ \ \ \ \}}
\DoxyCodeLine{00392\ \ \ \}}
\DoxyCodeLine{00393\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \ \textcolor{keywordflow}{case}\ RPGM\_FORMAT:\ \{}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00397\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00398\ \ \ \ \ \ \ grayrow[col]\ =\ pgm\_getrawsample(\ file,\ maxval\ );}
\DoxyCodeLine{00399\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ grayrow[col]\ >\ maxval\ )}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grayrow[col],\ maxval\ );}
\DoxyCodeLine{00403\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00404\ \ \ \ \ \}}
\DoxyCodeLine{00405\ \ \ \}}
\DoxyCodeLine{00406\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00407\ }
\DoxyCodeLine{00408\ \ \ \textcolor{keywordflow}{case}\ PBM\_FORMAT:}
\DoxyCodeLine{00409\ \ \ \textcolor{keywordflow}{case}\ RPBM\_FORMAT:}
\DoxyCodeLine{00410\ \ \ \ \ \{}
\DoxyCodeLine{00411\ \ \ \ \ \ \ bit\ *\ bitrow;}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \ \ \ \ bitrow\ =\ pbm\_allocrow(cols);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ pbm\_readpbmrow(\ file,\ bitrow,\ cols,\ format\ );}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ grayrow[col]\ =\ (bitrow[col]\ ==\ PBM\_WHITE\ )\ ?\ maxval\ :\ 0;}
\DoxyCodeLine{00418\ \ \ \ \ \ \ pbm\_freerow(bitrow);}
\DoxyCodeLine{00419\ \ \ \ \ \}}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00421\ }
\DoxyCodeLine{00422\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00423\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}can't\ happen"{}}\ );}
\DoxyCodeLine{00424\ \ \ \}}
\DoxyCodeLine{00425\ \}}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00428\ ppm\_readppmrow(istream*\ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{pixel}}*\ \textcolor{keyword}{const}\ pixelrow,}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ format)\ \{}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{switch}\ (format)\ \{}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{case}\ PPM\_FORMAT:\ \{}
\DoxyCodeLine{00436\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00438\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ r\ =\ pm\_getuint(fileP);}
\DoxyCodeLine{00439\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ g\ =\ pm\_getuint(fileP);}
\DoxyCodeLine{00440\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ b\ =\ pm\_getuint(fileP);}
\DoxyCodeLine{00441\ \ \ \ \ \ \ PPM\_ASSIGN(pixelrow[col],\ r,\ g,\ b);}
\DoxyCodeLine{00442\ \ \ \ \ \}}
\DoxyCodeLine{00443\ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00445\ }
\DoxyCodeLine{00446\ \ \ \textcolor{keywordflow}{case}\ RPPM\_FORMAT:\ \{}
\DoxyCodeLine{00447\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00448\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00449\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ r\ =\ pgm\_getrawsample(fileP,\ maxval);}
\DoxyCodeLine{00450\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ g\ =\ pgm\_getrawsample(fileP,\ maxval);}
\DoxyCodeLine{00451\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ b\ =\ pgm\_getrawsample(fileP,\ maxval);}
\DoxyCodeLine{00452\ \ \ \ \ \ \ PPM\_ASSIGN(pixelrow[col],\ r,\ g,\ b);}
\DoxyCodeLine{00453\ \ \ \ \ \}}
\DoxyCodeLine{00454\ \ \ \}}
\DoxyCodeLine{00455\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{case}\ PGM\_FORMAT:}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{case}\ RPGM\_FORMAT:\ \{}
\DoxyCodeLine{00459\ \ \ \ \ gray\ *\ \textcolor{keyword}{const}\ grayrow\ =\ pgm\_allocrow(cols);}
\DoxyCodeLine{00460\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00461\ }
\DoxyCodeLine{00462\ \ \ \ \ pgm\_readpgmrow(fileP,\ grayrow,\ cols,\ maxval,\ format);}
\DoxyCodeLine{00463\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00464\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ g\ =\ grayrow[col];}
\DoxyCodeLine{00465\ \ \ \ \ \ \ PPM\_ASSIGN(pixelrow[col],\ g,\ g,\ g);}
\DoxyCodeLine{00466\ \ \ \ \ \}}
\DoxyCodeLine{00467\ \ \ \ \ pgm\_freerow(grayrow);}
\DoxyCodeLine{00468\ \ \ \}}
\DoxyCodeLine{00469\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00470\ }
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{case}\ PBM\_FORMAT:}
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{case}\ RPBM\_FORMAT:\ \{}
\DoxyCodeLine{00473\ \ \ \ \ bit\ *\ \textcolor{keyword}{const}\ bitrow\ =\ pbm\_allocrow(cols);}
\DoxyCodeLine{00474\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00475\ }
\DoxyCodeLine{00476\ \ \ \ \ pbm\_readpbmrow(fileP,\ bitrow,\ cols,\ format);}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00478\ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ g\ =\ (bitrow[col]\ ==\ PBM\_WHITE)\ ?\ maxval\ :\ 0;}
\DoxyCodeLine{00479\ \ \ \ \ \ \ PPM\_ASSIGN(pixelrow[col],\ g,\ g,\ g);}
\DoxyCodeLine{00480\ \ \ \ \ \}}
\DoxyCodeLine{00481\ \ \ \ \ pbm\_freerow(bitrow);}
\DoxyCodeLine{00482\ \ \ \}}
\DoxyCodeLine{00483\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00484\ }
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00486\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}Invalid\ format\ code"{}});}
\DoxyCodeLine{00487\ \ \ \}}
\DoxyCodeLine{00488\ \}}
\DoxyCodeLine{00489\ }
\DoxyCodeLine{00490\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00491\ pnm\_readpnmrow(\ istream*\ file,\ \mbox{\hyperlink{structpixel}{xel}}*\ xelrow,\ \textcolor{keywordtype}{int}\ cols,\ xelval\ maxval,\ \textcolor{keywordtype}{int}\ format\ )\ \{}
\DoxyCodeLine{00492\ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00493\ \ \ \mbox{\hyperlink{structpixel}{xel}}*\ xP;}
\DoxyCodeLine{00494\ \ \ gray*\ grayrow;}
\DoxyCodeLine{00495\ \ \ gray*\ gP;}
\DoxyCodeLine{00496\ \ \ bit*\ bitrow;}
\DoxyCodeLine{00497\ \ \ bit*\ bP;}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \textcolor{keywordflow}{switch}\ (\ PNM\_FORMAT\_TYPE(format)\ )}
\DoxyCodeLine{00500\ \ \ \ \ \{}
\DoxyCodeLine{00501\ \ \ \ \ \textcolor{keywordflow}{case}\ PPM\_TYPE:}
\DoxyCodeLine{00502\ \ \ \ \ \ \ ppm\_readppmrow(\ file,\ (\mbox{\hyperlink{structpixel}{pixel}}*)\ xelrow,\ cols,\ (pixval)\ maxval,\ format\ );}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \ \ \textcolor{keywordflow}{case}\ PGM\_TYPE:}
\DoxyCodeLine{00506\ \ \ \ \ \ \ grayrow\ =\ pgm\_allocrow(\ cols\ );}
\DoxyCodeLine{00507\ \ \ \ \ \ \ pgm\_readpgmrow(\ file,\ grayrow,\ cols,\ (gray)\ maxval,\ format\ );}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0,\ xP\ =\ xelrow,\ gP\ =\ grayrow;\ col\ <\ cols;\ ++col,\ ++xP,\ ++gP\ )}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ PNM\_ASSIGN1(\ *xP,\ *gP\ );}
\DoxyCodeLine{00510\ \ \ \ \ \ \ pgm\_freerow(\ grayrow\ );}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00513\ \ \ \ \ \textcolor{keywordflow}{case}\ PBM\_TYPE:}
\DoxyCodeLine{00514\ \ \ \ \ \ \ bitrow\ =\ pbm\_allocrow(\ cols\ );}
\DoxyCodeLine{00515\ \ \ \ \ \ \ pbm\_readpbmrow(\ file,\ bitrow,\ cols,\ format\ );}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0,\ xP\ =\ xelrow,\ bP\ =\ bitrow;\ col\ <\ cols;\ ++col,\ ++xP,\ ++bP\ )}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ PNM\_ASSIGN1(\ *xP,\ *bP\ ==\ PBM\_BLACK\ ?\ 0:\ maxval\ );}
\DoxyCodeLine{00518\ \ \ \ \ \ \ pbm\_freerow(\ bitrow\ );}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00520\ }
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00522\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}can't\ happen"{}}\ );}
\DoxyCodeLine{00523\ \ \ \ \ \}}
\DoxyCodeLine{00524\ \}}
\DoxyCodeLine{00525\ }
\DoxyCodeLine{00526\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00527\ pbm\_writepbminit(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ rows,}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{if}\ (!forceplain\ \&\&\ !pm\_plain\_output)\ \{}
\DoxyCodeLine{00533\ \ \ \ \ (*fileP)}
\DoxyCodeLine{00534\ \ \ \ \ \ \ <<\ (char)PBM\_MAGIC1}
\DoxyCodeLine{00535\ \ \ \ \ \ \ <<\ (\textcolor{keywordtype}{char})RPBM\_MAGIC2}
\DoxyCodeLine{00536\ \ \ \ \ \ \ <<\ \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{00537\ \ \ \ \ \ \ <<\ cols\ <<\ \textcolor{charliteral}{'\ '}\ <<\ rows\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00538\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00539\ \ \ \ \ (*fileP)}
\DoxyCodeLine{00540\ \ \ \ \ \ \ <<\ (char)PBM\_MAGIC1}
\DoxyCodeLine{00541\ \ \ \ \ \ \ <<\ (\textcolor{keywordtype}{char})PBM\_MAGIC2}
\DoxyCodeLine{00542\ \ \ \ \ \ \ <<\ \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ <<\ cols\ <<\ \textcolor{charliteral}{'\ '}\ <<\ rows\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00544\ \ \ \}}
\DoxyCodeLine{00545\ \}}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00548\ pgm\_writepgminit(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ rows,}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray\ \ \ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00553\ }
\DoxyCodeLine{00554\ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ plainFormat\ =\ forceplain\ ||\ pm\_plain\_output;}
\DoxyCodeLine{00555\ }
\DoxyCodeLine{00556\ \ \ \textcolor{keywordflow}{if}\ (maxval\ >\ PGM\_OVERALLMAXVAL\ \&\&\ !plainFormat)}
\DoxyCodeLine{00557\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}too-\/large\ maxval\ passed\ to\ ppm\_writepgminit():\ \%d.\(\backslash\)n"{}}}
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Maximum\ allowed\ by\ the\ PGM\ format\ is\ \%d."{}},}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ \ \ \ \ \ maxval,\ PGM\_OVERALLMAXVAL);}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ (*fileP)}
\DoxyCodeLine{00562\ \ \ \ \ <<\ (char)PGM\_MAGIC1}
\DoxyCodeLine{00563\ \ \ \ \ <<\ (\textcolor{keywordtype}{char})(plainFormat\ \textcolor{comment}{/*||\ maxval\ >=\ 1<<16*/}\ ?\ PGM\_MAGIC2\ :\ RPGM\_MAGIC2)}
\DoxyCodeLine{00564\ \ \ \ \ <<\ \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{00565\ \ \ \ \ <<\ cols\ <<\ \textcolor{charliteral}{'\ '}\ <<\ rows\ <<\ \textcolor{charliteral}{'\(\backslash\)n'}\ <<\ maxval\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00566\ \}}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00569\ ppm\_writeppminit(ostream*\ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ rows,}
\DoxyCodeLine{00572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixval\ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00574\ }
\DoxyCodeLine{00575\ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ plainFormat\ =\ forceplain\ ||\ pm\_plain\_output;}
\DoxyCodeLine{00576\ }
\DoxyCodeLine{00577\ \ \ \textcolor{keywordflow}{if}\ (maxval\ >\ PPM\_OVERALLMAXVAL\ \&\&\ !plainFormat)}
\DoxyCodeLine{00578\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}too-\/large\ maxval\ passed\ to\ ppm\_writeppminit():\ \%d."{}}}
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Maximum\ allowed\ by\ the\ PPM\ format\ is\ \%d."{}},}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ \ \ \ \ \ maxval,\ PPM\_OVERALLMAXVAL);}
\DoxyCodeLine{00581\ }
\DoxyCodeLine{00582\ \ \ (*fileP)}
\DoxyCodeLine{00583\ \ \ \ \ <<\ (char)PPM\_MAGIC1}
\DoxyCodeLine{00584\ \ \ \ \ <<\ (\textcolor{keywordtype}{char})(plainFormat\ \textcolor{comment}{/*||\ maxval\ >=\ 1<<16*/}\ ?\ PPM\_MAGIC2\ :\ RPPM\_MAGIC2)}
\DoxyCodeLine{00585\ \ \ \ \ <<\ \textcolor{charliteral}{'\(\backslash\)n'}}
\DoxyCodeLine{00586\ \ \ \ \ <<\ cols\ <<\ \textcolor{charliteral}{'\ '}\ <<\ rows\ <<\ \textcolor{charliteral}{'\(\backslash\)n'}\ <<\ maxval\ <<\ \textcolor{charliteral}{'\(\backslash\)n'};}
\DoxyCodeLine{00587\ \}}
\DoxyCodeLine{00588\ }
\DoxyCodeLine{00589\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00590\ pnm\_writepnminit(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ rows,}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xelval\ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ format,}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00596\ }
\DoxyCodeLine{00597\ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ plainFormat\ =\ forceplain\ ||\ pm\_plain\_output;}
\DoxyCodeLine{00598\ }
\DoxyCodeLine{00599\ \ \ \textcolor{keywordflow}{switch}\ (PNM\_FORMAT\_TYPE(format))\ \{}
\DoxyCodeLine{00600\ \ \ \textcolor{keywordflow}{case}\ PPM\_TYPE:}
\DoxyCodeLine{00601\ \ \ \ \ ppm\_writeppminit(fileP,\ cols,\ rows,\ (pixval)\ maxval,\ plainFormat);}
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00603\ }
\DoxyCodeLine{00604\ \ \ \textcolor{keywordflow}{case}\ PGM\_TYPE:}
\DoxyCodeLine{00605\ \ \ \ \ pgm\_writepgminit(fileP,\ cols,\ rows,\ (gray)\ maxval,\ plainFormat);}
\DoxyCodeLine{00606\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \ \textcolor{keywordflow}{case}\ PBM\_TYPE:}
\DoxyCodeLine{00609\ \ \ \ \ pbm\_writepbminit(fileP,\ cols,\ rows,\ plainFormat);}
\DoxyCodeLine{00610\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00613\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}invalid\ format\ argument\ received\ by\ pnm\_writepnminit():\ \%d"{}}}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PNM\_FORMAT\_TYPE(format)\ must\ be\ \%d,\ \%d,\ or\ \%d"{}},}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ format,\ PBM\_TYPE,\ PGM\_TYPE,\ PPM\_TYPE);}
\DoxyCodeLine{00616\ \ \ \}}
\DoxyCodeLine{00617\ \}}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00620\ packBitsGeneric(ostream\ *\ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ bit\ *\ \ \ \ \ \textcolor{keyword}{const}\ bitrow,}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ packedBits,}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ nextColP)\ \{}
\DoxyCodeLine{00625\ \ \ \textcolor{comment}{/*-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{00626\ \textcolor{comment}{\ \ \ \ Pack\ the\ bits\ of\ bitrow[]\ into\ byts\ at\ 'packedBits'.\ \ Going\ left\ to\ right,}}
\DoxyCodeLine{00627\ \textcolor{comment}{\ \ \ \ stop\ when\ there\ aren't\ enough\ bits\ left\ to\ fill\ a\ whole\ byte.\ \ Return}}
\DoxyCodeLine{00628\ \textcolor{comment}{\ \ \ \ as\ *nextColP\ the\ number\ of\ the\ next\ column\ after\ the\ rightmost\ one\ we}}
\DoxyCodeLine{00629\ \textcolor{comment}{\ \ \ \ packed.}}
\DoxyCodeLine{00630\ \textcolor{comment}{}}
\DoxyCodeLine{00631\ \textcolor{comment}{\ \ \ \ Don't\ use\ any\ special\ CPU\ facilities\ to\ do\ the\ packing.}}
\DoxyCodeLine{00632\ \textcolor{comment}{\ \ \ \ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/*/}}
\DoxyCodeLine{00633\ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00634\ }
\DoxyCodeLine{00635\ \textcolor{preprocessor}{\#define\ iszero(x)\ ((x)\ ==\ 0\ ?\ 0\ :\ 1)}}
\DoxyCodeLine{00636\ }
\DoxyCodeLine{00637\ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ +\ 7\ <\ cols;\ col\ +=\ 8)}
\DoxyCodeLine{00638\ \ \ \ \ packedBits[col/8]\ =\ (}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+0])\ <<\ 7\ |}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+1])\ <<\ 6\ |}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+2])\ <<\ 5\ |}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+3])\ <<\ 4\ |}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+4])\ <<\ 3\ |}
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+5])\ <<\ 2\ |}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+6])\ <<\ 1\ |}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ iszero(bitrow[col+7])\ <<\ 0}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ );}
\DoxyCodeLine{00648\ \ \ *nextColP\ =\ col;}
\DoxyCodeLine{00649\ \}}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00652\ writePackedRawRow(ostream\ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ packed\_bits,}
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cols)\ \{}
\DoxyCodeLine{00655\ }
\DoxyCodeLine{00656\ \ \ fileP-\/>write((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)packed\_bits,\ pbm\_packed\_bytes(cols));}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{if}\ (fileP-\/>fail())\ \{}
\DoxyCodeLine{00658\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}I/O\ error\ writing\ packed\ row\ to\ raw\ PBM\ file."{}});}
\DoxyCodeLine{00659\ \ \ \}}
\DoxyCodeLine{00660\ \}}
\DoxyCodeLine{00661\ }
\DoxyCodeLine{00662\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00663\ writePbmRowRaw(ostream\ *\ \ \ \ \ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ bit\ *\ \textcolor{keyword}{const}\ bitrow,}
\DoxyCodeLine{00665\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ cols)\ \{}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \ \ \textcolor{keywordtype}{int}\ nextCol;}
\DoxyCodeLine{00668\ }
\DoxyCodeLine{00669\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ *\ \textcolor{keyword}{const}\ packedBits\ =\ pbm\_allocrow\_packed(cols);}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \ \ packBitsGeneric(fileP,\ bitrow,\ packedBits,\ cols,\ \&nextCol);}
\DoxyCodeLine{00672\ }
\DoxyCodeLine{00673\ \ \ \textcolor{comment}{/*\ routine\ for\ partial\ byte\ at\ the\ end\ of\ packed\_bits[]}}
\DoxyCodeLine{00674\ \textcolor{comment}{\ \ \ \ \ Prior\ to\ addition\ of\ the\ above\ enhancement,}}
\DoxyCodeLine{00675\ \textcolor{comment}{\ \ \ \ \ this\ method\ was\ used\ for\ the\ entire\ process}}
\DoxyCodeLine{00676\ \textcolor{comment}{\ \ */}}
\DoxyCodeLine{00677\ }
\DoxyCodeLine{00678\ \ \ \textcolor{keywordflow}{if}\ (cols\ \%\ 8\ >\ 0)\ \{}
\DoxyCodeLine{00679\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00680\ \ \ \ \ \textcolor{keywordtype}{int}\ bitshift;}
\DoxyCodeLine{00681\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ item;}
\DoxyCodeLine{00682\ }
\DoxyCodeLine{00683\ \ \ \ \ bitshift\ =\ 7;\ \ \textcolor{comment}{/*\ initial\ value\ */}}
\DoxyCodeLine{00684\ \ \ \ \ item\ =\ 0;\ \ \ \ \ \ \textcolor{comment}{/*\ initial\ value\ */}}
\DoxyCodeLine{00685\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ nextCol;\ col\ <\ cols;\ ++col,\ -\/-\/bitshift\ )}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bitrow[col]\ !=0)}
\DoxyCodeLine{00687\ \ \ \ \ \ \ \ \ item\ |=\ 1\ <<\ bitshift}
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \ \ ;}
\DoxyCodeLine{00689\ }
\DoxyCodeLine{00690\ \ \ \ \ packedBits[col/8]\ =\ item;}
\DoxyCodeLine{00691\ \ \ \}}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ writePackedRawRow(fileP,\ packedBits,\ cols);}
\DoxyCodeLine{00694\ }
\DoxyCodeLine{00695\ \ \ pbm\_freerow\_packed(packedBits);}
\DoxyCodeLine{00696\ \}}
\DoxyCodeLine{00697\ }
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ }
\DoxyCodeLine{00700\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00701\ writePbmRowPlain(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bit\ *\ \ \textcolor{keyword}{const}\ bitrow,}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols)\ \{}
\DoxyCodeLine{00704\ }
\DoxyCodeLine{00705\ \ \ \textcolor{keywordtype}{int}\ col,\ charcount;}
\DoxyCodeLine{00706\ }
\DoxyCodeLine{00707\ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00708\ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00709\ \ \ \ \ \textcolor{keywordflow}{if}\ (charcount\ >=\ 70)\ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ fileP-\/>put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{00711\ \ \ \ \ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00712\ \ \ \ \ \}}
\DoxyCodeLine{00713\ \ \ \ \ fileP-\/>put(bitrow[col]\ ?\ \textcolor{charliteral}{'1'}\ :\ \textcolor{stringliteral}{'0'});}
\DoxyCodeLine{00714\ \ \ \ \ ++charcount;}
\DoxyCodeLine{00715\ \ \ \}}
\DoxyCodeLine{00716\ \ \ fileP-\/>put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{00717\ \}}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00720\ pbm\_writepbmrow(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bit\ *\ \ \textcolor{keyword}{const}\ bitrow,}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00724\ }
\DoxyCodeLine{00725\ \ \ \textcolor{keywordflow}{if}\ (!forceplain\ \&\&\ !pm\_plain\_output)}
\DoxyCodeLine{00726\ \ \ \ \ writePbmRowRaw(fileP,\ bitrow,\ cols);}
\DoxyCodeLine{00727\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00728\ \ \ \ \ writePbmRowPlain(fileP,\ bitrow,\ cols);}
\DoxyCodeLine{00729\ \}}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00732\ pgm\_writerawsample(ostream\ *file,\ \textcolor{keyword}{const}\ gray\ val,\ \textcolor{keyword}{const}\ gray\ maxval)\ \{}
\DoxyCodeLine{00733\ }
\DoxyCodeLine{00734\ \ \ \textcolor{keywordflow}{if}\ (maxval\ <\ 256)\ \{}
\DoxyCodeLine{00735\ \ \ \ \ \textcolor{comment}{/*\ Samples\ fit\ in\ one\ byte,\ so\ write\ just\ one\ byte\ */}}
\DoxyCodeLine{00736\ \ \ \ \ file-\/>put(val);}
\DoxyCodeLine{00737\ \ \ \ \ \textcolor{keywordflow}{if}\ (file-\/>fail())}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}Error\ writing\ single\ byte\ sample\ to\ file"{}});}
\DoxyCodeLine{00739\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00740\ \ \ \ \ \textcolor{comment}{/*\ Samples\ are\ too\ big\ for\ one\ byte,\ so\ write\ two\ */}}
\DoxyCodeLine{00741\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ outval[2];}
\DoxyCodeLine{00742\ \ \ \ \ \textcolor{comment}{/*\ We\ could\ save\ a\ few\ instructions\ if\ we\ exploited\ the\ internal}}
\DoxyCodeLine{00743\ \textcolor{comment}{\ \ \ \ \ \ \ format\ of\ a\ gray,\ i.e.\ its\ endianness.\ \ Then\ we\ might\ be\ able}}
\DoxyCodeLine{00744\ \textcolor{comment}{\ \ \ \ \ \ \ to\ skip\ the\ shifting\ and\ anding.}}
\DoxyCodeLine{00745\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00746\ \ \ \ \ outval[0]\ =\ val\ >>\ 8;}
\DoxyCodeLine{00747\ \ \ \ \ outval[1]\ =\ val\ \&\ 0xFF;}
\DoxyCodeLine{00748\ \ \ \ \ file-\/>write((\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}\ *)outval,\ 2);}
\DoxyCodeLine{00749\ \ \ \ \ \textcolor{keywordflow}{if}\ (file-\/>fail())}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}Error\ writing\ double\ byte\ sample\ to\ file"{}});}
\DoxyCodeLine{00751\ \ \ \}}
\DoxyCodeLine{00752\ \}}
\DoxyCodeLine{00753\ }
\DoxyCodeLine{00754\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00755\ pgm\_writepgmrowraw(ostream\ *file,\ gray\ *grayrow,\ \textcolor{keywordtype}{int}\ cols,\ gray\ maxval\ )\ \{}
\DoxyCodeLine{00756\ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00757\ }
\DoxyCodeLine{00758\ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)\ \{}
\DoxyCodeLine{00759\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00760\ \ \ \ \ \textcolor{keywordflow}{if}\ (grayrow[col]\ >\ maxval)}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ grayrow[col],\ maxval);}
\DoxyCodeLine{00762\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00763\ \ \ \ \ pgm\_writerawsample(file,\ grayrow[col],\ maxval);}
\DoxyCodeLine{00764\ \ \ \}}
\DoxyCodeLine{00765\ \}}
\DoxyCodeLine{00766\ }
\DoxyCodeLine{00767\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00768\ putus(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \textcolor{keyword}{const}\ n,}
\DoxyCodeLine{00769\ \ \ \ \ \ \ ostream\ *\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ fileP)\ \{}
\DoxyCodeLine{00770\ }
\DoxyCodeLine{00771\ \ \ \textcolor{keywordflow}{if}\ (n\ >=\ 10)}
\DoxyCodeLine{00772\ \ \ \ \ putus(n\ /\ 10,\ fileP);}
\DoxyCodeLine{00773\ \ \ fileP-\/>put(n\ \%\ 10\ +\ \textcolor{charliteral}{'0'});}
\DoxyCodeLine{00774\ \}}
\DoxyCodeLine{00775\ }
\DoxyCodeLine{00776\ }
\DoxyCodeLine{00777\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00778\ pgm\_writepgmrowplain(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray\ *\ \textcolor{keyword}{const}\ grayrow,}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray\ \ \ \textcolor{keyword}{const}\ maxval)\ \{}
\DoxyCodeLine{00782\ }
\DoxyCodeLine{00783\ \ \ \textcolor{keywordtype}{int}\ col,\ charcount;}
\DoxyCodeLine{00784\ \ \ gray*\ gP;}
\DoxyCodeLine{00785\ }
\DoxyCodeLine{00786\ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00787\ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0,\ gP\ =\ grayrow;\ col\ <\ cols;\ ++col,\ ++gP)\ \{}
\DoxyCodeLine{00788\ \ \ \ \ \textcolor{keywordflow}{if}\ (charcount\ >=\ 65)\ \{}
\DoxyCodeLine{00789\ \ \ \ \ \ \ fileP-\/>put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{00790\ \ \ \ \ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00791\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (charcount\ >\ 0)\ \{}
\DoxyCodeLine{00792\ \ \ \ \ \ \ fileP-\/>put(\textcolor{charliteral}{'\ '});}
\DoxyCodeLine{00793\ \ \ \ \ \ \ ++charcount;}
\DoxyCodeLine{00794\ \ \ \ \ \}}
\DoxyCodeLine{00795\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00796\ \ \ \ \ \textcolor{keywordflow}{if}\ (*gP\ >\ maxval)}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ *gP,\ maxval);}
\DoxyCodeLine{00798\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00799\ \ \ \ \ putus((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short})*gP,\ fileP);}
\DoxyCodeLine{00800\ \ \ \ \ charcount\ +=\ 3;}
\DoxyCodeLine{00801\ \ \ \}}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordflow}{if}\ (charcount\ >\ 0)}
\DoxyCodeLine{00803\ \ \ \ \ fileP-\/>put(\textcolor{charliteral}{'\(\backslash\)n'});}
\DoxyCodeLine{00804\ \}}
\DoxyCodeLine{00805\ }
\DoxyCodeLine{00806\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00807\ pgm\_writepgmrow(ostream*\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray*\ \textcolor{keyword}{const}\ grayrow,}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ gray\ \ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \textcolor{keywordflow}{if}\ (forceplain\ ||\ pm\_plain\_output\ \textcolor{comment}{/*||\ maxval\ >=\ 1<<16*/})}
\DoxyCodeLine{00814\ \ \ \ \ pgm\_writepgmrowplain(fileP,\ grayrow,\ cols,\ maxval);}
\DoxyCodeLine{00815\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00816\ \ \ \ \ pgm\_writepgmrowraw(fileP,\ grayrow,\ cols,\ maxval);}
\DoxyCodeLine{00817\ \}}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00820\ ppm\_writeppmrowraw(ostream\ *file,\ \mbox{\hyperlink{structpixel}{pixel}}\ *pixelrow,\ \textcolor{keywordtype}{int}\ cols,\ pixval\ maxval\ )\ \{}
\DoxyCodeLine{00821\ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00822\ \ \ pixval\ val;}
\DoxyCodeLine{00823\ }
\DoxyCodeLine{00824\ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0;\ col\ <\ cols;\ ++col\ )}
\DoxyCodeLine{00825\ \ \ \ \ \{}
\DoxyCodeLine{00826\ \ \ \ \ \ \ val\ =\ PPM\_GETR(\ pixelrow[col]\ );}
\DoxyCodeLine{00827\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}r\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00830\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00831\ \ \ \ \ \ \ pgm\_writerawsample(\ file,\ val,\ maxval\ );}
\DoxyCodeLine{00832\ \ \ \ \ \ \ val\ =\ PPM\_GETG(\ pixelrow[col]\ );}
\DoxyCodeLine{00833\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00834\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}g\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00836\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00837\ \ \ \ \ \ \ pgm\_writerawsample(\ file,\ val,\ maxval\ );}
\DoxyCodeLine{00838\ \ \ \ \ \ \ val\ =\ PPM\_GETB(\ pixelrow[col]\ );}
\DoxyCodeLine{00839\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00841\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}b\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00842\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00843\ \ \ \ \ \ \ pgm\_writerawsample(\ file,\ val,\ maxval\ );}
\DoxyCodeLine{00844\ \ \ \ \ \}}
\DoxyCodeLine{00845\ \}}
\DoxyCodeLine{00846\ }
\DoxyCodeLine{00847\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00848\ ppm\_writeppmrowplain(ostream\ *file,\ \mbox{\hyperlink{structpixel}{pixel}}\ *pixelrow,\ \textcolor{keywordtype}{int}\ cols,\ pixval\ maxval\ )\ \{}
\DoxyCodeLine{00849\ \ \ \textcolor{keywordtype}{int}\ col,\ charcount;}
\DoxyCodeLine{00850\ \ \ \mbox{\hyperlink{structpixel}{pixel}}*\ pP;}
\DoxyCodeLine{00851\ \ \ pixval\ val;}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00854\ \ \ \textcolor{keywordflow}{for}\ (\ col\ =\ 0,\ pP\ =\ pixelrow;\ col\ <\ cols;\ ++col,\ ++pP\ )}
\DoxyCodeLine{00855\ \ \ \ \ \{}
\DoxyCodeLine{00856\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ charcount\ >=\ 65\ )}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\(\backslash\)n'}\ );}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ \ \ charcount\ =\ 0;}
\DoxyCodeLine{00860\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00861\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (\ charcount\ >\ 0\ )}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\ '}\ );}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\ '}\ );}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ charcount\ +=\ 2;}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00867\ \ \ \ \ \ \ val\ =\ PPM\_GETR(\ *pP\ );}
\DoxyCodeLine{00868\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00869\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00870\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}r\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00871\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00872\ \ \ \ \ \ \ putus(\ val,\ file\ );}
\DoxyCodeLine{00873\ \ \ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\ '}\ );}
\DoxyCodeLine{00874\ \ \ \ \ \ \ val\ =\ PPM\_GETG(\ *pP\ );}
\DoxyCodeLine{00875\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00876\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}g\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00878\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00879\ \ \ \ \ \ \ putus(\ val,\ file\ );}
\DoxyCodeLine{00880\ \ \ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\ '}\ );}
\DoxyCodeLine{00881\ \ \ \ \ \ \ val\ =\ PPM\_GETB(\ *pP\ );}
\DoxyCodeLine{00882\ \textcolor{preprocessor}{\#ifdef\ DEBUG}}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\ val\ >\ maxval\ )}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\ \textcolor{stringliteral}{"{}b\ value\ out\ of\ bounds\ (\%u\ >\ \%u)"{}},\ val,\ maxval\ );}
\DoxyCodeLine{00885\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*DEBUG*/}\textcolor{preprocessor}{}}
\DoxyCodeLine{00886\ \ \ \ \ \ \ putus(\ val,\ file\ );}
\DoxyCodeLine{00887\ \ \ \ \ \ \ charcount\ +=\ 11;}
\DoxyCodeLine{00888\ \ \ \ \ \}}
\DoxyCodeLine{00889\ \ \ \textcolor{keywordflow}{if}\ (\ charcount\ >\ 0\ )}
\DoxyCodeLine{00890\ \ \ \ \ (void)\ file-\/>put(\ \textcolor{charliteral}{'\(\backslash\)n'}\ );}
\DoxyCodeLine{00891\ \}}
\DoxyCodeLine{00892\ }
\DoxyCodeLine{00893\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00894\ ppm\_writeppmrow(ostream\ *\ \ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{pixel}}\ *\ \textcolor{keyword}{const}\ pixelrow,}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pixval\ \ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \ \textcolor{keywordflow}{if}\ (forceplain\ ||\ pm\_plain\_output\ \textcolor{comment}{/*||\ maxval\ >=\ 1<<16*/})}
\DoxyCodeLine{00901\ \ \ \ \ ppm\_writeppmrowplain(fileP,\ pixelrow,\ cols,\ maxval);}
\DoxyCodeLine{00902\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00903\ \ \ \ \ ppm\_writeppmrowraw(fileP,\ pixelrow,\ cols,\ maxval);}
\DoxyCodeLine{00904\ \}}
\DoxyCodeLine{00905\ }
\DoxyCodeLine{00906\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{00907\ pnm\_writepnmrow(ostream\ *\ \textcolor{keyword}{const}\ fileP,}
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *\ \ \textcolor{keyword}{const}\ xelrow,}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ cols,}
\DoxyCodeLine{00910\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ xelval\ \textcolor{keyword}{const}\ maxval,}
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ format,}
\DoxyCodeLine{00912\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \textcolor{keyword}{const}\ forceplain)\ \{}
\DoxyCodeLine{00913\ }
\DoxyCodeLine{00914\ \ \ \textcolor{keywordtype}{bool}\ \textcolor{keyword}{const}\ plainFormat\ =\ forceplain\ ||\ pm\_plain\_output;}
\DoxyCodeLine{00915\ }
\DoxyCodeLine{00916\ \ \ \textcolor{keywordflow}{switch}\ (PNM\_FORMAT\_TYPE(format))\ \{}
\DoxyCodeLine{00917\ \ \ \textcolor{keywordflow}{case}\ PPM\_TYPE:}
\DoxyCodeLine{00918\ \ \ \ \ ppm\_writeppmrow(fileP,\ (\mbox{\hyperlink{structpixel}{pixel}}*)\ xelrow,\ cols,\ (pixval)\ maxval,}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ plainFormat);}
\DoxyCodeLine{00920\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \textcolor{keywordflow}{case}\ PGM\_TYPE:\ \{}
\DoxyCodeLine{00923\ \ \ \ \ gray*\ grayrow;}
\DoxyCodeLine{00924\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00926\ \ \ \ \ grayrow\ =\ pgm\_allocrow(cols);}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)}
\DoxyCodeLine{00929\ \ \ \ \ \ \ grayrow[col]\ =\ PNM\_GET1(xelrow[col]);}
\DoxyCodeLine{00930\ }
\DoxyCodeLine{00931\ \ \ \ \ pgm\_writepgmrow(fileP,\ grayrow,\ cols,\ (gray)\ maxval,\ plainFormat);}
\DoxyCodeLine{00932\ }
\DoxyCodeLine{00933\ \ \ \ \ pgm\_freerow(\ grayrow\ );}
\DoxyCodeLine{00934\ \ \ \}}
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00936\ }
\DoxyCodeLine{00937\ \ \ \textcolor{keywordflow}{case}\ PBM\_TYPE:\ \{}
\DoxyCodeLine{00938\ \ \ \ \ bit*\ bitrow;}
\DoxyCodeLine{00939\ \ \ \ \ \textcolor{keywordtype}{int}\ col;}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \ \ bitrow\ =\ pbm\_allocrow(cols);}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \ \ \ \ \textcolor{keywordflow}{for}\ (col\ =\ 0;\ col\ <\ cols;\ ++col)}
\DoxyCodeLine{00944\ \ \ \ \ \ \ bitrow[col]\ =\ PNM\_GET1(xelrow[col])\ ==\ 0\ ?\ PBM\_BLACK\ :\ PBM\_WHITE;}
\DoxyCodeLine{00945\ }
\DoxyCodeLine{00946\ \ \ \ \ pbm\_writepbmrow(fileP,\ bitrow,\ cols,\ plainFormat);}
\DoxyCodeLine{00947\ }
\DoxyCodeLine{00948\ \ \ \ \ pbm\_freerow(bitrow);}
\DoxyCodeLine{00949\ \ \ \}}
\DoxyCodeLine{00950\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00953\ \ \ \ \ \mbox{\hyperlink{pnmimage__base_8cxx_a893dc64f7df73a34ac05e4fadc248da5}{pm\_error}}(\textcolor{stringliteral}{"{}invalid\ format\ argument\ received\ by\ pnm\_writepnmrow():\ \%d"{}}}
\DoxyCodeLine{00954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}PNM\_FORMAT\_TYPE(format)\ must\ be\ \%d,\ \%d,\ or\ \%d"{}},}
\DoxyCodeLine{00955\ \ \ \ \ \ \ \ \ \ \ \ \ \ format,\ PBM\_TYPE,\ PGM\_TYPE,\ PPM\_TYPE);}
\DoxyCodeLine{00956\ \ \ \}}
\DoxyCodeLine{00957\ \}}
\DoxyCodeLine{00958\ }
\DoxyCodeLine{00962\ PNMFileTypePNM::}
\DoxyCodeLine{00963\ PNMFileTypePNM()\ \{}
\DoxyCodeLine{00964\ \}}
\DoxyCodeLine{00965\ }
\DoxyCodeLine{00969\ \textcolor{keywordtype}{string}\ PNMFileTypePNM::}
\DoxyCodeLine{00970\ get\_name()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00971\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}NetPBM-\/style\ PBM/PGM/PPM/PNM"{}};}
\DoxyCodeLine{00972\ \}}
\DoxyCodeLine{00973\ }
\DoxyCodeLine{00978\ \textcolor{keywordtype}{int}\ PNMFileTypePNM::}
\DoxyCodeLine{00979\ get\_num\_extensions()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00980\ \ \ \textcolor{keywordflow}{return}\ num\_extensions\_PNM;}
\DoxyCodeLine{00981\ \}}
\DoxyCodeLine{00982\ }
\DoxyCodeLine{00987\ \textcolor{keywordtype}{string}\ PNMFileTypePNM::}
\DoxyCodeLine{00988\ get\_extension(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00989\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ num\_extensions\_PNM,\ \textcolor{keywordtype}{string}());}
\DoxyCodeLine{00990\ \ \ \textcolor{keywordflow}{return}\ extensions\_PNM[n];}
\DoxyCodeLine{00991\ \}}
\DoxyCodeLine{00992\ }
\DoxyCodeLine{00997\ \textcolor{keywordtype}{string}\ PNMFileTypePNM::}
\DoxyCodeLine{00998\ get\_suggested\_extension()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00999\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}ppm"{}};}
\DoxyCodeLine{01000\ \}}
\DoxyCodeLine{01001\ }
\DoxyCodeLine{01006\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::}
\DoxyCodeLine{01007\ has\_magic\_number()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01008\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01009\ \}}
\DoxyCodeLine{01010\ }
\DoxyCodeLine{01016\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::}
\DoxyCodeLine{01017\ matches\_magic\_number(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&magic\_number)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01018\ \ \ \textcolor{keywordflow}{return}\ (magic\_number.size()\ >=\ 2)\ \&\&}
\DoxyCodeLine{01019\ \ \ \ \ magic\_number[0]\ ==\ \textcolor{charliteral}{'P'}\ \&\&}
\DoxyCodeLine{01020\ \ \ \ \ (magic\_number[1]\ >=\ \textcolor{charliteral}{'1'}\ \&\&\ magic\_number[1]\ <=\ \textcolor{charliteral}{'6'});}
\DoxyCodeLine{01021\ \}}
\DoxyCodeLine{01022\ }
\DoxyCodeLine{01028\ \mbox{\hyperlink{classPNMReader}{PNMReader}}\ *PNMFileTypePNM::}
\DoxyCodeLine{01029\ make\_reader(istream\ *file,\ \textcolor{keywordtype}{bool}\ owns\_file,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&magic\_number)\ \{}
\DoxyCodeLine{01030\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ Reader(\textcolor{keyword}{this},\ file,\ owns\_file,\ magic\_number);}
\DoxyCodeLine{01031\ \}}
\DoxyCodeLine{01032\ }
\DoxyCodeLine{01038\ \mbox{\hyperlink{classPNMWriter}{PNMWriter}}\ *PNMFileTypePNM::}
\DoxyCodeLine{01039\ make\_writer(ostream\ *file,\ \textcolor{keywordtype}{bool}\ owns\_file)\ \{}
\DoxyCodeLine{01040\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ Writer(\textcolor{keyword}{this},\ file,\ owns\_file);}
\DoxyCodeLine{01041\ \}}
\DoxyCodeLine{01042\ }
\DoxyCodeLine{01043\ }
\DoxyCodeLine{01047\ PNMFileTypePNM::Reader::}
\DoxyCodeLine{01048\ Reader(\mbox{\hyperlink{classPNMFileType}{PNMFileType}}\ *type,\ istream\ *file,\ \textcolor{keywordtype}{bool}\ owns\_file,\ \textcolor{keywordtype}{string}\ magic\_number)\ :}
\DoxyCodeLine{01049\ \ \ \mbox{\hyperlink{classPNMReader}{PNMReader}}(type,\ file,\ owns\_file)}
\DoxyCodeLine{01050\ \{}
\DoxyCodeLine{01051\ \ \ \textcolor{keywordflow}{if}\ (!read\_magic\_number(\_file,\ magic\_number,\ 2))\ \{}
\DoxyCodeLine{01052\ \ \ \ \ \textcolor{comment}{//\ No\ magic\ number.\ \ No\ image.}}
\DoxyCodeLine{01053\ \ \ \ \ \textcolor{keywordflow}{if}\ (pnmimage\_pnm\_cat.is\_debug())\ \{}
\DoxyCodeLine{01054\ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug()}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}PNM\ file\ appears\ to\ be\ empty.\(\backslash\)n"{}};}
\DoxyCodeLine{01056\ \ \ \ \ \}}
\DoxyCodeLine{01057\ \ \ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01058\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01059\ \ \ \}}
\DoxyCodeLine{01060\ }
\DoxyCodeLine{01061\ \ \ \_ftype\ =}
\DoxyCodeLine{01062\ \ \ \ \ ((\textcolor{keywordtype}{unsigned}\ char)magic\_number[0]\ <<\ 8)\ |}
\DoxyCodeLine{01063\ \ \ \ \ (\textcolor{keywordtype}{unsigned}\ char)magic\_number[1];}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \textcolor{keywordflow}{switch}\ (\ PNM\_FORMAT\_TYPE(\_ftype)\ )\ \{}
\DoxyCodeLine{01066\ \ \ \textcolor{keywordflow}{case}\ PPM\_TYPE:}
\DoxyCodeLine{01067\ \ \ \ \ ppm\_readppminitrest(\ file,\ \&\_x\_size,\ \&\_y\_size,\ \&\_maxval\ );}
\DoxyCodeLine{01068\ \ \ \ \ \_num\_channels\ =\ 3;}
\DoxyCodeLine{01069\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01070\ }
\DoxyCodeLine{01071\ \ \ \textcolor{keywordflow}{case}\ PGM\_TYPE:}
\DoxyCodeLine{01072\ \ \ \ \ pgm\_readpgminitrest(\ file,\ \&\_x\_size,\ \&\_y\_size,\ \&\_maxval\ );}
\DoxyCodeLine{01073\ \ \ \ \ \_num\_channels\ =\ 1;}
\DoxyCodeLine{01074\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01075\ }
\DoxyCodeLine{01076\ \ \ \textcolor{keywordflow}{case}\ PBM\_TYPE:}
\DoxyCodeLine{01077\ \ \ \ \ pbm\_readpbminitrest(\ file,\ \&\_x\_size,\ \&\_y\_size\ );}
\DoxyCodeLine{01078\ \ \ \ \ \_num\_channels\ =\ 1;}
\DoxyCodeLine{01079\ \ \ \ \ \_maxval\ =\ 1;}
\DoxyCodeLine{01080\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01081\ }
\DoxyCodeLine{01082\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01083\ \ \ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01084\ \ \ \}}
\DoxyCodeLine{01085\ }
\DoxyCodeLine{01086\ \ \ \textcolor{keywordflow}{if}\ (pnmimage\_pnm\_cat.is\_debug())\ \{}
\DoxyCodeLine{01087\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_valid())\ \{}
\DoxyCodeLine{01088\ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug()}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Reading\ "{}};}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (PNM\_FORMAT\_TYPE(\_ftype))\ \{}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ PPM\_TYPE:}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}PPM"{}};}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ PGM\_TYPE:}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}PGM"{}};}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ PBM\_TYPE:}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug(\textcolor{keyword}{false})\ <<\ \textcolor{stringliteral}{"{}PBM"{}};}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01101\ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug(\textcolor{keyword}{false})}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ "{}}\ <<\ *\textcolor{keyword}{this}\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01103\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01104\ \ \ \ \ \ \ pnmimage\_pnm\_cat.debug()}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}File\ is\ not\ a\ valid\ PNM\ image.\(\backslash\)n"{}};}
\DoxyCodeLine{01106\ \ \ \ \ \}}
\DoxyCodeLine{01107\ \ \ \}}
\DoxyCodeLine{01108\ \}}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01116\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::Reader::}
\DoxyCodeLine{01117\ supports\_read\_row()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01118\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01119\ \}}
\DoxyCodeLine{01120\ }
\DoxyCodeLine{01133\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::Reader::}
\DoxyCodeLine{01134\ read\_row(\mbox{\hyperlink{structpixel}{xel}}\ *array,\ xelval\ *,\ \textcolor{keywordtype}{int}\ x\_size,\ \textcolor{keywordtype}{int}\ y\_size)\ \{}
\DoxyCodeLine{01135\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{01136\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01137\ \ \ \}}
\DoxyCodeLine{01138\ \ \ pnm\_readpnmrow(\_file,\ array,\ x\_size,\ \_maxval,\ \_ftype);}
\DoxyCodeLine{01139\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01140\ \}}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01142\ }
\DoxyCodeLine{01146\ PNMFileTypePNM::Writer::}
\DoxyCodeLine{01147\ Writer(\mbox{\hyperlink{classPNMFileType}{PNMFileType}}\ *type,\ ostream\ *file,\ \textcolor{keywordtype}{bool}\ owns\_file)\ :}
\DoxyCodeLine{01148\ \ \ \mbox{\hyperlink{classPNMWriter}{PNMWriter}}(type,\ file,\ owns\_file)}
\DoxyCodeLine{01149\ \{}
\DoxyCodeLine{01150\ \}}
\DoxyCodeLine{01151\ }
\DoxyCodeLine{01158\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::Writer::}
\DoxyCodeLine{01159\ supports\_write\_row()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01160\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01161\ \}}
\DoxyCodeLine{01162\ }
\DoxyCodeLine{01173\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::Writer::}
\DoxyCodeLine{01174\ write\_header()\ \{}
\DoxyCodeLine{01175\ \ \ \textcolor{keywordflow}{switch}\ (get\_color\_type())\ \{}
\DoxyCodeLine{01176\ \ \ \textcolor{keywordflow}{case}\ PNMImageHeader::CT\_grayscale:}
\DoxyCodeLine{01177\ \ \ \textcolor{keywordflow}{case}\ PNMImageHeader::CT\_two\_channel:}
\DoxyCodeLine{01178\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_maxval\ ==\ 1)\ \{}
\DoxyCodeLine{01179\ \ \ \ \ \ \ \_pnm\_format\ =\ PBM\_TYPE;}
\DoxyCodeLine{01180\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01181\ \ \ \ \ \ \ \_pnm\_format\ =\ PGM\_TYPE;}
\DoxyCodeLine{01182\ \ \ \ \ \}}
\DoxyCodeLine{01183\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01185\ \ \ \textcolor{keywordflow}{case}\ PNMImageHeader::CT\_color:}
\DoxyCodeLine{01186\ \ \ \textcolor{keywordflow}{case}\ PNMImageHeader::CT\_four\_channel:}
\DoxyCodeLine{01187\ \ \ \ \ \_pnm\_format\ =\ PPM\_TYPE;}
\DoxyCodeLine{01188\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01189\ }
\DoxyCodeLine{01190\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{01191\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01192\ \ \ \}}
\DoxyCodeLine{01193\ }
\DoxyCodeLine{01194\ \ \ pnm\_writepnminit(\_file,\ \_x\_size,\ \_y\_size,\ \_maxval,\ \_pnm\_format,\ 0);}
\DoxyCodeLine{01195\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01196\ \}}
\DoxyCodeLine{01197\ }
\DoxyCodeLine{01209\ \textcolor{keywordtype}{bool}\ PNMFileTypePNM::Writer::}
\DoxyCodeLine{01210\ write\_row(\mbox{\hyperlink{structpixel}{xel}}\ *row\_data,\ xelval\ *)\ \{}
\DoxyCodeLine{01211\ \ \ pnm\_writepnmrow(\_file,\ row\_data,\ \_x\_size,\ \_maxval,\ \_pnm\_format,\ 0);}
\DoxyCodeLine{01212\ }
\DoxyCodeLine{01213\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01214\ \}}
\DoxyCodeLine{01215\ }
\DoxyCodeLine{01219\ \textcolor{keywordtype}{void}\ PNMFileTypePNM::}
\DoxyCodeLine{01220\ register\_with\_read\_factory()\ \{}
\DoxyCodeLine{01221\ \ \ BamReader::get\_factory()-\/>}
\DoxyCodeLine{01222\ \ \ \ \ register\_factory(get\_class\_type(),\ make\_from\_bam);}
\DoxyCodeLine{01223\ \}}
\DoxyCodeLine{01224\ }
\DoxyCodeLine{01233\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *PNMFileTypePNM::}
\DoxyCodeLine{01234\ make\_from\_bam(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{01235\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classPNMFileTypeRegistry_a83617b215ff0b0482e86e463b43f22cf}{PNMFileTypeRegistry::get\_global\_ptr}}()-\/>\mbox{\hyperlink{classPNMFileTypeRegistry_a77cfb63495edef614b8ebf0c0d501843}{get\_type\_by\_handle}}(get\_class\_type());}
\DoxyCodeLine{01236\ \}}
\DoxyCodeLine{01237\ }
\DoxyCodeLine{01238\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ HAVE\_PNM}}

\end{DoxyCode}
