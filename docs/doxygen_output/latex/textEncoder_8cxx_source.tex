\doxysection{text\+Encoder.\+cxx}
\hypertarget{textEncoder_8cxx_source}{}\label{textEncoder_8cxx_source}\index{dtool/src/dtoolutil/textEncoder.cxx@{dtool/src/dtoolutil/textEncoder.cxx}}
\mbox{\hyperlink{textEncoder_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{textEncoder_8h}{textEncoder.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{stringDecoder_8h}{stringDecoder.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{unicodeLatinMap_8h}{unicodeLatinMap.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__dtoolutil_8h}{config\_dtoolutil.h}}"{}}}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00020\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00021\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00022\ \textcolor{keyword}{using\ }std::wstring;}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{comment}{//\ Maps\ cp437\ characters\ to\ Unicode\ codepoints.}}
\DoxyCodeLine{00025\ \textcolor{keyword}{static}\ \textcolor{keywordtype}{char16\_t}\ cp437\_table[256]\ =\ \{}
\DoxyCodeLine{00026\ \ \ 0x0000,\ 0x263a,\ 0x263b,\ 0x2665,\ 0x2666,\ 0x2663,\ 0x2660,\ 0x2022,}
\DoxyCodeLine{00027\ \ \ 0x25d8,\ 0x25cb,\ 0x25d9,\ 0x2642,\ 0x2640,\ 0x266a,\ 0x266b,\ 0x263c,}
\DoxyCodeLine{00028\ \ \ 0x25ba,\ 0x25c4,\ 0x2195,\ 0x203c,\ 0x00b6,\ 0x00a7,\ 0x25ac,\ 0x21a8,}
\DoxyCodeLine{00029\ \ \ 0x2191,\ 0x2193,\ 0x2192,\ 0x2190,\ 0x221f,\ 0x2194,\ 0x25b2,\ 0x25bc,}
\DoxyCodeLine{00030\ \ \ 0x0020,\ 0x0021,\ 0x0022,\ 0x0023,\ 0x0024,\ 0x0025,\ 0x0026,\ 0x0027,}
\DoxyCodeLine{00031\ \ \ 0x0028,\ 0x0029,\ 0x002a,\ 0x002b,\ 0x002c,\ 0x002d,\ 0x002e,\ 0x002f,}
\DoxyCodeLine{00032\ \ \ 0x0030,\ 0x0031,\ 0x0032,\ 0x0033,\ 0x0034,\ 0x0035,\ 0x0036,\ 0x0037,}
\DoxyCodeLine{00033\ \ \ 0x0038,\ 0x0039,\ 0x003a,\ 0x003b,\ 0x003c,\ 0x003d,\ 0x003e,\ 0x003f,}
\DoxyCodeLine{00034\ \ \ 0x0040,\ 0x0041,\ 0x0042,\ 0x0043,\ 0x0044,\ 0x0045,\ 0x0046,\ 0x0047,}
\DoxyCodeLine{00035\ \ \ 0x0048,\ 0x0049,\ 0x004a,\ 0x004b,\ 0x004c,\ 0x004d,\ 0x004e,\ 0x004f,}
\DoxyCodeLine{00036\ \ \ 0x0050,\ 0x0051,\ 0x0052,\ 0x0053,\ 0x0054,\ 0x0055,\ 0x0056,\ 0x0057,}
\DoxyCodeLine{00037\ \ \ 0x0058,\ 0x0059,\ 0x005a,\ 0x005b,\ 0x005c,\ 0x005d,\ 0x005e,\ 0x005f,}
\DoxyCodeLine{00038\ \ \ 0x0060,\ 0x0061,\ 0x0062,\ 0x0063,\ 0x0064,\ 0x0065,\ 0x0066,\ 0x0067,}
\DoxyCodeLine{00039\ \ \ 0x0068,\ 0x0069,\ 0x006a,\ 0x006b,\ 0x006c,\ 0x006d,\ 0x006e,\ 0x006f,}
\DoxyCodeLine{00040\ \ \ 0x0070,\ 0x0071,\ 0x0072,\ 0x0073,\ 0x0074,\ 0x0075,\ 0x0076,\ 0x0077,}
\DoxyCodeLine{00041\ \ \ 0x0078,\ 0x0079,\ 0x007a,\ 0x007b,\ 0x007c,\ 0x007d,\ 0x007e,\ 0x2302,}
\DoxyCodeLine{00042\ \ \ 0x00c7,\ 0x00fc,\ 0x00e9,\ 0x00e2,\ 0x00e4,\ 0x00e0,\ 0x00e5,\ 0x00e7,}
\DoxyCodeLine{00043\ \ \ 0x00ea,\ 0x00eb,\ 0x00e8,\ 0x00ef,\ 0x00ee,\ 0x00ec,\ 0x00c4,\ 0x00c5,}
\DoxyCodeLine{00044\ \ \ 0x00c9,\ 0x00e6,\ 0x00c6,\ 0x00f4,\ 0x00f6,\ 0x00f2,\ 0x00fb,\ 0x00f9,}
\DoxyCodeLine{00045\ \ \ 0x00ff,\ 0x00d6,\ 0x00dc,\ 0x00a2,\ 0x00a3,\ 0x00a5,\ 0x20a7,\ 0x0192,}
\DoxyCodeLine{00046\ \ \ 0x00e1,\ 0x00ed,\ 0x00f3,\ 0x00fa,\ 0x00f1,\ 0x00d1,\ 0x00aa,\ 0x00ba,}
\DoxyCodeLine{00047\ \ \ 0x00bf,\ 0x2310,\ 0x00ac,\ 0x00bd,\ 0x00bc,\ 0x00a1,\ 0x00ab,\ 0x00bb,}
\DoxyCodeLine{00048\ \ \ 0x2591,\ 0x2592,\ 0x2593,\ 0x2502,\ 0x2524,\ 0x2561,\ 0x2562,\ 0x2556,}
\DoxyCodeLine{00049\ \ \ 0x2555,\ 0x2563,\ 0x2551,\ 0x2557,\ 0x255d,\ 0x255c,\ 0x255b,\ 0x2510,}
\DoxyCodeLine{00050\ \ \ 0x2514,\ 0x2534,\ 0x252c,\ 0x251c,\ 0x2500,\ 0x253c,\ 0x255e,\ 0x255f,}
\DoxyCodeLine{00051\ \ \ 0x255a,\ 0x2554,\ 0x2569,\ 0x2566,\ 0x2560,\ 0x2550,\ 0x256c,\ 0x2567,}
\DoxyCodeLine{00052\ \ \ 0x2568,\ 0x2564,\ 0x2565,\ 0x2559,\ 0x2558,\ 0x2552,\ 0x2553,\ 0x256b,}
\DoxyCodeLine{00053\ \ \ 0x256a,\ 0x2518,\ 0x250c,\ 0x2588,\ 0x2584,\ 0x258c,\ 0x2590,\ 0x2580,}
\DoxyCodeLine{00054\ \ \ 0x03b1,\ 0x00df,\ 0x0393,\ 0x03c0,\ 0x03a3,\ 0x03c3,\ 0x00b5,\ 0x03c4,}
\DoxyCodeLine{00055\ \ \ 0x03a6,\ 0x0398,\ 0x03a9,\ 0x03b4,\ 0x221e,\ 0x03c6,\ 0x03b5,\ 0x2229,}
\DoxyCodeLine{00056\ \ \ 0x2261,\ 0x00b1,\ 0x2265,\ 0x2264,\ 0x2320,\ 0x2321,\ 0x00f7,\ 0x2248,}
\DoxyCodeLine{00057\ \ \ 0x00b0,\ 0x2219,\ 0x00b7,\ 0x221a,\ 0x207f,\ 0x00b2,\ 0x25a0,\ 0x00a0,}
\DoxyCodeLine{00058\ \};}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ TextEncoder::Encoding\ TextEncoder::\_default\_encoding\ =\ TextEncoder::E\_utf8;}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00066\ \textcolor{keywordtype}{void}\ TextEncoder::}
\DoxyCodeLine{00067\ make\_upper()\ \{}
\DoxyCodeLine{00068\ \ \ get\_wtext();}
\DoxyCodeLine{00069\ \ \ wstring::iterator\ si;}
\DoxyCodeLine{00070\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_wtext.begin();\ si\ !=\ \_wtext.end();\ ++si)\ \{}
\DoxyCodeLine{00071\ \ \ \ \ (*si)\ =\ unicode\_toupper(*si);}
\DoxyCodeLine{00072\ \ \ \}}
\DoxyCodeLine{00073\ \ \ \_flags\ \&=\ \string~F\_got\_text;}
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{classTextEncoder_ac0bec8514c886fb6d9294efd29b1eeca}{text\_changed}}();}
\DoxyCodeLine{00075\ \}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00081\ \textcolor{keywordtype}{void}\ TextEncoder::}
\DoxyCodeLine{00082\ make\_lower()\ \{}
\DoxyCodeLine{00083\ \ \ get\_wtext();}
\DoxyCodeLine{00084\ \ \ wstring::iterator\ si;}
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_wtext.begin();\ si\ !=\ \_wtext.end();\ ++si)\ \{}
\DoxyCodeLine{00086\ \ \ \ \ (*si)\ =\ unicode\_tolower(*si);}
\DoxyCodeLine{00087\ \ \ \}}
\DoxyCodeLine{00088\ \ \ \_flags\ \&=\ \string~F\_got\_text;}
\DoxyCodeLine{00089\ \ \ \mbox{\hyperlink{classTextEncoder_ac0bec8514c886fb6d9294efd29b1eeca}{text\_changed}}();}
\DoxyCodeLine{00090\ \}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00105\ wstring\ TextEncoder::}
\DoxyCodeLine{00106\ get\_wtext\_as\_ascii()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00107\ \ \ get\_wtext();}
\DoxyCodeLine{00108\ \ \ wstring\ result;}
\DoxyCodeLine{00109\ \ \ wstring::const\_iterator\ si;}
\DoxyCodeLine{00110\ \ \ \textcolor{keywordflow}{for}\ (si\ =\ \_wtext.begin();\ si\ !=\ \_wtext.end();\ ++si)\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ character\ =\ (*si);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classUnicodeLatinMap_1_1Entry}{UnicodeLatinMap::Entry}}\ *map\_entry\ =}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \mbox{\hyperlink{classUnicodeLatinMap_a4ffd050ea2daac1619647b3cdddc2833}{UnicodeLatinMap::look\_up}}(character);}
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keywordflow}{if}\ (map\_entry\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ map\_entry-\/>\_ascii\_equiv\ !=\ 0)\ \{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ result\ +=\ (wchar\_t)map\_entry-\/>\_ascii\_equiv;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (map\_entry-\/>\_ascii\_additional\ !=\ 0)\ \{}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ result\ +=\ (wchar\_t)map\_entry-\/>\_ascii\_additional;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00122\ \ \ \ \ \ \ result\ +=\ character;}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ \ \ \}}
\DoxyCodeLine{00125\ }
\DoxyCodeLine{00126\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00127\ \}}
\DoxyCodeLine{00128\ }
\DoxyCodeLine{00134\ \textcolor{keywordtype}{bool}\ TextEncoder::}
\DoxyCodeLine{00135\ is\_wtext()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00136\ \ \ get\_wtext();}
\DoxyCodeLine{00137\ \ \ wstring::const\_iterator\ ti;}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_wtext.begin();\ ti\ !=\ \_wtext.end();\ ++ti)\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keywordflow}{if}\ (((*ti)\ \&\ \string~0x7f)\ !=\ 0)\ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00141\ \ \ \ \ \}}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00145\ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00151\ \textcolor{keywordtype}{string}\ TextEncoder::}
\DoxyCodeLine{00152\ encode\_wchar(\textcolor{keywordtype}{char32\_t}\ ch,\ TextEncoder::Encoding\ encoding)\ \{}
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{switch}\ (encoding)\ \{}
\DoxyCodeLine{00154\ \ \ \textcolor{keywordflow}{case}\ E\_iso8859:}
\DoxyCodeLine{00155\ \ \ \ \ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0xff)\ ==\ 0)\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string(1,\ (\textcolor{keywordtype}{char})ch);}
\DoxyCodeLine{00157\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \textcolor{comment}{//\ The\ character\ won't\ fit\ in\ the\ 8-\/bit\ ISO\ 8859.\ \ See\ if\ we\ can\ make\ it}}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \textcolor{comment}{//\ fit\ by\ reducing\ it\ to\ its\ ascii\ equivalent\ (essentially\ stripping\ off}}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \textcolor{comment}{//\ an\ unusual\ accent\ mark).}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classUnicodeLatinMap_1_1Entry}{UnicodeLatinMap::Entry}}\ *map\_entry\ =}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classUnicodeLatinMap_a4ffd050ea2daac1619647b3cdddc2833}{UnicodeLatinMap::look\_up}}(ch);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (map\_entry\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ map\_entry-\/>\_ascii\_equiv\ !=\ 0)\ \{}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yes,\ it\ has\ an\ ascii\ equivalent.}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (map\_entry-\/>\_ascii\_additional\ !=\ 0)\ \{}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ In\ fact,\ it\ has\ two\ of\ them.}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ string(1,\ map\_entry-\/>\_ascii\_equiv)\ +}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ string(1,\ map\_entry-\/>\_ascii\_additional);}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string(1,\ map\_entry-\/>\_ascii\_equiv);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \textcolor{comment}{//\ Nope;\ return\ "{}."{}\ for\ lack\ of\ anything\ better.}}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keywordflow}{case}\ E\_utf8:}
\DoxyCodeLine{00178\ \ \ \ \ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0x7f)\ ==\ 0)\ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string(1,\ (\textcolor{keywordtype}{char})ch);}
\DoxyCodeLine{00180\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0x7ff)\ ==\ 0)\ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ >>\ 6)\ |\ 0xc0))\ +}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ \&\ 0x3f)\ |\ 0x80));}
\DoxyCodeLine{00184\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0xffff)\ ==\ 0)\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ >>\ 12)\ |\ 0xe0))\ +}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})(((ch\ >>\ 6)\ \&\ 0x3f)\ |\ 0x80))\ +}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ \&\ 0x3f)\ |\ 0x80));}
\DoxyCodeLine{00189\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ >>\ 18)\ |\ 0xf0))\ +}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})(((ch\ >>\ 12)\ \&\ 0x3f)\ |\ 0x80))\ +}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})(((ch\ >>\ 6)\ \&\ 0x3f)\ |\ 0x80))\ +}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})((ch\ \&\ 0x3f)\ |\ 0x80));}
\DoxyCodeLine{00195\ \ \ \ \ \}}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{case}\ E\_utf16be:}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0xffff)\ ==\ 0)\ \{}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \textcolor{comment}{//\ Note\ that\ this\ passes\ through\ surrogates\ and\ BOMs\ unharmed.}}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})(ch\ >>\ 8))\ +}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ string(1,\ (\textcolor{keywordtype}{char})(ch\ \&\ 0xff));}
\DoxyCodeLine{00203\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \textcolor{comment}{//\ Use\ a\ surrogate\ pair.}}
\DoxyCodeLine{00205\ \ \ \ \ \ \ uint32\_t\ v\ =\ (uint32\_t)ch\ -\/\ 0x10000u;}
\DoxyCodeLine{00206\ \ \ \ \ \ \ uint16\_t\ hi\ =\ (v\ >>\ 10u)\ |\ 0xd800u;}
\DoxyCodeLine{00207\ \ \ \ \ \ \ uint16\_t\ lo\ =\ (v\ \&\ 0x3ffu)\ |\ 0xdc00u;}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ encoded[4]\ =\ \{}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ (char)(hi\ >>\ 8),}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ (char)(hi\ \&\ 0xff),}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ (char)(lo\ >>\ 8),}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ (char)(lo\ \&\ 0xff),}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string(encoded,\ 4);}
\DoxyCodeLine{00215\ \ \ \ \ \}}
\DoxyCodeLine{00216\ }
\DoxyCodeLine{00217\ \ \ \textcolor{keywordflow}{case}\ E\_cp437:}
\DoxyCodeLine{00218\ \ \ \ \ \textcolor{keywordflow}{if}\ ((ch\ \&\ \string~0x7f)\ ==\ 0)\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ string(1,\ (\textcolor{keywordtype}{char})ch);}
\DoxyCodeLine{00220\ \ \ \ \ \}}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (ch\ >=\ 0\ \&\&\ ch\ <\ 0x266b)\ \{}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ case\ is\ not\ optimized,\ because\ we\ don't\ really\ need\ it\ right\ now.}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 256;\ ++i)\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (cp437\_table[i]\ ==\ ch)\ \{}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::string(1,\ (\textcolor{keywordtype}{char})i);}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \ \ \}}
\DoxyCodeLine{00229\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}."{}};}
\DoxyCodeLine{00230\ \ \ \}}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00233\ \}}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00239\ \textcolor{keywordtype}{string}\ TextEncoder::}
\DoxyCodeLine{00240\ encode\_wtext(\textcolor{keyword}{const}\ wstring\ \&wtext,\ TextEncoder::Encoding\ encoding)\ \{}
\DoxyCodeLine{00241\ \ \ \textcolor{keywordtype}{string}\ result;}
\DoxyCodeLine{00242\ }
\DoxyCodeLine{00243\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ wtext.size();\ ++i)\ \{}
\DoxyCodeLine{00244\ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ ch\ =\ wtext[i];}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \ \ \textcolor{comment}{//\ On\ some\ systems,\ wstring\ may\ be\ UTF-\/16,\ and\ contain\ surrogate\ pairs.}}
\DoxyCodeLine{00247\ \textcolor{preprocessor}{\#if\ WCHAR\_MAX\ <\ 0x10FFFF}}
\DoxyCodeLine{00248\ \ \ \ \ \textcolor{keywordflow}{if}\ (ch\ >=\ 0xd800\ \&\&\ ch\ <\ 0xdc00\ \&\&\ (i\ +\ 1)\ <\ wtext.size())\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ is\ a\ high\ surrogate.\ \ Look\ for\ a\ subsequent\ low\ surrogate.}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \textcolor{keywordtype}{wchar\_t}\ ch2\ =\ wtext[i\ +\ 1];}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (ch2\ >=\ 0xdc00\ \&\&\ ch2\ <\ 0xe000)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Yes,\ this\ is\ a\ low\ surrogate.}}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char32\_t}\ code\_point\ =\ 0x10000\ +\ ((ch\ -\/\ 0xd800)\ <<\ 10)\ +\ (ch2\ -\/\ 0xdc00);}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ result\ +=\ encode\_wchar(code\_point,\ encoding);}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ i++;}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ \}}
\DoxyCodeLine{00259\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \ \ \ \ result\ +=\ encode\_wchar(ch,\ encoding);}
\DoxyCodeLine{00262\ \ \ \}}
\DoxyCodeLine{00263\ }
\DoxyCodeLine{00264\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00271\ wstring\ TextEncoder::}
\DoxyCodeLine{00272\ decode\_text(\textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&text,\ TextEncoder::Encoding\ encoding)\ \{}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{switch}\ (encoding)\ \{}
\DoxyCodeLine{00274\ \ \ \textcolor{keywordflow}{case}\ E\_utf8:}
\DoxyCodeLine{00275\ \ \ \ \ \{}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \mbox{\hyperlink{classStringUtf8Decoder}{StringUtf8Decoder}}\ decoder(text);}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decode\_text\_impl(decoder);}
\DoxyCodeLine{00278\ \ \ \ \ \}}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \textcolor{keywordflow}{case}\ E\_utf16be:}
\DoxyCodeLine{00281\ \ \ \ \ \{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \mbox{\hyperlink{classStringUtf16Decoder}{StringUtf16Decoder}}\ decoder(text);}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decode\_text\_impl(decoder);}
\DoxyCodeLine{00284\ \ \ \ \ \}}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \textcolor{keywordflow}{case}\ E\_cp437:}
\DoxyCodeLine{00287\ \ \ \ \ \{}
\DoxyCodeLine{00288\ \ \ \ \ \ \ std::wstring\ result(text.size(),\ 0);}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ result.size();\ ++i)\ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ result[i]\ =\ cp437\_table[(uint8\_t)text[i]];}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00293\ \ \ \ \ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \textcolor{keywordflow}{case}\ E\_iso8859:}
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00297\ \ \ \ \ \{}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \mbox{\hyperlink{classStringDecoder}{StringDecoder}}\ decoder(text);}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ decode\_text\_impl(decoder);}
\DoxyCodeLine{00300\ \ \ \ \ \}}
\DoxyCodeLine{00301\ \ \ \};}
\DoxyCodeLine{00302\ \}}
\DoxyCodeLine{00303\ }
\DoxyCodeLine{00308\ wstring\ TextEncoder::}
\DoxyCodeLine{00309\ decode\_text\_impl(\mbox{\hyperlink{classStringDecoder}{StringDecoder}}\ \&decoder)\ \{}
\DoxyCodeLine{00310\ \ \ wstring\ result;}
\DoxyCodeLine{00311\ \ \ \textcolor{comment}{//\ bool\ expand\_amp\ =\ get\_expand\_amp();}}
\DoxyCodeLine{00312\ }
\DoxyCodeLine{00313\ \ \ \textcolor{keywordtype}{char32\_t}\ character\ =\ decoder.\mbox{\hyperlink{classStringDecoder_a7984183ea93d2667c4525cae706efd08}{get\_next\_character}}();}
\DoxyCodeLine{00314\ \ \ \textcolor{keywordflow}{while}\ (!decoder.is\_eof())\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \textcolor{comment}{/*}}
\DoxyCodeLine{00316\ \textcolor{comment}{\ \ \ \ if\ (character\ ==\ '\&'\ \&\&\ expand\_amp)\ \{}}
\DoxyCodeLine{00317\ \textcolor{comment}{\ \ \ \ \ \ //\ An\ ampersand\ in\ expand\_amp\ mode\ is\ treated\ as\ an\ escape\ character.}}
\DoxyCodeLine{00318\ \textcolor{comment}{\ \ \ \ \ \ character\ =\ expand\_amp\_sequence(decoder);}}
\DoxyCodeLine{00319\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00320\ \textcolor{comment}{\ \ \ \ */}}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordflow}{if}\ (character\ <=\ WCHAR\_MAX)\ \{}
\DoxyCodeLine{00322\ \ \ \ \ \ \ result\ +=\ character;}
\DoxyCodeLine{00323\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ need\ to\ encode\ this\ as\ a\ surrogate\ pair.}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ uint32\_t\ v\ =\ (uint32\_t)character\ -\/\ 0x10000u;}
\DoxyCodeLine{00326\ \ \ \ \ \ \ result\ +=\ (wchar\_t)((v\ >>\ 10u)\ |\ 0xd800u);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ result\ +=\ (wchar\_t)((v\ \&\ 0x3ffu)\ |\ 0xdc00u);}
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \ \ character\ =\ decoder.\mbox{\hyperlink{classStringDecoder_a7984183ea93d2667c4525cae706efd08}{get\_next\_character}}();}
\DoxyCodeLine{00330\ \ \ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00333\ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00341\ \textcolor{comment}{/*}}
\DoxyCodeLine{00342\ \textcolor{comment}{int\ TextEncoder::}}
\DoxyCodeLine{00343\ \textcolor{comment}{expand\_amp\_sequence(StringDecoder\ \&decoder)\ const\ \{}}
\DoxyCodeLine{00344\ \textcolor{comment}{\ \ int\ result\ =\ 0;}}
\DoxyCodeLine{00345\ \textcolor{comment}{}}
\DoxyCodeLine{00346\ \textcolor{comment}{\ \ int\ character\ =\ decoder.get\_next\_character();}}
\DoxyCodeLine{00347\ \textcolor{comment}{\ \ if\ (!decoder.is\_eof()\ \&\&\ character\ ==\ '\#')\ \{}}
\DoxyCodeLine{00348\ \textcolor{comment}{\ \ \ \ //\ An\ explicit\ numeric\ sequence:\ \&\#nnn;}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ \ \ \ result\ =\ 0;}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ \ \ \ character\ =\ decoder.get\_next\_character();}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ \ \ \ while\ (!decoder.is\_eof()\ \&\&\ character\ <\ 128\ \&\&\ isdigit((unsigned\ int)character))\ \{}}
\DoxyCodeLine{00352\ \textcolor{comment}{\ \ \ \ \ \ result\ =\ (result\ *\ 10)\ +\ (character\ -\/\ '0');}}
\DoxyCodeLine{00353\ \textcolor{comment}{\ \ \ \ \ \ character\ =\ decoder.get\_next\_character();}}
\DoxyCodeLine{00354\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00355\ \textcolor{comment}{\ \ \ \ if\ (character\ !=\ ';')\ \{}}
\DoxyCodeLine{00356\ \textcolor{comment}{\ \ \ \ \ \ //\ Invalid\ sequence.}}
\DoxyCodeLine{00357\ \textcolor{comment}{\ \ \ \ \ \ return\ 0;}}
\DoxyCodeLine{00358\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00359\ \textcolor{comment}{}}
\DoxyCodeLine{00360\ \textcolor{comment}{\ \ \ \ return\ result;}}
\DoxyCodeLine{00361\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00362\ \textcolor{comment}{}}
\DoxyCodeLine{00363\ \textcolor{comment}{\ \ string\ sequence;}}
\DoxyCodeLine{00364\ \textcolor{comment}{}}
\DoxyCodeLine{00365\ \textcolor{comment}{\ \ //\ Some\ non-\/numeric\ sequence.}}
\DoxyCodeLine{00366\ \textcolor{comment}{\ \ while\ (!decoder.is\_eof()\ \&\&\ character\ <\ 128\ \&\&\ isalpha((unsigned\ int)character))\ \{}}
\DoxyCodeLine{00367\ \textcolor{comment}{\ \ \ \ sequence\ +=\ character;}}
\DoxyCodeLine{00368\ \textcolor{comment}{\ \ \ \ character\ =\ decoder.get\_next\_character();}}
\DoxyCodeLine{00369\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00370\ \textcolor{comment}{\ \ if\ (character\ !=\ ';')\ \{}}
\DoxyCodeLine{00371\ \textcolor{comment}{\ \ \ \ //\ Invalid\ sequence.}}
\DoxyCodeLine{00372\ \textcolor{comment}{\ \ \ \ return\ 0;}}
\DoxyCodeLine{00373\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00374\ \textcolor{comment}{}}
\DoxyCodeLine{00375\ \textcolor{comment}{\ \ static\ const\ struct\ \{}}
\DoxyCodeLine{00376\ \textcolor{comment}{\ \ \ \ const\ char\ *name;}}
\DoxyCodeLine{00377\ \textcolor{comment}{\ \ \ \ int\ code;}}
\DoxyCodeLine{00378\ \textcolor{comment}{\ \ \}\ tokens[]\ =\ \{}}
\DoxyCodeLine{00379\ \textcolor{comment}{\ \ \ \ \{\ "{}amp"{},\ '\&'\ \},\ \{\ "{}lt"{},\ '<'\ \},\ \{\ "{}gt"{},\ '>'\ \},\ \{\ "{}quot"{},\ '"{}'\ \},}}
\DoxyCodeLine{00380\ \textcolor{comment}{\ \ \ \ \{\ "{}nbsp"{},\ '\ '\ \},}}
\DoxyCodeLine{00381\ \textcolor{comment}{}}
\DoxyCodeLine{00382\ \textcolor{comment}{\ \ \ \ \{\ "{}iexcl"{},\ 161\ \},\ \{\ "{}cent"{},\ 162\ \},\ \{\ "{}pound"{},\ 163\ \},\ \{\ "{}curren"{},\ 164\ \},}}
\DoxyCodeLine{00383\ \textcolor{comment}{\ \ \ \ \{\ "{}yen"{},\ 165\ \},\ \{\ "{}brvbar"{},\ 166\ \},\ \{\ "{}brkbar"{},\ 166\ \},\ \{\ "{}sect"{},\ 167\ \},}}
\DoxyCodeLine{00384\ \textcolor{comment}{\ \ \ \ \{\ "{}uml"{},\ 168\ \},\ \{\ "{}die"{},\ 168\ \},\ \{\ "{}copy"{},\ 169\ \},\ \{\ "{}ordf"{},\ 170\ \},}}
\DoxyCodeLine{00385\ \textcolor{comment}{\ \ \ \ \{\ "{}laquo"{},\ 171\ \},\ \{\ "{}not"{},\ 172\ \},\ \{\ "{}shy"{},\ 173\ \},\ \{\ "{}reg"{},\ 174\ \},}}
\DoxyCodeLine{00386\ \textcolor{comment}{\ \ \ \ \{\ "{}macr"{},\ 175\ \},\ \{\ "{}hibar"{},\ 175\ \},\ \{\ "{}deg"{},\ 176\ \},\ \{\ "{}plusmn"{},\ 177\ \},}}
\DoxyCodeLine{00387\ \textcolor{comment}{\ \ \ \ \{\ "{}sup2"{},\ 178\ \},\ \{\ "{}sup3"{},\ 179\ \},\ \{\ "{}acute"{},\ 180\ \},\ \{\ "{}micro"{},\ 181\ \},}}
\DoxyCodeLine{00388\ \textcolor{comment}{\ \ \ \ \{\ "{}para"{},\ 182\ \},\ \{\ "{}middot"{},\ 183\ \},\ \{\ "{}cedil"{},\ 184\ \},\ \{\ "{}sup1"{},\ 185\ \},}}
\DoxyCodeLine{00389\ \textcolor{comment}{\ \ \ \ \{\ "{}ordm"{},\ 186\ \},\ \{\ "{}raquo"{},\ 187\ \},\ \{\ "{}frac14"{},\ 188\ \},\ \{\ "{}frac12"{},\ 189\ \},}}
\DoxyCodeLine{00390\ \textcolor{comment}{\ \ \ \ \{\ "{}frac34"{},\ 190\ \},\ \{\ "{}iquest"{},\ 191\ \},\ \{\ "{}Agrave"{},\ 192\ \},\ \{\ "{}Aacute"{},\ 193\ \},}}
\DoxyCodeLine{00391\ \textcolor{comment}{\ \ \ \ \{\ "{}Acirc"{},\ 194\ \},\ \{\ "{}Atilde"{},\ 195\ \},\ \{\ "{}Auml"{},\ 196\ \},\ \{\ "{}Aring"{},\ 197\ \},}}
\DoxyCodeLine{00392\ \textcolor{comment}{\ \ \ \ \{\ "{}AElig"{},\ 198\ \},\ \{\ "{}Ccedil"{},\ 199\ \},\ \{\ "{}Egrave"{},\ 200\ \},\ \{\ "{}Eacute"{},\ 201\ \},}}
\DoxyCodeLine{00393\ \textcolor{comment}{\ \ \ \ \{\ "{}Ecirc"{},\ 202\ \},\ \{\ "{}Euml"{},\ 203\ \},\ \{\ "{}Igrave"{},\ 204\ \},\ \{\ "{}Iacute"{},\ 205\ \},}}
\DoxyCodeLine{00394\ \textcolor{comment}{\ \ \ \ \{\ "{}Icirc"{},\ 206\ \},\ \{\ "{}Iuml"{},\ 207\ \},\ \{\ "{}ETH"{},\ 208\ \},\ \{\ "{}Dstrok"{},\ 208\ \},}}
\DoxyCodeLine{00395\ \textcolor{comment}{\ \ \ \ \{\ "{}Ntilde"{},\ 209\ \},\ \{\ "{}Ograve"{},\ 210\ \},\ \{\ "{}Oacute"{},\ 211\ \},\ \{\ "{}Ocirc"{},\ 212\ \},}}
\DoxyCodeLine{00396\ \textcolor{comment}{\ \ \ \ \{\ "{}Otilde"{},\ 213\ \},\ \{\ "{}Ouml"{},\ 214\ \},\ \{\ "{}times"{},\ 215\ \},\ \{\ "{}Oslash"{},\ 216\ \},}}
\DoxyCodeLine{00397\ \textcolor{comment}{\ \ \ \ \{\ "{}Ugrave"{},\ 217\ \},\ \{\ "{}Uacute"{},\ 218\ \},\ \{\ "{}Ucirc"{},\ 219\ \},\ \{\ "{}Uuml"{},\ 220\ \},}}
\DoxyCodeLine{00398\ \textcolor{comment}{\ \ \ \ \{\ "{}Yacute"{},\ 221\ \},\ \{\ "{}THORN"{},\ 222\ \},\ \{\ "{}szlig"{},\ 223\ \},\ \{\ "{}agrave"{},\ 224\ \},}}
\DoxyCodeLine{00399\ \textcolor{comment}{\ \ \ \ \{\ "{}aacute"{},\ 225\ \},\ \{\ "{}acirc"{},\ 226\ \},\ \{\ "{}atilde"{},\ 227\ \},\ \{\ "{}auml"{},\ 228\ \},}}
\DoxyCodeLine{00400\ \textcolor{comment}{\ \ \ \ \{\ "{}aring"{},\ 229\ \},\ \{\ "{}aelig"{},\ 230\ \},\ \{\ "{}ccedil"{},\ 231\ \},\ \{\ "{}egrave"{},\ 232\ \},}}
\DoxyCodeLine{00401\ \textcolor{comment}{\ \ \ \ \{\ "{}eacute"{},\ 233\ \},\ \{\ "{}ecirc"{},\ 234\ \},\ \{\ "{}euml"{},\ 235\ \},\ \{\ "{}igrave"{},\ 236\ \},}}
\DoxyCodeLine{00402\ \textcolor{comment}{\ \ \ \ \{\ "{}iacute"{},\ 237\ \},\ \{\ "{}icirc"{},\ 238\ \},\ \{\ "{}iuml"{},\ 239\ \},\ \{\ "{}eth"{},\ 240\ \},}}
\DoxyCodeLine{00403\ \textcolor{comment}{\ \ \ \ \{\ "{}ntilde"{},\ 241\ \},\ \{\ "{}ograve"{},\ 242\ \},\ \{\ "{}oacute"{},\ 243\ \},\ \{\ "{}ocirc"{},\ 244\ \},}}
\DoxyCodeLine{00404\ \textcolor{comment}{\ \ \ \ \{\ "{}otilde"{},\ 245\ \},\ \{\ "{}ouml"{},\ 246\ \},\ \{\ "{}divide"{},\ 247\ \},\ \{\ "{}oslash"{},\ 248\ \},}}
\DoxyCodeLine{00405\ \textcolor{comment}{\ \ \ \ \{\ "{}ugrave"{},\ 249\ \},\ \{\ "{}uacute"{},\ 250\ \},\ \{\ "{}ucirc"{},\ 251\ \},\ \{\ "{}uuml"{},\ 252\ \},}}
\DoxyCodeLine{00406\ \textcolor{comment}{\ \ \ \ \{\ "{}yacute"{},\ 253\ \},\ \{\ "{}thorn"{},\ 254\ \},\ \{\ "{}yuml"{},\ 255\ \},}}
\DoxyCodeLine{00407\ \textcolor{comment}{}}
\DoxyCodeLine{00408\ \textcolor{comment}{\ \ \ \ \{\ NULL,\ 0\ \},}}
\DoxyCodeLine{00409\ \textcolor{comment}{\ \ \};}}
\DoxyCodeLine{00410\ \textcolor{comment}{}}
\DoxyCodeLine{00411\ \textcolor{comment}{\ \ for\ (int\ i\ =\ 0;\ tokens[i].name\ !=\ NULL;\ i++)\ \{}}
\DoxyCodeLine{00412\ \textcolor{comment}{\ \ \ \ if\ (sequence\ ==\ tokens[i].name)\ \{}}
\DoxyCodeLine{00413\ \textcolor{comment}{\ \ \ \ \ \ //\ Here's\ a\ match.}}
\DoxyCodeLine{00414\ \textcolor{comment}{\ \ \ \ \ \ return\ tokens[i].code;}}
\DoxyCodeLine{00415\ \textcolor{comment}{\ \ \ \ \}}}
\DoxyCodeLine{00416\ \textcolor{comment}{\ \ \}}}
\DoxyCodeLine{00417\ \textcolor{comment}{}}
\DoxyCodeLine{00418\ \textcolor{comment}{\ \ //\ Some\ unrecognized\ sequence.}}
\DoxyCodeLine{00419\ \textcolor{comment}{\ \ return\ 0;}}
\DoxyCodeLine{00420\ \textcolor{comment}{\}}}
\DoxyCodeLine{00421\ \textcolor{comment}{*/}}
\DoxyCodeLine{00422\ }
\DoxyCodeLine{00426\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classTextEncoder_ac0bec8514c886fb6d9294efd29b1eeca}{TextEncoder::}}}
\DoxyCodeLine{00427\ \mbox{\hyperlink{classTextEncoder_ac0bec8514c886fb6d9294efd29b1eeca}{text\_changed}}()\ \{}
\DoxyCodeLine{00428\ \}}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00433\ ostream\ \&}
\DoxyCodeLine{00434\ operator\ <<\ (ostream\ \&out,\ TextEncoder::Encoding\ encoding)\ \{}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{switch}\ (encoding)\ \{}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{case}\ TextEncoder::E\_iso8859:}
\DoxyCodeLine{00437\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}iso8859"{}};}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \textcolor{keywordflow}{case}\ TextEncoder::E\_utf8:}
\DoxyCodeLine{00440\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}utf8"{}};}
\DoxyCodeLine{00441\ }
\DoxyCodeLine{00442\ \ \ \textcolor{keywordflow}{case}\ TextEncoder::E\_utf16be:}
\DoxyCodeLine{00443\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}utf16be"{}};}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \textcolor{keywordflow}{case}\ TextEncoder::E\_cp437:}
\DoxyCodeLine{00446\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}cp437"{}};}
\DoxyCodeLine{00447\ \ \ \};}
\DoxyCodeLine{00448\ }
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}**invalid\ TextEncoder::Encoding("{}}\ <<\ (int)encoding\ <<\ \textcolor{stringliteral}{"{})**"{}};}
\DoxyCodeLine{00450\ \}}
\DoxyCodeLine{00451\ }
\DoxyCodeLine{00455\ istream\ \&}
\DoxyCodeLine{00456\ operator\ >>\ (istream\ \&in,\ TextEncoder::Encoding\ \&encoding)\ \{}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordtype}{string}\ word;}
\DoxyCodeLine{00458\ \ \ in\ >>\ word;}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \textcolor{keywordflow}{if}\ (word\ ==\ \textcolor{stringliteral}{"{}iso8859"{}})\ \{}
\DoxyCodeLine{00461\ \ \ \ \ encoding\ =\ TextEncoder::E\_iso8859;}
\DoxyCodeLine{00462\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (word\ ==\ \textcolor{stringliteral}{"{}utf8"{}}\ ||\ word\ ==\ \textcolor{stringliteral}{"{}utf-\/8"{}})\ \{}
\DoxyCodeLine{00463\ \ \ \ \ encoding\ =\ TextEncoder::E\_utf8;}
\DoxyCodeLine{00464\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (word\ ==\ \textcolor{stringliteral}{"{}unicode"{}}\ ||\ word\ ==\ \textcolor{stringliteral}{"{}utf16be"{}}\ ||\ word\ ==\ \textcolor{stringliteral}{"{}utf-\/16be"{}}\ ||}
\DoxyCodeLine{00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ word\ ==\ \textcolor{stringliteral}{"{}utf16-\/be"{}}\ ||\ word\ ==\ \textcolor{stringliteral}{"{}utf-\/16-\/be"{}})\ \{}
\DoxyCodeLine{00466\ \ \ \ \ encoding\ =\ TextEncoder::E\_utf16be;}
\DoxyCodeLine{00467\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (word\ ==\ \textcolor{stringliteral}{"{}cp437"{}})\ \{}
\DoxyCodeLine{00468\ \ \ \ \ encoding\ =\ TextEncoder::E\_cp437;}
\DoxyCodeLine{00469\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00470\ \ \ \ \ ostream\ *notify\_ptr\ =\ \mbox{\hyperlink{classStringDecoder_ac6eb5af21cee5285e6eab4b34fc4e8f2}{StringDecoder::get\_notify\_ptr}}();}
\DoxyCodeLine{00471\ \ \ \ \ \textcolor{keywordflow}{if}\ (notify\_ptr\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00472\ \ \ \ \ \ \ (*notify\_ptr)}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ TextEncoder::Encoding:\ "{}}\ <<\ word\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00474\ \ \ \ \ \}}
\DoxyCodeLine{00475\ \ \ \ \ encoding\ =\ TextEncoder::E\_iso8859;}
\DoxyCodeLine{00476\ \ \ \}}
\DoxyCodeLine{00477\ }
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{return}\ in;}
\DoxyCodeLine{00479\ \}}

\end{DoxyCode}
