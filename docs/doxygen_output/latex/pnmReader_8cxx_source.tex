\doxysection{pnm\+Reader.\+cxx}
\hypertarget{pnmReader_8cxx_source}{}\label{pnmReader_8cxx_source}\index{panda/src/pnmimage/pnmReader.cxx@{panda/src/pnmimage/pnmReader.cxx}}
\mbox{\hyperlink{pnmReader_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{pnmReader_8h}{pnmReader.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{virtualFileSystem_8h}{virtualFileSystem.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{thread_8h}{thread.h}}"{}}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00021\ PNMReader::}
\DoxyCodeLine{00022\ \string~PNMReader()\ \{}
\DoxyCodeLine{00023\ \ \ \textcolor{keywordflow}{if}\ (\_owns\_file)\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{classVirtualFileSystem}{VirtualFileSystem}}\ *vfs\ =\ VirtualFileSystem::get\_global\_ptr();}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \textcolor{comment}{//\ We're\ assuming\ here\ that\ the\ file\ was\ opened\ via\ VFS.\ \ That\ may\ not}}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{//\ necessarily\ be\ the\ case,\ but\ we\ don't\ make\ that\ distinction.\ \ However,}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//\ at\ the\ moment\ at\ least,\ that\ distinction\ doesn't\ matter,\ since}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{comment}{//\ vfs-\/>close\_read\_file()\ just\ deletes\ the\ file\ pointer\ anyway.}}
\DoxyCodeLine{00030\ \ \ \ \ vfs-\/>close\_read\_file(\_file);}
\DoxyCodeLine{00031\ \ \ \}}
\DoxyCodeLine{00032\ \ \ \_file\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00033\ \}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00043\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPNMReader_a56daaa0d17da863f2b7768806f43303e}{PNMReader::}}}
\DoxyCodeLine{00044\ \mbox{\hyperlink{classPNMReader_a56daaa0d17da863f2b7768806f43303e}{prepare\_read}}()\ \{}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{if}\ (!\_is\_valid)\ \{}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00047\ \ \ \}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \_x\_shift\ =\ 0;}
\DoxyCodeLine{00050\ \ \ \_y\_shift\ =\ 0;}
\DoxyCodeLine{00051\ \ \ \_orig\_x\_size\ =\ \_x\_size;}
\DoxyCodeLine{00052\ \ \ \_orig\_y\_size\ =\ \_y\_size;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{classPNMReader_a807b2a3e3e62c498967feee1eab5485e}{supports\_read\_row}}())\ \{}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{//\ Maybe\ we\ can\ quick-\/filter\ each\ row\ down\ as\ we\ go.}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordflow}{if}\ (\_has\_read\_size)\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \_x\_shift\ =\ get\_reduction\_shift(\_x\_size,\ \_read\_x\_size);}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \_x\_size\ =\ \_x\_size\ /\ (1\ <<\ \_x\_shift);}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \_y\_shift\ =\ get\_reduction\_shift(\_y\_size,\ \_read\_y\_size);}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \_y\_size\ =\ \_y\_size\ /\ (1\ <<\ \_y\_shift);}
\DoxyCodeLine{00061\ \ \ \ \ \}}
\DoxyCodeLine{00062\ \ \ \}}
\DoxyCodeLine{00063\ \}}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00070\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPNMReader_a34acf9a526d3ffe9f6be1fc4617757ae}{PNMReader::}}}
\DoxyCodeLine{00071\ \mbox{\hyperlink{classPNMReader_a34acf9a526d3ffe9f6be1fc4617757ae}{is\_floating\_point}}()\ \{}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00073\ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00079\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPNMReader_ae743bce38d7eb6a951a6291ecfa84269}{PNMReader::}}}
\DoxyCodeLine{00080\ \mbox{\hyperlink{classPNMReader_ae743bce38d7eb6a951a6291ecfa84269}{read\_pfm}}(\mbox{\hyperlink{classPfmFile}{PfmFile}}\ \&pfm)\ \{}
\DoxyCodeLine{00081\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00082\ \}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classPNMReader_a244e28aedcd80a852259646cc20f6a4a}{PNMReader::}}}
\DoxyCodeLine{00094\ \mbox{\hyperlink{classPNMReader_a244e28aedcd80a852259646cc20f6a4a}{read\_data}}(\mbox{\hyperlink{structpixel}{xel}}\ *array,\ xelval\ *alpha)\ \{}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{if}\ (!is\_valid())\ \{}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \textcolor{keywordflow}{if}\ (\_x\_shift\ ==\ 0\ \&\&\ \_y\_shift\ ==\ 0)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{comment}{//\ Read\ with\ no\ reduction.}}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordtype}{int}\ y;}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPNMReader_a05f809bf76c2ef11c9cc39444b170d00}{read\_row}}(array\ +\ y\ *\ \_x\_size,\ alpha\ +\ y\ *\ \_x\_size,\ \_x\_size,\ \_y\_size))\ \{}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ y;}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00107\ \ \ \ \ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordtype}{int}\ x\_reduction\ =\ (1\ <<\ \_x\_shift);}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordtype}{int}\ y\_reduction\ =\ (1\ <<\ \_y\_shift);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{int}\ shift\ =\ \_x\_shift\ +\ \_y\_shift;}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{comment}{//\ We\ need\ a\ temporary\ buffer,\ at\ least\ one\ row\ wide,\ with\ full-\/width}}
\DoxyCodeLine{00116\ \ \ \ \ \textcolor{comment}{//\ integers,\ for\ accumulating\ pixel\ data.}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{keywordtype}{int}\ *accum\_row\_array\ =\ (\textcolor{keywordtype}{int}\ *)alloca(\_orig\_x\_size\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})\ *\ 3);}
\DoxyCodeLine{00118\ \ \ \ \ \textcolor{keywordtype}{int}\ *accum\_row\_alpha\ =\ (\textcolor{keywordtype}{int}\ *)alloca(\_orig\_x\_size\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \ \ \textcolor{comment}{//\ Each\ time\ we\ read\ a\ row,\ we\ will\ actually\ read\ the\ full\ row\ here,}}
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{comment}{//\ before\ we\ filter\ it\ down\ into\ the\ above.}}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *orig\_row\_array\ =\ (\mbox{\hyperlink{structpixel}{xel}}\ *)alloca(\_orig\_x\_size\ *\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structpixel}{xel}}));}
\DoxyCodeLine{00123\ \ \ \ \ xelval\ *orig\_row\_alpha\ =\ (xelval\ *)alloca(\_orig\_x\_size\ *\ \textcolor{keyword}{sizeof}(xelval));}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keywordtype}{int}\ y;}
\DoxyCodeLine{00126\ \ \ \ \ \textcolor{keywordflow}{for}\ (y\ =\ 0;\ y\ <\ \_y\_size;\ ++y)\ \{}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \textcolor{comment}{//\ Zero\ out\ the\ accumulation\ data,\ in\ preparation\ for\ holding\ the}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \textcolor{comment}{//\ results\ of\ the\ below.}}
\DoxyCodeLine{00129\ \ \ \ \ \ \ memset(accum\_row\_array,\ 0,\ \_x\_size\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int})\ *\ 3);}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_alpha())\ \{}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ memset(accum\_row\_alpha,\ 0,\ \_x\_size\ *\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ yi\ =\ 0;\ yi\ <\ y\_reduction;\ ++yi)\ \{}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ OK,\ read\ a\ row.\ \ This\ reads\ the\ original,\ full-\/size\ row.}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classPNMReader_a05f809bf76c2ef11c9cc39444b170d00}{read\_row}}(orig\_row\_array,\ orig\_row\_alpha,\ \_orig\_x\_size,\ \_orig\_y\_size))\ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ Thread::consider\_yield();}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ y;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Boil\ that\ row\ down\ to\ its\ proper,\ reduced\ size,\ and\ accumulate\ it}}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ into\ the\ target\ row.}}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *p\ =\ orig\_row\_array;}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *q\ =\ accum\_row\_array;}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *qstop\ =\ q\ +\ \_x\_size\ *\ 3;}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (q\ <\ qstop)\ \{}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ x\_reduction;\ ++xi)\ \{}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \ \ \ \ q[0]\ +=\ (*p).r;}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ q[1]\ +=\ (*p).g;}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ q[2]\ +=\ (*p).b;}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ ++p;}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ q\ +=\ 3;}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_alpha())\ \{}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Now\ do\ it\ again\ for\ the\ alpha\ channel.}}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ xelval\ *p\ =\ orig\_row\_alpha;}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *q\ =\ accum\_row\_alpha;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *qstop\ =\ q\ +\ \_x\_size;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (q\ <\ qstop)\ \{}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ xi\ =\ 0;\ xi\ <\ x\_reduction;\ ++xi)\ \{}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (*q)\ +=\ (*p);}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ++p;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \ \ \ \ ++q;}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \ \ \ \ \textcolor{comment}{//\ OK,\ now\ copy\ the\ accumulated\ pixel\ data\ into\ the\ final\ result.}}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *target\_row\_array\ =\ array\ +\ y\ *\ \_x\_size;}
\DoxyCodeLine{00172\ \ \ \ \ \ \ xelval\ *target\_row\_alpha\ =\ alpha\ +\ y\ *\ \_x\_size;}
\DoxyCodeLine{00173\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *p\ =\ accum\_row\_array;}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *q\ =\ target\_row\_array;}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \mbox{\hyperlink{structpixel}{xel}}\ *qstop\ =\ q\ +\ \_x\_size;}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (q\ <\ qstop)\ \{}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ (*q).r\ =\ (*p++)\ >>\ shift;}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ (*q).g\ =\ (*p++)\ >>\ shift;}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ (*q).b\ =\ (*p++)\ >>\ shift;}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ ++q;}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00183\ }
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (has\_alpha())\ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ *p\ =\ accum\_row\_alpha;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ xelval\ *q\ =\ target\_row\_alpha;}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ xelval\ *qstop\ =\ q\ +\ \_x\_size;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (q\ <\ qstop)\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ (*q)\ =\ (*p++)\ >>\ shift;}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ ++q;}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00193\ \ \ \ \ \}}
\DoxyCodeLine{00194\ \ \ \}}
\DoxyCodeLine{00195\ }
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{return}\ \_y\_size;}
\DoxyCodeLine{00198\ \}}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00206\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPNMReader_a807b2a3e3e62c498967feee1eab5485e}{PNMReader::}}}
\DoxyCodeLine{00207\ \mbox{\hyperlink{classPNMReader_a807b2a3e3e62c498967feee1eab5485e}{supports\_read\_row}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00208\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00209\ \}}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00223\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPNMReader_a05f809bf76c2ef11c9cc39444b170d00}{PNMReader::}}}
\DoxyCodeLine{00224\ \mbox{\hyperlink{classPNMReader_a05f809bf76c2ef11c9cc39444b170d00}{read\_row}}(\mbox{\hyperlink{structpixel}{xel}}\ *,\ xelval\ *,\ \textcolor{keywordtype}{int},\ \textcolor{keywordtype}{int})\ \{}
\DoxyCodeLine{00225\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00226\ \}}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ }
\DoxyCodeLine{00234\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classPNMReader_a59b5c810ff5448261bfd5ec3285c04ca}{PNMReader::}}}
\DoxyCodeLine{00235\ \mbox{\hyperlink{classPNMReader_a59b5c810ff5448261bfd5ec3285c04ca}{supports\_stream\_read}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00237\ \}}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00246\ \textcolor{keywordtype}{int}\ PNMReader::}
\DoxyCodeLine{00247\ get\_reduction\_shift(\textcolor{keywordtype}{int}\ orig\_size,\ \textcolor{keywordtype}{int}\ new\_size)\ \{}
\DoxyCodeLine{00248\ \ \ \textcolor{keywordflow}{if}\ (new\_size\ ==\ 0)\ \{}
\DoxyCodeLine{00249\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \ \ \textcolor{keywordtype}{int}\ reduction\ =\ std::max(orig\_size\ /\ new\_size,\ 1);}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \ \ \textcolor{keywordtype}{int}\ shift\ =\ 0;}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \textcolor{keywordtype}{int}\ r\ =\ 2;}
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{while}\ (r\ <=\ reduction)\ \{}
\DoxyCodeLine{00258\ \ \ \ \ shift\ +=\ 1;}
\DoxyCodeLine{00259\ \ \ \ \ r\ <<=\ 1;}
\DoxyCodeLine{00260\ \ \ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{if}\ ((orig\_size\ \%\ r)\ !=\ 0)\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{//\ If\ the\ reduction\ isn't\ even,\ never\ mind.}}
\DoxyCodeLine{00264\ \ \ \ \ shift\ =\ 0;}
\DoxyCodeLine{00265\ \ \ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00267\ \ \ \textcolor{keywordflow}{return}\ shift;}
\DoxyCodeLine{00268\ \}}

\end{DoxyCode}
