\doxysection{audio\+Volume\+Attrib.\+cxx}
\hypertarget{audioVolumeAttrib_8cxx_source}{}\label{audioVolumeAttrib_8cxx_source}\index{panda/src/pgraph/audioVolumeAttrib.cxx@{panda/src/pgraph/audioVolumeAttrib.cxx}}
\mbox{\hyperlink{audioVolumeAttrib_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{audioVolumeAttrib_8h}{audioVolumeAttrib.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsStateGuardianBase_8h}{graphicsStateGuardianBase.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::\_identity\_attrib;}
\DoxyCodeLine{00024\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ AudioVolumeAttrib::\_type\_handle;}
\DoxyCodeLine{00025\ \textcolor{keywordtype}{int}\ AudioVolumeAttrib::\_attrib\_slot;}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00030\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00031\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keywordtype}{bool}\ off,\ PN\_stdfloat\ volume)\ :}
\DoxyCodeLine{00032\ \ \ \_off(off),}
\DoxyCodeLine{00033\ \ \ \_volume(volume)}
\DoxyCodeLine{00034\ \{}
\DoxyCodeLine{00035\ \ \ nassertv(\_volume\ >=\ 0.f);}
\DoxyCodeLine{00036\ \ \ \_has\_volume\ =\ !IS\_NEARLY\_EQUAL(\_volume,\ 1.0f);}
\DoxyCodeLine{00037\ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00042\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00043\ make\_identity()\ \{}
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//\ We\ make\ identity\ a\ special\ case\ and\ store\ a\ pointer\ forever\ once\ we\ find}}
\DoxyCodeLine{00045\ \ \ \textcolor{comment}{//\ it\ the\ first\ time.}}
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{if}\ (\_identity\_attrib\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00047\ \ \ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{false},\ 1.0f);;}
\DoxyCodeLine{00048\ \ \ \ \ \_identity\_attrib\ =\ return\_new(attrib);}
\DoxyCodeLine{00049\ \ \ \}}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{return}\ \_identity\_attrib;}
\DoxyCodeLine{00052\ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00058\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00059\ make(PN\_stdfloat\ volume)\ \{}
\DoxyCodeLine{00060\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{false},\ volume);}
\DoxyCodeLine{00061\ \ \ \textcolor{keywordflow}{return}\ return\_new(attrib);}
\DoxyCodeLine{00062\ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00069\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00070\ make\_off()\ \{}
\DoxyCodeLine{00071\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{true},\ 1.0f);}
\DoxyCodeLine{00073\ \ \ \textcolor{keywordflow}{return}\ return\_new(attrib);}
\DoxyCodeLine{00074\ \}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00080\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00081\ make\_default()\ \{}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordflow}{return}\ return\_new(\textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{false},\ 1.0f));}
\DoxyCodeLine{00083\ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00089\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00090\ set\_volume(PN\_stdfloat\ volume)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00092\ \ \ assert(volume\ >=\ 0.f);}
\DoxyCodeLine{00093\ \ \ attrib-\/>\_volume\ =\ volume;}
\DoxyCodeLine{00094\ \ \ attrib-\/>\_has\_volume\ =\ !IS\_NEARLY\_EQUAL(volume,\ 1.0f);}
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{return}\ return\_new(attrib);}
\DoxyCodeLine{00096\ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00101\ \textcolor{keywordtype}{void}\ AudioVolumeAttrib::}
\DoxyCodeLine{00102\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00103\ \ \ out\ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}:"{}};}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{if}\ (is\_off())\ \{}
\DoxyCodeLine{00105\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}off"{}};}
\DoxyCodeLine{00106\ \ \ \}}
\DoxyCodeLine{00107\ \ \ \textcolor{keywordflow}{if}\ (has\_volume())\ \{}
\DoxyCodeLine{00108\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}("{}}\ <<\ get\_volume()\ <<\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!is\_off())\ \{}
\DoxyCodeLine{00111\ \ \ \ \ out\ <<\ \textcolor{stringliteral}{"{}identity"{}};}
\DoxyCodeLine{00112\ \ \ \}}
\DoxyCodeLine{00113\ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classAudioVolumeAttrib_a781173e62298730fe297a3a94670148f}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00128\ \mbox{\hyperlink{classAudioVolumeAttrib_a781173e62298730fe297a3a94670148f}{compare\_to\_impl}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderAttrib}{RenderAttrib}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00129\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *ta\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *)other;}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{if}\ (\_off\ !=\ ta-\/>\_off)\ \{}
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\_off\ -\/\ (int)ta-\/>\_off;}
\DoxyCodeLine{00133\ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (\_volume\ !=\ ta-\/>\_volume)\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{return}\ \_volume\ <\ ta-\/>\_volume\ ?\ -\/1\ :\ 1;}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00140\ \}}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00148\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classAudioVolumeAttrib_a8ee5714ee4748b89dcb60c838ba8c077}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00149\ \mbox{\hyperlink{classAudioVolumeAttrib_a8ee5714ee4748b89dcb60c838ba8c077}{get\_hash\_impl}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00150\ \ \ \textcolor{keywordtype}{size\_t}\ hash\ =\ 0;}
\DoxyCodeLine{00151\ \ \ hash\ =\ int\_hash::add\_hash(hash,\ (\textcolor{keywordtype}{int})\_off);}
\DoxyCodeLine{00152\ \ \ hash\ =\ \mbox{\hyperlink{classfloating__point__hash}{float\_hash}}().add\_hash(hash,\ \_volume);}
\DoxyCodeLine{00153\ \ \ \textcolor{keywordflow}{return}\ hash;}
\DoxyCodeLine{00154\ \}}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00167\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00168\ compose\_impl(\textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderAttrib}{RenderAttrib}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00169\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *ta\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *)other;}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (ta-\/>is\_off())\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{return}\ ta;}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(is\_off(),\ ta-\/>\_volume\ *\ \_volume);}
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{return}\ return\_new(attrib);}
\DoxyCodeLine{00177\ \}}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00185\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ AudioVolumeAttrib::}
\DoxyCodeLine{00186\ invert\_compose\_impl(\textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderAttrib}{RenderAttrib}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00187\ \ \ \textcolor{keywordflow}{if}\ (is\_off())\ \{}
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{return}\ other;}
\DoxyCodeLine{00189\ \ \ \}}
\DoxyCodeLine{00190\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *ta\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *)other;}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ PN\_stdfloat\ new\_volume\ =\ \_volume\ ==\ 0.0f\ ?\ 1.0f\ :\ ta-\/>\_volume\ /\ \_volume;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{false},\ new\_volume);}
\DoxyCodeLine{00195\ \ \ \textcolor{keywordflow}{return}\ return\_new(attrib);}
\DoxyCodeLine{00196\ \}}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00201\ \textcolor{keywordtype}{void}\ AudioVolumeAttrib::}
\DoxyCodeLine{00202\ register\_with\_read\_factory()\ \{}
\DoxyCodeLine{00203\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classAudioVolumeAttrib_a95cac2848666523b657c72f73f3c8a84}{make\_from\_bam}});}
\DoxyCodeLine{00204\ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00210\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAudioVolumeAttrib_a8d22cbe0ba6de70f9effb1add67af3ed}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00211\ \mbox{\hyperlink{classAudioVolumeAttrib_a8d22cbe0ba6de70f9effb1add67af3ed}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00212\ \ \ \mbox{\hyperlink{classRenderAttrib_a71362ffe83327f2de6b2b9ffb958d8d4}{RenderAttrib::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \textcolor{comment}{//\ We\ cheat,\ and\ modify\ the\ bam\ stream\ without\ upping\ the\ bam\ version.\ \ We}}
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//\ can\ do\ this\ since\ we\ know\ that\ no\ existing\ bam\ files\ have\ an}}
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ AudioVolumeAttrib\ in\ them.}}
\DoxyCodeLine{00217\ \ \ dg.add\_bool(\_off);}
\DoxyCodeLine{00218\ \ \ dg.add\_stdfloat(\_volume);}
\DoxyCodeLine{00219\ \}}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00226\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classAudioVolumeAttrib_a95cac2848666523b657c72f73f3c8a84}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00227\ \mbox{\hyperlink{classAudioVolumeAttrib_a95cac2848666523b657c72f73f3c8a84}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00228\ \ \ \mbox{\hyperlink{classAudioVolumeAttrib}{AudioVolumeAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAudioVolumeAttrib_a975db9cf798483423cbec2c0d0eede08}{AudioVolumeAttrib}}(\textcolor{keyword}{false},\ 1.0f);}
\DoxyCodeLine{00229\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00230\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00233\ \ \ attrib-\/>\mbox{\hyperlink{classAudioVolumeAttrib_a48f2454cc8cdcdd6a26b6a09fa3353ba}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00234\ }
\DoxyCodeLine{00235\ \ \ \textcolor{keywordflow}{return}\ attrib;}
\DoxyCodeLine{00236\ \}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00242\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classAudioVolumeAttrib_a48f2454cc8cdcdd6a26b6a09fa3353ba}{AudioVolumeAttrib::}}}
\DoxyCodeLine{00243\ \mbox{\hyperlink{classAudioVolumeAttrib_a48f2454cc8cdcdd6a26b6a09fa3353ba}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00244\ \ \ \mbox{\hyperlink{classRenderAttrib_af4f7151db19835a2e7b74b458c3563f1}{RenderAttrib::fillin}}(scan,\ manager);}
\DoxyCodeLine{00245\ }
\DoxyCodeLine{00246\ \ \ \_off\ =\ scan.get\_bool();}
\DoxyCodeLine{00247\ \ \ \_volume\ =\ scan.get\_stdfloat();}
\DoxyCodeLine{00248\ \ \ nassertv(\_volume\ >=\ 0.f);}
\DoxyCodeLine{00249\ \ \ \_has\_volume\ =\ !IS\_NEARLY\_EQUAL(\_volume,\ 1.0f);}
\DoxyCodeLine{00250\ \}}

\end{DoxyCode}
