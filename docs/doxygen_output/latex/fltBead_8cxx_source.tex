\doxysection{flt\+Bead.\+cxx}
\hypertarget{fltBead_8cxx_source}{}\label{fltBead_8cxx_source}\index{pandatool/src/flt/fltBead.cxx@{pandatool/src/flt/fltBead.cxx}}
\mbox{\hyperlink{fltBead_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltBead_8h}{fltBead.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltRecordReader_8h}{fltRecordReader.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltRecordWriter_8h}{fltRecordWriter.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformGeneralMatrix_8h}{fltTransformGeneralMatrix.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformPut_8h}{fltTransformPut.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformRotateAboutEdge_8h}{fltTransformRotateAboutEdge.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformRotateAboutPoint_8h}{fltTransformRotateAboutPoint.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformScale_8h}{fltTransformScale.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformTranslate_8h}{fltTransformTranslate.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{fltTransformRotateScale_8h}{fltTransformRotateScale.h}}"{}}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__flt_8h}{config\_flt.h}}"{}}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \textcolor{preprocessor}{\#include\ <assert.h>}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ FltBead::\_type\_handle;}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00035\ FltBead::}
\DoxyCodeLine{00036\ FltBead(\mbox{\hyperlink{classFltHeader}{FltHeader}}\ *header)\ :\ \mbox{\hyperlink{classFltRecord}{FltRecord}}(header)\ \{}
\DoxyCodeLine{00037\ \ \ \_has\_transform\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00038\ \ \ \_transform\ =\ LMatrix4d::ident\_mat();}
\DoxyCodeLine{00039\ \ \ \_replicate\_count\ =\ 0;}
\DoxyCodeLine{00040\ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00047\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltBead_af2813bd728465d813386bb1abf18b10f}{FltBead::}}}
\DoxyCodeLine{00048\ \mbox{\hyperlink{classFltBead_af2813bd728465d813386bb1abf18b10f}{has\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00049\ \ \ \textcolor{keywordflow}{return}\ \_has\_transform;}
\DoxyCodeLine{00050\ \}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{const}\ LMatrix4d\ \&\mbox{\hyperlink{classFltBead_abcc49be51a14d452e584b189cf3ce391}{FltBead::}}}
\DoxyCodeLine{00058\ \mbox{\hyperlink{classFltBead_abcc49be51a14d452e584b189cf3ce391}{get\_transform}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00059\ \ \ \textcolor{keywordflow}{return}\ \_has\_transform\ ?\ \_transform\ :\ LMatrix4d::ident\_mat();}
\DoxyCodeLine{00060\ \}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltBead_ac2962c8b7356026e8d583aa3e2f2981c}{FltBead::}}}
\DoxyCodeLine{00068\ \mbox{\hyperlink{classFltBead_ac2962c8b7356026e8d583aa3e2f2981c}{set\_transform}}(\textcolor{keyword}{const}\ LMatrix4d\ \&mat)\ \{}
\DoxyCodeLine{00069\ \ \ \mbox{\hyperlink{classFltBead_a3982d8133d99416703b53a35032aedea}{clear\_transform}}();}
\DoxyCodeLine{00070\ \ \ \mbox{\hyperlink{classFltTransformGeneralMatrix}{FltTransformGeneralMatrix}}\ *step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformGeneralMatrix}{FltTransformGeneralMatrix}}(\_header);}
\DoxyCodeLine{00071\ \ \ step-\/>\mbox{\hyperlink{classFltTransformGeneralMatrix_af0a45be611185fa383d93a9ad3eaf74b}{set\_matrix}}(mat);}
\DoxyCodeLine{00072\ \ \ \mbox{\hyperlink{classFltBead_a6de5a61706a5e7815a078174e8a97a3b}{add\_transform\_step}}(step);}
\DoxyCodeLine{00073\ \}}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00078\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltBead_a3982d8133d99416703b53a35032aedea}{FltBead::}}}
\DoxyCodeLine{00079\ \mbox{\hyperlink{classFltBead_a3982d8133d99416703b53a35032aedea}{clear\_transform}}()\ \{}
\DoxyCodeLine{00080\ \ \ \_has\_transform\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00081\ \ \ \_transform\ =\ LMatrix4d::ident\_mat();}
\DoxyCodeLine{00082\ \ \ \_transform\_steps.clear();}
\DoxyCodeLine{00083\ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00091\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltBead_a0adf85d10f0fe54243e51eda91d118aa}{FltBead::}}}
\DoxyCodeLine{00092\ \mbox{\hyperlink{classFltBead_a0adf85d10f0fe54243e51eda91d118aa}{get\_num\_transform\_steps}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00093\ \ \ \textcolor{keywordflow}{return}\ \_transform\_steps.size();}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00100\ \mbox{\hyperlink{classFltTransformRecord}{FltTransformRecord}}\ *\mbox{\hyperlink{classFltBead_ab34247028be80d302b277b9742c95e73}{FltBead::}}}
\DoxyCodeLine{00101\ \mbox{\hyperlink{classFltBead_ab34247028be80d302b277b9742c95e73}{get\_transform\_step}}(\textcolor{keywordtype}{int}\ n)\ \{}
\DoxyCodeLine{00102\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_transform\_steps.size(),}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{return}\ \_transform\_steps[n];}
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00111\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFltTransformRecord}{FltTransformRecord}}\ *\mbox{\hyperlink{classFltBead_ab34247028be80d302b277b9742c95e73}{FltBead::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classFltBead_ab34247028be80d302b277b9742c95e73}{get\_transform\_step}}(\textcolor{keywordtype}{int}\ n)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00113\ \ \ nassertr(n\ >=\ 0\ \&\&\ n\ <\ (\textcolor{keywordtype}{int})\_transform\_steps.size(),}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{return}\ \_transform\_steps[n];}
\DoxyCodeLine{00116\ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00122\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltBead_a6de5a61706a5e7815a078174e8a97a3b}{FltBead::}}}
\DoxyCodeLine{00123\ \mbox{\hyperlink{classFltBead_a6de5a61706a5e7815a078174e8a97a3b}{add\_transform\_step}}(\mbox{\hyperlink{classFltTransformRecord}{FltTransformRecord}}\ *record)\ \{}
\DoxyCodeLine{00124\ \ \ \textcolor{keywordflow}{if}\ (!\_has\_transform)\ \{}
\DoxyCodeLine{00125\ \ \ \ \ \_has\_transform\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00126\ \ \ \ \ \_transform\ =\ record-\/>get\_matrix();}
\DoxyCodeLine{00127\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00128\ \ \ \ \ \_transform\ =\ record-\/>get\_matrix()\ *\ \_transform;}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ \ \ \_transform\_steps.push\_back(record);}
\DoxyCodeLine{00131\ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00140\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classFltBead_a5bbe14dce6b7b5e0e349f07030532978}{FltBead::}}}
\DoxyCodeLine{00141\ \mbox{\hyperlink{classFltBead_a5bbe14dce6b7b5e0e349f07030532978}{get\_replicate\_count}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00142\ \ \ \textcolor{keywordflow}{return}\ \_replicate\_count;}
\DoxyCodeLine{00143\ \}}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00150\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classFltBead_ad358fd3c6941722a3856610cedf2b05a}{FltBead::}}}
\DoxyCodeLine{00151\ \mbox{\hyperlink{classFltBead_ad358fd3c6941722a3856610cedf2b05a}{set\_replicate\_count}}(\textcolor{keywordtype}{int}\ count)\ \{}
\DoxyCodeLine{00152\ \ \ \_replicate\_count\ =\ count;}
\DoxyCodeLine{00153\ \}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00160\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltBead_aa7f14f94671d6c17799f936a0b52ad32}{FltBead::}}}
\DoxyCodeLine{00161\ \mbox{\hyperlink{classFltBead_aa7f14f94671d6c17799f936a0b52ad32}{extract\_record}}(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{00162\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFltRecord_a5f5d9e6ee028b283b410e3daa72dedfa}{FltRecord::extract\_record}}(reader))\ \{}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00164\ \ \ \}}
\DoxyCodeLine{00165\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00166\ \}}
\DoxyCodeLine{00167\ }
\DoxyCodeLine{00173\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltBead_a41f0d9907d145be650dcc69415acc4ea}{FltBead::}}}
\DoxyCodeLine{00174\ \mbox{\hyperlink{classFltBead_a41f0d9907d145be650dcc69415acc4ea}{extract\_ancillary}}(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classFltTransformRecord}{FltTransformRecord}}\ *step\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{keywordflow}{switch}\ (reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}())\ \{}
\DoxyCodeLine{00178\ \ \ \textcolor{keywordflow}{case}\ FO\_transform\_matrix:}
\DoxyCodeLine{00179\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_transform\_matrix(reader);}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \textcolor{keywordflow}{case}\ FO\_general\_matrix:}
\DoxyCodeLine{00182\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformGeneralMatrix}{FltTransformGeneralMatrix}}(\_header);}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ \textcolor{keywordflow}{case}\ FO\_put:}
\DoxyCodeLine{00186\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformPut}{FltTransformPut}}(\_header);}
\DoxyCodeLine{00187\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordflow}{case}\ FO\_rotate\_about\_edge:}
\DoxyCodeLine{00190\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformRotateAboutEdge}{FltTransformRotateAboutEdge}}(\_header);}
\DoxyCodeLine{00191\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{case}\ FO\_rotate\_about\_point:}
\DoxyCodeLine{00194\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformRotateAboutPoint}{FltTransformRotateAboutPoint}}(\_header);}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \textcolor{keywordflow}{case}\ FO\_scale:}
\DoxyCodeLine{00198\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformScale}{FltTransformScale}}(\_header);}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \textcolor{keywordflow}{case}\ FO\_translate:}
\DoxyCodeLine{00202\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformTranslate}{FltTransformTranslate}}(\_header);}
\DoxyCodeLine{00203\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \textcolor{keywordflow}{case}\ FO\_rotate\_and\_scale:}
\DoxyCodeLine{00206\ \ \ \ \ step\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classFltTransformRotateScale}{FltTransformRotateScale}}(\_header);}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{case}\ FO\_replicate:}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordflow}{return}\ extract\_replicate\_count(reader);}
\DoxyCodeLine{00211\ }
\DoxyCodeLine{00212\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00213\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltRecord_aa43385dcb64df0bbab4dee6cf11900ce}{FltRecord::extract\_ancillary}}(reader);}
\DoxyCodeLine{00214\ \ \ \}}
\DoxyCodeLine{00215\ }
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ A\ transform\ step.}}
\DoxyCodeLine{00217\ \ \ nassertr(step\ !=\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00218\ \ \ \textcolor{keywordflow}{if}\ (!step-\/>\mbox{\hyperlink{classFltRecord_a5f5d9e6ee028b283b410e3daa72dedfa}{extract\_record}}(reader))\ \{}
\DoxyCodeLine{00219\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00220\ \ \ \}}
\DoxyCodeLine{00221\ \ \ \_transform\_steps.push\_back(DCAST(\mbox{\hyperlink{classFltTransformRecord}{FltTransformRecord}},\ step));}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00224\ \}}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00231\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classFltBead_a41f86521b509cf414727db5a009b4a13}{FltBead::}}}
\DoxyCodeLine{00232\ \mbox{\hyperlink{classFltBead_a41f86521b509cf414727db5a009b4a13}{build\_record}}(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00233\ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{classFltRecord_a12b3593fb8871e8f2b59cf61df9137a4}{FltRecord::build\_record}}(writer))\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00235\ \ \ \}}
\DoxyCodeLine{00236\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00237\ \}}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00243\ FltError\ \mbox{\hyperlink{classFltBead_a19082dbd88798acbd2a092fe1c37b005}{FltBead::}}}
\DoxyCodeLine{00244\ \mbox{\hyperlink{classFltBead_a19082dbd88798acbd2a092fe1c37b005}{write\_ancillary}}(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00245\ \ \ \textcolor{keywordflow}{if}\ (\_has\_transform)\ \{}
\DoxyCodeLine{00246\ \ \ \ \ FltError\ result\ =\ write\_transform(writer);}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \}}
\DoxyCodeLine{00251\ \ \ \textcolor{keywordflow}{if}\ (\_replicate\_count\ !=\ 0)\ \{}
\DoxyCodeLine{00252\ \ \ \ \ FltError\ result\ =\ write\_replicate\_count(writer);}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00255\ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \}}
\DoxyCodeLine{00257\ }
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classFltRecord_a29b9805648e2c06fceb525a4210c569a}{FltRecord::write\_ancillary}}(writer);}
\DoxyCodeLine{00260\ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00267\ \textcolor{keywordtype}{bool}\ FltBead::}
\DoxyCodeLine{00268\ extract\_transform\_matrix(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{00269\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_transform\_matrix,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00270\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ LMatrix4d\ matrix;}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ r\ =\ 0;\ r\ <\ 4;\ r++)\ \{}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ 4;\ c++)\ \{}
\DoxyCodeLine{00275\ \ \ \ \ \ \ matrix(r,\ c)\ =\ iterator.get\_be\_float32();}
\DoxyCodeLine{00276\ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \}}
\DoxyCodeLine{00278\ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator);}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ \ \ \_transform\_steps.clear();}
\DoxyCodeLine{00281\ \ \ \_has\_transform\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00282\ \ \ \_transform\ =\ matrix;}
\DoxyCodeLine{00283\ }
\DoxyCodeLine{00284\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00285\ \}}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00290\ \textcolor{keywordtype}{bool}\ FltBead::}
\DoxyCodeLine{00291\ extract\_replicate\_count(\mbox{\hyperlink{classFltRecordReader}{FltRecordReader}}\ \&reader)\ \{}
\DoxyCodeLine{00292\ \ \ nassertr(reader.\mbox{\hyperlink{classFltRecordReader_a1d483675fbd7410cb7ff14055b2e972f}{get\_opcode}}()\ ==\ FO\_replicate,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00293\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&iterator\ =\ reader.\mbox{\hyperlink{classFltRecordReader_aa9b8c65ee16aaebdcb07e230d7abe9af}{get\_iterator}}();}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \_replicate\_count\ =\ iterator.get\_be\_int16();}
\DoxyCodeLine{00296\ \ \ iterator.skip\_bytes(2);}
\DoxyCodeLine{00297\ }
\DoxyCodeLine{00298\ \ \ \mbox{\hyperlink{classFltRecord_ab004dc18d172af7a6c8ac97d545649d0}{check\_remaining\_size}}(iterator);}
\DoxyCodeLine{00299\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00300\ \}}
\DoxyCodeLine{00301\ }
\DoxyCodeLine{00305\ FltError\ FltBead::}
\DoxyCodeLine{00306\ write\_transform(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00307\ \ \ \textcolor{comment}{//\ First,\ write\ out\ the\ initial\ transform\ indication.}}
\DoxyCodeLine{00308\ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_transform\_matrix);}
\DoxyCodeLine{00309\ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ r\ =\ 0;\ r\ <\ 4;\ r++)\ \{}
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ c\ =\ 0;\ c\ <\ 4;\ c++)\ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ datagram.add\_be\_float32(\_transform(r,\ c));}
\DoxyCodeLine{00314\ \ \ \ \ \}}
\DoxyCodeLine{00315\ \ \ \}}
\DoxyCodeLine{00316\ }
\DoxyCodeLine{00317\ \ \ FltError\ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{00318\ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00320\ \ \ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//\ Now,\ write\ out\ each\ of\ the\ steps\ of\ the\ transform.}}
\DoxyCodeLine{00323\ \ \ Transforms::const\_iterator\ ti;}
\DoxyCodeLine{00324\ \ \ \textcolor{keywordflow}{for}\ (ti\ =\ \_transform\_steps.begin();\ ti\ !=\ \_transform\_steps.end();\ ++ti)\ \{}
\DoxyCodeLine{00325\ \ \ \ \ \textcolor{keywordflow}{if}\ (!(*ti)-\/>build\_record(writer))\ \{}
\DoxyCodeLine{00326\ \ \ \ \ \ \ assert(!flt\_error\_abort);}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ FE\_invalid\_record;}
\DoxyCodeLine{00328\ \ \ \ \ \}}
\DoxyCodeLine{00329\ \ \ \ \ FltError\ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{00330\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00332\ \ \ \ \ \}}
\DoxyCodeLine{00333\ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{00336\ \}}
\DoxyCodeLine{00337\ }
\DoxyCodeLine{00341\ FltError\ FltBead::}
\DoxyCodeLine{00342\ write\_replicate\_count(\mbox{\hyperlink{classFltRecordWriter}{FltRecordWriter}}\ \&writer)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00343\ \ \ \textcolor{keywordflow}{if}\ (\_replicate\_count\ !=\ 0)\ \{}
\DoxyCodeLine{00344\ \ \ \ \ writer.\mbox{\hyperlink{classFltRecordWriter_ab4fed0f789be2d741ccc6913cf49fd2b}{set\_opcode}}(FO\_replicate);}
\DoxyCodeLine{00345\ \ \ \ \ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&datagram\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ac133f95f301e87e4142072f1edd123e9}{update\_datagram}}();}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ datagram.add\_be\_int16(\_replicate\_count);}
\DoxyCodeLine{00348\ \ \ \ \ datagram.pad\_bytes(2);}
\DoxyCodeLine{00349\ }
\DoxyCodeLine{00350\ \ \ \ \ FltError\ result\ =\ writer.\mbox{\hyperlink{classFltRecordWriter_ab52d19f4f42cab35a2bb99a1d6ca823a}{advance}}();}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{keywordflow}{if}\ (result\ !=\ FE\_ok)\ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00353\ \ \ \ \ \}}
\DoxyCodeLine{00354\ \ \ \}}
\DoxyCodeLine{00355\ }
\DoxyCodeLine{00356\ \ \ \textcolor{keywordflow}{return}\ FE\_ok;}
\DoxyCodeLine{00357\ \}}

\end{DoxyCode}
