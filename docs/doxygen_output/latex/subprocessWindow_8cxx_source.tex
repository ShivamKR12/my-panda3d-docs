\doxysection{subprocess\+Window.\+cxx}
\hypertarget{subprocessWindow_8cxx_source}{}\label{subprocessWindow_8cxx_source}\index{panda/src/display/subprocessWindow.cxx@{panda/src/display/subprocessWindow.cxx}}
\mbox{\hyperlink{subprocessWindow_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{subprocessWindow_8h}{subprocessWindow.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#ifdef\ SUPPORT\_SUBPROCESS\_WINDOW}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsEngine_8h}{graphicsEngine.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__display_8h}{config\_display.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{nativeWindowHandle_8h}{nativeWindowHandle.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mouseButton_8h}{mouseButton.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{throw__event_8h}{throw\_event.h}}"{}}}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ SubprocessWindow::\_type\_handle;}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00032\ SubprocessWindow::}
\DoxyCodeLine{00033\ SubprocessWindow(\mbox{\hyperlink{classGraphicsEngine}{GraphicsEngine}}\ *engine,\ \mbox{\hyperlink{classGraphicsPipe}{GraphicsPipe}}\ *pipe,}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{string}\ \&name,}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classFrameBufferProperties}{FrameBufferProperties}}\ \&fb\_prop,}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ \&win\_prop,}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ flags,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsStateGuardian}{GraphicsStateGuardian}}\ *gsg,}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *host)\ :}
\DoxyCodeLine{00040\ \ \ \mbox{\hyperlink{classGraphicsWindow}{GraphicsWindow}}(engine,\ pipe,\ name,\ fb\_prop,\ win\_prop,\ flags,\ gsg,\ host)}
\DoxyCodeLine{00041\ \{}
\DoxyCodeLine{00042\ \ \ \_input\ =\ GraphicsWindowInputDevice::pointer\_and\_keyboard(\textcolor{keyword}{this},\ \textcolor{stringliteral}{"{}keyboard/mouse"{}});}
\DoxyCodeLine{00043\ \ \ \_input\_devices.push\_back(\_input.p());}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{comment}{//\ This\ will\ be\ an\ offscreen\ buffer\ that\ we\ use\ to\ render\ the\ actual}}
\DoxyCodeLine{00046\ \ \ \textcolor{comment}{//\ contents.}}
\DoxyCodeLine{00047\ \ \ \_buffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Create\ a\ texture\ to\ receive\ the\ contents\ of\ the\ framebuffer\ from\ the}}
\DoxyCodeLine{00050\ \ \ \textcolor{comment}{//\ offscreen\ buffer.}}
\DoxyCodeLine{00051\ \ \ \_texture\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTexture}{Texture}}(name);}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \_fd\ =\ -\/1;}
\DoxyCodeLine{00054\ \ \ \_mmap\_size\ =\ 0;}
\DoxyCodeLine{00055\ \ \ \_filename\ =\ string();}
\DoxyCodeLine{00056\ \ \ \_swbuffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00057\ \ \ \_last\_event\_flags\ =\ 0;}
\DoxyCodeLine{00058\ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00063\ SubprocessWindow::}
\DoxyCodeLine{00064\ \string~SubprocessWindow()\ \{}
\DoxyCodeLine{00065\ \ \ nassertv(\_buffer\ ==\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00066\ \ \ nassertv(\_swbuffer\ ==\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00067\ \}}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00076\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00077\ process\_events()\ \{}
\DoxyCodeLine{00078\ \ \ \mbox{\hyperlink{classGraphicsWindow_ac73229408c1c588f30e690a8f4947917}{GraphicsWindow::process\_events}}();}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \ \ \textcolor{keywordflow}{if}\ (\_swbuffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{classSubprocessWindowBuffer_1_1Event}{SubprocessWindowBuffer::Event}}\ swb\_event;}
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{keywordflow}{while}\ (\_swbuffer-\/>get\_event(swb\_event))\ \{}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \textcolor{comment}{//\ Deal\ with\ this\ event.}}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_mouse\_position)\ \{}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \_input-\/>set\_pointer\_in\_window(swb\_event.\_x,\ swb\_event.\_y);}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ ((swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_has\_mouse)\ ==\ 0)\ \{}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \_input-\/>set\_pointer\_out\_of\_window();}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ diff\ =\ swb\_event.\_flags\ \string^\ \_last\_event\_flags;}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \_last\_event\_flags\ =\ swb\_event.\_flags;}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ \&\ SubprocessWindowBuffer::EF\_shift\_held)\ \{}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ transition\_button(swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_shift\_held,\ KeyboardButton::shift());}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ \&\ SubprocessWindowBuffer::EF\_control\_held)\ \{}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ transition\_button(swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_control\_held,\ KeyboardButton::control());}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ \&\ SubprocessWindowBuffer::EF\_alt\_held)\ \{}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ transition\_button(swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_alt\_held,\ KeyboardButton::alt());}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (diff\ \&\ SubprocessWindowBuffer::EF\_meta\_held)\ \{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ transition\_button(swb\_event.\_flags\ \&\ SubprocessWindowBuffer::EF\_meta\_held,\ KeyboardButton::meta());}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ \ \ \ \ \mbox{\hyperlink{classButtonHandle}{ButtonHandle}}\ button\ =\ ButtonHandle::none();}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (swb\_event.\_source\ ==\ SubprocessWindowBuffer::ES\_mouse)\ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ button\ =\ MouseButton::button(swb\_event.\_code);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (swb\_event.\_source\ ==\ SubprocessWindowBuffer::ES\_keyboard)\ \{}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ keycode;}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ button\ =\ translate\_key(keycode,\ swb\_event.\_code,\ swb\_event.\_flags);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (keycode\ !=\ 0\ \&\&\ swb\_event.\_type\ !=\ SubprocessWindowBuffer::ET\_button\_up)\ \{}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \_input-\/>keystroke(keycode);}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (swb\_event.\_type\ ==\ SubprocessWindowBuffer::ET\_button\_up)\ \{}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \_input-\/>button\_up(button);}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (swb\_event.\_type\ ==\ SubprocessWindowBuffer::ET\_button\_down)\ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \_input-\/>button\_down(button);}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00123\ \ \ \ \ \}}
\DoxyCodeLine{00124\ \ \ \}}
\DoxyCodeLine{00125\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00133\ \textcolor{keywordtype}{bool}\ SubprocessWindow::}
\DoxyCodeLine{00134\ begin\_frame(FrameMode\ mode,\ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordflow}{if}\ (\_swbuffer\ ==\ \textcolor{keyword}{nullptr}\ ||\ \_buffer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00137\ \ \ \}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \textcolor{keywordtype}{bool}\ result\ =\ \_buffer-\/>begin\_frame(mode,\ current\_thread);}
\DoxyCodeLine{00140\ \ \ \textcolor{keywordflow}{return}\ result;}
\DoxyCodeLine{00141\ \}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00148\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00149\ end\_frame(FrameMode\ mode,\ \mbox{\hyperlink{classThread}{Thread}}\ *current\_thread)\ \{}
\DoxyCodeLine{00150\ \ \ \_buffer-\/>end\_frame(mode,\ current\_thread);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00152\ \ \ \textcolor{keywordflow}{if}\ (mode\ ==\ FM\_render)\ \{}
\DoxyCodeLine{00153\ \ \ \ \ \_flip\_ready\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00154\ \ \ \}}
\DoxyCodeLine{00155\ \}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00168\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00169\ begin\_flip()\ \{}
\DoxyCodeLine{00170\ \ \ nassertv(\_buffer\ !=\ \textcolor{keyword}{nullptr});}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordflow}{if}\ (\_swbuffer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00173\ \ \ \}}
\DoxyCodeLine{00174\ }
\DoxyCodeLine{00175\ \ \ \mbox{\hyperlink{classRenderBuffer}{RenderBuffer}}\ buffer(\_gsg,\ \mbox{\hyperlink{classDrawableRegion_a56dc4a58eab41fbf0918aa67f7779461}{DrawableRegion::get\_renderbuffer\_type}}(RTP\_color));}
\DoxyCodeLine{00176\ \ \ buffer\ =\ \_gsg-\/>get\_render\_buffer(\_buffer-\/>get\_draw\_buffer\_type(),}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_buffer-\/>get\_fb\_properties());}
\DoxyCodeLine{00178\ }
\DoxyCodeLine{00179\ \ \ \textcolor{keywordtype}{bool}\ copied\ =}
\DoxyCodeLine{00180\ \ \ \ \ \_gsg-\/>framebuffer\_copy\_to\_ram(\_texture,\ 0,\ -\/1,}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_overlay\_display\_region,\ buffer);}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \textcolor{keywordflow}{if}\ (copied)\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \mbox{\hyperlink{classConstPointerToArray}{CPTA\_uchar}}\ image\ =\ \_texture-\/>get\_ram\_image();}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ framebuffer\_size\ =\ \_swbuffer-\/>get\_framebuffer\_size();}
\DoxyCodeLine{00186\ \ \ \ \ nassertv(image.size()\ ==\ framebuffer\_size);}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\_swbuffer-\/>ready\_for\_write())\ \{}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ to\ wait\ for\ the\ other\ end\ to\ remove\ the\ last\ frame\ we}}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \textcolor{comment}{//\ rendered.\ \ We\ only\ wait\ so\ long\ before\ we\ give\ up,\ so\ we\ don't}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \textcolor{comment}{//\ completely\ starve\ the\ Python\ process\ just\ because\ the\ render\ window}}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \textcolor{comment}{//\ is\ offscreen\ or\ something.}}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \ \ \ \ \mbox{\hyperlink{classClockObject}{ClockObject}}\ *clock\ =\ ClockObject::get\_global\_clock();}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ start\ =\ clock-\/>get\_real\_time();}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (!\_swbuffer-\/>ready\_for\_write())\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ Thread::force\_yield();}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ now\ =\ clock-\/>get\_real\_time();}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (now\ -\/\ start\ >\ subprocess\_window\_max\_wait)\ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Never\ mind.}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00204\ \ \ \ \ \}}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{comment}{//\ We're\ ready\ to\ go.\ \ Copy\ the\ image\ to\ our\ shared\ framebuffer.}}
\DoxyCodeLine{00207\ \ \ \ \ \textcolor{keywordtype}{void}\ *target\ =\ \_swbuffer-\/>open\_write\_framebuffer();}
\DoxyCodeLine{00208\ \ \ \ \ memcpy(target,\ image.p(),\ framebuffer\_size);}
\DoxyCodeLine{00209\ \ \ \ \ \_swbuffer-\/>close\_write\_framebuffer();}
\DoxyCodeLine{00210\ \ \ \}}
\DoxyCodeLine{00211\ \}}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00227\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00228\ set\_properties\_now(\mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ \&properties)\ \{}
\DoxyCodeLine{00229\ \ \ \mbox{\hyperlink{classFilename}{Filename}}\ filename;}
\DoxyCodeLine{00230\ \ \ \mbox{\hyperlink{classWindowHandle}{WindowHandle}}\ *window\_handle\ =\ properties.get\_parent\_window();}
\DoxyCodeLine{00231\ \ \ \textcolor{keywordflow}{if}\ (window\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00232\ \ \ \ \ WindowHandle::OSHandle\ *os\_handle\ =\ window\_handle-\/>get\_os\_handle();}
\DoxyCodeLine{00233\ \ \ \ \ \textcolor{keywordflow}{if}\ (os\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (os\_handle-\/>is\_of\_type(NativeWindowHandle::SubprocessHandle::get\_class\_type()))\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classNativeWindowHandle_1_1SubprocessHandle}{NativeWindowHandle::SubprocessHandle}}\ *subprocess\_handle\ =\ DCAST(\mbox{\hyperlink{classNativeWindowHandle_1_1SubprocessHandle}{NativeWindowHandle::SubprocessHandle}},\ os\_handle);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ filename\ =\ subprocess\_handle-\/>get\_filename();}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00238\ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{if}\ (!filename.empty()\ \&\&\ filename\ !=\ \_filename)\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{comment}{//\ We're\ changing\ the\ subprocess\ buffer\ filename;\ that\ means\ we\ might\ as}}
\DoxyCodeLine{00243\ \ \ \ \ \textcolor{comment}{//\ well\ completely\ close\ and\ re-\/open\ the\ window.}}
\DoxyCodeLine{00244\ \ \ \ \ display\_cat.info()\ <<\ \textcolor{stringliteral}{"{}Re-\/opening\ SubprocessWindow\(\backslash\)n"{}};}
\DoxyCodeLine{00245\ \ \ \ \ internal\_close\_window();}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \_properties.add\_properties(properties);}
\DoxyCodeLine{00248\ \ \ \ \ properties.\mbox{\hyperlink{classWindowProperties_a4d1f3070c100c25f9dfc937be8347fd4}{clear}}();}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ internal\_open\_window();}
\DoxyCodeLine{00251\ \ \ \ \ set\_size\_and\_recalc(\_properties.get\_x\_size(),\ \_properties.get\_y\_size());}
\DoxyCodeLine{00252\ \ \ \ \ throw\_event(get\_window\_event(),\ \textcolor{keyword}{this});}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00254\ \ \ \}}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \mbox{\hyperlink{classGraphicsWindow_adeb1896f5f72fd2959b76dbfb8ca1fe9}{GraphicsWindow::set\_properties\_now}}(properties);}
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{if}\ (!properties.is\_any\_specified())\ \{}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{comment}{//\ The\ base\ class\ has\ already\ handled\ this\ case.}}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00260\ \ \ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \textcolor{keywordflow}{if}\ (properties.has\_parent\_window())\ \{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{comment}{//\ Redundant\ parent-\/window\ specification.}}
\DoxyCodeLine{00264\ \ \ \ \ properties.clear\_parent\_window();}
\DoxyCodeLine{00265\ \ \ \}}
\DoxyCodeLine{00266\ \}}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00271\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00272\ close\_window()\ \{}
\DoxyCodeLine{00273\ \ \ internal\_close\_window();}
\DoxyCodeLine{00274\ }
\DoxyCodeLine{00275\ \ \ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ properties;}
\DoxyCodeLine{00276\ \ \ properties.set\_open(\textcolor{keyword}{false});}
\DoxyCodeLine{00277\ \ \ properties.set\_foreground(\textcolor{keyword}{false});}
\DoxyCodeLine{00278\ \ \ system\_changed\_properties(properties);}
\DoxyCodeLine{00279\ \}}
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00285\ \textcolor{keywordtype}{bool}\ SubprocessWindow::}
\DoxyCodeLine{00286\ open\_window()\ \{}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{if}\ (!internal\_open\_window())\ \{}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00289\ \ \ \}}
\DoxyCodeLine{00290\ }
\DoxyCodeLine{00291\ \ \ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ properties;}
\DoxyCodeLine{00292\ \ \ properties.set\_open(\textcolor{keyword}{true});}
\DoxyCodeLine{00293\ \ \ properties.set\_foreground(\textcolor{keyword}{true});}
\DoxyCodeLine{00294\ \ \ system\_changed\_properties(properties);}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00297\ \}}
\DoxyCodeLine{00298\ }
\DoxyCodeLine{00303\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00304\ internal\_close\_window()\ \{}
\DoxyCodeLine{00305\ \ \ \textcolor{keywordflow}{if}\ (\_swbuffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \mbox{\hyperlink{classSubprocessWindowBuffer_aa4aa0474d26960a22d7cd2769f506acd}{SubprocessWindowBuffer::close\_buffer}}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ (\_fd,\ \_mmap\_size,\ \_filename.to\_os\_specific(),\ \_swbuffer);}
\DoxyCodeLine{00308\ \ \ \ \ \_fd\ =\ -\/1;}
\DoxyCodeLine{00309\ \ \ \ \ \_filename\ =\ string();}
\DoxyCodeLine{00310\ }
\DoxyCodeLine{00311\ \ \ \ \ \_swbuffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00312\ \ \ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \textcolor{keywordflow}{if}\ (\_buffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00315\ \ \ \ \ \_buffer-\/>request\_close();}
\DoxyCodeLine{00316\ \ \ \ \ \_buffer-\/>process\_events();}
\DoxyCodeLine{00317\ \ \ \ \ \_engine-\/>remove\_window(\_buffer);}
\DoxyCodeLine{00318\ \ \ \ \ \_buffer\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{comment}{//\ Tell\ our\ parent\ window\ (if\ any)\ that\ we're\ no\ longer\ its\ child.}}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordflow}{if}\ (\_window\_handle\ !=\ \textcolor{keyword}{nullptr}\ \&\&}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \_parent\_window\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00324\ \ \ \ \ \_parent\_window\_handle-\/>detach\_child(\_window\_handle);}
\DoxyCodeLine{00325\ \ \ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \_window\_handle\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00328\ \ \ \_parent\_window\_handle\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00329\ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00330\ \}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00336\ \textcolor{keywordtype}{bool}\ SubprocessWindow::}
\DoxyCodeLine{00337\ internal\_open\_window()\ \{}
\DoxyCodeLine{00338\ \ \ nassertr(\_buffer\ ==\ \textcolor{keyword}{nullptr},\ \textcolor{keyword}{false});}
\DoxyCodeLine{00339\ }
\DoxyCodeLine{00340\ \ \ \textcolor{comment}{//\ Create\ a\ buffer\ with\ the\ same\ properties\ as\ the\ window.}}
\DoxyCodeLine{00341\ \ \ \textcolor{keywordtype}{int}\ flags\ =\ \_creation\_flags;}
\DoxyCodeLine{00342\ \ \ flags\ =\ ((flags\ \&\ \mbox{\hyperlink{classGraphicsPipe}{\string~GraphicsPipe}}::BF\_require\_window)\ |\ GraphicsPipe::BF\_refuse\_window);}
\DoxyCodeLine{00343\ \ \ \mbox{\hyperlink{classWindowProperties}{WindowProperties}}\ win\_props\ =\ \mbox{\hyperlink{classWindowProperties_a19ea6ad41750bd4e983f64ee9e507d02}{WindowProperties::size}}(\_properties.get\_x\_size(),\ \_properties.get\_y\_size());}
\DoxyCodeLine{00344\ }
\DoxyCodeLine{00345\ \ \ \mbox{\hyperlink{classGraphicsOutput}{GraphicsOutput}}\ *buffer\ =}
\DoxyCodeLine{00346\ \ \ \ \ \_engine-\/>make\_output(\_pipe,\ \_name,\ 0,\ \_fb\_properties,\ win\_props,}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ flags,\ \_gsg,\ \_host);}
\DoxyCodeLine{00348\ \ \ \textcolor{keywordflow}{if}\ (buffer\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00349\ \ \ \ \ \_buffer\ =\ DCAST(\mbox{\hyperlink{classGraphicsBuffer}{GraphicsBuffer}},\ buffer);}
\DoxyCodeLine{00350\ \ \ \ \ \textcolor{comment}{//\ However,\ the\ buffer\ is\ not\ itself\ intended\ to\ be\ rendered.\ \ We\ only}}
\DoxyCodeLine{00351\ \ \ \ \ \textcolor{comment}{//\ render\ it\ indirectly,\ via\ callbacks\ in\ here.}}
\DoxyCodeLine{00352\ \ \ \ \ \_buffer-\/>set\_active(\textcolor{keyword}{false});}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \_buffer-\/>request\_open();}
\DoxyCodeLine{00355\ \ \ \ \ \_buffer-\/>process\_events();}
\DoxyCodeLine{00356\ }
\DoxyCodeLine{00357\ \ \ \ \ \_is\_valid\ =\ \_buffer-\/>is\_valid();}
\DoxyCodeLine{00358\ \ \ \}}
\DoxyCodeLine{00359\ }
\DoxyCodeLine{00360\ \ \ \textcolor{keywordflow}{if}\ (!\_is\_valid)\ \{}
\DoxyCodeLine{00361\ \ \ \ \ display\_cat.error()}
\DoxyCodeLine{00362\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ SubprocessWindowBuffer's\ internal\ offscreen\ buffer.\(\backslash\)n"{}};}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00364\ \ \ \}}
\DoxyCodeLine{00365\ }
\DoxyCodeLine{00366\ \ \ \_gsg\ =\ \_buffer-\/>get\_gsg();}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \mbox{\hyperlink{classWindowHandle}{WindowHandle}}\ *window\_handle\ =\ \_properties.get\_parent\_window();}
\DoxyCodeLine{00369\ \ \ \textcolor{keywordflow}{if}\ (window\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00370\ \ \ \ \ WindowHandle::OSHandle\ *os\_handle\ =\ window\_handle-\/>get\_os\_handle();}
\DoxyCodeLine{00371\ \ \ \ \ \textcolor{keywordflow}{if}\ (os\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (os\_handle-\/>is\_of\_type(NativeWindowHandle::SubprocessHandle::get\_class\_type()))\ \{}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classNativeWindowHandle_1_1SubprocessHandle}{NativeWindowHandle::SubprocessHandle}}\ *subprocess\_handle\ =\ DCAST(\mbox{\hyperlink{classNativeWindowHandle_1_1SubprocessHandle}{NativeWindowHandle::SubprocessHandle}},\ os\_handle);}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \_filename\ =\ subprocess\_handle-\/>get\_filename();}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00376\ \ \ \ \ \}}
\DoxyCodeLine{00377\ \ \ \}}
\DoxyCodeLine{00378\ \ \ \_parent\_window\_handle\ =\ window\_handle;}
\DoxyCodeLine{00379\ }
\DoxyCodeLine{00380\ \ \ \textcolor{keywordflow}{if}\ (\_filename.empty())\ \{}
\DoxyCodeLine{00381\ \ \ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00382\ \ \ \ \ display\_cat.error()}
\DoxyCodeLine{00383\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}No\ filename\ given\ to\ SubprocessWindow.\(\backslash\)n"{}};}
\DoxyCodeLine{00384\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00385\ \ \ \}}
\DoxyCodeLine{00386\ }
\DoxyCodeLine{00387\ \ \ \_swbuffer\ =\ \mbox{\hyperlink{classSubprocessWindowBuffer_af5652c8e9e244d8c6394151f4360ef7d}{SubprocessWindowBuffer::open\_buffer}}}
\DoxyCodeLine{00388\ \ \ \ \ (\_fd,\ \_mmap\_size,\ \_filename.to\_os\_specific());}
\DoxyCodeLine{00389\ }
\DoxyCodeLine{00390\ \ \ \textcolor{keywordflow}{if}\ (\_swbuffer\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00391\ \ \ \ \ close(\_fd);}
\DoxyCodeLine{00392\ \ \ \ \ \_fd\ =\ -\/1;}
\DoxyCodeLine{00393\ \ \ \ \ \_filename\ =\ string();}
\DoxyCodeLine{00394\ \ \ \ \ \_is\_valid\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00395\ \ \ \ \ display\_cat.error()}
\DoxyCodeLine{00396\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Failed\ to\ open\ SubprocessWindowBuffer's\ shared-\/memory\ buffer\ "{}}}
\DoxyCodeLine{00397\ \ \ \ \ \ \ <<\ \_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00399\ \ \ \}}
\DoxyCodeLine{00400\ }
\DoxyCodeLine{00401\ \ \ \textcolor{keywordflow}{if}\ (display\_cat.is\_debug())\ \{}
\DoxyCodeLine{00402\ \ \ \ \ display\_cat.debug()}
\DoxyCodeLine{00403\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}SubprocessWindow\ reading\ "{}}\ <<\ \_filename\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00404\ \ \ \}}
\DoxyCodeLine{00405\ }
\DoxyCodeLine{00406\ \ \ \textcolor{comment}{//\ Create\ a\ WindowHandle\ for\ ourselves}}
\DoxyCodeLine{00407\ \ \ \_window\_handle\ =\ NativeWindowHandle::make\_subprocess(\_filename);}
\DoxyCodeLine{00408\ }
\DoxyCodeLine{00409\ \ \ \textcolor{comment}{//\ And\ tell\ our\ parent\ window\ that\ we're\ now\ its\ child.}}
\DoxyCodeLine{00410\ \ \ \textcolor{keywordflow}{if}\ (\_parent\_window\_handle\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{00411\ \ \ \ \ \_parent\_window\_handle-\/>attach\_child(\_window\_handle);}
\DoxyCodeLine{00412\ \ \ \}}
\DoxyCodeLine{00413\ }
\DoxyCodeLine{00414\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00415\ \}}
\DoxyCodeLine{00416\ }
\DoxyCodeLine{00422\ \mbox{\hyperlink{classButtonHandle}{ButtonHandle}}\ SubprocessWindow::}
\DoxyCodeLine{00423\ translate\_key(\textcolor{keywordtype}{int}\ \&keycode,\ \textcolor{keywordtype}{int}\ os\_code,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ flags)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00424\ \ \ keycode\ =\ 0;}
\DoxyCodeLine{00425\ \ \ \mbox{\hyperlink{classButtonHandle}{ButtonHandle}}\ nk\ =\ ButtonHandle::none();}
\DoxyCodeLine{00426\ }
\DoxyCodeLine{00427\ \textcolor{preprocessor}{\#ifdef\ \_\_APPLE\_\_}}
\DoxyCodeLine{00428\ \ \ \textcolor{keywordflow}{switch}\ ((os\_code\ >>\ 8)\ \&\ 0xff)\ \{}
\DoxyCodeLine{00429\ \ \ \textcolor{keywordflow}{case}\ \ \ 0:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'a'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00430\ \ \ \textcolor{keywordflow}{case}\ \ 11:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'b'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00431\ \ \ \textcolor{keywordflow}{case}\ \ \ 8:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'c'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00432\ \ \ \textcolor{keywordflow}{case}\ \ \ 2:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'d'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00433\ \ \ \textcolor{keywordflow}{case}\ \ 14:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'e'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00434\ \ \ \textcolor{keywordflow}{case}\ \ \ 3:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'f'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00435\ \ \ \textcolor{keywordflow}{case}\ \ \ 5:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'g'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00436\ \ \ \textcolor{keywordflow}{case}\ \ \ 4:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'h'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00437\ \ \ \textcolor{keywordflow}{case}\ \ 34:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'i'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00438\ \ \ \textcolor{keywordflow}{case}\ \ 38:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'j'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00439\ \ \ \textcolor{keywordflow}{case}\ \ 40:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'k'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00440\ \ \ \textcolor{keywordflow}{case}\ \ 37:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'l'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00441\ \ \ \textcolor{keywordflow}{case}\ \ 46:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'m'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00442\ \ \ \textcolor{keywordflow}{case}\ \ 45:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'n'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00443\ \ \ \textcolor{keywordflow}{case}\ \ 31:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'o'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00444\ \ \ \textcolor{keywordflow}{case}\ \ 35:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'p'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00445\ \ \ \textcolor{keywordflow}{case}\ \ 12:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'q'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00446\ \ \ \textcolor{keywordflow}{case}\ \ 15:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'r'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00447\ \ \ \textcolor{keywordflow}{case}\ \ \ 1:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'s'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00448\ \ \ \textcolor{keywordflow}{case}\ \ 17:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'t'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00449\ \ \ \textcolor{keywordflow}{case}\ \ 32:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'u'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00450\ \ \ \textcolor{keywordflow}{case}\ \ \ 9:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'v'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00451\ \ \ \textcolor{keywordflow}{case}\ \ 13:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'w'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00452\ \ \ \textcolor{keywordflow}{case}\ \ \ 7:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'x'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00453\ \ \ \textcolor{keywordflow}{case}\ \ 16:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'y'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00454\ \ \ \textcolor{keywordflow}{case}\ \ \ 6:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'z'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00455\ }
\DoxyCodeLine{00456\ \ \ \ \ \textcolor{comment}{//\ top\ row\ numbers}}
\DoxyCodeLine{00457\ \ \ \textcolor{keywordflow}{case}\ \ 29:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'0'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00458\ \ \ \textcolor{keywordflow}{case}\ \ 18:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'1'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00459\ \ \ \textcolor{keywordflow}{case}\ \ 19:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'2'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00460\ \ \ \textcolor{keywordflow}{case}\ \ 20:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'3'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00461\ \ \ \textcolor{keywordflow}{case}\ \ 21:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'4'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00462\ \ \ \textcolor{keywordflow}{case}\ \ 23:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'5'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00463\ \ \ \textcolor{keywordflow}{case}\ \ 22:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'6'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00464\ \ \ \textcolor{keywordflow}{case}\ \ 26:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'7'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00465\ \ \ \textcolor{keywordflow}{case}\ \ 28:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'8'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00466\ \ \ \textcolor{keywordflow}{case}\ \ 25:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'9'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00467\ }
\DoxyCodeLine{00468\ \ \ \ \ \textcolor{comment}{//\ key\ pad\ ...\ do\ they\ really\ map\ to\ the\ top\ number\ in\ panda\ ?}}
\DoxyCodeLine{00469\ \ \ \textcolor{keywordflow}{case}\ \ 82:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'0'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00470\ \ \ \textcolor{keywordflow}{case}\ \ 83:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'1'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00471\ \ \ \textcolor{keywordflow}{case}\ \ 84:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'2'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00472\ \ \ \textcolor{keywordflow}{case}\ \ 85:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'3'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00473\ \ \ \textcolor{keywordflow}{case}\ \ 86:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'4'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00474\ \ \ \textcolor{keywordflow}{case}\ \ 87:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'5'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00475\ \ \ \textcolor{keywordflow}{case}\ \ 88:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'6'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00476\ \ \ \textcolor{keywordflow}{case}\ \ 89:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'7'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00477\ \ \ \textcolor{keywordflow}{case}\ \ 91:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'8'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00478\ \ \ \textcolor{keywordflow}{case}\ \ 92:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'9'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \ \ \textcolor{comment}{//\ case\ \ 36:\ nk\ =\ KeyboardButton::ret();\ break;\ \ no\ return\ in\ panda\ ???}}
\DoxyCodeLine{00481\ \ \ \textcolor{keywordflow}{case}\ \ 49:\ nk\ =\ KeyboardButton::space();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00482\ \ \ \textcolor{keywordflow}{case}\ \ 51:\ nk\ =\ KeyboardButton::backspace();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00483\ \ \ \textcolor{keywordflow}{case}\ \ 48:\ nk\ =\ KeyboardButton::tab();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00484\ \ \ \textcolor{keywordflow}{case}\ \ 53:\ nk\ =\ KeyboardButton::escape();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00485\ \ \ \textcolor{keywordflow}{case}\ \ 76:\ nk\ =\ KeyboardButton::enter();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00486\ \ \ \textcolor{keywordflow}{case}\ \ 36:\ nk\ =\ KeyboardButton::enter();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00487\ }
\DoxyCodeLine{00488\ \ \ \textcolor{keywordflow}{case}\ 123:\ nk\ =\ KeyboardButton::left();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00489\ \ \ \textcolor{keywordflow}{case}\ 124:\ nk\ =\ KeyboardButton::right();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00490\ \ \ \textcolor{keywordflow}{case}\ 125:\ nk\ =\ KeyboardButton::down();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00491\ \ \ \textcolor{keywordflow}{case}\ 126:\ nk\ =\ KeyboardButton::up();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00492\ \ \ \textcolor{keywordflow}{case}\ 116:\ nk\ =\ KeyboardButton::page\_up();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00493\ \ \ \textcolor{keywordflow}{case}\ 121:\ nk\ =\ KeyboardButton::page\_down();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00494\ \ \ \textcolor{keywordflow}{case}\ 115:\ nk\ =\ KeyboardButton::home();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00495\ \ \ \textcolor{keywordflow}{case}\ 119:\ nk\ =\ KeyboardButton::end();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00496\ \ \ \textcolor{keywordflow}{case}\ 114:\ nk\ =\ KeyboardButton::help();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00497\ \ \ \textcolor{keywordflow}{case}\ 117:\ nk\ =\ KeyboardButton::del();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00498\ }
\DoxyCodeLine{00499\ \ \ \ \ \textcolor{comment}{//\ case\ \ 71:\ nk\ =\ KeyboardButton::num\_lock()\ break;}}
\DoxyCodeLine{00500\ }
\DoxyCodeLine{00501\ \ \ \textcolor{keywordflow}{case}\ 122:\ nk\ =\ KeyboardButton::f1();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00502\ \ \ \textcolor{keywordflow}{case}\ 120:\ nk\ =\ KeyboardButton::f2();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00503\ \ \ \textcolor{keywordflow}{case}\ \ 99:\ nk\ =\ KeyboardButton::f3();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00504\ \ \ \textcolor{keywordflow}{case}\ 118:\ nk\ =\ KeyboardButton::f4();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00505\ \ \ \textcolor{keywordflow}{case}\ \ 96:\ nk\ =\ KeyboardButton::f5();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00506\ \ \ \textcolor{keywordflow}{case}\ \ 97:\ nk\ =\ KeyboardButton::f6();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00507\ \ \ \textcolor{keywordflow}{case}\ \ 98:\ nk\ =\ KeyboardButton::f7();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00508\ \ \ \textcolor{keywordflow}{case}\ 100:\ nk\ =\ KeyboardButton::f8();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00509\ \ \ \textcolor{keywordflow}{case}\ 101:\ nk\ =\ KeyboardButton::f9();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00510\ \ \ \textcolor{keywordflow}{case}\ 109:\ nk\ =\ KeyboardButton::f10();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00511\ \ \ \textcolor{keywordflow}{case}\ 103:\ nk\ =\ KeyboardButton::f11();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00512\ \ \ \textcolor{keywordflow}{case}\ 111:\ nk\ =\ KeyboardButton::f12();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00513\ }
\DoxyCodeLine{00514\ \ \ \textcolor{keywordflow}{case}\ 105:\ nk\ =\ KeyboardButton::f13();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00515\ \ \ \textcolor{keywordflow}{case}\ 107:\ nk\ =\ KeyboardButton::f14();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00516\ \ \ \textcolor{keywordflow}{case}\ 113:\ nk\ =\ KeyboardButton::f15();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00517\ \ \ \textcolor{keywordflow}{case}\ 106:\ nk\ =\ KeyboardButton::f16();\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \textcolor{comment}{//\ shiftable\ chartablet}}
\DoxyCodeLine{00520\ \ \ \textcolor{keywordflow}{case}\ \ 50:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'`'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00521\ \ \ \textcolor{keywordflow}{case}\ \ 27:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'-\/'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00522\ \ \ \textcolor{keywordflow}{case}\ \ 24:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'='});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00523\ \ \ \textcolor{keywordflow}{case}\ \ 33:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'['});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00524\ \ \ \textcolor{keywordflow}{case}\ \ 30:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{']'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00525\ \ \ \textcolor{keywordflow}{case}\ \ 42:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'\(\backslash\)\(\backslash\)'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00526\ \ \ \textcolor{keywordflow}{case}\ \ 41:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{';'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00527\ \ \ \textcolor{keywordflow}{case}\ \ 39:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'\(\backslash\)''});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00528\ \ \ \textcolor{keywordflow}{case}\ \ 43:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{','});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00529\ \ \ \textcolor{keywordflow}{case}\ \ 47:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'.'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00530\ \ \ \textcolor{keywordflow}{case}\ \ 44:\ nk\ =\ KeyboardButton::ascii\_key(\textcolor{charliteral}{'/'});\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00531\ }
\DoxyCodeLine{00532\ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{comment}{//\ Punt.}}
\DoxyCodeLine{00534\ \ \ \ \ nk\ =\ KeyboardButton::ascii\_key(os\_code\ \&\ 0xff);}
\DoxyCodeLine{00535\ \ \ \}}
\DoxyCodeLine{00536\ }
\DoxyCodeLine{00537\ \ \ \textcolor{keywordflow}{if}\ (nk.has\_ascii\_equivalent())\ \{}
\DoxyCodeLine{00538\ \ \ \ \ \textcolor{comment}{//\ If\ we\ assigned\ an\ ASCII\ button,\ then\ get\ the\ original\ ASCII\ code\ from}}
\DoxyCodeLine{00539\ \ \ \ \ \textcolor{comment}{//\ the\ event\ (it\ will\ include\ shift\ et\ al).}}
\DoxyCodeLine{00540\ }
\DoxyCodeLine{00541\ \ \ \ \ \textcolor{comment}{//\ TODO:\ is\ it\ possible\ to\ get\ any\ international\ characters\ via\ this\ old}}
\DoxyCodeLine{00542\ \ \ \ \ \textcolor{comment}{//\ EventRecord\ interface?}}
\DoxyCodeLine{00543\ \ \ \ \ keycode\ =\ os\_code\ \&\ 0xff;}
\DoxyCodeLine{00544\ \ \ \}}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ \_\_APPLE\_\_}}
\DoxyCodeLine{00547\ }
\DoxyCodeLine{00548\ \ \ \textcolor{keywordflow}{return}\ nk;}
\DoxyCodeLine{00549\ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00555\ \textcolor{keywordtype}{void}\ SubprocessWindow::}
\DoxyCodeLine{00556\ transition\_button(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ flags,\ \mbox{\hyperlink{classButtonHandle}{ButtonHandle}}\ button)\ \{}
\DoxyCodeLine{00557\ \ \ \textcolor{keywordflow}{if}\ (flags)\ \{}
\DoxyCodeLine{00558\ \ \ \ \ \_input-\/>button\_down(button);}
\DoxyCodeLine{00559\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00560\ \ \ \ \ \_input-\/>button\_up(button);}
\DoxyCodeLine{00561\ \ \ \}}
\DoxyCodeLine{00562\ \}}
\DoxyCodeLine{00563\ }
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ SUPPORT\_SUBPROCESS\_WINDOW}}

\end{DoxyCode}
