\doxysection{physics\+Object.\+cxx}
\hypertarget{physicsObject_8cxx_source}{}\label{physicsObject_8cxx_source}\index{panda/src/physics/physicsObject.cxx@{panda/src/physics/physicsObject.cxx}}
\mbox{\hyperlink{physicsObject_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{physicsObject_8h}{physicsObject.h}}"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \mbox{\hyperlink{classConfigVariableDouble}{ConfigVariableDouble}}\ PhysicsObject::\_default\_terminal\_velocity}
\DoxyCodeLine{00017\ (\textcolor{stringliteral}{"{}default\_terminal\_velocity"{}},\ 400.0f);}
\DoxyCodeLine{00018\ }
\DoxyCodeLine{00019\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ PhysicsObject::\_type\_handle;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00024\ \mbox{\hyperlink{classPhysicsObject_ae1869a54412255612df17578933bdde9}{PhysicsObject::}}}
\DoxyCodeLine{00025\ \mbox{\hyperlink{classPhysicsObject_ae1869a54412255612df17578933bdde9}{PhysicsObject}}()\ :}
\DoxyCodeLine{00026\ \ \ \_terminal\_velocity(\_default\_terminal\_velocity),}
\DoxyCodeLine{00027\ \ \ \_mass(1.0f),}
\DoxyCodeLine{00028\ \ \ \_process\_me(false),}
\DoxyCodeLine{00029\ \ \ \_oriented(true)}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \ \ \_position.set(0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00032\ \ \ \_last\_position\ =\ \_position;}
\DoxyCodeLine{00033\ \ \ \_velocity.set(0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00034\ \ \ \_orientation.set(1.0\ ,0.0f,\ 0.0f,\ 0.0f);}
\DoxyCodeLine{00035\ \ \ \_rotation\ =\ LRotation::ident\_quat();}
\DoxyCodeLine{00036\ \}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00041\ \mbox{\hyperlink{classPhysicsObject_ae1869a54412255612df17578933bdde9}{PhysicsObject::}}}
\DoxyCodeLine{00042\ \mbox{\hyperlink{classPhysicsObject_ae1869a54412255612df17578933bdde9}{PhysicsObject}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPhysicsObject}{PhysicsObject}}\&\ copy)\ \{}
\DoxyCodeLine{00043\ \ \ operator=(copy);}
\DoxyCodeLine{00044\ \}}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00049\ \mbox{\hyperlink{classPhysicsObject_a2172e8b71176e3a54d6a8f5ff15d4178}{PhysicsObject::}}}
\DoxyCodeLine{00050\ \mbox{\hyperlink{classPhysicsObject_a2172e8b71176e3a54d6a8f5ff15d4178}{\string~PhysicsObject}}()\ \{}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00056\ \textcolor{keyword}{const}\ \mbox{\hyperlink{classPhysicsObject}{PhysicsObject}}\ \&PhysicsObject::}
\DoxyCodeLine{00057\ operator\ =(\textcolor{keyword}{const}\ \mbox{\hyperlink{classPhysicsObject}{PhysicsObject}}\ \&other)\ \{}
\DoxyCodeLine{00058\ \ \ \_process\_me\ =\ other.\_process\_me;}
\DoxyCodeLine{00059\ \ \ \_mass\ =\ other.\_mass;}
\DoxyCodeLine{00060\ \ \ \_position\ =\ other.\_position;}
\DoxyCodeLine{00061\ \ \ \_last\_position\ =\ other.\_last\_position;}
\DoxyCodeLine{00062\ \ \ \_velocity\ =\ other.\_velocity;}
\DoxyCodeLine{00063\ \ \ \_orientation\ =\ other.\_orientation;}
\DoxyCodeLine{00064\ \ \ \_rotation\ =\ other.\_rotation;}
\DoxyCodeLine{00065\ \ \ \_terminal\_velocity\ =\ other.\_terminal\_velocity;}
\DoxyCodeLine{00066\ \ \ \_oriented\ =\ other.\_oriented;}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00069\ \}}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00074\ \mbox{\hyperlink{classPhysicsObject}{PhysicsObject}}\ *\mbox{\hyperlink{classPhysicsObject_a0b233703c5d48abfd41c8466233ebfe4}{PhysicsObject::}}}
\DoxyCodeLine{00075\ \mbox{\hyperlink{classPhysicsObject_a0b233703c5d48abfd41c8466233ebfe4}{make\_copy}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classPhysicsObject_ae1869a54412255612df17578933bdde9}{PhysicsObject}}(*\textcolor{keyword}{this});}
\DoxyCodeLine{00077\ \}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00086\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPhysicsObject_a2aaf44b4a13f3f20901584ba83c65a89}{PhysicsObject::}}}
\DoxyCodeLine{00087\ \mbox{\hyperlink{classPhysicsObject_a2aaf44b4a13f3f20901584ba83c65a89}{add\_local\_impact}}(\textcolor{keyword}{const}\ LPoint3\ \&offset\_from\_center\_of\_mass,}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keyword}{const}\ LVector3\ \&force)\ \{}
\DoxyCodeLine{00089\ \ \ nassertv(!offset\_from\_center\_of\_mass.is\_nan());}
\DoxyCodeLine{00090\ \ \ nassertv(!force.is\_nan());}
\DoxyCodeLine{00091\ \ \ \mbox{\hyperlink{classPhysicsObject_af915396e935b80bbf9353bab78eeda5e}{add\_impact}}(}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \_orientation.xform(offset\_from\_center\_of\_mass),}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \_orientation.xform(force));}
\DoxyCodeLine{00094\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00103\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPhysicsObject_af915396e935b80bbf9353bab78eeda5e}{PhysicsObject::}}}
\DoxyCodeLine{00104\ \mbox{\hyperlink{classPhysicsObject_af915396e935b80bbf9353bab78eeda5e}{add\_impact}}(\textcolor{keyword}{const}\ LPoint3\ \&offset,}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keyword}{const}\ LVector3\ \&force)\ \{}
\DoxyCodeLine{00106\ \ \ nassertv(!offset.is\_nan());}
\DoxyCodeLine{00107\ \ \ nassertv(!force.is\_nan());}
\DoxyCodeLine{00108\ \ \ LVector3\ a\ =\ offset;}
\DoxyCodeLine{00109\ \ \ LVector3\ b\ =\ force;}
\DoxyCodeLine{00110\ \ \ a.normalize();}
\DoxyCodeLine{00111\ \ \ b.normalize();}
\DoxyCodeLine{00112\ \ \ a\ =\ a.cross(b);}
\DoxyCodeLine{00113\ \ \ PN\_stdfloat\ angle\ =\ a.length();}
\DoxyCodeLine{00114\ \ \ \textcolor{keywordflow}{if}\ (angle)\ \{}
\DoxyCodeLine{00115\ \ \ \ \ LRotation\ torque(0,\ 0,\ 0,\ 0);}
\DoxyCodeLine{00116\ \ \ \ \ PN\_stdfloat\ spin\ =\ force.length()*0.1;\ \textcolor{comment}{//\ todo:\ this\ should\ account\ for}}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ impact\ distance\ and\ mass.}}
\DoxyCodeLine{00118\ \ \ \ \ a.normalize();}
\DoxyCodeLine{00119\ \ \ \ \ assert(IS\_THRESHOLD\_EQUAL(a.length(),\ 1.0f,\ 0.001f));}
\DoxyCodeLine{00120\ \ \ \ \ torque.set\_from\_axis\_angle(spin,\ a);}
\DoxyCodeLine{00121\ \ \ \ \ add\_torque(torque);}
\DoxyCodeLine{00122\ \ \ \}}
\DoxyCodeLine{00123\ \ \ LVector3\ impulse\ =\ (1.0f\ -\/\ angle)\ *\ force;}
\DoxyCodeLine{00124\ \ \ add\_impulse(impulse);}
\DoxyCodeLine{00125\ \}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00130\ LMatrix4\ \mbox{\hyperlink{classPhysicsObject_a60c0a9a723c00b5f71e7853cfdb11027}{PhysicsObject::}}}
\DoxyCodeLine{00131\ \mbox{\hyperlink{classPhysicsObject_a60c0a9a723c00b5f71e7853cfdb11027}{get\_lcs}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00132\ \ \ LMatrix4\ m\ =\ LMatrix4::translate\_mat(\_position);}
\DoxyCodeLine{00133\ \ \ \textcolor{keywordflow}{if}\ (\_oriented)\ \{}
\DoxyCodeLine{00134\ \ \ \ \ m=m*\_orientation;}
\DoxyCodeLine{00135\ \ \ \}}
\DoxyCodeLine{00136\ \ \ nassertr(!m.is\_nan(),\ m);}
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{return}\ m;}
\DoxyCodeLine{00138\ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00144\ LMatrix4\ \mbox{\hyperlink{classPhysicsObject_a3192e2674c201e5fdbf865c699ac567b}{PhysicsObject::}}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{classPhysicsObject_a3192e2674c201e5fdbf865c699ac567b}{get\_inertial\_tensor}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00146\ \ \ \textcolor{keywordflow}{return}\ LMatrix4::ident\_mat();}
\DoxyCodeLine{00147\ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00152\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPhysicsObject_a193a7a7c75947dc6bf7aabfb4178d496}{PhysicsObject::}}}
\DoxyCodeLine{00153\ \mbox{\hyperlink{classPhysicsObject_a193a7a7c75947dc6bf7aabfb4178d496}{output}}(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00154\ \textcolor{preprocessor}{\ \ \#ifndef\ NDEBUG\ }\textcolor{comment}{//[}}
\DoxyCodeLine{00155\ \ \ out<<\textcolor{stringliteral}{"{}PhysicsObject"{}};}
\DoxyCodeLine{00156\ \textcolor{preprocessor}{\ \ \#endif\ }\textcolor{comment}{//]\ NDEBUG}}
\DoxyCodeLine{00157\ \}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00162\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classPhysicsObject_a9b67be7b85c25974bead0d718677c97e}{PhysicsObject::}}}
\DoxyCodeLine{00163\ \mbox{\hyperlink{classPhysicsObject_a9b67be7b85c25974bead0d718677c97e}{write}}(std::ostream\ \&out,\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}})\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00164\ \textcolor{preprocessor}{\ \ \#ifndef\ NDEBUG\ }\textcolor{comment}{//[}}
\DoxyCodeLine{00165\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}});}
\DoxyCodeLine{00166\ \ \ out<<\textcolor{stringliteral}{"{}"{}}<<\textcolor{stringliteral}{"{}PhysicsObject\ "{}}<<\_name<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00167\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_position\ "{}}<<\_position<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00168\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_last\_position\ "{}}<<\_last\_position<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00169\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_velocity\ "{}}<<\_velocity<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00170\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}(implicit\ velocity\ "{}}<<get\_implicit\_velocity()<<\textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00171\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_orientation\ "{}}<<\_orientation<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00172\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}(hpr\ "{}}<<\_orientation.get\_hpr()<<\textcolor{stringliteral}{"{})\(\backslash\)n"{}};}
\DoxyCodeLine{00173\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_rotation\ "{}}<<\_rotation<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00174\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_terminal\_velocity\ "{}}<<\_terminal\_velocity<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00175\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_mass\ "{}}<<\_mass<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00176\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_process\_me\ "{}}<<\_process\_me<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00177\ \ \ out.width(\mbox{\hyperlink{indent_8cxx_a20c026b79ac844b38fcd02e70a7497d1}{indent}}+2);\ out<<\textcolor{stringliteral}{"{}"{}};\ out<<\textcolor{stringliteral}{"{}\_oriented\ "{}}<<\_oriented<<\textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00178\ \textcolor{preprocessor}{\ \ \#endif\ }\textcolor{comment}{//]\ NDEBUG}}
\DoxyCodeLine{00179\ \}}

\end{DoxyCode}
