\doxysection{joint\+Vertex\+Transform.\+cxx}
\hypertarget{jointVertexTransform_8cxx_source}{}\label{jointVertexTransform_8cxx_source}\index{panda/src/char/jointVertexTransform.cxx@{panda/src/char/jointVertexTransform.cxx}}
\mbox{\hyperlink{jointVertexTransform_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{jointVertexTransform_8h}{jointVertexTransform.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{lightMutexHolder_8h}{lightMutexHolder.h}}"{}}}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ JointVertexTransform::\_type\_handle;}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00026\ JointVertexTransform::}
\DoxyCodeLine{00027\ JointVertexTransform()}
\DoxyCodeLine{00028\ \{}
\DoxyCodeLine{00029\ \}}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00035\ JointVertexTransform::}
\DoxyCodeLine{00036\ JointVertexTransform(\mbox{\hyperlink{classCharacterJoint}{CharacterJoint}}\ *joint)\ :}
\DoxyCodeLine{00037\ \ \ \_joint(joint)}
\DoxyCodeLine{00038\ \{}
\DoxyCodeLine{00039\ \ \ \textcolor{comment}{//\ Tell\ the\ joint\ that\ we\ need\ to\ be\ informed\ when\ it\ moves.}}
\DoxyCodeLine{00040\ \ \ \_joint-\/>\_vertex\_transforms.insert(\textcolor{keyword}{this});}
\DoxyCodeLine{00041\ \ \ mark\_modified(Thread::get\_current\_thread());}
\DoxyCodeLine{00042\ \}}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00047\ JointVertexTransform::}
\DoxyCodeLine{00048\ \string~JointVertexTransform()\ \{}
\DoxyCodeLine{00049\ \ \ \textcolor{comment}{//\ Tell\ the\ joint\ to\ stop\ informing\ us\ about\ its\ motion.}}
\DoxyCodeLine{00050\ \ \ \_joint-\/>\_vertex\_transforms.erase(\textcolor{keyword}{this});}
\DoxyCodeLine{00051\ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00056\ \textcolor{keywordtype}{void}\ JointVertexTransform::}
\DoxyCodeLine{00057\ get\_matrix(LMatrix4\ \&matrix)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00058\ \ \ matrix\ =\ \_joint-\/>\_skinning\_matrix;}
\DoxyCodeLine{00059\ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00067\ \textcolor{keywordtype}{void}\ JointVertexTransform::}
\DoxyCodeLine{00068\ mult\_matrix(LMatrix4\ \&result,\ \textcolor{keyword}{const}\ LMatrix4\ \&previous)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00069\ \ \ result.multiply(\_joint-\/>\_skinning\_matrix,\ previous);}
\DoxyCodeLine{00070\ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00077\ \textcolor{keywordtype}{void}\ JointVertexTransform::}
\DoxyCodeLine{00078\ accumulate\_matrix(LMatrix4\ \&accum,\ PN\_stdfloat\ weight)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00079\ \ \ accum.accumulate(\_joint-\/>\_skinning\_matrix,\ weight);}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00085\ \textcolor{keywordtype}{void}\ JointVertexTransform::}
\DoxyCodeLine{00086\ output(std::ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00087\ \ \ out\ <<\ \_joint-\/>get\_name();}
\DoxyCodeLine{00088\ \}}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00093\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classJointVertexTransform_a31c4dd81570f2e079c10f3ffdab0cc1a}{JointVertexTransform::}}}
\DoxyCodeLine{00094\ \mbox{\hyperlink{classJointVertexTransform_a31c4dd81570f2e079c10f3ffdab0cc1a}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00095\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classJointVertexTransform_a54fb9d89aab21e6a2045b2a686d3db98}{make\_from\_bam}});}
\DoxyCodeLine{00096\ \}}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00102\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classJointVertexTransform_a25d5dcc0296cc2bc4b90f57b06ebf718}{JointVertexTransform::}}}
\DoxyCodeLine{00103\ \mbox{\hyperlink{classJointVertexTransform_a25d5dcc0296cc2bc4b90f57b06ebf718}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00104\ \ \ \mbox{\hyperlink{classVertexTransform_a7215ddc1a326e36237f09bd9e8dbf5b3}{VertexTransform::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \ \ manager-\/>\mbox{\hyperlink{classBamWriter_a634bd4eb8e9b33ffde91a27c02f80467}{write\_pointer}}(dg,\ \_joint);}
\DoxyCodeLine{00107\ \}}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00113\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classJointVertexTransform_aa71e80fbe017a2258e0d8b12f2d99c35}{JointVertexTransform::}}}
\DoxyCodeLine{00114\ \mbox{\hyperlink{classJointVertexTransform_aa71e80fbe017a2258e0d8b12f2d99c35}{complete\_pointers}}(\mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ **p\_list,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordtype}{int}\ pi\ =\ \mbox{\hyperlink{classTypedWritable_addc29bb978851cacca2196f8a1f35014}{VertexTransform::complete\_pointers}}(p\_list,\ manager);}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ \_joint\ =\ DCAST(\mbox{\hyperlink{classCharacterJoint}{CharacterJoint}},\ p\_list[pi++]);}
\DoxyCodeLine{00118\ \ \ \_joint-\/>\_vertex\_transforms.insert(\textcolor{keyword}{this});}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{return}\ pi;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00128\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classJointVertexTransform_a54fb9d89aab21e6a2045b2a686d3db98}{JointVertexTransform::}}}
\DoxyCodeLine{00129\ \mbox{\hyperlink{classJointVertexTransform_a54fb9d89aab21e6a2045b2a686d3db98}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00130\ \ \ \mbox{\hyperlink{classJointVertexTransform}{JointVertexTransform}}\ *\textcolor{keywordtype}{object}\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classJointVertexTransform}{JointVertexTransform}};}
\DoxyCodeLine{00131\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00132\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{object}-\/>fillin(scan,\ manager);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \ \ \textcolor{keywordflow}{return}\ object;}
\DoxyCodeLine{00138\ \}}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00144\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classJointVertexTransform_af019788861ebbfafda38727a4508a3ff}{JointVertexTransform::}}}
\DoxyCodeLine{00145\ \mbox{\hyperlink{classJointVertexTransform_af019788861ebbfafda38727a4508a3ff}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00146\ \ \ \mbox{\hyperlink{classVertexTransform_a62e3ffa3a5c49d880c6ecf648e8f16d4}{VertexTransform::fillin}}(scan,\ manager);}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ \ \ manager-\/>\mbox{\hyperlink{classBamReader_ac0ecc0609d9c6de514145777b3336435}{read\_pointer}}(scan);}
\DoxyCodeLine{00149\ \ \ \mbox{\hyperlink{classVertexTransform_abb48f849f7fb845043dac7c73775faf0}{mark\_modified}}(Thread::get\_current\_thread());}
\DoxyCodeLine{00150\ \}}

\end{DoxyCode}
