\doxysection{rescale\+Normal\+Attrib.\+cxx}
\hypertarget{rescaleNormalAttrib_8cxx_source}{}\label{rescaleNormalAttrib_8cxx_source}\index{panda/src/pgraph/rescaleNormalAttrib.cxx@{panda/src/pgraph/rescaleNormalAttrib.cxx}}
\mbox{\hyperlink{rescaleNormalAttrib_8cxx}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{rescaleNormalAttrib_8h}{rescaleNormalAttrib.h}}"{}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{graphicsStateGuardianBase_8h}{graphicsStateGuardianBase.h}}"{}}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{string__utils_8h}{string\_utils.h}}"{}}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{dcast_8h}{dcast.h}}"{}}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamReader_8h}{bamReader.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{bamWriter_8h}{bamWriter.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagram_8h}{datagram.h}}"{}}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{datagramIterator_8h}{datagramIterator.h}}"{}}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{configVariableEnum_8h}{configVariableEnum.h}}"{}}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config__pgraph_8h}{config\_pgraph.h}}"{}}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{using\ }std::istream;}
\DoxyCodeLine{00026\ \textcolor{keyword}{using\ }std::ostream;}
\DoxyCodeLine{00027\ \textcolor{keyword}{using\ }std::string;}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \mbox{\hyperlink{classTypeHandle}{TypeHandle}}\ RescaleNormalAttrib::\_type\_handle;}
\DoxyCodeLine{00030\ \textcolor{keywordtype}{int}\ RescaleNormalAttrib::\_attrib\_slot;}
\DoxyCodeLine{00031\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ RescaleNormalAttrib::\_attribs[RescaleNormalAttrib::M\_auto\ +\ 1];}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00038\ CPT(\mbox{\hyperlink{classRenderAttrib}{RenderAttrib}})\ RescaleNormalAttrib::}
\DoxyCodeLine{00039\ make(RescaleNormalAttrib::Mode\ mode)\ \{}
\DoxyCodeLine{00040\ \ \ \textcolor{keywordflow}{if}\ (\_attribs[mode].is\_null())\ \{}
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{//\ Don't\ bother\ with\ return\_new,\ since\ this\ is\ the\ only\ way\ a}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ RescaleNormalAttrib\ can\ be\ made\ anyway.}}
\DoxyCodeLine{00043\ \ \ \ \ \_attribs[mode]\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}(mode);}
\DoxyCodeLine{00044\ \ \ \}}
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{return}\ \_attribs[mode];}
\DoxyCodeLine{00046\ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00051\ \textcolor{keywordtype}{void}\ RescaleNormalAttrib::}
\DoxyCodeLine{00052\ output(ostream\ \&out)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00053\ \ \ out\ <<\ get\_type()\ <<\ \textcolor{stringliteral}{"{}:"{}}\ <<\ get\_mode();}
\DoxyCodeLine{00054\ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00068\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classRescaleNormalAttrib_ae0edfd4816f765ca674d2a10181e9b0b}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00069\ \mbox{\hyperlink{classRescaleNormalAttrib_ae0edfd4816f765ca674d2a10181e9b0b}{compare\_to\_impl}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classRenderAttrib}{RenderAttrib}}\ *other)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00070\ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}\ *ta\ =\ (\textcolor{keyword}{const}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}\ *)other;}
\DoxyCodeLine{00071\ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{int})\_mode\ -\/\ (int)ta-\/>\_mode;}
\DoxyCodeLine{00072\ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00080\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classRescaleNormalAttrib_aed957526180304696b59fff13f8205d5}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00081\ \mbox{\hyperlink{classRescaleNormalAttrib_aed957526180304696b59fff13f8205d5}{get\_hash\_impl}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00082\ \ \ \textcolor{keywordtype}{size\_t}\ hash\ =\ 0;}
\DoxyCodeLine{00083\ \ \ hash\ =\ int\_hash::add\_hash(hash,\ (\textcolor{keywordtype}{int})\_mode);}
\DoxyCodeLine{00084\ \ \ \textcolor{keywordflow}{return}\ hash;}
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00090\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRescaleNormalAttrib_ae25303479a1841dedc3b8a80e9e4cd76}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00091\ \mbox{\hyperlink{classRescaleNormalAttrib_ae25303479a1841dedc3b8a80e9e4cd76}{register\_with\_read\_factory}}()\ \{}
\DoxyCodeLine{00092\ \ \ BamReader::get\_factory()-\/>register\_factory(get\_class\_type(),\ \mbox{\hyperlink{classRescaleNormalAttrib_a85bb631cad245ad70410e1541ed10c8f}{make\_from\_bam}});}
\DoxyCodeLine{00093\ \}}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00099\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRescaleNormalAttrib_aa57d0c4c91678f1db0a66b4cac4d0d4b}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00100\ \mbox{\hyperlink{classRescaleNormalAttrib_aa57d0c4c91678f1db0a66b4cac4d0d4b}{write\_datagram}}(\mbox{\hyperlink{classBamWriter}{BamWriter}}\ *manager,\ \mbox{\hyperlink{classDatagram}{Datagram}}\ \&dg)\ \{}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{classRenderAttrib_a71362ffe83327f2de6b2b9ffb958d8d4}{RenderAttrib::write\_datagram}}(manager,\ dg);}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ dg.add\_int8(\_mode);}
\DoxyCodeLine{00104\ \}}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00111\ \mbox{\hyperlink{classTypedWritable}{TypedWritable}}\ *\mbox{\hyperlink{classRescaleNormalAttrib_a85bb631cad245ad70410e1541ed10c8f}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00112\ \mbox{\hyperlink{classRescaleNormalAttrib_a85bb631cad245ad70410e1541ed10c8f}{make\_from\_bam}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classFactoryParams}{FactoryParams}}\ \&params)\ \{}
\DoxyCodeLine{00113\ \ \ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}(M\_none);}
\DoxyCodeLine{00114\ \ \ \mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ scan;}
\DoxyCodeLine{00115\ \ \ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager;}
\DoxyCodeLine{00116\ }
\DoxyCodeLine{00117\ \ \ parse\_params(params,\ scan,\ manager);}
\DoxyCodeLine{00118\ \ \ attrib-\/>\mbox{\hyperlink{classRescaleNormalAttrib_a704f35564d9512e4975b2ca2ee3fc4fa}{fillin}}(scan,\ manager);}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordflow}{return}\ attrib;}
\DoxyCodeLine{00121\ \}}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00127\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classRescaleNormalAttrib_a704f35564d9512e4975b2ca2ee3fc4fa}{RescaleNormalAttrib::}}}
\DoxyCodeLine{00128\ \mbox{\hyperlink{classRescaleNormalAttrib_a704f35564d9512e4975b2ca2ee3fc4fa}{fillin}}(\mbox{\hyperlink{classDatagramIterator}{DatagramIterator}}\ \&scan,\ \mbox{\hyperlink{classBamReader}{BamReader}}\ *manager)\ \{}
\DoxyCodeLine{00129\ \ \ \mbox{\hyperlink{classRenderAttrib_af4f7151db19835a2e7b74b458c3563f1}{RenderAttrib::fillin}}(scan,\ manager);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00131\ \ \ \_mode\ =\ (Mode)scan.get\_int8();}
\DoxyCodeLine{00132\ \}}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00137\ \textcolor{keywordtype}{void}\ RescaleNormalAttrib::}
\DoxyCodeLine{00138\ init\_type()\ \{}
\DoxyCodeLine{00139\ \ \ RenderAttrib::init\_type();}
\DoxyCodeLine{00140\ \ \ \mbox{\hyperlink{register__type_8h_a54fc7cae2908ec9e8da7174a8d027735}{register\_type}}(\_type\_handle,\ \textcolor{stringliteral}{"{}RescaleNormalAttrib"{}},}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ RenderAttrib::get\_class\_type());}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \textcolor{comment}{//\ This\ is\ defined\ here,\ since\ we\ have\ otherwise\ no\ guarantee\ that\ the}}
\DoxyCodeLine{00144\ \ \ \textcolor{comment}{//\ config\ var\ has\ already\ been\ constructed\ by\ the\ time\ we\ call\ init\_type()}}
\DoxyCodeLine{00145\ \ \ \textcolor{comment}{//\ at\ static\ init\ time.}}
\DoxyCodeLine{00146\ \ \ \textcolor{keyword}{static}\ \mbox{\hyperlink{classConfigVariableEnum}{ConfigVariableEnum<RescaleNormalAttrib::Mode>}}\ rescale\_normals}
\DoxyCodeLine{00147\ \ \ (\textcolor{stringliteral}{"{}rescale-\/normals"{}},\ RescaleNormalAttrib::M\_auto,}
\DoxyCodeLine{00148\ \ \ \ PRC\_DESC(\textcolor{stringliteral}{"{}Specifies\ the\ kind\ of\ RescaleNormalAttrib\ that\ should\ be\ "{}}}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}created\ for\ the\ top\ of\ the\ scene\ graph.\ \ This\ can\ automatically\ "{}}}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}ensure\ that\ your\ lighting\ normals\ are\ unit-\/length,\ which\ may\ be\ "{}}}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}particularly\ necessary\ in\ the\ presence\ of\ scales\ in\ the\ scene\ "{}}}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}graph.\ \ Turning\ it\ off\ ('none')\ may\ produce\ a\ small\ performance\ "{}}}
\DoxyCodeLine{00153\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}benefit."{}}));}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ Mode\ mode\ =\ rescale\_normals;}
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}\ *attrib\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classRescaleNormalAttrib}{RescaleNormalAttrib}}(mode);}
\DoxyCodeLine{00157\ \ \ \_attrib\_slot\ =\ register\_slot(\_type\_handle,\ 100,\ attrib);}
\DoxyCodeLine{00158\ \ \ \_attribs[mode]\ =\ attrib;}
\DoxyCodeLine{00159\ \}}
\DoxyCodeLine{00160\ }
\DoxyCodeLine{00164\ ostream\ \&}
\DoxyCodeLine{00165\ operator\ <<\ (ostream\ \&out,\ RescaleNormalAttrib::Mode\ mode)\ \{}
\DoxyCodeLine{00166\ \ \ \textcolor{keywordflow}{switch}\ (mode)\ \{}
\DoxyCodeLine{00167\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_none:}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}none"{}};}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_rescale:}
\DoxyCodeLine{00171\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}rescale"{}};}
\DoxyCodeLine{00172\ }
\DoxyCodeLine{00173\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_normalize:}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}normalize"{}};}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \textcolor{keywordflow}{case}\ RescaleNormalAttrib::M\_auto:}
\DoxyCodeLine{00177\ \ \ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}auto"{}};}
\DoxyCodeLine{00178\ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \textcolor{keywordflow}{return}\ out\ <<\ \textcolor{stringliteral}{"{}(**invalid\ RescaleNormalAttrib::Mode("{}}\ <<\ (int)mode\ <<\ \textcolor{stringliteral}{"{})**)"{}};}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00186\ istream\ \&}
\DoxyCodeLine{00187\ operator\ >>\ (istream\ \&in,\ RescaleNormalAttrib::Mode\ \&mode)\ \{}
\DoxyCodeLine{00188\ \ \ \textcolor{keywordtype}{string}\ word;}
\DoxyCodeLine{00189\ \ \ in\ >>\ word;}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \textcolor{keywordflow}{if}\ (cmp\_nocase(word,\ \textcolor{stringliteral}{"{}none"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00192\ \ \ \ \ mode\ =\ RescaleNormalAttrib::M\_none;}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(word,\ \textcolor{stringliteral}{"{}rescale"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00195\ \ \ \ \ mode\ =\ RescaleNormalAttrib::M\_rescale;}
\DoxyCodeLine{00196\ }
\DoxyCodeLine{00197\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(word,\ \textcolor{stringliteral}{"{}normalize"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00198\ \ \ \ \ mode\ =\ RescaleNormalAttrib::M\_normalize;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (cmp\_nocase(word,\ \textcolor{stringliteral}{"{}auto"{}})\ ==\ 0)\ \{}
\DoxyCodeLine{00201\ \ \ \ \ mode\ =\ RescaleNormalAttrib::M\_auto;}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00204\ \ \ \ \ pgraph\_cat.error()}
\DoxyCodeLine{00205\ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Invalid\ RescaleNormalAttrib::Mode\ value:\ "{}}\ <<\ word\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00206\ \ \ \ \ mode\ =\ RescaleNormalAttrib::M\_none;}
\DoxyCodeLine{00207\ \ \ \}}
\DoxyCodeLine{00208\ }
\DoxyCodeLine{00209\ \ \ \textcolor{keywordflow}{return}\ in;}
\DoxyCodeLine{00210\ \}}

\end{DoxyCode}
